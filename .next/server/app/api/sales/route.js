"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
(() => {
var exports = {};
exports.id = "app/api/sales/route";
exports.ids = ["app/api/sales/route"];
exports.modules = {

/***/ "next/dist/compiled/next-server/app-page.runtime.dev.js":
/*!*************************************************************************!*\
  !*** external "next/dist/compiled/next-server/app-page.runtime.dev.js" ***!
  \*************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/compiled/next-server/app-page.runtime.dev.js");

/***/ }),

/***/ "next/dist/compiled/next-server/app-route.runtime.dev.js":
/*!**************************************************************************!*\
  !*** external "next/dist/compiled/next-server/app-route.runtime.dev.js" ***!
  \**************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/compiled/next-server/app-route.runtime.dev.js");

/***/ }),

/***/ "crypto":
/*!*************************!*\
  !*** external "crypto" ***!
  \*************************/
/***/ ((module) => {

module.exports = require("crypto");

/***/ }),

/***/ "node:buffer":
/*!******************************!*\
  !*** external "node:buffer" ***!
  \******************************/
/***/ ((module) => {

module.exports = require("node:buffer");

/***/ }),

/***/ "node:crypto":
/*!******************************!*\
  !*** external "node:crypto" ***!
  \******************************/
/***/ ((module) => {

module.exports = require("node:crypto");

/***/ }),

/***/ "node:util":
/*!****************************!*\
  !*** external "node:util" ***!
  \****************************/
/***/ ((module) => {

module.exports = require("node:util");

/***/ }),

/***/ "(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fsales%2Froute&page=%2Fapi%2Fsales%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fsales%2Froute.ts&appDir=C%3A%5CUsers%5CUsuario%5CAKILES%5CGAME%20WEB%20APP%5CSPLIT%5Cthegame%5Capp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=C%3A%5CUsers%5CUsuario%5CAKILES%5CGAME%20WEB%20APP%5CSPLIT%5Cthegame&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!":
/*!***********************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************!*\
  !*** ./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fsales%2Froute&page=%2Fapi%2Fsales%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fsales%2Froute.ts&appDir=C%3A%5CUsers%5CUsuario%5CAKILES%5CGAME%20WEB%20APP%5CSPLIT%5Cthegame%5Capp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=C%3A%5CUsers%5CUsuario%5CAKILES%5CGAME%20WEB%20APP%5CSPLIT%5Cthegame&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D! ***!
  \***********************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   originalPathname: () => (/* binding */ originalPathname),\n/* harmony export */   patchFetch: () => (/* binding */ patchFetch),\n/* harmony export */   requestAsyncStorage: () => (/* binding */ requestAsyncStorage),\n/* harmony export */   routeModule: () => (/* binding */ routeModule),\n/* harmony export */   serverHooks: () => (/* binding */ serverHooks),\n/* harmony export */   staticGenerationAsyncStorage: () => (/* binding */ staticGenerationAsyncStorage)\n/* harmony export */ });\n/* harmony import */ var next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/dist/server/future/route-modules/app-route/module.compiled */ \"(rsc)/./node_modules/next/dist/server/future/route-modules/app-route/module.compiled.js\");\n/* harmony import */ var next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! next/dist/server/future/route-kind */ \"(rsc)/./node_modules/next/dist/server/future/route-kind.js\");\n/* harmony import */ var next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! next/dist/server/lib/patch-fetch */ \"(rsc)/./node_modules/next/dist/server/lib/patch-fetch.js\");\n/* harmony import */ var next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__);\n/* harmony import */ var C_Users_Usuario_AKILES_GAME_WEB_APP_SPLIT_thegame_app_api_sales_route_ts__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./app/api/sales/route.ts */ \"(rsc)/./app/api/sales/route.ts\");\n\n\n\n\n// We inject the nextConfigOutput here so that we can use them in the route\n// module.\nconst nextConfigOutput = \"\"\nconst routeModule = new next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__.AppRouteRouteModule({\n    definition: {\n        kind: next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__.RouteKind.APP_ROUTE,\n        page: \"/api/sales/route\",\n        pathname: \"/api/sales\",\n        filename: \"route\",\n        bundlePath: \"app/api/sales/route\"\n    },\n    resolvedPagePath: \"C:\\\\Users\\\\Usuario\\\\AKILES\\\\GAME WEB APP\\\\SPLIT\\\\thegame\\\\app\\\\api\\\\sales\\\\route.ts\",\n    nextConfigOutput,\n    userland: C_Users_Usuario_AKILES_GAME_WEB_APP_SPLIT_thegame_app_api_sales_route_ts__WEBPACK_IMPORTED_MODULE_3__\n});\n// Pull out the exports that we need to expose from the module. This should\n// be eliminated when we've moved the other routes to the new format. These\n// are used to hook into the route.\nconst { requestAsyncStorage, staticGenerationAsyncStorage, serverHooks } = routeModule;\nconst originalPathname = \"/api/sales/route\";\nfunction patchFetch() {\n    return (0,next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__.patchFetch)({\n        serverHooks,\n        staticGenerationAsyncStorage\n    });\n}\n\n\n//# sourceMappingURL=app-route.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvbmV4dC9kaXN0L2J1aWxkL3dlYnBhY2svbG9hZGVycy9uZXh0LWFwcC1sb2FkZXIuanM/bmFtZT1hcHAlMkZhcGklMkZzYWxlcyUyRnJvdXRlJnBhZ2U9JTJGYXBpJTJGc2FsZXMlMkZyb3V0ZSZhcHBQYXRocz0mcGFnZVBhdGg9cHJpdmF0ZS1uZXh0LWFwcC1kaXIlMkZhcGklMkZzYWxlcyUyRnJvdXRlLnRzJmFwcERpcj1DJTNBJTVDVXNlcnMlNUNVc3VhcmlvJTVDQUtJTEVTJTVDR0FNRSUyMFdFQiUyMEFQUCU1Q1NQTElUJTVDdGhlZ2FtZSU1Q2FwcCZwYWdlRXh0ZW5zaW9ucz10c3gmcGFnZUV4dGVuc2lvbnM9dHMmcGFnZUV4dGVuc2lvbnM9anN4JnBhZ2VFeHRlbnNpb25zPWpzJnJvb3REaXI9QyUzQSU1Q1VzZXJzJTVDVXN1YXJpbyU1Q0FLSUxFUyU1Q0dBTUUlMjBXRUIlMjBBUFAlNUNTUExJVCU1Q3RoZWdhbWUmaXNEZXY9dHJ1ZSZ0c2NvbmZpZ1BhdGg9dHNjb25maWcuanNvbiZiYXNlUGF0aD0mYXNzZXRQcmVmaXg9Jm5leHRDb25maWdPdXRwdXQ9JnByZWZlcnJlZFJlZ2lvbj0mbWlkZGxld2FyZUNvbmZpZz1lMzAlM0QhIiwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7Ozs7OztBQUFzRztBQUN2QztBQUNjO0FBQ21DO0FBQ2hIO0FBQ0E7QUFDQTtBQUNBLHdCQUF3QixnSEFBbUI7QUFDM0M7QUFDQSxjQUFjLHlFQUFTO0FBQ3ZCO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQSxZQUFZO0FBQ1osQ0FBQztBQUNEO0FBQ0E7QUFDQTtBQUNBLFFBQVEsaUVBQWlFO0FBQ3pFO0FBQ0E7QUFDQSxXQUFXLDRFQUFXO0FBQ3RCO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDdUg7O0FBRXZIIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vdGhlZ2FtZS1hZG1pbi8/OWM5NCJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBBcHBSb3V0ZVJvdXRlTW9kdWxlIH0gZnJvbSBcIm5leHQvZGlzdC9zZXJ2ZXIvZnV0dXJlL3JvdXRlLW1vZHVsZXMvYXBwLXJvdXRlL21vZHVsZS5jb21waWxlZFwiO1xuaW1wb3J0IHsgUm91dGVLaW5kIH0gZnJvbSBcIm5leHQvZGlzdC9zZXJ2ZXIvZnV0dXJlL3JvdXRlLWtpbmRcIjtcbmltcG9ydCB7IHBhdGNoRmV0Y2ggYXMgX3BhdGNoRmV0Y2ggfSBmcm9tIFwibmV4dC9kaXN0L3NlcnZlci9saWIvcGF0Y2gtZmV0Y2hcIjtcbmltcG9ydCAqIGFzIHVzZXJsYW5kIGZyb20gXCJDOlxcXFxVc2Vyc1xcXFxVc3VhcmlvXFxcXEFLSUxFU1xcXFxHQU1FIFdFQiBBUFBcXFxcU1BMSVRcXFxcdGhlZ2FtZVxcXFxhcHBcXFxcYXBpXFxcXHNhbGVzXFxcXHJvdXRlLnRzXCI7XG4vLyBXZSBpbmplY3QgdGhlIG5leHRDb25maWdPdXRwdXQgaGVyZSBzbyB0aGF0IHdlIGNhbiB1c2UgdGhlbSBpbiB0aGUgcm91dGVcbi8vIG1vZHVsZS5cbmNvbnN0IG5leHRDb25maWdPdXRwdXQgPSBcIlwiXG5jb25zdCByb3V0ZU1vZHVsZSA9IG5ldyBBcHBSb3V0ZVJvdXRlTW9kdWxlKHtcbiAgICBkZWZpbml0aW9uOiB7XG4gICAgICAgIGtpbmQ6IFJvdXRlS2luZC5BUFBfUk9VVEUsXG4gICAgICAgIHBhZ2U6IFwiL2FwaS9zYWxlcy9yb3V0ZVwiLFxuICAgICAgICBwYXRobmFtZTogXCIvYXBpL3NhbGVzXCIsXG4gICAgICAgIGZpbGVuYW1lOiBcInJvdXRlXCIsXG4gICAgICAgIGJ1bmRsZVBhdGg6IFwiYXBwL2FwaS9zYWxlcy9yb3V0ZVwiXG4gICAgfSxcbiAgICByZXNvbHZlZFBhZ2VQYXRoOiBcIkM6XFxcXFVzZXJzXFxcXFVzdWFyaW9cXFxcQUtJTEVTXFxcXEdBTUUgV0VCIEFQUFxcXFxTUExJVFxcXFx0aGVnYW1lXFxcXGFwcFxcXFxhcGlcXFxcc2FsZXNcXFxccm91dGUudHNcIixcbiAgICBuZXh0Q29uZmlnT3V0cHV0LFxuICAgIHVzZXJsYW5kXG59KTtcbi8vIFB1bGwgb3V0IHRoZSBleHBvcnRzIHRoYXQgd2UgbmVlZCB0byBleHBvc2UgZnJvbSB0aGUgbW9kdWxlLiBUaGlzIHNob3VsZFxuLy8gYmUgZWxpbWluYXRlZCB3aGVuIHdlJ3ZlIG1vdmVkIHRoZSBvdGhlciByb3V0ZXMgdG8gdGhlIG5ldyBmb3JtYXQuIFRoZXNlXG4vLyBhcmUgdXNlZCB0byBob29rIGludG8gdGhlIHJvdXRlLlxuY29uc3QgeyByZXF1ZXN0QXN5bmNTdG9yYWdlLCBzdGF0aWNHZW5lcmF0aW9uQXN5bmNTdG9yYWdlLCBzZXJ2ZXJIb29rcyB9ID0gcm91dGVNb2R1bGU7XG5jb25zdCBvcmlnaW5hbFBhdGhuYW1lID0gXCIvYXBpL3NhbGVzL3JvdXRlXCI7XG5mdW5jdGlvbiBwYXRjaEZldGNoKCkge1xuICAgIHJldHVybiBfcGF0Y2hGZXRjaCh7XG4gICAgICAgIHNlcnZlckhvb2tzLFxuICAgICAgICBzdGF0aWNHZW5lcmF0aW9uQXN5bmNTdG9yYWdlXG4gICAgfSk7XG59XG5leHBvcnQgeyByb3V0ZU1vZHVsZSwgcmVxdWVzdEFzeW5jU3RvcmFnZSwgc3RhdGljR2VuZXJhdGlvbkFzeW5jU3RvcmFnZSwgc2VydmVySG9va3MsIG9yaWdpbmFsUGF0aG5hbWUsIHBhdGNoRmV0Y2gsICB9O1xuXG4vLyMgc291cmNlTWFwcGluZ1VSTD1hcHAtcm91dGUuanMubWFwIl0sIm5hbWVzIjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fsales%2Froute&page=%2Fapi%2Fsales%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fsales%2Froute.ts&appDir=C%3A%5CUsers%5CUsuario%5CAKILES%5CGAME%20WEB%20APP%5CSPLIT%5Cthegame%5Capp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=C%3A%5CUsers%5CUsuario%5CAKILES%5CGAME%20WEB%20APP%5CSPLIT%5Cthegame&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!\n");

/***/ }),

/***/ "(rsc)/./app/api/sales/route.ts":
/*!********************************!*\
  !*** ./app/api/sales/route.ts ***!
  \********************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   GET: () => (/* binding */ GET),\n/* harmony export */   POST: () => (/* binding */ POST)\n/* harmony export */ });\n/* harmony import */ var next_server__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/server */ \"(rsc)/./node_modules/next/dist/api/server.js\");\n/* harmony import */ var uuid__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! uuid */ \"(rsc)/./node_modules/uuid/dist/esm/v4.js\");\n/* harmony import */ var _data_store_datastore__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @/data-store/datastore */ \"(rsc)/./data-store/datastore.ts\");\n/* harmony import */ var _lib_api_auth__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @/lib/api-auth */ \"(rsc)/./lib/api-auth.ts\");\n// app/api/sales/route.ts\n\n\n\n\nasync function GET(req) {\n    if (!await (0,_lib_api_auth__WEBPACK_IMPORTED_MODULE_2__.requireAdminAuth)(req)) return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n        error: \"Unauthorized\"\n    }, {\n        status: 401\n    });\n    const sales = await (0,_data_store_datastore__WEBPACK_IMPORTED_MODULE_1__.getAllSales)();\n    return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json(sales);\n}\nasync function POST(req) {\n    if (!await (0,_lib_api_auth__WEBPACK_IMPORTED_MODULE_2__.requireAdminAuth)(req)) return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n        error: \"Unauthorized\"\n    }, {\n        status: 401\n    });\n    const body = await req.json();\n    const sale = {\n        ...body,\n        id: body.id || (0,uuid__WEBPACK_IMPORTED_MODULE_3__[\"default\"])(),\n        createdAt: body.createdAt ? new Date(body.createdAt) : new Date(),\n        updatedAt: new Date(),\n        links: body.links || []\n    };\n    const saved = await (0,_data_store_datastore__WEBPACK_IMPORTED_MODULE_1__.upsertSale)(sale);\n    return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json(saved);\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9hcHAvYXBpL3NhbGVzL3JvdXRlLnRzIiwibWFwcGluZ3MiOiI7Ozs7Ozs7OztBQUFBLHlCQUF5QjtBQUMrQjtBQUN0QjtBQUUrQjtBQUNmO0FBRTNDLGVBQWVNLElBQUlDLEdBQWdCO0lBQ3hDLElBQUksQ0FBRSxNQUFNRiwrREFBZ0JBLENBQUNFLE1BQU8sT0FBT1AscURBQVlBLENBQUNRLElBQUksQ0FBQztRQUFFQyxPQUFPO0lBQWUsR0FBRztRQUFFQyxRQUFRO0lBQUk7SUFDdEcsTUFBTUMsUUFBUSxNQUFNUixrRUFBV0E7SUFDL0IsT0FBT0gscURBQVlBLENBQUNRLElBQUksQ0FBQ0c7QUFDM0I7QUFFTyxlQUFlQyxLQUFLTCxHQUFnQjtJQUN6QyxJQUFJLENBQUUsTUFBTUYsK0RBQWdCQSxDQUFDRSxNQUFPLE9BQU9QLHFEQUFZQSxDQUFDUSxJQUFJLENBQUM7UUFBRUMsT0FBTztJQUFlLEdBQUc7UUFBRUMsUUFBUTtJQUFJO0lBQ3RHLE1BQU1HLE9BQVEsTUFBTU4sSUFBSUMsSUFBSTtJQUM1QixNQUFNTSxPQUFhO1FBQ2pCLEdBQUdELElBQUk7UUFDUEUsSUFBSUYsS0FBS0UsRUFBRSxJQUFJYixnREFBSUE7UUFDbkJjLFdBQVdILEtBQUtHLFNBQVMsR0FBRyxJQUFJQyxLQUFLSixLQUFLRyxTQUFTLElBQUksSUFBSUM7UUFDM0RDLFdBQVcsSUFBSUQ7UUFDZkUsT0FBT04sS0FBS00sS0FBSyxJQUFJLEVBQUU7SUFDekI7SUFDQSxNQUFNQyxRQUFRLE1BQU1oQixpRUFBVUEsQ0FBQ1U7SUFDL0IsT0FBT2QscURBQVlBLENBQUNRLElBQUksQ0FBQ1k7QUFDM0IiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly90aGVnYW1lLWFkbWluLy4vYXBwL2FwaS9zYWxlcy9yb3V0ZS50cz81MGNkIl0sInNvdXJjZXNDb250ZW50IjpbIi8vIGFwcC9hcGkvc2FsZXMvcm91dGUudHNcclxuaW1wb3J0IHsgTmV4dFJlc3BvbnNlLCBOZXh0UmVxdWVzdCB9IGZyb20gJ25leHQvc2VydmVyJztcclxuaW1wb3J0IHsgdjQgYXMgdXVpZCB9IGZyb20gJ3V1aWQnO1xyXG5pbXBvcnQgdHlwZSB7IFNhbGUgfSBmcm9tICdAL3R5cGVzL2VudGl0aWVzJztcclxuaW1wb3J0IHsgZ2V0QWxsU2FsZXMsIHVwc2VydFNhbGUgfSBmcm9tICdAL2RhdGEtc3RvcmUvZGF0YXN0b3JlJztcclxuaW1wb3J0IHsgcmVxdWlyZUFkbWluQXV0aCB9IGZyb20gJ0AvbGliL2FwaS1hdXRoJztcclxuXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBHRVQocmVxOiBOZXh0UmVxdWVzdCkge1xyXG4gIGlmICghKGF3YWl0IHJlcXVpcmVBZG1pbkF1dGgocmVxKSkpIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbih7IGVycm9yOiAnVW5hdXRob3JpemVkJyB9LCB7IHN0YXR1czogNDAxIH0pO1xyXG4gIGNvbnN0IHNhbGVzID0gYXdhaXQgZ2V0QWxsU2FsZXMoKTtcclxuICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oc2FsZXMpO1xyXG59XHJcblxyXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gUE9TVChyZXE6IE5leHRSZXF1ZXN0KSB7XHJcbiAgaWYgKCEoYXdhaXQgcmVxdWlyZUFkbWluQXV0aChyZXEpKSkgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKHsgZXJyb3I6ICdVbmF1dGhvcml6ZWQnIH0sIHsgc3RhdHVzOiA0MDEgfSk7XHJcbiAgY29uc3QgYm9keSA9IChhd2FpdCByZXEuanNvbigpKSBhcyBTYWxlO1xyXG4gIGNvbnN0IHNhbGU6IFNhbGUgPSB7IFxyXG4gICAgLi4uYm9keSwgXHJcbiAgICBpZDogYm9keS5pZCB8fCB1dWlkKCksIFxyXG4gICAgY3JlYXRlZEF0OiBib2R5LmNyZWF0ZWRBdCA/IG5ldyBEYXRlKGJvZHkuY3JlYXRlZEF0KSA6IG5ldyBEYXRlKCksIFxyXG4gICAgdXBkYXRlZEF0OiBuZXcgRGF0ZSgpLCBcclxuICAgIGxpbmtzOiBib2R5LmxpbmtzIHx8IFtdIFxyXG4gIH07XHJcbiAgY29uc3Qgc2F2ZWQgPSBhd2FpdCB1cHNlcnRTYWxlKHNhbGUpO1xyXG4gIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbihzYXZlZCk7XHJcbn1cclxuIl0sIm5hbWVzIjpbIk5leHRSZXNwb25zZSIsInY0IiwidXVpZCIsImdldEFsbFNhbGVzIiwidXBzZXJ0U2FsZSIsInJlcXVpcmVBZG1pbkF1dGgiLCJHRVQiLCJyZXEiLCJqc29uIiwiZXJyb3IiLCJzdGF0dXMiLCJzYWxlcyIsIlBPU1QiLCJib2R5Iiwic2FsZSIsImlkIiwiY3JlYXRlZEF0IiwiRGF0ZSIsInVwZGF0ZWRBdCIsImxpbmtzIiwic2F2ZWQiXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./app/api/sales/route.ts\n");

/***/ }),

/***/ "(rsc)/./data-store/datastore.ts":
/*!*********************************!*\
  !*** ./data-store/datastore.ts ***!
  \*********************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   getAllCharacters: () => (/* binding */ getAllCharacters),\n/* harmony export */   getAllFinancials: () => (/* binding */ getAllFinancials),\n/* harmony export */   getAllItems: () => (/* binding */ getAllItems),\n/* harmony export */   getAllPlayers: () => (/* binding */ getAllPlayers),\n/* harmony export */   getAllSales: () => (/* binding */ getAllSales),\n/* harmony export */   getAllSettlements: () => (/* binding */ getAllSettlements),\n/* harmony export */   getAllSites: () => (/* binding */ getAllSites),\n/* harmony export */   getAllTasks: () => (/* binding */ getAllTasks),\n/* harmony export */   getCharacterById: () => (/* binding */ getCharacterById),\n/* harmony export */   getCompanyAssets: () => (/* binding */ getCompanyAssets),\n/* harmony export */   getConversionRates: () => (/* binding */ getConversionRates),\n/* harmony export */   getFinancialById: () => (/* binding */ getFinancialById),\n/* harmony export */   getItemById: () => (/* binding */ getItemById),\n/* harmony export */   getPersonalAssets: () => (/* binding */ getPersonalAssets),\n/* harmony export */   getPlayerById: () => (/* binding */ getPlayerById),\n/* harmony export */   getPointsConversionRates: () => (/* binding */ getPointsConversionRates),\n/* harmony export */   getSaleById: () => (/* binding */ getSaleById),\n/* harmony export */   getSettlementById: () => (/* binding */ getSettlementById),\n/* harmony export */   getSiteById: () => (/* binding */ getSiteById),\n/* harmony export */   getSitesByRadius: () => (/* binding */ getSitesByRadius),\n/* harmony export */   getSitesBySettlement: () => (/* binding */ getSitesBySettlement),\n/* harmony export */   getTaskById: () => (/* binding */ getTaskById),\n/* harmony export */   removeCharacter: () => (/* binding */ removeCharacter),\n/* harmony export */   removeFinancial: () => (/* binding */ removeFinancial),\n/* harmony export */   removeItem: () => (/* binding */ removeItem),\n/* harmony export */   removePlayer: () => (/* binding */ removePlayer),\n/* harmony export */   removeSale: () => (/* binding */ removeSale),\n/* harmony export */   removeSettlement: () => (/* binding */ removeSettlement),\n/* harmony export */   removeSite: () => (/* binding */ removeSite),\n/* harmony export */   removeTask: () => (/* binding */ removeTask),\n/* harmony export */   saveCompanyAssets: () => (/* binding */ saveCompanyAssets),\n/* harmony export */   saveConversionRates: () => (/* binding */ saveConversionRates),\n/* harmony export */   savePersonalAssets: () => (/* binding */ savePersonalAssets),\n/* harmony export */   savePointsConversionRates: () => (/* binding */ savePointsConversionRates),\n/* harmony export */   upsertCharacter: () => (/* binding */ upsertCharacter),\n/* harmony export */   upsertFinancial: () => (/* binding */ upsertFinancial),\n/* harmony export */   upsertItem: () => (/* binding */ upsertItem),\n/* harmony export */   upsertPlayer: () => (/* binding */ upsertPlayer),\n/* harmony export */   upsertSale: () => (/* binding */ upsertSale),\n/* harmony export */   upsertSettlement: () => (/* binding */ upsertSettlement),\n/* harmony export */   upsertSite: () => (/* binding */ upsertSite),\n/* harmony export */   upsertTask: () => (/* binding */ upsertTask)\n/* harmony export */ });\n/* harmony import */ var _types_enums__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @/types/enums */ \"(rsc)/./types/enums.ts\");\n/* harmony import */ var _repositories_task_repo__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./repositories/task.repo */ \"(rsc)/./data-store/repositories/task.repo.ts\");\n/* harmony import */ var _repositories_item_repo__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./repositories/item.repo */ \"(rsc)/./data-store/repositories/item.repo.ts\");\n/* harmony import */ var _repositories_financial_repo__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./repositories/financial.repo */ \"(rsc)/./data-store/repositories/financial.repo.ts\");\n/* harmony import */ var _repositories_sale_repo__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./repositories/sale.repo */ \"(rsc)/./data-store/repositories/sale.repo.ts\");\n/* harmony import */ var _repositories_character_repo__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ./repositories/character.repo */ \"(rsc)/./data-store/repositories/character.repo.ts\");\n/* harmony import */ var _repositories_player_repo__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ./repositories/player.repo */ \"(rsc)/./data-store/repositories/player.repo.ts\");\n/* harmony import */ var _repositories_site_repo__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ./repositories/site.repo */ \"(rsc)/./data-store/repositories/site.repo.ts\");\n/* harmony import */ var _kv__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ./kv */ \"(rsc)/./data-store/kv.ts\");\n/* harmony import */ var _workflows_entities_workflows_task_workflow__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! @/workflows/entities-workflows/task.workflow */ \"(rsc)/./workflows/entities-workflows/task.workflow.ts\");\n/* harmony import */ var _workflows_entities_workflows_item_workflow__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! @/workflows/entities-workflows/item.workflow */ \"(rsc)/./workflows/entities-workflows/item.workflow.ts\");\n/* harmony import */ var _workflows_entities_workflows_financial_workflow__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! @/workflows/entities-workflows/financial.workflow */ \"(rsc)/./workflows/entities-workflows/financial.workflow.ts\");\n/* harmony import */ var _workflows_entities_workflows_sale_workflow__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(/*! @/workflows/entities-workflows/sale.workflow */ \"(rsc)/./workflows/entities-workflows/sale.workflow.ts\");\n/* harmony import */ var _workflows_entities_workflows_character_workflow__WEBPACK_IMPORTED_MODULE_13__ = __webpack_require__(/*! @/workflows/entities-workflows/character.workflow */ \"(rsc)/./workflows/entities-workflows/character.workflow.ts\");\n/* harmony import */ var _workflows_entities_workflows_player_workflow__WEBPACK_IMPORTED_MODULE_14__ = __webpack_require__(/*! @/workflows/entities-workflows/player.workflow */ \"(rsc)/./workflows/entities-workflows/player.workflow.ts\");\n/* harmony import */ var _workflows_entities_workflows_site_workflow__WEBPACK_IMPORTED_MODULE_15__ = __webpack_require__(/*! @/workflows/entities-workflows/site.workflow */ \"(rsc)/./workflows/entities-workflows/site.workflow.ts\");\n/* harmony import */ var _links_links_workflows__WEBPACK_IMPORTED_MODULE_16__ = __webpack_require__(/*! @/links/links-workflows */ \"(rsc)/./links/links-workflows.ts\");\n// data-store/datastore.ts\n// Orchestration layer: repositories → workflows → links → logging\n\n\n\n\n\n\n\n\n\n// Import workflow functions individually to avoid TypeScript issues\n\n\n\n\n\n\n\n\n// TASKS\nasync function upsertTask(task) {\n    const previous = await (0,_repositories_task_repo__WEBPACK_IMPORTED_MODULE_1__.getTaskById)(task.id);\n    const saved = await (0,_repositories_task_repo__WEBPACK_IMPORTED_MODULE_1__.upsertTask)(task);\n    await (0,_workflows_entities_workflows_task_workflow__WEBPACK_IMPORTED_MODULE_9__.onTaskUpsert)(saved, previous || undefined);\n    await (0,_links_links_workflows__WEBPACK_IMPORTED_MODULE_16__.processLinkEntity)(saved, _types_enums__WEBPACK_IMPORTED_MODULE_0__.EntityType.TASK);\n    return saved;\n}\nasync function getAllTasks() {\n    return await (0,_repositories_task_repo__WEBPACK_IMPORTED_MODULE_1__.getAllTasks)();\n}\nasync function getTaskById(id) {\n    return await (0,_repositories_task_repo__WEBPACK_IMPORTED_MODULE_1__.getTaskById)(id);\n}\nasync function removeTask(id) {\n    const existing = await (0,_repositories_task_repo__WEBPACK_IMPORTED_MODULE_1__.getTaskById)(id);\n    await (0,_repositories_task_repo__WEBPACK_IMPORTED_MODULE_1__.deleteTask)(id);\n    if (existing) {\n        // Call task deletion workflow for cleanup\n        const { removeTaskLogEntriesOnDelete } = await Promise.resolve(/*! import() */).then(__webpack_require__.bind(__webpack_require__, /*! @/workflows/entities-workflows/task.workflow */ \"(rsc)/./workflows/entities-workflows/task.workflow.ts\"));\n        await removeTaskLogEntriesOnDelete(id);\n    }\n}\n// ITEMS\nasync function upsertItem(item) {\n    const previous = await (0,_repositories_item_repo__WEBPACK_IMPORTED_MODULE_2__.getItemById)(item.id);\n    const saved = await (0,_repositories_item_repo__WEBPACK_IMPORTED_MODULE_2__.upsertItem)(item);\n    await (0,_workflows_entities_workflows_item_workflow__WEBPACK_IMPORTED_MODULE_10__.onItemUpsert)(saved, previous || undefined);\n    await (0,_links_links_workflows__WEBPACK_IMPORTED_MODULE_16__.processLinkEntity)(saved, _types_enums__WEBPACK_IMPORTED_MODULE_0__.EntityType.ITEM);\n    return saved;\n}\nasync function getAllItems() {\n    return await (0,_repositories_item_repo__WEBPACK_IMPORTED_MODULE_2__.getAllItems)();\n}\nasync function getItemById(id) {\n    return await (0,_repositories_item_repo__WEBPACK_IMPORTED_MODULE_2__.getItemById)(id);\n}\nasync function removeItem(id) {\n    const existing = await (0,_repositories_item_repo__WEBPACK_IMPORTED_MODULE_2__.getItemById)(id);\n    await (0,_repositories_item_repo__WEBPACK_IMPORTED_MODULE_2__.deleteItem)(id);\n    if (existing) {\n        // Call item deletion workflow for cleanup\n        const { removeItemEffectsOnDelete } = await Promise.resolve(/*! import() */).then(__webpack_require__.bind(__webpack_require__, /*! @/workflows/entities-workflows/item.workflow */ \"(rsc)/./workflows/entities-workflows/item.workflow.ts\"));\n        await removeItemEffectsOnDelete(id);\n    }\n}\n// FINANCIALS\nasync function upsertFinancial(financial) {\n    const previous = await (0,_repositories_financial_repo__WEBPACK_IMPORTED_MODULE_3__.getFinancialById)(financial.id);\n    const saved = await (0,_repositories_financial_repo__WEBPACK_IMPORTED_MODULE_3__.upsertFinancial)(financial);\n    await (0,_workflows_entities_workflows_financial_workflow__WEBPACK_IMPORTED_MODULE_11__.onFinancialUpsert)(saved, previous || undefined);\n    await (0,_links_links_workflows__WEBPACK_IMPORTED_MODULE_16__.processLinkEntity)(saved, _types_enums__WEBPACK_IMPORTED_MODULE_0__.EntityType.FINANCIAL);\n    return saved;\n}\nasync function getAllFinancials() {\n    return await (0,_repositories_financial_repo__WEBPACK_IMPORTED_MODULE_3__.getAllFinancials)();\n}\nasync function getFinancialById(id) {\n    return await (0,_repositories_financial_repo__WEBPACK_IMPORTED_MODULE_3__.getFinancialById)(id);\n}\nasync function removeFinancial(id) {\n    const existing = await (0,_repositories_financial_repo__WEBPACK_IMPORTED_MODULE_3__.getFinancialById)(id);\n    await (0,_repositories_financial_repo__WEBPACK_IMPORTED_MODULE_3__.deleteFinancial)(id);\n    if (existing) {\n        // Call financial deletion workflow for cleanup\n        const { removeRecordEffectsOnDelete } = await Promise.resolve(/*! import() */).then(__webpack_require__.bind(__webpack_require__, /*! @/workflows/entities-workflows/financial.workflow */ \"(rsc)/./workflows/entities-workflows/financial.workflow.ts\"));\n        await removeRecordEffectsOnDelete(id);\n    }\n}\n// SALES\nasync function upsertSale(sale) {\n    const previous = await (0,_repositories_sale_repo__WEBPACK_IMPORTED_MODULE_4__.getSaleById)(sale.id);\n    const saved = await (0,_repositories_sale_repo__WEBPACK_IMPORTED_MODULE_4__.upsertSale)(sale);\n    await (0,_workflows_entities_workflows_sale_workflow__WEBPACK_IMPORTED_MODULE_12__.onSaleUpsert)(saved, previous || undefined);\n    await (0,_links_links_workflows__WEBPACK_IMPORTED_MODULE_16__.processLinkEntity)(saved, _types_enums__WEBPACK_IMPORTED_MODULE_0__.EntityType.SALE);\n    return saved;\n}\nasync function getAllSales() {\n    return await (0,_repositories_sale_repo__WEBPACK_IMPORTED_MODULE_4__.getAllSales)();\n}\nasync function getSaleById(id) {\n    return await (0,_repositories_sale_repo__WEBPACK_IMPORTED_MODULE_4__.getSaleById)(id);\n}\nasync function removeSale(id) {\n    const existing = await (0,_repositories_sale_repo__WEBPACK_IMPORTED_MODULE_4__.getSaleById)(id);\n    await (0,_repositories_sale_repo__WEBPACK_IMPORTED_MODULE_4__.deleteSale)(id);\n    if (existing) {\n        // Call sale deletion workflow for cleanup\n        const { removeSaleEffectsOnDelete } = await Promise.resolve(/*! import() */).then(__webpack_require__.bind(__webpack_require__, /*! @/workflows/entities-workflows/sale.workflow */ \"(rsc)/./workflows/entities-workflows/sale.workflow.ts\"));\n        await removeSaleEffectsOnDelete(id);\n    }\n}\n// CHARACTERS\nasync function upsertCharacter(character) {\n    const previous = await (0,_repositories_character_repo__WEBPACK_IMPORTED_MODULE_5__.getCharacterById)(character.id);\n    const saved = await (0,_repositories_character_repo__WEBPACK_IMPORTED_MODULE_5__.upsertCharacter)(character);\n    await (0,_workflows_entities_workflows_character_workflow__WEBPACK_IMPORTED_MODULE_13__.onCharacterUpsert)(saved, previous || undefined);\n    await (0,_links_links_workflows__WEBPACK_IMPORTED_MODULE_16__.processLinkEntity)(saved, _types_enums__WEBPACK_IMPORTED_MODULE_0__.EntityType.CHARACTER);\n    return saved;\n}\nasync function getAllCharacters() {\n    return await (0,_repositories_character_repo__WEBPACK_IMPORTED_MODULE_5__.getAllCharacters)();\n}\nasync function getCharacterById(id) {\n    return await (0,_repositories_character_repo__WEBPACK_IMPORTED_MODULE_5__.getCharacterById)(id);\n}\nasync function removeCharacter(id) {\n    const existing = await (0,_repositories_character_repo__WEBPACK_IMPORTED_MODULE_5__.getCharacterById)(id);\n    await (0,_repositories_character_repo__WEBPACK_IMPORTED_MODULE_5__.deleteCharacter)(id);\n    if (existing) {\n        // Call character deletion workflow for cleanup\n        const { removeCharacterEffectsOnDelete } = await Promise.resolve(/*! import() */).then(__webpack_require__.bind(__webpack_require__, /*! @/workflows/entities-workflows/character.workflow */ \"(rsc)/./workflows/entities-workflows/character.workflow.ts\"));\n        await removeCharacterEffectsOnDelete(id);\n    }\n}\n// PLAYERS\nasync function upsertPlayer(player) {\n    const previous = await (0,_repositories_player_repo__WEBPACK_IMPORTED_MODULE_6__.getPlayerById)(player.id);\n    const saved = await (0,_repositories_player_repo__WEBPACK_IMPORTED_MODULE_6__.upsertPlayer)(player);\n    await (0,_workflows_entities_workflows_player_workflow__WEBPACK_IMPORTED_MODULE_14__.onPlayerUpsert)(saved, previous || undefined);\n    await (0,_links_links_workflows__WEBPACK_IMPORTED_MODULE_16__.processLinkEntity)(saved, _types_enums__WEBPACK_IMPORTED_MODULE_0__.EntityType.PLAYER);\n    return saved;\n}\nasync function getAllPlayers() {\n    return await (0,_repositories_player_repo__WEBPACK_IMPORTED_MODULE_6__.getAllPlayers)();\n}\nasync function getPlayerById(id) {\n    return await (0,_repositories_player_repo__WEBPACK_IMPORTED_MODULE_6__.getPlayerById)(id);\n}\nasync function removePlayer(id) {\n    const existing = await (0,_repositories_player_repo__WEBPACK_IMPORTED_MODULE_6__.getPlayerById)(id);\n    await (0,_repositories_player_repo__WEBPACK_IMPORTED_MODULE_6__.deletePlayer)(id);\n    if (existing) {\n        // Call player deletion workflow for cleanup\n        const { removePlayerEffectsOnDelete } = await Promise.resolve(/*! import() */).then(__webpack_require__.bind(__webpack_require__, /*! @/workflows/entities-workflows/player.workflow */ \"(rsc)/./workflows/entities-workflows/player.workflow.ts\"));\n        await removePlayerEffectsOnDelete(id);\n    }\n}\n// SITES\nasync function upsertSite(site) {\n    const previous = await (0,_repositories_site_repo__WEBPACK_IMPORTED_MODULE_7__.getSiteById)(site.id);\n    const saved = await (0,_repositories_site_repo__WEBPACK_IMPORTED_MODULE_7__.upsertSite)(site);\n    await (0,_workflows_entities_workflows_site_workflow__WEBPACK_IMPORTED_MODULE_15__.onSiteUpsert)(saved, previous || undefined);\n    await (0,_links_links_workflows__WEBPACK_IMPORTED_MODULE_16__.processLinkEntity)(saved, _types_enums__WEBPACK_IMPORTED_MODULE_0__.EntityType.SITE);\n    return saved;\n}\nasync function getAllSites() {\n    return await (0,_repositories_site_repo__WEBPACK_IMPORTED_MODULE_7__.getAllSites)();\n}\nasync function getSiteById(id) {\n    return await (0,_repositories_site_repo__WEBPACK_IMPORTED_MODULE_7__.getSiteById)(id);\n}\nasync function removeSite(id) {\n    const existing = await (0,_repositories_site_repo__WEBPACK_IMPORTED_MODULE_7__.getSiteById)(id);\n    await (0,_repositories_site_repo__WEBPACK_IMPORTED_MODULE_7__.deleteSite)(id);\n    if (existing) {\n        // Call site deletion workflow for cleanup\n        const { removeSiteEffectsOnDelete } = await Promise.resolve(/*! import() */).then(__webpack_require__.bind(__webpack_require__, /*! @/workflows/entities-workflows/site.workflow */ \"(rsc)/./workflows/entities-workflows/site.workflow.ts\"));\n        await removeSiteEffectsOnDelete(id);\n    }\n}\n// ============================================================================\n// SETTLEMENT METHODS (Reference data for Sites)\n// ============================================================================\nasync function getAllSettlements() {\n    return await (0,_repositories_site_repo__WEBPACK_IMPORTED_MODULE_7__.getAllSettlements)();\n}\nasync function getSettlementById(id) {\n    return await (0,_repositories_site_repo__WEBPACK_IMPORTED_MODULE_7__.getSettlementById)(id);\n}\nasync function upsertSettlement(settlement) {\n    return await (0,_repositories_site_repo__WEBPACK_IMPORTED_MODULE_7__.upsertSettlement)(settlement);\n}\nasync function removeSettlement(id) {\n    await (0,_repositories_site_repo__WEBPACK_IMPORTED_MODULE_7__.removeSettlement)(id);\n}\n// ============================================================================\n// SITE QUERY METHODS\n// ============================================================================\nasync function getSitesBySettlement(settlementId) {\n    return await (0,_repositories_site_repo__WEBPACK_IMPORTED_MODULE_7__.getSitesBySettlement)(settlementId);\n}\nasync function getSitesByRadius(centerLat, centerLng, radiusMeters) {\n    return await (0,_repositories_site_repo__WEBPACK_IMPORTED_MODULE_7__.getSitesByRadius)(centerLat, centerLng, radiusMeters);\n}\n// POINTS CONVERSION RATES\nasync function getPointsConversionRates() {\n    const rates = await (0,_kv__WEBPACK_IMPORTED_MODULE_8__.kvGet)(\"data:points-conversion-rates\");\n    return rates || {\n        hpToJ$: 10,\n        fpToJ$: 15,\n        rpToJ$: 12,\n        xpToJ$: 3,\n        j$ToUSD: 10\n    };\n}\nasync function savePointsConversionRates(rates) {\n    await (0,_kv__WEBPACK_IMPORTED_MODULE_8__.kvSet)(\"data:points-conversion-rates\", rates);\n}\n// COMPANY ASSETS\nasync function getCompanyAssets() {\n    const assets = await (0,_kv__WEBPACK_IMPORTED_MODULE_8__.kvGet)(\"data:company-assets\");\n    return assets || {\n        cash: 0,\n        bank: 0,\n        bitcoin: 0,\n        toCharge: 0,\n        toPay: 0,\n        companyJ$: 0,\n        materials: {\n            value: 0,\n            cost: 0\n        },\n        equipment: {\n            value: 0,\n            cost: 0\n        },\n        artworks: {\n            value: 0,\n            cost: 0\n        },\n        prints: {\n            value: 0,\n            cost: 0\n        },\n        stickers: {\n            value: 0,\n            cost: 0\n        },\n        merch: {\n            value: 0,\n            cost: 0\n        }\n    };\n}\nasync function saveCompanyAssets(assets) {\n    await (0,_kv__WEBPACK_IMPORTED_MODULE_8__.kvSet)(\"data:company-assets\", assets);\n}\n// PERSONAL ASSETS\nasync function getPersonalAssets() {\n    const assets = await (0,_kv__WEBPACK_IMPORTED_MODULE_8__.kvGet)(\"data:personal-assets\");\n    return assets || {\n        cash: 0,\n        bank: 0,\n        bitcoin: 0,\n        crypto: 0,\n        toCharge: 0,\n        toPay: 0,\n        personalJ$: 0,\n        vehicle: 0,\n        properties: 0,\n        nfts: 0,\n        other: 0\n    };\n}\nasync function savePersonalAssets(assets) {\n    await (0,_kv__WEBPACK_IMPORTED_MODULE_8__.kvSet)(\"data:personal-assets\", assets);\n}\n// CONVERSION RATES\nasync function getConversionRates() {\n    const rates = await (0,_kv__WEBPACK_IMPORTED_MODULE_8__.kvGet)(\"data:conversion-rates\");\n    return rates || {\n        hpToJ$: 10,\n        fpToJ$: 15,\n        rpToJ$: 12,\n        xpToJ$: 3,\n        j$ToUSD: 10,\n        colonesToUsd: 500,\n        bitcoinToUsd: 50000,\n        jungleCoinsToUsd: 0.1\n    };\n}\nasync function saveConversionRates(rates) {\n    await (0,_kv__WEBPACK_IMPORTED_MODULE_8__.kvSet)(\"data:conversion-rates\", rates);\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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Q1osZUFBZXdCO0lBQ3BCLE1BQU1oQyxRQUFRLE1BQU1qRCwwQ0FBS0EsQ0FBQztJQUMxQixPQUFPaUQsU0FBUztRQUNkQyxRQUFRO1FBQ1JDLFFBQVE7UUFDUkMsUUFBUTtRQUNSQyxRQUFRO1FBQ1JDLFNBQVM7UUFDVDRCLGNBQWM7UUFDZEMsY0FBYztRQUNkQyxrQkFBa0I7SUFDcEI7QUFDRjtBQUVPLGVBQWVDLG9CQUFvQnBDLEtBQVU7SUFDbEQsTUFBTWhELDBDQUFLQSxDQUFDLHlCQUF5QmdEO0FBQ3ZDIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vdGhlZ2FtZS1hZG1pbi8uL2RhdGEtc3RvcmUvZGF0YXN0b3JlLnRzPzhkMmYiXSwic291cmNlc0NvbnRlbnQiOlsiLy8gZGF0YS1zdG9yZS9kYXRhc3RvcmUudHNcclxuLy8gT3JjaGVzdHJhdGlvbiBsYXllcjogcmVwb3NpdG9yaWVzIOKGkiB3b3JrZmxvd3Mg4oaSIGxpbmtzIOKGkiBsb2dnaW5nXHJcblxyXG5pbXBvcnQgdHlwZSB7IFRhc2ssIEl0ZW0sIEZpbmFuY2lhbFJlY29yZCwgU2FsZSwgQ2hhcmFjdGVyLCBQbGF5ZXIsIFNpdGUsIFNldHRsZW1lbnQgfSBmcm9tICdAL3R5cGVzL2VudGl0aWVzJztcclxuaW1wb3J0IHsgRW50aXR5VHlwZSB9IGZyb20gJ0AvdHlwZXMvZW51bXMnO1xyXG5pbXBvcnQgeyBcclxuICB1cHNlcnRUYXNrIGFzIHJlcG9VcHNlcnRUYXNrLFxyXG4gIGdldEFsbFRhc2tzIGFzIHJlcG9HZXRBbGxUYXNrcyxcclxuICBnZXRUYXNrQnlJZCBhcyByZXBvR2V0VGFza0J5SWQsXHJcbiAgZGVsZXRlVGFzayBhcyByZXBvRGVsZXRlVGFza1xyXG59IGZyb20gJy4vcmVwb3NpdG9yaWVzL3Rhc2sucmVwbyc7XHJcbmltcG9ydCB7IFxyXG4gIHVwc2VydEl0ZW0gYXMgcmVwb1Vwc2VydEl0ZW0sXHJcbiAgZ2V0QWxsSXRlbXMgYXMgcmVwb0dldEFsbEl0ZW1zLFxyXG4gIGdldEl0ZW1CeUlkIGFzIHJlcG9HZXRJdGVtQnlJZCxcclxuICBkZWxldGVJdGVtIGFzIHJlcG9EZWxldGVJdGVtXHJcbn0gZnJvbSAnLi9yZXBvc2l0b3JpZXMvaXRlbS5yZXBvJztcclxuaW1wb3J0IHsgXHJcbiAgdXBzZXJ0RmluYW5jaWFsIGFzIHJlcG9VcHNlcnRGaW5hbmNpYWwsXHJcbiAgZ2V0QWxsRmluYW5jaWFscyBhcyByZXBvR2V0QWxsRmluYW5jaWFscyxcclxuICBnZXRGaW5hbmNpYWxCeUlkIGFzIHJlcG9HZXRGaW5hbmNpYWxCeUlkLFxyXG4gIGRlbGV0ZUZpbmFuY2lhbCBhcyByZXBvRGVsZXRlRmluYW5jaWFsXHJcbn0gZnJvbSAnLi9yZXBvc2l0b3JpZXMvZmluYW5jaWFsLnJlcG8nO1xyXG5pbXBvcnQgeyBcclxuICB1cHNlcnRTYWxlIGFzIHJlcG9VcHNlcnRTYWxlLFxyXG4gIGdldEFsbFNhbGVzIGFzIHJlcG9HZXRBbGxTYWxlcyxcclxuICBnZXRTYWxlQnlJZCBhcyByZXBvR2V0U2FsZUJ5SWQsXHJcbiAgZGVsZXRlU2FsZSBhcyByZXBvRGVsZXRlU2FsZVxyXG59IGZyb20gJy4vcmVwb3NpdG9yaWVzL3NhbGUucmVwbyc7XHJcbmltcG9ydCB7IFxyXG4gIHVwc2VydENoYXJhY3RlciBhcyByZXBvVXBzZXJ0Q2hhcmFjdGVyLFxyXG4gIGdldEFsbENoYXJhY3RlcnMgYXMgcmVwb0dldEFsbENoYXJhY3RlcnMsXHJcbiAgZ2V0Q2hhcmFjdGVyQnlJZCBhcyByZXBvR2V0Q2hhcmFjdGVyQnlJZCxcclxuICBkZWxldGVDaGFyYWN0ZXIgYXMgcmVwb0RlbGV0ZUNoYXJhY3RlclxyXG59IGZyb20gJy4vcmVwb3NpdG9yaWVzL2NoYXJhY3Rlci5yZXBvJztcclxuaW1wb3J0IHsgXHJcbiAgdXBzZXJ0UGxheWVyIGFzIHJlcG9VcHNlcnRQbGF5ZXIsXHJcbiAgZ2V0QWxsUGxheWVycyBhcyByZXBvR2V0QWxsUGxheWVycyxcclxuICBnZXRQbGF5ZXJCeUlkIGFzIHJlcG9HZXRQbGF5ZXJCeUlkLFxyXG4gIGRlbGV0ZVBsYXllciBhcyByZXBvRGVsZXRlUGxheWVyXHJcbn0gZnJvbSAnLi9yZXBvc2l0b3JpZXMvcGxheWVyLnJlcG8nO1xyXG5pbXBvcnQgeyBcclxuICB1cHNlcnRTaXRlIGFzIHJlcG9VcHNlcnRTaXRlLFxyXG4gIGdldEFsbFNpdGVzIGFzIHJlcG9HZXRBbGxTaXRlcyxcclxuICBnZXRTaXRlQnlJZCBhcyByZXBvR2V0U2l0ZUJ5SWQsXHJcbiAgZGVsZXRlU2l0ZSBhcyByZXBvRGVsZXRlU2l0ZSxcclxuICBnZXRBbGxTZXR0bGVtZW50cyBhcyByZXBvR2V0QWxsU2V0dGxlbWVudHMsXHJcbiAgZ2V0U2V0dGxlbWVudEJ5SWQgYXMgcmVwb0dldFNldHRsZW1lbnRCeUlkLFxyXG4gIHVwc2VydFNldHRsZW1lbnQgYXMgcmVwb1Vwc2VydFNldHRsZW1lbnQsXHJcbiAgcmVtb3ZlU2V0dGxlbWVudCBhcyByZXBvUmVtb3ZlU2V0dGxlbWVudCxcclxuICBnZXRTaXRlc0J5U2V0dGxlbWVudCBhcyByZXBvR2V0U2l0ZXNCeVNldHRsZW1lbnQsXHJcbiAgZ2V0U2l0ZXNCeVJhZGl1cyBhcyByZXBvR2V0U2l0ZXNCeVJhZGl1c1xyXG59IGZyb20gJy4vcmVwb3NpdG9yaWVzL3NpdGUucmVwbyc7XHJcbmltcG9ydCB7IGt2R2V0LCBrdlNldCB9IGZyb20gJy4va3YnO1xyXG4vLyBJbXBvcnQgd29ya2Zsb3cgZnVuY3Rpb25zIGluZGl2aWR1YWxseSB0byBhdm9pZCBUeXBlU2NyaXB0IGlzc3Vlc1xyXG5pbXBvcnQgeyBvblRhc2tVcHNlcnQgfSBmcm9tICdAL3dvcmtmbG93cy9lbnRpdGllcy13b3JrZmxvd3MvdGFzay53b3JrZmxvdyc7XHJcbmltcG9ydCB7IG9uSXRlbVVwc2VydCB9IGZyb20gJ0Avd29ya2Zsb3dzL2VudGl0aWVzLXdvcmtmbG93cy9pdGVtLndvcmtmbG93JztcclxuaW1wb3J0IHsgb25GaW5hbmNpYWxVcHNlcnQgfSBmcm9tICdAL3dvcmtmbG93cy9lbnRpdGllcy13b3JrZmxvd3MvZmluYW5jaWFsLndvcmtmbG93JztcclxuaW1wb3J0IHsgb25TYWxlVXBzZXJ0IH0gZnJvbSAnQC93b3JrZmxvd3MvZW50aXRpZXMtd29ya2Zsb3dzL3NhbGUud29ya2Zsb3cnO1xyXG5pbXBvcnQgeyBvbkNoYXJhY3RlclVwc2VydCB9IGZyb20gJ0Avd29ya2Zsb3dzL2VudGl0aWVzLXdvcmtmbG93cy9jaGFyYWN0ZXIud29ya2Zsb3cnO1xyXG5pbXBvcnQgeyBvblBsYXllclVwc2VydCB9IGZyb20gJ0Avd29ya2Zsb3dzL2VudGl0aWVzLXdvcmtmbG93cy9wbGF5ZXIud29ya2Zsb3cnO1xyXG5pbXBvcnQgeyBvblNpdGVVcHNlcnQgfSBmcm9tICdAL3dvcmtmbG93cy9lbnRpdGllcy13b3JrZmxvd3Mvc2l0ZS53b3JrZmxvdyc7XHJcbmltcG9ydCB7IHByb2Nlc3NMaW5rRW50aXR5IH0gZnJvbSAnQC9saW5rcy9saW5rcy13b3JrZmxvd3MnO1xyXG5pbXBvcnQgeyBhcHBlbmRFbnRpdHlMb2cgfSBmcm9tICdAL3dvcmtmbG93cy9lbnRpdGllcy1sb2dnaW5nJztcclxuXHJcbi8vIFRBU0tTXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiB1cHNlcnRUYXNrKHRhc2s6IFRhc2spOiBQcm9taXNlPFRhc2s+IHtcclxuICBjb25zdCBwcmV2aW91cyA9IGF3YWl0IHJlcG9HZXRUYXNrQnlJZCh0YXNrLmlkKTtcclxuICBjb25zdCBzYXZlZCA9IGF3YWl0IHJlcG9VcHNlcnRUYXNrKHRhc2spO1xyXG4gIGF3YWl0IG9uVGFza1Vwc2VydChzYXZlZCwgcHJldmlvdXMgfHwgdW5kZWZpbmVkKTtcclxuICBhd2FpdCBwcm9jZXNzTGlua0VudGl0eShzYXZlZCwgRW50aXR5VHlwZS5UQVNLKTtcclxuICByZXR1cm4gc2F2ZWQ7XHJcbn1cclxuXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBnZXRBbGxUYXNrcygpOiBQcm9taXNlPFRhc2tbXT4ge1xyXG4gIHJldHVybiBhd2FpdCByZXBvR2V0QWxsVGFza3MoKTtcclxufVxyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGdldFRhc2tCeUlkKGlkOiBzdHJpbmcpOiBQcm9taXNlPFRhc2sgfCBudWxsPiB7XHJcbiAgcmV0dXJuIGF3YWl0IHJlcG9HZXRUYXNrQnlJZChpZCk7XHJcbn1cclxuXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiByZW1vdmVUYXNrKGlkOiBzdHJpbmcpOiBQcm9taXNlPHZvaWQ+IHtcclxuICBjb25zdCBleGlzdGluZyA9IGF3YWl0IHJlcG9HZXRUYXNrQnlJZChpZCk7XHJcbiAgYXdhaXQgcmVwb0RlbGV0ZVRhc2soaWQpO1xyXG4gIGlmIChleGlzdGluZykge1xyXG4gICAgLy8gQ2FsbCB0YXNrIGRlbGV0aW9uIHdvcmtmbG93IGZvciBjbGVhbnVwXHJcbiAgICBjb25zdCB7IHJlbW92ZVRhc2tMb2dFbnRyaWVzT25EZWxldGUgfSA9IGF3YWl0IGltcG9ydCgnQC93b3JrZmxvd3MvZW50aXRpZXMtd29ya2Zsb3dzL3Rhc2sud29ya2Zsb3cnKTtcclxuICAgIGF3YWl0IHJlbW92ZVRhc2tMb2dFbnRyaWVzT25EZWxldGUoaWQpO1xyXG4gIH1cclxufVxyXG5cclxuLy8gSVRFTVNcclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIHVwc2VydEl0ZW0oaXRlbTogSXRlbSk6IFByb21pc2U8SXRlbT4ge1xyXG4gIGNvbnN0IHByZXZpb3VzID0gYXdhaXQgcmVwb0dldEl0ZW1CeUlkKGl0ZW0uaWQpO1xyXG4gIGNvbnN0IHNhdmVkID0gYXdhaXQgcmVwb1Vwc2VydEl0ZW0oaXRlbSk7XHJcbiAgYXdhaXQgb25JdGVtVXBzZXJ0KHNhdmVkLCBwcmV2aW91cyB8fCB1bmRlZmluZWQpO1xyXG4gIGF3YWl0IHByb2Nlc3NMaW5rRW50aXR5KHNhdmVkLCBFbnRpdHlUeXBlLklURU0pO1xyXG4gIHJldHVybiBzYXZlZDtcclxufVxyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGdldEFsbEl0ZW1zKCk6IFByb21pc2U8SXRlbVtdPiB7XHJcbiAgcmV0dXJuIGF3YWl0IHJlcG9HZXRBbGxJdGVtcygpO1xyXG59XHJcblxyXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gZ2V0SXRlbUJ5SWQoaWQ6IHN0cmluZyk6IFByb21pc2U8SXRlbSB8IG51bGw+IHtcclxuICByZXR1cm4gYXdhaXQgcmVwb0dldEl0ZW1CeUlkKGlkKTtcclxufVxyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIHJlbW92ZUl0ZW0oaWQ6IHN0cmluZyk6IFByb21pc2U8dm9pZD4ge1xyXG4gIGNvbnN0IGV4aXN0aW5nID0gYXdhaXQgcmVwb0dldEl0ZW1CeUlkKGlkKTtcclxuICBhd2FpdCByZXBvRGVsZXRlSXRlbShpZCk7XHJcbiAgaWYgKGV4aXN0aW5nKSB7XHJcbiAgICAvLyBDYWxsIGl0ZW0gZGVsZXRpb24gd29ya2Zsb3cgZm9yIGNsZWFudXBcclxuICAgIGNvbnN0IHsgcmVtb3ZlSXRlbUVmZmVjdHNPbkRlbGV0ZSB9ID0gYXdhaXQgaW1wb3J0KCdAL3dvcmtmbG93cy9lbnRpdGllcy13b3JrZmxvd3MvaXRlbS53b3JrZmxvdycpO1xyXG4gICAgYXdhaXQgcmVtb3ZlSXRlbUVmZmVjdHNPbkRlbGV0ZShpZCk7XHJcbiAgfVxyXG59XHJcblxyXG4vLyBGSU5BTkNJQUxTXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiB1cHNlcnRGaW5hbmNpYWwoZmluYW5jaWFsOiBGaW5hbmNpYWxSZWNvcmQpOiBQcm9taXNlPEZpbmFuY2lhbFJlY29yZD4ge1xyXG4gIGNvbnN0IHByZXZpb3VzID0gYXdhaXQgcmVwb0dldEZpbmFuY2lhbEJ5SWQoZmluYW5jaWFsLmlkKTtcclxuICBjb25zdCBzYXZlZCA9IGF3YWl0IHJlcG9VcHNlcnRGaW5hbmNpYWwoZmluYW5jaWFsKTtcclxuICBhd2FpdCBvbkZpbmFuY2lhbFVwc2VydChzYXZlZCwgcHJldmlvdXMgfHwgdW5kZWZpbmVkKTtcclxuICBhd2FpdCBwcm9jZXNzTGlua0VudGl0eShzYXZlZCwgRW50aXR5VHlwZS5GSU5BTkNJQUwpO1xyXG4gIHJldHVybiBzYXZlZDtcclxufVxyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGdldEFsbEZpbmFuY2lhbHMoKTogUHJvbWlzZTxGaW5hbmNpYWxSZWNvcmRbXT4ge1xyXG4gIHJldHVybiBhd2FpdCByZXBvR2V0QWxsRmluYW5jaWFscygpO1xyXG59XHJcblxyXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gZ2V0RmluYW5jaWFsQnlJZChpZDogc3RyaW5nKTogUHJvbWlzZTxGaW5hbmNpYWxSZWNvcmQgfCBudWxsPiB7XHJcbiAgcmV0dXJuIGF3YWl0IHJlcG9HZXRGaW5hbmNpYWxCeUlkKGlkKTtcclxufVxyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIHJlbW92ZUZpbmFuY2lhbChpZDogc3RyaW5nKTogUHJvbWlzZTx2b2lkPiB7XHJcbiAgY29uc3QgZXhpc3RpbmcgPSBhd2FpdCByZXBvR2V0RmluYW5jaWFsQnlJZChpZCk7XHJcbiAgYXdhaXQgcmVwb0RlbGV0ZUZpbmFuY2lhbChpZCk7XHJcbiAgaWYgKGV4aXN0aW5nKSB7XHJcbiAgICAvLyBDYWxsIGZpbmFuY2lhbCBkZWxldGlvbiB3b3JrZmxvdyBmb3IgY2xlYW51cFxyXG4gICAgY29uc3QgeyByZW1vdmVSZWNvcmRFZmZlY3RzT25EZWxldGUgfSA9IGF3YWl0IGltcG9ydCgnQC93b3JrZmxvd3MvZW50aXRpZXMtd29ya2Zsb3dzL2ZpbmFuY2lhbC53b3JrZmxvdycpO1xyXG4gICAgYXdhaXQgcmVtb3ZlUmVjb3JkRWZmZWN0c09uRGVsZXRlKGlkKTtcclxuICB9XHJcbn1cclxuXHJcbi8vIFNBTEVTXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiB1cHNlcnRTYWxlKHNhbGU6IFNhbGUpOiBQcm9taXNlPFNhbGU+IHtcclxuICBjb25zdCBwcmV2aW91cyA9IGF3YWl0IHJlcG9HZXRTYWxlQnlJZChzYWxlLmlkKTtcclxuICBjb25zdCBzYXZlZCA9IGF3YWl0IHJlcG9VcHNlcnRTYWxlKHNhbGUpO1xyXG4gIGF3YWl0IG9uU2FsZVVwc2VydChzYXZlZCwgcHJldmlvdXMgfHwgdW5kZWZpbmVkKTtcclxuICBhd2FpdCBwcm9jZXNzTGlua0VudGl0eShzYXZlZCwgRW50aXR5VHlwZS5TQUxFKTtcclxuICByZXR1cm4gc2F2ZWQ7XHJcbn1cclxuXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBnZXRBbGxTYWxlcygpOiBQcm9taXNlPFNhbGVbXT4ge1xyXG4gIHJldHVybiBhd2FpdCByZXBvR2V0QWxsU2FsZXMoKTtcclxufVxyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGdldFNhbGVCeUlkKGlkOiBzdHJpbmcpOiBQcm9taXNlPFNhbGUgfCBudWxsPiB7XHJcbiAgcmV0dXJuIGF3YWl0IHJlcG9HZXRTYWxlQnlJZChpZCk7XHJcbn1cclxuXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiByZW1vdmVTYWxlKGlkOiBzdHJpbmcpOiBQcm9taXNlPHZvaWQ+IHtcclxuICBjb25zdCBleGlzdGluZyA9IGF3YWl0IHJlcG9HZXRTYWxlQnlJZChpZCk7XHJcbiAgYXdhaXQgcmVwb0RlbGV0ZVNhbGUoaWQpO1xyXG4gIGlmIChleGlzdGluZykge1xyXG4gICAgLy8gQ2FsbCBzYWxlIGRlbGV0aW9uIHdvcmtmbG93IGZvciBjbGVhbnVwXHJcbiAgICBjb25zdCB7IHJlbW92ZVNhbGVFZmZlY3RzT25EZWxldGUgfSA9IGF3YWl0IGltcG9ydCgnQC93b3JrZmxvd3MvZW50aXRpZXMtd29ya2Zsb3dzL3NhbGUud29ya2Zsb3cnKTtcclxuICAgIGF3YWl0IHJlbW92ZVNhbGVFZmZlY3RzT25EZWxldGUoaWQpO1xyXG4gIH1cclxufVxyXG5cclxuLy8gQ0hBUkFDVEVSU1xyXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gdXBzZXJ0Q2hhcmFjdGVyKGNoYXJhY3RlcjogQ2hhcmFjdGVyKTogUHJvbWlzZTxDaGFyYWN0ZXI+IHtcclxuICBjb25zdCBwcmV2aW91cyA9IGF3YWl0IHJlcG9HZXRDaGFyYWN0ZXJCeUlkKGNoYXJhY3Rlci5pZCk7XHJcbiAgY29uc3Qgc2F2ZWQgPSBhd2FpdCByZXBvVXBzZXJ0Q2hhcmFjdGVyKGNoYXJhY3Rlcik7XHJcbiAgYXdhaXQgb25DaGFyYWN0ZXJVcHNlcnQoc2F2ZWQsIHByZXZpb3VzIHx8IHVuZGVmaW5lZCk7XHJcbiAgYXdhaXQgcHJvY2Vzc0xpbmtFbnRpdHkoc2F2ZWQsIEVudGl0eVR5cGUuQ0hBUkFDVEVSKTtcclxuICByZXR1cm4gc2F2ZWQ7XHJcbn1cclxuXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBnZXRBbGxDaGFyYWN0ZXJzKCk6IFByb21pc2U8Q2hhcmFjdGVyW10+IHtcclxuICByZXR1cm4gYXdhaXQgcmVwb0dldEFsbENoYXJhY3RlcnMoKTtcclxufVxyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGdldENoYXJhY3RlckJ5SWQoaWQ6IHN0cmluZyk6IFByb21pc2U8Q2hhcmFjdGVyIHwgbnVsbD4ge1xyXG4gIHJldHVybiBhd2FpdCByZXBvR2V0Q2hhcmFjdGVyQnlJZChpZCk7XHJcbn1cclxuXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiByZW1vdmVDaGFyYWN0ZXIoaWQ6IHN0cmluZyk6IFByb21pc2U8dm9pZD4ge1xyXG4gIGNvbnN0IGV4aXN0aW5nID0gYXdhaXQgcmVwb0dldENoYXJhY3RlckJ5SWQoaWQpO1xyXG4gIGF3YWl0IHJlcG9EZWxldGVDaGFyYWN0ZXIoaWQpO1xyXG4gIGlmIChleGlzdGluZykge1xyXG4gICAgLy8gQ2FsbCBjaGFyYWN0ZXIgZGVsZXRpb24gd29ya2Zsb3cgZm9yIGNsZWFudXBcclxuICAgIGNvbnN0IHsgcmVtb3ZlQ2hhcmFjdGVyRWZmZWN0c09uRGVsZXRlIH0gPSBhd2FpdCBpbXBvcnQoJ0Avd29ya2Zsb3dzL2VudGl0aWVzLXdvcmtmbG93cy9jaGFyYWN0ZXIud29ya2Zsb3cnKTtcclxuICAgIGF3YWl0IHJlbW92ZUNoYXJhY3RlckVmZmVjdHNPbkRlbGV0ZShpZCk7XHJcbiAgfVxyXG59XHJcblxyXG4vLyBQTEFZRVJTXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiB1cHNlcnRQbGF5ZXIocGxheWVyOiBQbGF5ZXIpOiBQcm9taXNlPFBsYXllcj4ge1xyXG4gIGNvbnN0IHByZXZpb3VzID0gYXdhaXQgcmVwb0dldFBsYXllckJ5SWQocGxheWVyLmlkKTtcclxuICBjb25zdCBzYXZlZCA9IGF3YWl0IHJlcG9VcHNlcnRQbGF5ZXIocGxheWVyKTtcclxuICBhd2FpdCBvblBsYXllclVwc2VydChzYXZlZCwgcHJldmlvdXMgfHwgdW5kZWZpbmVkKTtcclxuICBhd2FpdCBwcm9jZXNzTGlua0VudGl0eShzYXZlZCwgRW50aXR5VHlwZS5QTEFZRVIpO1xyXG4gIHJldHVybiBzYXZlZDtcclxufVxyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGdldEFsbFBsYXllcnMoKTogUHJvbWlzZTxQbGF5ZXJbXT4ge1xyXG4gIHJldHVybiBhd2FpdCByZXBvR2V0QWxsUGxheWVycygpO1xyXG59XHJcblxyXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gZ2V0UGxheWVyQnlJZChpZDogc3RyaW5nKTogUHJvbWlzZTxQbGF5ZXIgfCBudWxsPiB7XHJcbiAgcmV0dXJuIGF3YWl0IHJlcG9HZXRQbGF5ZXJCeUlkKGlkKTtcclxufVxyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIHJlbW92ZVBsYXllcihpZDogc3RyaW5nKTogUHJvbWlzZTx2b2lkPiB7XHJcbiAgY29uc3QgZXhpc3RpbmcgPSBhd2FpdCByZXBvR2V0UGxheWVyQnlJZChpZCk7XHJcbiAgYXdhaXQgcmVwb0RlbGV0ZVBsYXllcihpZCk7XHJcbiAgaWYgKGV4aXN0aW5nKSB7XHJcbiAgICAvLyBDYWxsIHBsYXllciBkZWxldGlvbiB3b3JrZmxvdyBmb3IgY2xlYW51cFxyXG4gICAgY29uc3QgeyByZW1vdmVQbGF5ZXJFZmZlY3RzT25EZWxldGUgfSA9IGF3YWl0IGltcG9ydCgnQC93b3JrZmxvd3MvZW50aXRpZXMtd29ya2Zsb3dzL3BsYXllci53b3JrZmxvdycpO1xyXG4gICAgYXdhaXQgcmVtb3ZlUGxheWVyRWZmZWN0c09uRGVsZXRlKGlkKTtcclxuICB9XHJcbn1cclxuXHJcbi8vIFNJVEVTXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiB1cHNlcnRTaXRlKHNpdGU6IFNpdGUpOiBQcm9taXNlPFNpdGU+IHtcclxuICBjb25zdCBwcmV2aW91cyA9IGF3YWl0IHJlcG9HZXRTaXRlQnlJZChzaXRlLmlkKTtcclxuICBjb25zdCBzYXZlZCA9IGF3YWl0IHJlcG9VcHNlcnRTaXRlKHNpdGUpO1xyXG4gIGF3YWl0IG9uU2l0ZVVwc2VydChzYXZlZCwgcHJldmlvdXMgfHwgdW5kZWZpbmVkKTtcclxuICBhd2FpdCBwcm9jZXNzTGlua0VudGl0eShzYXZlZCwgRW50aXR5VHlwZS5TSVRFKTtcclxuICByZXR1cm4gc2F2ZWQ7XHJcbn1cclxuXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBnZXRBbGxTaXRlcygpOiBQcm9taXNlPFNpdGVbXT4ge1xyXG4gIHJldHVybiBhd2FpdCByZXBvR2V0QWxsU2l0ZXMoKTtcclxufVxyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGdldFNpdGVCeUlkKGlkOiBzdHJpbmcpOiBQcm9taXNlPFNpdGUgfCBudWxsPiB7XHJcbiAgcmV0dXJuIGF3YWl0IHJlcG9HZXRTaXRlQnlJZChpZCk7XHJcbn1cclxuXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiByZW1vdmVTaXRlKGlkOiBzdHJpbmcpOiBQcm9taXNlPHZvaWQ+IHtcclxuICBjb25zdCBleGlzdGluZyA9IGF3YWl0IHJlcG9HZXRTaXRlQnlJZChpZCk7XHJcbiAgYXdhaXQgcmVwb0RlbGV0ZVNpdGUoaWQpO1xyXG4gIGlmIChleGlzdGluZykge1xyXG4gICAgLy8gQ2FsbCBzaXRlIGRlbGV0aW9uIHdvcmtmbG93IGZvciBjbGVhbnVwXHJcbiAgICBjb25zdCB7IHJlbW92ZVNpdGVFZmZlY3RzT25EZWxldGUgfSA9IGF3YWl0IGltcG9ydCgnQC93b3JrZmxvd3MvZW50aXRpZXMtd29ya2Zsb3dzL3NpdGUud29ya2Zsb3cnKTtcclxuICAgIGF3YWl0IHJlbW92ZVNpdGVFZmZlY3RzT25EZWxldGUoaWQpO1xyXG4gIH1cclxufVxyXG5cclxuLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxyXG4vLyBTRVRUTEVNRU5UIE1FVEhPRFMgKFJlZmVyZW5jZSBkYXRhIGZvciBTaXRlcylcclxuLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGdldEFsbFNldHRsZW1lbnRzKCk6IFByb21pc2U8U2V0dGxlbWVudFtdPiB7XHJcbiAgcmV0dXJuIGF3YWl0IHJlcG9HZXRBbGxTZXR0bGVtZW50cygpO1xyXG59XHJcblxyXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gZ2V0U2V0dGxlbWVudEJ5SWQoaWQ6IHN0cmluZyk6IFByb21pc2U8U2V0dGxlbWVudCB8IG51bGw+IHtcclxuICByZXR1cm4gYXdhaXQgcmVwb0dldFNldHRsZW1lbnRCeUlkKGlkKTtcclxufVxyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIHVwc2VydFNldHRsZW1lbnQoc2V0dGxlbWVudDogU2V0dGxlbWVudCk6IFByb21pc2U8U2V0dGxlbWVudD4ge1xyXG4gIHJldHVybiBhd2FpdCByZXBvVXBzZXJ0U2V0dGxlbWVudChzZXR0bGVtZW50KTtcclxufVxyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIHJlbW92ZVNldHRsZW1lbnQoaWQ6IHN0cmluZyk6IFByb21pc2U8dm9pZD4ge1xyXG4gIGF3YWl0IHJlcG9SZW1vdmVTZXR0bGVtZW50KGlkKTtcclxufVxyXG5cclxuLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxyXG4vLyBTSVRFIFFVRVJZIE1FVEhPRFNcclxuLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGdldFNpdGVzQnlTZXR0bGVtZW50KHNldHRsZW1lbnRJZDogc3RyaW5nKTogUHJvbWlzZTxTaXRlW10+IHtcclxuICByZXR1cm4gYXdhaXQgcmVwb0dldFNpdGVzQnlTZXR0bGVtZW50KHNldHRsZW1lbnRJZCk7XHJcbn1cclxuXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBnZXRTaXRlc0J5UmFkaXVzKFxyXG4gIGNlbnRlckxhdDogbnVtYmVyLFxyXG4gIGNlbnRlckxuZzogbnVtYmVyLFxyXG4gIHJhZGl1c01ldGVyczogbnVtYmVyXHJcbik6IFByb21pc2U8U2l0ZVtdPiB7XHJcbiAgcmV0dXJuIGF3YWl0IHJlcG9HZXRTaXRlc0J5UmFkaXVzKGNlbnRlckxhdCwgY2VudGVyTG5nLCByYWRpdXNNZXRlcnMpO1xyXG59XHJcblxyXG4vLyBQT0lOVFMgQ09OVkVSU0lPTiBSQVRFU1xyXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gZ2V0UG9pbnRzQ29udmVyc2lvblJhdGVzKCk6IFByb21pc2U8YW55PiB7XHJcbiAgY29uc3QgcmF0ZXMgPSBhd2FpdCBrdkdldCgnZGF0YTpwb2ludHMtY29udmVyc2lvbi1yYXRlcycpO1xyXG4gIHJldHVybiByYXRlcyB8fCB7XHJcbiAgICBocFRvSiQ6IDEwLFxyXG4gICAgZnBUb0okOiAxNSxcclxuICAgIHJwVG9KJDogMTIsXHJcbiAgICB4cFRvSiQ6IDMsXHJcbiAgICBqJFRvVVNEOiAxMFxyXG4gIH07XHJcbn1cclxuXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBzYXZlUG9pbnRzQ29udmVyc2lvblJhdGVzKHJhdGVzOiBhbnkpOiBQcm9taXNlPHZvaWQ+IHtcclxuICBhd2FpdCBrdlNldCgnZGF0YTpwb2ludHMtY29udmVyc2lvbi1yYXRlcycsIHJhdGVzKTtcclxufVxyXG5cclxuLy8gQ09NUEFOWSBBU1NFVFNcclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGdldENvbXBhbnlBc3NldHMoKTogUHJvbWlzZTxhbnk+IHtcclxuICBjb25zdCBhc3NldHMgPSBhd2FpdCBrdkdldCgnZGF0YTpjb21wYW55LWFzc2V0cycpO1xyXG4gIHJldHVybiBhc3NldHMgfHwge1xyXG4gICAgY2FzaDogMCxcclxuICAgIGJhbms6IDAsXHJcbiAgICBiaXRjb2luOiAwLFxyXG4gICAgdG9DaGFyZ2U6IDAsXHJcbiAgICB0b1BheTogMCxcclxuICAgIGNvbXBhbnlKJDogMCxcclxuICAgIG1hdGVyaWFsczogeyB2YWx1ZTogMCwgY29zdDogMCB9LFxyXG4gICAgZXF1aXBtZW50OiB7IHZhbHVlOiAwLCBjb3N0OiAwIH0sXHJcbiAgICBhcnR3b3JrczogeyB2YWx1ZTogMCwgY29zdDogMCB9LFxyXG4gICAgcHJpbnRzOiB7IHZhbHVlOiAwLCBjb3N0OiAwIH0sXHJcbiAgICBzdGlja2VyczogeyB2YWx1ZTogMCwgY29zdDogMCB9LFxyXG4gICAgbWVyY2g6IHsgdmFsdWU6IDAsIGNvc3Q6IDAgfVxyXG4gIH07XHJcbn1cclxuXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBzYXZlQ29tcGFueUFzc2V0cyhhc3NldHM6IGFueSk6IFByb21pc2U8dm9pZD4ge1xyXG4gIGF3YWl0IGt2U2V0KCdkYXRhOmNvbXBhbnktYXNzZXRzJywgYXNzZXRzKTtcclxufVxyXG5cclxuLy8gUEVSU09OQUwgQVNTRVRTXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBnZXRQZXJzb25hbEFzc2V0cygpOiBQcm9taXNlPGFueT4ge1xyXG4gIGNvbnN0IGFzc2V0cyA9IGF3YWl0IGt2R2V0KCdkYXRhOnBlcnNvbmFsLWFzc2V0cycpO1xyXG4gIHJldHVybiBhc3NldHMgfHwge1xyXG4gICAgY2FzaDogMCxcclxuICAgIGJhbms6IDAsXHJcbiAgICBiaXRjb2luOiAwLFxyXG4gICAgY3J5cHRvOiAwLFxyXG4gICAgdG9DaGFyZ2U6IDAsXHJcbiAgICB0b1BheTogMCxcclxuICAgIHBlcnNvbmFsSiQ6IDAsXHJcbiAgICB2ZWhpY2xlOiAwLFxyXG4gICAgcHJvcGVydGllczogMCxcclxuICAgIG5mdHM6IDAsXHJcbiAgICBvdGhlcjogMFxyXG4gIH07XHJcbn1cclxuXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBzYXZlUGVyc29uYWxBc3NldHMoYXNzZXRzOiBhbnkpOiBQcm9taXNlPHZvaWQ+IHtcclxuICBhd2FpdCBrdlNldCgnZGF0YTpwZXJzb25hbC1hc3NldHMnLCBhc3NldHMpO1xyXG59XHJcblxyXG4vLyBDT05WRVJTSU9OIFJBVEVTXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBnZXRDb252ZXJzaW9uUmF0ZXMoKTogUHJvbWlzZTxhbnk+IHtcclxuICBjb25zdCByYXRlcyA9IGF3YWl0IGt2R2V0KCdkYXRhOmNvbnZlcnNpb24tcmF0ZXMnKTtcclxuICByZXR1cm4gcmF0ZXMgfHwge1xyXG4gICAgaHBUb0okOiAxMCxcclxuICAgIGZwVG9KJDogMTUsXHJcbiAgICBycFRvSiQ6IDEyLFxyXG4gICAgeHBUb0okOiAzLFxyXG4gICAgaiRUb1VTRDogMTAsXHJcbiAgICBjb2xvbmVzVG9Vc2Q6IDUwMCxcclxuICAgIGJpdGNvaW5Ub1VzZDogNTAwMDAsXHJcbiAgICBqdW5nbGVDb2luc1RvVXNkOiAwLjFcclxuICB9O1xyXG59XHJcblxyXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gc2F2ZUNvbnZlcnNpb25SYXRlcyhyYXRlczogYW55KTogUHJvbWlzZTx2b2lkPiB7XHJcbiAgYXdhaXQga3ZTZXQoJ2RhdGE6Y29udmVyc2lvbi1yYXRlcycsIHJhdGVzKTtcclxufSJdLCJuYW1lcyI6WyJFbnRpdHlUeXBlIiwidXBzZXJ0VGFzayIsInJlcG9VcHNlcnRUYXNrIiwiZ2V0QWxsVGFza3MiLCJyZXBvR2V0QWxsVGFza3MiLCJnZXRUYXNrQnlJZCIsInJlcG9HZXRUYXNrQnlJZCIsImRlbGV0ZVRhc2siLCJyZXBvRGVsZXRlVGFzayIsInVwc2VydEl0ZW0iLCJyZXBvVXBzZXJ0SXRlbSIsImdldEFsbEl0ZW1zIiwicmVwb0dldEFsbEl0ZW1zIiwiZ2V0SXRlbUJ5SWQiLCJyZXBvR2V0SXRlbUJ5SWQiLCJkZWxldGVJdGVtIiwicmVwb0RlbGV0ZUl0ZW0iLCJ1cHNlcnRGaW5hbmNpYWwiLCJyZXBvVXBzZXJ0RmluYW5jaWFsIiwiZ2V0QWxsRmluYW5jaWFscyIsInJlcG9HZXRBbGxGaW5hbmNpYWxzIiwiZ2V0RmluYW5jaWFsQnlJZCIsInJlcG9HZXRGaW5hbmNpYWxCeUlkIiwiZGVsZXRlRmluYW5jaWFsIiwicmVwb0RlbGV0ZUZpbmFuY2lhbCIsInVwc2VydFNhbGUiLCJyZXBvVXBzZXJ0U2FsZSIsImdldEFsbFNhbGVzIiwicmVwb0dldEFsbFNhbGVzIiwiZ2V0U2FsZUJ5SWQiLCJyZXBvR2V0U2FsZUJ5SWQiLCJkZWxldGVTYWxlIiwicmVwb0RlbGV0ZVNhbGUiLCJ1cHNlcnRDaGFyYWN0ZXIiLCJyZXBvVXBzZXJ0Q2hhcmFjdGVyIiwiZ2V0QWxsQ2hhcmFjdGVycyIsInJlcG9HZXRBbGxDaGFyYWN0ZXJzIiwiZ2V0Q2hhcmFjdGVyQnlJZCIsInJlcG9HZXRDaGFyYWN0ZXJCeUlkIiwiZGVsZXRlQ2hhcmFjdGVyIiwicmVwb0RlbGV0ZUNoYXJhY3RlciIsInVwc2VydFBsYXllciIsInJlcG9VcHNlcnRQbGF5ZXIiLCJnZXRBbGxQbGF5ZXJzIiwicmVwb0dldEFsbFBsYXllcnMiLCJnZXRQbGF5ZXJCeUlkIiwicmVwb0dldFBsYXllckJ5SWQiLCJkZWxldGVQbGF5ZXIiLCJyZXBvRGVsZXRlUGxheWVyIiwidXBzZXJ0U2l0ZSIsInJlcG9VcHNlcnRTaXRlIiwiZ2V0QWxsU2l0ZXMiLCJyZXBvR2V0QWxsU2l0ZXMiLCJnZXRTaXRlQnlJZCIsInJlcG9HZXRTaXRlQnlJZCIsImRlbGV0ZVNpdGUiLCJyZXBvRGVsZXRlU2l0ZSIsImdldEFsbFNldHRsZW1lbnRzIiwicmVwb0dldEFsbFNldHRsZW1lbnRzIiwiZ2V0U2V0dGxlbWVudEJ5SWQiLCJyZXBvR2V0U2V0dGxlbWVudEJ5SWQiLCJ1cHNlcnRTZXR0bGVtZW50IiwicmVwb1Vwc2VydFNldHRsZW1lbnQiLCJyZW1vdmVTZXR0bGVtZW50IiwicmVwb1JlbW92ZVNldHRsZW1lbnQiLCJnZXRTaXRlc0J5U2V0dGxlbWVudCIsInJlcG9HZXRTaXRlc0J5U2V0dGxlbWVudCIsImdldFNpdGVzQnlSYWRpdXMiLCJyZXBvR2V0U2l0ZXNCeVJhZGl1cyIsImt2R2V0Iiwia3ZTZXQiLCJvblRhc2tVcHNlcnQiLCJvbkl0ZW1VcHNlcnQiLCJvbkZpbmFuY2lhbFVwc2VydCIsIm9uU2FsZVVwc2VydCIsIm9uQ2hhcmFjdGVyVXBzZXJ0Iiwib25QbGF5ZXJVcHNlcnQiLCJvblNpdGVVcHNlcnQiLCJwcm9jZXNzTGlua0VudGl0eSIsInRhc2siLCJwcmV2aW91cyIsImlkIiwic2F2ZWQiLCJ1bmRlZmluZWQiLCJUQVNLIiwicmVtb3ZlVGFzayIsImV4aXN0aW5nIiwicmVtb3ZlVGFza0xvZ0VudHJpZXNPbkRlbGV0ZSIsIml0ZW0iLCJJVEVNIiwicmVtb3ZlSXRlbSIsInJlbW92ZUl0ZW1FZmZlY3RzT25EZWxldGUiLCJmaW5hbmNpYWwiLCJGSU5BTkNJQUwiLCJyZW1vdmVGaW5hbmNpYWwiLCJyZW1vdmVSZWNvcmRFZmZlY3RzT25EZWxldGUiLCJzYWxlIiwiU0FMRSIsInJlbW92ZVNhbGUiLCJyZW1vdmVTYWxlRWZmZWN0c09uRGVsZXRlIiwiY2hhcmFjdGVyIiwiQ0hBUkFDVEVSIiwicmVtb3ZlQ2hhcmFjdGVyIiwicmVtb3ZlQ2hhcmFjdGVyRWZmZWN0c09uRGVsZXRlIiwicGxheWVyIiwiUExBWUVSIiwicmVtb3ZlUGxheWVyIiwicmVtb3ZlUGxheWVyRWZmZWN0c09uRGVsZXRlIiwic2l0ZSIsIlNJVEUiLCJyZW1vdmVTaXRlIiwicmVtb3ZlU2l0ZUVmZmVjdHNPbkRlbGV0ZSIsInNldHRsZW1lbnQiLCJzZXR0bGVtZW50SWQiLCJjZW50ZXJMYXQiLCJjZW50ZXJMbmciLCJyYWRpdXNNZXRlcnMiLCJnZXRQb2ludHNDb252ZXJzaW9uUmF0ZXMiLCJyYXRlcyIsImhwVG9KJCIsImZwVG9KJCIsInJwVG9KJCIsInhwVG9KJCIsImokVG9VU0QiLCJzYXZlUG9pbnRzQ29udmVyc2lvblJhdGVzIiwiZ2V0Q29tcGFueUFzc2V0cyIsImFzc2V0cyIsImNhc2giLCJiYW5rIiwiYml0Y29pbiIsInRvQ2hhcmdlIiwidG9QYXkiLCJjb21wYW55SiQiLCJtYXRlcmlhbHMiLCJ2YWx1ZSIsImNvc3QiLCJlcXVpcG1lbnQiLCJhcnR3b3JrcyIsInByaW50cyIsInN0aWNrZXJzIiwibWVyY2giLCJzYXZlQ29tcGFueUFzc2V0cyIsImdldFBlcnNvbmFsQXNzZXRzIiwiY3J5cHRvIiwicGVyc29uYWxKJCIsInZlaGljbGUiLCJwcm9wZXJ0aWVzIiwibmZ0cyIsIm90aGVyIiwic2F2ZVBlcnNvbmFsQXNzZXRzIiwiZ2V0Q29udmVyc2lvblJhdGVzIiwiY29sb25lc1RvVXNkIiwiYml0Y29pblRvVXNkIiwianVuZ2xlQ29pbnNUb1VzZCIsInNhdmVDb252ZXJzaW9uUmF0ZXMiXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./data-store/datastore.ts\n");

/***/ }),

/***/ "(rsc)/./data-store/effects-registry.ts":
/*!****************************************!*\
  !*** ./data-store/effects-registry.ts ***!
  \****************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   clearEffect: () => (/* binding */ clearEffect),\n/* harmony export */   clearEffectsByPrefix: () => (/* binding */ clearEffectsByPrefix),\n/* harmony export */   clearProcessingStack: () => (/* binding */ clearProcessingStack),\n/* harmony export */   endProcessing: () => (/* binding */ endProcessing),\n/* harmony export */   getProcessingStatus: () => (/* binding */ getProcessingStatus),\n/* harmony export */   hasEffect: () => (/* binding */ hasEffect),\n/* harmony export */   isProcessing: () => (/* binding */ isProcessing),\n/* harmony export */   markEffect: () => (/* binding */ markEffect),\n/* harmony export */   startProcessing: () => (/* binding */ startProcessing)\n/* harmony export */ });\n/* harmony import */ var _kv__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./kv */ \"(rsc)/./data-store/kv.ts\");\n/* harmony import */ var _keys__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./keys */ \"(rsc)/./data-store/keys.ts\");\n// data-store/effects-registry.ts\n// Idempotency registry stored in KV. Avoids global flags and server HTTP loops.\n\n\nasync function hasEffect(effectKey) {\n    const key = (0,_keys__WEBPACK_IMPORTED_MODULE_1__.buildEffectKey)(effectKey);\n    const val = await (0,_kv__WEBPACK_IMPORTED_MODULE_0__.kvGet)(key);\n    return val === true;\n}\nasync function markEffect(effectKey, ttl) {\n    const key = (0,_keys__WEBPACK_IMPORTED_MODULE_1__.buildEffectKey)(effectKey);\n    await (0,_kv__WEBPACK_IMPORTED_MODULE_0__.kvSet)(key, true);\n}\nasync function clearEffect(effectKey) {\n    const key = (0,_keys__WEBPACK_IMPORTED_MODULE_1__.buildEffectKey)(effectKey);\n    await (0,_kv__WEBPACK_IMPORTED_MODULE_0__.kvSet)(key, false);\n}\nasync function clearEffectsByPrefix(entityType, entityId, prefix) {\n    // For now, we'll implement a simple version that clears all effects for an entity\n    // In a full implementation, this would scan and clear effects with the given prefix\n    console.log(`[clearEffectsByPrefix] Clearing effects for ${entityType}:${entityId} with prefix: ${prefix}`);\n// TODO: Implement proper prefix-based clearing when needed\n}\n// ============================================================================\n// LIGHTWEIGHT CIRCUIT BREAKER: Circular reference detection and depth limits\n// ============================================================================\n// Processing stack tracking for circular reference detection\nconst processingStack = new Set();\nconst MAX_DEPTH = 5;\n/**\r\n * Check if an entity is currently being processed\r\n */ function isProcessing(entityType, entityId) {\n    return processingStack.has(`${entityType}:${entityId}`);\n}\n/**\r\n * Start processing an entity - throws error if circular reference detected\r\n */ function startProcessing(entityType, entityId) {\n    const key = `${entityType}:${entityId}`;\n    if (processingStack.has(key)) {\n        throw new Error(`Circular reference detected: ${key}`);\n    }\n    if (processingStack.size >= MAX_DEPTH) {\n        throw new Error(`Max processing depth exceeded: ${MAX_DEPTH}`);\n    }\n    processingStack.add(key);\n    console.log(`[CircuitBreaker] Started processing: ${key} (depth: ${processingStack.size})`);\n}\n/**\r\n * End processing an entity\r\n */ function endProcessing(entityType, entityId) {\n    const key = `${entityType}:${entityId}`;\n    processingStack.delete(key);\n    console.log(`[CircuitBreaker] Ended processing: ${key} (depth: ${processingStack.size})`);\n}\n/**\r\n * Get current processing status for debugging\r\n */ function getProcessingStatus() {\n    return {\n        stack: Array.from(processingStack),\n        depth: processingStack.size,\n        maxDepth: MAX_DEPTH\n    };\n}\n/**\r\n * Clear all processing state (emergency reset)\r\n */ function clearProcessingStack() {\n    processingStack.clear();\n    console.log(`[CircuitBreaker] Cleared processing stack`);\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9kYXRhLXN0b3JlL2VmZmVjdHMtcmVnaXN0cnkudHMiLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7Ozs7QUFBQSxpQ0FBaUM7QUFDakMsZ0ZBQWdGO0FBRTVDO0FBQ0k7QUFFakMsZUFBZUcsVUFBVUMsU0FBaUI7SUFDL0MsTUFBTUMsTUFBTUgscURBQWNBLENBQUNFO0lBQzNCLE1BQU1FLE1BQU0sTUFBTU4sMENBQUtBLENBQVVLO0lBQ2pDLE9BQU9DLFFBQVE7QUFDakI7QUFFTyxlQUFlQyxXQUFXSCxTQUFpQixFQUFFSSxHQUFZO0lBQzlELE1BQU1ILE1BQU1ILHFEQUFjQSxDQUFDRTtJQUMzQixNQUFNSCwwQ0FBS0EsQ0FBQ0ksS0FBSztBQUNuQjtBQUVPLGVBQWVJLFlBQVlMLFNBQWlCO0lBQ2pELE1BQU1DLE1BQU1ILHFEQUFjQSxDQUFDRTtJQUMzQixNQUFNSCwwQ0FBS0EsQ0FBQ0ksS0FBSztBQUNuQjtBQUVPLGVBQWVLLHFCQUFxQkMsVUFBa0IsRUFBRUMsUUFBZ0IsRUFBRUMsTUFBYztJQUM3RixrRkFBa0Y7SUFDbEYsb0ZBQW9GO0lBQ3BGQyxRQUFRQyxHQUFHLENBQUMsQ0FBQyw0Q0FBNEMsRUFBRUosV0FBVyxDQUFDLEVBQUVDLFNBQVMsY0FBYyxFQUFFQyxPQUFPLENBQUM7QUFDMUcsMkRBQTJEO0FBQzdEO0FBRUEsK0VBQStFO0FBQy9FLDZFQUE2RTtBQUM3RSwrRUFBK0U7QUFFL0UsNkRBQTZEO0FBQzdELE1BQU1HLGtCQUFrQixJQUFJQztBQUM1QixNQUFNQyxZQUFZO0FBRWxCOztDQUVDLEdBQ00sU0FBU0MsYUFBYVIsVUFBa0IsRUFBRUMsUUFBZ0I7SUFDL0QsT0FBT0ksZ0JBQWdCSSxHQUFHLENBQUMsQ0FBQyxFQUFFVCxXQUFXLENBQUMsRUFBRUMsU0FBUyxDQUFDO0FBQ3hEO0FBRUE7O0NBRUMsR0FDTSxTQUFTUyxnQkFBZ0JWLFVBQWtCLEVBQUVDLFFBQWdCO0lBQ2xFLE1BQU1QLE1BQU0sQ0FBQyxFQUFFTSxXQUFXLENBQUMsRUFBRUMsU0FBUyxDQUFDO0lBRXZDLElBQUlJLGdCQUFnQkksR0FBRyxDQUFDZixNQUFNO1FBQzVCLE1BQU0sSUFBSWlCLE1BQU0sQ0FBQyw2QkFBNkIsRUFBRWpCLElBQUksQ0FBQztJQUN2RDtJQUVBLElBQUlXLGdCQUFnQk8sSUFBSSxJQUFJTCxXQUFXO1FBQ3JDLE1BQU0sSUFBSUksTUFBTSxDQUFDLCtCQUErQixFQUFFSixVQUFVLENBQUM7SUFDL0Q7SUFFQUYsZ0JBQWdCUSxHQUFHLENBQUNuQjtJQUNwQlMsUUFBUUMsR0FBRyxDQUFDLENBQUMscUNBQXFDLEVBQUVWLElBQUksU0FBUyxFQUFFVyxnQkFBZ0JPLElBQUksQ0FBQyxDQUFDLENBQUM7QUFDNUY7QUFFQTs7Q0FFQyxHQUNNLFNBQVNFLGNBQWNkLFVBQWtCLEVBQUVDLFFBQWdCO0lBQ2hFLE1BQU1QLE1BQU0sQ0FBQyxFQUFFTSxXQUFXLENBQUMsRUFBRUMsU0FBUyxDQUFDO0lBQ3ZDSSxnQkFBZ0JVLE1BQU0sQ0FBQ3JCO0lBQ3ZCUyxRQUFRQyxHQUFHLENBQUMsQ0FBQyxtQ0FBbUMsRUFBRVYsSUFBSSxTQUFTLEVBQUVXLGdCQUFnQk8sSUFBSSxDQUFDLENBQUMsQ0FBQztBQUMxRjtBQUVBOztDQUVDLEdBQ00sU0FBU0k7SUFLZCxPQUFPO1FBQ0xDLE9BQU9DLE1BQU1DLElBQUksQ0FBQ2Q7UUFDbEJlLE9BQU9mLGdCQUFnQk8sSUFBSTtRQUMzQlMsVUFBVWQ7SUFDWjtBQUNGO0FBRUE7O0NBRUMsR0FDTSxTQUFTZTtJQUNkakIsZ0JBQWdCa0IsS0FBSztJQUNyQnBCLFFBQVFDLEdBQUcsQ0FBQyxDQUFDLHlDQUF5QyxDQUFDO0FBQ3pEIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vdGhlZ2FtZS1hZG1pbi8uL2RhdGEtc3RvcmUvZWZmZWN0cy1yZWdpc3RyeS50cz85NDliIl0sInNvdXJjZXNDb250ZW50IjpbIi8vIGRhdGEtc3RvcmUvZWZmZWN0cy1yZWdpc3RyeS50c1xyXG4vLyBJZGVtcG90ZW5jeSByZWdpc3RyeSBzdG9yZWQgaW4gS1YuIEF2b2lkcyBnbG9iYWwgZmxhZ3MgYW5kIHNlcnZlciBIVFRQIGxvb3BzLlxyXG5cclxuaW1wb3J0IHsga3ZHZXQsIGt2U2V0IH0gZnJvbSAnLi9rdic7XHJcbmltcG9ydCB7IGJ1aWxkRWZmZWN0S2V5IH0gZnJvbSAnLi9rZXlzJztcclxuXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBoYXNFZmZlY3QoZWZmZWN0S2V5OiBzdHJpbmcpOiBQcm9taXNlPGJvb2xlYW4+IHtcclxuICBjb25zdCBrZXkgPSBidWlsZEVmZmVjdEtleShlZmZlY3RLZXkpO1xyXG4gIGNvbnN0IHZhbCA9IGF3YWl0IGt2R2V0PGJvb2xlYW4+KGtleSk7XHJcbiAgcmV0dXJuIHZhbCA9PT0gdHJ1ZTtcclxufVxyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIG1hcmtFZmZlY3QoZWZmZWN0S2V5OiBzdHJpbmcsIHR0bD86IG51bWJlcik6IFByb21pc2U8dm9pZD4ge1xyXG4gIGNvbnN0IGtleSA9IGJ1aWxkRWZmZWN0S2V5KGVmZmVjdEtleSk7XHJcbiAgYXdhaXQga3ZTZXQoa2V5LCB0cnVlKTtcclxufVxyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGNsZWFyRWZmZWN0KGVmZmVjdEtleTogc3RyaW5nKTogUHJvbWlzZTx2b2lkPiB7XHJcbiAgY29uc3Qga2V5ID0gYnVpbGRFZmZlY3RLZXkoZWZmZWN0S2V5KTtcclxuICBhd2FpdCBrdlNldChrZXksIGZhbHNlKTtcclxufVxyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGNsZWFyRWZmZWN0c0J5UHJlZml4KGVudGl0eVR5cGU6IHN0cmluZywgZW50aXR5SWQ6IHN0cmluZywgcHJlZml4OiBzdHJpbmcpOiBQcm9taXNlPHZvaWQ+IHtcclxuICAvLyBGb3Igbm93LCB3ZSdsbCBpbXBsZW1lbnQgYSBzaW1wbGUgdmVyc2lvbiB0aGF0IGNsZWFycyBhbGwgZWZmZWN0cyBmb3IgYW4gZW50aXR5XHJcbiAgLy8gSW4gYSBmdWxsIGltcGxlbWVudGF0aW9uLCB0aGlzIHdvdWxkIHNjYW4gYW5kIGNsZWFyIGVmZmVjdHMgd2l0aCB0aGUgZ2l2ZW4gcHJlZml4XHJcbiAgY29uc29sZS5sb2coYFtjbGVhckVmZmVjdHNCeVByZWZpeF0gQ2xlYXJpbmcgZWZmZWN0cyBmb3IgJHtlbnRpdHlUeXBlfToke2VudGl0eUlkfSB3aXRoIHByZWZpeDogJHtwcmVmaXh9YCk7XHJcbiAgLy8gVE9ETzogSW1wbGVtZW50IHByb3BlciBwcmVmaXgtYmFzZWQgY2xlYXJpbmcgd2hlbiBuZWVkZWRcclxufVxyXG5cclxuLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxyXG4vLyBMSUdIVFdFSUdIVCBDSVJDVUlUIEJSRUFLRVI6IENpcmN1bGFyIHJlZmVyZW5jZSBkZXRlY3Rpb24gYW5kIGRlcHRoIGxpbWl0c1xyXG4vLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XHJcblxyXG4vLyBQcm9jZXNzaW5nIHN0YWNrIHRyYWNraW5nIGZvciBjaXJjdWxhciByZWZlcmVuY2UgZGV0ZWN0aW9uXHJcbmNvbnN0IHByb2Nlc3NpbmdTdGFjayA9IG5ldyBTZXQ8c3RyaW5nPigpO1xyXG5jb25zdCBNQVhfREVQVEggPSA1O1xyXG5cclxuLyoqXHJcbiAqIENoZWNrIGlmIGFuIGVudGl0eSBpcyBjdXJyZW50bHkgYmVpbmcgcHJvY2Vzc2VkXHJcbiAqL1xyXG5leHBvcnQgZnVuY3Rpb24gaXNQcm9jZXNzaW5nKGVudGl0eVR5cGU6IHN0cmluZywgZW50aXR5SWQ6IHN0cmluZyk6IGJvb2xlYW4ge1xyXG4gIHJldHVybiBwcm9jZXNzaW5nU3RhY2suaGFzKGAke2VudGl0eVR5cGV9OiR7ZW50aXR5SWR9YCk7XHJcbn1cclxuXHJcbi8qKlxyXG4gKiBTdGFydCBwcm9jZXNzaW5nIGFuIGVudGl0eSAtIHRocm93cyBlcnJvciBpZiBjaXJjdWxhciByZWZlcmVuY2UgZGV0ZWN0ZWRcclxuICovXHJcbmV4cG9ydCBmdW5jdGlvbiBzdGFydFByb2Nlc3NpbmcoZW50aXR5VHlwZTogc3RyaW5nLCBlbnRpdHlJZDogc3RyaW5nKTogdm9pZCB7XHJcbiAgY29uc3Qga2V5ID0gYCR7ZW50aXR5VHlwZX06JHtlbnRpdHlJZH1gO1xyXG4gIFxyXG4gIGlmIChwcm9jZXNzaW5nU3RhY2suaGFzKGtleSkpIHtcclxuICAgIHRocm93IG5ldyBFcnJvcihgQ2lyY3VsYXIgcmVmZXJlbmNlIGRldGVjdGVkOiAke2tleX1gKTtcclxuICB9XHJcbiAgXHJcbiAgaWYgKHByb2Nlc3NpbmdTdGFjay5zaXplID49IE1BWF9ERVBUSCkge1xyXG4gICAgdGhyb3cgbmV3IEVycm9yKGBNYXggcHJvY2Vzc2luZyBkZXB0aCBleGNlZWRlZDogJHtNQVhfREVQVEh9YCk7XHJcbiAgfVxyXG4gIFxyXG4gIHByb2Nlc3NpbmdTdGFjay5hZGQoa2V5KTtcclxuICBjb25zb2xlLmxvZyhgW0NpcmN1aXRCcmVha2VyXSBTdGFydGVkIHByb2Nlc3Npbmc6ICR7a2V5fSAoZGVwdGg6ICR7cHJvY2Vzc2luZ1N0YWNrLnNpemV9KWApO1xyXG59XHJcblxyXG4vKipcclxuICogRW5kIHByb2Nlc3NpbmcgYW4gZW50aXR5XHJcbiAqL1xyXG5leHBvcnQgZnVuY3Rpb24gZW5kUHJvY2Vzc2luZyhlbnRpdHlUeXBlOiBzdHJpbmcsIGVudGl0eUlkOiBzdHJpbmcpOiB2b2lkIHtcclxuICBjb25zdCBrZXkgPSBgJHtlbnRpdHlUeXBlfToke2VudGl0eUlkfWA7XHJcbiAgcHJvY2Vzc2luZ1N0YWNrLmRlbGV0ZShrZXkpO1xyXG4gIGNvbnNvbGUubG9nKGBbQ2lyY3VpdEJyZWFrZXJdIEVuZGVkIHByb2Nlc3Npbmc6ICR7a2V5fSAoZGVwdGg6ICR7cHJvY2Vzc2luZ1N0YWNrLnNpemV9KWApO1xyXG59XHJcblxyXG4vKipcclxuICogR2V0IGN1cnJlbnQgcHJvY2Vzc2luZyBzdGF0dXMgZm9yIGRlYnVnZ2luZ1xyXG4gKi9cclxuZXhwb3J0IGZ1bmN0aW9uIGdldFByb2Nlc3NpbmdTdGF0dXMoKToge1xyXG4gIHN0YWNrOiBzdHJpbmdbXTtcclxuICBkZXB0aDogbnVtYmVyO1xyXG4gIG1heERlcHRoOiBudW1iZXI7XHJcbn0ge1xyXG4gIHJldHVybiB7XHJcbiAgICBzdGFjazogQXJyYXkuZnJvbShwcm9jZXNzaW5nU3RhY2spLFxyXG4gICAgZGVwdGg6IHByb2Nlc3NpbmdTdGFjay5zaXplLFxyXG4gICAgbWF4RGVwdGg6IE1BWF9ERVBUSFxyXG4gIH07XHJcbn1cclxuXHJcbi8qKlxyXG4gKiBDbGVhciBhbGwgcHJvY2Vzc2luZyBzdGF0ZSAoZW1lcmdlbmN5IHJlc2V0KVxyXG4gKi9cclxuZXhwb3J0IGZ1bmN0aW9uIGNsZWFyUHJvY2Vzc2luZ1N0YWNrKCk6IHZvaWQge1xyXG4gIHByb2Nlc3NpbmdTdGFjay5jbGVhcigpO1xyXG4gIGNvbnNvbGUubG9nKGBbQ2lyY3VpdEJyZWFrZXJdIENsZWFyZWQgcHJvY2Vzc2luZyBzdGFja2ApO1xyXG59XHJcblxyXG5cclxuIl0sIm5hbWVzIjpbImt2R2V0Iiwia3ZTZXQiLCJidWlsZEVmZmVjdEtleSIsImhhc0VmZmVjdCIsImVmZmVjdEtleSIsImtleSIsInZhbCIsIm1hcmtFZmZlY3QiLCJ0dGwiLCJjbGVhckVmZmVjdCIsImNsZWFyRWZmZWN0c0J5UHJlZml4IiwiZW50aXR5VHlwZSIsImVudGl0eUlkIiwicHJlZml4IiwiY29uc29sZSIsImxvZyIsInByb2Nlc3NpbmdTdGFjayIsIlNldCIsIk1BWF9ERVBUSCIsImlzUHJvY2Vzc2luZyIsImhhcyIsInN0YXJ0UHJvY2Vzc2luZyIsIkVycm9yIiwic2l6ZSIsImFkZCIsImVuZFByb2Nlc3NpbmciLCJkZWxldGUiLCJnZXRQcm9jZXNzaW5nU3RhdHVzIiwic3RhY2siLCJBcnJheSIsImZyb20iLCJkZXB0aCIsIm1heERlcHRoIiwiY2xlYXJQcm9jZXNzaW5nU3RhY2siLCJjbGVhciJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./data-store/effects-registry.ts\n");

/***/ }),

/***/ "(rsc)/./data-store/keys.ts":
/*!****************************!*\
  !*** ./data-store/keys.ts ***!
  \****************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   buildDataKey: () => (/* binding */ buildDataKey),\n/* harmony export */   buildEffectKey: () => (/* binding */ buildEffectKey),\n/* harmony export */   buildIndexKey: () => (/* binding */ buildIndexKey),\n/* harmony export */   buildLinkKey: () => (/* binding */ buildLinkKey),\n/* harmony export */   buildLinksIndexKey: () => (/* binding */ buildLinksIndexKey),\n/* harmony export */   buildLogKey: () => (/* binding */ buildLogKey)\n/* harmony export */ });\n// data-store/keys.ts\n// Centralized KV key builders. Keep shapes consistent across repositories.\n// Production-only system - no environment namespacing needed\nfunction buildDataKey(entity, id) {\n    return `data:${entity}:${id}`;\n}\nfunction buildIndexKey(entity) {\n    return `index:${entity}`; // set of ids\n}\nfunction buildLinksIndexKey(entityType, id) {\n    return `index:links:by-entity:${entityType}:${id}`; // set of link ids\n}\nfunction buildLinkKey(id) {\n    return `links:link:${id}`;\n}\nfunction buildEffectKey(effectKey) {\n    return `effects:${effectKey}`;\n}\nfunction buildLogKey(entity, yyyymm) {\n    return yyyymm ? `logs:${entity}:${yyyymm}` : `logs:${entity}`;\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9kYXRhLXN0b3JlL2tleXMudHMiLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7O0FBQUEscUJBQXFCO0FBQ3JCLDJFQUEyRTtBQUMzRSw2REFBNkQ7QUFFdEQsU0FBU0EsYUFBYUMsTUFBYyxFQUFFQyxFQUFVO0lBQ3JELE9BQU8sQ0FBQyxLQUFLLEVBQUVELE9BQU8sQ0FBQyxFQUFFQyxHQUFHLENBQUM7QUFDL0I7QUFFTyxTQUFTQyxjQUFjRixNQUFjO0lBQzFDLE9BQU8sQ0FBQyxNQUFNLEVBQUVBLE9BQU8sQ0FBQyxFQUFFLGFBQWE7QUFDekM7QUFFTyxTQUFTRyxtQkFBbUJDLFVBQWtCLEVBQUVILEVBQVU7SUFDL0QsT0FBTyxDQUFDLHNCQUFzQixFQUFFRyxXQUFXLENBQUMsRUFBRUgsR0FBRyxDQUFDLEVBQUUsa0JBQWtCO0FBQ3hFO0FBRU8sU0FBU0ksYUFBYUosRUFBVTtJQUNyQyxPQUFPLENBQUMsV0FBVyxFQUFFQSxHQUFHLENBQUM7QUFDM0I7QUFFTyxTQUFTSyxlQUFlQyxTQUFpQjtJQUM5QyxPQUFPLENBQUMsUUFBUSxFQUFFQSxVQUFVLENBQUM7QUFDL0I7QUFFTyxTQUFTQyxZQUFZUixNQUFjLEVBQUVTLE1BQWU7SUFDekQsT0FBT0EsU0FDSCxDQUFDLEtBQUssRUFBRVQsT0FBTyxDQUFDLEVBQUVTLE9BQU8sQ0FBQyxHQUMxQixDQUFDLEtBQUssRUFBRVQsT0FBTyxDQUFDO0FBQ3RCIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vdGhlZ2FtZS1hZG1pbi8uL2RhdGEtc3RvcmUva2V5cy50cz83MGUyIl0sInNvdXJjZXNDb250ZW50IjpbIi8vIGRhdGEtc3RvcmUva2V5cy50c1xyXG4vLyBDZW50cmFsaXplZCBLViBrZXkgYnVpbGRlcnMuIEtlZXAgc2hhcGVzIGNvbnNpc3RlbnQgYWNyb3NzIHJlcG9zaXRvcmllcy5cclxuLy8gUHJvZHVjdGlvbi1vbmx5IHN5c3RlbSAtIG5vIGVudmlyb25tZW50IG5hbWVzcGFjaW5nIG5lZWRlZFxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIGJ1aWxkRGF0YUtleShlbnRpdHk6IHN0cmluZywgaWQ6IHN0cmluZyk6IHN0cmluZyB7XHJcbiAgcmV0dXJuIGBkYXRhOiR7ZW50aXR5fToke2lkfWA7XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBidWlsZEluZGV4S2V5KGVudGl0eTogc3RyaW5nKTogc3RyaW5nIHtcclxuICByZXR1cm4gYGluZGV4OiR7ZW50aXR5fWA7IC8vIHNldCBvZiBpZHNcclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIGJ1aWxkTGlua3NJbmRleEtleShlbnRpdHlUeXBlOiBzdHJpbmcsIGlkOiBzdHJpbmcpOiBzdHJpbmcge1xyXG4gIHJldHVybiBgaW5kZXg6bGlua3M6YnktZW50aXR5OiR7ZW50aXR5VHlwZX06JHtpZH1gOyAvLyBzZXQgb2YgbGluayBpZHNcclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIGJ1aWxkTGlua0tleShpZDogc3RyaW5nKTogc3RyaW5nIHtcclxuICByZXR1cm4gYGxpbmtzOmxpbms6JHtpZH1gO1xyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gYnVpbGRFZmZlY3RLZXkoZWZmZWN0S2V5OiBzdHJpbmcpOiBzdHJpbmcge1xyXG4gIHJldHVybiBgZWZmZWN0czoke2VmZmVjdEtleX1gO1xyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gYnVpbGRMb2dLZXkoZW50aXR5OiBzdHJpbmcsIHl5eXltbT86IHN0cmluZyk6IHN0cmluZyB7XHJcbiAgcmV0dXJuIHl5eXltbVxyXG4gICAgPyBgbG9nczoke2VudGl0eX06JHt5eXl5bW19YFxyXG4gICAgOiBgbG9nczoke2VudGl0eX1gO1xyXG59XHJcblxyXG5cclxuIl0sIm5hbWVzIjpbImJ1aWxkRGF0YUtleSIsImVudGl0eSIsImlkIiwiYnVpbGRJbmRleEtleSIsImJ1aWxkTGlua3NJbmRleEtleSIsImVudGl0eVR5cGUiLCJidWlsZExpbmtLZXkiLCJidWlsZEVmZmVjdEtleSIsImVmZmVjdEtleSIsImJ1aWxkTG9nS2V5IiwieXl5eW1tIl0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(rsc)/./data-store/keys.ts\n");

/***/ }),

/***/ "(rsc)/./data-store/kv.ts":
/*!**************************!*\
  !*** ./data-store/kv.ts ***!
  \**************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   kvDel: () => (/* binding */ kvDel),\n/* harmony export */   kvGet: () => (/* binding */ kvGet),\n/* harmony export */   kvMGet: () => (/* binding */ kvMGet),\n/* harmony export */   kvSAdd: () => (/* binding */ kvSAdd),\n/* harmony export */   kvSMembers: () => (/* binding */ kvSMembers),\n/* harmony export */   kvSRem: () => (/* binding */ kvSRem),\n/* harmony export */   kvScan: () => (/* binding */ kvScan),\n/* harmony export */   kvSet: () => (/* binding */ kvSet)\n/* harmony export */ });\n/* harmony import */ var _vercel_kv__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @vercel/kv */ \"(rsc)/./node_modules/@vercel/kv/dist/index.js\");\n// data-store/kv.ts\n// Thin server-only wrappers around @vercel/kv. No HTTP calls to own routes.\n\nasync function kvGet(key) {\n    return await _vercel_kv__WEBPACK_IMPORTED_MODULE_0__.kv.get(key) ?? null;\n}\nasync function kvSet(key, value) {\n    await _vercel_kv__WEBPACK_IMPORTED_MODULE_0__.kv.set(key, value);\n}\nasync function kvDel(key) {\n    await _vercel_kv__WEBPACK_IMPORTED_MODULE_0__.kv.del(key);\n}\nasync function kvMGet(keys) {\n    const res = await _vercel_kv__WEBPACK_IMPORTED_MODULE_0__.kv.mget(keys);\n    return res.map((v)=>v ?? null);\n}\nasync function kvScan(prefix, limit = 100) {\n    const keys = [];\n    const iter = _vercel_kv__WEBPACK_IMPORTED_MODULE_0__.kv.scanIterator({\n        match: `${prefix}*`,\n        count: limit\n    });\n    for await (const key of iter){\n        keys.push(key);\n    }\n    return keys;\n}\nasync function kvSAdd(key, ...members) {\n    if (members.length) await _vercel_kv__WEBPACK_IMPORTED_MODULE_0__.kv.sadd(key, ...members);\n}\nasync function kvSRem(key, ...members) {\n    if (members.length) await _vercel_kv__WEBPACK_IMPORTED_MODULE_0__.kv.srem(key, ...members);\n}\nasync function kvSMembers(key) {\n    const members = await _vercel_kv__WEBPACK_IMPORTED_MODULE_0__.kv.smembers(key);\n    return members ?? [];\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9kYXRhLXN0b3JlL2t2LnRzIiwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7OztBQUFBLG1CQUFtQjtBQUNuQiw0RUFBNEU7QUFFNUM7QUFFekIsZUFBZUMsTUFBU0MsR0FBVztJQUN4QyxPQUFPLE1BQU9GLDBDQUFFQSxDQUFDRyxHQUFHLENBQUlELFFBQVM7QUFDbkM7QUFFTyxlQUFlRSxNQUFTRixHQUFXLEVBQUVHLEtBQVE7SUFDbEQsTUFBTUwsMENBQUVBLENBQUNNLEdBQUcsQ0FBQ0osS0FBS0c7QUFDcEI7QUFFTyxlQUFlRSxNQUFNTCxHQUFXO0lBQ3JDLE1BQU1GLDBDQUFFQSxDQUFDUSxHQUFHLENBQUNOO0FBQ2Y7QUFFTyxlQUFlTyxPQUFVQyxJQUFjO0lBQzVDLE1BQU1DLE1BQU0sTUFBTVgsMENBQUVBLENBQUNZLElBQUksQ0FBQ0Y7SUFDMUIsT0FBTyxJQUFlRyxHQUFHLENBQUNDLENBQUFBLElBQU1BLEtBQUs7QUFDdkM7QUFFTyxlQUFlQyxPQUFPQyxNQUFjLEVBQUVDLFFBQVEsR0FBRztJQUN0RCxNQUFNUCxPQUFpQixFQUFFO0lBQ3pCLE1BQU1RLE9BQU9sQiwwQ0FBRUEsQ0FBQ21CLFlBQVksQ0FBQztRQUFFQyxPQUFPLENBQUMsRUFBRUosT0FBTyxDQUFDLENBQUM7UUFBRUssT0FBT0o7SUFBTTtJQUNqRSxXQUFXLE1BQU1mLE9BQU9nQixLQUFNO1FBQzVCUixLQUFLWSxJQUFJLENBQUNwQjtJQUNaO0lBQ0EsT0FBT1E7QUFDVDtBQUVPLGVBQWVhLE9BQU9yQixHQUFXLEVBQUUsR0FBR3NCLE9BQWlCO0lBQzVELElBQUlBLFFBQVFDLE1BQU0sRUFBRSxNQUFNekIsMENBQUVBLENBQUMwQixJQUFJLENBQUN4QixRQUFTc0I7QUFDN0M7QUFFTyxlQUFlRyxPQUFPekIsR0FBVyxFQUFFLEdBQUdzQixPQUFpQjtJQUM1RCxJQUFJQSxRQUFRQyxNQUFNLEVBQUUsTUFBTXpCLDBDQUFFQSxDQUFDNEIsSUFBSSxDQUFDMUIsUUFBU3NCO0FBQzdDO0FBRU8sZUFBZUssV0FBVzNCLEdBQVc7SUFDMUMsTUFBTXNCLFVBQVUsTUFBTXhCLDBDQUFFQSxDQUFDOEIsUUFBUSxDQUFDNUI7SUFDbEMsT0FBT3NCLFdBQVcsRUFBRTtBQUN0QiIsInNvdXJjZXMiOlsid2VicGFjazovL3RoZWdhbWUtYWRtaW4vLi9kYXRhLXN0b3JlL2t2LnRzPzc1NDUiXSwic291cmNlc0NvbnRlbnQiOlsiLy8gZGF0YS1zdG9yZS9rdi50c1xyXG4vLyBUaGluIHNlcnZlci1vbmx5IHdyYXBwZXJzIGFyb3VuZCBAdmVyY2VsL2t2LiBObyBIVFRQIGNhbGxzIHRvIG93biByb3V0ZXMuXHJcblxyXG5pbXBvcnQgeyBrdiB9IGZyb20gJ0B2ZXJjZWwva3YnO1xyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGt2R2V0PFQ+KGtleTogc3RyaW5nKTogUHJvbWlzZTxUIHwgbnVsbD4ge1xyXG4gIHJldHVybiAoYXdhaXQga3YuZ2V0PFQ+KGtleSkpID8/IG51bGw7XHJcbn1cclxuXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBrdlNldDxUPihrZXk6IHN0cmluZywgdmFsdWU6IFQpOiBQcm9taXNlPHZvaWQ+IHtcclxuICBhd2FpdCBrdi5zZXQoa2V5LCB2YWx1ZSBhcyBhbnkpO1xyXG59XHJcblxyXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24ga3ZEZWwoa2V5OiBzdHJpbmcpOiBQcm9taXNlPHZvaWQ+IHtcclxuICBhd2FpdCBrdi5kZWwoa2V5KTtcclxufVxyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGt2TUdldDxUPihrZXlzOiBzdHJpbmdbXSk6IFByb21pc2U8KFQgfCBudWxsKVtdPiB7XHJcbiAgY29uc3QgcmVzID0gYXdhaXQga3YubWdldChrZXlzKTtcclxuICByZXR1cm4gKHJlcyBhcyBhbnlbXSkubWFwKHYgPT4gKHYgPz8gbnVsbCkpO1xyXG59XHJcblxyXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24ga3ZTY2FuKHByZWZpeDogc3RyaW5nLCBsaW1pdCA9IDEwMCk6IFByb21pc2U8c3RyaW5nW10+IHtcclxuICBjb25zdCBrZXlzOiBzdHJpbmdbXSA9IFtdO1xyXG4gIGNvbnN0IGl0ZXIgPSBrdi5zY2FuSXRlcmF0b3IoeyBtYXRjaDogYCR7cHJlZml4fSpgLCBjb3VudDogbGltaXQgfSk7XHJcbiAgZm9yIGF3YWl0IChjb25zdCBrZXkgb2YgaXRlcikge1xyXG4gICAga2V5cy5wdXNoKGtleSBhcyBzdHJpbmcpO1xyXG4gIH1cclxuICByZXR1cm4ga2V5cztcclxufVxyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGt2U0FkZChrZXk6IHN0cmluZywgLi4ubWVtYmVyczogc3RyaW5nW10pOiBQcm9taXNlPHZvaWQ+IHtcclxuICBpZiAobWVtYmVycy5sZW5ndGgpIGF3YWl0IGt2LnNhZGQoa2V5LCAuLi4obWVtYmVycyBhcyBbc3RyaW5nLCAuLi5zdHJpbmdbXV0pKTtcclxufVxyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGt2U1JlbShrZXk6IHN0cmluZywgLi4ubWVtYmVyczogc3RyaW5nW10pOiBQcm9taXNlPHZvaWQ+IHtcclxuICBpZiAobWVtYmVycy5sZW5ndGgpIGF3YWl0IGt2LnNyZW0oa2V5LCAuLi4obWVtYmVycyBhcyBbc3RyaW5nLCAuLi5zdHJpbmdbXV0pKTtcclxufVxyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGt2U01lbWJlcnMoa2V5OiBzdHJpbmcpOiBQcm9taXNlPHN0cmluZ1tdPiB7XHJcbiAgY29uc3QgbWVtYmVycyA9IGF3YWl0IGt2LnNtZW1iZXJzKGtleSk7XHJcbiAgcmV0dXJuIG1lbWJlcnMgPz8gW107XHJcbn1cclxuXHJcblxyXG4iXSwibmFtZXMiOlsia3YiLCJrdkdldCIsImtleSIsImdldCIsImt2U2V0IiwidmFsdWUiLCJzZXQiLCJrdkRlbCIsImRlbCIsImt2TUdldCIsImtleXMiLCJyZXMiLCJtZ2V0IiwibWFwIiwidiIsImt2U2NhbiIsInByZWZpeCIsImxpbWl0IiwiaXRlciIsInNjYW5JdGVyYXRvciIsIm1hdGNoIiwiY291bnQiLCJwdXNoIiwia3ZTQWRkIiwibWVtYmVycyIsImxlbmd0aCIsInNhZGQiLCJrdlNSZW0iLCJzcmVtIiwia3ZTTWVtYmVycyIsInNtZW1iZXJzIl0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(rsc)/./data-store/kv.ts\n");

/***/ }),

/***/ "(rsc)/./data-store/repositories/character.repo.ts":
/*!***************************************************!*\
  !*** ./data-store/repositories/character.repo.ts ***!
  \***************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   deleteCharacter: () => (/* binding */ deleteCharacter),\n/* harmony export */   getAllCharacters: () => (/* binding */ getAllCharacters),\n/* harmony export */   getCharacterById: () => (/* binding */ getCharacterById),\n/* harmony export */   upsertCharacter: () => (/* binding */ upsertCharacter)\n/* harmony export */ });\n/* harmony import */ var _kv__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../kv */ \"(rsc)/./data-store/kv.ts\");\n/* harmony import */ var _keys__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../keys */ \"(rsc)/./data-store/keys.ts\");\n// data-store/repositories/character.repo.ts\n\n\nconst ENTITY = \"characters\";\nasync function getAllCharacters() {\n    const indexKey = (0,_keys__WEBPACK_IMPORTED_MODULE_1__.buildIndexKey)(ENTITY);\n    const ids = await (0,_kv__WEBPACK_IMPORTED_MODULE_0__.kvSMembers)(indexKey);\n    if (ids.length === 0) return [];\n    const characters = [];\n    for (const id of ids){\n        const key = (0,_keys__WEBPACK_IMPORTED_MODULE_1__.buildDataKey)(ENTITY, id);\n        const character = await (0,_kv__WEBPACK_IMPORTED_MODULE_0__.kvGet)(key);\n        if (character) characters.push(character);\n    }\n    return characters;\n}\nasync function getCharacterById(id) {\n    const key = (0,_keys__WEBPACK_IMPORTED_MODULE_1__.buildDataKey)(ENTITY, id);\n    return await (0,_kv__WEBPACK_IMPORTED_MODULE_0__.kvGet)(key);\n}\nasync function upsertCharacter(character) {\n    const key = (0,_keys__WEBPACK_IMPORTED_MODULE_1__.buildDataKey)(ENTITY, character.id);\n    const indexKey = (0,_keys__WEBPACK_IMPORTED_MODULE_1__.buildIndexKey)(ENTITY);\n    await (0,_kv__WEBPACK_IMPORTED_MODULE_0__.kvSet)(key, character);\n    await (0,_kv__WEBPACK_IMPORTED_MODULE_0__.kvSAdd)(indexKey, character.id);\n    return character;\n}\nasync function deleteCharacter(id) {\n    const key = (0,_keys__WEBPACK_IMPORTED_MODULE_1__.buildDataKey)(ENTITY, id);\n    const indexKey = (0,_keys__WEBPACK_IMPORTED_MODULE_1__.buildIndexKey)(ENTITY);\n    await (0,_kv__WEBPACK_IMPORTED_MODULE_0__.kvDel)(key);\n    await (0,_kv__WEBPACK_IMPORTED_MODULE_0__.kvSRem)(indexKey, id);\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9kYXRhLXN0b3JlL3JlcG9zaXRvcmllcy9jaGFyYWN0ZXIucmVwby50cyIsIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7QUFBQSw0Q0FBNEM7QUFDNEI7QUFDbEI7QUFHdEQsTUFBTVEsU0FBUztBQUVSLGVBQWVDO0lBQ3BCLE1BQU1DLFdBQVdILG9EQUFhQSxDQUFDQztJQUMvQixNQUFNRyxNQUFNLE1BQU1OLCtDQUFVQSxDQUFDSztJQUM3QixJQUFJQyxJQUFJQyxNQUFNLEtBQUssR0FBRyxPQUFPLEVBQUU7SUFFL0IsTUFBTUMsYUFBMEIsRUFBRTtJQUNsQyxLQUFLLE1BQU1DLE1BQU1ILElBQUs7UUFDcEIsTUFBTUksTUFBTVQsbURBQVlBLENBQUNFLFFBQVFNO1FBQ2pDLE1BQU1FLFlBQVksTUFBTWhCLDBDQUFLQSxDQUFZZTtRQUN6QyxJQUFJQyxXQUFXSCxXQUFXSSxJQUFJLENBQUNEO0lBQ2pDO0lBRUEsT0FBT0g7QUFDVDtBQUVPLGVBQWVLLGlCQUFpQkosRUFBVTtJQUMvQyxNQUFNQyxNQUFNVCxtREFBWUEsQ0FBQ0UsUUFBUU07SUFDakMsT0FBTyxNQUFNZCwwQ0FBS0EsQ0FBWWU7QUFDaEM7QUFFTyxlQUFlSSxnQkFBZ0JILFNBQW9CO0lBQ3hELE1BQU1ELE1BQU1ULG1EQUFZQSxDQUFDRSxRQUFRUSxVQUFVRixFQUFFO0lBQzdDLE1BQU1KLFdBQVdILG9EQUFhQSxDQUFDQztJQUUvQixNQUFNUCwwQ0FBS0EsQ0FBQ2MsS0FBS0M7SUFDakIsTUFBTWIsMkNBQU1BLENBQUNPLFVBQVVNLFVBQVVGLEVBQUU7SUFFbkMsT0FBT0U7QUFDVDtBQUVPLGVBQWVJLGdCQUFnQk4sRUFBVTtJQUM5QyxNQUFNQyxNQUFNVCxtREFBWUEsQ0FBQ0UsUUFBUU07SUFDakMsTUFBTUosV0FBV0gsb0RBQWFBLENBQUNDO0lBRS9CLE1BQU1OLDBDQUFLQSxDQUFDYTtJQUNaLE1BQU1YLDJDQUFNQSxDQUFDTSxVQUFVSTtBQUN6QiIsInNvdXJjZXMiOlsid2VicGFjazovL3RoZWdhbWUtYWRtaW4vLi9kYXRhLXN0b3JlL3JlcG9zaXRvcmllcy9jaGFyYWN0ZXIucmVwby50cz9lYTU0Il0sInNvdXJjZXNDb250ZW50IjpbIi8vIGRhdGEtc3RvcmUvcmVwb3NpdG9yaWVzL2NoYXJhY3Rlci5yZXBvLnRzXHJcbmltcG9ydCB7IGt2R2V0LCBrdlNldCwga3ZEZWwsIGt2U0FkZCwga3ZTUmVtLCBrdlNNZW1iZXJzIH0gZnJvbSAnLi4va3YnO1xyXG5pbXBvcnQgeyBidWlsZERhdGFLZXksIGJ1aWxkSW5kZXhLZXkgfSBmcm9tICcuLi9rZXlzJztcclxuaW1wb3J0IHR5cGUgeyBDaGFyYWN0ZXIgfSBmcm9tICdAL3R5cGVzL2VudGl0aWVzJztcclxuXHJcbmNvbnN0IEVOVElUWSA9ICdjaGFyYWN0ZXJzJztcclxuXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBnZXRBbGxDaGFyYWN0ZXJzKCk6IFByb21pc2U8Q2hhcmFjdGVyW10+IHtcclxuICBjb25zdCBpbmRleEtleSA9IGJ1aWxkSW5kZXhLZXkoRU5USVRZKTtcclxuICBjb25zdCBpZHMgPSBhd2FpdCBrdlNNZW1iZXJzKGluZGV4S2V5KTtcclxuICBpZiAoaWRzLmxlbmd0aCA9PT0gMCkgcmV0dXJuIFtdO1xyXG4gIFxyXG4gIGNvbnN0IGNoYXJhY3RlcnM6IENoYXJhY3RlcltdID0gW107XHJcbiAgZm9yIChjb25zdCBpZCBvZiBpZHMpIHtcclxuICAgIGNvbnN0IGtleSA9IGJ1aWxkRGF0YUtleShFTlRJVFksIGlkKTtcclxuICAgIGNvbnN0IGNoYXJhY3RlciA9IGF3YWl0IGt2R2V0PENoYXJhY3Rlcj4oa2V5KTtcclxuICAgIGlmIChjaGFyYWN0ZXIpIGNoYXJhY3RlcnMucHVzaChjaGFyYWN0ZXIpO1xyXG4gIH1cclxuICBcclxuICByZXR1cm4gY2hhcmFjdGVycztcclxufVxyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGdldENoYXJhY3RlckJ5SWQoaWQ6IHN0cmluZyk6IFByb21pc2U8Q2hhcmFjdGVyIHwgbnVsbD4ge1xyXG4gIGNvbnN0IGtleSA9IGJ1aWxkRGF0YUtleShFTlRJVFksIGlkKTtcclxuICByZXR1cm4gYXdhaXQga3ZHZXQ8Q2hhcmFjdGVyPihrZXkpO1xyXG59XHJcblxyXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gdXBzZXJ0Q2hhcmFjdGVyKGNoYXJhY3RlcjogQ2hhcmFjdGVyKTogUHJvbWlzZTxDaGFyYWN0ZXI+IHtcclxuICBjb25zdCBrZXkgPSBidWlsZERhdGFLZXkoRU5USVRZLCBjaGFyYWN0ZXIuaWQpO1xyXG4gIGNvbnN0IGluZGV4S2V5ID0gYnVpbGRJbmRleEtleShFTlRJVFkpO1xyXG4gIFxyXG4gIGF3YWl0IGt2U2V0KGtleSwgY2hhcmFjdGVyKTtcclxuICBhd2FpdCBrdlNBZGQoaW5kZXhLZXksIGNoYXJhY3Rlci5pZCk7XHJcbiAgXHJcbiAgcmV0dXJuIGNoYXJhY3RlcjtcclxufVxyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGRlbGV0ZUNoYXJhY3RlcihpZDogc3RyaW5nKTogUHJvbWlzZTx2b2lkPiB7XHJcbiAgY29uc3Qga2V5ID0gYnVpbGREYXRhS2V5KEVOVElUWSwgaWQpO1xyXG4gIGNvbnN0IGluZGV4S2V5ID0gYnVpbGRJbmRleEtleShFTlRJVFkpO1xyXG4gIFxyXG4gIGF3YWl0IGt2RGVsKGtleSk7XHJcbiAgYXdhaXQga3ZTUmVtKGluZGV4S2V5LCBpZCk7XHJcbn1cclxuIl0sIm5hbWVzIjpbImt2R2V0Iiwia3ZTZXQiLCJrdkRlbCIsImt2U0FkZCIsImt2U1JlbSIsImt2U01lbWJlcnMiLCJidWlsZERhdGFLZXkiLCJidWlsZEluZGV4S2V5IiwiRU5USVRZIiwiZ2V0QWxsQ2hhcmFjdGVycyIsImluZGV4S2V5IiwiaWRzIiwibGVuZ3RoIiwiY2hhcmFjdGVycyIsImlkIiwia2V5IiwiY2hhcmFjdGVyIiwicHVzaCIsImdldENoYXJhY3RlckJ5SWQiLCJ1cHNlcnRDaGFyYWN0ZXIiLCJkZWxldGVDaGFyYWN0ZXIiXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./data-store/repositories/character.repo.ts\n");

/***/ }),

/***/ "(rsc)/./data-store/repositories/financial.repo.ts":
/*!***************************************************!*\
  !*** ./data-store/repositories/financial.repo.ts ***!
  \***************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   deleteFinancial: () => (/* binding */ deleteFinancial),\n/* harmony export */   getAllFinancials: () => (/* binding */ getAllFinancials),\n/* harmony export */   getFinancialById: () => (/* binding */ getFinancialById),\n/* harmony export */   upsertFinancial: () => (/* binding */ upsertFinancial)\n/* harmony export */ });\n/* harmony import */ var _kv__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../kv */ \"(rsc)/./data-store/kv.ts\");\n/* harmony import */ var _keys__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../keys */ \"(rsc)/./data-store/keys.ts\");\n// data-store/repositories/financial.repo.ts\n\n\nconst ENTITY = \"financials\";\nasync function getAllFinancials() {\n    const indexKey = (0,_keys__WEBPACK_IMPORTED_MODULE_1__.buildIndexKey)(ENTITY);\n    const ids = await (0,_kv__WEBPACK_IMPORTED_MODULE_0__.kvSMembers)(indexKey);\n    if (ids.length === 0) return [];\n    const financials = [];\n    for (const id of ids){\n        const key = (0,_keys__WEBPACK_IMPORTED_MODULE_1__.buildDataKey)(ENTITY, id);\n        const financial = await (0,_kv__WEBPACK_IMPORTED_MODULE_0__.kvGet)(key);\n        if (financial) financials.push(financial);\n    }\n    return financials;\n}\nasync function getFinancialById(id) {\n    const key = (0,_keys__WEBPACK_IMPORTED_MODULE_1__.buildDataKey)(ENTITY, id);\n    return await (0,_kv__WEBPACK_IMPORTED_MODULE_0__.kvGet)(key);\n}\nasync function upsertFinancial(financial) {\n    const key = (0,_keys__WEBPACK_IMPORTED_MODULE_1__.buildDataKey)(ENTITY, financial.id);\n    const indexKey = (0,_keys__WEBPACK_IMPORTED_MODULE_1__.buildIndexKey)(ENTITY);\n    await (0,_kv__WEBPACK_IMPORTED_MODULE_0__.kvSet)(key, financial);\n    await (0,_kv__WEBPACK_IMPORTED_MODULE_0__.kvSAdd)(indexKey, financial.id);\n    return financial;\n}\nasync function deleteFinancial(id) {\n    const key = (0,_keys__WEBPACK_IMPORTED_MODULE_1__.buildDataKey)(ENTITY, id);\n    const indexKey = (0,_keys__WEBPACK_IMPORTED_MODULE_1__.buildIndexKey)(ENTITY);\n    await (0,_kv__WEBPACK_IMPORTED_MODULE_0__.kvDel)(key);\n    await (0,_kv__WEBPACK_IMPORTED_MODULE_0__.kvSRem)(indexKey, id);\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9kYXRhLXN0b3JlL3JlcG9zaXRvcmllcy9maW5hbmNpYWwucmVwby50cyIsIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7QUFBQSw0Q0FBNEM7QUFDNEI7QUFDbEI7QUFHdEQsTUFBTVEsU0FBUztBQUVSLGVBQWVDO0lBQ3BCLE1BQU1DLFdBQVdILG9EQUFhQSxDQUFDQztJQUMvQixNQUFNRyxNQUFNLE1BQU1OLCtDQUFVQSxDQUFDSztJQUM3QixJQUFJQyxJQUFJQyxNQUFNLEtBQUssR0FBRyxPQUFPLEVBQUU7SUFFL0IsTUFBTUMsYUFBZ0MsRUFBRTtJQUN4QyxLQUFLLE1BQU1DLE1BQU1ILElBQUs7UUFDcEIsTUFBTUksTUFBTVQsbURBQVlBLENBQUNFLFFBQVFNO1FBQ2pDLE1BQU1FLFlBQVksTUFBTWhCLDBDQUFLQSxDQUFrQmU7UUFDL0MsSUFBSUMsV0FBV0gsV0FBV0ksSUFBSSxDQUFDRDtJQUNqQztJQUVBLE9BQU9IO0FBQ1Q7QUFFTyxlQUFlSyxpQkFBaUJKLEVBQVU7SUFDL0MsTUFBTUMsTUFBTVQsbURBQVlBLENBQUNFLFFBQVFNO0lBQ2pDLE9BQU8sTUFBTWQsMENBQUtBLENBQWtCZTtBQUN0QztBQUVPLGVBQWVJLGdCQUFnQkgsU0FBMEI7SUFDOUQsTUFBTUQsTUFBTVQsbURBQVlBLENBQUNFLFFBQVFRLFVBQVVGLEVBQUU7SUFDN0MsTUFBTUosV0FBV0gsb0RBQWFBLENBQUNDO0lBRS9CLE1BQU1QLDBDQUFLQSxDQUFDYyxLQUFLQztJQUNqQixNQUFNYiwyQ0FBTUEsQ0FBQ08sVUFBVU0sVUFBVUYsRUFBRTtJQUVuQyxPQUFPRTtBQUNUO0FBRU8sZUFBZUksZ0JBQWdCTixFQUFVO0lBQzlDLE1BQU1DLE1BQU1ULG1EQUFZQSxDQUFDRSxRQUFRTTtJQUNqQyxNQUFNSixXQUFXSCxvREFBYUEsQ0FBQ0M7SUFFL0IsTUFBTU4sMENBQUtBLENBQUNhO0lBQ1osTUFBTVgsMkNBQU1BLENBQUNNLFVBQVVJO0FBQ3pCIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vdGhlZ2FtZS1hZG1pbi8uL2RhdGEtc3RvcmUvcmVwb3NpdG9yaWVzL2ZpbmFuY2lhbC5yZXBvLnRzP2RlMGEiXSwic291cmNlc0NvbnRlbnQiOlsiLy8gZGF0YS1zdG9yZS9yZXBvc2l0b3JpZXMvZmluYW5jaWFsLnJlcG8udHNcclxuaW1wb3J0IHsga3ZHZXQsIGt2U2V0LCBrdkRlbCwga3ZTQWRkLCBrdlNSZW0sIGt2U01lbWJlcnMgfSBmcm9tICcuLi9rdic7XHJcbmltcG9ydCB7IGJ1aWxkRGF0YUtleSwgYnVpbGRJbmRleEtleSB9IGZyb20gJy4uL2tleXMnO1xyXG5pbXBvcnQgdHlwZSB7IEZpbmFuY2lhbFJlY29yZCB9IGZyb20gJ0AvdHlwZXMvZW50aXRpZXMnO1xyXG5cclxuY29uc3QgRU5USVRZID0gJ2ZpbmFuY2lhbHMnO1xyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGdldEFsbEZpbmFuY2lhbHMoKTogUHJvbWlzZTxGaW5hbmNpYWxSZWNvcmRbXT4ge1xyXG4gIGNvbnN0IGluZGV4S2V5ID0gYnVpbGRJbmRleEtleShFTlRJVFkpO1xyXG4gIGNvbnN0IGlkcyA9IGF3YWl0IGt2U01lbWJlcnMoaW5kZXhLZXkpO1xyXG4gIGlmIChpZHMubGVuZ3RoID09PSAwKSByZXR1cm4gW107XHJcbiAgXHJcbiAgY29uc3QgZmluYW5jaWFsczogRmluYW5jaWFsUmVjb3JkW10gPSBbXTtcclxuICBmb3IgKGNvbnN0IGlkIG9mIGlkcykge1xyXG4gICAgY29uc3Qga2V5ID0gYnVpbGREYXRhS2V5KEVOVElUWSwgaWQpO1xyXG4gICAgY29uc3QgZmluYW5jaWFsID0gYXdhaXQga3ZHZXQ8RmluYW5jaWFsUmVjb3JkPihrZXkpO1xyXG4gICAgaWYgKGZpbmFuY2lhbCkgZmluYW5jaWFscy5wdXNoKGZpbmFuY2lhbCk7XHJcbiAgfVxyXG4gIFxyXG4gIHJldHVybiBmaW5hbmNpYWxzO1xyXG59XHJcblxyXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gZ2V0RmluYW5jaWFsQnlJZChpZDogc3RyaW5nKTogUHJvbWlzZTxGaW5hbmNpYWxSZWNvcmQgfCBudWxsPiB7XHJcbiAgY29uc3Qga2V5ID0gYnVpbGREYXRhS2V5KEVOVElUWSwgaWQpO1xyXG4gIHJldHVybiBhd2FpdCBrdkdldDxGaW5hbmNpYWxSZWNvcmQ+KGtleSk7XHJcbn1cclxuXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiB1cHNlcnRGaW5hbmNpYWwoZmluYW5jaWFsOiBGaW5hbmNpYWxSZWNvcmQpOiBQcm9taXNlPEZpbmFuY2lhbFJlY29yZD4ge1xyXG4gIGNvbnN0IGtleSA9IGJ1aWxkRGF0YUtleShFTlRJVFksIGZpbmFuY2lhbC5pZCk7XHJcbiAgY29uc3QgaW5kZXhLZXkgPSBidWlsZEluZGV4S2V5KEVOVElUWSk7XHJcbiAgXHJcbiAgYXdhaXQga3ZTZXQoa2V5LCBmaW5hbmNpYWwpO1xyXG4gIGF3YWl0IGt2U0FkZChpbmRleEtleSwgZmluYW5jaWFsLmlkKTtcclxuICBcclxuICByZXR1cm4gZmluYW5jaWFsO1xyXG59XHJcblxyXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gZGVsZXRlRmluYW5jaWFsKGlkOiBzdHJpbmcpOiBQcm9taXNlPHZvaWQ+IHtcclxuICBjb25zdCBrZXkgPSBidWlsZERhdGFLZXkoRU5USVRZLCBpZCk7XHJcbiAgY29uc3QgaW5kZXhLZXkgPSBidWlsZEluZGV4S2V5KEVOVElUWSk7XHJcbiAgXHJcbiAgYXdhaXQga3ZEZWwoa2V5KTtcclxuICBhd2FpdCBrdlNSZW0oaW5kZXhLZXksIGlkKTtcclxufVxyXG4iXSwibmFtZXMiOlsia3ZHZXQiLCJrdlNldCIsImt2RGVsIiwia3ZTQWRkIiwia3ZTUmVtIiwia3ZTTWVtYmVycyIsImJ1aWxkRGF0YUtleSIsImJ1aWxkSW5kZXhLZXkiLCJFTlRJVFkiLCJnZXRBbGxGaW5hbmNpYWxzIiwiaW5kZXhLZXkiLCJpZHMiLCJsZW5ndGgiLCJmaW5hbmNpYWxzIiwiaWQiLCJrZXkiLCJmaW5hbmNpYWwiLCJwdXNoIiwiZ2V0RmluYW5jaWFsQnlJZCIsInVwc2VydEZpbmFuY2lhbCIsImRlbGV0ZUZpbmFuY2lhbCJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./data-store/repositories/financial.repo.ts\n");

/***/ }),

/***/ "(rsc)/./data-store/repositories/item.repo.ts":
/*!**********************************************!*\
  !*** ./data-store/repositories/item.repo.ts ***!
  \**********************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   deleteItem: () => (/* binding */ deleteItem),\n/* harmony export */   getAllItems: () => (/* binding */ getAllItems),\n/* harmony export */   getItemById: () => (/* binding */ getItemById),\n/* harmony export */   upsertItem: () => (/* binding */ upsertItem)\n/* harmony export */ });\n/* harmony import */ var _kv__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../kv */ \"(rsc)/./data-store/kv.ts\");\n/* harmony import */ var _keys__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../keys */ \"(rsc)/./data-store/keys.ts\");\n// data-store/repositories/item.repo.ts\n\n\nconst ENTITY = \"items\";\nasync function getAllItems() {\n    const indexKey = (0,_keys__WEBPACK_IMPORTED_MODULE_1__.buildIndexKey)(ENTITY);\n    const ids = await (0,_kv__WEBPACK_IMPORTED_MODULE_0__.kvSMembers)(indexKey);\n    if (ids.length === 0) return [];\n    const items = [];\n    for (const id of ids){\n        const key = (0,_keys__WEBPACK_IMPORTED_MODULE_1__.buildDataKey)(ENTITY, id);\n        const item = await (0,_kv__WEBPACK_IMPORTED_MODULE_0__.kvGet)(key);\n        if (item) items.push(item);\n    }\n    return items;\n}\nasync function getItemById(id) {\n    const key = (0,_keys__WEBPACK_IMPORTED_MODULE_1__.buildDataKey)(ENTITY, id);\n    return await (0,_kv__WEBPACK_IMPORTED_MODULE_0__.kvGet)(key);\n}\nasync function upsertItem(item) {\n    const key = (0,_keys__WEBPACK_IMPORTED_MODULE_1__.buildDataKey)(ENTITY, item.id);\n    const indexKey = (0,_keys__WEBPACK_IMPORTED_MODULE_1__.buildIndexKey)(ENTITY);\n    await (0,_kv__WEBPACK_IMPORTED_MODULE_0__.kvSet)(key, item);\n    await (0,_kv__WEBPACK_IMPORTED_MODULE_0__.kvSAdd)(indexKey, item.id);\n    return item;\n}\nasync function deleteItem(id) {\n    const key = (0,_keys__WEBPACK_IMPORTED_MODULE_1__.buildDataKey)(ENTITY, id);\n    const indexKey = (0,_keys__WEBPACK_IMPORTED_MODULE_1__.buildIndexKey)(ENTITY);\n    await (0,_kv__WEBPACK_IMPORTED_MODULE_0__.kvDel)(key);\n    await (0,_kv__WEBPACK_IMPORTED_MODULE_0__.kvSRem)(indexKey, id);\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9kYXRhLXN0b3JlL3JlcG9zaXRvcmllcy9pdGVtLnJlcG8udHMiLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7O0FBQUEsdUNBQXVDO0FBQ2lDO0FBQ2xCO0FBR3RELE1BQU1RLFNBQVM7QUFFUixlQUFlQztJQUNwQixNQUFNQyxXQUFXSCxvREFBYUEsQ0FBQ0M7SUFDL0IsTUFBTUcsTUFBTSxNQUFNTiwrQ0FBVUEsQ0FBQ0s7SUFDN0IsSUFBSUMsSUFBSUMsTUFBTSxLQUFLLEdBQUcsT0FBTyxFQUFFO0lBRS9CLE1BQU1DLFFBQWdCLEVBQUU7SUFDeEIsS0FBSyxNQUFNQyxNQUFNSCxJQUFLO1FBQ3BCLE1BQU1JLE1BQU1ULG1EQUFZQSxDQUFDRSxRQUFRTTtRQUNqQyxNQUFNRSxPQUFPLE1BQU1oQiwwQ0FBS0EsQ0FBT2U7UUFDL0IsSUFBSUMsTUFBTUgsTUFBTUksSUFBSSxDQUFDRDtJQUN2QjtJQUVBLE9BQU9IO0FBQ1Q7QUFFTyxlQUFlSyxZQUFZSixFQUFVO0lBQzFDLE1BQU1DLE1BQU1ULG1EQUFZQSxDQUFDRSxRQUFRTTtJQUNqQyxPQUFPLE1BQU1kLDBDQUFLQSxDQUFPZTtBQUMzQjtBQUVPLGVBQWVJLFdBQVdILElBQVU7SUFDekMsTUFBTUQsTUFBTVQsbURBQVlBLENBQUNFLFFBQVFRLEtBQUtGLEVBQUU7SUFDeEMsTUFBTUosV0FBV0gsb0RBQWFBLENBQUNDO0lBRS9CLE1BQU1QLDBDQUFLQSxDQUFDYyxLQUFLQztJQUNqQixNQUFNYiwyQ0FBTUEsQ0FBQ08sVUFBVU0sS0FBS0YsRUFBRTtJQUU5QixPQUFPRTtBQUNUO0FBRU8sZUFBZUksV0FBV04sRUFBVTtJQUN6QyxNQUFNQyxNQUFNVCxtREFBWUEsQ0FBQ0UsUUFBUU07SUFDakMsTUFBTUosV0FBV0gsb0RBQWFBLENBQUNDO0lBRS9CLE1BQU1OLDBDQUFLQSxDQUFDYTtJQUNaLE1BQU1YLDJDQUFNQSxDQUFDTSxVQUFVSTtBQUN6QiIsInNvdXJjZXMiOlsid2VicGFjazovL3RoZWdhbWUtYWRtaW4vLi9kYXRhLXN0b3JlL3JlcG9zaXRvcmllcy9pdGVtLnJlcG8udHM/YzY0OCJdLCJzb3VyY2VzQ29udGVudCI6WyIvLyBkYXRhLXN0b3JlL3JlcG9zaXRvcmllcy9pdGVtLnJlcG8udHNcclxuaW1wb3J0IHsga3ZHZXQsIGt2U2V0LCBrdkRlbCwga3ZTQWRkLCBrdlNSZW0sIGt2U01lbWJlcnMgfSBmcm9tICcuLi9rdic7XHJcbmltcG9ydCB7IGJ1aWxkRGF0YUtleSwgYnVpbGRJbmRleEtleSB9IGZyb20gJy4uL2tleXMnO1xyXG5pbXBvcnQgdHlwZSB7IEl0ZW0gfSBmcm9tICdAL3R5cGVzL2VudGl0aWVzJztcclxuXHJcbmNvbnN0IEVOVElUWSA9ICdpdGVtcyc7XHJcblxyXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gZ2V0QWxsSXRlbXMoKTogUHJvbWlzZTxJdGVtW10+IHtcclxuICBjb25zdCBpbmRleEtleSA9IGJ1aWxkSW5kZXhLZXkoRU5USVRZKTtcclxuICBjb25zdCBpZHMgPSBhd2FpdCBrdlNNZW1iZXJzKGluZGV4S2V5KTtcclxuICBpZiAoaWRzLmxlbmd0aCA9PT0gMCkgcmV0dXJuIFtdO1xyXG4gIFxyXG4gIGNvbnN0IGl0ZW1zOiBJdGVtW10gPSBbXTtcclxuICBmb3IgKGNvbnN0IGlkIG9mIGlkcykge1xyXG4gICAgY29uc3Qga2V5ID0gYnVpbGREYXRhS2V5KEVOVElUWSwgaWQpO1xyXG4gICAgY29uc3QgaXRlbSA9IGF3YWl0IGt2R2V0PEl0ZW0+KGtleSk7XHJcbiAgICBpZiAoaXRlbSkgaXRlbXMucHVzaChpdGVtKTtcclxuICB9XHJcbiAgXHJcbiAgcmV0dXJuIGl0ZW1zO1xyXG59XHJcblxyXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gZ2V0SXRlbUJ5SWQoaWQ6IHN0cmluZyk6IFByb21pc2U8SXRlbSB8IG51bGw+IHtcclxuICBjb25zdCBrZXkgPSBidWlsZERhdGFLZXkoRU5USVRZLCBpZCk7XHJcbiAgcmV0dXJuIGF3YWl0IGt2R2V0PEl0ZW0+KGtleSk7XHJcbn1cclxuXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiB1cHNlcnRJdGVtKGl0ZW06IEl0ZW0pOiBQcm9taXNlPEl0ZW0+IHtcclxuICBjb25zdCBrZXkgPSBidWlsZERhdGFLZXkoRU5USVRZLCBpdGVtLmlkKTtcclxuICBjb25zdCBpbmRleEtleSA9IGJ1aWxkSW5kZXhLZXkoRU5USVRZKTtcclxuICBcclxuICBhd2FpdCBrdlNldChrZXksIGl0ZW0pO1xyXG4gIGF3YWl0IGt2U0FkZChpbmRleEtleSwgaXRlbS5pZCk7XHJcbiAgXHJcbiAgcmV0dXJuIGl0ZW07XHJcbn1cclxuXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBkZWxldGVJdGVtKGlkOiBzdHJpbmcpOiBQcm9taXNlPHZvaWQ+IHtcclxuICBjb25zdCBrZXkgPSBidWlsZERhdGFLZXkoRU5USVRZLCBpZCk7XHJcbiAgY29uc3QgaW5kZXhLZXkgPSBidWlsZEluZGV4S2V5KEVOVElUWSk7XHJcbiAgXHJcbiAgYXdhaXQga3ZEZWwoa2V5KTtcclxuICBhd2FpdCBrdlNSZW0oaW5kZXhLZXksIGlkKTtcclxufVxyXG4iXSwibmFtZXMiOlsia3ZHZXQiLCJrdlNldCIsImt2RGVsIiwia3ZTQWRkIiwia3ZTUmVtIiwia3ZTTWVtYmVycyIsImJ1aWxkRGF0YUtleSIsImJ1aWxkSW5kZXhLZXkiLCJFTlRJVFkiLCJnZXRBbGxJdGVtcyIsImluZGV4S2V5IiwiaWRzIiwibGVuZ3RoIiwiaXRlbXMiLCJpZCIsImtleSIsIml0ZW0iLCJwdXNoIiwiZ2V0SXRlbUJ5SWQiLCJ1cHNlcnRJdGVtIiwiZGVsZXRlSXRlbSJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./data-store/repositories/item.repo.ts\n");

/***/ }),

/***/ "(rsc)/./data-store/repositories/player.repo.ts":
/*!************************************************!*\
  !*** ./data-store/repositories/player.repo.ts ***!
  \************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   deletePlayer: () => (/* binding */ deletePlayer),\n/* harmony export */   getAllPlayers: () => (/* binding */ getAllPlayers),\n/* harmony export */   getPlayerById: () => (/* binding */ getPlayerById),\n/* harmony export */   upsertPlayer: () => (/* binding */ upsertPlayer)\n/* harmony export */ });\n/* harmony import */ var _kv__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../kv */ \"(rsc)/./data-store/kv.ts\");\n/* harmony import */ var _keys__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../keys */ \"(rsc)/./data-store/keys.ts\");\n// data-store/repositories/player.repo.ts\n\n\nconst ENTITY = \"players\";\nasync function getAllPlayers() {\n    const indexKey = (0,_keys__WEBPACK_IMPORTED_MODULE_1__.buildIndexKey)(ENTITY);\n    const ids = await (0,_kv__WEBPACK_IMPORTED_MODULE_0__.kvSMembers)(indexKey);\n    if (ids.length === 0) return [];\n    const players = [];\n    for (const id of ids){\n        const key = (0,_keys__WEBPACK_IMPORTED_MODULE_1__.buildDataKey)(ENTITY, id);\n        const player = await (0,_kv__WEBPACK_IMPORTED_MODULE_0__.kvGet)(key);\n        if (player) players.push(player);\n    }\n    return players;\n}\nasync function getPlayerById(id) {\n    const key = (0,_keys__WEBPACK_IMPORTED_MODULE_1__.buildDataKey)(ENTITY, id);\n    return await (0,_kv__WEBPACK_IMPORTED_MODULE_0__.kvGet)(key);\n}\nasync function upsertPlayer(player) {\n    const key = (0,_keys__WEBPACK_IMPORTED_MODULE_1__.buildDataKey)(ENTITY, player.id);\n    const indexKey = (0,_keys__WEBPACK_IMPORTED_MODULE_1__.buildIndexKey)(ENTITY);\n    await (0,_kv__WEBPACK_IMPORTED_MODULE_0__.kvSet)(key, player);\n    await (0,_kv__WEBPACK_IMPORTED_MODULE_0__.kvSAdd)(indexKey, player.id);\n    return player;\n}\nasync function deletePlayer(id) {\n    const key = (0,_keys__WEBPACK_IMPORTED_MODULE_1__.buildDataKey)(ENTITY, id);\n    const indexKey = (0,_keys__WEBPACK_IMPORTED_MODULE_1__.buildIndexKey)(ENTITY);\n    await (0,_kv__WEBPACK_IMPORTED_MODULE_0__.kvDel)(key);\n    await (0,_kv__WEBPACK_IMPORTED_MODULE_0__.kvSRem)(indexKey, id);\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9kYXRhLXN0b3JlL3JlcG9zaXRvcmllcy9wbGF5ZXIucmVwby50cyIsIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7QUFBQSx5Q0FBeUM7QUFDK0I7QUFDbEI7QUFHdEQsTUFBTVEsU0FBUztBQUVSLGVBQWVDO0lBQ3BCLE1BQU1DLFdBQVdILG9EQUFhQSxDQUFDQztJQUMvQixNQUFNRyxNQUFNLE1BQU1OLCtDQUFVQSxDQUFDSztJQUM3QixJQUFJQyxJQUFJQyxNQUFNLEtBQUssR0FBRyxPQUFPLEVBQUU7SUFFL0IsTUFBTUMsVUFBb0IsRUFBRTtJQUM1QixLQUFLLE1BQU1DLE1BQU1ILElBQUs7UUFDcEIsTUFBTUksTUFBTVQsbURBQVlBLENBQUNFLFFBQVFNO1FBQ2pDLE1BQU1FLFNBQVMsTUFBTWhCLDBDQUFLQSxDQUFTZTtRQUNuQyxJQUFJQyxRQUFRSCxRQUFRSSxJQUFJLENBQUNEO0lBQzNCO0lBRUEsT0FBT0g7QUFDVDtBQUVPLGVBQWVLLGNBQWNKLEVBQVU7SUFDNUMsTUFBTUMsTUFBTVQsbURBQVlBLENBQUNFLFFBQVFNO0lBQ2pDLE9BQU8sTUFBTWQsMENBQUtBLENBQVNlO0FBQzdCO0FBRU8sZUFBZUksYUFBYUgsTUFBYztJQUMvQyxNQUFNRCxNQUFNVCxtREFBWUEsQ0FBQ0UsUUFBUVEsT0FBT0YsRUFBRTtJQUMxQyxNQUFNSixXQUFXSCxvREFBYUEsQ0FBQ0M7SUFFL0IsTUFBTVAsMENBQUtBLENBQUNjLEtBQUtDO0lBQ2pCLE1BQU1iLDJDQUFNQSxDQUFDTyxVQUFVTSxPQUFPRixFQUFFO0lBRWhDLE9BQU9FO0FBQ1Q7QUFFTyxlQUFlSSxhQUFhTixFQUFVO0lBQzNDLE1BQU1DLE1BQU1ULG1EQUFZQSxDQUFDRSxRQUFRTTtJQUNqQyxNQUFNSixXQUFXSCxvREFBYUEsQ0FBQ0M7SUFFL0IsTUFBTU4sMENBQUtBLENBQUNhO0lBQ1osTUFBTVgsMkNBQU1BLENBQUNNLFVBQVVJO0FBQ3pCIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vdGhlZ2FtZS1hZG1pbi8uL2RhdGEtc3RvcmUvcmVwb3NpdG9yaWVzL3BsYXllci5yZXBvLnRzPzBhODkiXSwic291cmNlc0NvbnRlbnQiOlsiLy8gZGF0YS1zdG9yZS9yZXBvc2l0b3JpZXMvcGxheWVyLnJlcG8udHNcclxuaW1wb3J0IHsga3ZHZXQsIGt2U2V0LCBrdkRlbCwga3ZTQWRkLCBrdlNSZW0sIGt2U01lbWJlcnMgfSBmcm9tICcuLi9rdic7XHJcbmltcG9ydCB7IGJ1aWxkRGF0YUtleSwgYnVpbGRJbmRleEtleSB9IGZyb20gJy4uL2tleXMnO1xyXG5pbXBvcnQgdHlwZSB7IFBsYXllciB9IGZyb20gJ0AvdHlwZXMvZW50aXRpZXMnO1xyXG5cclxuY29uc3QgRU5USVRZID0gJ3BsYXllcnMnO1xyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGdldEFsbFBsYXllcnMoKTogUHJvbWlzZTxQbGF5ZXJbXT4ge1xyXG4gIGNvbnN0IGluZGV4S2V5ID0gYnVpbGRJbmRleEtleShFTlRJVFkpO1xyXG4gIGNvbnN0IGlkcyA9IGF3YWl0IGt2U01lbWJlcnMoaW5kZXhLZXkpO1xyXG4gIGlmIChpZHMubGVuZ3RoID09PSAwKSByZXR1cm4gW107XHJcbiAgXHJcbiAgY29uc3QgcGxheWVyczogUGxheWVyW10gPSBbXTtcclxuICBmb3IgKGNvbnN0IGlkIG9mIGlkcykge1xyXG4gICAgY29uc3Qga2V5ID0gYnVpbGREYXRhS2V5KEVOVElUWSwgaWQpO1xyXG4gICAgY29uc3QgcGxheWVyID0gYXdhaXQga3ZHZXQ8UGxheWVyPihrZXkpO1xyXG4gICAgaWYgKHBsYXllcikgcGxheWVycy5wdXNoKHBsYXllcik7XHJcbiAgfVxyXG4gIFxyXG4gIHJldHVybiBwbGF5ZXJzO1xyXG59XHJcblxyXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gZ2V0UGxheWVyQnlJZChpZDogc3RyaW5nKTogUHJvbWlzZTxQbGF5ZXIgfCBudWxsPiB7XHJcbiAgY29uc3Qga2V5ID0gYnVpbGREYXRhS2V5KEVOVElUWSwgaWQpO1xyXG4gIHJldHVybiBhd2FpdCBrdkdldDxQbGF5ZXI+KGtleSk7XHJcbn1cclxuXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiB1cHNlcnRQbGF5ZXIocGxheWVyOiBQbGF5ZXIpOiBQcm9taXNlPFBsYXllcj4ge1xyXG4gIGNvbnN0IGtleSA9IGJ1aWxkRGF0YUtleShFTlRJVFksIHBsYXllci5pZCk7XHJcbiAgY29uc3QgaW5kZXhLZXkgPSBidWlsZEluZGV4S2V5KEVOVElUWSk7XHJcbiAgXHJcbiAgYXdhaXQga3ZTZXQoa2V5LCBwbGF5ZXIpO1xyXG4gIGF3YWl0IGt2U0FkZChpbmRleEtleSwgcGxheWVyLmlkKTtcclxuICBcclxuICByZXR1cm4gcGxheWVyO1xyXG59XHJcblxyXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gZGVsZXRlUGxheWVyKGlkOiBzdHJpbmcpOiBQcm9taXNlPHZvaWQ+IHtcclxuICBjb25zdCBrZXkgPSBidWlsZERhdGFLZXkoRU5USVRZLCBpZCk7XHJcbiAgY29uc3QgaW5kZXhLZXkgPSBidWlsZEluZGV4S2V5KEVOVElUWSk7XHJcbiAgXHJcbiAgYXdhaXQga3ZEZWwoa2V5KTtcclxuICBhd2FpdCBrdlNSZW0oaW5kZXhLZXksIGlkKTtcclxufVxyXG4iXSwibmFtZXMiOlsia3ZHZXQiLCJrdlNldCIsImt2RGVsIiwia3ZTQWRkIiwia3ZTUmVtIiwia3ZTTWVtYmVycyIsImJ1aWxkRGF0YUtleSIsImJ1aWxkSW5kZXhLZXkiLCJFTlRJVFkiLCJnZXRBbGxQbGF5ZXJzIiwiaW5kZXhLZXkiLCJpZHMiLCJsZW5ndGgiLCJwbGF5ZXJzIiwiaWQiLCJrZXkiLCJwbGF5ZXIiLCJwdXNoIiwiZ2V0UGxheWVyQnlJZCIsInVwc2VydFBsYXllciIsImRlbGV0ZVBsYXllciJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./data-store/repositories/player.repo.ts\n");

/***/ }),

/***/ "(rsc)/./data-store/repositories/sale.repo.ts":
/*!**********************************************!*\
  !*** ./data-store/repositories/sale.repo.ts ***!
  \**********************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   deleteSale: () => (/* binding */ deleteSale),\n/* harmony export */   getAllSales: () => (/* binding */ getAllSales),\n/* harmony export */   getSaleById: () => (/* binding */ getSaleById),\n/* harmony export */   upsertSale: () => (/* binding */ upsertSale)\n/* harmony export */ });\n/* harmony import */ var _kv__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../kv */ \"(rsc)/./data-store/kv.ts\");\n/* harmony import */ var _keys__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../keys */ \"(rsc)/./data-store/keys.ts\");\n// data-store/repositories/sale.repo.ts\n\n\nconst ENTITY = \"sales\";\nasync function getAllSales() {\n    const indexKey = (0,_keys__WEBPACK_IMPORTED_MODULE_1__.buildIndexKey)(ENTITY);\n    const ids = await (0,_kv__WEBPACK_IMPORTED_MODULE_0__.kvSMembers)(indexKey);\n    if (ids.length === 0) return [];\n    const sales = [];\n    for (const id of ids){\n        const key = (0,_keys__WEBPACK_IMPORTED_MODULE_1__.buildDataKey)(ENTITY, id);\n        const sale = await (0,_kv__WEBPACK_IMPORTED_MODULE_0__.kvGet)(key);\n        if (sale) sales.push(sale);\n    }\n    return sales;\n}\nasync function getSaleById(id) {\n    const key = (0,_keys__WEBPACK_IMPORTED_MODULE_1__.buildDataKey)(ENTITY, id);\n    return await (0,_kv__WEBPACK_IMPORTED_MODULE_0__.kvGet)(key);\n}\nasync function upsertSale(sale) {\n    const key = (0,_keys__WEBPACK_IMPORTED_MODULE_1__.buildDataKey)(ENTITY, sale.id);\n    const indexKey = (0,_keys__WEBPACK_IMPORTED_MODULE_1__.buildIndexKey)(ENTITY);\n    await (0,_kv__WEBPACK_IMPORTED_MODULE_0__.kvSet)(key, sale);\n    await (0,_kv__WEBPACK_IMPORTED_MODULE_0__.kvSAdd)(indexKey, sale.id);\n    return sale;\n}\nasync function deleteSale(id) {\n    const key = (0,_keys__WEBPACK_IMPORTED_MODULE_1__.buildDataKey)(ENTITY, id);\n    const indexKey = (0,_keys__WEBPACK_IMPORTED_MODULE_1__.buildIndexKey)(ENTITY);\n    await (0,_kv__WEBPACK_IMPORTED_MODULE_0__.kvDel)(key);\n    await (0,_kv__WEBPACK_IMPORTED_MODULE_0__.kvSRem)(indexKey, id);\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9kYXRhLXN0b3JlL3JlcG9zaXRvcmllcy9zYWxlLnJlcG8udHMiLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7O0FBQUEsdUNBQXVDO0FBQ2lDO0FBQ2xCO0FBR3RELE1BQU1RLFNBQVM7QUFFUixlQUFlQztJQUNwQixNQUFNQyxXQUFXSCxvREFBYUEsQ0FBQ0M7SUFDL0IsTUFBTUcsTUFBTSxNQUFNTiwrQ0FBVUEsQ0FBQ0s7SUFDN0IsSUFBSUMsSUFBSUMsTUFBTSxLQUFLLEdBQUcsT0FBTyxFQUFFO0lBRS9CLE1BQU1DLFFBQWdCLEVBQUU7SUFDeEIsS0FBSyxNQUFNQyxNQUFNSCxJQUFLO1FBQ3BCLE1BQU1JLE1BQU1ULG1EQUFZQSxDQUFDRSxRQUFRTTtRQUNqQyxNQUFNRSxPQUFPLE1BQU1oQiwwQ0FBS0EsQ0FBT2U7UUFDL0IsSUFBSUMsTUFBTUgsTUFBTUksSUFBSSxDQUFDRDtJQUN2QjtJQUVBLE9BQU9IO0FBQ1Q7QUFFTyxlQUFlSyxZQUFZSixFQUFVO0lBQzFDLE1BQU1DLE1BQU1ULG1EQUFZQSxDQUFDRSxRQUFRTTtJQUNqQyxPQUFPLE1BQU1kLDBDQUFLQSxDQUFPZTtBQUMzQjtBQUVPLGVBQWVJLFdBQVdILElBQVU7SUFDekMsTUFBTUQsTUFBTVQsbURBQVlBLENBQUNFLFFBQVFRLEtBQUtGLEVBQUU7SUFDeEMsTUFBTUosV0FBV0gsb0RBQWFBLENBQUNDO0lBRS9CLE1BQU1QLDBDQUFLQSxDQUFDYyxLQUFLQztJQUNqQixNQUFNYiwyQ0FBTUEsQ0FBQ08sVUFBVU0sS0FBS0YsRUFBRTtJQUU5QixPQUFPRTtBQUNUO0FBRU8sZUFBZUksV0FBV04sRUFBVTtJQUN6QyxNQUFNQyxNQUFNVCxtREFBWUEsQ0FBQ0UsUUFBUU07SUFDakMsTUFBTUosV0FBV0gsb0RBQWFBLENBQUNDO0lBRS9CLE1BQU1OLDBDQUFLQSxDQUFDYTtJQUNaLE1BQU1YLDJDQUFNQSxDQUFDTSxVQUFVSTtBQUN6QiIsInNvdXJjZXMiOlsid2VicGFjazovL3RoZWdhbWUtYWRtaW4vLi9kYXRhLXN0b3JlL3JlcG9zaXRvcmllcy9zYWxlLnJlcG8udHM/NDkzYSJdLCJzb3VyY2VzQ29udGVudCI6WyIvLyBkYXRhLXN0b3JlL3JlcG9zaXRvcmllcy9zYWxlLnJlcG8udHNcclxuaW1wb3J0IHsga3ZHZXQsIGt2U2V0LCBrdkRlbCwga3ZTQWRkLCBrdlNSZW0sIGt2U01lbWJlcnMgfSBmcm9tICcuLi9rdic7XHJcbmltcG9ydCB7IGJ1aWxkRGF0YUtleSwgYnVpbGRJbmRleEtleSB9IGZyb20gJy4uL2tleXMnO1xyXG5pbXBvcnQgdHlwZSB7IFNhbGUgfSBmcm9tICdAL3R5cGVzL2VudGl0aWVzJztcclxuXHJcbmNvbnN0IEVOVElUWSA9ICdzYWxlcyc7XHJcblxyXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gZ2V0QWxsU2FsZXMoKTogUHJvbWlzZTxTYWxlW10+IHtcclxuICBjb25zdCBpbmRleEtleSA9IGJ1aWxkSW5kZXhLZXkoRU5USVRZKTtcclxuICBjb25zdCBpZHMgPSBhd2FpdCBrdlNNZW1iZXJzKGluZGV4S2V5KTtcclxuICBpZiAoaWRzLmxlbmd0aCA9PT0gMCkgcmV0dXJuIFtdO1xyXG4gIFxyXG4gIGNvbnN0IHNhbGVzOiBTYWxlW10gPSBbXTtcclxuICBmb3IgKGNvbnN0IGlkIG9mIGlkcykge1xyXG4gICAgY29uc3Qga2V5ID0gYnVpbGREYXRhS2V5KEVOVElUWSwgaWQpO1xyXG4gICAgY29uc3Qgc2FsZSA9IGF3YWl0IGt2R2V0PFNhbGU+KGtleSk7XHJcbiAgICBpZiAoc2FsZSkgc2FsZXMucHVzaChzYWxlKTtcclxuICB9XHJcbiAgXHJcbiAgcmV0dXJuIHNhbGVzO1xyXG59XHJcblxyXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gZ2V0U2FsZUJ5SWQoaWQ6IHN0cmluZyk6IFByb21pc2U8U2FsZSB8IG51bGw+IHtcclxuICBjb25zdCBrZXkgPSBidWlsZERhdGFLZXkoRU5USVRZLCBpZCk7XHJcbiAgcmV0dXJuIGF3YWl0IGt2R2V0PFNhbGU+KGtleSk7XHJcbn1cclxuXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiB1cHNlcnRTYWxlKHNhbGU6IFNhbGUpOiBQcm9taXNlPFNhbGU+IHtcclxuICBjb25zdCBrZXkgPSBidWlsZERhdGFLZXkoRU5USVRZLCBzYWxlLmlkKTtcclxuICBjb25zdCBpbmRleEtleSA9IGJ1aWxkSW5kZXhLZXkoRU5USVRZKTtcclxuICBcclxuICBhd2FpdCBrdlNldChrZXksIHNhbGUpO1xyXG4gIGF3YWl0IGt2U0FkZChpbmRleEtleSwgc2FsZS5pZCk7XHJcbiAgXHJcbiAgcmV0dXJuIHNhbGU7XHJcbn1cclxuXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBkZWxldGVTYWxlKGlkOiBzdHJpbmcpOiBQcm9taXNlPHZvaWQ+IHtcclxuICBjb25zdCBrZXkgPSBidWlsZERhdGFLZXkoRU5USVRZLCBpZCk7XHJcbiAgY29uc3QgaW5kZXhLZXkgPSBidWlsZEluZGV4S2V5KEVOVElUWSk7XHJcbiAgXHJcbiAgYXdhaXQga3ZEZWwoa2V5KTtcclxuICBhd2FpdCBrdlNSZW0oaW5kZXhLZXksIGlkKTtcclxufVxyXG4iXSwibmFtZXMiOlsia3ZHZXQiLCJrdlNldCIsImt2RGVsIiwia3ZTQWRkIiwia3ZTUmVtIiwia3ZTTWVtYmVycyIsImJ1aWxkRGF0YUtleSIsImJ1aWxkSW5kZXhLZXkiLCJFTlRJVFkiLCJnZXRBbGxTYWxlcyIsImluZGV4S2V5IiwiaWRzIiwibGVuZ3RoIiwic2FsZXMiLCJpZCIsImtleSIsInNhbGUiLCJwdXNoIiwiZ2V0U2FsZUJ5SWQiLCJ1cHNlcnRTYWxlIiwiZGVsZXRlU2FsZSJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./data-store/repositories/sale.repo.ts\n");

/***/ }),

/***/ "(rsc)/./data-store/repositories/site.repo.ts":
/*!**********************************************!*\
  !*** ./data-store/repositories/site.repo.ts ***!
  \**********************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   deleteSite: () => (/* binding */ deleteSite),\n/* harmony export */   getAllSettlements: () => (/* binding */ getAllSettlements),\n/* harmony export */   getAllSites: () => (/* binding */ getAllSites),\n/* harmony export */   getSettlementById: () => (/* binding */ getSettlementById),\n/* harmony export */   getSiteById: () => (/* binding */ getSiteById),\n/* harmony export */   getSitesByRadius: () => (/* binding */ getSitesByRadius),\n/* harmony export */   getSitesBySettlement: () => (/* binding */ getSitesBySettlement),\n/* harmony export */   removeSettlement: () => (/* binding */ removeSettlement),\n/* harmony export */   upsertSettlement: () => (/* binding */ upsertSettlement),\n/* harmony export */   upsertSite: () => (/* binding */ upsertSite)\n/* harmony export */ });\n/* harmony import */ var _kv__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../kv */ \"(rsc)/./data-store/kv.ts\");\n/* harmony import */ var _keys__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../keys */ \"(rsc)/./data-store/keys.ts\");\n// data-store/repositories/site.repo.ts\n\n\nconst ENTITY = \"sites\";\nconst SETTLEMENTS_ENTITY = \"settlements\";\nasync function getAllSites() {\n    const indexKey = (0,_keys__WEBPACK_IMPORTED_MODULE_1__.buildIndexKey)(ENTITY);\n    const ids = await (0,_kv__WEBPACK_IMPORTED_MODULE_0__.kvSMembers)(indexKey);\n    if (ids.length === 0) return [];\n    const keys = ids.map((id)=>(0,_keys__WEBPACK_IMPORTED_MODULE_1__.buildDataKey)(ENTITY, id));\n    const sites = await (0,_kv__WEBPACK_IMPORTED_MODULE_0__.kvMGet)(keys);\n    return sites.filter((site)=>site !== null);\n}\nasync function getSiteById(id) {\n    const key = (0,_keys__WEBPACK_IMPORTED_MODULE_1__.buildDataKey)(ENTITY, id);\n    return await (0,_kv__WEBPACK_IMPORTED_MODULE_0__.kvGet)(key);\n}\nasync function upsertSite(site) {\n    const key = (0,_keys__WEBPACK_IMPORTED_MODULE_1__.buildDataKey)(ENTITY, site.id);\n    const indexKey = (0,_keys__WEBPACK_IMPORTED_MODULE_1__.buildIndexKey)(ENTITY);\n    await (0,_kv__WEBPACK_IMPORTED_MODULE_0__.kvSet)(key, site);\n    await (0,_kv__WEBPACK_IMPORTED_MODULE_0__.kvSAdd)(indexKey, site.id);\n    return site;\n}\nasync function deleteSite(id) {\n    const key = (0,_keys__WEBPACK_IMPORTED_MODULE_1__.buildDataKey)(ENTITY, id);\n    const indexKey = (0,_keys__WEBPACK_IMPORTED_MODULE_1__.buildIndexKey)(ENTITY);\n    await (0,_kv__WEBPACK_IMPORTED_MODULE_0__.kvDel)(key);\n    await (0,_kv__WEBPACK_IMPORTED_MODULE_0__.kvSRem)(indexKey, id);\n}\n// ============================================================================\n// SETTLEMENT METHODS (Reference data for Sites)\n// ============================================================================\nasync function getAllSettlements() {\n    const indexKey = (0,_keys__WEBPACK_IMPORTED_MODULE_1__.buildIndexKey)(SETTLEMENTS_ENTITY);\n    const ids = await (0,_kv__WEBPACK_IMPORTED_MODULE_0__.kvSMembers)(indexKey);\n    if (ids.length === 0) return [];\n    const keys = ids.map((id)=>(0,_keys__WEBPACK_IMPORTED_MODULE_1__.buildDataKey)(SETTLEMENTS_ENTITY, id));\n    const settlements = await (0,_kv__WEBPACK_IMPORTED_MODULE_0__.kvMGet)(keys);\n    return settlements.filter((settlement)=>settlement !== null);\n}\nasync function getSettlementById(id) {\n    const key = (0,_keys__WEBPACK_IMPORTED_MODULE_1__.buildDataKey)(SETTLEMENTS_ENTITY, id);\n    return await (0,_kv__WEBPACK_IMPORTED_MODULE_0__.kvGet)(key);\n}\nasync function upsertSettlement(settlement) {\n    const key = (0,_keys__WEBPACK_IMPORTED_MODULE_1__.buildDataKey)(SETTLEMENTS_ENTITY, settlement.id);\n    const indexKey = (0,_keys__WEBPACK_IMPORTED_MODULE_1__.buildIndexKey)(SETTLEMENTS_ENTITY);\n    await (0,_kv__WEBPACK_IMPORTED_MODULE_0__.kvSet)(key, settlement);\n    await (0,_kv__WEBPACK_IMPORTED_MODULE_0__.kvSAdd)(indexKey, settlement.id);\n    return settlement;\n}\nasync function removeSettlement(id) {\n    const key = (0,_keys__WEBPACK_IMPORTED_MODULE_1__.buildDataKey)(SETTLEMENTS_ENTITY, id);\n    const indexKey = (0,_keys__WEBPACK_IMPORTED_MODULE_1__.buildIndexKey)(SETTLEMENTS_ENTITY);\n    await (0,_kv__WEBPACK_IMPORTED_MODULE_0__.kvDel)(key);\n    await (0,_kv__WEBPACK_IMPORTED_MODULE_0__.kvSRem)(indexKey, id);\n}\n// ============================================================================\n// SITE QUERY METHODS\n// ============================================================================\nasync function getSitesBySettlement(settlementId) {\n    const allSites = await getAllSites();\n    return allSites.filter((site)=>{\n        if (site.metadata.type !== \"PHYSICAL\") return false;\n        const physicalMeta = site.metadata;\n        return physicalMeta.settlementId === settlementId;\n    });\n}\nasync function getSitesByRadius(centerLat, centerLng, radiusMeters) {\n    const allSites = await getAllSites();\n    const settlementsMap = new Map();\n    // Load all settlements with coordinates\n    const settlements = await getAllSettlements();\n    settlements.forEach((s)=>{\n        if (s.coordinates) settlementsMap.set(s.id, s);\n    });\n    return allSites.filter((site)=>{\n        if (site.metadata.type !== \"PHYSICAL\") return false;\n        const physicalMeta = site.metadata;\n        const settlement = settlementsMap.get(physicalMeta.settlementId);\n        if (!settlement?.coordinates) return false;\n        // Haversine formula for distance calculation\n        const R = 6371000; // Earth radius in meters\n        const φ1 = centerLat * Math.PI / 180;\n        const φ2 = settlement.coordinates.lat * Math.PI / 180;\n        const Δφ = (settlement.coordinates.lat - centerLat) * Math.PI / 180;\n        const Δλ = (settlement.coordinates.lng - centerLng) * Math.PI / 180;\n        const a = Math.sin(Δφ / 2) * Math.sin(Δφ / 2) + Math.cos(φ1) * Math.cos(φ2) * Math.sin(Δλ / 2) * Math.sin(Δλ / 2);\n        const c = 2 * Math.atan2(Math.sqrt(a), Math.sqrt(1 - a));\n        const distance = R * c;\n        return distance <= radiusMeters;\n    });\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9kYXRhLXN0b3JlL3JlcG9zaXRvcmllcy9zaXRlLnJlcG8udHMiLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7Ozs7O0FBQUEsdUNBQXVDO0FBQ3lDO0FBQzFCO0FBR3RELE1BQU1TLFNBQVM7QUFDZixNQUFNQyxxQkFBcUI7QUFFcEIsZUFBZUM7SUFDcEIsTUFBTUMsV0FBV0osb0RBQWFBLENBQUNDO0lBQy9CLE1BQU1JLE1BQU0sTUFBTVAsK0NBQVVBLENBQUNNO0lBQzdCLElBQUlDLElBQUlDLE1BQU0sS0FBSyxHQUFHLE9BQU8sRUFBRTtJQUUvQixNQUFNQyxPQUFPRixJQUFJRyxHQUFHLENBQUNDLENBQUFBLEtBQU1WLG1EQUFZQSxDQUFDRSxRQUFRUTtJQUNoRCxNQUFNQyxRQUFRLE1BQU1qQiwyQ0FBTUEsQ0FBT2M7SUFDakMsT0FBT0csTUFBTUMsTUFBTSxDQUFDLENBQUNDLE9BQXVCQSxTQUFTO0FBQ3ZEO0FBRU8sZUFBZUMsWUFBWUosRUFBVTtJQUMxQyxNQUFNSyxNQUFNZixtREFBWUEsQ0FBQ0UsUUFBUVE7SUFDakMsT0FBTyxNQUFNakIsMENBQUtBLENBQU9zQjtBQUMzQjtBQUVPLGVBQWVDLFdBQVdILElBQVU7SUFDekMsTUFBTUUsTUFBTWYsbURBQVlBLENBQUNFLFFBQVFXLEtBQUtILEVBQUU7SUFDeEMsTUFBTUwsV0FBV0osb0RBQWFBLENBQUNDO0lBRS9CLE1BQU1QLDBDQUFLQSxDQUFDb0IsS0FBS0Y7SUFDakIsTUFBTWhCLDJDQUFNQSxDQUFDUSxVQUFVUSxLQUFLSCxFQUFFO0lBRTlCLE9BQU9HO0FBQ1Q7QUFFTyxlQUFlSSxXQUFXUCxFQUFVO0lBQ3pDLE1BQU1LLE1BQU1mLG1EQUFZQSxDQUFDRSxRQUFRUTtJQUNqQyxNQUFNTCxXQUFXSixvREFBYUEsQ0FBQ0M7SUFFL0IsTUFBTU4sMENBQUtBLENBQUNtQjtJQUNaLE1BQU1qQiwyQ0FBTUEsQ0FBQ08sVUFBVUs7QUFDekI7QUFFQSwrRUFBK0U7QUFDL0UsZ0RBQWdEO0FBQ2hELCtFQUErRTtBQUV4RSxlQUFlUTtJQUNwQixNQUFNYixXQUFXSixvREFBYUEsQ0FBQ0U7SUFDL0IsTUFBTUcsTUFBTSxNQUFNUCwrQ0FBVUEsQ0FBQ007SUFDN0IsSUFBSUMsSUFBSUMsTUFBTSxLQUFLLEdBQUcsT0FBTyxFQUFFO0lBRS9CLE1BQU1DLE9BQU9GLElBQUlHLEdBQUcsQ0FBQ0MsQ0FBQUEsS0FBTVYsbURBQVlBLENBQUNHLG9CQUFvQk87SUFDNUQsTUFBTVMsY0FBYyxNQUFNekIsMkNBQU1BLENBQWFjO0lBQzdDLE9BQU9XLFlBQVlQLE1BQU0sQ0FBQyxDQUFDUSxhQUF5Q0EsZUFBZTtBQUNyRjtBQUVPLGVBQWVDLGtCQUFrQlgsRUFBVTtJQUNoRCxNQUFNSyxNQUFNZixtREFBWUEsQ0FBQ0csb0JBQW9CTztJQUM3QyxPQUFPLE1BQU1qQiwwQ0FBS0EsQ0FBYXNCO0FBQ2pDO0FBRU8sZUFBZU8saUJBQWlCRixVQUFzQjtJQUMzRCxNQUFNTCxNQUFNZixtREFBWUEsQ0FBQ0csb0JBQW9CaUIsV0FBV1YsRUFBRTtJQUMxRCxNQUFNTCxXQUFXSixvREFBYUEsQ0FBQ0U7SUFFL0IsTUFBTVIsMENBQUtBLENBQUNvQixLQUFLSztJQUNqQixNQUFNdkIsMkNBQU1BLENBQUNRLFVBQVVlLFdBQVdWLEVBQUU7SUFFcEMsT0FBT1U7QUFDVDtBQUVPLGVBQWVHLGlCQUFpQmIsRUFBVTtJQUMvQyxNQUFNSyxNQUFNZixtREFBWUEsQ0FBQ0csb0JBQW9CTztJQUM3QyxNQUFNTCxXQUFXSixvREFBYUEsQ0FBQ0U7SUFFL0IsTUFBTVAsMENBQUtBLENBQUNtQjtJQUNaLE1BQU1qQiwyQ0FBTUEsQ0FBQ08sVUFBVUs7QUFDekI7QUFFQSwrRUFBK0U7QUFDL0UscUJBQXFCO0FBQ3JCLCtFQUErRTtBQUV4RSxlQUFlYyxxQkFBcUJDLFlBQW9CO0lBQzdELE1BQU1DLFdBQVcsTUFBTXRCO0lBQ3ZCLE9BQU9zQixTQUFTZCxNQUFNLENBQUNDLENBQUFBO1FBQ3JCLElBQUlBLEtBQUtjLFFBQVEsQ0FBQ0MsSUFBSSxLQUFLLFlBQVksT0FBTztRQUM5QyxNQUFNQyxlQUFlaEIsS0FBS2MsUUFBUTtRQUNsQyxPQUFPRSxhQUFhSixZQUFZLEtBQUtBO0lBQ3ZDO0FBQ0Y7QUFFTyxlQUFlSyxpQkFDcEJDLFNBQWlCLEVBQ2pCQyxTQUFpQixFQUNqQkMsWUFBb0I7SUFFcEIsTUFBTVAsV0FBVyxNQUFNdEI7SUFDdkIsTUFBTThCLGlCQUFpQixJQUFJQztJQUUzQix3Q0FBd0M7SUFDeEMsTUFBTWhCLGNBQWMsTUFBTUQ7SUFDMUJDLFlBQVlpQixPQUFPLENBQUNDLENBQUFBO1FBQ2xCLElBQUlBLEVBQUVDLFdBQVcsRUFBRUosZUFBZUssR0FBRyxDQUFDRixFQUFFM0IsRUFBRSxFQUFFMkI7SUFDOUM7SUFFQSxPQUFPWCxTQUFTZCxNQUFNLENBQUNDLENBQUFBO1FBQ3JCLElBQUlBLEtBQUtjLFFBQVEsQ0FBQ0MsSUFBSSxLQUFLLFlBQVksT0FBTztRQUM5QyxNQUFNQyxlQUFlaEIsS0FBS2MsUUFBUTtRQUNsQyxNQUFNUCxhQUFhYyxlQUFlTSxHQUFHLENBQUNYLGFBQWFKLFlBQVk7UUFFL0QsSUFBSSxDQUFDTCxZQUFZa0IsYUFBYSxPQUFPO1FBRXJDLDZDQUE2QztRQUM3QyxNQUFNRyxJQUFJLFNBQVMseUJBQXlCO1FBQzVDLE1BQU1DLEtBQUtYLFlBQVlZLEtBQUtDLEVBQUUsR0FBRztRQUNqQyxNQUFNQyxLQUFLekIsV0FBV2tCLFdBQVcsQ0FBQ1EsR0FBRyxHQUFHSCxLQUFLQyxFQUFFLEdBQUc7UUFDbEQsTUFBTUcsS0FBSyxDQUFDM0IsV0FBV2tCLFdBQVcsQ0FBQ1EsR0FBRyxHQUFHZixTQUFRLElBQUtZLEtBQUtDLEVBQUUsR0FBRztRQUNoRSxNQUFNSSxLQUFLLENBQUM1QixXQUFXa0IsV0FBVyxDQUFDVyxHQUFHLEdBQUdqQixTQUFRLElBQUtXLEtBQUtDLEVBQUUsR0FBRztRQUVoRSxNQUFNTSxJQUFJUCxLQUFLUSxHQUFHLENBQUNKLEtBQUcsS0FBS0osS0FBS1EsR0FBRyxDQUFDSixLQUFHLEtBQzdCSixLQUFLUyxHQUFHLENBQUNWLE1BQU1DLEtBQUtTLEdBQUcsQ0FBQ1AsTUFDeEJGLEtBQUtRLEdBQUcsQ0FBQ0gsS0FBRyxLQUFLTCxLQUFLUSxHQUFHLENBQUNILEtBQUc7UUFDdkMsTUFBTUssSUFBSSxJQUFJVixLQUFLVyxLQUFLLENBQUNYLEtBQUtZLElBQUksQ0FBQ0wsSUFBSVAsS0FBS1ksSUFBSSxDQUFDLElBQUVMO1FBQ25ELE1BQU1NLFdBQVdmLElBQUlZO1FBRXJCLE9BQU9HLFlBQVl2QjtJQUNyQjtBQUNGIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vdGhlZ2FtZS1hZG1pbi8uL2RhdGEtc3RvcmUvcmVwb3NpdG9yaWVzL3NpdGUucmVwby50cz8xZTE0Il0sInNvdXJjZXNDb250ZW50IjpbIi8vIGRhdGEtc3RvcmUvcmVwb3NpdG9yaWVzL3NpdGUucmVwby50c1xyXG5pbXBvcnQgeyBrdkdldCwga3ZNR2V0LCBrdlNldCwga3ZEZWwsIGt2U0FkZCwga3ZTUmVtLCBrdlNNZW1iZXJzIH0gZnJvbSAnLi4va3YnO1xyXG5pbXBvcnQgeyBidWlsZERhdGFLZXksIGJ1aWxkSW5kZXhLZXkgfSBmcm9tICcuLi9rZXlzJztcclxuaW1wb3J0IHR5cGUgeyBTaXRlLCBTZXR0bGVtZW50LCBQaHlzaWNhbFNpdGVNZXRhZGF0YSB9IGZyb20gJ0AvdHlwZXMvZW50aXRpZXMnO1xyXG5cclxuY29uc3QgRU5USVRZID0gJ3NpdGVzJztcclxuY29uc3QgU0VUVExFTUVOVFNfRU5USVRZID0gJ3NldHRsZW1lbnRzJztcclxuXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBnZXRBbGxTaXRlcygpOiBQcm9taXNlPFNpdGVbXT4ge1xyXG4gIGNvbnN0IGluZGV4S2V5ID0gYnVpbGRJbmRleEtleShFTlRJVFkpO1xyXG4gIGNvbnN0IGlkcyA9IGF3YWl0IGt2U01lbWJlcnMoaW5kZXhLZXkpO1xyXG4gIGlmIChpZHMubGVuZ3RoID09PSAwKSByZXR1cm4gW107XHJcbiAgXHJcbiAgY29uc3Qga2V5cyA9IGlkcy5tYXAoaWQgPT4gYnVpbGREYXRhS2V5KEVOVElUWSwgaWQpKTtcclxuICBjb25zdCBzaXRlcyA9IGF3YWl0IGt2TUdldDxTaXRlPihrZXlzKTtcclxuICByZXR1cm4gc2l0ZXMuZmlsdGVyKChzaXRlKTogc2l0ZSBpcyBTaXRlID0+IHNpdGUgIT09IG51bGwpO1xyXG59XHJcblxyXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gZ2V0U2l0ZUJ5SWQoaWQ6IHN0cmluZyk6IFByb21pc2U8U2l0ZSB8IG51bGw+IHtcclxuICBjb25zdCBrZXkgPSBidWlsZERhdGFLZXkoRU5USVRZLCBpZCk7XHJcbiAgcmV0dXJuIGF3YWl0IGt2R2V0PFNpdGU+KGtleSk7XHJcbn1cclxuXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiB1cHNlcnRTaXRlKHNpdGU6IFNpdGUpOiBQcm9taXNlPFNpdGU+IHtcclxuICBjb25zdCBrZXkgPSBidWlsZERhdGFLZXkoRU5USVRZLCBzaXRlLmlkKTtcclxuICBjb25zdCBpbmRleEtleSA9IGJ1aWxkSW5kZXhLZXkoRU5USVRZKTtcclxuICBcclxuICBhd2FpdCBrdlNldChrZXksIHNpdGUpO1xyXG4gIGF3YWl0IGt2U0FkZChpbmRleEtleSwgc2l0ZS5pZCk7XHJcbiAgXHJcbiAgcmV0dXJuIHNpdGU7XHJcbn1cclxuXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBkZWxldGVTaXRlKGlkOiBzdHJpbmcpOiBQcm9taXNlPHZvaWQ+IHtcclxuICBjb25zdCBrZXkgPSBidWlsZERhdGFLZXkoRU5USVRZLCBpZCk7XHJcbiAgY29uc3QgaW5kZXhLZXkgPSBidWlsZEluZGV4S2V5KEVOVElUWSk7XHJcbiAgXHJcbiAgYXdhaXQga3ZEZWwoa2V5KTtcclxuICBhd2FpdCBrdlNSZW0oaW5kZXhLZXksIGlkKTtcclxufVxyXG5cclxuLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxyXG4vLyBTRVRUTEVNRU5UIE1FVEhPRFMgKFJlZmVyZW5jZSBkYXRhIGZvciBTaXRlcylcclxuLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGdldEFsbFNldHRsZW1lbnRzKCk6IFByb21pc2U8U2V0dGxlbWVudFtdPiB7XHJcbiAgY29uc3QgaW5kZXhLZXkgPSBidWlsZEluZGV4S2V5KFNFVFRMRU1FTlRTX0VOVElUWSk7XHJcbiAgY29uc3QgaWRzID0gYXdhaXQga3ZTTWVtYmVycyhpbmRleEtleSk7XHJcbiAgaWYgKGlkcy5sZW5ndGggPT09IDApIHJldHVybiBbXTtcclxuICBcclxuICBjb25zdCBrZXlzID0gaWRzLm1hcChpZCA9PiBidWlsZERhdGFLZXkoU0VUVExFTUVOVFNfRU5USVRZLCBpZCkpO1xyXG4gIGNvbnN0IHNldHRsZW1lbnRzID0gYXdhaXQga3ZNR2V0PFNldHRsZW1lbnQ+KGtleXMpO1xyXG4gIHJldHVybiBzZXR0bGVtZW50cy5maWx0ZXIoKHNldHRsZW1lbnQpOiBzZXR0bGVtZW50IGlzIFNldHRsZW1lbnQgPT4gc2V0dGxlbWVudCAhPT0gbnVsbCk7XHJcbn1cclxuXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBnZXRTZXR0bGVtZW50QnlJZChpZDogc3RyaW5nKTogUHJvbWlzZTxTZXR0bGVtZW50IHwgbnVsbD4ge1xyXG4gIGNvbnN0IGtleSA9IGJ1aWxkRGF0YUtleShTRVRUTEVNRU5UU19FTlRJVFksIGlkKTtcclxuICByZXR1cm4gYXdhaXQga3ZHZXQ8U2V0dGxlbWVudD4oa2V5KTtcclxufVxyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIHVwc2VydFNldHRsZW1lbnQoc2V0dGxlbWVudDogU2V0dGxlbWVudCk6IFByb21pc2U8U2V0dGxlbWVudD4ge1xyXG4gIGNvbnN0IGtleSA9IGJ1aWxkRGF0YUtleShTRVRUTEVNRU5UU19FTlRJVFksIHNldHRsZW1lbnQuaWQpO1xyXG4gIGNvbnN0IGluZGV4S2V5ID0gYnVpbGRJbmRleEtleShTRVRUTEVNRU5UU19FTlRJVFkpO1xyXG4gIFxyXG4gIGF3YWl0IGt2U2V0KGtleSwgc2V0dGxlbWVudCk7XHJcbiAgYXdhaXQga3ZTQWRkKGluZGV4S2V5LCBzZXR0bGVtZW50LmlkKTtcclxuICBcclxuICByZXR1cm4gc2V0dGxlbWVudDtcclxufVxyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIHJlbW92ZVNldHRsZW1lbnQoaWQ6IHN0cmluZyk6IFByb21pc2U8dm9pZD4ge1xyXG4gIGNvbnN0IGtleSA9IGJ1aWxkRGF0YUtleShTRVRUTEVNRU5UU19FTlRJVFksIGlkKTtcclxuICBjb25zdCBpbmRleEtleSA9IGJ1aWxkSW5kZXhLZXkoU0VUVExFTUVOVFNfRU5USVRZKTtcclxuICBcclxuICBhd2FpdCBrdkRlbChrZXkpO1xyXG4gIGF3YWl0IGt2U1JlbShpbmRleEtleSwgaWQpO1xyXG59XHJcblxyXG4vLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XHJcbi8vIFNJVEUgUVVFUlkgTUVUSE9EU1xyXG4vLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XHJcblxyXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gZ2V0U2l0ZXNCeVNldHRsZW1lbnQoc2V0dGxlbWVudElkOiBzdHJpbmcpOiBQcm9taXNlPFNpdGVbXT4ge1xyXG4gIGNvbnN0IGFsbFNpdGVzID0gYXdhaXQgZ2V0QWxsU2l0ZXMoKTtcclxuICByZXR1cm4gYWxsU2l0ZXMuZmlsdGVyKHNpdGUgPT4ge1xyXG4gICAgaWYgKHNpdGUubWV0YWRhdGEudHlwZSAhPT0gJ1BIWVNJQ0FMJykgcmV0dXJuIGZhbHNlO1xyXG4gICAgY29uc3QgcGh5c2ljYWxNZXRhID0gc2l0ZS5tZXRhZGF0YSBhcyBQaHlzaWNhbFNpdGVNZXRhZGF0YTtcclxuICAgIHJldHVybiBwaHlzaWNhbE1ldGEuc2V0dGxlbWVudElkID09PSBzZXR0bGVtZW50SWQ7XHJcbiAgfSk7XHJcbn1cclxuXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBnZXRTaXRlc0J5UmFkaXVzKFxyXG4gIGNlbnRlckxhdDogbnVtYmVyLFxyXG4gIGNlbnRlckxuZzogbnVtYmVyLFxyXG4gIHJhZGl1c01ldGVyczogbnVtYmVyXHJcbik6IFByb21pc2U8U2l0ZVtdPiB7XHJcbiAgY29uc3QgYWxsU2l0ZXMgPSBhd2FpdCBnZXRBbGxTaXRlcygpO1xyXG4gIGNvbnN0IHNldHRsZW1lbnRzTWFwID0gbmV3IE1hcDxzdHJpbmcsIFNldHRsZW1lbnQ+KCk7XHJcbiAgXHJcbiAgLy8gTG9hZCBhbGwgc2V0dGxlbWVudHMgd2l0aCBjb29yZGluYXRlc1xyXG4gIGNvbnN0IHNldHRsZW1lbnRzID0gYXdhaXQgZ2V0QWxsU2V0dGxlbWVudHMoKTtcclxuICBzZXR0bGVtZW50cy5mb3JFYWNoKHMgPT4ge1xyXG4gICAgaWYgKHMuY29vcmRpbmF0ZXMpIHNldHRsZW1lbnRzTWFwLnNldChzLmlkLCBzKTtcclxuICB9KTtcclxuICBcclxuICByZXR1cm4gYWxsU2l0ZXMuZmlsdGVyKHNpdGUgPT4ge1xyXG4gICAgaWYgKHNpdGUubWV0YWRhdGEudHlwZSAhPT0gJ1BIWVNJQ0FMJykgcmV0dXJuIGZhbHNlO1xyXG4gICAgY29uc3QgcGh5c2ljYWxNZXRhID0gc2l0ZS5tZXRhZGF0YSBhcyBQaHlzaWNhbFNpdGVNZXRhZGF0YTtcclxuICAgIGNvbnN0IHNldHRsZW1lbnQgPSBzZXR0bGVtZW50c01hcC5nZXQocGh5c2ljYWxNZXRhLnNldHRsZW1lbnRJZCk7XHJcbiAgICBcclxuICAgIGlmICghc2V0dGxlbWVudD8uY29vcmRpbmF0ZXMpIHJldHVybiBmYWxzZTtcclxuICAgIFxyXG4gICAgLy8gSGF2ZXJzaW5lIGZvcm11bGEgZm9yIGRpc3RhbmNlIGNhbGN1bGF0aW9uXHJcbiAgICBjb25zdCBSID0gNjM3MTAwMDsgLy8gRWFydGggcmFkaXVzIGluIG1ldGVyc1xyXG4gICAgY29uc3Qgz4YxID0gY2VudGVyTGF0ICogTWF0aC5QSSAvIDE4MDtcclxuICAgIGNvbnN0IM+GMiA9IHNldHRsZW1lbnQuY29vcmRpbmF0ZXMubGF0ICogTWF0aC5QSSAvIDE4MDtcclxuICAgIGNvbnN0IM6Uz4YgPSAoc2V0dGxlbWVudC5jb29yZGluYXRlcy5sYXQgLSBjZW50ZXJMYXQpICogTWF0aC5QSSAvIDE4MDtcclxuICAgIGNvbnN0IM6UzrsgPSAoc2V0dGxlbWVudC5jb29yZGluYXRlcy5sbmcgLSBjZW50ZXJMbmcpICogTWF0aC5QSSAvIDE4MDtcclxuICAgIFxyXG4gICAgY29uc3QgYSA9IE1hdGguc2luKM6Uz4YvMikgKiBNYXRoLnNpbijOlM+GLzIpICtcclxuICAgICAgICAgICAgICBNYXRoLmNvcyjPhjEpICogTWF0aC5jb3Moz4YyKSAqXHJcbiAgICAgICAgICAgICAgTWF0aC5zaW4ozpTOuy8yKSAqIE1hdGguc2luKM6UzrsvMik7XHJcbiAgICBjb25zdCBjID0gMiAqIE1hdGguYXRhbjIoTWF0aC5zcXJ0KGEpLCBNYXRoLnNxcnQoMS1hKSk7XHJcbiAgICBjb25zdCBkaXN0YW5jZSA9IFIgKiBjO1xyXG4gICAgXHJcbiAgICByZXR1cm4gZGlzdGFuY2UgPD0gcmFkaXVzTWV0ZXJzO1xyXG4gIH0pO1xyXG59XHJcbiJdLCJuYW1lcyI6WyJrdkdldCIsImt2TUdldCIsImt2U2V0Iiwia3ZEZWwiLCJrdlNBZGQiLCJrdlNSZW0iLCJrdlNNZW1iZXJzIiwiYnVpbGREYXRhS2V5IiwiYnVpbGRJbmRleEtleSIsIkVOVElUWSIsIlNFVFRMRU1FTlRTX0VOVElUWSIsImdldEFsbFNpdGVzIiwiaW5kZXhLZXkiLCJpZHMiLCJsZW5ndGgiLCJrZXlzIiwibWFwIiwiaWQiLCJzaXRlcyIsImZpbHRlciIsInNpdGUiLCJnZXRTaXRlQnlJZCIsImtleSIsInVwc2VydFNpdGUiLCJkZWxldGVTaXRlIiwiZ2V0QWxsU2V0dGxlbWVudHMiLCJzZXR0bGVtZW50cyIsInNldHRsZW1lbnQiLCJnZXRTZXR0bGVtZW50QnlJZCIsInVwc2VydFNldHRsZW1lbnQiLCJyZW1vdmVTZXR0bGVtZW50IiwiZ2V0U2l0ZXNCeVNldHRsZW1lbnQiLCJzZXR0bGVtZW50SWQiLCJhbGxTaXRlcyIsIm1ldGFkYXRhIiwidHlwZSIsInBoeXNpY2FsTWV0YSIsImdldFNpdGVzQnlSYWRpdXMiLCJjZW50ZXJMYXQiLCJjZW50ZXJMbmciLCJyYWRpdXNNZXRlcnMiLCJzZXR0bGVtZW50c01hcCIsIk1hcCIsImZvckVhY2giLCJzIiwiY29vcmRpbmF0ZXMiLCJzZXQiLCJnZXQiLCJSIiwiz4YxIiwiTWF0aCIsIlBJIiwiz4YyIiwibGF0IiwizpTPhiIsIs6UzrsiLCJsbmciLCJhIiwic2luIiwiY29zIiwiYyIsImF0YW4yIiwic3FydCIsImRpc3RhbmNlIl0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(rsc)/./data-store/repositories/site.repo.ts\n");

/***/ }),

/***/ "(rsc)/./data-store/repositories/task.repo.ts":
/*!**********************************************!*\
  !*** ./data-store/repositories/task.repo.ts ***!
  \**********************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   deleteTask: () => (/* binding */ deleteTask),\n/* harmony export */   getAllTasks: () => (/* binding */ getAllTasks),\n/* harmony export */   getTaskById: () => (/* binding */ getTaskById),\n/* harmony export */   upsertTask: () => (/* binding */ upsertTask)\n/* harmony export */ });\n/* harmony import */ var _data_store_kv__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @/data-store/kv */ \"(rsc)/./data-store/kv.ts\");\n/* harmony import */ var _data_store_keys__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @/data-store/keys */ \"(rsc)/./data-store/keys.ts\");\n// data-store/repositories/task.repo.ts\n\n\nconst ENTITY = \"task\";\nasync function getTaskById(id) {\n    return await (0,_data_store_kv__WEBPACK_IMPORTED_MODULE_0__.kvGet)((0,_data_store_keys__WEBPACK_IMPORTED_MODULE_1__.buildDataKey)(ENTITY, id));\n}\nasync function getAllTasks() {\n    const ids = await (0,_data_store_kv__WEBPACK_IMPORTED_MODULE_0__.kvSMembers)((0,_data_store_keys__WEBPACK_IMPORTED_MODULE_1__.buildIndexKey)(ENTITY));\n    const rows = await Promise.all(ids.map((id)=>(0,_data_store_kv__WEBPACK_IMPORTED_MODULE_0__.kvGet)((0,_data_store_keys__WEBPACK_IMPORTED_MODULE_1__.buildDataKey)(ENTITY, id))));\n    return rows.filter(Boolean);\n}\nasync function upsertTask(task) {\n    await (0,_data_store_kv__WEBPACK_IMPORTED_MODULE_0__.kvSet)((0,_data_store_keys__WEBPACK_IMPORTED_MODULE_1__.buildDataKey)(ENTITY, task.id), task);\n    await (0,_data_store_kv__WEBPACK_IMPORTED_MODULE_0__.kvSAdd)((0,_data_store_keys__WEBPACK_IMPORTED_MODULE_1__.buildIndexKey)(ENTITY), task.id);\n    return task;\n}\nasync function deleteTask(id) {\n    await (0,_data_store_kv__WEBPACK_IMPORTED_MODULE_0__.kvDel)((0,_data_store_keys__WEBPACK_IMPORTED_MODULE_1__.buildDataKey)(ENTITY, id));\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9kYXRhLXN0b3JlL3JlcG9zaXRvcmllcy90YXNrLnJlcG8udHMiLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7O0FBQUEsdUNBQXVDO0FBRW1DO0FBQ1Y7QUFFaEUsTUFBTU8sU0FBUztBQUVSLGVBQWVDLFlBQVlDLEVBQVU7SUFDMUMsT0FBTyxNQUFNVCxxREFBS0EsQ0FBT0ssOERBQVlBLENBQUNFLFFBQVFFO0FBQ2hEO0FBRU8sZUFBZUM7SUFDcEIsTUFBTUMsTUFBTSxNQUFNUiwwREFBVUEsQ0FBQ0csK0RBQWFBLENBQUNDO0lBQzNDLE1BQU1LLE9BQU8sTUFBTUMsUUFBUUMsR0FBRyxDQUFDSCxJQUFJSSxHQUFHLENBQUNOLENBQUFBLEtBQU1ULHFEQUFLQSxDQUFPSyw4REFBWUEsQ0FBQ0UsUUFBUUU7SUFDOUUsT0FBT0csS0FBS0ksTUFBTSxDQUFDQztBQUNyQjtBQUVPLGVBQWVDLFdBQVdDLElBQVU7SUFDekMsTUFBTWxCLHFEQUFLQSxDQUFDSSw4REFBWUEsQ0FBQ0UsUUFBUVksS0FBS1YsRUFBRSxHQUFHVTtJQUMzQyxNQUFNZixzREFBTUEsQ0FBQ0UsK0RBQWFBLENBQUNDLFNBQVNZLEtBQUtWLEVBQUU7SUFDM0MsT0FBT1U7QUFDVDtBQUVPLGVBQWVDLFdBQVdYLEVBQVU7SUFDekMsTUFBTVAscURBQUtBLENBQUNHLDhEQUFZQSxDQUFDRSxRQUFRRTtBQUNuQyIsInNvdXJjZXMiOlsid2VicGFjazovL3RoZWdhbWUtYWRtaW4vLi9kYXRhLXN0b3JlL3JlcG9zaXRvcmllcy90YXNrLnJlcG8udHM/NjJmZSJdLCJzb3VyY2VzQ29udGVudCI6WyIvLyBkYXRhLXN0b3JlL3JlcG9zaXRvcmllcy90YXNrLnJlcG8udHNcclxuaW1wb3J0IHR5cGUgeyBUYXNrIH0gZnJvbSAnQC90eXBlcy9lbnRpdGllcyc7XHJcbmltcG9ydCB7IGt2R2V0LCBrdlNldCwga3ZEZWwsIGt2U01lbWJlcnMsIGt2U0FkZCB9IGZyb20gJ0AvZGF0YS1zdG9yZS9rdic7XHJcbmltcG9ydCB7IGJ1aWxkRGF0YUtleSwgYnVpbGRJbmRleEtleSB9IGZyb20gJ0AvZGF0YS1zdG9yZS9rZXlzJztcclxuXHJcbmNvbnN0IEVOVElUWSA9ICd0YXNrJztcclxuXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBnZXRUYXNrQnlJZChpZDogc3RyaW5nKTogUHJvbWlzZTxUYXNrIHwgbnVsbD4ge1xyXG4gIHJldHVybiBhd2FpdCBrdkdldDxUYXNrPihidWlsZERhdGFLZXkoRU5USVRZLCBpZCkpO1xyXG59XHJcblxyXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gZ2V0QWxsVGFza3MoKTogUHJvbWlzZTxUYXNrW10+IHtcclxuICBjb25zdCBpZHMgPSBhd2FpdCBrdlNNZW1iZXJzKGJ1aWxkSW5kZXhLZXkoRU5USVRZKSk7XHJcbiAgY29uc3Qgcm93cyA9IGF3YWl0IFByb21pc2UuYWxsKGlkcy5tYXAoaWQgPT4ga3ZHZXQ8VGFzaz4oYnVpbGREYXRhS2V5KEVOVElUWSwgaWQpKSkpO1xyXG4gIHJldHVybiByb3dzLmZpbHRlcihCb29sZWFuKSBhcyBUYXNrW107XHJcbn1cclxuXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiB1cHNlcnRUYXNrKHRhc2s6IFRhc2spOiBQcm9taXNlPFRhc2s+IHtcclxuICBhd2FpdCBrdlNldChidWlsZERhdGFLZXkoRU5USVRZLCB0YXNrLmlkKSwgdGFzayk7XHJcbiAgYXdhaXQga3ZTQWRkKGJ1aWxkSW5kZXhLZXkoRU5USVRZKSwgdGFzay5pZCk7XHJcbiAgcmV0dXJuIHRhc2s7XHJcbn1cclxuXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBkZWxldGVUYXNrKGlkOiBzdHJpbmcpOiBQcm9taXNlPHZvaWQ+IHtcclxuICBhd2FpdCBrdkRlbChidWlsZERhdGFLZXkoRU5USVRZLCBpZCkpO1xyXG59XHJcblxyXG5cclxuIl0sIm5hbWVzIjpbImt2R2V0Iiwia3ZTZXQiLCJrdkRlbCIsImt2U01lbWJlcnMiLCJrdlNBZGQiLCJidWlsZERhdGFLZXkiLCJidWlsZEluZGV4S2V5IiwiRU5USVRZIiwiZ2V0VGFza0J5SWQiLCJpZCIsImdldEFsbFRhc2tzIiwiaWRzIiwicm93cyIsIlByb21pc2UiLCJhbGwiLCJtYXAiLCJmaWx0ZXIiLCJCb29sZWFuIiwidXBzZXJ0VGFzayIsInRhc2siLCJkZWxldGVUYXNrIl0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(rsc)/./data-store/repositories/task.repo.ts\n");

/***/ }),

/***/ "(rsc)/./lib/api-auth.ts":
/*!*************************!*\
  !*** ./lib/api-auth.ts ***!
  \*************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   requireAdminAuth: () => (/* binding */ requireAdminAuth)\n/* harmony export */ });\n/* harmony import */ var _auth__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./auth */ \"(rsc)/./lib/auth.ts\");\n// lib/api-auth.ts\n// API Authentication Utility for protecting API routes\n// Ensures only authenticated admin users can access API endpoints\n\n/**\r\n * Require admin authentication for API routes\r\n * Returns true if user is authenticated, false otherwise\r\n */ async function requireAdminAuth(req) {\n    try {\n        // Get the admin session token from cookies\n        const token = req.cookies.get(\"admin_session\")?.value;\n        // Get the JWT secret from environment variables\n        const secret = process.env.ADMIN_SESSION_SECRET || \"\";\n        // If no token or secret, user is not authenticated\n        if (!token || !secret) {\n            console.log(\"[API Auth] No token or secret found\");\n            return false;\n        }\n        // Verify the JWT token\n        const verified = await (0,_auth__WEBPACK_IMPORTED_MODULE_0__.verifyJwt)(token, secret);\n        if (verified.valid) {\n            // console.log('[API Auth] User authenticated successfully'); // Disabled to reduce log spam\n            return true;\n        } else {\n            console.log(\"[API Auth] Invalid token:\", verified.reason);\n            return false;\n        }\n    } catch (error) {\n        console.error(\"[API Auth] Error verifying authentication:\", error);\n        return false;\n    }\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9saWIvYXBpLWF1dGgudHMiLCJtYXBwaW5ncyI6Ijs7Ozs7QUFBQSxrQkFBa0I7QUFDbEIsdURBQXVEO0FBQ3ZELGtFQUFrRTtBQUcvQjtBQUVuQzs7O0NBR0MsR0FDTSxlQUFlQyxpQkFBaUJDLEdBQWdCO0lBQ3JELElBQUk7UUFDRiwyQ0FBMkM7UUFDM0MsTUFBTUMsUUFBUUQsSUFBSUUsT0FBTyxDQUFDQyxHQUFHLENBQUMsa0JBQWtCQztRQUVoRCxnREFBZ0Q7UUFDaEQsTUFBTUMsU0FBU0MsUUFBUUMsR0FBRyxDQUFDQyxvQkFBb0IsSUFBSTtRQUVuRCxtREFBbUQ7UUFDbkQsSUFBSSxDQUFDUCxTQUFTLENBQUNJLFFBQVE7WUFDckJJLFFBQVFDLEdBQUcsQ0FBQztZQUNaLE9BQU87UUFDVDtRQUVBLHVCQUF1QjtRQUN2QixNQUFNQyxXQUFXLE1BQU1iLGdEQUFTQSxDQUFDRyxPQUFPSTtRQUV4QyxJQUFJTSxTQUFTQyxLQUFLLEVBQUU7WUFDbEIsNEZBQTRGO1lBQzVGLE9BQU87UUFDVCxPQUFPO1lBQ0xILFFBQVFDLEdBQUcsQ0FBQyw2QkFBNkJDLFNBQVNFLE1BQU07WUFDeEQsT0FBTztRQUNUO0lBQ0YsRUFBRSxPQUFPQyxPQUFPO1FBQ2RMLFFBQVFLLEtBQUssQ0FBQyw4Q0FBOENBO1FBQzVELE9BQU87SUFDVDtBQUNGIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vdGhlZ2FtZS1hZG1pbi8uL2xpYi9hcGktYXV0aC50cz9iMzBlIl0sInNvdXJjZXNDb250ZW50IjpbIi8vIGxpYi9hcGktYXV0aC50c1xyXG4vLyBBUEkgQXV0aGVudGljYXRpb24gVXRpbGl0eSBmb3IgcHJvdGVjdGluZyBBUEkgcm91dGVzXHJcbi8vIEVuc3VyZXMgb25seSBhdXRoZW50aWNhdGVkIGFkbWluIHVzZXJzIGNhbiBhY2Nlc3MgQVBJIGVuZHBvaW50c1xyXG5cclxuaW1wb3J0IHsgTmV4dFJlcXVlc3QgfSBmcm9tICduZXh0L3NlcnZlcic7XHJcbmltcG9ydCB7IHZlcmlmeUp3dCB9IGZyb20gJy4vYXV0aCc7XHJcblxyXG4vKipcclxuICogUmVxdWlyZSBhZG1pbiBhdXRoZW50aWNhdGlvbiBmb3IgQVBJIHJvdXRlc1xyXG4gKiBSZXR1cm5zIHRydWUgaWYgdXNlciBpcyBhdXRoZW50aWNhdGVkLCBmYWxzZSBvdGhlcndpc2VcclxuICovXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiByZXF1aXJlQWRtaW5BdXRoKHJlcTogTmV4dFJlcXVlc3QpOiBQcm9taXNlPGJvb2xlYW4+IHtcclxuICB0cnkge1xyXG4gICAgLy8gR2V0IHRoZSBhZG1pbiBzZXNzaW9uIHRva2VuIGZyb20gY29va2llc1xyXG4gICAgY29uc3QgdG9rZW4gPSByZXEuY29va2llcy5nZXQoJ2FkbWluX3Nlc3Npb24nKT8udmFsdWU7XHJcbiAgICBcclxuICAgIC8vIEdldCB0aGUgSldUIHNlY3JldCBmcm9tIGVudmlyb25tZW50IHZhcmlhYmxlc1xyXG4gICAgY29uc3Qgc2VjcmV0ID0gcHJvY2Vzcy5lbnYuQURNSU5fU0VTU0lPTl9TRUNSRVQgfHwgJyc7XHJcbiAgICBcclxuICAgIC8vIElmIG5vIHRva2VuIG9yIHNlY3JldCwgdXNlciBpcyBub3QgYXV0aGVudGljYXRlZFxyXG4gICAgaWYgKCF0b2tlbiB8fCAhc2VjcmV0KSB7XHJcbiAgICAgIGNvbnNvbGUubG9nKCdbQVBJIEF1dGhdIE5vIHRva2VuIG9yIHNlY3JldCBmb3VuZCcpO1xyXG4gICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICB9XHJcbiAgICBcclxuICAgIC8vIFZlcmlmeSB0aGUgSldUIHRva2VuXHJcbiAgICBjb25zdCB2ZXJpZmllZCA9IGF3YWl0IHZlcmlmeUp3dCh0b2tlbiwgc2VjcmV0KTtcclxuICAgIFxyXG4gICAgaWYgKHZlcmlmaWVkLnZhbGlkKSB7XHJcbiAgICAgIC8vIGNvbnNvbGUubG9nKCdbQVBJIEF1dGhdIFVzZXIgYXV0aGVudGljYXRlZCBzdWNjZXNzZnVsbHknKTsgLy8gRGlzYWJsZWQgdG8gcmVkdWNlIGxvZyBzcGFtXHJcbiAgICAgIHJldHVybiB0cnVlO1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgY29uc29sZS5sb2coJ1tBUEkgQXV0aF0gSW52YWxpZCB0b2tlbjonLCB2ZXJpZmllZC5yZWFzb24pO1xyXG4gICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICB9XHJcbiAgfSBjYXRjaCAoZXJyb3IpIHtcclxuICAgIGNvbnNvbGUuZXJyb3IoJ1tBUEkgQXV0aF0gRXJyb3IgdmVyaWZ5aW5nIGF1dGhlbnRpY2F0aW9uOicsIGVycm9yKTtcclxuICAgIHJldHVybiBmYWxzZTtcclxuICB9XHJcbn1cclxuXHJcblxyXG4iXSwibmFtZXMiOlsidmVyaWZ5Snd0IiwicmVxdWlyZUFkbWluQXV0aCIsInJlcSIsInRva2VuIiwiY29va2llcyIsImdldCIsInZhbHVlIiwic2VjcmV0IiwicHJvY2VzcyIsImVudiIsIkFETUlOX1NFU1NJT05fU0VDUkVUIiwiY29uc29sZSIsImxvZyIsInZlcmlmaWVkIiwidmFsaWQiLCJyZWFzb24iLCJlcnJvciJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./lib/api-auth.ts\n");

/***/ }),

/***/ "(rsc)/./lib/auth.ts":
/*!*********************!*\
  !*** ./lib/auth.ts ***!
  \*********************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   generateJwt: () => (/* binding */ generateJwt),\n/* harmony export */   getRequiredEnv: () => (/* binding */ getRequiredEnv),\n/* harmony export */   verifyJwt: () => (/* binding */ verifyJwt)\n/* harmony export */ });\n/* harmony import */ var jose__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! jose */ \"(rsc)/./node_modules/jose/dist/node/esm/jwt/sign.js\");\n/* harmony import */ var jose__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! jose */ \"(rsc)/./node_modules/jose/dist/node/esm/jwt/verify.js\");\n// lib/auth.ts\n// JWT (HS256) utilities for Node runtime (route handlers)\n\nfunction toUint8Array(input) {\n    return new TextEncoder().encode(input);\n}\nasync function generateJwt(claims, secret, expiresInSeconds) {\n    const key = toUint8Array(secret);\n    const nowSeconds = Math.floor(Date.now() / 1000);\n    return await new jose__WEBPACK_IMPORTED_MODULE_0__.SignJWT({\n        ...claims\n    }).setProtectedHeader({\n        alg: \"HS256\"\n    }).setIssuedAt(nowSeconds).setExpirationTime(nowSeconds + expiresInSeconds).sign(key);\n}\nasync function verifyJwt(token, secret) {\n    try {\n        const key = toUint8Array(secret);\n        const { payload } = await (0,jose__WEBPACK_IMPORTED_MODULE_1__.jwtVerify)(token, key);\n        return {\n            valid: true,\n            payload: payload\n        };\n    } catch (_e) {\n        return {\n            valid: false,\n            reason: \"error\"\n        };\n    }\n}\nfunction getRequiredEnv(name) {\n    const value = process.env[name];\n    if (!value || value.trim() === \"\") {\n        throw new Error(`${name} is not set. Add it to .env.local and Vercel project settings.`);\n    }\n    return value;\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9saWIvYXV0aC50cyIsIm1hcHBpbmdzIjoiOzs7Ozs7OztBQUFBLGNBQWM7QUFDZCwwREFBMEQ7QUFDaEI7QUFVMUMsU0FBU0UsYUFBYUMsS0FBYTtJQUNqQyxPQUFPLElBQUlDLGNBQWNDLE1BQU0sQ0FBQ0Y7QUFDbEM7QUFFTyxlQUFlRyxZQUFZQyxNQUFzQyxFQUFFQyxNQUFjLEVBQUVDLGdCQUF3QjtJQUNoSCxNQUFNQyxNQUFNUixhQUFhTTtJQUN6QixNQUFNRyxhQUFhQyxLQUFLQyxLQUFLLENBQUNDLEtBQUtDLEdBQUcsS0FBSztJQUMzQyxPQUFPLE1BQU0sSUFBSWYseUNBQU9BLENBQUM7UUFBRSxHQUFHTyxNQUFNO0lBQUMsR0FDbENTLGtCQUFrQixDQUFDO1FBQUVDLEtBQUs7SUFBUSxHQUNsQ0MsV0FBVyxDQUFDUCxZQUNaUSxpQkFBaUIsQ0FBQ1IsYUFBYUYsa0JBQy9CVyxJQUFJLENBQUNWO0FBQ1Y7QUFFTyxlQUFlVyxVQUFVQyxLQUFhLEVBQUVkLE1BQWM7SUFDM0QsSUFBSTtRQUNGLE1BQU1FLE1BQU1SLGFBQWFNO1FBQ3pCLE1BQU0sRUFBRWUsT0FBTyxFQUFFLEdBQUcsTUFBTXRCLCtDQUFTQSxDQUFDcUIsT0FBT1o7UUFDM0MsT0FBTztZQUFFYyxPQUFPO1lBQU1ELFNBQVNBO1FBQWdDO0lBQ2pFLEVBQUUsT0FBT0UsSUFBSTtRQUNYLE9BQU87WUFBRUQsT0FBTztZQUFPRSxRQUFRO1FBQVE7SUFDekM7QUFDRjtBQUVPLFNBQVNDLGVBQWVDLElBQVk7SUFDekMsTUFBTUMsUUFBUUMsUUFBUUMsR0FBRyxDQUFDSCxLQUFLO0lBQy9CLElBQUksQ0FBQ0MsU0FBU0EsTUFBTUcsSUFBSSxPQUFPLElBQUk7UUFDakMsTUFBTSxJQUFJQyxNQUFNLENBQUMsRUFBRUwsS0FBSyw4REFBOEQsQ0FBQztJQUN6RjtJQUNBLE9BQU9DO0FBQ1QiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly90aGVnYW1lLWFkbWluLy4vbGliL2F1dGgudHM/YmY3ZSJdLCJzb3VyY2VzQ29udGVudCI6WyIvLyBsaWIvYXV0aC50c1xyXG4vLyBKV1QgKEhTMjU2KSB1dGlsaXRpZXMgZm9yIE5vZGUgcnVudGltZSAocm91dGUgaGFuZGxlcnMpXHJcbmltcG9ydCB7IFNpZ25KV1QsIGp3dFZlcmlmeSB9IGZyb20gJ2pvc2UnO1xyXG5cclxuZXhwb3J0IGludGVyZmFjZSBKd3RDbGFpbXMge1xyXG4gIHN1Yjogc3RyaW5nO1xyXG4gIHJvbGU6IHN0cmluZztcclxuICBpYXQ6IG51bWJlcjsgLy8gaXNzdWVkIGF0IChzZWNvbmRzIHNpbmNlIGVwb2NoKVxyXG4gIGV4cDogbnVtYmVyOyAvLyBleHBpcnkgKHNlY29uZHMgc2luY2UgZXBvY2gpXHJcbiAgW2tleTogc3RyaW5nXTogdW5rbm93bjtcclxufVxyXG5cclxuZnVuY3Rpb24gdG9VaW50OEFycmF5KGlucHV0OiBzdHJpbmcpOiBVaW50OEFycmF5IHtcclxuICByZXR1cm4gbmV3IFRleHRFbmNvZGVyKCkuZW5jb2RlKGlucHV0KTtcclxufVxyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGdlbmVyYXRlSnd0KGNsYWltczogT21pdDxKd3RDbGFpbXMsICdpYXQnIHwgJ2V4cCc+LCBzZWNyZXQ6IHN0cmluZywgZXhwaXJlc0luU2Vjb25kczogbnVtYmVyKTogUHJvbWlzZTxzdHJpbmc+IHtcclxuICBjb25zdCBrZXkgPSB0b1VpbnQ4QXJyYXkoc2VjcmV0KTtcclxuICBjb25zdCBub3dTZWNvbmRzID0gTWF0aC5mbG9vcihEYXRlLm5vdygpIC8gMTAwMCk7XHJcbiAgcmV0dXJuIGF3YWl0IG5ldyBTaWduSldUKHsgLi4uY2xhaW1zIH0pXHJcbiAgICAuc2V0UHJvdGVjdGVkSGVhZGVyKHsgYWxnOiAnSFMyNTYnIH0pXHJcbiAgICAuc2V0SXNzdWVkQXQobm93U2Vjb25kcylcclxuICAgIC5zZXRFeHBpcmF0aW9uVGltZShub3dTZWNvbmRzICsgZXhwaXJlc0luU2Vjb25kcylcclxuICAgIC5zaWduKGtleSk7XHJcbn1cclxuXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiB2ZXJpZnlKd3QodG9rZW46IHN0cmluZywgc2VjcmV0OiBzdHJpbmcpOiBQcm9taXNlPHsgdmFsaWQ6IGJvb2xlYW47IHBheWxvYWQ/OiBKd3RDbGFpbXM7IHJlYXNvbj86IHN0cmluZyB9PiB7XHJcbiAgdHJ5IHtcclxuICAgIGNvbnN0IGtleSA9IHRvVWludDhBcnJheShzZWNyZXQpO1xyXG4gICAgY29uc3QgeyBwYXlsb2FkIH0gPSBhd2FpdCBqd3RWZXJpZnkodG9rZW4sIGtleSk7XHJcbiAgICByZXR1cm4geyB2YWxpZDogdHJ1ZSwgcGF5bG9hZDogcGF5bG9hZCBhcyB1bmtub3duIGFzIEp3dENsYWltcyB9O1xyXG4gIH0gY2F0Y2ggKF9lKSB7XHJcbiAgICByZXR1cm4geyB2YWxpZDogZmFsc2UsIHJlYXNvbjogJ2Vycm9yJyB9O1xyXG4gIH1cclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIGdldFJlcXVpcmVkRW52KG5hbWU6IHN0cmluZyk6IHN0cmluZyB7XHJcbiAgY29uc3QgdmFsdWUgPSBwcm9jZXNzLmVudltuYW1lXTtcclxuICBpZiAoIXZhbHVlIHx8IHZhbHVlLnRyaW0oKSA9PT0gJycpIHtcclxuICAgIHRocm93IG5ldyBFcnJvcihgJHtuYW1lfSBpcyBub3Qgc2V0LiBBZGQgaXQgdG8gLmVudi5sb2NhbCBhbmQgVmVyY2VsIHByb2plY3Qgc2V0dGluZ3MuYCk7XHJcbiAgfVxyXG4gIHJldHVybiB2YWx1ZTtcclxufVxyXG4iXSwibmFtZXMiOlsiU2lnbkpXVCIsImp3dFZlcmlmeSIsInRvVWludDhBcnJheSIsImlucHV0IiwiVGV4dEVuY29kZXIiLCJlbmNvZGUiLCJnZW5lcmF0ZUp3dCIsImNsYWltcyIsInNlY3JldCIsImV4cGlyZXNJblNlY29uZHMiLCJrZXkiLCJub3dTZWNvbmRzIiwiTWF0aCIsImZsb29yIiwiRGF0ZSIsIm5vdyIsInNldFByb3RlY3RlZEhlYWRlciIsImFsZyIsInNldElzc3VlZEF0Iiwic2V0RXhwaXJhdGlvblRpbWUiLCJzaWduIiwidmVyaWZ5Snd0IiwidG9rZW4iLCJwYXlsb2FkIiwidmFsaWQiLCJfZSIsInJlYXNvbiIsImdldFJlcXVpcmVkRW52IiwibmFtZSIsInZhbHVlIiwicHJvY2VzcyIsImVudiIsInRyaW0iLCJFcnJvciJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./lib/auth.ts\n");

/***/ }),

/***/ "(rsc)/./lib/client-api.ts":
/*!***************************!*\
  !*** ./lib/client-api.ts ***!
  \***************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   ClientAPI: () => (/* binding */ e0)
/* harmony export */ });
/* harmony import */ var next_dist_build_webpack_loaders_next_flight_loader_module_proxy__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/dist/build/webpack/loaders/next-flight-loader/module-proxy */ "(rsc)/./node_modules/next/dist/build/webpack/loaders/next-flight-loader/module-proxy.js");

const proxy = (0,next_dist_build_webpack_loaders_next_flight_loader_module_proxy__WEBPACK_IMPORTED_MODULE_0__.createProxy)(String.raw`C:\Users\Usuario\AKILES\GAME WEB APP\SPLIT\thegame\lib\client-api.ts`)

// Accessing the __esModule property and exporting $$typeof are required here.
// The __esModule getter forces the proxy target to create the default export
// and the $$typeof value is for rendering logic to determine if the module
// is a client boundary.
const { __esModule, $$typeof } = proxy;
const __default__ = proxy.default;

const e0 = (0,next_dist_build_webpack_loaders_next_flight_loader_module_proxy__WEBPACK_IMPORTED_MODULE_0__.createProxy)(String.raw`C:\Users\Usuario\AKILES\GAME WEB APP\SPLIT\thegame\lib\client-api.ts#ClientAPI`);


/***/ }),

/***/ "(rsc)/./links/link-registry.ts":
/*!********************************!*\
  !*** ./links/link-registry.ts ***!
  \********************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   createLink: () => (/* binding */ createLink),\n/* harmony export */   getAllLinks: () => (/* binding */ getAllLinks),\n/* harmony export */   getLinksFor: () => (/* binding */ getLinksFor),\n/* harmony export */   removeLink: () => (/* binding */ removeLink)\n/* harmony export */ });\n/* harmony import */ var _data_store_kv__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @/data-store/kv */ \"(rsc)/./data-store/kv.ts\");\n/* harmony import */ var _data_store_keys__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @/data-store/keys */ \"(rsc)/./data-store/keys.ts\");\n/* harmony import */ var _link_validation__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./link-validation */ \"(rsc)/./links/link-validation.ts\");\n// links/link-registry.ts\n// The Rosetta Stone storage and query layer (KV only)\n\n\n\nasync function createLink(link) {\n    // NEW: Validate before creating\n    const validation = await (0,_link_validation__WEBPACK_IMPORTED_MODULE_2__.validateLink)(link.linkType, link.source, link.target, link.metadata);\n    if (!validation.isValid) {\n        console.warn(`[createLink] Validation failed: ${validation.reason}`);\n        if (validation.warnings) {\n            console.warn(`[createLink] Validation warnings:`, validation.warnings);\n        }\n        return; // Skip creating invalid links\n    }\n    // Log warnings if any\n    if (validation.warnings && validation.warnings.length > 0) {\n        console.warn(`[createLink] Validation warnings for ${link.linkType}:`, validation.warnings);\n    }\n    await (0,_data_store_kv__WEBPACK_IMPORTED_MODULE_0__.kvSet)((0,_data_store_keys__WEBPACK_IMPORTED_MODULE_1__.buildLinkKey)(link.id), link);\n    // index by source and target for bidirectional queries\n    await (0,_data_store_kv__WEBPACK_IMPORTED_MODULE_0__.kvSAdd)((0,_data_store_keys__WEBPACK_IMPORTED_MODULE_1__.buildLinksIndexKey)(link.source.type, link.source.id), link.id);\n    await (0,_data_store_kv__WEBPACK_IMPORTED_MODULE_0__.kvSAdd)((0,_data_store_keys__WEBPACK_IMPORTED_MODULE_1__.buildLinksIndexKey)(link.target.type, link.target.id), link.id);\n}\nasync function getLinksFor(entity) {\n    const ids = await (0,_data_store_kv__WEBPACK_IMPORTED_MODULE_0__.kvSMembers)((0,_data_store_keys__WEBPACK_IMPORTED_MODULE_1__.buildLinksIndexKey)(entity.type, entity.id));\n    if (!ids.length) return [];\n    const keys = ids.map(_data_store_keys__WEBPACK_IMPORTED_MODULE_1__.buildLinkKey);\n    const rows = await Promise.all(keys.map((k)=>(0,_data_store_kv__WEBPACK_IMPORTED_MODULE_0__.kvGet)(k)));\n    return rows.filter(Boolean);\n}\nasync function removeLink(linkId) {\n    const key = (0,_data_store_keys__WEBPACK_IMPORTED_MODULE_1__.buildLinkKey)(linkId);\n    const existing = await (0,_data_store_kv__WEBPACK_IMPORTED_MODULE_0__.kvGet)(key);\n    if (existing) {\n        // Remove from both source and target indexes\n        await (0,_data_store_kv__WEBPACK_IMPORTED_MODULE_0__.kvSRem)((0,_data_store_keys__WEBPACK_IMPORTED_MODULE_1__.buildLinksIndexKey)(existing.source.type, existing.source.id), linkId);\n        await (0,_data_store_kv__WEBPACK_IMPORTED_MODULE_0__.kvSRem)((0,_data_store_keys__WEBPACK_IMPORTED_MODULE_1__.buildLinksIndexKey)(existing.target.type, existing.target.id), linkId);\n    }\n    await (0,_data_store_kv__WEBPACK_IMPORTED_MODULE_0__.kvDel)(key);\n}\nasync function getAllLinks() {\n    const keys = await (0,_data_store_kv__WEBPACK_IMPORTED_MODULE_0__.kvScan)(\"links:link:\");\n    if (!keys.length) return [];\n    const links = await Promise.all(keys.map((k)=>(0,_data_store_kv__WEBPACK_IMPORTED_MODULE_0__.kvGet)(k)));\n    return links.filter(Boolean);\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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d2VicGFjazovL3RoZWdhbWUtYWRtaW4vLi9saW5rcy9saW5rLXJlZ2lzdHJ5LnRzP2VhMDciXSwic291cmNlc0NvbnRlbnQiOlsiLy8gbGlua3MvbGluay1yZWdpc3RyeS50c1xyXG4vLyBUaGUgUm9zZXR0YSBTdG9uZSBzdG9yYWdlIGFuZCBxdWVyeSBsYXllciAoS1Ygb25seSlcclxuXHJcbmltcG9ydCB7IExpbmtUeXBlLCBFbnRpdHlUeXBlIH0gZnJvbSAnQC90eXBlcy9lbnVtcyc7XHJcbmltcG9ydCB0eXBlIHsgTGluayB9IGZyb20gJ0AvdHlwZXMvZW50aXRpZXMnO1xyXG5pbXBvcnQgeyBrdkdldCwga3ZTZXQsIGt2RGVsLCBrdlNBZGQsIGt2U1JlbSwga3ZTTWVtYmVycywga3ZTY2FuIH0gZnJvbSAnQC9kYXRhLXN0b3JlL2t2JztcclxuaW1wb3J0IHsgYnVpbGRMaW5rS2V5LCBidWlsZExpbmtzSW5kZXhLZXkgfSBmcm9tICdAL2RhdGEtc3RvcmUva2V5cyc7XHJcbmltcG9ydCB7IHZhbGlkYXRlTGluayB9IGZyb20gJy4vbGluay12YWxpZGF0aW9uJztcclxuXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBjcmVhdGVMaW5rKGxpbms6IExpbmspOiBQcm9taXNlPHZvaWQ+IHtcclxuICAvLyBORVc6IFZhbGlkYXRlIGJlZm9yZSBjcmVhdGluZ1xyXG4gIGNvbnN0IHZhbGlkYXRpb24gPSBhd2FpdCB2YWxpZGF0ZUxpbmsobGluay5saW5rVHlwZSwgbGluay5zb3VyY2UsIGxpbmsudGFyZ2V0LCBsaW5rLm1ldGFkYXRhKTtcclxuICBpZiAoIXZhbGlkYXRpb24uaXNWYWxpZCkge1xyXG4gICAgY29uc29sZS53YXJuKGBbY3JlYXRlTGlua10gVmFsaWRhdGlvbiBmYWlsZWQ6ICR7dmFsaWRhdGlvbi5yZWFzb259YCk7XHJcbiAgICBpZiAodmFsaWRhdGlvbi53YXJuaW5ncykge1xyXG4gICAgICBjb25zb2xlLndhcm4oYFtjcmVhdGVMaW5rXSBWYWxpZGF0aW9uIHdhcm5pbmdzOmAsIHZhbGlkYXRpb24ud2FybmluZ3MpO1xyXG4gICAgfVxyXG4gICAgcmV0dXJuOyAvLyBTa2lwIGNyZWF0aW5nIGludmFsaWQgbGlua3NcclxuICB9XHJcbiAgXHJcbiAgLy8gTG9nIHdhcm5pbmdzIGlmIGFueVxyXG4gIGlmICh2YWxpZGF0aW9uLndhcm5pbmdzICYmIHZhbGlkYXRpb24ud2FybmluZ3MubGVuZ3RoID4gMCkge1xyXG4gICAgY29uc29sZS53YXJuKGBbY3JlYXRlTGlua10gVmFsaWRhdGlvbiB3YXJuaW5ncyBmb3IgJHtsaW5rLmxpbmtUeXBlfTpgLCB2YWxpZGF0aW9uLndhcm5pbmdzKTtcclxuICB9XHJcbiAgXHJcbiAgYXdhaXQga3ZTZXQoYnVpbGRMaW5rS2V5KGxpbmsuaWQpLCBsaW5rKTtcclxuICAvLyBpbmRleCBieSBzb3VyY2UgYW5kIHRhcmdldCBmb3IgYmlkaXJlY3Rpb25hbCBxdWVyaWVzXHJcbiAgYXdhaXQga3ZTQWRkKGJ1aWxkTGlua3NJbmRleEtleShsaW5rLnNvdXJjZS50eXBlLCBsaW5rLnNvdXJjZS5pZCksIGxpbmsuaWQpO1xyXG4gIGF3YWl0IGt2U0FkZChidWlsZExpbmtzSW5kZXhLZXkobGluay50YXJnZXQudHlwZSwgbGluay50YXJnZXQuaWQpLCBsaW5rLmlkKTtcclxufVxyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGdldExpbmtzRm9yKGVudGl0eTogeyB0eXBlOiBFbnRpdHlUeXBlOyBpZDogc3RyaW5nIH0pOiBQcm9taXNlPExpbmtbXT4ge1xyXG4gIGNvbnN0IGlkcyA9IGF3YWl0IGt2U01lbWJlcnMoYnVpbGRMaW5rc0luZGV4S2V5KGVudGl0eS50eXBlLCBlbnRpdHkuaWQpKTtcclxuICBpZiAoIWlkcy5sZW5ndGgpIHJldHVybiBbXTtcclxuICBjb25zdCBrZXlzID0gaWRzLm1hcChidWlsZExpbmtLZXkpO1xyXG4gIGNvbnN0IHJvd3MgPSBhd2FpdCBQcm9taXNlLmFsbChrZXlzLm1hcChrID0+IGt2R2V0PExpbms+KGspKSk7XHJcbiAgcmV0dXJuIHJvd3MuZmlsdGVyKEJvb2xlYW4pIGFzIExpbmtbXTtcclxufVxyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIHJlbW92ZUxpbmsobGlua0lkOiBzdHJpbmcpOiBQcm9taXNlPHZvaWQ+IHtcclxuICBjb25zdCBrZXkgPSBidWlsZExpbmtLZXkobGlua0lkKTtcclxuICBjb25zdCBleGlzdGluZyA9IGF3YWl0IGt2R2V0PExpbms+KGtleSk7XHJcbiAgaWYgKGV4aXN0aW5nKSB7XHJcbiAgICAvLyBSZW1vdmUgZnJvbSBib3RoIHNvdXJjZSBhbmQgdGFyZ2V0IGluZGV4ZXNcclxuICAgIGF3YWl0IGt2U1JlbShidWlsZExpbmtzSW5kZXhLZXkoZXhpc3Rpbmcuc291cmNlLnR5cGUsIGV4aXN0aW5nLnNvdXJjZS5pZCksIGxpbmtJZCk7XHJcbiAgICBhd2FpdCBrdlNSZW0oYnVpbGRMaW5rc0luZGV4S2V5KGV4aXN0aW5nLnRhcmdldC50eXBlLCBleGlzdGluZy50YXJnZXQuaWQpLCBsaW5rSWQpO1xyXG4gIH1cclxuICBhd2FpdCBrdkRlbChrZXkpO1xyXG59XHJcblxyXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gZ2V0QWxsTGlua3MoKTogUHJvbWlzZTxMaW5rW10+IHtcclxuICBjb25zdCBrZXlzID0gYXdhaXQga3ZTY2FuKCdsaW5rczpsaW5rOicpO1xyXG4gIGlmICgha2V5cy5sZW5ndGgpIHJldHVybiBbXTtcclxuICBjb25zdCBsaW5rcyA9IGF3YWl0IFByb21pc2UuYWxsKGtleXMubWFwKChrOiBzdHJpbmcpID0+IGt2R2V0PExpbms+KGspKSk7XHJcbiAgcmV0dXJuIGxpbmtzLmZpbHRlcihCb29sZWFuKSBhcyBMaW5rW107XHJcbn1cclxuXHJcblxyXG4iXSwibmFtZXMiOlsia3ZHZXQiLCJrdlNldCIsImt2RGVsIiwia3ZTQWRkIiwia3ZTUmVtIiwia3ZTTWVtYmVycyIsImt2U2NhbiIsImJ1aWxkTGlua0tleSIsImJ1aWxkTGlua3NJbmRleEtleSIsInZhbGlkYXRlTGluayIsImNyZWF0ZUxpbmsiLCJsaW5rIiwidmFsaWRhdGlvbiIsImxpbmtUeXBlIiwic291cmNlIiwidGFyZ2V0IiwibWV0YWRhdGEiLCJpc1ZhbGlkIiwiY29uc29sZSIsIndhcm4iLCJyZWFzb24iLCJ3YXJuaW5ncyIsImxlbmd0aCIsImlkIiwidHlwZSIsImdldExpbmtzRm9yIiwiZW50aXR5IiwiaWRzIiwia2V5cyIsIm1hcCIsInJvd3MiLCJQcm9taXNlIiwiYWxsIiwiayIsImZpbHRlciIsIkJvb2xlYW4iLCJyZW1vdmVMaW5rIiwibGlua0lkIiwia2V5IiwiZXhpc3RpbmciLCJnZXRBbGxMaW5rcyIsImxpbmtzIl0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(rsc)/./links/link-registry.ts\n");

/***/ }),

/***/ "(rsc)/./links/link-validation.ts":
/*!**********************************!*\
  !*** ./links/link-validation.ts ***!
  \**********************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   validateBusinessRules: () => (/* binding */ validateBusinessRules),\n/* harmony export */   validateEntityExists: () => (/* binding */ validateEntityExists),\n/* harmony export */   validateLink: () => (/* binding */ validateLink),\n/* harmony export */   validateLinkTypeCompatibility: () => (/* binding */ validateLinkTypeCompatibility)\n/* harmony export */ });\n/* harmony import */ var _types_enums__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @/types/enums */ \"(rsc)/./types/enums.ts\");\n/* harmony import */ var _data_store_datastore__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @/data-store/datastore */ \"(rsc)/./data-store/datastore.ts\");\n// links/link-validation.ts\n// Link Validation System for The Rosetta Stone\n// Migrated from lib/game-mechanics/workflow-integration.ts\n\n\n/**\r\n * Main link validation orchestrator\r\n * Validates link type compatibility, entity existence, and business rules\r\n */ async function validateLink(linkType, source, target, metadata) {\n    const warnings = [];\n    try {\n        // 1. Basic validation\n        if (!linkType || !source?.type || !source?.id || !target?.type || !target?.id) {\n            return {\n                isValid: false,\n                reason: \"Missing required fields: linkType, source.type, source.id, target.type, target.id\"\n            };\n        }\n        // 2. Self-reference validation\n        if (source.type === target.type && source.id === target.id) {\n            return {\n                isValid: false,\n                reason: \"Self-referencing links are not allowed\"\n            };\n        }\n        // 3. Link type compatibility validation\n        const compatibilityResult = validateLinkTypeCompatibility(linkType, source.type, target.type);\n        if (!compatibilityResult.isValid) {\n            return {\n                isValid: false,\n                reason: `Incompatible link type: ${linkType} cannot connect ${source.type} to ${target.type}. ${compatibilityResult.reason}`\n            };\n        }\n        // 4. Entity existence validation\n        const sourceExists = await validateEntityExists(source.type, source.id);\n        if (!sourceExists) {\n            return {\n                isValid: false,\n                reason: `Source entity does not exist: ${source.type}:${source.id}`\n            };\n        }\n        const targetExists = await validateEntityExists(target.type, target.id);\n        if (!targetExists) {\n            return {\n                isValid: false,\n                reason: `Target entity does not exist: ${target.type}:${target.id}`\n            };\n        }\n        // 5. Business rules validation\n        const businessRulesResult = await validateBusinessRules(linkType, source, target, metadata);\n        if (!businessRulesResult.isValid) {\n            return {\n                isValid: false,\n                reason: businessRulesResult.reason\n            };\n        }\n        // Add any warnings from business rules\n        if (businessRulesResult.warnings) {\n            warnings.push(...businessRulesResult.warnings);\n        }\n        return {\n            isValid: true,\n            warnings: warnings.length > 0 ? warnings : undefined\n        };\n    } catch (error) {\n        return {\n            isValid: false,\n            reason: `Validation error: ${error instanceof Error ? error.message : \"Unknown error\"}`\n        };\n    }\n}\n/**\r\n * Validate link type compatibility with source and target entity types\r\n * Complete mapping of all 39 link types\r\n */ function validateLinkTypeCompatibility(linkType, sourceType, targetType) {\n    // Define valid link type combinations for all 39 link types\n    const validCombinations = {\n        // TASK relationships (6)\n        \"TASK_ITEM\": {\n            source: [\n                _types_enums__WEBPACK_IMPORTED_MODULE_0__.EntityType.TASK\n            ],\n            target: [\n                _types_enums__WEBPACK_IMPORTED_MODULE_0__.EntityType.ITEM\n            ]\n        },\n        \"TASK_FINREC\": {\n            source: [\n                _types_enums__WEBPACK_IMPORTED_MODULE_0__.EntityType.TASK\n            ],\n            target: [\n                _types_enums__WEBPACK_IMPORTED_MODULE_0__.EntityType.FINANCIAL\n            ]\n        },\n        \"TASK_SALE\": {\n            source: [\n                _types_enums__WEBPACK_IMPORTED_MODULE_0__.EntityType.TASK\n            ],\n            target: [\n                _types_enums__WEBPACK_IMPORTED_MODULE_0__.EntityType.SALE\n            ]\n        },\n        \"TASK_PLAYER\": {\n            source: [\n                _types_enums__WEBPACK_IMPORTED_MODULE_0__.EntityType.TASK\n            ],\n            target: [\n                _types_enums__WEBPACK_IMPORTED_MODULE_0__.EntityType.PLAYER\n            ]\n        },\n        \"TASK_CHARACTER\": {\n            source: [\n                _types_enums__WEBPACK_IMPORTED_MODULE_0__.EntityType.TASK\n            ],\n            target: [\n                _types_enums__WEBPACK_IMPORTED_MODULE_0__.EntityType.CHARACTER\n            ]\n        },\n        \"TASK_SITE\": {\n            source: [\n                _types_enums__WEBPACK_IMPORTED_MODULE_0__.EntityType.TASK\n            ],\n            target: [\n                _types_enums__WEBPACK_IMPORTED_MODULE_0__.EntityType.SITE\n            ]\n        },\n        // ITEM relationships (6)\n        \"ITEM_TASK\": {\n            source: [\n                _types_enums__WEBPACK_IMPORTED_MODULE_0__.EntityType.ITEM\n            ],\n            target: [\n                _types_enums__WEBPACK_IMPORTED_MODULE_0__.EntityType.TASK\n            ]\n        },\n        \"ITEM_SALE\": {\n            source: [\n                _types_enums__WEBPACK_IMPORTED_MODULE_0__.EntityType.ITEM\n            ],\n            target: [\n                _types_enums__WEBPACK_IMPORTED_MODULE_0__.EntityType.SALE\n            ]\n        },\n        \"ITEM_FINREC\": {\n            source: [\n                _types_enums__WEBPACK_IMPORTED_MODULE_0__.EntityType.ITEM\n            ],\n            target: [\n                _types_enums__WEBPACK_IMPORTED_MODULE_0__.EntityType.FINANCIAL\n            ]\n        },\n        \"ITEM_PLAYER\": {\n            source: [\n                _types_enums__WEBPACK_IMPORTED_MODULE_0__.EntityType.ITEM\n            ],\n            target: [\n                _types_enums__WEBPACK_IMPORTED_MODULE_0__.EntityType.PLAYER\n            ]\n        },\n        \"ITEM_CHARACTER\": {\n            source: [\n                _types_enums__WEBPACK_IMPORTED_MODULE_0__.EntityType.ITEM\n            ],\n            target: [\n                _types_enums__WEBPACK_IMPORTED_MODULE_0__.EntityType.CHARACTER\n            ]\n        },\n        \"ITEM_SITE\": {\n            source: [\n                _types_enums__WEBPACK_IMPORTED_MODULE_0__.EntityType.ITEM\n            ],\n            target: [\n                _types_enums__WEBPACK_IMPORTED_MODULE_0__.EntityType.SITE\n            ]\n        },\n        // SALE relationships (6)\n        \"SALE_TASK\": {\n            source: [\n                _types_enums__WEBPACK_IMPORTED_MODULE_0__.EntityType.SALE\n            ],\n            target: [\n                _types_enums__WEBPACK_IMPORTED_MODULE_0__.EntityType.TASK\n            ]\n        },\n        \"SALE_ITEM\": {\n            source: [\n                _types_enums__WEBPACK_IMPORTED_MODULE_0__.EntityType.SALE\n            ],\n            target: [\n                _types_enums__WEBPACK_IMPORTED_MODULE_0__.EntityType.ITEM\n            ]\n        },\n        \"SALE_FINREC\": {\n            source: [\n                _types_enums__WEBPACK_IMPORTED_MODULE_0__.EntityType.SALE\n            ],\n            target: [\n                _types_enums__WEBPACK_IMPORTED_MODULE_0__.EntityType.FINANCIAL\n            ]\n        },\n        \"SALE_PLAYER\": {\n            source: [\n                _types_enums__WEBPACK_IMPORTED_MODULE_0__.EntityType.SALE\n            ],\n            target: [\n                _types_enums__WEBPACK_IMPORTED_MODULE_0__.EntityType.PLAYER\n            ]\n        },\n        \"SALE_CHARACTER\": {\n            source: [\n                _types_enums__WEBPACK_IMPORTED_MODULE_0__.EntityType.SALE\n            ],\n            target: [\n                _types_enums__WEBPACK_IMPORTED_MODULE_0__.EntityType.CHARACTER\n            ]\n        },\n        \"SALE_SITE\": {\n            source: [\n                _types_enums__WEBPACK_IMPORTED_MODULE_0__.EntityType.SALE\n            ],\n            target: [\n                _types_enums__WEBPACK_IMPORTED_MODULE_0__.EntityType.SITE\n            ]\n        },\n        // FINANCIAL RECORD relationships (6)\n        \"FINREC_TASK\": {\n            source: [\n                _types_enums__WEBPACK_IMPORTED_MODULE_0__.EntityType.FINANCIAL\n            ],\n            target: [\n                _types_enums__WEBPACK_IMPORTED_MODULE_0__.EntityType.TASK\n            ]\n        },\n        \"FINREC_ITEM\": {\n            source: [\n                _types_enums__WEBPACK_IMPORTED_MODULE_0__.EntityType.FINANCIAL\n            ],\n            target: [\n                _types_enums__WEBPACK_IMPORTED_MODULE_0__.EntityType.ITEM\n            ]\n        },\n        \"FINREC_SALE\": {\n            source: [\n                _types_enums__WEBPACK_IMPORTED_MODULE_0__.EntityType.FINANCIAL\n            ],\n            target: [\n                _types_enums__WEBPACK_IMPORTED_MODULE_0__.EntityType.SALE\n            ]\n        },\n        \"FINREC_PLAYER\": {\n            source: [\n                _types_enums__WEBPACK_IMPORTED_MODULE_0__.EntityType.FINANCIAL\n            ],\n            target: [\n                _types_enums__WEBPACK_IMPORTED_MODULE_0__.EntityType.PLAYER\n            ]\n        },\n        \"FINREC_CHARACTER\": {\n            source: [\n                _types_enums__WEBPACK_IMPORTED_MODULE_0__.EntityType.FINANCIAL\n            ],\n            target: [\n                _types_enums__WEBPACK_IMPORTED_MODULE_0__.EntityType.CHARACTER\n            ]\n        },\n        \"FINREC_SITE\": {\n            source: [\n                _types_enums__WEBPACK_IMPORTED_MODULE_0__.EntityType.FINANCIAL\n            ],\n            target: [\n                _types_enums__WEBPACK_IMPORTED_MODULE_0__.EntityType.SITE\n            ]\n        },\n        // CHARACTER relationships (6)\n        \"CHARACTER_TASK\": {\n            source: [\n                _types_enums__WEBPACK_IMPORTED_MODULE_0__.EntityType.CHARACTER\n            ],\n            target: [\n                _types_enums__WEBPACK_IMPORTED_MODULE_0__.EntityType.TASK\n            ]\n        },\n        \"CHARACTER_ITEM\": {\n            source: [\n                _types_enums__WEBPACK_IMPORTED_MODULE_0__.EntityType.CHARACTER\n            ],\n            target: [\n                _types_enums__WEBPACK_IMPORTED_MODULE_0__.EntityType.ITEM\n            ]\n        },\n        \"CHARACTER_SALE\": {\n            source: [\n                _types_enums__WEBPACK_IMPORTED_MODULE_0__.EntityType.CHARACTER\n            ],\n            target: [\n                _types_enums__WEBPACK_IMPORTED_MODULE_0__.EntityType.SALE\n            ]\n        },\n        \"CHARACTER_FINREC\": {\n            source: [\n                _types_enums__WEBPACK_IMPORTED_MODULE_0__.EntityType.CHARACTER\n            ],\n            target: [\n                _types_enums__WEBPACK_IMPORTED_MODULE_0__.EntityType.FINANCIAL\n            ]\n        },\n        \"CHARACTER_SITE\": {\n            source: [\n                _types_enums__WEBPACK_IMPORTED_MODULE_0__.EntityType.CHARACTER\n            ],\n            target: [\n                _types_enums__WEBPACK_IMPORTED_MODULE_0__.EntityType.SITE\n            ]\n        },\n        \"CHARACTER_PLAYER\": {\n            source: [\n                _types_enums__WEBPACK_IMPORTED_MODULE_0__.EntityType.CHARACTER\n            ],\n            target: [\n                _types_enums__WEBPACK_IMPORTED_MODULE_0__.EntityType.PLAYER\n            ]\n        },\n        // SITE relationships (6)\n        \"SITE_TASK\": {\n            source: [\n                _types_enums__WEBPACK_IMPORTED_MODULE_0__.EntityType.SITE\n            ],\n            target: [\n                _types_enums__WEBPACK_IMPORTED_MODULE_0__.EntityType.TASK\n            ]\n        },\n        \"SITE_CHARACTER\": {\n            source: [\n                _types_enums__WEBPACK_IMPORTED_MODULE_0__.EntityType.SITE\n            ],\n            target: [\n                _types_enums__WEBPACK_IMPORTED_MODULE_0__.EntityType.CHARACTER\n            ]\n        },\n        \"SITE_FINREC\": {\n            source: [\n                _types_enums__WEBPACK_IMPORTED_MODULE_0__.EntityType.SITE\n            ],\n            target: [\n                _types_enums__WEBPACK_IMPORTED_MODULE_0__.EntityType.FINANCIAL\n            ]\n        },\n        \"SITE_ITEM\": {\n            source: [\n                _types_enums__WEBPACK_IMPORTED_MODULE_0__.EntityType.SITE\n            ],\n            target: [\n                _types_enums__WEBPACK_IMPORTED_MODULE_0__.EntityType.ITEM\n            ]\n        },\n        \"SITE_SALE\": {\n            source: [\n                _types_enums__WEBPACK_IMPORTED_MODULE_0__.EntityType.SITE\n            ],\n            target: [\n                _types_enums__WEBPACK_IMPORTED_MODULE_0__.EntityType.SALE\n            ]\n        },\n        \"SITE_SITE\": {\n            source: [\n                _types_enums__WEBPACK_IMPORTED_MODULE_0__.EntityType.SITE\n            ],\n            target: [\n                _types_enums__WEBPACK_IMPORTED_MODULE_0__.EntityType.SITE\n            ]\n        },\n        // PLAYER relationships (5)\n        \"PLAYER_TASK\": {\n            source: [\n                _types_enums__WEBPACK_IMPORTED_MODULE_0__.EntityType.PLAYER\n            ],\n            target: [\n                _types_enums__WEBPACK_IMPORTED_MODULE_0__.EntityType.TASK\n            ]\n        },\n        \"PLAYER_SALE\": {\n            source: [\n                _types_enums__WEBPACK_IMPORTED_MODULE_0__.EntityType.PLAYER\n            ],\n            target: [\n                _types_enums__WEBPACK_IMPORTED_MODULE_0__.EntityType.SALE\n            ]\n        },\n        \"PLAYER_FINREC\": {\n            source: [\n                _types_enums__WEBPACK_IMPORTED_MODULE_0__.EntityType.PLAYER\n            ],\n            target: [\n                _types_enums__WEBPACK_IMPORTED_MODULE_0__.EntityType.FINANCIAL\n            ]\n        },\n        \"PLAYER_ITEM\": {\n            source: [\n                _types_enums__WEBPACK_IMPORTED_MODULE_0__.EntityType.PLAYER\n            ],\n            target: [\n                _types_enums__WEBPACK_IMPORTED_MODULE_0__.EntityType.ITEM\n            ]\n        },\n        \"PLAYER_CHARACTER\": {\n            source: [\n                _types_enums__WEBPACK_IMPORTED_MODULE_0__.EntityType.PLAYER\n            ],\n            target: [\n                _types_enums__WEBPACK_IMPORTED_MODULE_0__.EntityType.CHARACTER\n            ]\n        },\n        // ACCOUNT relationships (4)\n        \"ACCOUNT_PLAYER\": {\n            source: [\n                _types_enums__WEBPACK_IMPORTED_MODULE_0__.EntityType.ACCOUNT\n            ],\n            target: [\n                _types_enums__WEBPACK_IMPORTED_MODULE_0__.EntityType.PLAYER\n            ]\n        },\n        \"ACCOUNT_CHARACTER\": {\n            source: [\n                _types_enums__WEBPACK_IMPORTED_MODULE_0__.EntityType.ACCOUNT\n            ],\n            target: [\n                _types_enums__WEBPACK_IMPORTED_MODULE_0__.EntityType.CHARACTER\n            ]\n        },\n        \"PLAYER_ACCOUNT\": {\n            source: [\n                _types_enums__WEBPACK_IMPORTED_MODULE_0__.EntityType.PLAYER\n            ],\n            target: [\n                _types_enums__WEBPACK_IMPORTED_MODULE_0__.EntityType.ACCOUNT\n            ]\n        },\n        \"CHARACTER_ACCOUNT\": {\n            source: [\n                _types_enums__WEBPACK_IMPORTED_MODULE_0__.EntityType.CHARACTER\n            ],\n            target: [\n                _types_enums__WEBPACK_IMPORTED_MODULE_0__.EntityType.ACCOUNT\n            ]\n        }\n    };\n    const combination = validCombinations[linkType];\n    if (!combination) {\n        return {\n            isValid: false,\n            reason: `Unknown link type: ${linkType}`\n        };\n    }\n    if (!combination.source.includes(sourceType)) {\n        return {\n            isValid: false,\n            reason: `Invalid source type for ${linkType}: ${sourceType}. Valid sources: ${combination.source.join(\", \")}`\n        };\n    }\n    if (!combination.target.includes(targetType)) {\n        return {\n            isValid: false,\n            reason: `Invalid target type for ${linkType}: ${targetType}. Valid targets: ${combination.target.join(\", \")}`\n        };\n    }\n    return {\n        isValid: true\n    };\n}\n/**\r\n * Validate that entity exists in the system\r\n */ async function validateEntityExists(entityType, entityId) {\n    try {\n        switch(entityType){\n            case _types_enums__WEBPACK_IMPORTED_MODULE_0__.EntityType.TASK:\n                const tasks = await (0,_data_store_datastore__WEBPACK_IMPORTED_MODULE_1__.getAllTasks)();\n                const task = tasks.find((t)=>t.id === entityId);\n                return !!task;\n            case _types_enums__WEBPACK_IMPORTED_MODULE_0__.EntityType.ITEM:\n                const items = await (0,_data_store_datastore__WEBPACK_IMPORTED_MODULE_1__.getAllItems)();\n                const item = items.find((i)=>i.id === entityId);\n                return !!item;\n            case _types_enums__WEBPACK_IMPORTED_MODULE_0__.EntityType.FINANCIAL:\n                const financialRecords = await (0,_data_store_datastore__WEBPACK_IMPORTED_MODULE_1__.getAllFinancials)();\n                const financial = financialRecords.find((f)=>f.id === entityId);\n                return !!financial;\n            case _types_enums__WEBPACK_IMPORTED_MODULE_0__.EntityType.SALE:\n                const sales = await (0,_data_store_datastore__WEBPACK_IMPORTED_MODULE_1__.getAllSales)();\n                const sale = sales.find((s)=>s.id === entityId);\n                return !!sale;\n            case _types_enums__WEBPACK_IMPORTED_MODULE_0__.EntityType.CHARACTER:\n                const characters = await (0,_data_store_datastore__WEBPACK_IMPORTED_MODULE_1__.getAllCharacters)();\n                const character = characters.find((c)=>c.id === entityId);\n                return !!character;\n            case _types_enums__WEBPACK_IMPORTED_MODULE_0__.EntityType.PLAYER:\n                const players = await (0,_data_store_datastore__WEBPACK_IMPORTED_MODULE_1__.getAllPlayers)();\n                const player = players.find((p)=>p.id === entityId);\n                return !!player;\n            case _types_enums__WEBPACK_IMPORTED_MODULE_0__.EntityType.SITE:\n                const sites = await (0,_data_store_datastore__WEBPACK_IMPORTED_MODULE_1__.getAllSites)();\n                const site = sites.find((s)=>s.id === entityId);\n                return !!site;\n            case _types_enums__WEBPACK_IMPORTED_MODULE_0__.EntityType.ACCOUNT:\n                // Account entity not implemented in current datastore\n                return false;\n            default:\n                console.warn(`[validateEntityExists] Unknown entity type: ${entityType}`);\n                return false;\n        }\n    } catch (error) {\n        console.error(`[validateEntityExists] Error validating entity ${entityType}:${entityId}:`, error);\n        return false;\n    }\n}\n/**\r\n * Validate business rules specific to link types\r\n */ async function validateBusinessRules(linkType, source, target, metadata) {\n    const warnings = [];\n    try {\n        switch(linkType){\n            case \"PLAYER_CHARACTER\":\n                // Validate that character has valid playerId\n                const characters = await (0,_data_store_datastore__WEBPACK_IMPORTED_MODULE_1__.getAllCharacters)();\n                const character = characters.find((c)=>c.id === source.id);\n                if (character && character.playerId !== target.id) {\n                    warnings.push(`Character playerId (${character.playerId}) does not match target player ID (${target.id})`);\n                }\n                break;\n            case \"TASK_SITE\":\n                // Validate that task has valid siteId\n                const tasks = await (0,_data_store_datastore__WEBPACK_IMPORTED_MODULE_1__.getAllTasks)();\n                const task = tasks.find((t)=>t.id === source.id);\n                if (task && task.siteId !== target.id) {\n                    warnings.push(`Task siteId (${task.siteId}) does not match target site ID (${target.id})`);\n                }\n                break;\n            case \"ITEM_SITE\":\n                // Validate item stock location\n                const items = await (0,_data_store_datastore__WEBPACK_IMPORTED_MODULE_1__.getAllItems)();\n                const item = items.find((i)=>i.id === source.id);\n                if (item && item.stock) {\n                    const hasStockAtSite = item.stock.some((stock)=>stock.siteId === target.id);\n                    if (!hasStockAtSite) {\n                        warnings.push(`Item does not have stock at target site: ${target.id}`);\n                    }\n                }\n                break;\n            case \"SALE_ITEM\":\n                // Validate sale contains the item\n                const sales = await (0,_data_store_datastore__WEBPACK_IMPORTED_MODULE_1__.getAllSales)();\n                const sale = sales.find((s)=>s.id === source.id);\n                if (sale && sale.lines) {\n                    const hasItemInSale = sale.lines.some((line)=>line.kind === \"item\" && line.itemId === target.id);\n                    if (!hasItemInSale) {\n                        warnings.push(`Sale does not contain target item: ${target.id}`);\n                    }\n                }\n                break;\n            case \"CHARACTER_PLAYER\":\n                // Validate that character belongs to the player\n                const charForPlayer = await (0,_data_store_datastore__WEBPACK_IMPORTED_MODULE_1__.getAllCharacters)();\n                const char = charForPlayer.find((c)=>c.id === source.id);\n                if (char && char.playerId !== target.id) {\n                    warnings.push(`Character playerId (${char.playerId}) does not match target player ID (${target.id})`);\n                }\n                break;\n            case \"SALE_CHARACTER\":\n                // Validate that character is the customer\n                const saleForChar = await (0,_data_store_datastore__WEBPACK_IMPORTED_MODULE_1__.getAllSales)();\n                const saleWithChar = saleForChar.find((s)=>s.id === source.id);\n                if (saleWithChar && saleWithChar.customerId !== target.id) {\n                    warnings.push(`Sale customerId (${saleWithChar.customerId}) does not match target character ID (${target.id})`);\n                }\n                break;\n            // Add more business rule validations as needed\n            default:\n                break;\n        }\n        return {\n            isValid: true,\n            warnings: warnings.length > 0 ? warnings : undefined\n        };\n    } catch (error) {\n        return {\n            isValid: false,\n            reason: `Business rules validation error: ${error instanceof Error ? error.message : \"Unknown error\"}`\n        };\n    }\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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RUYsS0FBSztnQkFDSCxnREFBZ0Q7Z0JBQ2hELE1BQU1pRSxnQkFBZ0IsTUFBTTNFLHVFQUFnQkE7Z0JBQzVDLE1BQU00RSxPQUFPRCxjQUFjL0IsSUFBSSxDQUFDYSxDQUFBQSxJQUFLQSxFQUFFL0MsRUFBRSxLQUFLTCxPQUFPSyxFQUFFO2dCQUN2RCxJQUFJa0UsUUFBUUEsS0FBS1gsUUFBUSxLQUFLM0QsT0FBT0ksRUFBRSxFQUFFO29CQUN2Q0YsU0FBU1ksSUFBSSxDQUFDLENBQUMsb0JBQW9CLEVBQUV3RCxLQUFLWCxRQUFRLENBQUMsbUNBQW1DLEVBQUUzRCxPQUFPSSxFQUFFLENBQUMsQ0FBQyxDQUFDO2dCQUN0RztnQkFDQTtZQUVGLEtBQUs7Z0JBQ0gsMENBQTBDO2dCQUMxQyxNQUFNbUUsY0FBYyxNQUFNOUUsa0VBQVdBO2dCQUNyQyxNQUFNK0UsZUFBZUQsWUFBWWpDLElBQUksQ0FBQ1UsQ0FBQUEsSUFBS0EsRUFBRTVDLEVBQUUsS0FBS0wsT0FBT0ssRUFBRTtnQkFDN0QsSUFBSW9FLGdCQUFnQkEsYUFBYUMsVUFBVSxLQUFLekUsT0FBT0ksRUFBRSxFQUFFO29CQUN6REYsU0FBU1ksSUFBSSxDQUFDLENBQUMsaUJBQWlCLEVBQUUwRCxhQUFhQyxVQUFVLENBQUMsc0NBQXNDLEVBQUV6RSxPQUFPSSxFQUFFLENBQUMsQ0FBQyxDQUFDO2dCQUNoSDtnQkFDQTtZQUVGLCtDQUErQztZQUMvQztnQkFFRTtRQUNKO1FBRUEsT0FBTztZQUNMQyxTQUFTO1lBQ1RILFVBQVVBLFNBQVNhLE1BQU0sR0FBRyxJQUFJYixXQUFXYztRQUM3QztJQUVGLEVBQUUsT0FBT0MsT0FBTztRQUNkLE9BQU87WUFDTFosU0FBUztZQUNUQyxRQUFRLENBQUMsaUNBQWlDLEVBQUVXLGlCQUFpQkMsUUFBUUQsTUFBTUUsT0FBTyxHQUFHLGdCQUFnQixDQUFDO1FBQ3hHO0lBQ0Y7QUFDRiIsInNvdXJjZXMiOlsid2VicGFjazovL3RoZWdhbWUtYWRtaW4vLi9saW5rcy9saW5rLXZhbGlkYXRpb24udHM/ZTNhYSJdLCJzb3VyY2VzQ29udGVudCI6WyIvLyBsaW5rcy9saW5rLXZhbGlkYXRpb24udHNcclxuLy8gTGluayBWYWxpZGF0aW9uIFN5c3RlbSBmb3IgVGhlIFJvc2V0dGEgU3RvbmVcclxuLy8gTWlncmF0ZWQgZnJvbSBsaWIvZ2FtZS1tZWNoYW5pY3Mvd29ya2Zsb3ctaW50ZWdyYXRpb24udHNcclxuXHJcbmltcG9ydCB7IExpbmtUeXBlLCBFbnRpdHlUeXBlIH0gZnJvbSAnQC90eXBlcy9lbnVtcyc7XHJcbmltcG9ydCB7IFxyXG4gIGdldEFsbFRhc2tzLFxyXG4gIGdldEFsbEl0ZW1zLFxyXG4gIGdldEFsbEZpbmFuY2lhbHMsXHJcbiAgZ2V0QWxsU2FsZXMsXHJcbiAgZ2V0QWxsQ2hhcmFjdGVycyxcclxuICBnZXRBbGxQbGF5ZXJzLFxyXG4gIGdldEFsbFNpdGVzXHJcbn0gZnJvbSAnQC9kYXRhLXN0b3JlL2RhdGFzdG9yZSc7XHJcblxyXG4vKipcclxuICogTGluayB2YWxpZGF0aW9uIHJlc3VsdCBpbnRlcmZhY2VcclxuICovXHJcbmV4cG9ydCBpbnRlcmZhY2UgTGlua1ZhbGlkYXRpb25SZXN1bHQge1xyXG4gIGlzVmFsaWQ6IGJvb2xlYW47XHJcbiAgcmVhc29uPzogc3RyaW5nO1xyXG4gIHdhcm5pbmdzPzogc3RyaW5nW107XHJcbn1cclxuXHJcbi8qKlxyXG4gKiBNYWluIGxpbmsgdmFsaWRhdGlvbiBvcmNoZXN0cmF0b3JcclxuICogVmFsaWRhdGVzIGxpbmsgdHlwZSBjb21wYXRpYmlsaXR5LCBlbnRpdHkgZXhpc3RlbmNlLCBhbmQgYnVzaW5lc3MgcnVsZXNcclxuICovXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiB2YWxpZGF0ZUxpbmsoXHJcbiAgbGlua1R5cGU6IExpbmtUeXBlLFxyXG4gIHNvdXJjZTogeyB0eXBlOiBFbnRpdHlUeXBlOyBpZDogc3RyaW5nIH0sXHJcbiAgdGFyZ2V0OiB7IHR5cGU6IEVudGl0eVR5cGU7IGlkOiBzdHJpbmcgfSxcclxuICBtZXRhZGF0YT86IFJlY29yZDxzdHJpbmcsIGFueT5cclxuKTogUHJvbWlzZTxMaW5rVmFsaWRhdGlvblJlc3VsdD4ge1xyXG4gIGNvbnN0IHdhcm5pbmdzOiBzdHJpbmdbXSA9IFtdO1xyXG4gIFxyXG4gIHRyeSB7XHJcbiAgICAvLyAxLiBCYXNpYyB2YWxpZGF0aW9uXHJcbiAgICBpZiAoIWxpbmtUeXBlIHx8ICFzb3VyY2U/LnR5cGUgfHwgIXNvdXJjZT8uaWQgfHwgIXRhcmdldD8udHlwZSB8fCAhdGFyZ2V0Py5pZCkge1xyXG4gICAgICByZXR1cm4ge1xyXG4gICAgICAgIGlzVmFsaWQ6IGZhbHNlLFxyXG4gICAgICAgIHJlYXNvbjogJ01pc3NpbmcgcmVxdWlyZWQgZmllbGRzOiBsaW5rVHlwZSwgc291cmNlLnR5cGUsIHNvdXJjZS5pZCwgdGFyZ2V0LnR5cGUsIHRhcmdldC5pZCdcclxuICAgICAgfTtcclxuICAgIH1cclxuXHJcbiAgICAvLyAyLiBTZWxmLXJlZmVyZW5jZSB2YWxpZGF0aW9uXHJcbiAgICBpZiAoc291cmNlLnR5cGUgPT09IHRhcmdldC50eXBlICYmIHNvdXJjZS5pZCA9PT0gdGFyZ2V0LmlkKSB7XHJcbiAgICAgIHJldHVybiB7XHJcbiAgICAgICAgaXNWYWxpZDogZmFsc2UsXHJcbiAgICAgICAgcmVhc29uOiAnU2VsZi1yZWZlcmVuY2luZyBsaW5rcyBhcmUgbm90IGFsbG93ZWQnXHJcbiAgICAgIH07XHJcbiAgICB9XHJcblxyXG4gICAgLy8gMy4gTGluayB0eXBlIGNvbXBhdGliaWxpdHkgdmFsaWRhdGlvblxyXG4gICAgY29uc3QgY29tcGF0aWJpbGl0eVJlc3VsdCA9IHZhbGlkYXRlTGlua1R5cGVDb21wYXRpYmlsaXR5KGxpbmtUeXBlLCBzb3VyY2UudHlwZSwgdGFyZ2V0LnR5cGUpO1xyXG4gICAgaWYgKCFjb21wYXRpYmlsaXR5UmVzdWx0LmlzVmFsaWQpIHtcclxuICAgICAgcmV0dXJuIHtcclxuICAgICAgICBpc1ZhbGlkOiBmYWxzZSxcclxuICAgICAgICByZWFzb246IGBJbmNvbXBhdGlibGUgbGluayB0eXBlOiAke2xpbmtUeXBlfSBjYW5ub3QgY29ubmVjdCAke3NvdXJjZS50eXBlfSB0byAke3RhcmdldC50eXBlfS4gJHtjb21wYXRpYmlsaXR5UmVzdWx0LnJlYXNvbn1gXHJcbiAgICAgIH07XHJcbiAgICB9XHJcblxyXG4gICAgLy8gNC4gRW50aXR5IGV4aXN0ZW5jZSB2YWxpZGF0aW9uXHJcbiAgICBjb25zdCBzb3VyY2VFeGlzdHMgPSBhd2FpdCB2YWxpZGF0ZUVudGl0eUV4aXN0cyhzb3VyY2UudHlwZSwgc291cmNlLmlkKTtcclxuICAgIGlmICghc291cmNlRXhpc3RzKSB7XHJcbiAgICAgIHJldHVybiB7XHJcbiAgICAgICAgaXNWYWxpZDogZmFsc2UsXHJcbiAgICAgICAgcmVhc29uOiBgU291cmNlIGVudGl0eSBkb2VzIG5vdCBleGlzdDogJHtzb3VyY2UudHlwZX06JHtzb3VyY2UuaWR9YFxyXG4gICAgICB9O1xyXG4gICAgfVxyXG5cclxuICAgIGNvbnN0IHRhcmdldEV4aXN0cyA9IGF3YWl0IHZhbGlkYXRlRW50aXR5RXhpc3RzKHRhcmdldC50eXBlLCB0YXJnZXQuaWQpO1xyXG4gICAgaWYgKCF0YXJnZXRFeGlzdHMpIHtcclxuICAgICAgcmV0dXJuIHtcclxuICAgICAgICBpc1ZhbGlkOiBmYWxzZSxcclxuICAgICAgICByZWFzb246IGBUYXJnZXQgZW50aXR5IGRvZXMgbm90IGV4aXN0OiAke3RhcmdldC50eXBlfToke3RhcmdldC5pZH1gXHJcbiAgICAgIH07XHJcbiAgICB9XHJcblxyXG4gICAgLy8gNS4gQnVzaW5lc3MgcnVsZXMgdmFsaWRhdGlvblxyXG4gICAgY29uc3QgYnVzaW5lc3NSdWxlc1Jlc3VsdCA9IGF3YWl0IHZhbGlkYXRlQnVzaW5lc3NSdWxlcyhsaW5rVHlwZSwgc291cmNlLCB0YXJnZXQsIG1ldGFkYXRhKTtcclxuICAgIGlmICghYnVzaW5lc3NSdWxlc1Jlc3VsdC5pc1ZhbGlkKSB7XHJcbiAgICAgIHJldHVybiB7XHJcbiAgICAgICAgaXNWYWxpZDogZmFsc2UsXHJcbiAgICAgICAgcmVhc29uOiBidXNpbmVzc1J1bGVzUmVzdWx0LnJlYXNvblxyXG4gICAgICB9O1xyXG4gICAgfVxyXG5cclxuICAgIC8vIEFkZCBhbnkgd2FybmluZ3MgZnJvbSBidXNpbmVzcyBydWxlc1xyXG4gICAgaWYgKGJ1c2luZXNzUnVsZXNSZXN1bHQud2FybmluZ3MpIHtcclxuICAgICAgd2FybmluZ3MucHVzaCguLi5idXNpbmVzc1J1bGVzUmVzdWx0Lndhcm5pbmdzKTtcclxuICAgIH1cclxuXHJcbiAgICByZXR1cm4ge1xyXG4gICAgICBpc1ZhbGlkOiB0cnVlLFxyXG4gICAgICB3YXJuaW5nczogd2FybmluZ3MubGVuZ3RoID4gMCA/IHdhcm5pbmdzIDogdW5kZWZpbmVkXHJcbiAgICB9O1xyXG5cclxuICB9IGNhdGNoIChlcnJvcikge1xyXG4gICAgcmV0dXJuIHtcclxuICAgICAgaXNWYWxpZDogZmFsc2UsXHJcbiAgICAgIHJlYXNvbjogYFZhbGlkYXRpb24gZXJyb3I6ICR7ZXJyb3IgaW5zdGFuY2VvZiBFcnJvciA/IGVycm9yLm1lc3NhZ2UgOiAnVW5rbm93biBlcnJvcid9YFxyXG4gICAgfTtcclxuICB9XHJcbn1cclxuXHJcbi8qKlxyXG4gKiBWYWxpZGF0ZSBsaW5rIHR5cGUgY29tcGF0aWJpbGl0eSB3aXRoIHNvdXJjZSBhbmQgdGFyZ2V0IGVudGl0eSB0eXBlc1xyXG4gKiBDb21wbGV0ZSBtYXBwaW5nIG9mIGFsbCAzOSBsaW5rIHR5cGVzXHJcbiAqL1xyXG5leHBvcnQgZnVuY3Rpb24gdmFsaWRhdGVMaW5rVHlwZUNvbXBhdGliaWxpdHkoXHJcbiAgbGlua1R5cGU6IExpbmtUeXBlLFxyXG4gIHNvdXJjZVR5cGU6IEVudGl0eVR5cGUsXHJcbiAgdGFyZ2V0VHlwZTogRW50aXR5VHlwZVxyXG4pOiBMaW5rVmFsaWRhdGlvblJlc3VsdCB7XHJcbiAgLy8gRGVmaW5lIHZhbGlkIGxpbmsgdHlwZSBjb21iaW5hdGlvbnMgZm9yIGFsbCAzOSBsaW5rIHR5cGVzXHJcbiAgY29uc3QgdmFsaWRDb21iaW5hdGlvbnM6IFJlY29yZDxMaW5rVHlwZSwgeyBzb3VyY2U6IEVudGl0eVR5cGVbXSwgdGFyZ2V0OiBFbnRpdHlUeXBlW10gfT4gPSB7XHJcbiAgICAvLyBUQVNLIHJlbGF0aW9uc2hpcHMgKDYpXHJcbiAgICAnVEFTS19JVEVNJzogeyBzb3VyY2U6IFtFbnRpdHlUeXBlLlRBU0tdLCB0YXJnZXQ6IFtFbnRpdHlUeXBlLklURU1dIH0sXHJcbiAgICAnVEFTS19GSU5SRUMnOiB7IHNvdXJjZTogW0VudGl0eVR5cGUuVEFTS10sIHRhcmdldDogW0VudGl0eVR5cGUuRklOQU5DSUFMXSB9LFxyXG4gICAgJ1RBU0tfU0FMRSc6IHsgc291cmNlOiBbRW50aXR5VHlwZS5UQVNLXSwgdGFyZ2V0OiBbRW50aXR5VHlwZS5TQUxFXSB9LFxyXG4gICAgJ1RBU0tfUExBWUVSJzogeyBzb3VyY2U6IFtFbnRpdHlUeXBlLlRBU0tdLCB0YXJnZXQ6IFtFbnRpdHlUeXBlLlBMQVlFUl0gfSxcclxuICAgICdUQVNLX0NIQVJBQ1RFUic6IHsgc291cmNlOiBbRW50aXR5VHlwZS5UQVNLXSwgdGFyZ2V0OiBbRW50aXR5VHlwZS5DSEFSQUNURVJdIH0sXHJcbiAgICAnVEFTS19TSVRFJzogeyBzb3VyY2U6IFtFbnRpdHlUeXBlLlRBU0tdLCB0YXJnZXQ6IFtFbnRpdHlUeXBlLlNJVEVdIH0sXHJcbiAgICBcclxuICAgIC8vIElURU0gcmVsYXRpb25zaGlwcyAoNilcclxuICAgICdJVEVNX1RBU0snOiB7IHNvdXJjZTogW0VudGl0eVR5cGUuSVRFTV0sIHRhcmdldDogW0VudGl0eVR5cGUuVEFTS10gfSxcclxuICAgICdJVEVNX1NBTEUnOiB7IHNvdXJjZTogW0VudGl0eVR5cGUuSVRFTV0sIHRhcmdldDogW0VudGl0eVR5cGUuU0FMRV0gfSxcclxuICAgICdJVEVNX0ZJTlJFQyc6IHsgc291cmNlOiBbRW50aXR5VHlwZS5JVEVNXSwgdGFyZ2V0OiBbRW50aXR5VHlwZS5GSU5BTkNJQUxdIH0sXHJcbiAgICAnSVRFTV9QTEFZRVInOiB7IHNvdXJjZTogW0VudGl0eVR5cGUuSVRFTV0sIHRhcmdldDogW0VudGl0eVR5cGUuUExBWUVSXSB9LFxyXG4gICAgJ0lURU1fQ0hBUkFDVEVSJzogeyBzb3VyY2U6IFtFbnRpdHlUeXBlLklURU1dLCB0YXJnZXQ6IFtFbnRpdHlUeXBlLkNIQVJBQ1RFUl0gfSxcclxuICAgICdJVEVNX1NJVEUnOiB7IHNvdXJjZTogW0VudGl0eVR5cGUuSVRFTV0sIHRhcmdldDogW0VudGl0eVR5cGUuU0lURV0gfSxcclxuXHJcbiAgICAvLyBTQUxFIHJlbGF0aW9uc2hpcHMgKDYpXHJcbiAgICAnU0FMRV9UQVNLJzogeyBzb3VyY2U6IFtFbnRpdHlUeXBlLlNBTEVdLCB0YXJnZXQ6IFtFbnRpdHlUeXBlLlRBU0tdIH0sXHJcbiAgICAnU0FMRV9JVEVNJzogeyBzb3VyY2U6IFtFbnRpdHlUeXBlLlNBTEVdLCB0YXJnZXQ6IFtFbnRpdHlUeXBlLklURU1dIH0sXHJcbiAgICAnU0FMRV9GSU5SRUMnOiB7IHNvdXJjZTogW0VudGl0eVR5cGUuU0FMRV0sIHRhcmdldDogW0VudGl0eVR5cGUuRklOQU5DSUFMXSB9LFxyXG4gICAgJ1NBTEVfUExBWUVSJzogeyBzb3VyY2U6IFtFbnRpdHlUeXBlLlNBTEVdLCB0YXJnZXQ6IFtFbnRpdHlUeXBlLlBMQVlFUl0gfSxcclxuICAgICdTQUxFX0NIQVJBQ1RFUic6IHsgc291cmNlOiBbRW50aXR5VHlwZS5TQUxFXSwgdGFyZ2V0OiBbRW50aXR5VHlwZS5DSEFSQUNURVJdIH0sXHJcbiAgICAnU0FMRV9TSVRFJzogeyBzb3VyY2U6IFtFbnRpdHlUeXBlLlNBTEVdLCB0YXJnZXQ6IFtFbnRpdHlUeXBlLlNJVEVdIH0sXHJcblxyXG4gICAgLy8gRklOQU5DSUFMIFJFQ09SRCByZWxhdGlvbnNoaXBzICg2KVxyXG4gICAgJ0ZJTlJFQ19UQVNLJzogeyBzb3VyY2U6IFtFbnRpdHlUeXBlLkZJTkFOQ0lBTF0sIHRhcmdldDogW0VudGl0eVR5cGUuVEFTS10gfSxcclxuICAgICdGSU5SRUNfSVRFTSc6IHsgc291cmNlOiBbRW50aXR5VHlwZS5GSU5BTkNJQUxdLCB0YXJnZXQ6IFtFbnRpdHlUeXBlLklURU1dIH0sXHJcbiAgICAnRklOUkVDX1NBTEUnOiB7IHNvdXJjZTogW0VudGl0eVR5cGUuRklOQU5DSUFMXSwgdGFyZ2V0OiBbRW50aXR5VHlwZS5TQUxFXSB9LFxyXG4gICAgJ0ZJTlJFQ19QTEFZRVInOiB7IHNvdXJjZTogW0VudGl0eVR5cGUuRklOQU5DSUFMXSwgdGFyZ2V0OiBbRW50aXR5VHlwZS5QTEFZRVJdIH0sXHJcbiAgICAnRklOUkVDX0NIQVJBQ1RFUic6IHsgc291cmNlOiBbRW50aXR5VHlwZS5GSU5BTkNJQUxdLCB0YXJnZXQ6IFtFbnRpdHlUeXBlLkNIQVJBQ1RFUl0gfSxcclxuICAgICdGSU5SRUNfU0lURSc6IHsgc291cmNlOiBbRW50aXR5VHlwZS5GSU5BTkNJQUxdLCB0YXJnZXQ6IFtFbnRpdHlUeXBlLlNJVEVdIH0sXHJcblxyXG4gICAgLy8gQ0hBUkFDVEVSIHJlbGF0aW9uc2hpcHMgKDYpXHJcbiAgICAnQ0hBUkFDVEVSX1RBU0snOiB7IHNvdXJjZTogW0VudGl0eVR5cGUuQ0hBUkFDVEVSXSwgdGFyZ2V0OiBbRW50aXR5VHlwZS5UQVNLXSB9LFxyXG4gICAgJ0NIQVJBQ1RFUl9JVEVNJzogeyBzb3VyY2U6IFtFbnRpdHlUeXBlLkNIQVJBQ1RFUl0sIHRhcmdldDogW0VudGl0eVR5cGUuSVRFTV0gfSxcclxuICAgICdDSEFSQUNURVJfU0FMRSc6IHsgc291cmNlOiBbRW50aXR5VHlwZS5DSEFSQUNURVJdLCB0YXJnZXQ6IFtFbnRpdHlUeXBlLlNBTEVdIH0sXHJcbiAgICAnQ0hBUkFDVEVSX0ZJTlJFQyc6IHsgc291cmNlOiBbRW50aXR5VHlwZS5DSEFSQUNURVJdLCB0YXJnZXQ6IFtFbnRpdHlUeXBlLkZJTkFOQ0lBTF0gfSxcclxuICAgICdDSEFSQUNURVJfU0lURSc6IHsgc291cmNlOiBbRW50aXR5VHlwZS5DSEFSQUNURVJdLCB0YXJnZXQ6IFtFbnRpdHlUeXBlLlNJVEVdIH0sXHJcbiAgICAnQ0hBUkFDVEVSX1BMQVlFUic6IHsgc291cmNlOiBbRW50aXR5VHlwZS5DSEFSQUNURVJdLCB0YXJnZXQ6IFtFbnRpdHlUeXBlLlBMQVlFUl0gfSxcclxuXHJcbiAgICAvLyBTSVRFIHJlbGF0aW9uc2hpcHMgKDYpXHJcbiAgICAnU0lURV9UQVNLJzogeyBzb3VyY2U6IFtFbnRpdHlUeXBlLlNJVEVdLCB0YXJnZXQ6IFtFbnRpdHlUeXBlLlRBU0tdIH0sXHJcbiAgICAnU0lURV9DSEFSQUNURVInOiB7IHNvdXJjZTogW0VudGl0eVR5cGUuU0lURV0sIHRhcmdldDogW0VudGl0eVR5cGUuQ0hBUkFDVEVSXSB9LFxyXG4gICAgJ1NJVEVfRklOUkVDJzogeyBzb3VyY2U6IFtFbnRpdHlUeXBlLlNJVEVdLCB0YXJnZXQ6IFtFbnRpdHlUeXBlLkZJTkFOQ0lBTF0gfSxcclxuICAgICdTSVRFX0lURU0nOiB7IHNvdXJjZTogW0VudGl0eVR5cGUuU0lURV0sIHRhcmdldDogW0VudGl0eVR5cGUuSVRFTV0gfSxcclxuICAgICdTSVRFX1NBTEUnOiB7IHNvdXJjZTogW0VudGl0eVR5cGUuU0lURV0sIHRhcmdldDogW0VudGl0eVR5cGUuU0FMRV0gfSxcclxuICAgICdTSVRFX1NJVEUnOiB7IHNvdXJjZTogW0VudGl0eVR5cGUuU0lURV0sIHRhcmdldDogW0VudGl0eVR5cGUuU0lURV0gfSxcclxuXHJcbiAgICAvLyBQTEFZRVIgcmVsYXRpb25zaGlwcyAoNSlcclxuICAgICdQTEFZRVJfVEFTSyc6IHsgc291cmNlOiBbRW50aXR5VHlwZS5QTEFZRVJdLCB0YXJnZXQ6IFtFbnRpdHlUeXBlLlRBU0tdIH0sXHJcbiAgICAnUExBWUVSX1NBTEUnOiB7IHNvdXJjZTogW0VudGl0eVR5cGUuUExBWUVSXSwgdGFyZ2V0OiBbRW50aXR5VHlwZS5TQUxFXSB9LFxyXG4gICAgJ1BMQVlFUl9GSU5SRUMnOiB7IHNvdXJjZTogW0VudGl0eVR5cGUuUExBWUVSXSwgdGFyZ2V0OiBbRW50aXR5VHlwZS5GSU5BTkNJQUxdIH0sXHJcbiAgICAnUExBWUVSX0lURU0nOiB7IHNvdXJjZTogW0VudGl0eVR5cGUuUExBWUVSXSwgdGFyZ2V0OiBbRW50aXR5VHlwZS5JVEVNXSB9LFxyXG4gICAgJ1BMQVlFUl9DSEFSQUNURVInOiB7IHNvdXJjZTogW0VudGl0eVR5cGUuUExBWUVSXSwgdGFyZ2V0OiBbRW50aXR5VHlwZS5DSEFSQUNURVJdIH0sXHJcblxyXG4gICAgLy8gQUNDT1VOVCByZWxhdGlvbnNoaXBzICg0KVxyXG4gICAgJ0FDQ09VTlRfUExBWUVSJzogeyBzb3VyY2U6IFtFbnRpdHlUeXBlLkFDQ09VTlRdLCB0YXJnZXQ6IFtFbnRpdHlUeXBlLlBMQVlFUl0gfSxcclxuICAgICdBQ0NPVU5UX0NIQVJBQ1RFUic6IHsgc291cmNlOiBbRW50aXR5VHlwZS5BQ0NPVU5UXSwgdGFyZ2V0OiBbRW50aXR5VHlwZS5DSEFSQUNURVJdIH0sXHJcbiAgICAnUExBWUVSX0FDQ09VTlQnOiB7IHNvdXJjZTogW0VudGl0eVR5cGUuUExBWUVSXSwgdGFyZ2V0OiBbRW50aXR5VHlwZS5BQ0NPVU5UXSB9LFxyXG4gICAgJ0NIQVJBQ1RFUl9BQ0NPVU5UJzogeyBzb3VyY2U6IFtFbnRpdHlUeXBlLkNIQVJBQ1RFUl0sIHRhcmdldDogW0VudGl0eVR5cGUuQUNDT1VOVF0gfVxyXG4gIH07XHJcblxyXG4gIGNvbnN0IGNvbWJpbmF0aW9uID0gdmFsaWRDb21iaW5hdGlvbnNbbGlua1R5cGVdO1xyXG4gIGlmICghY29tYmluYXRpb24pIHtcclxuICAgIHJldHVybiB7XHJcbiAgICAgIGlzVmFsaWQ6IGZhbHNlLFxyXG4gICAgICByZWFzb246IGBVbmtub3duIGxpbmsgdHlwZTogJHtsaW5rVHlwZX1gXHJcbiAgICB9O1xyXG4gIH1cclxuXHJcbiAgaWYgKCFjb21iaW5hdGlvbi5zb3VyY2UuaW5jbHVkZXMoc291cmNlVHlwZSkpIHtcclxuICAgIHJldHVybiB7XHJcbiAgICAgIGlzVmFsaWQ6IGZhbHNlLFxyXG4gICAgICByZWFzb246IGBJbnZhbGlkIHNvdXJjZSB0eXBlIGZvciAke2xpbmtUeXBlfTogJHtzb3VyY2VUeXBlfS4gVmFsaWQgc291cmNlczogJHtjb21iaW5hdGlvbi5zb3VyY2Uuam9pbignLCAnKX1gXHJcbiAgICB9O1xyXG4gIH1cclxuXHJcbiAgaWYgKCFjb21iaW5hdGlvbi50YXJnZXQuaW5jbHVkZXModGFyZ2V0VHlwZSkpIHtcclxuICAgIHJldHVybiB7XHJcbiAgICAgIGlzVmFsaWQ6IGZhbHNlLFxyXG4gICAgICByZWFzb246IGBJbnZhbGlkIHRhcmdldCB0eXBlIGZvciAke2xpbmtUeXBlfTogJHt0YXJnZXRUeXBlfS4gVmFsaWQgdGFyZ2V0czogJHtjb21iaW5hdGlvbi50YXJnZXQuam9pbignLCAnKX1gXHJcbiAgICB9O1xyXG4gIH1cclxuXHJcbiAgcmV0dXJuIHsgaXNWYWxpZDogdHJ1ZSB9O1xyXG59XHJcblxyXG4vKipcclxuICogVmFsaWRhdGUgdGhhdCBlbnRpdHkgZXhpc3RzIGluIHRoZSBzeXN0ZW1cclxuICovXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiB2YWxpZGF0ZUVudGl0eUV4aXN0cyhlbnRpdHlUeXBlOiBFbnRpdHlUeXBlLCBlbnRpdHlJZDogc3RyaW5nKTogUHJvbWlzZTxib29sZWFuPiB7XHJcbiAgdHJ5IHtcclxuICAgIHN3aXRjaCAoZW50aXR5VHlwZSkge1xyXG4gICAgICBjYXNlIEVudGl0eVR5cGUuVEFTSzpcclxuICAgICAgICBjb25zdCB0YXNrcyA9IGF3YWl0IGdldEFsbFRhc2tzKCk7XHJcbiAgICAgICAgY29uc3QgdGFzayA9IHRhc2tzLmZpbmQodCA9PiB0LmlkID09PSBlbnRpdHlJZCk7XHJcbiAgICAgICAgcmV0dXJuICEhdGFzaztcclxuICAgICAgY2FzZSBFbnRpdHlUeXBlLklURU06XHJcbiAgICAgICAgY29uc3QgaXRlbXMgPSBhd2FpdCBnZXRBbGxJdGVtcygpO1xyXG4gICAgICAgIGNvbnN0IGl0ZW0gPSBpdGVtcy5maW5kKGkgPT4gaS5pZCA9PT0gZW50aXR5SWQpO1xyXG4gICAgICAgIHJldHVybiAhIWl0ZW07XHJcbiAgICAgIGNhc2UgRW50aXR5VHlwZS5GSU5BTkNJQUw6XHJcbiAgICAgICAgY29uc3QgZmluYW5jaWFsUmVjb3JkcyA9IGF3YWl0IGdldEFsbEZpbmFuY2lhbHMoKTtcclxuICAgICAgICBjb25zdCBmaW5hbmNpYWwgPSBmaW5hbmNpYWxSZWNvcmRzLmZpbmQoZiA9PiBmLmlkID09PSBlbnRpdHlJZCk7XHJcbiAgICAgICAgcmV0dXJuICEhZmluYW5jaWFsO1xyXG4gICAgICBjYXNlIEVudGl0eVR5cGUuU0FMRTpcclxuICAgICAgICBjb25zdCBzYWxlcyA9IGF3YWl0IGdldEFsbFNhbGVzKCk7XHJcbiAgICAgICAgY29uc3Qgc2FsZSA9IHNhbGVzLmZpbmQocyA9PiBzLmlkID09PSBlbnRpdHlJZCk7XHJcbiAgICAgICAgcmV0dXJuICEhc2FsZTtcclxuICAgICAgY2FzZSBFbnRpdHlUeXBlLkNIQVJBQ1RFUjpcclxuICAgICAgICBjb25zdCBjaGFyYWN0ZXJzID0gYXdhaXQgZ2V0QWxsQ2hhcmFjdGVycygpO1xyXG4gICAgICAgIGNvbnN0IGNoYXJhY3RlciA9IGNoYXJhY3RlcnMuZmluZChjID0+IGMuaWQgPT09IGVudGl0eUlkKTtcclxuICAgICAgICByZXR1cm4gISFjaGFyYWN0ZXI7XHJcbiAgICAgIGNhc2UgRW50aXR5VHlwZS5QTEFZRVI6XHJcbiAgICAgICAgY29uc3QgcGxheWVycyA9IGF3YWl0IGdldEFsbFBsYXllcnMoKTtcclxuICAgICAgICBjb25zdCBwbGF5ZXIgPSBwbGF5ZXJzLmZpbmQocCA9PiBwLmlkID09PSBlbnRpdHlJZCk7XHJcbiAgICAgICAgcmV0dXJuICEhcGxheWVyO1xyXG4gICAgICBjYXNlIEVudGl0eVR5cGUuU0lURTpcclxuICAgICAgICBjb25zdCBzaXRlcyA9IGF3YWl0IGdldEFsbFNpdGVzKCk7XHJcbiAgICAgICAgY29uc3Qgc2l0ZSA9IHNpdGVzLmZpbmQocyA9PiBzLmlkID09PSBlbnRpdHlJZCk7XHJcbiAgICAgICAgcmV0dXJuICEhc2l0ZTtcclxuICAgICAgY2FzZSBFbnRpdHlUeXBlLkFDQ09VTlQ6XHJcbiAgICAgICAgLy8gQWNjb3VudCBlbnRpdHkgbm90IGltcGxlbWVudGVkIGluIGN1cnJlbnQgZGF0YXN0b3JlXHJcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgICBkZWZhdWx0OlxyXG4gICAgICAgIGNvbnNvbGUud2FybihgW3ZhbGlkYXRlRW50aXR5RXhpc3RzXSBVbmtub3duIGVudGl0eSB0eXBlOiAke2VudGl0eVR5cGV9YCk7XHJcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgfVxyXG4gIH0gY2F0Y2ggKGVycm9yKSB7XHJcbiAgICBjb25zb2xlLmVycm9yKGBbdmFsaWRhdGVFbnRpdHlFeGlzdHNdIEVycm9yIHZhbGlkYXRpbmcgZW50aXR5ICR7ZW50aXR5VHlwZX06JHtlbnRpdHlJZH06YCwgZXJyb3IpO1xyXG4gICAgcmV0dXJuIGZhbHNlO1xyXG4gIH1cclxufVxyXG5cclxuLyoqXHJcbiAqIFZhbGlkYXRlIGJ1c2luZXNzIHJ1bGVzIHNwZWNpZmljIHRvIGxpbmsgdHlwZXNcclxuICovXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiB2YWxpZGF0ZUJ1c2luZXNzUnVsZXMoXHJcbiAgbGlua1R5cGU6IExpbmtUeXBlLFxyXG4gIHNvdXJjZTogeyB0eXBlOiBFbnRpdHlUeXBlOyBpZDogc3RyaW5nIH0sXHJcbiAgdGFyZ2V0OiB7IHR5cGU6IEVudGl0eVR5cGU7IGlkOiBzdHJpbmcgfSxcclxuICBtZXRhZGF0YT86IFJlY29yZDxzdHJpbmcsIGFueT5cclxuKTogUHJvbWlzZTxMaW5rVmFsaWRhdGlvblJlc3VsdD4ge1xyXG4gIGNvbnN0IHdhcm5pbmdzOiBzdHJpbmdbXSA9IFtdO1xyXG5cclxuICB0cnkge1xyXG4gICAgc3dpdGNoIChsaW5rVHlwZSkge1xyXG4gICAgICBjYXNlICdQTEFZRVJfQ0hBUkFDVEVSJzpcclxuICAgICAgICAvLyBWYWxpZGF0ZSB0aGF0IGNoYXJhY3RlciBoYXMgdmFsaWQgcGxheWVySWRcclxuICAgICAgICBjb25zdCBjaGFyYWN0ZXJzID0gYXdhaXQgZ2V0QWxsQ2hhcmFjdGVycygpO1xyXG4gICAgICAgIGNvbnN0IGNoYXJhY3RlciA9IGNoYXJhY3RlcnMuZmluZChjID0+IGMuaWQgPT09IHNvdXJjZS5pZCk7XHJcbiAgICAgICAgaWYgKGNoYXJhY3RlciAmJiBjaGFyYWN0ZXIucGxheWVySWQgIT09IHRhcmdldC5pZCkge1xyXG4gICAgICAgICAgd2FybmluZ3MucHVzaChgQ2hhcmFjdGVyIHBsYXllcklkICgke2NoYXJhY3Rlci5wbGF5ZXJJZH0pIGRvZXMgbm90IG1hdGNoIHRhcmdldCBwbGF5ZXIgSUQgKCR7dGFyZ2V0LmlkfSlgKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgYnJlYWs7XHJcblxyXG4gICAgICBjYXNlICdUQVNLX1NJVEUnOlxyXG4gICAgICAgIC8vIFZhbGlkYXRlIHRoYXQgdGFzayBoYXMgdmFsaWQgc2l0ZUlkXHJcbiAgICAgICAgY29uc3QgdGFza3MgPSBhd2FpdCBnZXRBbGxUYXNrcygpO1xyXG4gICAgICAgIGNvbnN0IHRhc2sgPSB0YXNrcy5maW5kKHQgPT4gdC5pZCA9PT0gc291cmNlLmlkKTtcclxuICAgICAgICBpZiAodGFzayAmJiB0YXNrLnNpdGVJZCAhPT0gdGFyZ2V0LmlkKSB7XHJcbiAgICAgICAgICB3YXJuaW5ncy5wdXNoKGBUYXNrIHNpdGVJZCAoJHt0YXNrLnNpdGVJZH0pIGRvZXMgbm90IG1hdGNoIHRhcmdldCBzaXRlIElEICgke3RhcmdldC5pZH0pYCk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGJyZWFrO1xyXG5cclxuICAgICAgY2FzZSAnSVRFTV9TSVRFJzpcclxuICAgICAgICAvLyBWYWxpZGF0ZSBpdGVtIHN0b2NrIGxvY2F0aW9uXHJcbiAgICAgICAgY29uc3QgaXRlbXMgPSBhd2FpdCBnZXRBbGxJdGVtcygpO1xyXG4gICAgICAgIGNvbnN0IGl0ZW0gPSBpdGVtcy5maW5kKGkgPT4gaS5pZCA9PT0gc291cmNlLmlkKTtcclxuICAgICAgICBpZiAoaXRlbSAmJiBpdGVtLnN0b2NrKSB7XHJcbiAgICAgICAgICBjb25zdCBoYXNTdG9ja0F0U2l0ZSA9IGl0ZW0uc3RvY2suc29tZSgoc3RvY2s6IGFueSkgPT4gc3RvY2suc2l0ZUlkID09PSB0YXJnZXQuaWQpO1xyXG4gICAgICAgICAgaWYgKCFoYXNTdG9ja0F0U2l0ZSkge1xyXG4gICAgICAgICAgICB3YXJuaW5ncy5wdXNoKGBJdGVtIGRvZXMgbm90IGhhdmUgc3RvY2sgYXQgdGFyZ2V0IHNpdGU6ICR7dGFyZ2V0LmlkfWApO1xyXG4gICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICBicmVhaztcclxuXHJcbiAgICAgIGNhc2UgJ1NBTEVfSVRFTSc6XHJcbiAgICAgICAgLy8gVmFsaWRhdGUgc2FsZSBjb250YWlucyB0aGUgaXRlbVxyXG4gICAgICAgIGNvbnN0IHNhbGVzID0gYXdhaXQgZ2V0QWxsU2FsZXMoKTtcclxuICAgICAgICBjb25zdCBzYWxlID0gc2FsZXMuZmluZChzID0+IHMuaWQgPT09IHNvdXJjZS5pZCk7XHJcbiAgICAgICAgaWYgKHNhbGUgJiYgc2FsZS5saW5lcykge1xyXG4gICAgICAgICAgY29uc3QgaGFzSXRlbUluU2FsZSA9IHNhbGUubGluZXMuc29tZSgobGluZTogYW55KSA9PiBsaW5lLmtpbmQgPT09ICdpdGVtJyAmJiBsaW5lLml0ZW1JZCA9PT0gdGFyZ2V0LmlkKTtcclxuICAgICAgICAgIGlmICghaGFzSXRlbUluU2FsZSkge1xyXG4gICAgICAgICAgICB3YXJuaW5ncy5wdXNoKGBTYWxlIGRvZXMgbm90IGNvbnRhaW4gdGFyZ2V0IGl0ZW06ICR7dGFyZ2V0LmlkfWApO1xyXG4gICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICBicmVhaztcclxuXHJcbiAgICAgIGNhc2UgJ0NIQVJBQ1RFUl9QTEFZRVInOlxyXG4gICAgICAgIC8vIFZhbGlkYXRlIHRoYXQgY2hhcmFjdGVyIGJlbG9uZ3MgdG8gdGhlIHBsYXllclxyXG4gICAgICAgIGNvbnN0IGNoYXJGb3JQbGF5ZXIgPSBhd2FpdCBnZXRBbGxDaGFyYWN0ZXJzKCk7XHJcbiAgICAgICAgY29uc3QgY2hhciA9IGNoYXJGb3JQbGF5ZXIuZmluZChjID0+IGMuaWQgPT09IHNvdXJjZS5pZCk7XHJcbiAgICAgICAgaWYgKGNoYXIgJiYgY2hhci5wbGF5ZXJJZCAhPT0gdGFyZ2V0LmlkKSB7XHJcbiAgICAgICAgICB3YXJuaW5ncy5wdXNoKGBDaGFyYWN0ZXIgcGxheWVySWQgKCR7Y2hhci5wbGF5ZXJJZH0pIGRvZXMgbm90IG1hdGNoIHRhcmdldCBwbGF5ZXIgSUQgKCR7dGFyZ2V0LmlkfSlgKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgYnJlYWs7XHJcblxyXG4gICAgICBjYXNlICdTQUxFX0NIQVJBQ1RFUic6XHJcbiAgICAgICAgLy8gVmFsaWRhdGUgdGhhdCBjaGFyYWN0ZXIgaXMgdGhlIGN1c3RvbWVyXHJcbiAgICAgICAgY29uc3Qgc2FsZUZvckNoYXIgPSBhd2FpdCBnZXRBbGxTYWxlcygpO1xyXG4gICAgICAgIGNvbnN0IHNhbGVXaXRoQ2hhciA9IHNhbGVGb3JDaGFyLmZpbmQocyA9PiBzLmlkID09PSBzb3VyY2UuaWQpO1xyXG4gICAgICAgIGlmIChzYWxlV2l0aENoYXIgJiYgc2FsZVdpdGhDaGFyLmN1c3RvbWVySWQgIT09IHRhcmdldC5pZCkge1xyXG4gICAgICAgICAgd2FybmluZ3MucHVzaChgU2FsZSBjdXN0b21lcklkICgke3NhbGVXaXRoQ2hhci5jdXN0b21lcklkfSkgZG9lcyBub3QgbWF0Y2ggdGFyZ2V0IGNoYXJhY3RlciBJRCAoJHt0YXJnZXQuaWR9KWApO1xyXG4gICAgICAgIH1cclxuICAgICAgICBicmVhaztcclxuXHJcbiAgICAgIC8vIEFkZCBtb3JlIGJ1c2luZXNzIHJ1bGUgdmFsaWRhdGlvbnMgYXMgbmVlZGVkXHJcbiAgICAgIGRlZmF1bHQ6XHJcbiAgICAgICAgLy8gTm8gc3BlY2lmaWMgYnVzaW5lc3MgcnVsZXMgZm9yIHRoaXMgbGluayB0eXBlXHJcbiAgICAgICAgYnJlYWs7XHJcbiAgICB9XHJcblxyXG4gICAgcmV0dXJuIHtcclxuICAgICAgaXNWYWxpZDogdHJ1ZSxcclxuICAgICAgd2FybmluZ3M6IHdhcm5pbmdzLmxlbmd0aCA+IDAgPyB3YXJuaW5ncyA6IHVuZGVmaW5lZFxyXG4gICAgfTtcclxuXHJcbiAgfSBjYXRjaCAoZXJyb3IpIHtcclxuICAgIHJldHVybiB7XHJcbiAgICAgIGlzVmFsaWQ6IGZhbHNlLFxyXG4gICAgICByZWFzb246IGBCdXNpbmVzcyBydWxlcyB2YWxpZGF0aW9uIGVycm9yOiAke2Vycm9yIGluc3RhbmNlb2YgRXJyb3IgPyBlcnJvci5tZXNzYWdlIDogJ1Vua25vd24gZXJyb3InfWBcclxuICAgIH07XHJcbiAgfVxyXG59XHJcbiJdLCJuYW1lcyI6WyJFbnRpdHlUeXBlIiwiZ2V0QWxsVGFza3MiLCJnZXRBbGxJdGVtcyIsImdldEFsbEZpbmFuY2lhbHMiLCJnZXRBbGxTYWxlcyIsImdldEFsbENoYXJhY3RlcnMiLCJnZXRBbGxQbGF5ZXJzIiwiZ2V0QWxsU2l0ZXMiLCJ2YWxpZGF0ZUxpbmsiLCJsaW5rVHlwZSIsInNvdXJjZSIsInRhcmdldCIsIm1ldGFkYXRhIiwid2FybmluZ3MiLCJ0eXBlIiwiaWQiLCJpc1ZhbGlkIiwicmVhc29uIiwiY29tcGF0aWJpbGl0eVJlc3VsdCIsInZhbGlkYXRlTGlua1R5cGVDb21wYXRpYmlsaXR5Iiwic291cmNlRXhpc3RzIiwidmFsaWRhdGVFbnRpdHlFeGlzdHMiLCJ0YXJnZXRFeGlzdHMiLCJidXNpbmVzc1J1bGVzUmVzdWx0IiwidmFsaWRhdGVCdXNpbmVzc1J1bGVzIiwicHVzaCIsImxlbmd0aCIsInVuZGVmaW5lZCIsImVycm9yIiwiRXJyb3IiLCJtZXNzYWdlIiwic291cmNlVHlwZSIsInRhcmdldFR5cGUiLCJ2YWxpZENvbWJpbmF0aW9ucyIsIlRBU0siLCJJVEVNIiwiRklOQU5DSUFMIiwiU0FMRSIsIlBMQVlFUiIsIkNIQVJBQ1RFUiIsIlNJVEUiLCJBQ0NPVU5UIiwiY29tYmluYXRpb24iLCJpbmNsdWRlcyIsImpvaW4iLCJlbnRpdHlUeXBlIiwiZW50aXR5SWQiLCJ0YXNrcyIsInRhc2siLCJmaW5kIiwidCIsIml0ZW1zIiwiaXRlbSIsImkiLCJmaW5hbmNpYWxSZWNvcmRzIiwiZmluYW5jaWFsIiwiZiIsInNhbGVzIiwic2FsZSIsInMiLCJjaGFyYWN0ZXJzIiwiY2hhcmFjdGVyIiwiYyIsInBsYXllcnMiLCJwbGF5ZXIiLCJwIiwic2l0ZXMiLCJzaXRlIiwiY29uc29sZSIsIndhcm4iLCJwbGF5ZXJJZCIsInNpdGVJZCIsInN0b2NrIiwiaGFzU3RvY2tBdFNpdGUiLCJzb21lIiwibGluZXMiLCJoYXNJdGVtSW5TYWxlIiwibGluZSIsImtpbmQiLCJpdGVtSWQiLCJjaGFyRm9yUGxheWVyIiwiY2hhciIsInNhbGVGb3JDaGFyIiwic2FsZVdpdGhDaGFyIiwiY3VzdG9tZXJJZCJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./links/link-validation.ts\n");

/***/ }),

/***/ "(rsc)/./links/links-logging.ts":
/*!********************************!*\
  !*** ./links/links-logging.ts ***!
  \********************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   appendLinkLog: () => (/* binding */ appendLinkLog)\n/* harmony export */ });\n/* harmony import */ var _data_store_kv__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @/data-store/kv */ \"(rsc)/./data-store/kv.ts\");\n/* harmony import */ var _data_store_keys__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @/data-store/keys */ \"(rsc)/./data-store/keys.ts\");\n// links/links-logging.ts\n// Links self-logging: append link events to KV\n\n\nconst ENTITY = \"links\";\nasync function appendLinkLog(link, kind = \"created\") {\n    const key = (0,_data_store_keys__WEBPACK_IMPORTED_MODULE_1__.buildLogKey)(ENTITY);\n    const list = await (0,_data_store_kv__WEBPACK_IMPORTED_MODULE_0__.kvGet)(key) || [];\n    list.push({\n        kind,\n        linkId: link.id,\n        linkType: String(link.linkType),\n        source: {\n            type: String(link.source.type),\n            id: link.source.id\n        },\n        target: {\n            type: String(link.target.type),\n            id: link.target.id\n        },\n        metadata: link.metadata,\n        at: new Date().toISOString()\n    });\n    await (0,_data_store_kv__WEBPACK_IMPORTED_MODULE_0__.kvSet)(key, list);\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9saW5rcy9saW5rcy1sb2dnaW5nLnRzIiwibWFwcGluZ3MiOiI7Ozs7OztBQUFBLHlCQUF5QjtBQUN6QiwrQ0FBK0M7QUFHQTtBQUNDO0FBRWhELE1BQU1HLFNBQVM7QUFZUixlQUFlQyxjQUFjQyxJQUFVLEVBQUVDLE9BQTZCLFNBQVM7SUFDcEYsTUFBTUMsTUFBTUwsNkRBQVdBLENBQUNDO0lBQ3hCLE1BQU1LLE9BQU8sTUFBT1IscURBQUtBLENBQWlCTyxRQUFTLEVBQUU7SUFDckRDLEtBQUtDLElBQUksQ0FBQztRQUNSSDtRQUNBSSxRQUFRTCxLQUFLTSxFQUFFO1FBQ2ZDLFVBQVVDLE9BQU9SLEtBQUtPLFFBQVE7UUFDOUJFLFFBQVE7WUFBRUMsTUFBTUYsT0FBT1IsS0FBS1MsTUFBTSxDQUFDQyxJQUFJO1lBQUdKLElBQUlOLEtBQUtTLE1BQU0sQ0FBQ0gsRUFBRTtRQUFDO1FBQzdESyxRQUFRO1lBQUVELE1BQU1GLE9BQU9SLEtBQUtXLE1BQU0sQ0FBQ0QsSUFBSTtZQUFHSixJQUFJTixLQUFLVyxNQUFNLENBQUNMLEVBQUU7UUFBQztRQUM3RE0sVUFBVVosS0FBS1ksUUFBUTtRQUN2QkMsSUFBSSxJQUFJQyxPQUFPQyxXQUFXO0lBQzVCO0lBQ0EsTUFBTW5CLHFEQUFLQSxDQUFDTSxLQUFLQztBQUNuQiIsInNvdXJjZXMiOlsid2VicGFjazovL3RoZWdhbWUtYWRtaW4vLi9saW5rcy9saW5rcy1sb2dnaW5nLnRzP2Q0MmUiXSwic291cmNlc0NvbnRlbnQiOlsiLy8gbGlua3MvbGlua3MtbG9nZ2luZy50c1xyXG4vLyBMaW5rcyBzZWxmLWxvZ2dpbmc6IGFwcGVuZCBsaW5rIGV2ZW50cyB0byBLVlxyXG5cclxuaW1wb3J0IHR5cGUgeyBMaW5rIH0gZnJvbSAnQC90eXBlcy9lbnRpdGllcyc7XHJcbmltcG9ydCB7IGt2R2V0LCBrdlNldCB9IGZyb20gJ0AvZGF0YS1zdG9yZS9rdic7XHJcbmltcG9ydCB7IGJ1aWxkTG9nS2V5IH0gZnJvbSAnQC9kYXRhLXN0b3JlL2tleXMnO1xyXG5cclxuY29uc3QgRU5USVRZID0gJ2xpbmtzJztcclxuXHJcbmV4cG9ydCB0eXBlIExpbmtMb2dFdmVudCA9IHtcclxuICBraW5kOiAnY3JlYXRlZCcgfCAncmVtb3ZlZCcgfCAndXBkYXRlZCc7XHJcbiAgbGlua0lkOiBzdHJpbmc7XHJcbiAgbGlua1R5cGU6IHN0cmluZztcclxuICBzb3VyY2U6IHsgdHlwZTogc3RyaW5nOyBpZDogc3RyaW5nIH07XHJcbiAgdGFyZ2V0OiB7IHR5cGU6IHN0cmluZzsgaWQ6IHN0cmluZyB9O1xyXG4gIG1ldGFkYXRhPzogUmVjb3JkPHN0cmluZywgYW55PjtcclxuICBhdDogc3RyaW5nOyAvLyBJU08gdGltZXN0YW1wXHJcbn07XHJcblxyXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gYXBwZW5kTGlua0xvZyhsaW5rOiBMaW5rLCBraW5kOiBMaW5rTG9nRXZlbnRbJ2tpbmQnXSA9ICdjcmVhdGVkJyk6IFByb21pc2U8dm9pZD4ge1xyXG4gIGNvbnN0IGtleSA9IGJ1aWxkTG9nS2V5KEVOVElUWSk7XHJcbiAgY29uc3QgbGlzdCA9IChhd2FpdCBrdkdldDxMaW5rTG9nRXZlbnRbXT4oa2V5KSkgfHwgW107XHJcbiAgbGlzdC5wdXNoKHtcclxuICAgIGtpbmQsXHJcbiAgICBsaW5rSWQ6IGxpbmsuaWQsXHJcbiAgICBsaW5rVHlwZTogU3RyaW5nKGxpbmsubGlua1R5cGUpLFxyXG4gICAgc291cmNlOiB7IHR5cGU6IFN0cmluZyhsaW5rLnNvdXJjZS50eXBlKSwgaWQ6IGxpbmsuc291cmNlLmlkIH0sXHJcbiAgICB0YXJnZXQ6IHsgdHlwZTogU3RyaW5nKGxpbmsudGFyZ2V0LnR5cGUpLCBpZDogbGluay50YXJnZXQuaWQgfSxcclxuICAgIG1ldGFkYXRhOiBsaW5rLm1ldGFkYXRhLFxyXG4gICAgYXQ6IG5ldyBEYXRlKCkudG9JU09TdHJpbmcoKSxcclxuICB9KTtcclxuICBhd2FpdCBrdlNldChrZXksIGxpc3QpO1xyXG59XHJcblxyXG5cclxuIl0sIm5hbWVzIjpbImt2R2V0Iiwia3ZTZXQiLCJidWlsZExvZ0tleSIsIkVOVElUWSIsImFwcGVuZExpbmtMb2ciLCJsaW5rIiwia2luZCIsImtleSIsImxpc3QiLCJwdXNoIiwibGlua0lkIiwiaWQiLCJsaW5rVHlwZSIsIlN0cmluZyIsInNvdXJjZSIsInR5cGUiLCJ0YXJnZXQiLCJtZXRhZGF0YSIsImF0IiwiRGF0ZSIsInRvSVNPU3RyaW5nIl0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(rsc)/./links/links-logging.ts\n");

/***/ }),

/***/ "(rsc)/./links/links-workflows.ts":
/*!**********************************!*\
  !*** ./links/links-workflows.ts ***!
  \**********************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   makeLink: () => (/* binding */ makeLink),\n/* harmony export */   processCharacterEffects: () => (/* binding */ processCharacterEffects),\n/* harmony export */   processFinancialEffects: () => (/* binding */ processFinancialEffects),\n/* harmony export */   processItemEffects: () => (/* binding */ processItemEffects),\n/* harmony export */   processLinkEntity: () => (/* binding */ processLinkEntity),\n/* harmony export */   processPlayerEffects: () => (/* binding */ processPlayerEffects),\n/* harmony export */   processSaleEffects: () => (/* binding */ processSaleEffects),\n/* harmony export */   processTaskEffects: () => (/* binding */ processTaskEffects)\n/* harmony export */ });\n/* harmony import */ var _types_enums__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @/types/enums */ \"(rsc)/./types/enums.ts\");\n/* harmony import */ var _link_registry__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./link-registry */ \"(rsc)/./links/link-registry.ts\");\n/* harmony import */ var _links_logging__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./links-logging */ \"(rsc)/./links/links-logging.ts\");\n/* harmony import */ var _data_store_datastore__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! @/data-store/datastore */ \"(rsc)/./data-store/datastore.ts\");\n/* harmony import */ var uuid__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! uuid */ \"(rsc)/./node_modules/uuid/dist/esm/v4.js\");\n/* harmony import */ var _data_store_effects_registry__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! @/data-store/effects-registry */ \"(rsc)/./data-store/effects-registry.ts\");\n// links/links-workflows.ts\n// Universal entry point for creating links from entities (property inspection)\n\n\n\n\n\n\nfunction makeLink(linkType, source, target, metadata) {\n    return {\n        id: (0,uuid__WEBPACK_IMPORTED_MODULE_5__[\"default\"])(),\n        linkType,\n        source,\n        target,\n        createdAt: new Date(),\n        metadata\n    };\n}\nasync function processLinkEntity(entity, entityType) {\n    // Check for circular reference\n    if ((0,_data_store_effects_registry__WEBPACK_IMPORTED_MODULE_4__.isProcessing)(entityType, entity.id)) {\n        console.warn(`[CircuitBreaker] Already processing ${entityType}:${entity.id} - skipping to prevent circular reference`);\n        return;\n    }\n    try {\n        (0,_data_store_effects_registry__WEBPACK_IMPORTED_MODULE_4__.startProcessing)(entityType, entity.id);\n        switch(entityType){\n            case _types_enums__WEBPACK_IMPORTED_MODULE_0__.EntityType.TASK:\n                await processTaskEffects(entity);\n                break;\n            case _types_enums__WEBPACK_IMPORTED_MODULE_0__.EntityType.ITEM:\n                await processItemEffects(entity);\n                break;\n            case _types_enums__WEBPACK_IMPORTED_MODULE_0__.EntityType.SALE:\n                await processSaleEffects(entity);\n                break;\n            case _types_enums__WEBPACK_IMPORTED_MODULE_0__.EntityType.FINANCIAL:\n                await processFinancialEffects(entity);\n                break;\n            case _types_enums__WEBPACK_IMPORTED_MODULE_0__.EntityType.CHARACTER:\n                await processCharacterEffects(entity);\n                break;\n            case _types_enums__WEBPACK_IMPORTED_MODULE_0__.EntityType.PLAYER:\n                await processPlayerEffects(entity);\n                break;\n            case _types_enums__WEBPACK_IMPORTED_MODULE_0__.EntityType.SITE:\n                break;\n            default:\n                return;\n        }\n    } finally{\n        (0,_data_store_effects_registry__WEBPACK_IMPORTED_MODULE_4__.endProcessing)(entityType, entity.id);\n    }\n}\nasync function processTaskEffects(task) {\n    if (task.siteId) {\n        const l = makeLink(_types_enums__WEBPACK_IMPORTED_MODULE_0__.LinkType.TASK_SITE, {\n            type: _types_enums__WEBPACK_IMPORTED_MODULE_0__.EntityType.TASK,\n            id: task.id\n        }, {\n            type: _types_enums__WEBPACK_IMPORTED_MODULE_0__.EntityType.SITE,\n            id: task.siteId\n        });\n        await (0,_link_registry__WEBPACK_IMPORTED_MODULE_1__.createLink)(l);\n        await (0,_links_logging__WEBPACK_IMPORTED_MODULE_2__.appendLinkLog)(l, \"created\");\n    }\n    if (task.outputItemId) {\n        const l = makeLink(_types_enums__WEBPACK_IMPORTED_MODULE_0__.LinkType.TASK_ITEM, {\n            type: _types_enums__WEBPACK_IMPORTED_MODULE_0__.EntityType.TASK,\n            id: task.id\n        }, {\n            type: _types_enums__WEBPACK_IMPORTED_MODULE_0__.EntityType.ITEM,\n            id: task.outputItemId\n        });\n        await (0,_link_registry__WEBPACK_IMPORTED_MODULE_1__.createLink)(l);\n        await (0,_links_logging__WEBPACK_IMPORTED_MODULE_2__.appendLinkLog)(l, \"created\");\n    }\n    // TASK_CHARACTER link\n    if (task.characterId) {\n        const l = makeLink(_types_enums__WEBPACK_IMPORTED_MODULE_0__.LinkType.TASK_CHARACTER, {\n            type: _types_enums__WEBPACK_IMPORTED_MODULE_0__.EntityType.TASK,\n            id: task.id\n        }, {\n            type: _types_enums__WEBPACK_IMPORTED_MODULE_0__.EntityType.CHARACTER,\n            id: task.characterId\n        });\n        await (0,_link_registry__WEBPACK_IMPORTED_MODULE_1__.createLink)(l);\n        await (0,_links_logging__WEBPACK_IMPORTED_MODULE_2__.appendLinkLog)(l, \"created\");\n    }\n    // Create TASK_ITEM link for items created from task emissary fields\n    if (task.outputItemType && task.outputQuantity && task.status === \"Done\") {\n        // Find the item created by this task\n        const items = await (0,_data_store_datastore__WEBPACK_IMPORTED_MODULE_3__.getAllItems)();\n        const createdItem = items.find((item)=>item.sourceTaskId === task.id && item.type === task.outputItemType);\n        if (createdItem) {\n            const l = makeLink(_types_enums__WEBPACK_IMPORTED_MODULE_0__.LinkType.TASK_ITEM, {\n                type: _types_enums__WEBPACK_IMPORTED_MODULE_0__.EntityType.TASK,\n                id: task.id\n            }, {\n                type: _types_enums__WEBPACK_IMPORTED_MODULE_0__.EntityType.ITEM,\n                id: createdItem.id\n            }, {\n                quantity: task.outputQuantity,\n                unitCost: task.outputUnitCost,\n                price: task.outputItemPrice,\n                itemType: task.outputItemType\n            });\n            await (0,_link_registry__WEBPACK_IMPORTED_MODULE_1__.createLink)(l);\n            await (0,_links_logging__WEBPACK_IMPORTED_MODULE_2__.appendLinkLog)(l, \"created\");\n        }\n    }\n// Note: TASK_PLAYER handled by points-rewards-utils.ts ✅\n// Note: TASK_FINREC handled by financial-record-utils.ts ✅\n}\nasync function processItemEffects(item) {\n    if (item.sourceTaskId) {\n        const l = makeLink(_types_enums__WEBPACK_IMPORTED_MODULE_0__.LinkType.ITEM_TASK, {\n            type: _types_enums__WEBPACK_IMPORTED_MODULE_0__.EntityType.ITEM,\n            id: item.id\n        }, {\n            type: _types_enums__WEBPACK_IMPORTED_MODULE_0__.EntityType.TASK,\n            id: item.sourceTaskId\n        });\n        await (0,_link_registry__WEBPACK_IMPORTED_MODULE_1__.createLink)(l);\n        await (0,_links_logging__WEBPACK_IMPORTED_MODULE_2__.appendLinkLog)(l, \"created\");\n    }\n    for (const s of item.stock || []){\n        if (s.siteId) {\n            const l = makeLink(_types_enums__WEBPACK_IMPORTED_MODULE_0__.LinkType.ITEM_SITE, {\n                type: _types_enums__WEBPACK_IMPORTED_MODULE_0__.EntityType.ITEM,\n                id: item.id\n            }, {\n                type: _types_enums__WEBPACK_IMPORTED_MODULE_0__.EntityType.SITE,\n                id: s.siteId\n            });\n            await (0,_link_registry__WEBPACK_IMPORTED_MODULE_1__.createLink)(l);\n            await (0,_links_logging__WEBPACK_IMPORTED_MODULE_2__.appendLinkLog)(l, \"created\");\n        }\n    }\n    // ITEM_CHARACTER link\n    if (item.ownerCharacterId) {\n        const l = makeLink(_types_enums__WEBPACK_IMPORTED_MODULE_0__.LinkType.ITEM_CHARACTER, {\n            type: _types_enums__WEBPACK_IMPORTED_MODULE_0__.EntityType.ITEM,\n            id: item.id\n        }, {\n            type: _types_enums__WEBPACK_IMPORTED_MODULE_0__.EntityType.CHARACTER,\n            id: item.ownerCharacterId\n        });\n        await (0,_link_registry__WEBPACK_IMPORTED_MODULE_1__.createLink)(l);\n        await (0,_links_logging__WEBPACK_IMPORTED_MODULE_2__.appendLinkLog)(l, \"created\");\n    }\n// Note: ITEM_SALE links handled in processSaleEffects (from sale.lines)\n}\nasync function processSaleEffects(sale) {\n    if (sale.siteId) {\n        const l = makeLink(_types_enums__WEBPACK_IMPORTED_MODULE_0__.LinkType.SALE_SITE, {\n            type: _types_enums__WEBPACK_IMPORTED_MODULE_0__.EntityType.SALE,\n            id: sale.id\n        }, {\n            type: _types_enums__WEBPACK_IMPORTED_MODULE_0__.EntityType.SITE,\n            id: sale.siteId\n        });\n        await (0,_link_registry__WEBPACK_IMPORTED_MODULE_1__.createLink)(l);\n        await (0,_links_logging__WEBPACK_IMPORTED_MODULE_2__.appendLinkLog)(l, \"created\");\n    }\n    // SALE_CHARACTER link\n    if (sale.customerId) {\n        const l = makeLink(_types_enums__WEBPACK_IMPORTED_MODULE_0__.LinkType.SALE_CHARACTER, {\n            type: _types_enums__WEBPACK_IMPORTED_MODULE_0__.EntityType.SALE,\n            id: sale.id\n        }, {\n            type: _types_enums__WEBPACK_IMPORTED_MODULE_0__.EntityType.CHARACTER,\n            id: sale.customerId\n        });\n        await (0,_link_registry__WEBPACK_IMPORTED_MODULE_1__.createLink)(l);\n        await (0,_links_logging__WEBPACK_IMPORTED_MODULE_2__.appendLinkLog)(l, \"created\");\n    }\n    // SALE_ITEM links (from sale lines)\n    if (sale.lines && sale.lines.length > 0) {\n        for (const line of sale.lines){\n            if (line.kind === \"item\" && line.itemId) {\n                const l = makeLink(_types_enums__WEBPACK_IMPORTED_MODULE_0__.LinkType.SALE_ITEM, {\n                    type: _types_enums__WEBPACK_IMPORTED_MODULE_0__.EntityType.SALE,\n                    id: sale.id\n                }, {\n                    type: _types_enums__WEBPACK_IMPORTED_MODULE_0__.EntityType.ITEM,\n                    id: line.itemId\n                }, {\n                    quantity: line.quantity,\n                    unitPrice: line.unitPrice\n                });\n                await (0,_link_registry__WEBPACK_IMPORTED_MODULE_1__.createLink)(l);\n                await (0,_links_logging__WEBPACK_IMPORTED_MODULE_2__.appendLinkLog)(l, \"created\");\n            }\n        }\n    }\n    // SALE_TASK link (if sale spawned from task)\n    if (sale.sourceTaskId) {\n        const l = makeLink(_types_enums__WEBPACK_IMPORTED_MODULE_0__.LinkType.SALE_TASK, {\n            type: _types_enums__WEBPACK_IMPORTED_MODULE_0__.EntityType.SALE,\n            id: sale.id\n        }, {\n            type: _types_enums__WEBPACK_IMPORTED_MODULE_0__.EntityType.TASK,\n            id: sale.sourceTaskId\n        });\n        await (0,_link_registry__WEBPACK_IMPORTED_MODULE_1__.createLink)(l);\n        await (0,_links_logging__WEBPACK_IMPORTED_MODULE_2__.appendLinkLog)(l, \"created\");\n    }\n// Note: SALE_PLAYER handled by points-rewards-utils.ts ✅\n}\nasync function processFinancialEffects(fin) {\n    if (fin.siteId) {\n        const l = makeLink(_types_enums__WEBPACK_IMPORTED_MODULE_0__.LinkType.FINREC_SITE, {\n            type: _types_enums__WEBPACK_IMPORTED_MODULE_0__.EntityType.FINANCIAL,\n            id: fin.id\n        }, {\n            type: _types_enums__WEBPACK_IMPORTED_MODULE_0__.EntityType.SITE,\n            id: fin.siteId\n        });\n        await (0,_link_registry__WEBPACK_IMPORTED_MODULE_1__.createLink)(l);\n        await (0,_links_logging__WEBPACK_IMPORTED_MODULE_2__.appendLinkLog)(l, \"created\");\n    }\n    // FINREC_CHARACTER link\n    if (fin.customerCharacterId) {\n        const l = makeLink(_types_enums__WEBPACK_IMPORTED_MODULE_0__.LinkType.FINREC_CHARACTER, {\n            type: _types_enums__WEBPACK_IMPORTED_MODULE_0__.EntityType.FINANCIAL,\n            id: fin.id\n        }, {\n            type: _types_enums__WEBPACK_IMPORTED_MODULE_0__.EntityType.CHARACTER,\n            id: fin.customerCharacterId\n        });\n        await (0,_link_registry__WEBPACK_IMPORTED_MODULE_1__.createLink)(l);\n        await (0,_links_logging__WEBPACK_IMPORTED_MODULE_2__.appendLinkLog)(l, \"created\");\n    }\n    // Create FINREC_ITEM link for items created from financial record emissary fields\n    if (fin.outputItemType && fin.outputQuantity) {\n        // Find the item created by this financial record\n        const items = await (0,_data_store_datastore__WEBPACK_IMPORTED_MODULE_3__.getAllItems)();\n        const createdItem = items.find((item)=>item.sourceRecordId === fin.id && item.type === fin.outputItemType);\n        if (createdItem) {\n            const l = makeLink(_types_enums__WEBPACK_IMPORTED_MODULE_0__.LinkType.FINREC_ITEM, {\n                type: _types_enums__WEBPACK_IMPORTED_MODULE_0__.EntityType.FINANCIAL,\n                id: fin.id\n            }, {\n                type: _types_enums__WEBPACK_IMPORTED_MODULE_0__.EntityType.ITEM,\n                id: createdItem.id\n            }, {\n                quantity: fin.outputQuantity,\n                unitCost: fin.outputUnitCost,\n                price: fin.outputItemPrice,\n                itemType: fin.outputItemType\n            });\n            await (0,_link_registry__WEBPACK_IMPORTED_MODULE_1__.createLink)(l);\n            await (0,_links_logging__WEBPACK_IMPORTED_MODULE_2__.appendLinkLog)(l, \"created\");\n        }\n    }\n// Note: FINREC_TASK handled by financial-record-utils.ts ✅\n// Note: FINREC_PLAYER handled by points-rewards-utils.ts ✅\n}\nasync function processCharacterEffects(character) {\n    // CHARACTER_PLAYER link\n    if (character.playerId) {\n        const link = makeLink(_types_enums__WEBPACK_IMPORTED_MODULE_0__.LinkType.CHARACTER_PLAYER, {\n            type: _types_enums__WEBPACK_IMPORTED_MODULE_0__.EntityType.CHARACTER,\n            id: character.id\n        }, {\n            type: _types_enums__WEBPACK_IMPORTED_MODULE_0__.EntityType.PLAYER,\n            id: character.playerId\n        });\n        await (0,_link_registry__WEBPACK_IMPORTED_MODULE_1__.createLink)(link);\n        await (0,_links_logging__WEBPACK_IMPORTED_MODULE_2__.appendLinkLog)(link, \"created\");\n    }\n    // CHARACTER_SITE link (if character has home site)\n    if (character.siteId) {\n        const link = makeLink(_types_enums__WEBPACK_IMPORTED_MODULE_0__.LinkType.CHARACTER_SITE, {\n            type: _types_enums__WEBPACK_IMPORTED_MODULE_0__.EntityType.CHARACTER,\n            id: character.id\n        }, {\n            type: _types_enums__WEBPACK_IMPORTED_MODULE_0__.EntityType.SITE,\n            id: character.siteId\n        });\n        await (0,_link_registry__WEBPACK_IMPORTED_MODULE_1__.createLink)(link);\n        await (0,_links_logging__WEBPACK_IMPORTED_MODULE_2__.appendLinkLog)(link, \"created\");\n    }\n}\nasync function processPlayerEffects(player) {\n    // PLAYER_CHARACTER links (array of characters)\n    if (player.characterIds && player.characterIds.length > 0) {\n        for (const characterId of player.characterIds){\n            const link = makeLink(_types_enums__WEBPACK_IMPORTED_MODULE_0__.LinkType.PLAYER_CHARACTER, {\n                type: _types_enums__WEBPACK_IMPORTED_MODULE_0__.EntityType.PLAYER,\n                id: player.id\n            }, {\n                type: _types_enums__WEBPACK_IMPORTED_MODULE_0__.EntityType.CHARACTER,\n                id: characterId\n            });\n            await (0,_link_registry__WEBPACK_IMPORTED_MODULE_1__.createLink)(link);\n            await (0,_links_logging__WEBPACK_IMPORTED_MODULE_2__.appendLinkLog)(link, \"created\");\n        }\n    }\n// Note: PLAYER_SITE links not implemented - Player doesn't have siteId field\n} // Sites don't create links when saved - they're primarily link targets\n // SITE_SITE links are created by movement operations (see workflows/site-movement-utils.ts)\n // No processSiteEffects function needed - sites have no link-creating properties\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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b0UsVUFBVUMsUUFBUTtRQUFDO1FBRXBELE1BQU1sRiwwREFBVUEsQ0FBQ21GO1FBQ2pCLE1BQU1sRiw2REFBYUEsQ0FBQ2tGLE1BQU07SUFDNUI7SUFFQSxtREFBbUQ7SUFDbkQsSUFBSUYsVUFBVTlDLE1BQU0sRUFBRTtRQUNwQixNQUFNZ0QsT0FBTzNFLFNBQ1hULGtEQUFRQSxDQUFDc0YsY0FBYyxFQUN2QjtZQUFFL0MsTUFBTXhDLG9EQUFVQSxDQUFDK0IsU0FBUztZQUFFaEIsSUFBSW9FLFVBQVVwRSxFQUFFO1FBQUMsR0FDL0M7WUFBRXlCLE1BQU14QyxvREFBVUEsQ0FBQ21DLElBQUk7WUFBRXBCLElBQUlvRSxVQUFVOUMsTUFBTTtRQUFDO1FBRWhELE1BQU1uQywwREFBVUEsQ0FBQ21GO1FBQ2pCLE1BQU1sRiw2REFBYUEsQ0FBQ2tGLE1BQU07SUFDNUI7QUFDRjtBQUVPLGVBQWVuRCxxQkFBcUJzRCxNQUFjO0lBQ3ZELCtDQUErQztJQUMvQyxJQUFJQSxPQUFPQyxZQUFZLElBQUlELE9BQU9DLFlBQVksQ0FBQ25CLE1BQU0sR0FBRyxHQUFHO1FBQ3pELEtBQUssTUFBTTNCLGVBQWU2QyxPQUFPQyxZQUFZLENBQUU7WUFDN0MsTUFBTUosT0FBTzNFLFNBQ1hULGtEQUFRQSxDQUFDeUYsZ0JBQWdCLEVBQ3pCO2dCQUFFbEQsTUFBTXhDLG9EQUFVQSxDQUFDaUMsTUFBTTtnQkFBRWxCLElBQUl5RSxPQUFPekUsRUFBRTtZQUFDLEdBQ3pDO2dCQUFFeUIsTUFBTXhDLG9EQUFVQSxDQUFDK0IsU0FBUztnQkFBRWhCLElBQUk0QjtZQUFZO1lBRWhELE1BQU16QywwREFBVUEsQ0FBQ21GO1lBQ2pCLE1BQU1sRiw2REFBYUEsQ0FBQ2tGLE1BQU07UUFDNUI7SUFDRjtBQUVBLDZFQUE2RTtBQUMvRSxFQUVBLHVFQUF1RTtDQUN2RSw0RkFBNEY7Q0FDNUYsaUZBQWlGIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vdGhlZ2FtZS1hZG1pbi8uL2xpbmtzL2xpbmtzLXdvcmtmbG93cy50cz9hMWJkIl0sInNvdXJjZXNDb250ZW50IjpbIi8vIGxpbmtzL2xpbmtzLXdvcmtmbG93cy50c1xyXG4vLyBVbml2ZXJzYWwgZW50cnkgcG9pbnQgZm9yIGNyZWF0aW5nIGxpbmtzIGZyb20gZW50aXRpZXMgKHByb3BlcnR5IGluc3BlY3Rpb24pXHJcblxyXG5pbXBvcnQgeyBFbnRpdHlUeXBlLCBMaW5rVHlwZSB9IGZyb20gJ0AvdHlwZXMvZW51bXMnO1xyXG5pbXBvcnQgdHlwZSB7IFRhc2ssIEl0ZW0sIFNhbGUsIEZpbmFuY2lhbFJlY29yZCwgQ2hhcmFjdGVyLCBQbGF5ZXIsIFNpdGUsIExpbmsgfSBmcm9tICdAL3R5cGVzL2VudGl0aWVzJztcclxuaW1wb3J0IHsgY3JlYXRlTGluayB9IGZyb20gJy4vbGluay1yZWdpc3RyeSc7XHJcbmltcG9ydCB7IGFwcGVuZExpbmtMb2cgfSBmcm9tICcuL2xpbmtzLWxvZ2dpbmcnO1xyXG5pbXBvcnQgeyBnZXRBbGxJdGVtcyB9IGZyb20gJ0AvZGF0YS1zdG9yZS9kYXRhc3RvcmUnO1xyXG5pbXBvcnQgeyB2NCBhcyB1dWlkIH0gZnJvbSAndXVpZCc7XHJcbmltcG9ydCB7IGlzUHJvY2Vzc2luZywgc3RhcnRQcm9jZXNzaW5nLCBlbmRQcm9jZXNzaW5nIH0gZnJvbSAnQC9kYXRhLXN0b3JlL2VmZmVjdHMtcmVnaXN0cnknO1xyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIG1ha2VMaW5rKGxpbmtUeXBlOiBMaW5rVHlwZSwgc291cmNlOiB7IHR5cGU6IEVudGl0eVR5cGU7IGlkOiBzdHJpbmcgfSwgdGFyZ2V0OiB7IHR5cGU6IEVudGl0eVR5cGU7IGlkOiBzdHJpbmcgfSwgbWV0YWRhdGE/OiBSZWNvcmQ8c3RyaW5nLCBhbnk+KTogTGluayB7XHJcbiAgcmV0dXJuIHtcclxuICAgIGlkOiB1dWlkKCksXHJcbiAgICBsaW5rVHlwZSxcclxuICAgIHNvdXJjZSxcclxuICAgIHRhcmdldCxcclxuICAgIGNyZWF0ZWRBdDogbmV3IERhdGUoKSxcclxuICAgIG1ldGFkYXRhLFxyXG4gIH07XHJcbn1cclxuXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBwcm9jZXNzTGlua0VudGl0eShlbnRpdHk6IGFueSwgZW50aXR5VHlwZTogRW50aXR5VHlwZSk6IFByb21pc2U8dm9pZD4ge1xyXG4gIC8vIENoZWNrIGZvciBjaXJjdWxhciByZWZlcmVuY2VcclxuICBpZiAoaXNQcm9jZXNzaW5nKGVudGl0eVR5cGUsIGVudGl0eS5pZCkpIHtcclxuICAgIGNvbnNvbGUud2FybihgW0NpcmN1aXRCcmVha2VyXSBBbHJlYWR5IHByb2Nlc3NpbmcgJHtlbnRpdHlUeXBlfToke2VudGl0eS5pZH0gLSBza2lwcGluZyB0byBwcmV2ZW50IGNpcmN1bGFyIHJlZmVyZW5jZWApO1xyXG4gICAgcmV0dXJuO1xyXG4gIH1cclxuICBcclxuICB0cnkge1xyXG4gICAgc3RhcnRQcm9jZXNzaW5nKGVudGl0eVR5cGUsIGVudGl0eS5pZCk7XHJcbiAgICBcclxuICAgIHN3aXRjaCAoZW50aXR5VHlwZSkge1xyXG4gICAgICBjYXNlIEVudGl0eVR5cGUuVEFTSzpcclxuICAgICAgICBhd2FpdCBwcm9jZXNzVGFza0VmZmVjdHMoZW50aXR5IGFzIFRhc2spO1xyXG4gICAgICAgIGJyZWFrO1xyXG4gICAgICBjYXNlIEVudGl0eVR5cGUuSVRFTTpcclxuICAgICAgICBhd2FpdCBwcm9jZXNzSXRlbUVmZmVjdHMoZW50aXR5IGFzIEl0ZW0pO1xyXG4gICAgICAgIGJyZWFrO1xyXG4gICAgICBjYXNlIEVudGl0eVR5cGUuU0FMRTpcclxuICAgICAgICBhd2FpdCBwcm9jZXNzU2FsZUVmZmVjdHMoZW50aXR5IGFzIFNhbGUpO1xyXG4gICAgICAgIGJyZWFrO1xyXG4gICAgICBjYXNlIEVudGl0eVR5cGUuRklOQU5DSUFMOlxyXG4gICAgICAgIGF3YWl0IHByb2Nlc3NGaW5hbmNpYWxFZmZlY3RzKGVudGl0eSBhcyBGaW5hbmNpYWxSZWNvcmQpO1xyXG4gICAgICAgIGJyZWFrO1xyXG4gICAgICBjYXNlIEVudGl0eVR5cGUuQ0hBUkFDVEVSOlxyXG4gICAgICAgIGF3YWl0IHByb2Nlc3NDaGFyYWN0ZXJFZmZlY3RzKGVudGl0eSBhcyBDaGFyYWN0ZXIpO1xyXG4gICAgICAgIGJyZWFrO1xyXG4gICAgICBjYXNlIEVudGl0eVR5cGUuUExBWUVSOlxyXG4gICAgICAgIGF3YWl0IHByb2Nlc3NQbGF5ZXJFZmZlY3RzKGVudGl0eSBhcyBQbGF5ZXIpO1xyXG4gICAgICAgIGJyZWFrO1xyXG4gICAgICBjYXNlIEVudGl0eVR5cGUuU0lURTpcclxuICAgICAgICAvLyBTaXRlcyBkb24ndCBjcmVhdGUgbGlua3Mgd2hlbiBzYXZlZCAtIHRoZXkncmUgbGluayB0YXJnZXRzIG9ubHlcclxuICAgICAgICAvLyBTSVRFX1NJVEUgbGlua3MgY3JlYXRlZCBieSBtb3ZlbWVudCBvcGVyYXRpb25zICh3b3JrZmxvd3Mvc2l0ZS1tb3ZlbWVudC11dGlscy50cylcclxuICAgICAgICBicmVhaztcclxuICAgICAgZGVmYXVsdDpcclxuICAgICAgICByZXR1cm47XHJcbiAgICB9XHJcbiAgfSBmaW5hbGx5IHtcclxuICAgIGVuZFByb2Nlc3NpbmcoZW50aXR5VHlwZSwgZW50aXR5LmlkKTtcclxuICB9XHJcbn1cclxuXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBwcm9jZXNzVGFza0VmZmVjdHModGFzazogVGFzayk6IFByb21pc2U8dm9pZD4ge1xyXG4gIGlmICh0YXNrLnNpdGVJZCkge1xyXG4gICAgY29uc3QgbCA9IG1ha2VMaW5rKExpbmtUeXBlLlRBU0tfU0lURSwgeyB0eXBlOiBFbnRpdHlUeXBlLlRBU0ssIGlkOiB0YXNrLmlkIH0sIHsgdHlwZTogRW50aXR5VHlwZS5TSVRFLCBpZDogdGFzay5zaXRlSWQgfSk7XHJcbiAgICBhd2FpdCBjcmVhdGVMaW5rKGwpO1xyXG4gICAgYXdhaXQgYXBwZW5kTGlua0xvZyhsLCAnY3JlYXRlZCcpO1xyXG4gIH1cclxuICBpZiAodGFzay5vdXRwdXRJdGVtSWQpIHtcclxuICAgIGNvbnN0IGwgPSBtYWtlTGluayhMaW5rVHlwZS5UQVNLX0lURU0sIHsgdHlwZTogRW50aXR5VHlwZS5UQVNLLCBpZDogdGFzay5pZCB9LCB7IHR5cGU6IEVudGl0eVR5cGUuSVRFTSwgaWQ6IHRhc2sub3V0cHV0SXRlbUlkIH0pO1xyXG4gICAgYXdhaXQgY3JlYXRlTGluayhsKTtcclxuICAgIGF3YWl0IGFwcGVuZExpbmtMb2cobCwgJ2NyZWF0ZWQnKTtcclxuICB9XHJcbiAgXHJcbiAgLy8gVEFTS19DSEFSQUNURVIgbGlua1xyXG4gIGlmICh0YXNrLmNoYXJhY3RlcklkKSB7XHJcbiAgICBjb25zdCBsID0gbWFrZUxpbmsoXHJcbiAgICAgIExpbmtUeXBlLlRBU0tfQ0hBUkFDVEVSLFxyXG4gICAgICB7IHR5cGU6IEVudGl0eVR5cGUuVEFTSywgaWQ6IHRhc2suaWQgfSxcclxuICAgICAgeyB0eXBlOiBFbnRpdHlUeXBlLkNIQVJBQ1RFUiwgaWQ6IHRhc2suY2hhcmFjdGVySWQgfVxyXG4gICAgKTtcclxuICAgIGF3YWl0IGNyZWF0ZUxpbmsobCk7XHJcbiAgICBhd2FpdCBhcHBlbmRMaW5rTG9nKGwsICdjcmVhdGVkJyk7XHJcbiAgfVxyXG4gIFxyXG4gIC8vIENyZWF0ZSBUQVNLX0lURU0gbGluayBmb3IgaXRlbXMgY3JlYXRlZCBmcm9tIHRhc2sgZW1pc3NhcnkgZmllbGRzXHJcbiAgaWYgKHRhc2sub3V0cHV0SXRlbVR5cGUgJiYgdGFzay5vdXRwdXRRdWFudGl0eSAmJiB0YXNrLnN0YXR1cyA9PT0gJ0RvbmUnKSB7XHJcbiAgICAvLyBGaW5kIHRoZSBpdGVtIGNyZWF0ZWQgYnkgdGhpcyB0YXNrXHJcbiAgICBjb25zdCBpdGVtcyA9IGF3YWl0IGdldEFsbEl0ZW1zKCk7XHJcbiAgICBjb25zdCBjcmVhdGVkSXRlbSA9IGl0ZW1zLmZpbmQoaXRlbSA9PiBpdGVtLnNvdXJjZVRhc2tJZCA9PT0gdGFzay5pZCAmJiBpdGVtLnR5cGUgPT09IHRhc2sub3V0cHV0SXRlbVR5cGUpO1xyXG4gICAgXHJcbiAgICBpZiAoY3JlYXRlZEl0ZW0pIHtcclxuICAgICAgY29uc3QgbCA9IG1ha2VMaW5rKFxyXG4gICAgICAgIExpbmtUeXBlLlRBU0tfSVRFTSwgXHJcbiAgICAgICAgeyB0eXBlOiBFbnRpdHlUeXBlLlRBU0ssIGlkOiB0YXNrLmlkIH0sIFxyXG4gICAgICAgIHsgdHlwZTogRW50aXR5VHlwZS5JVEVNLCBpZDogY3JlYXRlZEl0ZW0uaWQgfSxcclxuICAgICAgICB7XHJcbiAgICAgICAgICBxdWFudGl0eTogdGFzay5vdXRwdXRRdWFudGl0eSxcclxuICAgICAgICAgIHVuaXRDb3N0OiB0YXNrLm91dHB1dFVuaXRDb3N0LFxyXG4gICAgICAgICAgcHJpY2U6IHRhc2sub3V0cHV0SXRlbVByaWNlLFxyXG4gICAgICAgICAgaXRlbVR5cGU6IHRhc2sub3V0cHV0SXRlbVR5cGVcclxuICAgICAgICB9XHJcbiAgICAgICk7XHJcbiAgICAgIGF3YWl0IGNyZWF0ZUxpbmsobCk7XHJcbiAgICAgIGF3YWl0IGFwcGVuZExpbmtMb2cobCwgJ2NyZWF0ZWQnKTtcclxuICAgIH1cclxuICB9XHJcbiAgXHJcbiAgLy8gTm90ZTogVEFTS19QTEFZRVIgaGFuZGxlZCBieSBwb2ludHMtcmV3YXJkcy11dGlscy50cyDinIVcclxuICAvLyBOb3RlOiBUQVNLX0ZJTlJFQyBoYW5kbGVkIGJ5IGZpbmFuY2lhbC1yZWNvcmQtdXRpbHMudHMg4pyFXHJcbn1cclxuXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBwcm9jZXNzSXRlbUVmZmVjdHMoaXRlbTogSXRlbSk6IFByb21pc2U8dm9pZD4ge1xyXG4gIGlmIChpdGVtLnNvdXJjZVRhc2tJZCkge1xyXG4gICAgY29uc3QgbCA9IG1ha2VMaW5rKExpbmtUeXBlLklURU1fVEFTSywgeyB0eXBlOiBFbnRpdHlUeXBlLklURU0sIGlkOiBpdGVtLmlkIH0sIHsgdHlwZTogRW50aXR5VHlwZS5UQVNLLCBpZDogaXRlbS5zb3VyY2VUYXNrSWQgfSk7XHJcbiAgICBhd2FpdCBjcmVhdGVMaW5rKGwpO1xyXG4gICAgYXdhaXQgYXBwZW5kTGlua0xvZyhsLCAnY3JlYXRlZCcpO1xyXG4gIH1cclxuICBmb3IgKGNvbnN0IHMgb2YgaXRlbS5zdG9jayB8fCBbXSkge1xyXG4gICAgaWYgKHMuc2l0ZUlkKSB7XHJcbiAgICAgIGNvbnN0IGwgPSBtYWtlTGluayhMaW5rVHlwZS5JVEVNX1NJVEUsIHsgdHlwZTogRW50aXR5VHlwZS5JVEVNLCBpZDogaXRlbS5pZCB9LCB7IHR5cGU6IEVudGl0eVR5cGUuU0lURSwgaWQ6IHMuc2l0ZUlkIH0pO1xyXG4gICAgICBhd2FpdCBjcmVhdGVMaW5rKGwpO1xyXG4gICAgICBhd2FpdCBhcHBlbmRMaW5rTG9nKGwsICdjcmVhdGVkJyk7XHJcbiAgICB9XHJcbiAgfVxyXG4gIFxyXG4gIC8vIElURU1fQ0hBUkFDVEVSIGxpbmtcclxuICBpZiAoaXRlbS5vd25lckNoYXJhY3RlcklkKSB7XHJcbiAgICBjb25zdCBsID0gbWFrZUxpbmsoXHJcbiAgICAgIExpbmtUeXBlLklURU1fQ0hBUkFDVEVSLFxyXG4gICAgICB7IHR5cGU6IEVudGl0eVR5cGUuSVRFTSwgaWQ6IGl0ZW0uaWQgfSxcclxuICAgICAgeyB0eXBlOiBFbnRpdHlUeXBlLkNIQVJBQ1RFUiwgaWQ6IGl0ZW0ub3duZXJDaGFyYWN0ZXJJZCB9XHJcbiAgICApO1xyXG4gICAgYXdhaXQgY3JlYXRlTGluayhsKTtcclxuICAgIGF3YWl0IGFwcGVuZExpbmtMb2cobCwgJ2NyZWF0ZWQnKTtcclxuICB9XHJcbiAgXHJcbiAgLy8gTm90ZTogSVRFTV9TQUxFIGxpbmtzIGhhbmRsZWQgaW4gcHJvY2Vzc1NhbGVFZmZlY3RzIChmcm9tIHNhbGUubGluZXMpXHJcbn1cclxuXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBwcm9jZXNzU2FsZUVmZmVjdHMoc2FsZTogU2FsZSk6IFByb21pc2U8dm9pZD4ge1xyXG4gIGlmIChzYWxlLnNpdGVJZCkge1xyXG4gICAgY29uc3QgbCA9IG1ha2VMaW5rKExpbmtUeXBlLlNBTEVfU0lURSwgeyB0eXBlOiBFbnRpdHlUeXBlLlNBTEUsIGlkOiBzYWxlLmlkIH0sIHsgdHlwZTogRW50aXR5VHlwZS5TSVRFLCBpZDogc2FsZS5zaXRlSWQgfSk7XHJcbiAgICBhd2FpdCBjcmVhdGVMaW5rKGwpO1xyXG4gICAgYXdhaXQgYXBwZW5kTGlua0xvZyhsLCAnY3JlYXRlZCcpO1xyXG4gIH1cclxuICBcclxuICAvLyBTQUxFX0NIQVJBQ1RFUiBsaW5rXHJcbiAgaWYgKHNhbGUuY3VzdG9tZXJJZCkge1xyXG4gICAgY29uc3QgbCA9IG1ha2VMaW5rKFxyXG4gICAgICBMaW5rVHlwZS5TQUxFX0NIQVJBQ1RFUixcclxuICAgICAgeyB0eXBlOiBFbnRpdHlUeXBlLlNBTEUsIGlkOiBzYWxlLmlkIH0sXHJcbiAgICAgIHsgdHlwZTogRW50aXR5VHlwZS5DSEFSQUNURVIsIGlkOiBzYWxlLmN1c3RvbWVySWQgfVxyXG4gICAgKTtcclxuICAgIGF3YWl0IGNyZWF0ZUxpbmsobCk7XHJcbiAgICBhd2FpdCBhcHBlbmRMaW5rTG9nKGwsICdjcmVhdGVkJyk7XHJcbiAgfVxyXG4gIFxyXG4gIC8vIFNBTEVfSVRFTSBsaW5rcyAoZnJvbSBzYWxlIGxpbmVzKVxyXG4gIGlmIChzYWxlLmxpbmVzICYmIHNhbGUubGluZXMubGVuZ3RoID4gMCkge1xyXG4gICAgZm9yIChjb25zdCBsaW5lIG9mIHNhbGUubGluZXMpIHtcclxuICAgICAgaWYgKGxpbmUua2luZCA9PT0gJ2l0ZW0nICYmIGxpbmUuaXRlbUlkKSB7XHJcbiAgICAgICAgY29uc3QgbCA9IG1ha2VMaW5rKFxyXG4gICAgICAgICAgTGlua1R5cGUuU0FMRV9JVEVNLFxyXG4gICAgICAgICAgeyB0eXBlOiBFbnRpdHlUeXBlLlNBTEUsIGlkOiBzYWxlLmlkIH0sXHJcbiAgICAgICAgICB7IHR5cGU6IEVudGl0eVR5cGUuSVRFTSwgaWQ6IGxpbmUuaXRlbUlkIH0sXHJcbiAgICAgICAgICB7IHF1YW50aXR5OiBsaW5lLnF1YW50aXR5LCB1bml0UHJpY2U6IGxpbmUudW5pdFByaWNlIH1cclxuICAgICAgICApO1xyXG4gICAgICAgIGF3YWl0IGNyZWF0ZUxpbmsobCk7XHJcbiAgICAgICAgYXdhaXQgYXBwZW5kTGlua0xvZyhsLCAnY3JlYXRlZCcpO1xyXG4gICAgICB9XHJcbiAgICB9XHJcbiAgfVxyXG4gIFxyXG4gIC8vIFNBTEVfVEFTSyBsaW5rIChpZiBzYWxlIHNwYXduZWQgZnJvbSB0YXNrKVxyXG4gIGlmIChzYWxlLnNvdXJjZVRhc2tJZCkge1xyXG4gICAgY29uc3QgbCA9IG1ha2VMaW5rKFxyXG4gICAgICBMaW5rVHlwZS5TQUxFX1RBU0ssXHJcbiAgICAgIHsgdHlwZTogRW50aXR5VHlwZS5TQUxFLCBpZDogc2FsZS5pZCB9LFxyXG4gICAgICB7IHR5cGU6IEVudGl0eVR5cGUuVEFTSywgaWQ6IHNhbGUuc291cmNlVGFza0lkIH1cclxuICAgICk7XHJcbiAgICBhd2FpdCBjcmVhdGVMaW5rKGwpO1xyXG4gICAgYXdhaXQgYXBwZW5kTGlua0xvZyhsLCAnY3JlYXRlZCcpO1xyXG4gIH1cclxuICBcclxuICAvLyBOb3RlOiBTQUxFX1BMQVlFUiBoYW5kbGVkIGJ5IHBvaW50cy1yZXdhcmRzLXV0aWxzLnRzIOKchVxyXG59XHJcblxyXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gcHJvY2Vzc0ZpbmFuY2lhbEVmZmVjdHMoZmluOiBGaW5hbmNpYWxSZWNvcmQpOiBQcm9taXNlPHZvaWQ+IHtcclxuICBpZiAoZmluLnNpdGVJZCkge1xyXG4gICAgY29uc3QgbCA9IG1ha2VMaW5rKExpbmtUeXBlLkZJTlJFQ19TSVRFLCB7IHR5cGU6IEVudGl0eVR5cGUuRklOQU5DSUFMLCBpZDogZmluLmlkIH0sIHsgdHlwZTogRW50aXR5VHlwZS5TSVRFLCBpZDogZmluLnNpdGVJZCB9KTtcclxuICAgIGF3YWl0IGNyZWF0ZUxpbmsobCk7XHJcbiAgICBhd2FpdCBhcHBlbmRMaW5rTG9nKGwsICdjcmVhdGVkJyk7XHJcbiAgfVxyXG4gIFxyXG4gIC8vIEZJTlJFQ19DSEFSQUNURVIgbGlua1xyXG4gIGlmIChmaW4uY3VzdG9tZXJDaGFyYWN0ZXJJZCkge1xyXG4gICAgY29uc3QgbCA9IG1ha2VMaW5rKFxyXG4gICAgICBMaW5rVHlwZS5GSU5SRUNfQ0hBUkFDVEVSLFxyXG4gICAgICB7IHR5cGU6IEVudGl0eVR5cGUuRklOQU5DSUFMLCBpZDogZmluLmlkIH0sXHJcbiAgICAgIHsgdHlwZTogRW50aXR5VHlwZS5DSEFSQUNURVIsIGlkOiBmaW4uY3VzdG9tZXJDaGFyYWN0ZXJJZCB9XHJcbiAgICApO1xyXG4gICAgYXdhaXQgY3JlYXRlTGluayhsKTtcclxuICAgIGF3YWl0IGFwcGVuZExpbmtMb2cobCwgJ2NyZWF0ZWQnKTtcclxuICB9XHJcbiAgXHJcbiAgLy8gQ3JlYXRlIEZJTlJFQ19JVEVNIGxpbmsgZm9yIGl0ZW1zIGNyZWF0ZWQgZnJvbSBmaW5hbmNpYWwgcmVjb3JkIGVtaXNzYXJ5IGZpZWxkc1xyXG4gIGlmIChmaW4ub3V0cHV0SXRlbVR5cGUgJiYgZmluLm91dHB1dFF1YW50aXR5KSB7XHJcbiAgICAvLyBGaW5kIHRoZSBpdGVtIGNyZWF0ZWQgYnkgdGhpcyBmaW5hbmNpYWwgcmVjb3JkXHJcbiAgICBjb25zdCBpdGVtcyA9IGF3YWl0IGdldEFsbEl0ZW1zKCk7XHJcbiAgICBjb25zdCBjcmVhdGVkSXRlbSA9IGl0ZW1zLmZpbmQoaXRlbSA9PiBpdGVtLnNvdXJjZVJlY29yZElkID09PSBmaW4uaWQgJiYgaXRlbS50eXBlID09PSBmaW4ub3V0cHV0SXRlbVR5cGUpO1xyXG4gICAgXHJcbiAgICBpZiAoY3JlYXRlZEl0ZW0pIHtcclxuICAgICAgY29uc3QgbCA9IG1ha2VMaW5rKFxyXG4gICAgICAgIExpbmtUeXBlLkZJTlJFQ19JVEVNLCBcclxuICAgICAgICB7IHR5cGU6IEVudGl0eVR5cGUuRklOQU5DSUFMLCBpZDogZmluLmlkIH0sIFxyXG4gICAgICAgIHsgdHlwZTogRW50aXR5VHlwZS5JVEVNLCBpZDogY3JlYXRlZEl0ZW0uaWQgfSxcclxuICAgICAgICB7XHJcbiAgICAgICAgICBxdWFudGl0eTogZmluLm91dHB1dFF1YW50aXR5LFxyXG4gICAgICAgICAgdW5pdENvc3Q6IGZpbi5vdXRwdXRVbml0Q29zdCxcclxuICAgICAgICAgIHByaWNlOiBmaW4ub3V0cHV0SXRlbVByaWNlLFxyXG4gICAgICAgICAgaXRlbVR5cGU6IGZpbi5vdXRwdXRJdGVtVHlwZVxyXG4gICAgICAgIH1cclxuICAgICAgKTtcclxuICAgICAgYXdhaXQgY3JlYXRlTGluayhsKTtcclxuICAgICAgYXdhaXQgYXBwZW5kTGlua0xvZyhsLCAnY3JlYXRlZCcpO1xyXG4gICAgfVxyXG4gIH1cclxuICBcclxuICAvLyBOb3RlOiBGSU5SRUNfVEFTSyBoYW5kbGVkIGJ5IGZpbmFuY2lhbC1yZWNvcmQtdXRpbHMudHMg4pyFXHJcbiAgLy8gTm90ZTogRklOUkVDX1BMQVlFUiBoYW5kbGVkIGJ5IHBvaW50cy1yZXdhcmRzLXV0aWxzLnRzIOKchVxyXG59XHJcblxyXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gcHJvY2Vzc0NoYXJhY3RlckVmZmVjdHMoY2hhcmFjdGVyOiBDaGFyYWN0ZXIpOiBQcm9taXNlPHZvaWQ+IHtcclxuICAvLyBDSEFSQUNURVJfUExBWUVSIGxpbmtcclxuICBpZiAoY2hhcmFjdGVyLnBsYXllcklkKSB7XHJcbiAgICBjb25zdCBsaW5rID0gbWFrZUxpbmsoXHJcbiAgICAgIExpbmtUeXBlLkNIQVJBQ1RFUl9QTEFZRVIsXHJcbiAgICAgIHsgdHlwZTogRW50aXR5VHlwZS5DSEFSQUNURVIsIGlkOiBjaGFyYWN0ZXIuaWQgfSxcclxuICAgICAgeyB0eXBlOiBFbnRpdHlUeXBlLlBMQVlFUiwgaWQ6IGNoYXJhY3Rlci5wbGF5ZXJJZCB9XHJcbiAgICApO1xyXG4gICAgYXdhaXQgY3JlYXRlTGluayhsaW5rKTtcclxuICAgIGF3YWl0IGFwcGVuZExpbmtMb2cobGluaywgJ2NyZWF0ZWQnKTtcclxuICB9XHJcbiAgXHJcbiAgLy8gQ0hBUkFDVEVSX1NJVEUgbGluayAoaWYgY2hhcmFjdGVyIGhhcyBob21lIHNpdGUpXHJcbiAgaWYgKGNoYXJhY3Rlci5zaXRlSWQpIHtcclxuICAgIGNvbnN0IGxpbmsgPSBtYWtlTGluayhcclxuICAgICAgTGlua1R5cGUuQ0hBUkFDVEVSX1NJVEUsXHJcbiAgICAgIHsgdHlwZTogRW50aXR5VHlwZS5DSEFSQUNURVIsIGlkOiBjaGFyYWN0ZXIuaWQgfSxcclxuICAgICAgeyB0eXBlOiBFbnRpdHlUeXBlLlNJVEUsIGlkOiBjaGFyYWN0ZXIuc2l0ZUlkIH1cclxuICAgICk7XHJcbiAgICBhd2FpdCBjcmVhdGVMaW5rKGxpbmspO1xyXG4gICAgYXdhaXQgYXBwZW5kTGlua0xvZyhsaW5rLCAnY3JlYXRlZCcpO1xyXG4gIH1cclxufVxyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIHByb2Nlc3NQbGF5ZXJFZmZlY3RzKHBsYXllcjogUGxheWVyKTogUHJvbWlzZTx2b2lkPiB7XHJcbiAgLy8gUExBWUVSX0NIQVJBQ1RFUiBsaW5rcyAoYXJyYXkgb2YgY2hhcmFjdGVycylcclxuICBpZiAocGxheWVyLmNoYXJhY3RlcklkcyAmJiBwbGF5ZXIuY2hhcmFjdGVySWRzLmxlbmd0aCA+IDApIHtcclxuICAgIGZvciAoY29uc3QgY2hhcmFjdGVySWQgb2YgcGxheWVyLmNoYXJhY3Rlcklkcykge1xyXG4gICAgICBjb25zdCBsaW5rID0gbWFrZUxpbmsoXHJcbiAgICAgICAgTGlua1R5cGUuUExBWUVSX0NIQVJBQ1RFUixcclxuICAgICAgICB7IHR5cGU6IEVudGl0eVR5cGUuUExBWUVSLCBpZDogcGxheWVyLmlkIH0sXHJcbiAgICAgICAgeyB0eXBlOiBFbnRpdHlUeXBlLkNIQVJBQ1RFUiwgaWQ6IGNoYXJhY3RlcklkIH1cclxuICAgICAgKTtcclxuICAgICAgYXdhaXQgY3JlYXRlTGluayhsaW5rKTtcclxuICAgICAgYXdhaXQgYXBwZW5kTGlua0xvZyhsaW5rLCAnY3JlYXRlZCcpO1xyXG4gICAgfVxyXG4gIH1cclxuICBcclxuICAvLyBOb3RlOiBQTEFZRVJfU0lURSBsaW5rcyBub3QgaW1wbGVtZW50ZWQgLSBQbGF5ZXIgZG9lc24ndCBoYXZlIHNpdGVJZCBmaWVsZFxyXG59XHJcblxyXG4vLyBTaXRlcyBkb24ndCBjcmVhdGUgbGlua3Mgd2hlbiBzYXZlZCAtIHRoZXkncmUgcHJpbWFyaWx5IGxpbmsgdGFyZ2V0c1xyXG4vLyBTSVRFX1NJVEUgbGlua3MgYXJlIGNyZWF0ZWQgYnkgbW92ZW1lbnQgb3BlcmF0aW9ucyAoc2VlIHdvcmtmbG93cy9zaXRlLW1vdmVtZW50LXV0aWxzLnRzKVxyXG4vLyBObyBwcm9jZXNzU2l0ZUVmZmVjdHMgZnVuY3Rpb24gbmVlZGVkIC0gc2l0ZXMgaGF2ZSBubyBsaW5rLWNyZWF0aW5nIHByb3BlcnRpZXNcclxuXHJcblxyXG4iXSwibmFtZXMiOlsiRW50aXR5VHlwZSIsIkxpbmtUeXBlIiwiY3JlYXRlTGluayIsImFwcGVuZExpbmtMb2ciLCJnZXRBbGxJdGVtcyIsInY0IiwidXVpZCIsImlzUHJvY2Vzc2luZyIsInN0YXJ0UHJvY2Vzc2luZyIsImVuZFByb2Nlc3NpbmciLCJtYWtlTGluayIsImxpbmtUeXBlIiwic291cmNlIiwidGFyZ2V0IiwibWV0YWRhdGEiLCJpZCIsImNyZWF0ZWRBdCIsIkRhdGUiLCJwcm9jZXNzTGlua0VudGl0eSIsImVudGl0eSIsImVudGl0eVR5cGUiLCJjb25zb2xlIiwid2FybiIsIlRBU0siLCJwcm9jZXNzVGFza0VmZmVjdHMiLCJJVEVNIiwicHJvY2Vzc0l0ZW1FZmZlY3RzIiwiU0FMRSIsInByb2Nlc3NTYWxlRWZmZWN0cyIsIkZJTkFOQ0lBTCIsInByb2Nlc3NGaW5hbmNpYWxFZmZlY3RzIiwiQ0hBUkFDVEVSIiwicHJvY2Vzc0NoYXJhY3RlckVmZmVjdHMiLCJQTEFZRVIiLCJwcm9jZXNzUGxheWVyRWZmZWN0cyIsIlNJVEUiLCJ0YXNrIiwic2l0ZUlkIiwibCIsIlRBU0tfU0lURSIsInR5cGUiLCJvdXRwdXRJdGVtSWQiLCJUQVNLX0lURU0iLCJjaGFyYWN0ZXJJZCIsIlRBU0tfQ0hBUkFDVEVSIiwib3V0cHV0SXRlbVR5cGUiLCJvdXRwdXRRdWFudGl0eSIsInN0YXR1cyIsIml0ZW1zIiwiY3JlYXRlZEl0ZW0iLCJmaW5kIiwiaXRlbSIsInNvdXJjZVRhc2tJZCIsInF1YW50aXR5IiwidW5pdENvc3QiLCJvdXRwdXRVbml0Q29zdCIsInByaWNlIiwib3V0cHV0SXRlbVByaWNlIiwiaXRlbVR5cGUiLCJJVEVNX1RBU0siLCJzIiwic3RvY2siLCJJVEVNX1NJVEUiLCJvd25lckNoYXJhY3RlcklkIiwiSVRFTV9DSEFSQUNURVIiLCJzYWxlIiwiU0FMRV9TSVRFIiwiY3VzdG9tZXJJZCIsIlNBTEVfQ0hBUkFDVEVSIiwibGluZXMiLCJsZW5ndGgiLCJsaW5lIiwia2luZCIsIml0ZW1JZCIsIlNBTEVfSVRFTSIsInVuaXRQcmljZSIsIlNBTEVfVEFTSyIsImZpbiIsIkZJTlJFQ19TSVRFIiwiY3VzdG9tZXJDaGFyYWN0ZXJJZCIsIkZJTlJFQ19DSEFSQUNURVIiLCJzb3VyY2VSZWNvcmRJZCIsIkZJTlJFQ19JVEVNIiwiY2hhcmFjdGVyIiwicGxheWVySWQiLCJsaW5rIiwiQ0hBUkFDVEVSX1BMQVlFUiIsIkNIQVJBQ1RFUl9TSVRFIiwicGxheWVyIiwiY2hhcmFjdGVySWRzIiwiUExBWUVSX0NIQVJBQ1RFUiJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./links/links-workflows.ts\n");

/***/ }),

/***/ "(rsc)/./types/enums.ts":
/*!************************!*\
  !*** ./types/enums.ts ***!
  \************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   ALL_AREAS: () => (/* binding */ ALL_AREAS),\n/* harmony export */   Attribute: () => (/* binding */ Attribute),\n/* harmony export */   BUSINESS_STRUCTURE: () => (/* binding */ BUSINESS_STRUCTURE),\n/* harmony export */   CHARACTER_ROLE_TYPES: () => (/* binding */ CHARACTER_ROLE_TYPES),\n/* harmony export */   COMPANY_AREAS: () => (/* binding */ COMPANY_AREAS),\n/* harmony export */   CharacterRole: () => (/* binding */ CharacterRole),\n/* harmony export */   CloudSiteType: () => (/* binding */ CloudSiteType),\n/* harmony export */   Collection: () => (/* binding */ Collection),\n/* harmony export */   CommColor: () => (/* binding */ CommColor),\n/* harmony export */   Currency: () => (/* binding */ Currency),\n/* harmony export */   DevSprintStatus: () => (/* binding */ DevSprintStatus),\n/* harmony export */   EntityType: () => (/* binding */ EntityType),\n/* harmony export */   FinancialStatus: () => (/* binding */ FinancialStatus),\n/* harmony export */   ITEM_CATEGORIES: () => (/* binding */ ITEM_CATEGORIES),\n/* harmony export */   IntelectualFunction: () => (/* binding */ IntelectualFunction),\n/* harmony export */   InventoryTab: () => (/* binding */ InventoryTab),\n/* harmony export */   ItemCategory: () => (/* binding */ ItemCategory),\n/* harmony export */   ItemStatus: () => (/* binding */ ItemStatus),\n/* harmony export */   ItemType: () => (/* binding */ ItemType),\n/* harmony export */   LOCATION_HIERARCHY: () => (/* binding */ LOCATION_HIERARCHY),\n/* harmony export */   LOCATION_STRUCTURE: () => (/* binding */ LOCATION_STRUCTURE),\n/* harmony export */   LinkType: () => (/* binding */ LinkType),\n/* harmony export */   NOTE_TAGS: () => (/* binding */ NOTE_TAGS),\n/* harmony export */   NoteColor: () => (/* binding */ NoteColor),\n/* harmony export */   NotebookType: () => (/* binding */ NotebookType),\n/* harmony export */   PAYMENT_METHOD_CATEGORIES: () => (/* binding */ PAYMENT_METHOD_CATEGORIES),\n/* harmony export */   PERSONAL_AREAS: () => (/* binding */ PERSONAL_AREAS),\n/* harmony export */   PaymentMethod: () => (/* binding */ PaymentMethod),\n/* harmony export */   PhysicalBusinessType: () => (/* binding */ PhysicalBusinessType),\n/* harmony export */   PointType: () => (/* binding */ PointType),\n/* harmony export */   RecurrentFrequency: () => (/* binding */ RecurrentFrequency),\n/* harmony export */   SITE_CATEGORIES: () => (/* binding */ SITE_CATEGORIES),\n/* harmony export */   SITE_GROUPS: () => (/* binding */ SITE_GROUPS),\n/* harmony export */   SKILLS_CATEGORIES: () => (/* binding */ SKILLS_CATEGORIES),\n/* harmony export */   STATION_CATEGORIES: () => (/* binding */ STATION_CATEGORIES),\n/* harmony export */   SaleStatus: () => (/* binding */ SaleStatus),\n/* harmony export */   SaleType: () => (/* binding */ SaleType),\n/* harmony export */   SalesSessionStatus: () => (/* binding */ SalesSessionStatus),\n/* harmony export */   SiteStatus: () => (/* binding */ SiteStatus),\n/* harmony export */   SiteType: () => (/* binding */ SiteType),\n/* harmony export */   Skill: () => (/* binding */ Skill),\n/* harmony export */   SpecialSiteType: () => (/* binding */ SpecialSiteType),\n/* harmony export */   TASK_CATEGORIES: () => (/* binding */ TASK_CATEGORIES),\n/* harmony export */   TaskPriority: () => (/* binding */ TaskPriority),\n/* harmony export */   TaskStatus: () => (/* binding */ TaskStatus),\n/* harmony export */   TaskType: () => (/* binding */ TaskType)\n/* harmony export */ });\n// types/enums.ts\n// All enums and constants - single source of truth for application state\n// ============================================================================\n// BUSINESS STRUCTURE - Single source of truth for sections and stations\n// ============================================================================\n/** Business Structure - Single source of truth for sections and stations */ const BUSINESS_STRUCTURE = {\n    ADMIN: [\n        \"Strategy\",\n        \"Projects\",\n        \"Inventory\",\n        \"Transport\",\n        \"Team\",\n        \"Materials\",\n        \"Equipment\",\n        \"Rent\",\n        \"Director\"\n    ],\n    RESEARCH: [\n        \"Classes\",\n        \"Studies\",\n        \"Development\"\n    ],\n    DESIGN: [\n        \"Digital Art\",\n        \"Art Creative Processes\",\n        \"Game Design\",\n        \"3D Modeling\",\n        \"Animation\"\n    ],\n    PRODUCTION: [\n        \"Artworks\",\n        \"Murals\",\n        \"Prints\",\n        \"Stickers\",\n        \"Merch\",\n        \"Woodworks\",\n        \"NFTs\"\n    ],\n    SALES: [\n        \"Direct Sales\",\n        \"Feria Sales\",\n        \"Network Sales\",\n        \"Online Sales\",\n        \"Store Sales\",\n        \"Marketing\",\n        \"Bookings\",\n        \"Other Sales\"\n    ],\n    PERSONAL: [\n        \"Health\",\n        \"Family\",\n        \"Food\",\n        \"Home\",\n        \"Transport P\",\n        \"Rent P\",\n        \"Other P\"\n    ]\n};\n// Areas (top-level business areas)\nconst COMPANY_AREAS = [\n    \"ADMIN\",\n    \"RESEARCH\",\n    \"DESIGN\",\n    \"PRODUCTION\",\n    \"SALES\"\n];\nconst PERSONAL_AREAS = [\n    \"PERSONAL\"\n];\nconst ALL_AREAS = [\n    ...COMPANY_AREAS,\n    ...PERSONAL_AREAS\n];\n// ============================================================================\n// STATION CATEGORIES - Derived from BUSINESS_STRUCTURE for SearchableSelect\n// ============================================================================\n/** Station categories for SearchableSelect grouping - derived from BUSINESS_STRUCTURE */ const STATION_CATEGORIES = {\n    ADMIN: BUSINESS_STRUCTURE.ADMIN,\n    RESEARCH: BUSINESS_STRUCTURE.RESEARCH,\n    DESIGN: BUSINESS_STRUCTURE.DESIGN,\n    PRODUCTION: BUSINESS_STRUCTURE.PRODUCTION,\n    SALES: BUSINESS_STRUCTURE.SALES,\n    PERSONAL: BUSINESS_STRUCTURE.PERSONAL\n};\n// ============================================================================\n// LOCATION STRUCTURE\n// ============================================================================\n/** Geographic Location Structure - Single source of truth for geographic hierarchy */ const LOCATION_STRUCTURE = {\n    \"North America\": {\n        \"United States\": [\n            \"United States\"\n        ],\n        \"Canada\": [\n            \"Canada\"\n        ]\n    },\n    \"Central America\": {\n        \"Costa Rica\": [\n            \"Puntarenas\",\n            \"San Jose\",\n            \"Guanacaste\",\n            \"Limon\"\n        ],\n        \"Panama\": [\n            \"Panama\"\n        ],\n        \"Nicaragua\": [\n            \"Nicaragua\"\n        ],\n        \"El Salvador\": [\n            \"El Salvador\"\n        ]\n    },\n    \"South America\": {\n        \"Venezuela\": [\n            \"Margarita Island\",\n            \"Caracas\"\n        ],\n        \"Colombia\": [\n            \"Bogota\"\n        ],\n        \"Uruguay\": [\n            \"Montevideo\"\n        ],\n        \"Chile\": [\n            \"Santiago\"\n        ],\n        \"Argentina\": [\n            \"Buenos Aires\"\n        ],\n        \"Brasil\": [\n            \"Rio de Janeiro\"\n        ],\n        \"Peru\": [\n            \"Lima\"\n        ]\n    }\n};\n// Export the structure for components to use\nconst LOCATION_HIERARCHY = LOCATION_STRUCTURE;\nvar PhysicalBusinessType;\n(function(PhysicalBusinessType) {\n    PhysicalBusinessType[\"STORAGE\"] = \"storage\";\n    PhysicalBusinessType[\"CONSIGNMENT\"] = \"consignment\";\n    PhysicalBusinessType[\"SELLING_POINT\"] = \"selling point\";\n    PhysicalBusinessType[\"FERIA\"] = \"feria\";\n    PhysicalBusinessType[\"TEACHING_SPACE\"] = \"teaching space\";\n    PhysicalBusinessType[\"HQ\"] = \"HQ\";\n    PhysicalBusinessType[\"ART_GALLERY\"] = \"art gallery\";\n    PhysicalBusinessType[\"DESIGN_SPACE\"] = \"design space\";\n    PhysicalBusinessType[\"WORKSHOP\"] = \"workshop\"; // Production sites for creating items\n})(PhysicalBusinessType || (PhysicalBusinessType = {}));\nvar CloudSiteType;\n(function(CloudSiteType) {\n    CloudSiteType[\"REPOSITORY\"] = \"repository\";\n    CloudSiteType[\"DIGITAL_STORAGE\"] = \"digital storage\";\n    CloudSiteType[\"NFT_WALLET\"] = \"nft wallet\"; // NFt assets\n})(CloudSiteType || (CloudSiteType = {}));\nvar SpecialSiteType;\n(function(SpecialSiteType) {\n    SpecialSiteType[\"UNIVERSAL_TRACKING\"] = \"universal tracking\";\n    SpecialSiteType[\"SOLD_ITEMS\"] = \"sold items\";\n    SpecialSiteType[\"ARCHIVED\"] = \"archived\";\n    SpecialSiteType[\"DELETED\"] = \"deleted\"; // Deleted items\n})(SpecialSiteType || (SpecialSiteType = {}));\nvar SiteType;\n(function(SiteType) {\n    SiteType[\"PHYSICAL\"] = \"PHYSICAL\";\n    SiteType[\"CLOUD\"] = \"CLOUD\";\n    SiteType[\"SPECIAL\"] = \"SPECIAL\"; // Special system-managed locations\n})(SiteType || (SiteType = {}));\nvar SiteStatus;\n(function(SiteStatus) {\n    SiteStatus[\"CREATED\"] = \"Created\";\n    SiteStatus[\"ACTIVE\"] = \"Active\";\n    SiteStatus[\"UPDATED\"] = \"Updated\";\n    SiteStatus[\"INACTIVE\"] = \"Inactive\";\n})(SiteStatus || (SiteStatus = {}));\n/** Site Structure - Single source of truth for sites and their types */ const SITE_STRUCTURE = {\n    PHYSICAL: {\n        HOME: \"Home\",\n        FERIA_BOX: \"Feria Box\",\n        SMOKING_LOUNGE: \"Smoking Lounge\",\n        TAGUA: \"Tagua\",\n        CAFE_VIVO: \"Cafe Vivo\",\n        XIVA: \"Xiva\",\n        PEREZOSO_FELIZ: \"Perezoso Feliz\",\n        EL_HORNITO: \"El Hornito\",\n        JUNGLE_ACADEMY: \"Jungle Academy\",\n        LA_TRIBU: \"La Tribu\",\n        OSA_DE_RIO: \"Osa de Rio\",\n        GALLERY_1084: \"Gallery 1084\",\n        CAT_CAFE: \"Cat Cafe\",\n        ECO_FERIA: \"Eco Feria\",\n        ESCUELA_VERDE: \"Escuela Verde\",\n        PRINT_MASTERS: \"Print Masters\"\n    },\n    CLOUD: {\n        DIGITAL_SPACE: \"Digital Space\",\n        DESKTOP_PC: \"Desktop PC\",\n        LAPTOP: \"Laptop\",\n        GOOGLE_DRIVE: \"Google Drive\",\n        GITHUB: \"Github\",\n        MAGIC_EDEN: \"Magic Eden\",\n        OPENSEA: \"OpenSea\"\n    },\n    SPECIAL: {\n        NONE: \"None\",\n        WORLD: \"World\",\n        SOLD_ITEMS_THIS_MONTH: \"Sold Items\",\n        ARCHIVED_HISTORICAL: \"Archived\",\n        DELETED_ITEMS_THIS_MONTH: \"Deleted Items\"\n    }\n};\n// Export the structure for components to use\nconst SITE_GROUPS = SITE_STRUCTURE;\n/** Site categories for UI organization and SearchableSelect grouping */ const SITE_CATEGORIES = {\n    PHYSICAL: [\n        \"HOME\",\n        \"FERIA_BOX\",\n        \"SMOKING_LOUNGE\",\n        \"TAGUA\",\n        \"CAFE_VIVO\",\n        \"XIVA\",\n        \"PEREZOSO_FELIZ\",\n        \"EL_HORNITO\",\n        \"JUNGLE_ACADEMY\",\n        \"LA_TRIBU\",\n        \"OSA_DE_RIO\",\n        \"GALLERY_1084\",\n        \"CAT_CAFE\",\n        \"ECO_FERIA\",\n        \"ESCUELA_VERDE\",\n        \"PRINT_MASTERS\"\n    ],\n    CLOUD: [\n        \"DIGITAL_SPACE\",\n        \"DESKTOP_PC\",\n        \"LAPTOP\",\n        \"GOOGLE_DRIVE\",\n        \"GITHUB\",\n        \"MAGIC_EDEN\",\n        \"OPENSEA\"\n    ],\n    SPECIAL: [\n        \"NONE\",\n        \"WORLD\",\n        \"SOLD_ITEMS_THIS_MONTH\",\n        \"ARCHIVED_HISTORICAL\",\n        \"DELETED_ITEMS_THIS_MONTH\"\n    ]\n};\nvar TaskType;\n(function(TaskType) {\n    TaskType[\"MISSION\"] = \"Mission\";\n    TaskType[\"MILESTONE\"] = \"Milestone\";\n    TaskType[\"GOAL\"] = \"Goal\";\n    TaskType[\"ASSIGNMENT\"] = \"Assignment\";\n    TaskType[\"RECURRENT_PARENT\"] = \"Recurrent Parent\";\n    TaskType[\"RECURRENT_TEMPLATE\"] = \"Recurrent Template\";\n    TaskType[\"RECURRENT_INSTANCE\"] = \"Recurrent Instance\"; // NEW: Spawned with due date\n})(TaskType || (TaskType = {}));\n/** Task categories for UI organization and SearchableSelect grouping */ const TASK_CATEGORIES = {\n    MISSION: [\n        \"Mission\",\n        \"Milestone\",\n        \"Goal\",\n        \"Assignment\"\n    ],\n    RECURRENT: [\n        \"Recurrent Parent\",\n        \"Recurrent Template\",\n        \"Recurrent Instance\"\n    ]\n};\nvar RecurrentFrequency;\n(function(RecurrentFrequency) {\n    RecurrentFrequency[\"ONCE\"] = \"Once\";\n    RecurrentFrequency[\"DAILY\"] = \"Daily\";\n    RecurrentFrequency[\"WEEKLY\"] = \"Weekly\";\n    RecurrentFrequency[\"MONTHLY\"] = \"Monthly\";\n    RecurrentFrequency[\"CUSTOM\"] = \"Custom\";\n    RecurrentFrequency[\"ALWAYS\"] = \"Always\";\n})(RecurrentFrequency || (RecurrentFrequency = {}));\nvar TaskStatus;\n(function(TaskStatus) {\n    TaskStatus[\"CREATED\"] = \"Created\";\n    TaskStatus[\"ON_HOLD\"] = \"On Hold\";\n    TaskStatus[\"IN_PROGRESS\"] = \"In Progress\";\n    TaskStatus[\"FINISHING\"] = \"Finishing\";\n    TaskStatus[\"DONE\"] = \"Done\";\n    TaskStatus[\"COLLECTED\"] = \"Collected\";\n    TaskStatus[\"FAILED\"] = \"Failed\";\n    TaskStatus[\"NONE\"] = \"None\";\n})(TaskStatus || (TaskStatus = {}));\nvar TaskPriority;\n(function(TaskPriority) {\n    TaskPriority[\"NOT_NOW\"] = \"Not Now\";\n    TaskPriority[\"SLOW\"] = \"Slow\";\n    TaskPriority[\"NORMAL\"] = \"Normal\";\n    TaskPriority[\"IMPORTANT\"] = \"Important\";\n    TaskPriority[\"URGENT\"] = \"Urgent\";\n})(TaskPriority || (TaskPriority = {}));\nvar FinancialStatus;\n(function(FinancialStatus) {\n    FinancialStatus[\"DONE\"] = \"Done\";\n    FinancialStatus[\"COLLECTED\"] = \"Collected\";\n})(FinancialStatus || (FinancialStatus = {}));\nvar DevSprintStatus;\n(function(DevSprintStatus) {\n    DevSprintStatus[\"NOT_STARTED\"] = \"Not Started\";\n    DevSprintStatus[\"IN_PROGRESS\"] = \"In Progress\";\n    DevSprintStatus[\"DONE\"] = \"Done\";\n})(DevSprintStatus || (DevSprintStatus = {}));\nvar PointType;\n(function(PointType) {\n    PointType[\"XP\"] = \"XP\";\n    PointType[\"RP\"] = \"RP\";\n    PointType[\"FP\"] = \"FP\";\n    PointType[\"HP\"] = \"HP\";\n})(PointType || (PointType = {}));\nvar Currency;\n(function(Currency) {\n    Currency[\"USD\"] = \"USD\";\n    Currency[\"JUNGLE_COINS\"] = \"J$\";\n    Currency[\"BTC\"] = \"BTC\";\n    Currency[\"CRC\"] = \"CRC\";\n})(Currency || (Currency = {}));\nvar ItemType;\n(function(ItemType) {\n    // MODEL_ITEM - Individual products that can be separated by model, subtype, site and collection\n    ItemType[\"DIGITAL\"] = \"Digital\";\n    ItemType[\"ARTWORK\"] = \"Artwork\";\n    ItemType[\"PRINT\"] = \"Print\";\n    ItemType[\"STICKER\"] = \"Sticker\";\n    ItemType[\"MERCH\"] = \"Merch\";\n    // BUNDLE_ITEM - Business Logic Items that are Packs of the same Type of Item\n    ItemType[\"STICKER_BUNDLE\"] = \"Sticker Bundle\";\n    ItemType[\"PRINT_BUNDLE\"] = \"Print Bundle\";\n    // RESOURCE_ITEM - Materials and Equipment for production\n    ItemType[\"MATERIAL\"] = \"Material\";\n    ItemType[\"EQUIPMENT\"] = \"Equipment\";\n})(ItemType || (ItemType = {}));\nvar ItemCategory;\n(function(ItemCategory) {\n    ItemCategory[\"MODEL_ITEM\"] = \"MODEL_ITEM\";\n    ItemCategory[\"BUNDLE_ITEM\"] = \"BUNDLE_ITEM\";\n    ItemCategory[\"RESOURCE_ITEM\"] = \"RESOURCE_ITEM\";\n})(ItemCategory || (ItemCategory = {}));\nvar InventoryTab;\n(function(InventoryTab) {\n    // MODEL_ITEM tabs\n    InventoryTab[\"DIGITAL\"] = \"digital\";\n    InventoryTab[\"ARTWORKS\"] = \"artworks\";\n    InventoryTab[\"STICKERS\"] = \"stickers\";\n    InventoryTab[\"PRINTS\"] = \"prints\";\n    InventoryTab[\"MERCH\"] = \"merch\";\n    // BUNDLE_ITEM tabs\n    InventoryTab[\"BUNDLES\"] = \"bundles\";\n    // RESOURCE_ITEM tabs\n    InventoryTab[\"MATERIALS\"] = \"materials\";\n    InventoryTab[\"EQUIPMENT\"] = \"equipment\";\n})(InventoryTab || (InventoryTab = {}));\nvar ItemStatus;\n(function(ItemStatus) {\n    ItemStatus[\"CREATED\"] = \"Created\";\n    ItemStatus[\"FOR_SALE\"] = \"For Sale\";\n    ItemStatus[\"SOLD\"] = \"Sold\";\n    ItemStatus[\"TO_ORDER\"] = \"To Order\";\n    ItemStatus[\"TO_DO\"] = \"To Do\";\n    ItemStatus[\"GIFTED\"] = \"Gifted\";\n    ItemStatus[\"RESERVED\"] = \"Reserved\";\n    ItemStatus[\"OBSOLETE\"] = \"Obsolete\";\n    ItemStatus[\"DAMAGED\"] = \"Damaged\";\n    ItemStatus[\"IDLE\"] = \"Idle\";\n    ItemStatus[\"COLLECTED\"] = \"Collected\";\n    // Temporary while building\n    ItemStatus[\"ON_HOLD\"] = \"On Hold\";\n    ItemStatus[\"STORED\"] = \"Stored\";\n    ItemStatus[\"TO_REPAIR\"] = \"To Repair\";\n})(ItemStatus || (ItemStatus = {}));\nvar Collection;\n(function(Collection) {\n    Collection[\"NO_COLLECTION\"] = \"No Collection\";\n    Collection[\"ORGANIC_IMAGINARY\"] = \"Organic Imaginary\";\n    Collection[\"ANIMAL_KINGDOM\"] = \"Animal Kingdom\";\n    Collection[\"MUSHLAND\"] = \"Mushland\";\n    Collection[\"SEVEN_ELEMENTS\"] = \"Seven Elements\";\n    Collection[\"BITCOIN\"] = \"Bitcoin\";\n    Collection[\"DOPE_CREW\"] = \"Dope Crew\";\n    Collection[\"WORDS\"] = \"Words\";\n    Collection[\"FRUITS_VEGGIES\"] = \"Fruits & Veggies\";\n    Collection[\"FLOWERS\"] = \"Flowers\";\n    Collection[\"KINGS_QUEENS\"] = \"Kings & Queens\";\n    Collection[\"POLYGONAL_HD\"] = \"Polygonal HD\";\n    Collection[\"RELIQUIAS\"] = \"Reliquias\";\n    Collection[\"BITUAYA\"] = \"Bituaya\";\n    Collection[\"LANDSCAPES\"] = \"Landscapes\";\n    Collection[\"EXILIADO\"] = \"Exiliado\";\n})(Collection || (Collection = {}));\n/** Item categories for UI organization and SearchableSelect grouping */ const ITEM_CATEGORIES = {\n    MODEL_ITEM: [\n        \"DIGITAL\",\n        \"ARTWORK\",\n        \"PRINT\",\n        \"STICKER\",\n        \"MERCH\"\n    ],\n    BUNDLE_ITEM: [\n        \"STICKER_BUNDLE\",\n        \"PRINT_BUNDLE\"\n    ],\n    RESOURCE_ITEM: [\n        \"MATERIAL\",\n        \"EQUIPMENT\"\n    ]\n};\nvar SaleType;\n(function(SaleType) {\n    SaleType[\"DIRECT\"] = \"DIRECT\";\n    SaleType[\"FERIA\"] = \"FERIA\";\n    SaleType[\"BUNDLE_SALE\"] = \"BUNDLE\";\n    SaleType[\"CONSIGNMENT\"] = \"CONSIGNMENT\";\n    SaleType[\"ONLINE\"] = \"ONLINE\";\n    SaleType[\"NFT\"] = \"NFT\";\n})(SaleType || (SaleType = {}));\nvar SalesSessionStatus;\n(function(SalesSessionStatus) {\n    SalesSessionStatus[\"PENDING_RECONCILIATION\"] = \"Pending Reconciliation\";\n    SalesSessionStatus[\"RECONCILED\"] = \"Reconciled\";\n})(SalesSessionStatus || (SalesSessionStatus = {}));\nvar SaleStatus;\n(function(SaleStatus) {\n    SaleStatus[\"PENDING\"] = \"PENDING\";\n    SaleStatus[\"ON_HOLD\"] = \"ON_HOLD\";\n    SaleStatus[\"CHARGED\"] = \"CHARGED\";\n    SaleStatus[\"CANCELLED\"] = \"CANCELLED\";\n})(SaleStatus || (SaleStatus = {}));\nvar PaymentMethod;\n(function(PaymentMethod) {\n    // Regular payment methods\n    PaymentMethod[\"FIAT_USD\"] = \"$ CASH\";\n    PaymentMethod[\"FIAT_CRC\"] = \"₡ CASH\";\n    PaymentMethod[\"BTC\"] = \"BITCOIN\";\n    PaymentMethod[\"CARD\"] = \"CARD\";\n    PaymentMethod[\"SINPE\"] = \"SINPE\";\n    PaymentMethod[\"PAYPAL\"] = \"PAYPAL\";\n    PaymentMethod[\"WIRE_TRANSFER\"] = \"WIRE\";\n    // Special payment methods\n    PaymentMethod[\"GIFT\"] = \"GIFT\";\n    PaymentMethod[\"EXCHANGE\"] = \"EXCHANGE\";\n    PaymentMethod[\"OTHER\"] = \"OTHER\";\n})(PaymentMethod || (PaymentMethod = {}));\n/** Payment method categories for UI organization */ const PAYMENT_METHOD_CATEGORIES = {\n    REGULAR: [\n        \"FIAT_USD\",\n        \"FIAT_CRC\",\n        \"BTC\",\n        \"CARD\",\n        \"SINPE\",\n        \"PAYPAL\",\n        \"WIRE_TRANSFER\"\n    ],\n    SPECIAL: [\n        \"GIFT\",\n        \"EXCHANGE\",\n        \"OTHER\"\n    ]\n};\nvar CharacterRole;\n(function(CharacterRole) {\n    CharacterRole[\"FOUNDER\"] = \"founder\";\n    CharacterRole[\"PLAYER\"] = \"player\";\n    CharacterRole[\"PADAWAN\"] = \"padawan\";\n    CharacterRole[\"INVESTOR\"] = \"investor\";\n    CharacterRole[\"TEAM\"] = \"team\";\n    CharacterRole[\"FAMILY\"] = \"family\";\n    CharacterRole[\"FRIEND\"] = \"friend\";\n    CharacterRole[\"ADMIN\"] = \"admin\";\n    CharacterRole[\"DESIGNER\"] = \"designer\";\n    CharacterRole[\"PRODUCER\"] = \"producer\";\n    CharacterRole[\"SELLER\"] = \"seller\";\n    CharacterRole[\"RESEARCHER\"] = \"researcher\";\n    CharacterRole[\"DEVELOPER\"] = \"developer\";\n    CharacterRole[\"AI_AGENT\"] = \"ai-agent\";\n    CharacterRole[\"ASSOCIATE\"] = \"associate\";\n    CharacterRole[\"COLLABORATOR\"] = \"collaborator\";\n    CharacterRole[\"CUSTOMER\"] = \"customer\";\n    CharacterRole[\"STUDENT\"] = \"student\";\n    CharacterRole[\"OTHER\"] = \"other\";\n})(CharacterRole || (CharacterRole = {}));\n/** Character role types for UI organization and permissions */ const CHARACTER_ROLE_TYPES = {\n    REGULAR: [\n        \"admin\",\n        \"designer\",\n        \"producer\",\n        \"seller\",\n        \"researcher\",\n        \"developer\",\n        \"associate\",\n        \"collaborator\",\n        \"customer\",\n        \"student\",\n        \"ai-agent\",\n        \"other\"\n    ],\n    SPECIAL: [\n        \"founder\",\n        \"player\",\n        \"padawan\",\n        \"team\",\n        \"family\",\n        \"friend\",\n        \"investor\"\n    ]\n};\nvar IntelectualFunction;\n(function(IntelectualFunction) {\n    IntelectualFunction[\"SELF_AWARE\"] = \"Self Awareness\";\n    IntelectualFunction[\"EMOTION_CONTROL\"] = \"Emotion Control\";\n    IntelectualFunction[\"DECISION_MAKING\"] = \"Decision Making\";\n    IntelectualFunction[\"CREATIVITY\"] = \"Creativity\";\n    IntelectualFunction[\"PROBLEM_SOLVING\"] = \"Problem Solving\";\n    IntelectualFunction[\"SELF_CONTROL\"] = \"Self Control\";\n    IntelectualFunction[\"WORK_MEMORY\"] = \"Working Memory\";\n    IntelectualFunction[\"ADAPTABILITY\"] = \"Adaptability\";\n    IntelectualFunction[\"INITIATIVE\"] = \"Initiative\";\n    IntelectualFunction[\"PLANNING\"] = \"Planning\";\n    IntelectualFunction[\"ORGANIZATION\"] = \"Organization\";\n    IntelectualFunction[\"TIME_MNGM\"] = \"Time Management\";\n    IntelectualFunction[\"CONCENTRATION\"] = \"Concentration\";\n    IntelectualFunction[\"DETERMINATION\"] = \"Determination\";\n})(IntelectualFunction || (IntelectualFunction = {}));\nvar Attribute;\n(function(Attribute) {\n    Attribute[\"PERCEPTION\"] = \"Perception\";\n    Attribute[\"LOGIC\"] = \"Logic\";\n    Attribute[\"FITNESS\"] = \"Fitness\";\n    Attribute[\"CHARISMA\"] = \"Charisma\";\n    Attribute[\"WISDOM\"] = \"Wisdom\";\n    Attribute[\"LEADERSHIP\"] = \"Leadership\";\n    Attribute[\"COMMUNICATION\"] = \"Communication\";\n    Attribute[\"VISION\"] = \"Vision\";\n    Attribute[\"RESILIENCE\"] = \"Resilience\";\n    Attribute[\"EMPATHY\"] = \"Empathy\";\n    Attribute[\"INTEGRITY\"] = \"Integrity\";\n})(Attribute || (Attribute = {}));\nvar Skill;\n(function(Skill) {\n    Skill[\"DESIGN_THINKING\"] = \"Design Thinking\";\n    Skill[\"PROJECT_MANAGEMENT\"] = \"Project Management\";\n    Skill[\"TEACHING\"] = \"Teaching\";\n    Skill[\"NEGOTIATION\"] = \"Negotiation\";\n    Skill[\"NARRATIVE\"] = \"Narrative\";\n    Skill[\"DEVELOPING\"] = \"Developing\";\n    Skill[\"HANDCRAFTING\"] = \"Handcrafting\";\n    Skill[\"PAINTING\"] = \"Painting\";\n    Skill[\"ILLUSTRATION\"] = \"Illustration\";\n})(Skill || (Skill = {}));\n/** Skills categories for UI organization and SearchableSelect grouping */ const SKILLS_CATEGORIES = {\n    COGNITIVE: [\n        \"SELF_AWARE\",\n        \"EMOTION_CONTROL\",\n        \"DECISION_MAKING\",\n        \"CREATIVITY\",\n        \"PROBLEM_SOLVING\",\n        \"SELF_CONTROL\",\n        \"WORK_MEMORY\",\n        \"ADAPTABILITY\",\n        \"INITIATIVE\",\n        \"PLANNING\"\n    ],\n    CHARACTER: [\n        \"PERCEPTION\",\n        \"LOGIC\",\n        \"FITNESS\",\n        \"CHARISMA\",\n        \"WISDOM\",\n        \"LEADERSHIP\",\n        \"COMMUNICATION\",\n        \"VISION\",\n        \"RESILIENCE\",\n        \"EMPATHY\"\n    ],\n    PRACTICAL: [\n        \"DESIGN_THINKING\",\n        \"PROJECT_MANAGEMENT\",\n        \"TEACHING\",\n        \"NEGOTIATION\",\n        \"NARRATIVE\",\n        \"DEVELOPING\",\n        \"HANDCRAFTING\",\n        \"PAINTING\",\n        \"ILLUSTRATION\"\n    ]\n};\nvar CommColor;\n(function(CommColor) {\n    CommColor[\"RED\"] = \"Red\";\n    CommColor[\"YELLOW\"] = \"Yellow\";\n    CommColor[\"GREEN\"] = \"Green\";\n    CommColor[\"BLUE\"] = \"Blue\";\n    CommColor[\"PURPLE\"] = \"Purple\";\n    CommColor[\"ORANGE\"] = \"Orange\";\n    CommColor[\"TURQUOISE\"] = \"Turquoise\";\n    CommColor[\"BROWN\"] = \"Brown\";\n    CommColor[\"YELLOW_BLUE\"] = \"Yellow-Blue\";\n    CommColor[\"YELLOW_GREEN\"] = \"Yellow-Green\";\n})(CommColor || (CommColor = {}));\nvar LinkType;\n(function(LinkType) {\n    // TASK relationships\n    LinkType[\"TASK_ITEM\"] = \"TASK_ITEM\";\n    LinkType[\"TASK_FINREC\"] = \"TASK_FINREC\";\n    LinkType[\"TASK_SALE\"] = \"TASK_SALE\";\n    LinkType[\"TASK_PLAYER\"] = \"TASK_PLAYER\";\n    LinkType[\"TASK_CHARACTER\"] = \"TASK_CHARACTER\";\n    LinkType[\"TASK_SITE\"] = \"TASK_SITE\";\n    // ITEM relationships\n    LinkType[\"ITEM_TASK\"] = \"ITEM_TASK\";\n    LinkType[\"ITEM_SALE\"] = \"ITEM_SALE\";\n    LinkType[\"ITEM_FINREC\"] = \"ITEM_FINREC\";\n    LinkType[\"ITEM_PLAYER\"] = \"ITEM_PLAYER\";\n    LinkType[\"ITEM_CHARACTER\"] = \"ITEM_CHARACTER\";\n    LinkType[\"ITEM_SITE\"] = \"ITEM_SITE\";\n    // SALE relationships\n    LinkType[\"SALE_TASK\"] = \"SALE_TASK\";\n    LinkType[\"SALE_ITEM\"] = \"SALE_ITEM\";\n    LinkType[\"SALE_FINREC\"] = \"SALE_FINREC\";\n    LinkType[\"SALE_PLAYER\"] = \"SALE_PLAYER\";\n    LinkType[\"SALE_CHARACTER\"] = \"SALE_CHARACTER\";\n    LinkType[\"SALE_SITE\"] = \"SALE_SITE\";\n    // FINANCIAL RECORD relationships\n    LinkType[\"FINREC_TASK\"] = \"FINREC_TASK\";\n    LinkType[\"FINREC_ITEM\"] = \"FINREC_ITEM\";\n    LinkType[\"FINREC_SALE\"] = \"FINREC_SALE\";\n    LinkType[\"FINREC_PLAYER\"] = \"FINREC_PLAYER\";\n    LinkType[\"FINREC_CHARACTER\"] = \"FINREC_CHARACTER\";\n    LinkType[\"FINREC_SITE\"] = \"FINREC_SITE\";\n    // CHARACTER relationships\n    LinkType[\"CHARACTER_TASK\"] = \"CHARACTER_TASK\";\n    LinkType[\"CHARACTER_ITEM\"] = \"CHARACTER_ITEM\";\n    LinkType[\"CHARACTER_SALE\"] = \"CHARACTER_SALE\";\n    LinkType[\"CHARACTER_FINREC\"] = \"CHARACTER_FINREC\";\n    LinkType[\"CHARACTER_SITE\"] = \"CHARACTER_SITE\";\n    LinkType[\"CHARACTER_PLAYER\"] = \"CHARACTER_PLAYER\";\n    // SITE relationships (locations and places)\n    LinkType[\"SITE_TASK\"] = \"SITE_TASK\";\n    LinkType[\"SITE_CHARACTER\"] = \"SITE_CHARACTER\";\n    LinkType[\"SITE_FINREC\"] = \"SITE_FINREC\";\n    LinkType[\"SITE_ITEM\"] = \"SITE_ITEM\";\n    LinkType[\"SITE_SALE\"] = \"SITE_SALE\";\n    LinkType[\"SITE_SITE\"] = \"SITE_SITE\";\n    // PLAYER relationships\n    LinkType[\"PLAYER_TASK\"] = \"PLAYER_TASK\";\n    LinkType[\"PLAYER_SALE\"] = \"PLAYER_SALE\";\n    LinkType[\"PLAYER_FINREC\"] = \"PLAYER_FINREC\";\n    LinkType[\"PLAYER_ITEM\"] = \"PLAYER_ITEM\";\n    LinkType[\"PLAYER_CHARACTER\"] = \"PLAYER_CHARACTER\";\n    // ACCOUNT relationships (authentication & identity)\n    LinkType[\"ACCOUNT_PLAYER\"] = \"ACCOUNT_PLAYER\";\n    LinkType[\"ACCOUNT_CHARACTER\"] = \"ACCOUNT_CHARACTER\";\n    LinkType[\"PLAYER_ACCOUNT\"] = \"PLAYER_ACCOUNT\";\n    LinkType[\"CHARACTER_ACCOUNT\"] = \"CHARACTER_ACCOUNT\";\n})(LinkType || (LinkType = {}));\nvar EntityType;\n(function(EntityType) {\n    EntityType[\"TASK\"] = \"task\";\n    EntityType[\"ITEM\"] = \"item\";\n    EntityType[\"SALE\"] = \"sale\";\n    EntityType[\"FINANCIAL\"] = \"financial\";\n    EntityType[\"CHARACTER\"] = \"character\";\n    EntityType[\"SITE\"] = \"site\";\n    EntityType[\"PLAYER\"] = \"player\";\n    EntityType[\"ACCOUNT\"] = \"account\";\n})(EntityType || (EntityType = {}));\nvar NoteColor;\n(function(NoteColor) {\n    NoteColor[\"WHITE\"] = \"white\";\n    NoteColor[\"ORANGE\"] = \"orange\";\n    NoteColor[\"PURPLE\"] = \"purple\";\n    NoteColor[\"GREEN\"] = \"green\";\n    NoteColor[\"BLUE\"] = \"blue\";\n    NoteColor[\"YELLOW\"] = \"yellow\";\n    NoteColor[\"PINK\"] = \"pink\";\n    NoteColor[\"RED\"] = \"red\";\n    NoteColor[\"GRAY\"] = \"gray\"; // Personal, private\n})(NoteColor || (NoteColor = {}));\nvar NotebookType;\n(function(NotebookType) {\n    NotebookType[\"ALL_NOTES\"] = \"all\";\n    NotebookType[\"CURRENT_SPRINT\"] = \"current_sprint\";\n    NotebookType[\"CHALLENGES\"] = \"challenges\";\n    NotebookType[\"ROAD_AHEAD\"] = \"road_ahead\";\n    NotebookType[\"STRATEGY\"] = \"strategy\";\n    NotebookType[\"IDEAS\"] = \"ideas\";\n    NotebookType[\"GENERAL\"] = \"general\";\n})(NotebookType || (NotebookType = {}));\n/** Available tags derived from business structure - DRY principle */ const NOTE_TAGS = Object.values(BUSINESS_STRUCTURE).flat();\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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Q2Y7SUFDREMsV0FBVztRQUNUO1FBQWM7UUFBUztRQUFXO1FBQVk7UUFDOUM7UUFBYztRQUFpQjtRQUFVO1FBQWM7S0FDeEQ7SUFDREMsV0FBVztRQUNUO1FBQW1CO1FBQXNCO1FBQVk7UUFDckQ7UUFBYTtRQUFjO1FBQWdCO1FBQVk7S0FDeEQ7QUFDSCxFQUFXOztVQUVDQzs7Ozs7Ozs7Ozs7R0FBQUEsY0FBQUE7O1VBa0JBQztJQUNWLHFCQUFxQjs7Ozs7OztJQVFyQixxQkFBcUI7Ozs7Ozs7SUFRckIscUJBQXFCOzs7Ozs7O0lBUXJCLGlDQUFpQzs7Ozs7OztJQVFqQywwQkFBMEI7Ozs7Ozs7SUFRMUIsNENBQTRDOzs7Ozs7O0lBUTVDLHVCQUF1Qjs7Ozs7O0lBT3ZCLG9EQUFvRDs7Ozs7R0F4RDFDQSxhQUFBQTs7VUFnRUFDOzs7Ozs7Ozs7R0FBQUEsZUFBQUE7O1VBZ0JBQzs7Ozs7Ozs7O2dDQVNZLG9CQUFvQjtHQVRoQ0EsY0FBQUE7O1VBYUFDOzs7Ozs7OztHQUFBQSxpQkFBQUE7QUFVWixtRUFBbUUsR0FDNUQsTUFBTUMsWUFBWUMsT0FBT0MsTUFBTSxDQUFDOUYsb0JBQW9CK0YsSUFBSSxHQUFHIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vdGhlZ2FtZS1hZG1pbi8uL3R5cGVzL2VudW1zLnRzPzQ4MmUiXSwic291cmNlc0NvbnRlbnQiOlsiLy8gdHlwZXMvZW51bXMudHNcbi8vIEFsbCBlbnVtcyBhbmQgY29uc3RhbnRzIC0gc2luZ2xlIHNvdXJjZSBvZiB0cnV0aCBmb3IgYXBwbGljYXRpb24gc3RhdGVcblxuLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuLy8gQlVTSU5FU1MgU1RSVUNUVVJFIC0gU2luZ2xlIHNvdXJjZSBvZiB0cnV0aCBmb3Igc2VjdGlvbnMgYW5kIHN0YXRpb25zXG4vLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG5cbi8qKiBCdXNpbmVzcyBTdHJ1Y3R1cmUgLSBTaW5nbGUgc291cmNlIG9mIHRydXRoIGZvciBzZWN0aW9ucyBhbmQgc3RhdGlvbnMgKi9cbmV4cG9ydCBjb25zdCBCVVNJTkVTU19TVFJVQ1RVUkUgPSB7XG4gIEFETUlOOiAgICAgIFsnU3RyYXRlZ3knLCAnUHJvamVjdHMnLCAnSW52ZW50b3J5JywgJ1RyYW5zcG9ydCcsICdUZWFtJywgJ01hdGVyaWFscycsICdFcXVpcG1lbnQnLCAnUmVudCcsICdEaXJlY3RvciddLFxuICBSRVNFQVJDSDogICBbJ0NsYXNzZXMnLCAnU3R1ZGllcycsICdEZXZlbG9wbWVudCddLFxuICBERVNJR046ICAgICBbJ0RpZ2l0YWwgQXJ0JywgJ0FydCBDcmVhdGl2ZSBQcm9jZXNzZXMnLCAnR2FtZSBEZXNpZ24nLCAnM0QgTW9kZWxpbmcnLCAnQW5pbWF0aW9uJ10sXG4gIFBST0RVQ1RJT046IFsnQXJ0d29ya3MnLCAnTXVyYWxzJywgJ1ByaW50cycsICdTdGlja2VycycsICdNZXJjaCcsICdXb29kd29ya3MnLCAnTkZUcyddLFxuICBTQUxFUzogICAgICBbJ0RpcmVjdCBTYWxlcycsICdGZXJpYSBTYWxlcycsICdOZXR3b3JrIFNhbGVzJywgJ09ubGluZSBTYWxlcycsICdTdG9yZSBTYWxlcycsICdNYXJrZXRpbmcnLCAnQm9va2luZ3MnLCAnT3RoZXIgU2FsZXMnXSxcbiAgUEVSU09OQUw6ICAgWydIZWFsdGgnLCAnRmFtaWx5JywgJ0Zvb2QnLCAnSG9tZScsICdUcmFuc3BvcnQgUCcsICdSZW50IFAnLCAnT3RoZXIgUCddXG59IGFzIGNvbnN0O1xuXG4vLyBBcmVhcyAodG9wLWxldmVsIGJ1c2luZXNzIGFyZWFzKVxuZXhwb3J0IGNvbnN0IENPTVBBTllfQVJFQVMgPSBbJ0FETUlOJywgJ1JFU0VBUkNIJywgJ0RFU0lHTicsICdQUk9EVUNUSU9OJywgJ1NBTEVTJ10gYXMgY29uc3Q7XG5leHBvcnQgY29uc3QgUEVSU09OQUxfQVJFQVMgPSBbJ1BFUlNPTkFMJ10gYXMgY29uc3Q7XG5leHBvcnQgY29uc3QgQUxMX0FSRUFTID0gWy4uLkNPTVBBTllfQVJFQVMsIC4uLlBFUlNPTkFMX0FSRUFTXSBhcyBjb25zdDtcblxuLy8gVHlwZSBleHBvcnRzXG5leHBvcnQgdHlwZSBBcmVhID0gdHlwZW9mIEFMTF9BUkVBU1tudW1iZXJdO1xuZXhwb3J0IHR5cGUgU3RhdGlvbiA9IHR5cGVvZiBCVVNJTkVTU19TVFJVQ1RVUkVbQXJlYV1bbnVtYmVyXTtcblxuLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuLy8gU1RBVElPTiBDQVRFR09SSUVTIC0gRGVyaXZlZCBmcm9tIEJVU0lORVNTX1NUUlVDVFVSRSBmb3IgU2VhcmNoYWJsZVNlbGVjdFxuLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuXG4vKiogU3RhdGlvbiBjYXRlZ29yaWVzIGZvciBTZWFyY2hhYmxlU2VsZWN0IGdyb3VwaW5nIC0gZGVyaXZlZCBmcm9tIEJVU0lORVNTX1NUUlVDVFVSRSAqL1xuZXhwb3J0IGNvbnN0IFNUQVRJT05fQ0FURUdPUklFUyA9IHtcbiAgQURNSU46IEJVU0lORVNTX1NUUlVDVFVSRS5BRE1JTixcbiAgUkVTRUFSQ0g6IEJVU0lORVNTX1NUUlVDVFVSRS5SRVNFQVJDSCxcbiAgREVTSUdOOiBCVVNJTkVTU19TVFJVQ1RVUkUuREVTSUdOLFxuICBQUk9EVUNUSU9OOiBCVVNJTkVTU19TVFJVQ1RVUkUuUFJPRFVDVElPTixcbiAgU0FMRVM6IEJVU0lORVNTX1NUUlVDVFVSRS5TQUxFUyxcbiAgUEVSU09OQUw6IEJVU0lORVNTX1NUUlVDVFVSRS5QRVJTT05BTFxufSBhcyBjb25zdDtcblxuLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuLy8gTE9DQVRJT04gU1RSVUNUVVJFXG4vLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG5cbi8qKiBHZW9ncmFwaGljIExvY2F0aW9uIFN0cnVjdHVyZSAtIFNpbmdsZSBzb3VyY2Ugb2YgdHJ1dGggZm9yIGdlb2dyYXBoaWMgaGllcmFyY2h5ICovXG5leHBvcnQgY29uc3QgTE9DQVRJT05fU1RSVUNUVVJFID0ge1xuICAnTm9ydGggQW1lcmljYSc6IHtcbiAgICAnVW5pdGVkIFN0YXRlcyc6IFsnVW5pdGVkIFN0YXRlcyddLFxuICAgICdDYW5hZGEnOiBbJ0NhbmFkYSddXG4gICAgfSxcbiAgJ0NlbnRyYWwgQW1lcmljYSc6IHtcbiAgICAnQ29zdGEgUmljYSc6IFsnUHVudGFyZW5hcycsICdTYW4gSm9zZScsICdHdWFuYWNhc3RlJywgJ0xpbW9uJ10sXG4gICAgJ1BhbmFtYSc6IFsnUGFuYW1hJ10sXG4gICAgJ05pY2FyYWd1YSc6IFsnTmljYXJhZ3VhJ10sXG4gICAgJ0VsIFNhbHZhZG9yJzogWydFbCBTYWx2YWRvciddXG4gICAgfSxcbiAgJ1NvdXRoIEFtZXJpY2EnOiB7XG4gICAgJ1ZlbmV6dWVsYSc6IFsnTWFyZ2FyaXRhIElzbGFuZCcsICdDYXJhY2FzJ10sXG4gICAgJ0NvbG9tYmlhJzogWydCb2dvdGEnXSxcbiAgICAnVXJ1Z3VheSc6IFsnTW9udGV2aWRlbyddLFxuICAgICdDaGlsZSc6IFsnU2FudGlhZ28nXSxcbiAgICAnQXJnZW50aW5hJzogWydCdWVub3MgQWlyZXMnXSxcbiAgICAnQnJhc2lsJzogWydSaW8gZGUgSmFuZWlybyddLFxuICAgICdQZXJ1JzogWydMaW1hJ11cbiAgICB9LFxufSBhcyBjb25zdDtcblxuLy8gRXhwb3J0IHRoZSBzdHJ1Y3R1cmUgZm9yIGNvbXBvbmVudHMgdG8gdXNlXG5leHBvcnQgY29uc3QgTE9DQVRJT05fSElFUkFSQ0hZID0gTE9DQVRJT05fU1RSVUNUVVJFO1xuXG4vKiogU2V0dGxlbWVudCBjYXRlZ29yaWVzIGZvciBTZWFyY2hhYmxlU2VsZWN0IGdyb3VwaW5nIC0gYmFzZWQgb24gTE9DQVRJT05fU1RSVUNUVVJFIHJlZ2lvbnMgKi9cbi8vIFNFVFRMRU1FTlRfQ0FURUdPUklFUyByZW1vdmVkIC0gbm93IHVzaW5nIGR5bmFtaWMgU2V0dGxlbWVudCBlbnRpdGllcyB3aXRoIGNvdW50cnkgZmllbGRcblxuLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuLy8gU0lURSBFTlVNU1xuLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuXG4vKiogUGh5c2ljYWwgU2l0ZSBCdXNpbmVzcyBUeXBlcyAqL1xuZXhwb3J0IGVudW0gUGh5c2ljYWxCdXNpbmVzc1R5cGUge1xuICBTVE9SQUdFICAgICAgICAgICA9ICdzdG9yYWdlJywgICAgICAgICAgICAgICAgLy8gV2FyZWhvdXNlIHNpdGVzIChIb21lLCBGZXJpYSBCb3guLi4pXG4gIENPTlNJR05NRU5UICAgICAgID0gJ2NvbnNpZ25tZW50JywgICAgICAgICAgICAvLyBJdGVtcyBsZWZ0IHRvIHNlbGwgKFNtb2tpbmcgTG91bmdlLCBUYWd1YS4uLilcbiAgU0VMTElOR19QT0lOVCAgICAgPSAnc2VsbGluZyBwb2ludCcsICAgICAgICAgIC8vIFN0b3JlcyB0aGF0IGJ1eSBhdCBkaXNjb3VudCAoRWwgSG9ybml0bywgUGVyZXpvc28gRmVsaXouLi4pXG4gIEZFUklBICAgICAgICAgICAgID0gJ2ZlcmlhJywgICAgICAgICAgICAgICAgICAvLyBGZXJpYSBzaXRlcyAoRWNvIEZlcmlhLi4uKVxuICBURUFDSElOR19TUEFDRSAgICA9ICd0ZWFjaGluZyBzcGFjZScsICAgICAgICAgLy8gVGVhY2hpbmcgc2l0ZXMgKEp1bmdsZSBBY2FkZW15Li4uKVxuICBIUSAgICAgICAgICAgICAgICA9ICdIUScsICAgICAgICAgICAgICAgICAgICAgLy8gSFEgc2l0ZXMgKEhvbWUsIEZlcmlhIEJveC4uLilcbiAgQVJUX0dBTExFUlkgICAgICAgPSAnYXJ0IGdhbGxlcnknLCAgICAgICAgICAgIC8vIEdhbGxlcnkgc2l0ZXMgKEdhbGxlcnkgMTA4NC4uLilcbiAgREVTSUdOX1NQQUNFICAgICAgPSAnZGVzaWduIHNwYWNlJywgICAgICAgICAgIC8vIERlc2lnbiBodWIgc2l0ZXMgKERlc2lnbiBIdWIuLi4pXG4gIFdPUktTSE9QICAgICAgICAgID0gJ3dvcmtzaG9wJyAgICAgICAgICAgICAgICAvLyBQcm9kdWN0aW9uIHNpdGVzIGZvciBjcmVhdGluZyBpdGVtc1xufVxuXG4vKiogQ2xvdWQgRGlnaXRhbCBUeXBlcyAqL1xuZXhwb3J0IGVudW0gQ2xvdWRTaXRlVHlwZSB7XG4gIFJFUE9TSVRPUlkgICAgICAgICAgPSAncmVwb3NpdG9yeScsICAgICAgICAgICAgIC8vIFNvdXJjZSBmaWxlcywgdGVtcGxhdGVzLCBkaWdpdGFsIGFzc2V0c1xuICBESUdJVEFMX1NUT1JBR0UgICAgID0gJ2RpZ2l0YWwgc3RvcmFnZScsICAgICAgICAvLyBEcml2ZXMsIGRpZ2l0YWwgYXJ0IGZvbGRlciwgb25saW5lIGdhbGxlcmllc1xuICBORlRfV0FMTEVUICAgICAgICAgID0gJ25mdCB3YWxsZXQnICAgICAgICAgICAgICAvLyBORnQgYXNzZXRzXG59XG5cbi8qKiBTcGVjaWFsIFNpdGUgUHVycG9zZXMgKi9cbmV4cG9ydCBlbnVtIFNwZWNpYWxTaXRlVHlwZSB7XG4gIFVOSVZFUlNBTF9UUkFDS0lORyA9ICd1bml2ZXJzYWwgdHJhY2tpbmcnLCAvLyBJdGVtcyBubyBsb25nZXIgYXQgc3BlY2lmaWMgc2l0ZXNcbiAgU09MRF9JVEVNUyAgICAgICAgID0gJ3NvbGQgaXRlbXMnLCAgICAgICAgIC8vIFNvbGQgaXRlbXMgdHJhY2tpbmdcbiAgQVJDSElWRUQgICAgICAgICAgID0gJ2FyY2hpdmVkJywgICAgICAgICAgIC8vIEFyY2hpdmVkL2hpc3RvcmljYWwgaXRlbXNcbiAgREVMRVRFRCAgICAgICAgICAgID0gJ2RlbGV0ZWQnICAgICAgICAgICAgIC8vIERlbGV0ZWQgaXRlbXNcbn1cblxuLyoqIFNpdGVUeXBlIGVudW0gZm9yIGJhY2t3YXJkIGNvbXBhdGliaWxpdHkgd2l0aCBlbnRpdGllcyAqL1xuZXhwb3J0IGVudW0gU2l0ZVR5cGUge1xuICBQSFlTSUNBTCA9ICdQSFlTSUNBTCcsICAvLyBQaHlzaWNhbCBsb2NhdGlvbnMgd2l0aCBhZGRyZXNzZXNcbiAgQ0xPVUQgPSAnQ0xPVUQnLCAgICAgICAgLy8gRGlnaXRhbC9jbG91ZCBzdG9yYWdlIGxvY2F0aW9uc1xuICBTUEVDSUFMID0gJ1NQRUNJQUwnICAgICAvLyBTcGVjaWFsIHN5c3RlbS1tYW5hZ2VkIGxvY2F0aW9uc1xufVxuXG4vKiogU3RhdHVzIG9mIFNpdGVzIC0gY29udHJvbHMgc3RhdGUgKi9cbmV4cG9ydCBlbnVtIFNpdGVTdGF0dXMge1xuICBDUkVBVEVEICA9ICdDcmVhdGVkJywgICAvLyBGaXJzdCBjcmVhdGVkXG4gIEFDVElWRSAgID0gJ0FjdGl2ZScsICAgIC8vIEhhcyBJdGVtIG9yIFRhc2sgbGlua3NcbiAgVVBEQVRFRCAgPSAnVXBkYXRlZCcsICAgLy8gRGF0YSBlZGl0ZWRcbiAgSU5BQ1RJVkUgPSAnSW5hY3RpdmUnLCAgLy8gTm8gcmVsYXRpb25zaGlwc1xufVxuXG4vKiogU2l0ZSBTdHJ1Y3R1cmUgLSBTaW5nbGUgc291cmNlIG9mIHRydXRoIGZvciBzaXRlcyBhbmQgdGhlaXIgdHlwZXMgKi9cbmNvbnN0IFNJVEVfU1RSVUNUVVJFID0ge1xuICBQSFlTSUNBTDoge1xuICAgIEhPTUU6ICdIb21lJyxcbiAgICBGRVJJQV9CT1g6ICdGZXJpYSBCb3gnLFxuICAgIFNNT0tJTkdfTE9VTkdFOiAnU21va2luZyBMb3VuZ2UnLFxuICAgIFRBR1VBOiAnVGFndWEnLFxuICAgIENBRkVfVklWTzogJ0NhZmUgVml2bycsXG4gICAgWElWQTogJ1hpdmEnLFxuICAgIFBFUkVaT1NPX0ZFTElaOiAnUGVyZXpvc28gRmVsaXonLFxuICAgIEVMX0hPUk5JVE86ICdFbCBIb3JuaXRvJyxcbiAgICBKVU5HTEVfQUNBREVNWTogJ0p1bmdsZSBBY2FkZW15JyxcbiAgICBMQV9UUklCVTogJ0xhIFRyaWJ1JyxcbiAgICBPU0FfREVfUklPOiAnT3NhIGRlIFJpbycsXG4gICAgR0FMTEVSWV8xMDg0OiAnR2FsbGVyeSAxMDg0JyxcbiAgICBDQVRfQ0FGRTogJ0NhdCBDYWZlJyxcbiAgICBFQ09fRkVSSUE6ICdFY28gRmVyaWEnLFxuICAgIEVTQ1VFTEFfVkVSREU6ICdFc2N1ZWxhIFZlcmRlJyxcbiAgICBQUklOVF9NQVNURVJTOiAnUHJpbnQgTWFzdGVycycsXG4gIH0sXG4gIENMT1VEOiB7XG4gICAgRElHSVRBTF9TUEFDRTogJ0RpZ2l0YWwgU3BhY2UnLFxuICAgIERFU0tUT1BfUEM6ICdEZXNrdG9wIFBDJyxcbiAgICBMQVBUT1A6ICdMYXB0b3AnLFxuICAgIEdPT0dMRV9EUklWRTogJ0dvb2dsZSBEcml2ZScsXG4gICAgR0lUSFVCOiAnR2l0aHViJyxcbiAgICBNQUdJQ19FREVOOiAnTWFnaWMgRWRlbicsXG4gICAgT1BFTlNFQTogJ09wZW5TZWEnLFxuICB9LFxuICBTUEVDSUFMOiB7XG4gICAgTk9ORTogJ05vbmUnLFxuICAgIFdPUkxEOiAnV29ybGQnLFxuICAgIFNPTERfSVRFTVNfVEhJU19NT05USDogJ1NvbGQgSXRlbXMnLFxuICAgIEFSQ0hJVkVEX0hJU1RPUklDQUw6ICdBcmNoaXZlZCcsXG4gICAgREVMRVRFRF9JVEVNU19USElTX01PTlRIOiAnRGVsZXRlZCBJdGVtcycsXG4gIH1cbn0gYXMgY29uc3Q7XG5cbi8vIEV4cG9ydCB0aGUgc3RydWN0dXJlIGZvciBjb21wb25lbnRzIHRvIHVzZVxuZXhwb3J0IGNvbnN0IFNJVEVfR1JPVVBTID0gU0lURV9TVFJVQ1RVUkU7XG5cbi8qKiBTaXRlIGNhdGVnb3JpZXMgZm9yIFVJIG9yZ2FuaXphdGlvbiBhbmQgU2VhcmNoYWJsZVNlbGVjdCBncm91cGluZyAqL1xuZXhwb3J0IGNvbnN0IFNJVEVfQ0FURUdPUklFUyA9IHtcbiAgUEhZU0lDQUw6IFsnSE9NRScsICdGRVJJQV9CT1gnLCAnU01PS0lOR19MT1VOR0UnLCAnVEFHVUEnLCAnQ0FGRV9WSVZPJywgJ1hJVkEnLCAnUEVSRVpPU09fRkVMSVonLCAnRUxfSE9STklUTycsICdKVU5HTEVfQUNBREVNWScsICdMQV9UUklCVScsICdPU0FfREVfUklPJywgJ0dBTExFUllfMTA4NCcsICdDQVRfQ0FGRScsICdFQ09fRkVSSUEnLCAnRVNDVUVMQV9WRVJERScsICdQUklOVF9NQVNURVJTJ10sXG4gIENMT1VEOiBbJ0RJR0lUQUxfU1BBQ0UnLCAnREVTS1RPUF9QQycsICdMQVBUT1AnLCAnR09PR0xFX0RSSVZFJywgJ0dJVEhVQicsICdNQUdJQ19FREVOJywgJ09QRU5TRUEnXSxcbiAgU1BFQ0lBTDogWydOT05FJywgJ1dPUkxEJywgJ1NPTERfSVRFTVNfVEhJU19NT05USCcsICdBUkNISVZFRF9ISVNUT1JJQ0FMJywgJ0RFTEVURURfSVRFTVNfVEhJU19NT05USCddXG59IGFzIGNvbnN0O1xuXG4vLyBTZXR0bGVtZW50IGVudW0gcmVtb3ZlZCAtIG5vdyB1c2luZyBkeW5hbWljIFNldHRsZW1lbnQgZW50aXRpZXNcblxuXG4vLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG4vLyBUQVNLIEVOVU1TXG4vLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG5cbi8qKiBNaXNzaW9uIFRyZWUgJiBoaWVyYXJjaGllcyAqL1xuZXhwb3J0IGVudW0gVGFza1R5cGUge1xuICBNSVNTSU9OICAgICAgICAgICAgICAgPSAnTWlzc2lvbicsXG4gIE1JTEVTVE9ORSAgICAgICAgICAgICA9ICdNaWxlc3RvbmUnLFxuICBHT0FMICAgICAgICAgICAgICAgICAgPSAnR29hbCcsXG4gIEFTU0lHTk1FTlQgICAgICAgICAgICA9ICdBc3NpZ25tZW50JyxcbiAgUkVDVVJSRU5UX1BBUkVOVCAgICAgID0gJ1JlY3VycmVudCBQYXJlbnQnLCAgICAgLy8gTkVXOiBGb2xkZXIvY29udGFpbmVyIGZvciByZWN1cnJlbnQgdGFza3NcbiAgUkVDVVJSRU5UX1RFTVBMQVRFICAgID0gJ1JlY3VycmVudCBUZW1wbGF0ZScsICAgLy8gTkVXOiBTZXRzIGZyZXF1ZW5jeSBwYXR0ZXJuXG4gIFJFQ1VSUkVOVF9JTlNUQU5DRSAgICA9ICdSZWN1cnJlbnQgSW5zdGFuY2UnICAgIC8vIE5FVzogU3Bhd25lZCB3aXRoIGR1ZSBkYXRlXG59XG5cbi8qKiBUYXNrIGNhdGVnb3JpZXMgZm9yIFVJIG9yZ2FuaXphdGlvbiBhbmQgU2VhcmNoYWJsZVNlbGVjdCBncm91cGluZyAqL1xuZXhwb3J0IGNvbnN0IFRBU0tfQ0FURUdPUklFUyA9IHtcbiAgTUlTU0lPTjogWydNaXNzaW9uJywgJ01pbGVzdG9uZScsICdHb2FsJywgJ0Fzc2lnbm1lbnQnXSxcbiAgUkVDVVJSRU5UOiBbJ1JlY3VycmVudCBQYXJlbnQnLCAnUmVjdXJyZW50IFRlbXBsYXRlJywgJ1JlY3VycmVudCBJbnN0YW5jZSddXG59IGFzIGNvbnN0O1xuXG4vKiogUmVjdXJyZW50IHRhc2sgZnJlcXVlbmN5IG9wdGlvbnMgKi9cbmV4cG9ydCBlbnVtIFJlY3VycmVudEZyZXF1ZW5jeSB7XG4gIE9OQ0UgPSAnT25jZScsXG4gIERBSUxZID0gJ0RhaWx5JyxcbiAgV0VFS0xZID0gJ1dlZWtseScsIFxuICBNT05USExZID0gJ01vbnRobHknLFxuICBDVVNUT00gPSAnQ3VzdG9tJyxcbiAgQUxXQVlTID0gJ0Fsd2F5cydcbn1cblxuLyoqIFdvcmtmbG93IHN0YXRlIG9mIGEgVGFzayAqL1xuZXhwb3J0IGVudW0gVGFza1N0YXR1cyB7XG4gIENSRUFURUQgICAgID0gJ0NyZWF0ZWQnLFxuICBPTl9IT0xEICAgICA9ICdPbiBIb2xkJyxcbiAgSU5fUFJPR1JFU1MgPSAnSW4gUHJvZ3Jlc3MnLFxuICBGSU5JU0hJTkcgICA9ICdGaW5pc2hpbmcnLFxuICBET05FICAgICAgICA9ICdEb25lJyxcbiAgQ09MTEVDVEVEICAgPSAnQ29sbGVjdGVkJyxcbiAgRkFJTEVEICAgICAgPSAnRmFpbGVkJyxcbiAgTk9ORSAgICAgICAgPSAnTm9uZScsICAgICAgICAvLyBubyBzdGF0dXNcbn1cblxuLyoqIE9wdGlvbmFsIHVyZ2VuY3kgZmxhZyAoLS3ilrogcmVwbGFjZXMgXCJBd2FpdGluZyAvIFVyZ2VudCDigKZcIikgKi9cbmV4cG9ydCBlbnVtIFRhc2tQcmlvcml0eSB7XG4gIE5PVF9OT1cgICAgPSAnTm90IE5vdycsXG4gIFNMT1cgICAgICAgPSAnU2xvdycsXG4gIE5PUk1BTCAgICAgPSAnTm9ybWFsJyxcbiAgSU1QT1JUQU5UICA9ICdJbXBvcnRhbnQnLFxuICBVUkdFTlQgICAgID0gJ1VyZ2VudCcsXG59XG5cbi8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cbi8vIEZJTkFOQ0lBTCAmIFBPSU5UUyBFTlVNU1xuLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuXG4vKiogU3RhdHVzIG9mIFJlY29yZHMgKGNvbXBsZXRlZCB0YXNrcykgKi9cbmV4cG9ydCBlbnVtIEZpbmFuY2lhbFN0YXR1cyB7XG4gIERPTkUgPSAnRG9uZScsICAgICAgICAvLyBhcyBzb29uIGFzIHRoZXkgYXJlIGNyZWF0ZWRcbiAgQ09MTEVDVEVEID0gJ0NvbGxlY3RlZCcsIC8vIHRoZXkgc3RheSBkb25lIHVudGlsIHRoZXkgYXJlIGNvbGxlY3RlZFxufVxuXG4vKiogU3RhdHVzIG9mIERldiBTcHJpbnRzL1BoYXNlcyAqL1xuZXhwb3J0IGVudW0gRGV2U3ByaW50U3RhdHVzIHtcbiAgTk9UX1NUQVJURUQgPSAnTm90IFN0YXJ0ZWQnLFxuICBJTl9QUk9HUkVTUyA9ICdJbiBQcm9ncmVzcycsXG4gIERPTkUgPSAnRG9uZScsXG59XG5cbi8vIE5ldyBQb2ludHMgU3lzdGVtIEVudW1zXG5leHBvcnQgZW51bSBQb2ludFR5cGUge1xuICBYUCA9ICdYUCcsICAgICAvLyBFeHBlcmllbmNlIFBvaW50c1xuICBSUCA9ICdSUCcsICAgIC8vIFJlc2VhcmNoIFBvaW50c1xuICBGUCA9ICdGUCcsICAgIC8vIEZhbWlseSBQb2ludHMgXG4gIEhQID0gJ0hQJywgICAgLy8gSGVhbHRoIFBvaW50c1xufVxuXG4vKiogSW4tZ2FtZSBjdXJyZW5jeSBzeXN0ZW0gKi9cbmV4cG9ydCBlbnVtIEN1cnJlbmN5IHtcbiAgVVNEICAgICAgICAgICA9ICdVU0QnLCAgICAgICAgICAgICAgLy8gVVMgRG9sbGFycyAtIHByaW1hcnkgYnVzaW5lc3MgY3VycmVuY3kgZm9yIGludmVudG9yaWVzLCBwYXltZW50cywgZXRjLlxuICBKVU5HTEVfQ09JTlMgID0gJ0okJywgICAgICAgICAgICAgICAvLyBKdW5nbGUgQ29pbnMgLSByZXdhcmQgdG9rZW5zIHRoYXQgY29udmVydCB0byBVU0QgKGxpa2UgWmVsZGEgZ2VtcylcbiAgQlRDICAgICAgICAgICA9ICdCVEMnLCAgICAgICAgICAgICAgLy8gQml0Y29pbiAtIGNyeXB0b2N1cnJlbmN5IGFzc2V0XG4gIENSQyAgICAgICAgICAgPSAnQ1JDJywgICAgICAgICAgICAgIC8vIENvc3RhIFJpY2EgQ29sb24gLSBsb2NhbCBjdXJyZW5jeVxufVxuXG4vLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG4vLyBJVEVNIEVOVU1TXG4vLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG5cbi8qKiBBbGwgSXRlbXMgLSBQcm9kdWN0cywgQnVuZGxlcywgTWF0ZXJpYWxzIGFuZCBFcXVpcG1lbnQgKi9cbmV4cG9ydCBlbnVtIEl0ZW1UeXBlIHtcbiAgLy8gTU9ERUxfSVRFTSAtIEluZGl2aWR1YWwgcHJvZHVjdHMgdGhhdCBjYW4gYmUgc2VwYXJhdGVkIGJ5IG1vZGVsLCBzdWJ0eXBlLCBzaXRlIGFuZCBjb2xsZWN0aW9uXG4gIERJR0lUQUwgICAgICAgICA9ICdEaWdpdGFsJyxcbiAgQVJUV09SSyAgICAgICAgID0gJ0FydHdvcmsnLFxuICBQUklOVCAgICAgICAgICAgPSAnUHJpbnQnLFxuICBTVElDS0VSICAgICAgICAgPSAnU3RpY2tlcicsXG4gIE1FUkNIICAgICAgICAgICA9ICdNZXJjaCcsXG4gIFxuICAvLyBCVU5ETEVfSVRFTSAtIEJ1c2luZXNzIExvZ2ljIEl0ZW1zIHRoYXQgYXJlIFBhY2tzIG9mIHRoZSBzYW1lIFR5cGUgb2YgSXRlbVxuICBTVElDS0VSX0JVTkRMRSAgPSAnU3RpY2tlciBCdW5kbGUnLCAgICAvLyBQYWNrIG9mIFN0aWNrZXJzXG4gIFBSSU5UX0JVTkRMRSAgICA9ICdQcmludCBCdW5kbGUnLCAgICAgIC8vIFBhY2sgb2YgUHJpbnRzXG4gIFxuICAvLyBSRVNPVVJDRV9JVEVNIC0gTWF0ZXJpYWxzIGFuZCBFcXVpcG1lbnQgZm9yIHByb2R1Y3Rpb25cbiAgTUFURVJJQUwgICAgICAgID0gJ01hdGVyaWFsJyxcbiAgRVFVSVBNRU5UICAgICAgID0gJ0VxdWlwbWVudCcsXG59XG5cbi8qKiBJdGVtIENhdGVnb3JpZXMgZm9yIFVJIG9yZ2FuaXphdGlvbiBhbmQgYnVzaW5lc3MgbG9naWMgKi9cbmV4cG9ydCBlbnVtIEl0ZW1DYXRlZ29yeSB7XG4gIE1PREVMX0lURU0gICAgICA9ICdNT0RFTF9JVEVNJywgICAgICAvLyBJbmRpdmlkdWFsIHByb2R1Y3RzIChEaWdpdGFsLCBBcnR3b3JrLCBQcmludCwgU3RpY2tlciwgTWVyY2gpXG4gIEJVTkRMRV9JVEVNICAgICA9ICdCVU5ETEVfSVRFTScsICAgICAvLyBCdXNpbmVzcyBMb2dpYyBJdGVtcyAoU3RpY2tlciBCdW5kbGUsIFByaW50IEJ1bmRsZSlcbiAgUkVTT1VSQ0VfSVRFTSAgID0gJ1JFU09VUkNFX0lURU0nLCAgIC8vIFByb2R1Y3Rpb24gcmVzb3VyY2VzIChNYXRlcmlhbCwgRXF1aXBtZW50KVxufVxuXG4vKiogSW52ZW50b3J5IHRhYiB2YWx1ZXMgLSBPcmdhbml6ZWQgYnkgSXRlbSBDYXRlZ29yaWVzICovXG5leHBvcnQgZW51bSBJbnZlbnRvcnlUYWIge1xuICAvLyBNT0RFTF9JVEVNIHRhYnNcbiAgRElHSVRBTCAgICAgPSAnZGlnaXRhbCcsXG4gIEFSVFdPUktTICAgID0gJ2FydHdvcmtzJyxcbiAgU1RJQ0tFUlMgICAgPSAnc3RpY2tlcnMnLFxuICBQUklOVFMgICAgICA9ICdwcmludHMnLFxuICBNRVJDSCAgICAgICA9ICdtZXJjaCcsXG4gIFxuICAvLyBCVU5ETEVfSVRFTSB0YWJzXG4gIEJVTkRMRVMgICAgID0gJ2J1bmRsZXMnLCAgICAvLyBCdXNpbmVzcyBMb2dpYyBJdGVtcyAoQnVuZGxlcylcbiAgXG4gIC8vIFJFU09VUkNFX0lURU0gdGFic1xuICBNQVRFUklBTFMgICA9ICdtYXRlcmlhbHMnLFxuICBFUVVJUE1FTlQgICA9ICdlcXVpcG1lbnQnLFxufVxuXG4vKiogTGlmZWN5Y2xlIHN0YXRlIG9mIE9ORSBJdGVtIC9TS1UgKi9cbmV4cG9ydCBlbnVtIEl0ZW1TdGF0dXMge1xuICBDUkVBVEVEICAgICA9ICdDcmVhdGVkJyxcbiAgRk9SX1NBTEUgICAgPSAnRm9yIFNhbGUnLFxuICBTT0xEICAgICAgICA9ICdTb2xkJyxcbiAgVE9fT1JERVIgICAgPSAnVG8gT3JkZXInLFxuICBUT19ETyAgICAgICA9ICdUbyBEbycsXG4gIEdJRlRFRCAgICAgID0gJ0dpZnRlZCcsXG4gIFJFU0VSVkVEICAgID0gJ1Jlc2VydmVkJyxcbiAgT0JTT0xFVEUgICAgPSAnT2Jzb2xldGUnLFxuICBEQU1BR0VEICAgICA9ICdEYW1hZ2VkJyxcbiAgSURMRSAgICAgICAgPSAnSWRsZScsXG4gIENPTExFQ1RFRCAgID0gJ0NvbGxlY3RlZCcsXG4gIC8vIFRlbXBvcmFyeSB3aGlsZSBidWlsZGluZ1xuICBPTl9IT0xEICAgICA9ICdPbiBIb2xkJyxcbiAgU1RPUkVEICAgICAgPSAnU3RvcmVkJyxcbiAgVE9fUkVQQUlSICAgPSAnVG8gUmVwYWlyJyxcbn1cblxuLyoqIENyZWF0aXZlIGNvbGxlY3Rpb25zICovXG5leHBvcnQgZW51bSBDb2xsZWN0aW9uIHtcbiAgTk9fQ09MTEVDVElPTiAgICAgPSAnTm8gQ29sbGVjdGlvbicsXG4gIE9SR0FOSUNfSU1BR0lOQVJZID0gJ09yZ2FuaWMgSW1hZ2luYXJ5JyxcbiAgQU5JTUFMX0tJTkdET00gICAgPSAnQW5pbWFsIEtpbmdkb20nLFxuICBNVVNITEFORCAgICAgICAgICA9ICdNdXNobGFuZCcsXG4gIFNFVkVOX0VMRU1FTlRTICAgID0gJ1NldmVuIEVsZW1lbnRzJyxcbiAgQklUQ09JTiAgICAgICAgICAgPSAnQml0Y29pbicsXG4gIERPUEVfQ1JFVyAgICAgICAgID0gJ0RvcGUgQ3JldycsXG4gIFdPUkRTICAgICAgICAgICAgID0gJ1dvcmRzJyxcbiAgRlJVSVRTX1ZFR0dJRVMgICAgPSAnRnJ1aXRzICYgVmVnZ2llcycsXG4gIEZMT1dFUlMgICAgICAgICAgID0gJ0Zsb3dlcnMnLFxuICBLSU5HU19RVUVFTlMgICAgICA9ICdLaW5ncyAmIFF1ZWVucycsXG4gIFBPTFlHT05BTF9IRCAgICAgID0gJ1BvbHlnb25hbCBIRCcsXG4gIFJFTElRVUlBUyAgICAgICAgID0gJ1JlbGlxdWlhcycsXG4gIEJJVFVBWUEgICAgICAgICAgID0gJ0JpdHVheWEnLFxuICBMQU5EU0NBUEVTICAgICAgICA9ICdMYW5kc2NhcGVzJyxcbiAgRVhJTElBRE8gICAgICAgICAgPSAnRXhpbGlhZG8nLFxufVxuXG4vKiogSXRlbSBjYXRlZ29yaWVzIGZvciBVSSBvcmdhbml6YXRpb24gYW5kIFNlYXJjaGFibGVTZWxlY3QgZ3JvdXBpbmcgKi9cbmV4cG9ydCBjb25zdCBJVEVNX0NBVEVHT1JJRVMgPSB7XG4gIE1PREVMX0lURU06IFsnRElHSVRBTCcsICdBUlRXT1JLJywgJ1BSSU5UJywgJ1NUSUNLRVInLCAnTUVSQ0gnXSxcbiAgQlVORExFX0lURU06IFsnU1RJQ0tFUl9CVU5ETEUnLCAnUFJJTlRfQlVORExFJ10sXG4gIFJFU09VUkNFX0lURU06IFsnTUFURVJJQUwnLCAnRVFVSVBNRU5UJ11cbn0gYXMgY29uc3Q7XG5cblxuLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuLy8gU0FMRVMgRU5VTVNcbi8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cblxuLyoqIFNhbGVzIHRyYW5zYWN0aW9uIHR5cGVzICovXG5leHBvcnQgZW51bSBTYWxlVHlwZSB7XG4gIERJUkVDVCA9ICdESVJFQ1QnLFxuICBGRVJJQSA9ICdGRVJJQScsXG4gIEJVTkRMRV9TQUxFID0gJ0JVTkRMRScsXG4gIENPTlNJR05NRU5UID0gJ0NPTlNJR05NRU5UJyxcbiAgT05MSU5FID0gJ09OTElORScsXG4gIE5GVCA9ICdORlQnLFxufVxuXG4vKiogQ2FzaC1kcmF3ZXIgc3RhdGUgKi9cbmV4cG9ydCBlbnVtIFNhbGVzU2Vzc2lvblN0YXR1cyB7XG4gIFBFTkRJTkdfUkVDT05DSUxJQVRJT04gPSAnUGVuZGluZyBSZWNvbmNpbGlhdGlvbicsXG4gIFJFQ09OQ0lMRUQgICAgICAgICAgICAgPSAnUmVjb25jaWxlZCcsXG59XG5cbi8qKiBTYWxlcyB0cmFuc2FjdGlvbiBzdGF0dXMgKi9cbmV4cG9ydCBlbnVtIFNhbGVTdGF0dXMge1xuICBQRU5ESU5HID0gJ1BFTkRJTkcnLCAgICAgIC8vIFNhbGUgaXNOb3RDaGFyZ2VkXG4gIE9OX0hPTEQgPSAnT05fSE9MRCcsICAgICAgLy8gV2FpdGluZyBmb3Igb3RoZXIgcmVhc29uc1xuICBDSEFSR0VEID0gJ0NIQVJHRUQnLCAgICAgIC8vIFNhbGUgaXMgQ2hhcmdlZFxuICBDQU5DRUxMRUQgPSAnQ0FOQ0VMTEVEJywgIC8vIFNhbGUgaXMgQ2FuY2VsbGVkXG59XG5cbi8qKiBQYXltZW50IG1ldGhvZHMgZm9yIHNhbGVzICovXG5leHBvcnQgZW51bSBQYXltZW50TWV0aG9kIHtcbiAgLy8gUmVndWxhciBwYXltZW50IG1ldGhvZHNcbiAgRklBVF9VU0QgPSAgICAgICckIENBU0gnLFxuICBGSUFUX0NSQyA9ICAgICAgJ+KCoSBDQVNIJyxcbiAgQlRDID0gICAgICAgICAgICdCSVRDT0lOJyxcbiAgQ0FSRCA9ICAgICAgICAgICdDQVJEJyxcbiAgU0lOUEUgPSAgICAgICAgICdTSU5QRScsXG4gIFBBWVBBTCA9ICAgICAgICAnUEFZUEFMJyxcbiAgV0lSRV9UUkFOU0ZFUiA9ICdXSVJFJyxcbiAgXG4gIC8vIFNwZWNpYWwgcGF5bWVudCBtZXRob2RzXG4gIEdJRlQgPSAgICAgICAgICAnR0lGVCcsXG4gIEVYQ0hBTkdFID0gICAgICAnRVhDSEFOR0UnLFxuICBPVEhFUiA9ICAgICAgICAgJ09USEVSJyxcbn1cblxuLyoqIFBheW1lbnQgbWV0aG9kIGNhdGVnb3JpZXMgZm9yIFVJIG9yZ2FuaXphdGlvbiAqL1xuZXhwb3J0IGNvbnN0IFBBWU1FTlRfTUVUSE9EX0NBVEVHT1JJRVMgPSB7XG4gIFJFR1VMQVI6IFsnRklBVF9VU0QnLCAnRklBVF9DUkMnLCAnQlRDJywgJ0NBUkQnLCAnU0lOUEUnLCAnUEFZUEFMJywgJ1dJUkVfVFJBTlNGRVInXSxcbiAgU1BFQ0lBTDogWydHSUZUJywgJ0VYQ0hBTkdFJywgJ09USEVSJ11cbn0gYXMgY29uc3Q7XG5cbi8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cbi8vIENIQVJBQ1RFUiBFTlVNU1xuLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuXG4vKiogQ2hhcmFjdGVyIHJvbGVzICovXG5leHBvcnQgZW51bSBDaGFyYWN0ZXJSb2xlIHtcbiAgRk9VTkRFUiAgICAgICA9ICdmb3VuZGVyJyxcbiAgUExBWUVSICAgICAgICA9ICdwbGF5ZXInLFxuICBQQURBV0FOICAgICAgID0gJ3BhZGF3YW4nLFxuICBJTlZFU1RPUiAgICAgID0gJ2ludmVzdG9yJyxcbiAgVEVBTSAgICAgICAgICA9ICd0ZWFtJyxcbiAgRkFNSUxZICAgICAgICA9ICdmYW1pbHknLFxuICBGUklFTkQgICAgICAgID0gJ2ZyaWVuZCcsXG4gIEFETUlOICAgICAgICAgPSAnYWRtaW4nLFxuICBERVNJR05FUiAgICAgID0gJ2Rlc2lnbmVyJyxcbiAgUFJPRFVDRVIgICAgICA9ICdwcm9kdWNlcicsXG4gIFNFTExFUiAgICAgICAgPSAnc2VsbGVyJyxcbiAgUkVTRUFSQ0hFUiAgICA9ICdyZXNlYXJjaGVyJyxcbiAgREVWRUxPUEVSICAgICA9ICdkZXZlbG9wZXInLFxuICBBSV9BR0VOVCAgICAgID0gJ2FpLWFnZW50JyxcbiAgQVNTT0NJQVRFICAgICA9ICdhc3NvY2lhdGUnLFxuICBDT0xMQUJPUkFUT1IgID0gJ2NvbGxhYm9yYXRvcicsXG4gIENVU1RPTUVSICAgICAgPSAnY3VzdG9tZXInLFxuICBTVFVERU5UICAgICAgID0gJ3N0dWRlbnQnLFxuICBPVEhFUiAgICAgICAgID0gJ290aGVyJ1xufVxuXG4vKiogQ2hhcmFjdGVyIHJvbGUgdHlwZXMgZm9yIFVJIG9yZ2FuaXphdGlvbiBhbmQgcGVybWlzc2lvbnMgKi9cbmV4cG9ydCBjb25zdCBDSEFSQUNURVJfUk9MRV9UWVBFUyA9IHtcbiAgUkVHVUxBUjogWydhZG1pbicsICdkZXNpZ25lcicsICdwcm9kdWNlcicsICdzZWxsZXInLCAncmVzZWFyY2hlcicsICdkZXZlbG9wZXInLCAnYXNzb2NpYXRlJywgJ2NvbGxhYm9yYXRvcicsICdjdXN0b21lcicsICdzdHVkZW50JywgJ2FpLWFnZW50JywgJ290aGVyJ10sXG4gIFNQRUNJQUw6IFsnZm91bmRlcicsICdwbGF5ZXInLCAncGFkYXdhbicsICd0ZWFtJywgJ2ZhbWlseScsICdmcmllbmQnLCAnaW52ZXN0b3InIF1cbn0gYXMgY29uc3Q7XG5cbmV4cG9ydCBlbnVtIEludGVsZWN0dWFsRnVuY3Rpb24ge1xuICBTRUxGX0FXQVJFICAgICAgPSAnU2VsZiBBd2FyZW5lc3MnLCAgICAgLy8gU2VsZi1tb25pdG9yaW5nIC8gZXJyb3IgbW9uaXRvcmluZzogTm90aWNlIHBlcmZvcm1hbmNlIGRyaWZ0LCBjYXRjaCBtaXN0YWtlcywgYWRqdXN0IGluLWZsaWdodC5cbiAgRU1PVElPTl9DT05UUk9MID0gJ0Vtb3Rpb24gQ29udHJvbCcsICAgIC8vIEVtb3Rpb25hbCByZWd1bGF0aW9uOiBNb2R1bGF0ZSBmcnVzdHJhdGlvbiwgc3RyZXNzLCBhbmQgcmV3YXJkLXNlZWtpbmcgc28geW91IGNhbiBleGVjdXRlLlxuICBERUNJU0lPTl9NQUtJTkcgPSAnRGVjaXNpb24gTWFraW5nJywgICAgLy8gRGVjaXNpb24tbWFraW5nICh2YWx1YXRpb24gJiByaXNrKTogQ2hvb3NlIHVuZGVyIHVuY2VydGFpbnR5OyB3ZWlnaCBjb3N0L2JlbmVmaXQgYW5kIHJpc2suXG4gIENSRUFUSVZJVFkgICAgICA9ICdDcmVhdGl2aXR5JywgICAgICAgICAvLyBhYmlsaXR5IHRvIGdlbmVyYXRlIG9yaWdpbmFsIGlkZWFzLCB2aWV3IHNpdHVhdGlvbnMgZnJvbSBuZXcgcGVyc3BlY3RpdmVzLCBhbmQgcHJvZHVjZSBub3ZlbCBvdXRjb21lcy4gXG4gIFBST0JMRU1fU09MVklORyA9ICdQcm9ibGVtIFNvbHZpbmcnLCAgICAvLyBQcm9ibGVtIHNvbHZpbmcgKHN0cmF0ZWd5IGdlbmVyYXRpb24pOiBEaWFnbm9zZSBibG9ja2VycywgZ2VuZXJhdGUgb3B0aW9ucywgdGVzdCBhbmQgaXRlcmF0ZS5cbiAgU0VMRl9DT05UUk9MICAgID0gJ1NlbGYgQ29udHJvbCcsICAgICAgIC8vIEluaGliaXRvcnkgY29udHJvbDogUmVzaXN0IGltcHVsc2VzIGFuZCBkZWxheSBncmF0aWZpY2F0aW9uIHRvIHN0YXkgYWxpZ25lZCB3aXRoIGdvYWxzLlxuICBXT1JLX01FTU9SWSAgICAgPSAnV29ya2luZyBNZW1vcnknLCAgICAgLy8gSG9sZCBhbmQgbWFuaXB1bGF0ZSBpbmZvcm1hdGlvbiBpbiBtaW5kIHdoaWxlIGFjdGluZy5cbiAgQURBUFRBQklMSVRZICAgID0gJ0FkYXB0YWJpbGl0eScsICAgICAgIC8vIENvZ25pdGl2ZSBmbGV4aWJpbGl0eTogU3dpdGNoIHRhc2tzL3N0cmF0ZWdpZXMgYW5kIGFkYXB0IHdoZW4gY29uZGl0aW9ucyBjaGFuZ2UuXG4gIElOSVRJQVRJVkUgICAgICA9ICdJbml0aWF0aXZlJywgICAgICAgICAvLyBUYXNrIGluaXRpYXRpb246IFN0YXJ0IHdpdGhvdXQgb3Zlci1wcmVwcGluZywgcGVyZmVjdGlvbmlzbSwgb3IgYXZvaWRhbmNlLlxuICBQTEFOTklORyAgICAgICAgPSAnUGxhbm5pbmcnLCAgICAgICAgICAgLy8gUGxhbm5pbmcgJiBwcmlvcml0aXphdGlvbjogQ2hvb3NlIHN0cmF0ZWd5LCBvcmRlciBzdGVwcywgYW5kIGRlY2lkZSB3aGF0IG1hdHRlcnMgbm93IHZzIGxhdGVyLlxuICBPUkdBTklaQVRJT04gICAgPSAnT3JnYW5pemF0aW9uJywgICAgICAgLy8gT3JnYW5pemF0aW9uICYgc2VxdWVuY2luZzogU3RydWN0dXJlIGluZm8sIGFzc2V0cywgYW5kIHN0ZXBzIGludG8gd29ya2FibGUgc2VxdWVuY2VzLlxuICBUSU1FX01OR00gICAgICAgPSAnVGltZSBNYW5hZ2VtZW50JywgICAgLy8gVGltZSBtYW5hZ2VtZW50ICYgZXN0aW1hdGlvbjogRXN0aW1hdGUgZHVyYXRpb25zLCBwYWNlIHdvcmssIHJlc3BlY3QgdGltZWJveGVzLCBmaW5pc2ggb24gdGltZS5cbiAgQ09OQ0VOVFJBVElPTiAgID0gJ0NvbmNlbnRyYXRpb24nLCAgICAgIC8vIFN1c3RhaW5lZCBhdHRlbnRpb24gKGZvY3VzKTogTWFpbnRhaW4gZW5nYWdlbWVudCwgcmVkdWNlIGRpc3RyYWN0aWJpbGl0eS5cbiAgREVURVJNSU5BVElPTiAgID0gJ0RldGVybWluYXRpb24nLCAgICAgIC8vIEdvYWwtZGlyZWN0ZWQgcGVyc2lzdGVuY2U6IEtlZXAgYWR2YW5jaW5nIGxvbmcgYXJjcyBkZXNwaXRlIGZyaWN0aW9uIG9yIGJvcmVkb20uXG59XG5cbmV4cG9ydCBlbnVtIEF0dHJpYnV0ZSB7XG4gIFBFUkNFUFRJT04gICAgICAgICAgICA9ICdQZXJjZXB0aW9uJywgICAgIC8vIGFsc28gcmVjdGlvblxuICBMT0dJQyAgICAgICAgICAgICAgICAgPSAnTG9naWMnLCAgICAgICAgICAvLyBhbHNvIGFuYWx5c2lzXG4gIEZJVE5FU1MgICAgICAgICAgICAgICA9ICdGaXRuZXNzJywgICAgICAgIC8vIGFsc28gc3RyZW5ndGgsIHBoeXNpY2FsIGF0dHJhY3RpdmVuZXNzLCBwaHlzaWNhbCBoZWFsdGhcbiAgQ0hBUklTTUEgICAgICAgICAgICAgID0gJ0NoYXJpc21hJywgICAgICAgLy8gYWxzbyBjaGFybVxuICBXSVNET00gICAgICAgICAgICAgICAgPSAnV2lzZG9tJywgICAgICAgICAvLyBhbHNvIGtub3dsZWRnZVxuICBMRUFERVJTSElQICAgICAgICAgICAgPSAnTGVhZGVyc2hpcCcsICAgICAvLyBhbHNvIGF1dGhvcml0eVxuICBDT01NVU5JQ0FUSU9OICAgICAgICAgPSAnQ29tbXVuaWNhdGlvbicsICAvLyBhbHNvIHJoZXRvcmljXG4gIFZJU0lPTiAgICAgICAgICAgICAgICA9ICdWaXNpb24nLFxuICBSRVNJTElFTkNFICAgICAgICAgICAgPSAnUmVzaWxpZW5jZScsICAgICAvLyBhbHNvIGVuZHVyYW5jZVxuICBFTVBBVEhZICAgICAgICAgICAgICAgPSAnRW1wYXRoeScsICAgXG4gIElOVEVHUklUWSAgICAgICAgICAgICA9ICdJbnRlZ3JpdHknLCAgICAgIC8vIGFsc28gaG9uZXN0eVxufVxuXG5leHBvcnQgZW51bSBTa2lsbCB7XG4gIERFU0lHTl9USElOS0lORyAgICAgICA9ICdEZXNpZ24gVGhpbmtpbmcnLFxuICBQUk9KRUNUX01BTkFHRU1FTlQgICAgPSAnUHJvamVjdCBNYW5hZ2VtZW50JyxcbiAgVEVBQ0hJTkcgICAgICAgICAgICAgID0gJ1RlYWNoaW5nJyxcbiAgTkVHT1RJQVRJT04gICAgICAgICAgID0gJ05lZ290aWF0aW9uJyxcbiAgTkFSUkFUSVZFICAgICAgICAgICAgID0gJ05hcnJhdGl2ZScsXG4gIERFVkVMT1BJTkcgICAgICAgICAgICA9ICdEZXZlbG9waW5nJyxcbiAgSEFORENSQUZUSU5HICAgICAgICAgID0gJ0hhbmRjcmFmdGluZycsXG4gIFBBSU5USU5HICAgICAgICAgICAgICA9ICdQYWludGluZycsXG4gIElMTFVTVFJBVElPTiAgICAgICAgICA9ICdJbGx1c3RyYXRpb24nLFxufVxuXG4vKiogU2tpbGxzIGNhdGVnb3JpZXMgZm9yIFVJIG9yZ2FuaXphdGlvbiBhbmQgU2VhcmNoYWJsZVNlbGVjdCBncm91cGluZyAqL1xuZXhwb3J0IGNvbnN0IFNLSUxMU19DQVRFR09SSUVTID0ge1xuICBDT0dOSVRJVkU6IFtcbiAgICAnU0VMRl9BV0FSRScsICdFTU9USU9OX0NPTlRST0wnLCAnREVDSVNJT05fTUFLSU5HJywgJ0NSRUFUSVZJVFknLCBcbiAgICAnUFJPQkxFTV9TT0xWSU5HJywgJ1NFTEZfQ09OVFJPTCcsICdXT1JLX01FTU9SWScsICdBREFQVEFCSUxJVFknLCBcbiAgICAnSU5JVElBVElWRScsICdQTEFOTklORydcbiAgXSxcbiAgQ0hBUkFDVEVSOiBbXG4gICAgJ1BFUkNFUFRJT04nLCAnTE9HSUMnLCAnRklUTkVTUycsICdDSEFSSVNNQScsICdXSVNET00nLCBcbiAgICAnTEVBREVSU0hJUCcsICdDT01NVU5JQ0FUSU9OJywgJ1ZJU0lPTicsICdSRVNJTElFTkNFJywgJ0VNUEFUSFknXG4gIF0sXG4gIFBSQUNUSUNBTDogW1xuICAgICdERVNJR05fVEhJTktJTkcnLCAnUFJPSkVDVF9NQU5BR0VNRU5UJywgJ1RFQUNISU5HJywgJ05FR09USUFUSU9OJywgXG4gICAgJ05BUlJBVElWRScsICdERVZFTE9QSU5HJywgJ0hBTkRDUkFGVElORycsICdQQUlOVElORycsICdJTExVU1RSQVRJT04nXG4gIF1cbn0gYXMgY29uc3Q7XG5cbmV4cG9ydCBlbnVtIENvbW1Db2xvciB7XG4gIFJFRCAgICAgICAgICAgICAgID0gJ1JlZCcsICAgICAgICAgICAgICAgLy8gRXhwbGFpbmVkIGluIGRldGFpbCBsYXRlclxuICBZRUxMT1cgICAgICAgICAgICA9ICdZZWxsb3cnLCAgICAgICAgICAgIC8vIEV4cGxhaW5lZCBpbiBkZXRhaWwgbGF0ZXJcbiAgR1JFRU4gICAgICAgICAgICAgPSAnR3JlZW4nLCAgICAgICAgICAgICAvLyBFeHBsYWluZWQgaW4gZGV0YWlsIGxhdGVyXG4gIEJMVUUgICAgICAgICAgICAgID0gJ0JsdWUnLCAgICAgICAgICAgICAgLy8gRXhwbGFpbmVkIGluIGRldGFpbCBsYXRlclxuICBQVVJQTEUgICAgICAgICAgICA9ICdQdXJwbGUnLCAgICAgICAgICAgIC8vIEV4cGxhaW5lZCBpbiBkZXRhaWwgbGF0ZXJcbiAgT1JBTkdFICAgICAgICAgICAgPSAnT3JhbmdlJywgICAgICAgICAgICAvLyBFeHBsYWluZWQgaW4gZGV0YWlsIGxhdGVyXG4gIFRVUlFVT0lTRSAgICAgICAgID0gJ1R1cnF1b2lzZScsICAgICAgICAgLy8gRXhwbGFpbmVkIGluIGRldGFpbCBsYXRlclxuICBCUk9XTiAgICAgICAgICAgICA9ICdCcm93bicsICAgICAgICAgICAgICAvLyBSQVJFOiBSZWQtR3JlZW4sIFBhY2lmaWMgQm9zc3ksIHRyYWl0cyB1bmtub3duXG4gIFlFTExPV19CTFVFICAgICAgID0gJ1llbGxvdy1CbHVlJywgICAgICAgIC8vIFJBUkU6IFllbGxvdy1CbHVlLCBKb3lmdWwgVGVjaGluaWNhbCwgdHJhaXRzIHVua25vd25cbiAgWUVMTE9XX0dSRUVOICAgICAgPSAnWWVsbG93LUdyZWVuJywgICAgICAgLy8gUkFSRTogWWVsbG93LUdyZWVuLCBQYWNpZmljIEpveWZ1bCwgcG9zc2libHkgYSBCb2IgTWFybGV5XG59XG5cbi8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cbi8vIExJTksgJiBFTlRJVFkgRU5VTVNcbi8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cblxuLyoqIExpbmsgVHlwZXMgLSBUaGUgUm9zZXR0YSBTdG9uZSBDb21tdW5pY2F0aW9uIFBhdHRlcm4gKi9cbmV4cG9ydCBlbnVtIExpbmtUeXBlIHtcbiAgLy8gVEFTSyByZWxhdGlvbnNoaXBzXG4gIFRBU0tfSVRFTSAgICAgICAgID0gJ1RBU0tfSVRFTScsICAgICAgLy8gVGFzayBjcmVhdGVkIEl0ZW1cbiAgVEFTS19GSU5SRUMgICAgICAgPSAnVEFTS19GSU5SRUMnLCAgICAvLyBUYXNrIGxpbmtlZCB0byBGaW5hbmNpYWwgUmVjb3JkXG4gIFRBU0tfU0FMRSAgICAgICAgID0gJ1RBU0tfU0FMRScsICAgICAgLy8gVGFzayBzcGF3bmVkIGZyb20gU2FsZVxuICBUQVNLX1BMQVlFUiAgICAgICA9ICdUQVNLX1BMQVlFUicsICAgIC8vIFRhc2sgZWFybmVkIFBsYXllciBwb2ludHMgKG9ubHkgZm9yIFBMQVlFUlMpXG4gIFRBU0tfQ0hBUkFDVEVSICAgID0gJ1RBU0tfQ0hBUkFDVEVSJywgLy8gVGFzayBhc3NpZ25lZCB0byBDaGFyYWN0ZXIgKGN1c3RvbWVyLCB0ZWFtIG1lbWJlciwgZXRjLilcbiAgVEFTS19TSVRFICAgICAgICAgPSAnVEFTS19TSVRFJywgICAgICAvLyBUYXNrIGlzIHBlcmZvcm1lZCBhdCBhIFNpdGVcbiAgXG4gIC8vIElURU0gcmVsYXRpb25zaGlwc1xuICBJVEVNX1RBU0sgICAgICAgICA9ICdJVEVNX1RBU0snLCAgICAgIC8vIEl0ZW0gd2FzIGNyZWF0ZWQgYnkgVGFza1xuICBJVEVNX1NBTEUgICAgICAgICA9ICdJVEVNX1NBTEUnLCAgICAgIC8vIEl0ZW0gd2FzIHNvbGQgaW4gU2FsZVxuICBJVEVNX0ZJTlJFQyAgICAgICA9ICdJVEVNX0ZJTlJFQycsICAgIC8vIEl0ZW0gdHJhY2tlZCBpbiBGaW5hbmNpYWwgUmVjb3JkXG4gIElURU1fUExBWUVSICAgICAgID0gJ0lURU1fUExBWUVSJywgICAgLy8gSXRlbSBlYXJuZWQgUGxheWVyIHBvaW50cyAob25seSBmb3IgUExBWUVSUylcbiAgSVRFTV9DSEFSQUNURVIgICAgPSAnSVRFTV9DSEFSQUNURVInLCAvLyBJdGVtIG93bmVkIGJ5IENoYXJhY3RlciAoY3VzdG9tZXIsIHRlYW0gbWVtYmVyLCBldGMuKVxuICBJVEVNX1NJVEUgICAgICAgICA9ICdJVEVNX1NJVEUnLCAgICAgIC8vIEl0ZW0gaXMgbG9jYXRlZCBhdCBhIFNpdGVcblxuICAvLyBTQUxFIHJlbGF0aW9uc2hpcHNcbiAgU0FMRV9UQVNLICAgICAgICAgPSAnU0FMRV9UQVNLJywgICAgICAvLyBTYWxlIGNyZWF0ZWQgVGFza1xuICBTQUxFX0lURU0gICAgICAgICA9ICdTQUxFX0lURU0nLCAgICAgIC8vIFNhbGUgc29sZCBJdGVtXG4gIFNBTEVfRklOUkVDICAgICAgID0gJ1NBTEVfRklOUkVDJywgICAgLy8gU2FsZSBsaW5rZWQgdG8gRmluYW5jaWFsIFJlY29yZFxuICBTQUxFX1BMQVlFUiAgICAgICA9ICdTQUxFX1BMQVlFUicsICAgIC8vIFNhbGUgZWFybmVkIFBsYXllciBwb2ludHMgKG9ubHkgZm9yIFBMQVlFUlMpXG4gIFNBTEVfQ0hBUkFDVEVSICAgID0gJ1NBTEVfQ0hBUkFDVEVSJywgLy8gU2FsZSBjdXN0b21lciBpcyBDaGFyYWN0ZXIgKGN1c3RvbWVyLCB0ZWFtIG1lbWJlciwgZXRjLilcbiAgU0FMRV9TSVRFICAgICAgICAgPSAnU0FMRV9TSVRFJywgICAgICAvLyBTYWxlIGlzIHBlcmZvcm1lZCBhdCBhIFNpdGVcbiAgXG4gIC8vIEZJTkFOQ0lBTCBSRUNPUkQgcmVsYXRpb25zaGlwc1xuICBGSU5SRUNfVEFTSyAgICAgICA9ICdGSU5SRUNfVEFTSycsICAgIC8vIEZpbmFuY2lhbCBSZWNvcmQgdHJhY2tzIFRhc2tcbiAgRklOUkVDX0lURU0gICAgICAgPSAnRklOUkVDX0lURU0nLCAgICAvLyBGaW5hbmNpYWwgUmVjb3JkIHRyYWNrcyBJdGVtXG4gIEZJTlJFQ19TQUxFICAgICAgID0gJ0ZJTlJFQ19TQUxFJywgICAgLy8gRmluYW5jaWFsIFJlY29yZCBsaW5rZWQgdG8gU2FsZVxuICBGSU5SRUNfUExBWUVSICAgICA9ICdGSU5SRUNfUExBWUVSJywgIC8vIEZpbmFuY2lhbCBSZWNvcmQgZWFybmVkIFBsYXllciBwb2ludHMgKG9ubHkgZm9yIFBMQVlFUlMpXG4gIEZJTlJFQ19DSEFSQUNURVIgID0gJ0ZJTlJFQ19DSEFSQUNURVInLCAvLyBGaW5hbmNpYWwgUmVjb3JkIGFzc2lnbmVkIHRvIENoYXJhY3RlciAoY3VzdG9tZXIsIHRlYW0gbWVtYmVyLCBldGMuKVxuICBGSU5SRUNfU0lURSAgICAgICA9ICdGSU5SRUNfU0lURScsICAgICAgLy8gRmluYW5jaWFsIFJlY29yZCBpcyByZWxhdGVkIHRvIGEgU2l0ZVxuICBcbiAgLy8gQ0hBUkFDVEVSIHJlbGF0aW9uc2hpcHNcbiAgQ0hBUkFDVEVSX1RBU0sgICAgPSAnQ0hBUkFDVEVSX1RBU0snLCAgICAgLy8gQ2hhcmFjdGVyIGFzc2lnbmVkIHRvIFRhc2sgKGN1c3RvbWVyLCB0ZWFtIG1lbWJlciwgZXRjLilcbiAgQ0hBUkFDVEVSX0lURU0gICAgPSAnQ0hBUkFDVEVSX0lURU0nLCAgICAgLy8gQ2hhcmFjdGVyIG93bnMvcG9zc2Vzc2VzIHRoaXMgSXRlbSAoY3VzdG9tZXIsIHRlYW0gbWVtYmVyLCBldGMuKVxuICBDSEFSQUNURVJfU0FMRSAgICA9ICdDSEFSQUNURVJfU0FMRScsICAgICAvLyBDaGFyYWN0ZXIgaXMgY3VzdG9tZXIgb2YgdGhpcyBTYWxlIChjdXN0b21lciwgdGVhbSBtZW1iZXIsIGV0Yy4pXG4gIENIQVJBQ1RFUl9GSU5SRUMgID0gJ0NIQVJBQ1RFUl9GSU5SRUMnLCAgIC8vIENoYXJhY3RlciBpcyBhc3NpZ25lZCB0byB0aGlzIEZpbmFuY2lhbCBSZWNvcmQgKGN1c3RvbWVyLCB0ZWFtIG1lbWJlciwgZXRjLilcbiAgQ0hBUkFDVEVSX1NJVEUgICAgPSAnQ0hBUkFDVEVSX1NJVEUnLCAgICAgLy8gQ2hhcmFjdGVyIGlzIHJlbGF0ZWQgdG8gYSBTaXRlIChvd25lciwgbGl2ZXMgYXQsIHdvcmtzIGF0LCBjdXN0b21lciBvZiwgZXRjLilcbiAgQ0hBUkFDVEVSX1BMQVlFUiAgPSAnQ0hBUkFDVEVSX1BMQVlFUicsICAgLy8gV2hlbiBhIENoYXJhY3RlciBiZWxvbmdzIHRvIGEgUGxheWVyXG5cbiAgLy8gU0lURSByZWxhdGlvbnNoaXBzIChsb2NhdGlvbnMgYW5kIHBsYWNlcylcbiAgU0lURV9UQVNLICAgICAgICAgPSAnU0lURV9UQVNLJywgLy8gU2l0ZSBoYXMgVGFza3MgcGVyZm9ybWVkIHRoZXJlIChyZXZlcnNlKVxuICBTSVRFX0NIQVJBQ1RFUiAgICA9ICdTSVRFX0NIQVJBQ1RFUicsIC8vIFNpdGUgaGFzIGEgcmVsYXRlZCBDaGFyYWN0ZXIgKHJldmVyc2UpXG4gIFNJVEVfRklOUkVDICAgICAgID0gJ1NJVEVfRklOUkVDJywgICAgLy8gU2l0ZSBoYXMgYSByZWxhdGVkIEZpbmFuY2lhbCBSZWNvcmQgKHJldmVyc2UpXG4gIFNJVEVfSVRFTSAgICAgICAgID0gJ1NJVEVfSVRFTScsICAgICAgLy8gU2l0ZSBoYXMgYSByZWxhdGVkIEl0ZW0gKHJldmVyc2UpXG4gIFNJVEVfU0FMRSAgICAgICAgID0gJ1NJVEVfU0FMRScsICAgICAgLy8gU2l0ZSBoYXMgYSByZWxhdGVkIFNhbGUgKHJldmVyc2UpXG4gIFNJVEVfU0lURSAgICAgICAgID0gJ1NJVEVfU0lURScsICAgICAgLy8gU2l0ZSBjb25uZWN0ZWQgdG8gYW5vdGhlciBTaXRlIChpbnZlbnRvcnkgbW92ZW1lbnQsIGxvZ2lzdGljcywgZXRjLilcblxuICAvLyBQTEFZRVIgcmVsYXRpb25zaGlwc1xuICBQTEFZRVJfVEFTSyAgICAgICA9ICdQTEFZRVJfVEFTSycsIC8vIFBsYXllciBoYXMgVGFza3MgUG9pbnRzIChyZXZlcnNlKVxuICBQTEFZRVJfU0FMRSAgICAgICA9ICdQTEFZRVJfU0FMRScsIC8vIFBsYXllciBoYXMgU2FsZXMgUG9pbnRzIChyZXZlcnNlKVxuICBQTEFZRVJfRklOUkVDICAgICA9ICdQTEFZRVJfRklOUkVDJywgLy8gUGxheWVyIGl0cyB0aWVkIHRvIHRoaXMgRmluYW5jaWFsIFJlY29yZCAocmV2ZXJzZSlcbiAgUExBWUVSX0lURU0gICAgICAgPSAnUExBWUVSX0lURU0nLCAvLyBQbGF5ZXIgb3ducy9wb3NzZXNzZXMgdGhpcyBJdGVtIChyZXZlcnNlKVxuICBQTEFZRVJfQ0hBUkFDVEVSICA9ICdQTEFZRVJfQ0hBUkFDVEVSJywgLy8gUGxheWVyIGludGVyYWN0cyB3aXRoIG9yIG1hbmFnZXMgdGhpcyBDaGFyYWN0ZXIgKHJldmVyc2UpXG4gIFxuICAvLyBBQ0NPVU5UIHJlbGF0aW9uc2hpcHMgKGF1dGhlbnRpY2F0aW9uICYgaWRlbnRpdHkpXG4gIEFDQ09VTlRfUExBWUVSICAgID0gJ0FDQ09VTlRfUExBWUVSJywgICAgLy8gQWNjb3VudCBvd25zIFBsYXllciAob3B0aW9uYWwpXG4gIEFDQ09VTlRfQ0hBUkFDVEVSID0gJ0FDQ09VTlRfQ0hBUkFDVEVSJywgLy8gQWNjb3VudCBvd25zIENoYXJhY3RlciAocmVxdWlyZWQpXG4gIFBMQVlFUl9BQ0NPVU5UICAgID0gJ1BMQVlFUl9BQ0NPVU5UJywgICAgLy8gUGxheWVyIGJlbG9uZ3MgdG8gQWNjb3VudCAocmV2ZXJzZSlcbiAgQ0hBUkFDVEVSX0FDQ09VTlQgPSAnQ0hBUkFDVEVSX0FDQ09VTlQnLCAvLyBDaGFyYWN0ZXIgYmVsb25ncyB0byBBY2NvdW50IChyZXZlcnNlKVxufVxuXG4vKiogRW50aXR5IFR5cGVzIGZvciBMaW5rIFN5c3RlbSAqL1xuZXhwb3J0IGVudW0gRW50aXR5VHlwZSB7XG4gIFRBU0sgICAgICAgICAgPSAndGFzaycsICAgICAgICAgICAgLy8gVGFza3MgTWlzc2lvbnMsIE1pbGVzdG9uZXMsIEdvYWxzLCBBc3NpZ25tZW50cywgYW5kIFJlY3VycmVudHMgVHJlZVxuICBJVEVNICAgICAgICAgID0gJ2l0ZW0nLCAgICAgICAgICAgIC8vIEl0ZW1zIHdpdGggSW52ZW50b3J5IGFuZCBTdG9jayB0cmFja2luZ1xuICBTQUxFICAgICAgICAgID0gJ3NhbGUnLCAgICAgICAgICAgIC8vIFNhbGVzIHdpdGggbGluZXMgYW5kIFBheW1lbnQgTWV0aG9kc1xuICBGSU5BTkNJQUwgICAgID0gJ2ZpbmFuY2lhbCcsICAgLy8gRmluYW5jaWFsIFJlY29yZFMgYW5kIERvbmUgVGFza3NcbiAgQ0hBUkFDVEVSICAgICA9ICdjaGFyYWN0ZXInLCAgIC8vIE1haW4gZW50aXR5IC0gQ2hhcmFjdGVycyBjYW4gaGF2ZSBtdWx0aXBsZSByb2xlcyAoRk9VTkRFUiwgUExBWUVSLCBDVVNUT01FUiwgZXRjLilcbiAgU0lURSAgICAgICAgICA9ICdzaXRlJywgICAgICAgICAgICAvLyBTaXRlcyBhbmQgbG9jYXRpb25zIGNhbiBub3cgYmUgbGlua2VkIHRvIFRhc2tzLCBTYWxlcyBhbmQgb3RoZXIgZW50aXRpZXNcbiAgUExBWUVSICAgICAgICA9ICdwbGF5ZXInLCAgICAgICAgLy8gUGxheWVycyBhcmUgcmVhbCBwZW9wbGUgd2l0aCBhdXRoZW50aWNhdGlvbiBhbmQgcHJvZ3Jlc3Npb25cbiAgQUNDT1VOVCAgICAgICA9ICdhY2NvdW50JywgICAgICAgLy8gQWNjb3VudHMgZW50aXR5IGZvciBhdXRoZW50aWNhdGlvbiBsb2dpbiBhbmQgYXJlIGNoYXJhY3RlciBhbmQgcGxheWVyIGxpbmtlZFxufVxuXG4vLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG4vLyBOT1RFIFNZU1RFTVxuLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuXG4vKiogTm90ZSBjb2xvciB0aGVtZXMgLSBtYXBwZWQgdG8gYnVzaW5lc3Mgc3RydWN0dXJlICovXG5leHBvcnQgZW51bSBOb3RlQ29sb3Ige1xuICBXSElURSAgID0gJ3doaXRlJywgICAgLy8gR2VuZXJhbCwgbmV1dHJhbFxuICBPUkFOR0UgID0gJ29yYW5nZScsICAgLy8gSWRlYXMsIGNyZWF0aXZpdHlcbiAgUFVSUExFICA9ICdwdXJwbGUnLCAgIC8vIEFkbWluLCBzdHJhdGVneSwgbWFuYWdlbWVudFxuICBHUkVFTiAgID0gJ2dyZWVuJywgICAgLy8gRGVzaWduLCBjcmVhdGl2ZSBwcm9jZXNzZXNcbiAgQkxVRSAgICA9ICdibHVlJywgICAgIC8vIFJlc2VhcmNoLCBzdHVkaWVzLCBkZXZlbG9wbWVudFxuICBZRUxMT1cgID0gJ3llbGxvdycsICAgLy8gUHJvZHVjdGlvbiwgbWFudWZhY3R1cmluZ1xuICBQSU5LICAgID0gJ3BpbmsnLCAgICAgLy8gU2FsZXMsIG1hcmtldGluZ1xuICBSRUQgICAgID0gJ3JlZCcsICAgICAgLy8gQ2hhbGxlbmdlcywgcHJvYmxlbXMsIHVyZ2VudFxuICBHUkFZICAgID0gJ2dyYXknICAgICAgLy8gUGVyc29uYWwsIHByaXZhdGVcbn1cblxuLyoqIE5vdGVib29rIHR5cGVzIGZvciB0aGUgbm90ZS10YWtpbmcgc3lzdGVtICovXG5leHBvcnQgZW51bSBOb3RlYm9va1R5cGUge1xuICBBTExfTk9URVMgICAgICA9ICdhbGwnLFxuICBDVVJSRU5UX1NQUklOVCA9ICdjdXJyZW50X3NwcmludCcsXG4gIENIQUxMRU5HRVMgICAgID0gJ2NoYWxsZW5nZXMnLFxuICBST0FEX0FIRUFEICAgICA9ICdyb2FkX2FoZWFkJyxcbiAgU1RSQVRFR1kgICAgICAgPSAnc3RyYXRlZ3knLFxuICBJREVBUyAgICAgICAgICA9ICdpZGVhcycsXG4gIEdFTkVSQUwgICAgICAgID0gJ2dlbmVyYWwnXG59XG5cbi8qKiBBdmFpbGFibGUgdGFncyBkZXJpdmVkIGZyb20gYnVzaW5lc3Mgc3RydWN0dXJlIC0gRFJZIHByaW5jaXBsZSAqL1xuZXhwb3J0IGNvbnN0IE5PVEVfVEFHUyA9IE9iamVjdC52YWx1ZXMoQlVTSU5FU1NfU1RSVUNUVVJFKS5mbGF0KCk7Il0sIm5hbWVzIjpbIkJVU0lORVNTX1NUUlVDVFVSRSIsIkFETUlOIiwiUkVTRUFSQ0giLCJERVNJR04iLCJQUk9EVUNUSU9OIiwiU0FMRVMiLCJQRVJTT05BTCIsIkNPTVBBTllfQVJFQVMiLCJQRVJTT05BTF9BUkVBUyIsIkFMTF9BUkVBUyIsIlNUQVRJT05fQ0FURUdPUklFUyIsIkxPQ0FUSU9OX1NUUlVDVFVSRSIsIkxPQ0FUSU9OX0hJRVJBUkNIWSIsIlBoeXNpY2FsQnVzaW5lc3NUeXBlIiwiQ2xvdWRTaXRlVHlwZSIsIlNwZWNpYWxTaXRlVHlwZSIsIlNpdGVUeXBlIiwiU2l0ZVN0YXR1cyIsIlNJVEVfU1RSVUNUVVJFIiwiUEhZU0lDQUwiLCJIT01FIiwiRkVSSUFfQk9YIiwiU01PS0lOR19MT1VOR0UiLCJUQUdVQSIsIkNBRkVfVklWTyIsIlhJVkEiLCJQRVJFWk9TT19GRUxJWiIsIkVMX0hPUk5JVE8iLCJKVU5HTEVfQUNBREVNWSIsIkxBX1RSSUJVIiwiT1NBX0RFX1JJTyIsIkdBTExFUllfMTA4NCIsIkNBVF9DQUZFIiwiRUNPX0ZFUklBIiwiRVNDVUVMQV9WRVJERSIsIlBSSU5UX01BU1RFUlMiLCJDTE9VRCIsIkRJR0lUQUxfU1BBQ0UiLCJERVNLVE9QX1BDIiwiTEFQVE9QIiwiR09PR0xFX0RSSVZFIiwiR0lUSFVCIiwiTUFHSUNfRURFTiIsIk9QRU5TRUEiLCJTUEVDSUFMIiwiTk9ORSIsIldPUkxEIiwiU09MRF9JVEVNU19USElTX01PTlRIIiwiQVJDSElWRURfSElTVE9SSUNBTCIsIkRFTEVURURfSVRFTVNfVEhJU19NT05USCIsIlNJVEVfR1JPVVBTIiwiU0lURV9DQVRFR09SSUVTIiwiVGFza1R5cGUiLCJUQVNLX0NBVEVHT1JJRVMiLCJNSVNTSU9OIiwiUkVDVVJSRU5UIiwiUmVjdXJyZW50RnJlcXVlbmN5IiwiVGFza1N0YXR1cyIsIlRhc2tQcmlvcml0eSIsIkZpbmFuY2lhbFN0YXR1cyIsIkRldlNwcmludFN0YXR1cyIsIlBvaW50VHlwZSIsIkN1cnJlbmN5IiwiSXRlbVR5cGUiLCJJdGVtQ2F0ZWdvcnkiLCJJbnZlbnRvcnlUYWIiLCJJdGVtU3RhdHVzIiwiQ29sbGVjdGlvbiIsIklURU1fQ0FURUdPUklFUyIsIk1PREVMX0lURU0iLCJCVU5ETEVfSVRFTSIsIlJFU09VUkNFX0lURU0iLCJTYWxlVHlwZSIsIlNhbGVzU2Vzc2lvblN0YXR1cyIsIlNhbGVTdGF0dXMiLCJQYXltZW50TWV0aG9kIiwiUEFZTUVOVF9NRVRIT0RfQ0FURUdPUklFUyIsIlJFR1VMQVIiLCJDaGFyYWN0ZXJSb2xlIiwiQ0hBUkFDVEVSX1JPTEVfVFlQRVMiLCJJbnRlbGVjdHVhbEZ1bmN0aW9uIiwiQXR0cmlidXRlIiwiU2tpbGwiLCJTS0lMTFNfQ0FURUdPUklFUyIsIkNPR05JVElWRSIsIkNIQVJBQ1RFUiIsIlBSQUNUSUNBTCIsIkNvbW1Db2xvciIsIkxpbmtUeXBlIiwiRW50aXR5VHlwZSIsIk5vdGVDb2xvciIsIk5vdGVib29rVHlwZSIsIk5PVEVfVEFHUyIsIk9iamVjdCIsInZhbHVlcyIsImZsYXQiXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./types/enums.ts\n");

/***/ }),

/***/ "(rsc)/./workflows/entities-logging.ts":
/*!***************************************!*\
  !*** ./workflows/entities-logging.ts ***!
  \***************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   appendBulkOperationLog: () => (/* binding */ appendBulkOperationLog),\n/* harmony export */   appendCharacterJungleCoinsLog: () => (/* binding */ appendCharacterJungleCoinsLog),\n/* harmony export */   appendEntityLog: () => (/* binding */ appendEntityLog),\n/* harmony export */   appendItemCreationLog: () => (/* binding */ appendItemCreationLog),\n/* harmony export */   appendPlayerPointsLog: () => (/* binding */ appendPlayerPointsLog),\n/* harmony export */   appendPlayerPointsUpdateLog: () => (/* binding */ appendPlayerPointsUpdateLog),\n/* harmony export */   updateEntityLogField: () => (/* binding */ updateEntityLogField)\n/* harmony export */ });\n/* harmony import */ var _data_store_kv__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @/data-store/kv */ \"(rsc)/./data-store/kv.ts\");\n/* harmony import */ var _data_store_keys__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @/data-store/keys */ \"(rsc)/./data-store/keys.ts\");\n/* harmony import */ var uuid__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! uuid */ \"(rsc)/./node_modules/uuid/dist/esm/v4.js\");\n// workflows/entities-logging.ts\n// Append-only lifecycle logs + in-place field updates for descriptive changes\n\n\n\nasync function appendEntityLog(entityType, entityId, event, details) {\n    const key = (0,_data_store_keys__WEBPACK_IMPORTED_MODULE_1__.buildLogKey)(entityType);\n    const list = await (0,_data_store_kv__WEBPACK_IMPORTED_MODULE_0__.kvGet)(key) || [];\n    list.push({\n        event,\n        entityId,\n        ...details,\n        timestamp: new Date().toISOString()\n    });\n    await (0,_data_store_kv__WEBPACK_IMPORTED_MODULE_0__.kvSet)(key, list);\n}\nasync function updateEntityLogField(entityType, entityId, fieldName, oldValue, newValue) {\n    const key = (0,_data_store_keys__WEBPACK_IMPORTED_MODULE_1__.buildLogKey)(entityType);\n    const list = await (0,_data_store_kv__WEBPACK_IMPORTED_MODULE_0__.kvGet)(key) || [];\n    // Find the most recent log entry for this entity\n    for(let i = list.length - 1; i >= 0; i--){\n        if (list[i]?.entityId === entityId) {\n            list[i][fieldName] = newValue;\n            list[i].lastUpdated = new Date().toISOString();\n            break;\n        }\n    }\n    await (0,_data_store_kv__WEBPACK_IMPORTED_MODULE_0__.kvSet)(key, list);\n}\nasync function appendBulkOperationLog(entityType, operation, details) {\n    const key = (0,_data_store_keys__WEBPACK_IMPORTED_MODULE_1__.buildLogKey)(entityType);\n    const list = await (0,_data_store_kv__WEBPACK_IMPORTED_MODULE_0__.kvGet)(key) || [];\n    const event = operation === \"import\" ? \"BULK_IMPORT\" : \"BULK_EXPORT\";\n    const operationId = (0,uuid__WEBPACK_IMPORTED_MODULE_2__[\"default\"])();\n    list.push({\n        event,\n        operationId,\n        operation,\n        count: details.count,\n        source: details.source,\n        importMode: details.importMode,\n        exportFormat: details.exportFormat,\n        extra: details.extra,\n        timestamp: new Date().toISOString()\n    });\n    await (0,_data_store_kv__WEBPACK_IMPORTED_MODULE_0__.kvSet)(key, list);\n}\n/**\r\n * Log item creation with source tracking\r\n * Used for items created from tasks, financial records, or directly\r\n */ async function appendItemCreationLog(item, sourceType, sourceId) {\n    const key = (0,_data_store_keys__WEBPACK_IMPORTED_MODULE_1__.buildLogKey)(\"item\");\n    const list = await (0,_data_store_kv__WEBPACK_IMPORTED_MODULE_0__.kvGet)(key) || [];\n    const logEntry = {\n        event: \"CREATED\",\n        entityId: item.id,\n        itemName: item.name,\n        itemType: item.type,\n        collection: item.collection,\n        status: item.status,\n        quantity: item.stock?.reduce((sum, stock)=>sum + stock.quantity, 0) || 0,\n        unitCost: item.unitCost || 0,\n        totalCost: (item.stock?.reduce((sum, stock)=>sum + stock.quantity, 0) || 0) * (item.unitCost || 0),\n        price: item.price || 0,\n        station: item.station,\n        category: item.category,\n        year: item.year,\n        sourceType,\n        sourceId,\n        description: `Item created from ${sourceType}: ${item.type} (${item.stock?.reduce((sum, stock)=>sum + stock.quantity, 0) || 0}x)`,\n        timestamp: new Date().toISOString()\n    };\n    list.push(logEntry);\n    await (0,_data_store_kv__WEBPACK_IMPORTED_MODULE_0__.kvSet)(key, list);\n}\n/**\r\n * Log player points award with source tracking\r\n * Used for points awarded from tasks, financial records, or sales\r\n */ async function appendPlayerPointsLog(playerId, points, sourceId, sourceType) {\n    const key = (0,_data_store_keys__WEBPACK_IMPORTED_MODULE_1__.buildLogKey)(\"player\");\n    const list = await (0,_data_store_kv__WEBPACK_IMPORTED_MODULE_0__.kvGet)(key) || [];\n    const logEntry = {\n        event: \"POINTS_CHANGED\",\n        entityId: playerId,\n        points: points,\n        sourceId: sourceId,\n        sourceType: sourceType,\n        description: `Points awarded from ${sourceType}: XP+${points.xp}, RP+${points.rp}, FP+${points.fp}, HP+${points.hp}`,\n        timestamp: new Date().toISOString()\n    };\n    list.push(logEntry);\n    await (0,_data_store_kv__WEBPACK_IMPORTED_MODULE_0__.kvSet)(key, list);\n}\n/**\r\n * Log character jungle coins award with source tracking\r\n * Used for jungle coins awarded from financial records\r\n */ async function appendCharacterJungleCoinsLog(characterId, amount, sourceId, sourceType) {\n    const key = (0,_data_store_keys__WEBPACK_IMPORTED_MODULE_1__.buildLogKey)(\"character\");\n    const list = await (0,_data_store_kv__WEBPACK_IMPORTED_MODULE_0__.kvGet)(key) || [];\n    const logEntry = {\n        event: \"UPDATED\",\n        entityId: characterId,\n        jungleCoins: amount,\n        sourceId: sourceId,\n        sourceType: sourceType,\n        description: `Jungle coins awarded from ${sourceType}: +${amount} J$`,\n        timestamp: new Date().toISOString()\n    };\n    list.push(logEntry);\n    await (0,_data_store_kv__WEBPACK_IMPORTED_MODULE_0__.kvSet)(key, list);\n}\n/**\r\n * Log player points update with change tracking\r\n * Used when task rewards change and points need to be updated\r\n */ async function appendPlayerPointsUpdateLog(playerId, oldPoints, newPoints, sourceId) {\n    const key = (0,_data_store_keys__WEBPACK_IMPORTED_MODULE_1__.buildLogKey)(\"player\");\n    const list = await (0,_data_store_kv__WEBPACK_IMPORTED_MODULE_0__.kvGet)(key) || [];\n    const delta = {\n        xp: newPoints.xp - oldPoints.xp,\n        rp: newPoints.rp - oldPoints.rp,\n        fp: newPoints.fp - oldPoints.fp,\n        hp: newPoints.hp - oldPoints.hp\n    };\n    const logEntry = {\n        event: \"POINTS_CHANGED\",\n        entityId: playerId,\n        oldPoints: oldPoints,\n        newPoints: newPoints,\n        delta: delta,\n        sourceId: sourceId,\n        description: `Points updated: XP${delta.xp >= 0 ? \"+\" : \"\"}${delta.xp}, RP${delta.rp >= 0 ? \"+\" : \"\"}${delta.rp}, FP${delta.fp >= 0 ? \"+\" : \"\"}${delta.fp}, HP${delta.hp >= 0 ? \"+\" : \"\"}${delta.hp}`,\n        timestamp: new Date().toISOString()\n    };\n    list.push(logEntry);\n    await (0,_data_store_kv__WEBPACK_IMPORTED_MODULE_0__.kvSet)(key, list);\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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RSxJQUFJLElBQUksTUFBTSxHQUFHLEVBQUVTLE1BQU1ULEVBQUUsQ0FBQyxJQUFJLEVBQUVTLE1BQU1SLEVBQUUsSUFBSSxJQUFJLE1BQU0sR0FBRyxFQUFFUSxNQUFNUixFQUFFLENBQUMsQ0FBQztRQUNyTS9DLFdBQVcsSUFBSUMsT0FBT0MsV0FBVztJQUNuQztJQUVBSixLQUFLQyxJQUFJLENBQUN1QjtJQUNWLE1BQU1sQyxxREFBS0EsQ0FBQ1MsS0FBS0M7QUFDbkIiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly90aGVnYW1lLWFkbWluLy4vd29ya2Zsb3dzL2VudGl0aWVzLWxvZ2dpbmcudHM/N2VhNSJdLCJzb3VyY2VzQ29udGVudCI6WyIvLyB3b3JrZmxvd3MvZW50aXRpZXMtbG9nZ2luZy50c1xyXG4vLyBBcHBlbmQtb25seSBsaWZlY3ljbGUgbG9ncyArIGluLXBsYWNlIGZpZWxkIHVwZGF0ZXMgZm9yIGRlc2NyaXB0aXZlIGNoYW5nZXNcclxuXHJcbmltcG9ydCB7IGt2R2V0LCBrdlNldCB9IGZyb20gJ0AvZGF0YS1zdG9yZS9rdic7XHJcbmltcG9ydCB7IGJ1aWxkTG9nS2V5IH0gZnJvbSAnQC9kYXRhLXN0b3JlL2tleXMnO1xyXG5pbXBvcnQgeyB2NCBhcyB1dWlkIH0gZnJvbSAndXVpZCc7XHJcblxyXG5leHBvcnQgdHlwZSBMb2dFdmVudCA9ICdDUkVBVEVEJyB8ICdTVEFUVVNfQ0hBTkdFRCcgfCAnRE9ORScgfCAnQ09MTEVDVEVEJyB8ICdNT1ZFRCcgfCAnU09MRCcgfCAnQ0hBUkdFRCcgfCAnQ0FOQ0VMTEVEJyB8ICdVUERBVEVEJyB8ICdMRVZFTF9VUCcgfCAnUE9JTlRTX0NIQU5HRUQnIHwgJ1JPTEVfQ0hBTkdFRCcgfCAnQUNUSVZBVEVEJyB8ICdERUFDVElWQVRFRCcgfCAnVU5DT01QTEVURUQnIHwgJ0JVTEtfSU1QT1JUJyB8ICdCVUxLX0VYUE9SVCc7XHJcblxyXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gYXBwZW5kRW50aXR5TG9nKFxyXG4gIGVudGl0eVR5cGU6IHN0cmluZywgXHJcbiAgZW50aXR5SWQ6IHN0cmluZyxcclxuICBldmVudDogTG9nRXZlbnQsXHJcbiAgZGV0YWlsczogUmVjb3JkPHN0cmluZywgYW55PlxyXG4pOiBQcm9taXNlPHZvaWQ+IHtcclxuICBjb25zdCBrZXkgPSBidWlsZExvZ0tleShlbnRpdHlUeXBlKTtcclxuICBjb25zdCBsaXN0ID0gKGF3YWl0IGt2R2V0PGFueVtdPihrZXkpKSB8fCBbXTtcclxuICBsaXN0LnB1c2goeyBcclxuICAgIGV2ZW50LFxyXG4gICAgZW50aXR5SWQsXHJcbiAgICAuLi5kZXRhaWxzLFxyXG4gICAgdGltZXN0YW1wOiBuZXcgRGF0ZSgpLnRvSVNPU3RyaW5nKCkgXHJcbiAgfSk7XHJcbiAgYXdhaXQga3ZTZXQoa2V5LCBsaXN0KTtcclxufVxyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIHVwZGF0ZUVudGl0eUxvZ0ZpZWxkKFxyXG4gIGVudGl0eVR5cGU6IHN0cmluZywgXHJcbiAgZW50aXR5SWQ6IHN0cmluZywgXHJcbiAgZmllbGROYW1lOiBzdHJpbmcsXHJcbiAgb2xkVmFsdWU6IGFueSxcclxuICBuZXdWYWx1ZTogYW55XHJcbik6IFByb21pc2U8dm9pZD4ge1xyXG4gIGNvbnN0IGtleSA9IGJ1aWxkTG9nS2V5KGVudGl0eVR5cGUpO1xyXG4gIGNvbnN0IGxpc3QgPSAoYXdhaXQga3ZHZXQ8YW55W10+KGtleSkpIHx8IFtdO1xyXG4gIFxyXG4gIC8vIEZpbmQgdGhlIG1vc3QgcmVjZW50IGxvZyBlbnRyeSBmb3IgdGhpcyBlbnRpdHlcclxuICBmb3IgKGxldCBpID0gbGlzdC5sZW5ndGggLSAxOyBpID49IDA7IGktLSkge1xyXG4gICAgaWYgKGxpc3RbaV0/LmVudGl0eUlkID09PSBlbnRpdHlJZCkge1xyXG4gICAgICBsaXN0W2ldW2ZpZWxkTmFtZV0gPSBuZXdWYWx1ZTtcclxuICAgICAgbGlzdFtpXS5sYXN0VXBkYXRlZCA9IG5ldyBEYXRlKCkudG9JU09TdHJpbmcoKTtcclxuICAgICAgYnJlYWs7XHJcbiAgICB9XHJcbiAgfVxyXG4gIFxyXG4gIGF3YWl0IGt2U2V0KGtleSwgbGlzdCk7XHJcbn1cclxuXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBhcHBlbmRCdWxrT3BlcmF0aW9uTG9nKFxyXG4gIGVudGl0eVR5cGU6IHN0cmluZyxcclxuICBvcGVyYXRpb246ICdpbXBvcnQnIHwgJ2V4cG9ydCcsXHJcbiAgZGV0YWlsczoge1xyXG4gICAgY291bnQ6IG51bWJlcjtcclxuICAgIHNvdXJjZT86IHN0cmluZztcclxuICAgIGltcG9ydE1vZGU/OiAnYWRkJyB8ICdtZXJnZScgfCAncmVwbGFjZSc7XHJcbiAgICBleHBvcnRGb3JtYXQ/OiBzdHJpbmc7XHJcbiAgICBleHRyYT86IGFueTtcclxuICB9XHJcbik6IFByb21pc2U8dm9pZD4ge1xyXG4gIGNvbnN0IGtleSA9IGJ1aWxkTG9nS2V5KGVudGl0eVR5cGUpO1xyXG4gIGNvbnN0IGxpc3QgPSAoYXdhaXQga3ZHZXQ8YW55W10+KGtleSkpIHx8IFtdO1xyXG4gIFxyXG4gIGNvbnN0IGV2ZW50OiBMb2dFdmVudCA9IG9wZXJhdGlvbiA9PT0gJ2ltcG9ydCcgPyAnQlVMS19JTVBPUlQnIDogJ0JVTEtfRVhQT1JUJztcclxuICBjb25zdCBvcGVyYXRpb25JZCA9IHV1aWQoKTtcclxuICBcclxuICBsaXN0LnB1c2goe1xyXG4gICAgZXZlbnQsXHJcbiAgICBvcGVyYXRpb25JZCxcclxuICAgIG9wZXJhdGlvbixcclxuICAgIGNvdW50OiBkZXRhaWxzLmNvdW50LFxyXG4gICAgc291cmNlOiBkZXRhaWxzLnNvdXJjZSxcclxuICAgIGltcG9ydE1vZGU6IGRldGFpbHMuaW1wb3J0TW9kZSxcclxuICAgIGV4cG9ydEZvcm1hdDogZGV0YWlscy5leHBvcnRGb3JtYXQsXHJcbiAgICBleHRyYTogZGV0YWlscy5leHRyYSxcclxuICAgIHRpbWVzdGFtcDogbmV3IERhdGUoKS50b0lTT1N0cmluZygpXHJcbiAgfSk7XHJcbiAgXHJcbiAgYXdhaXQga3ZTZXQoa2V5LCBsaXN0KTtcclxufVxyXG5cclxuLyoqXHJcbiAqIExvZyBpdGVtIGNyZWF0aW9uIHdpdGggc291cmNlIHRyYWNraW5nXHJcbiAqIFVzZWQgZm9yIGl0ZW1zIGNyZWF0ZWQgZnJvbSB0YXNrcywgZmluYW5jaWFsIHJlY29yZHMsIG9yIGRpcmVjdGx5XHJcbiAqL1xyXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gYXBwZW5kSXRlbUNyZWF0aW9uTG9nKFxyXG4gIGl0ZW06IGFueSxcclxuICBzb3VyY2VUeXBlOiAndGFzaycgfCAncmVjb3JkJyB8ICdkaXJlY3QnLFxyXG4gIHNvdXJjZUlkPzogc3RyaW5nXHJcbik6IFByb21pc2U8dm9pZD4ge1xyXG4gIGNvbnN0IGtleSA9IGJ1aWxkTG9nS2V5KCdpdGVtJyk7XHJcbiAgY29uc3QgbGlzdCA9IChhd2FpdCBrdkdldDxhbnlbXT4oa2V5KSkgfHwgW107XHJcbiAgXHJcbiAgY29uc3QgbG9nRW50cnkgPSB7XHJcbiAgICBldmVudDogJ0NSRUFURUQnIGFzIExvZ0V2ZW50LFxyXG4gICAgZW50aXR5SWQ6IGl0ZW0uaWQsXHJcbiAgICBpdGVtTmFtZTogaXRlbS5uYW1lLFxyXG4gICAgaXRlbVR5cGU6IGl0ZW0udHlwZSxcclxuICAgIGNvbGxlY3Rpb246IGl0ZW0uY29sbGVjdGlvbixcclxuICAgIHN0YXR1czogaXRlbS5zdGF0dXMsXHJcbiAgICBxdWFudGl0eTogaXRlbS5zdG9jaz8ucmVkdWNlKChzdW06IG51bWJlciwgc3RvY2s6IGFueSkgPT4gc3VtICsgc3RvY2sucXVhbnRpdHksIDApIHx8IDAsXHJcbiAgICB1bml0Q29zdDogaXRlbS51bml0Q29zdCB8fCAwLFxyXG4gICAgdG90YWxDb3N0OiAoaXRlbS5zdG9jaz8ucmVkdWNlKChzdW06IG51bWJlciwgc3RvY2s6IGFueSkgPT4gc3VtICsgc3RvY2sucXVhbnRpdHksIDApIHx8IDApICogKGl0ZW0udW5pdENvc3QgfHwgMCksXHJcbiAgICBwcmljZTogaXRlbS5wcmljZSB8fCAwLFxyXG4gICAgc3RhdGlvbjogaXRlbS5zdGF0aW9uLFxyXG4gICAgY2F0ZWdvcnk6IGl0ZW0uY2F0ZWdvcnksXHJcbiAgICB5ZWFyOiBpdGVtLnllYXIsXHJcbiAgICBzb3VyY2VUeXBlLFxyXG4gICAgc291cmNlSWQsXHJcbiAgICBkZXNjcmlwdGlvbjogYEl0ZW0gY3JlYXRlZCBmcm9tICR7c291cmNlVHlwZX06ICR7aXRlbS50eXBlfSAoJHtpdGVtLnN0b2NrPy5yZWR1Y2UoKHN1bTogbnVtYmVyLCBzdG9jazogYW55KSA9PiBzdW0gKyBzdG9jay5xdWFudGl0eSwgMCkgfHwgMH14KWAsXHJcbiAgICB0aW1lc3RhbXA6IG5ldyBEYXRlKCkudG9JU09TdHJpbmcoKVxyXG4gIH07XHJcbiAgXHJcbiAgbGlzdC5wdXNoKGxvZ0VudHJ5KTtcclxuICBhd2FpdCBrdlNldChrZXksIGxpc3QpO1xyXG59XHJcblxyXG4vKipcclxuICogTG9nIHBsYXllciBwb2ludHMgYXdhcmQgd2l0aCBzb3VyY2UgdHJhY2tpbmdcclxuICogVXNlZCBmb3IgcG9pbnRzIGF3YXJkZWQgZnJvbSB0YXNrcywgZmluYW5jaWFsIHJlY29yZHMsIG9yIHNhbGVzXHJcbiAqL1xyXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gYXBwZW5kUGxheWVyUG9pbnRzTG9nKFxyXG4gIHBsYXllcklkOiBzdHJpbmcsXHJcbiAgcG9pbnRzOiB7IHhwOiBudW1iZXI7IHJwOiBudW1iZXI7IGZwOiBudW1iZXI7IGhwOiBudW1iZXIgfSxcclxuICBzb3VyY2VJZDogc3RyaW5nLFxyXG4gIHNvdXJjZVR5cGU6IHN0cmluZ1xyXG4pOiBQcm9taXNlPHZvaWQ+IHtcclxuICBjb25zdCBrZXkgPSBidWlsZExvZ0tleSgncGxheWVyJyk7XHJcbiAgY29uc3QgbGlzdCA9IChhd2FpdCBrdkdldDxhbnlbXT4oa2V5KSkgfHwgW107XHJcbiAgXHJcbiAgY29uc3QgbG9nRW50cnkgPSB7XHJcbiAgICBldmVudDogJ1BPSU5UU19DSEFOR0VEJyBhcyBMb2dFdmVudCxcclxuICAgIGVudGl0eUlkOiBwbGF5ZXJJZCxcclxuICAgIHBvaW50czogcG9pbnRzLFxyXG4gICAgc291cmNlSWQ6IHNvdXJjZUlkLFxyXG4gICAgc291cmNlVHlwZTogc291cmNlVHlwZSxcclxuICAgIGRlc2NyaXB0aW9uOiBgUG9pbnRzIGF3YXJkZWQgZnJvbSAke3NvdXJjZVR5cGV9OiBYUCske3BvaW50cy54cH0sIFJQKyR7cG9pbnRzLnJwfSwgRlArJHtwb2ludHMuZnB9LCBIUCske3BvaW50cy5ocH1gLFxyXG4gICAgdGltZXN0YW1wOiBuZXcgRGF0ZSgpLnRvSVNPU3RyaW5nKClcclxuICB9O1xyXG4gIFxyXG4gIGxpc3QucHVzaChsb2dFbnRyeSk7XHJcbiAgYXdhaXQga3ZTZXQoa2V5LCBsaXN0KTtcclxufVxyXG5cclxuLyoqXHJcbiAqIExvZyBjaGFyYWN0ZXIganVuZ2xlIGNvaW5zIGF3YXJkIHdpdGggc291cmNlIHRyYWNraW5nXHJcbiAqIFVzZWQgZm9yIGp1bmdsZSBjb2lucyBhd2FyZGVkIGZyb20gZmluYW5jaWFsIHJlY29yZHNcclxuICovXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBhcHBlbmRDaGFyYWN0ZXJKdW5nbGVDb2luc0xvZyhcclxuICBjaGFyYWN0ZXJJZDogc3RyaW5nLFxyXG4gIGFtb3VudDogbnVtYmVyLFxyXG4gIHNvdXJjZUlkOiBzdHJpbmcsXHJcbiAgc291cmNlVHlwZTogc3RyaW5nXHJcbik6IFByb21pc2U8dm9pZD4ge1xyXG4gIGNvbnN0IGtleSA9IGJ1aWxkTG9nS2V5KCdjaGFyYWN0ZXInKTtcclxuICBjb25zdCBsaXN0ID0gKGF3YWl0IGt2R2V0PGFueVtdPihrZXkpKSB8fCBbXTtcclxuICBcclxuICBjb25zdCBsb2dFbnRyeSA9IHtcclxuICAgIGV2ZW50OiAnVVBEQVRFRCcgYXMgTG9nRXZlbnQsXHJcbiAgICBlbnRpdHlJZDogY2hhcmFjdGVySWQsXHJcbiAgICBqdW5nbGVDb2luczogYW1vdW50LFxyXG4gICAgc291cmNlSWQ6IHNvdXJjZUlkLFxyXG4gICAgc291cmNlVHlwZTogc291cmNlVHlwZSxcclxuICAgIGRlc2NyaXB0aW9uOiBgSnVuZ2xlIGNvaW5zIGF3YXJkZWQgZnJvbSAke3NvdXJjZVR5cGV9OiArJHthbW91bnR9IEokYCxcclxuICAgIHRpbWVzdGFtcDogbmV3IERhdGUoKS50b0lTT1N0cmluZygpXHJcbiAgfTtcclxuICBcclxuICBsaXN0LnB1c2gobG9nRW50cnkpO1xyXG4gIGF3YWl0IGt2U2V0KGtleSwgbGlzdCk7XHJcbn1cclxuXHJcbi8qKlxyXG4gKiBMb2cgcGxheWVyIHBvaW50cyB1cGRhdGUgd2l0aCBjaGFuZ2UgdHJhY2tpbmdcclxuICogVXNlZCB3aGVuIHRhc2sgcmV3YXJkcyBjaGFuZ2UgYW5kIHBvaW50cyBuZWVkIHRvIGJlIHVwZGF0ZWRcclxuICovXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBhcHBlbmRQbGF5ZXJQb2ludHNVcGRhdGVMb2coXHJcbiAgcGxheWVySWQ6IHN0cmluZyxcclxuICBvbGRQb2ludHM6IHsgeHA6IG51bWJlcjsgcnA6IG51bWJlcjsgZnA6IG51bWJlcjsgaHA6IG51bWJlciB9LFxyXG4gIG5ld1BvaW50czogeyB4cDogbnVtYmVyOyBycDogbnVtYmVyOyBmcDogbnVtYmVyOyBocDogbnVtYmVyIH0sXHJcbiAgc291cmNlSWQ6IHN0cmluZ1xyXG4pOiBQcm9taXNlPHZvaWQ+IHtcclxuICBjb25zdCBrZXkgPSBidWlsZExvZ0tleSgncGxheWVyJyk7XHJcbiAgY29uc3QgbGlzdCA9IChhd2FpdCBrdkdldDxhbnlbXT4oa2V5KSkgfHwgW107XHJcbiAgXHJcbiAgY29uc3QgZGVsdGEgPSB7XHJcbiAgICB4cDogbmV3UG9pbnRzLnhwIC0gb2xkUG9pbnRzLnhwLFxyXG4gICAgcnA6IG5ld1BvaW50cy5ycCAtIG9sZFBvaW50cy5ycCxcclxuICAgIGZwOiBuZXdQb2ludHMuZnAgLSBvbGRQb2ludHMuZnAsXHJcbiAgICBocDogbmV3UG9pbnRzLmhwIC0gb2xkUG9pbnRzLmhwXHJcbiAgfTtcclxuICBcclxuICBjb25zdCBsb2dFbnRyeSA9IHtcclxuICAgIGV2ZW50OiAnUE9JTlRTX0NIQU5HRUQnIGFzIExvZ0V2ZW50LFxyXG4gICAgZW50aXR5SWQ6IHBsYXllcklkLFxyXG4gICAgb2xkUG9pbnRzOiBvbGRQb2ludHMsXHJcbiAgICBuZXdQb2ludHM6IG5ld1BvaW50cyxcclxuICAgIGRlbHRhOiBkZWx0YSxcclxuICAgIHNvdXJjZUlkOiBzb3VyY2VJZCxcclxuICAgIGRlc2NyaXB0aW9uOiBgUG9pbnRzIHVwZGF0ZWQ6IFhQJHtkZWx0YS54cCA+PSAwID8gJysnIDogJyd9JHtkZWx0YS54cH0sIFJQJHtkZWx0YS5ycCA+PSAwID8gJysnIDogJyd9JHtkZWx0YS5ycH0sIEZQJHtkZWx0YS5mcCA+PSAwID8gJysnIDogJyd9JHtkZWx0YS5mcH0sIEhQJHtkZWx0YS5ocCA+PSAwID8gJysnIDogJyd9JHtkZWx0YS5ocH1gLFxyXG4gICAgdGltZXN0YW1wOiBuZXcgRGF0ZSgpLnRvSVNPU3RyaW5nKClcclxuICB9O1xyXG4gIFxyXG4gIGxpc3QucHVzaChsb2dFbnRyeSk7XHJcbiAgYXdhaXQga3ZTZXQoa2V5LCBsaXN0KTtcclxufVxyXG5cclxuXHJcbiJdLCJuYW1lcyI6WyJrdkdldCIsImt2U2V0IiwiYnVpbGRMb2dLZXkiLCJ2NCIsInV1aWQiLCJhcHBlbmRFbnRpdHlMb2ciLCJlbnRpdHlUeXBlIiwiZW50aXR5SWQiLCJldmVudCIsImRldGFpbHMiLCJrZXkiLCJsaXN0IiwicHVzaCIsInRpbWVzdGFtcCIsIkRhdGUiLCJ0b0lTT1N0cmluZyIsInVwZGF0ZUVudGl0eUxvZ0ZpZWxkIiwiZmllbGROYW1lIiwib2xkVmFsdWUiLCJuZXdWYWx1ZSIsImkiLCJsZW5ndGgiLCJsYXN0VXBkYXRlZCIsImFwcGVuZEJ1bGtPcGVyYXRpb25Mb2ciLCJvcGVyYXRpb24iLCJvcGVyYXRpb25JZCIsImNvdW50Iiwic291cmNlIiwiaW1wb3J0TW9kZSIsImV4cG9ydEZvcm1hdCIsImV4dHJhIiwiYXBwZW5kSXRlbUNyZWF0aW9uTG9nIiwiaXRlbSIsInNvdXJjZVR5cGUiLCJzb3VyY2VJZCIsImxvZ0VudHJ5IiwiaWQiLCJpdGVtTmFtZSIsIm5hbWUiLCJpdGVtVHlwZSIsInR5cGUiLCJjb2xsZWN0aW9uIiwic3RhdHVzIiwicXVhbnRpdHkiLCJzdG9jayIsInJlZHVjZSIsInN1bSIsInVuaXRDb3N0IiwidG90YWxDb3N0IiwicHJpY2UiLCJzdGF0aW9uIiwiY2F0ZWdvcnkiLCJ5ZWFyIiwiZGVzY3JpcHRpb24iLCJhcHBlbmRQbGF5ZXJQb2ludHNMb2ciLCJwbGF5ZXJJZCIsInBvaW50cyIsInhwIiwicnAiLCJmcCIsImhwIiwiYXBwZW5kQ2hhcmFjdGVySnVuZ2xlQ29pbnNMb2ciLCJjaGFyYWN0ZXJJZCIsImFtb3VudCIsImp1bmdsZUNvaW5zIiwiYXBwZW5kUGxheWVyUG9pbnRzVXBkYXRlTG9nIiwib2xkUG9pbnRzIiwibmV3UG9pbnRzIiwiZGVsdGEiXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./workflows/entities-logging.ts\n");

/***/ }),

/***/ "(rsc)/./workflows/entities-workflows/character.workflow.ts":
/*!************************************************************!*\
  !*** ./workflows/entities-workflows/character.workflow.ts ***!
  \************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   logCharacterEffect: () => (/* binding */ logCharacterEffect),\n/* harmony export */   logCharacterEffectFromRecord: () => (/* binding */ logCharacterEffectFromRecord),\n/* harmony export */   logCharacterUpdateFromTask: () => (/* binding */ logCharacterUpdateFromTask),\n/* harmony export */   onCharacterUpsert: () => (/* binding */ onCharacterUpsert),\n/* harmony export */   removeCharacterEffectsOnDelete: () => (/* binding */ removeCharacterEffectsOnDelete)\n/* harmony export */ });\n/* harmony import */ var _entities_logging__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../entities-logging */ \"(rsc)/./workflows/entities-logging.ts\");\n/* harmony import */ var _data_store_effects_registry__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @/data-store/effects-registry */ \"(rsc)/./data-store/effects-registry.ts\");\n/* harmony import */ var _lib_client_api__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @/lib/client-api */ \"(rsc)/./lib/client-api.ts\");\n// workflows/entities-workflows/character.workflow.ts\n// Character-specific workflow with ROLE_CHANGED event\n\n\n\n\nconst STATE_FIELDS = [\n    \"roles\",\n    \"isActive\"\n];\nconst DESCRIPTIVE_FIELDS = [\n    \"name\",\n    \"description\",\n    \"contactEmail\",\n    \"contactPhone\",\n    \"commColor\"\n];\nasync function onCharacterUpsert(character, previousCharacter) {\n    // New character creation\n    if (!previousCharacter) {\n        const effectKey = `character:${character.id}:created`;\n        if (await (0,_data_store_effects_registry__WEBPACK_IMPORTED_MODULE_1__.hasEffect)(effectKey)) return;\n        await (0,_entities_logging__WEBPACK_IMPORTED_MODULE_0__.appendEntityLog)(\"character\", character.id, \"CREATED\", {\n            name: character.name,\n            roles: character.roles\n        });\n        await (0,_data_store_effects_registry__WEBPACK_IMPORTED_MODULE_1__.markEffect)(effectKey);\n        return;\n    }\n    // Role changes - ROLE_CHANGED event\n    const rolesChanged = JSON.stringify(previousCharacter.roles) !== JSON.stringify(character.roles);\n    if (rolesChanged) {\n        await (0,_entities_logging__WEBPACK_IMPORTED_MODULE_0__.appendEntityLog)(\"character\", character.id, \"ROLE_CHANGED\", {\n            name: character.name,\n            oldRoles: previousCharacter.roles,\n            newRoles: character.roles\n        });\n    }\n    // General updates - UPDATED event\n    const hasSignificantChanges = previousCharacter.isActive !== character.isActive;\n    if (hasSignificantChanges) {\n        await (0,_entities_logging__WEBPACK_IMPORTED_MODULE_0__.appendEntityLog)(\"character\", character.id, \"UPDATED\", {\n            name: character.name,\n            isActive: character.isActive\n        });\n    }\n    // Descriptive changes - update in-place\n    for (const field of DESCRIPTIVE_FIELDS){\n        if (previousCharacter[field] !== character[field]) {\n            await (0,_entities_logging__WEBPACK_IMPORTED_MODULE_0__.updateEntityLogField)(\"character\", character.id, field, previousCharacter[field], character[field]);\n        }\n    }\n}\n/**\r\n * Remove character effects when character is deleted\r\n * Characters can have entries in character log and related links\r\n */ async function removeCharacterEffectsOnDelete(characterId) {\n    try {\n        console.log(`[removeCharacterEffectsOnDelete] Starting cleanup for character: ${characterId}`);\n        // 1. Remove all Links related to this character\n        const characterLinks = await _lib_client_api__WEBPACK_IMPORTED_MODULE_2__.ClientAPI.getLinksFor({\n            type: \"character\",\n            id: characterId\n        });\n        console.log(`[removeCharacterEffectsOnDelete] Found ${characterLinks.length} links to remove`);\n        for (const link of characterLinks){\n            try {\n                await _lib_client_api__WEBPACK_IMPORTED_MODULE_2__.ClientAPI.removeLink(link.id);\n                console.log(`[removeCharacterEffectsOnDelete] ✅ Removed link: ${link.linkType}`);\n            } catch (error) {\n                console.error(`[removeCharacterEffectsOnDelete] ❌ Failed to remove link ${link.id}:`, error);\n            }\n        }\n        // 2. Clear all effects for this character\n        await (0,_data_store_effects_registry__WEBPACK_IMPORTED_MODULE_1__.clearEffect)(`character:${characterId}:created`);\n        await (0,_data_store_effects_registry__WEBPACK_IMPORTED_MODULE_1__.clearEffectsByPrefix)(\"character\", characterId, \"\");\n        // 3. Remove log entries from character log\n        console.log(`[removeCharacterEffectsOnDelete] Starting log entry removal for character: ${characterId}`);\n        const result = await _lib_client_api__WEBPACK_IMPORTED_MODULE_2__.ClientAPI.removeLogEntry(\"character\", characterId);\n        if (result.success) {\n            console.log(`[removeCharacterEffectsOnDelete] ✅ Character log entries removed successfully for character: ${characterId}`);\n        } else {\n            console.error(`[removeCharacterEffectsOnDelete] Failed to remove character log entries: ${result.message}`);\n        }\n        console.log(`[removeCharacterEffectsOnDelete] ✅ Cleared effects, removed links, and removed log entries for character ${characterId}`);\n    } catch (error) {\n        console.error(\"Error removing character effects:\", error);\n    }\n}\n/**\r\n * Log character effect from task completion\r\n * This is currently a no-op since tasks don't award jungle coins anymore\r\n * J$ are only earned via Points Exchange\r\n */ async function logCharacterEffect(task) {\n    // J$ no longer awarded as task rewards - only earned via Points Exchange\n    // This function is now a no-op since tasks don't award J$ anymore\n    return;\n}\n/**\r\n * Log character effect from financial record\r\n * This logs the jungle coins awarded to the character from a financial record\r\n */ async function logCharacterEffectFromRecord(record) {\n    try {\n        console.log(`[logCharacterEffectFromRecord] Logging character effect for record: ${record.name} (${record.id})`);\n        // Only log if there are jungle coins to award\n        if (!record.jungleCoins || record.jungleCoins <= 0) {\n            console.log(\"[logCharacterEffectFromRecord] No jungle coins to log, skipping\");\n            return;\n        }\n        // Get main character ID (V0.1 constant)\n        const mainCharacterId = \"CHARACTER_ONE_ID\";\n        await (0,_entities_logging__WEBPACK_IMPORTED_MODULE_0__.appendCharacterJungleCoinsLog)(mainCharacterId, record.jungleCoins, record.id, \"financial\");\n        console.log(`[logCharacterEffectFromRecord] ✅ Character effect logged successfully for ${record.name}`);\n    } catch (error) {\n        console.error(\"Error logging character effect from record:\", error);\n    }\n}\n/**\r\n * Log character update from task changes\r\n * This is currently a no-op since tasks don't award jungle coins anymore\r\n * J$ are only earned via Points Exchange\r\n */ async function logCharacterUpdateFromTask(task, oldTask) {\n    // J$ no longer awarded as task rewards - only earned via Points Exchange\n    // This function is now a no-op since tasks don't award J$ anymore\n    return;\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi93b3JrZmxvd3MvZW50aXRpZXMtd29ya2Zsb3dzL2NoYXJhY3Rlci53b3JrZmxvdy50cyIsIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7OztBQUFBLHFEQUFxRDtBQUNyRCxzREFBc0Q7QUFHc0I7QUFDNkI7QUFDNUQ7QUFDdUI7QUFHcEUsTUFBTVEsZUFBZTtJQUFDO0lBQVM7Q0FBVztBQUMxQyxNQUFNQyxxQkFBcUI7SUFBQztJQUFRO0lBQWU7SUFBZ0I7SUFBZ0I7Q0FBWTtBQUV4RixlQUFlQyxrQkFBa0JDLFNBQW9CLEVBQUVDLGlCQUE2QjtJQUN6Rix5QkFBeUI7SUFDekIsSUFBSSxDQUFDQSxtQkFBbUI7UUFDdEIsTUFBTUMsWUFBWSxDQUFDLFVBQVUsRUFBRUYsVUFBVUcsRUFBRSxDQUFDLFFBQVEsQ0FBQztRQUNyRCxJQUFJLE1BQU1aLHVFQUFTQSxDQUFDVyxZQUFZO1FBRWhDLE1BQU1iLGtFQUFlQSxDQUFDLGFBQWFXLFVBQVVHLEVBQUUsRUFBRSxXQUFXO1lBQzFEQyxNQUFNSixVQUFVSSxJQUFJO1lBQ3BCQyxPQUFPTCxVQUFVSyxLQUFLO1FBQ3hCO1FBQ0EsTUFBTWIsd0VBQVVBLENBQUNVO1FBQ2pCO0lBQ0Y7SUFFQSxvQ0FBb0M7SUFDcEMsTUFBTUksZUFBZUMsS0FBS0MsU0FBUyxDQUFDUCxrQkFBa0JJLEtBQUssTUFBTUUsS0FBS0MsU0FBUyxDQUFDUixVQUFVSyxLQUFLO0lBQy9GLElBQUlDLGNBQWM7UUFDaEIsTUFBTWpCLGtFQUFlQSxDQUFDLGFBQWFXLFVBQVVHLEVBQUUsRUFBRSxnQkFBZ0I7WUFDL0RDLE1BQU1KLFVBQVVJLElBQUk7WUFDcEJLLFVBQVVSLGtCQUFrQkksS0FBSztZQUNqQ0ssVUFBVVYsVUFBVUssS0FBSztRQUMzQjtJQUNGO0lBRUEsa0NBQWtDO0lBQ2xDLE1BQU1NLHdCQUF3QlYsa0JBQWtCVyxRQUFRLEtBQUtaLFVBQVVZLFFBQVE7SUFDL0UsSUFBSUQsdUJBQXVCO1FBQ3pCLE1BQU10QixrRUFBZUEsQ0FB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SUFDeEcsRUFBRSxPQUFPcUIsT0FBTztRQUNkVCxRQUFRUyxLQUFLLENBQUMsK0NBQStDQTtJQUMvRDtBQUNGO0FBRUE7Ozs7Q0FJQyxHQUNNLGVBQWVXLDJCQUEyQkwsSUFBVSxFQUFFTSxPQUFhO0lBQ3hFLHlFQUF5RTtJQUN6RSxrRUFBa0U7SUFDbEU7QUFDRiIsInNvdXJjZXMiOlsid2VicGFjazovL3RoZWdhbWUtYWRtaW4vLi93b3JrZmxvd3MvZW50aXRpZXMtd29ya2Zsb3dzL2NoYXJhY3Rlci53b3JrZmxvdy50cz9lNTU4Il0sInNvdXJjZXNDb250ZW50IjpbIi8vIHdvcmtmbG93cy9lbnRpdGllcy13b3JrZmxvd3MvY2hhcmFjdGVyLndvcmtmbG93LnRzXHJcbi8vIENoYXJhY3Rlci1zcGVjaWZpYyB3b3JrZmxvdyB3aXRoIFJPTEVfQ0hBTkdFRCBldmVudFxyXG5cclxuaW1wb3J0IHR5cGUgeyBDaGFyYWN0ZXIgfSBmcm9tICdAL3R5cGVzL2VudGl0aWVzJztcclxuaW1wb3J0IHsgYXBwZW5kRW50aXR5TG9nLCB1cGRhdGVFbnRpdHlMb2dGaWVsZCB9IGZyb20gJy4uL2VudGl0aWVzLWxvZ2dpbmcnO1xyXG5pbXBvcnQgeyBoYXNFZmZlY3QsIG1hcmtFZmZlY3QsIGNsZWFyRWZmZWN0LCBjbGVhckVmZmVjdHNCeVByZWZpeCB9IGZyb20gJ0AvZGF0YS1zdG9yZS9lZmZlY3RzLXJlZ2lzdHJ5JztcclxuaW1wb3J0IHsgQ2xpZW50QVBJIH0gZnJvbSAnQC9saWIvY2xpZW50LWFwaSc7XHJcbmltcG9ydCB7IGFwcGVuZENoYXJhY3Rlckp1bmdsZUNvaW5zTG9nIH0gZnJvbSAnLi4vZW50aXRpZXMtbG9nZ2luZyc7XHJcbmltcG9ydCB0eXBlIHsgVGFzaywgRmluYW5jaWFsUmVjb3JkIH0gZnJvbSAnQC90eXBlcy9lbnRpdGllcyc7XHJcblxyXG5jb25zdCBTVEFURV9GSUVMRFMgPSBbJ3JvbGVzJywgJ2lzQWN0aXZlJ107XHJcbmNvbnN0IERFU0NSSVBUSVZFX0ZJRUxEUyA9IFsnbmFtZScsICdkZXNjcmlwdGlvbicsICdjb250YWN0RW1haWwnLCAnY29udGFjdFBob25lJywgJ2NvbW1Db2xvciddO1xyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIG9uQ2hhcmFjdGVyVXBzZXJ0KGNoYXJhY3RlcjogQ2hhcmFjdGVyLCBwcmV2aW91c0NoYXJhY3Rlcj86IENoYXJhY3Rlcik6IFByb21pc2U8dm9pZD4ge1xyXG4gIC8vIE5ldyBjaGFyYWN0ZXIgY3JlYXRpb25cclxuICBpZiAoIXByZXZpb3VzQ2hhcmFjdGVyKSB7XHJcbiAgICBjb25zdCBlZmZlY3RLZXkgPSBgY2hhcmFjdGVyOiR7Y2hhcmFjdGVyLmlkfTpjcmVhdGVkYDtcclxuICAgIGlmIChhd2FpdCBoYXNFZmZlY3QoZWZmZWN0S2V5KSkgcmV0dXJuO1xyXG4gICAgXHJcbiAgICBhd2FpdCBhcHBlbmRFbnRpdHlMb2coJ2NoYXJhY3RlcicsIGNoYXJhY3Rlci5pZCwgJ0NSRUFURUQnLCB7IFxyXG4gICAgICBuYW1lOiBjaGFyYWN0ZXIubmFtZSwgXHJcbiAgICAgIHJvbGVzOiBjaGFyYWN0ZXIucm9sZXNcclxuICAgIH0pO1xyXG4gICAgYXdhaXQgbWFya0VmZmVjdChlZmZlY3RLZXkpO1xyXG4gICAgcmV0dXJuO1xyXG4gIH1cclxuICBcclxuICAvLyBSb2xlIGNoYW5nZXMgLSBST0xFX0NIQU5HRUQgZXZlbnRcclxuICBjb25zdCByb2xlc0NoYW5nZWQgPSBKU09OLnN0cmluZ2lmeShwcmV2aW91c0NoYXJhY3Rlci5yb2xlcykgIT09IEpTT04uc3RyaW5naWZ5KGNoYXJhY3Rlci5yb2xlcyk7XHJcbiAgaWYgKHJvbGVzQ2hhbmdlZCkge1xyXG4gICAgYXdhaXQgYXBwZW5kRW50aXR5TG9nKCdjaGFyYWN0ZXInLCBjaGFyYWN0ZXIuaWQsICdST0xFX0NIQU5HRUQnLCB7XHJcbiAgICAgIG5hbWU6IGNoYXJhY3Rlci5uYW1lLFxyXG4gICAgICBvbGRSb2xlczogcHJldmlvdXNDaGFyYWN0ZXIucm9sZXMsXHJcbiAgICAgIG5ld1JvbGVzOiBjaGFyYWN0ZXIucm9sZXNcclxuICAgIH0pO1xyXG4gIH1cclxuICBcclxuICAvLyBHZW5lcmFsIHVwZGF0ZXMgLSBVUERBVEVEIGV2ZW50XHJcbiAgY29uc3QgaGFzU2lnbmlmaWNhbnRDaGFuZ2VzID0gcHJldmlvdXNDaGFyYWN0ZXIuaXNBY3RpdmUgIT09IGNoYXJhY3Rlci5pc0FjdGl2ZTtcclxuICBpZiAoaGFzU2lnbmlmaWNhbnRDaGFuZ2VzKSB7XHJcbiAgICBhd2FpdCBhcHBlbmRFbnRpdHlMb2coJ2NoYXJhY3RlcicsIGNoYXJhY3Rlci5pZCwgJ1VQREFURUQnLCB7XHJcbiAgICAgIG5hbWU6IGNoYXJhY3Rlci5uYW1lLFxyXG4gICAgICBpc0FjdGl2ZTogY2hhcmFjdGVyLmlzQWN0aXZlXHJcbiAgICB9KTtcclxuICB9XHJcbiAgXHJcbiAgLy8gRGVzY3JpcHRpdmUgY2hhbmdlcyAtIHVwZGF0ZSBpbi1wbGFjZVxyXG4gIGZvciAoY29uc3QgZmllbGQgb2YgREVTQ1JJUFRJVkVfRklFTERTKSB7XHJcbiAgICBpZiAoKHByZXZpb3VzQ2hhcmFjdGVyIGFzIGFueSlbZmllbGRdICE9PSAoY2hhcmFjdGVyIGFzIGFueSlbZmllbGRdKSB7XHJcbiAgICAgIGF3YWl0IHVwZGF0ZUVudGl0eUxvZ0ZpZWxkKCdjaGFyYWN0ZXInLCBjaGFyYWN0ZXIuaWQsIGZpZWxkLCAocHJldmlvdXNDaGFyYWN0ZXIgYXMgYW55KVtmaWVsZF0sIChjaGFyYWN0ZXIgYXMgYW55KVtmaWVsZF0pO1xyXG4gICAgfVxyXG4gIH1cclxufVxyXG5cclxuLyoqXHJcbiAqIFJlbW92ZSBjaGFyYWN0ZXIgZWZmZWN0cyB3aGVuIGNoYXJhY3RlciBpcyBkZWxldGVkXHJcbiAqIENoYXJhY3RlcnMgY2FuIGhhdmUgZW50cmllcyBpbiBjaGFyYWN0ZXIgbG9nIGFuZCByZWxhdGVkIGxpbmtzXHJcbiAqL1xyXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gcmVtb3ZlQ2hhcmFjdGVyRWZmZWN0c09uRGVsZXRlKGNoYXJhY3RlcklkOiBzdHJpbmcpOiBQcm9taXNlPHZvaWQ+IHtcclxuICB0cnkge1xyXG4gICAgY29uc29sZS5sb2coYFtyZW1vdmVDaGFyYWN0ZXJFZmZlY3RzT25EZWxldGVdIFN0YXJ0aW5nIGNsZWFudXAgZm9yIGNoYXJhY3RlcjogJHtjaGFyYWN0ZXJJZH1gKTtcclxuICAgIFxyXG4gICAgLy8gMS4gUmVtb3ZlIGFsbCBMaW5rcyByZWxhdGVkIHRvIHRoaXMgY2hhcmFjdGVyXHJcbiAgICBjb25zdCBjaGFyYWN0ZXJMaW5rcyA9IGF3YWl0IENsaWVudEFQSS5nZXRMaW5rc0Zvcih7IHR5cGU6ICdjaGFyYWN0ZXInLCBpZDogY2hhcmFjdGVySWQgfSk7XHJcbiAgICBjb25zb2xlLmxvZyhgW3JlbW92ZUNoYXJhY3RlckVmZmVjdHNPbkRlbGV0ZV0gRm91bmQgJHtjaGFyYWN0ZXJMaW5rcy5sZW5ndGh9IGxpbmtzIHRvIHJlbW92ZWApO1xyXG4gICAgXHJcbiAgICBmb3IgKGNvbnN0IGxpbmsgb2YgY2hhcmFjdGVyTGlua3MpIHtcclxuICAgICAgdHJ5IHtcclxuICAgICAgICBhd2FpdCBDbGllbnRBUEkucmVtb3ZlTGluayhsaW5rLmlkKTtcclxuICAgICAgICBjb25zb2xlLmxvZyhgW3JlbW92ZUNoYXJhY3RlckVmZmVjdHNPbkRlbGV0ZV0g4pyFIFJlbW92ZWQgbGluazogJHtsaW5rLmxpbmtUeXBlfWApO1xyXG4gICAgICB9IGNhdGNoIChlcnJvcikge1xyXG4gICAgICAgIGNvbnNvbGUuZXJyb3IoYFtyZW1vdmVDaGFyYWN0ZXJFZmZlY3RzT25EZWxldGVdIOKdjCBGYWlsZWQgdG8gcmVtb3ZlIGxpbmsgJHtsaW5rLmlkfTpgLCBlcnJvcik7XHJcbiAgICAgIH1cclxuICAgIH1cclxuICAgIFxyXG4gICAgLy8gMi4gQ2xlYXIgYWxsIGVmZmVjdHMgZm9yIHRoaXMgY2hhcmFjdGVyXHJcbiAgICBhd2FpdCBjbGVhckVmZmVjdChgY2hhcmFjdGVyOiR7Y2hhcmFjdGVySWR9OmNyZWF0ZWRgKTtcclxuICAgIGF3YWl0IGNsZWFyRWZmZWN0c0J5UHJlZml4KCdjaGFyYWN0ZXInLCBjaGFyYWN0ZXJJZCwgJycpO1xyXG4gICAgXHJcbiAgICAvLyAzLiBSZW1vdmUgbG9nIGVudHJpZXMgZnJvbSBjaGFyYWN0ZXIgbG9nXHJcbiAgICBjb25zb2xlLmxvZyhgW3JlbW92ZUNoYXJhY3RlckVmZmVjdHNPbkRlbGV0ZV0gU3RhcnRpbmcgbG9nIGVudHJ5IHJlbW92YWwgZm9yIGNoYXJhY3RlcjogJHtjaGFyYWN0ZXJJZH1gKTtcclxuICAgIFxyXG4gICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgQ2xpZW50QVBJLnJlbW92ZUxvZ0VudHJ5KCdjaGFyYWN0ZXInLCBjaGFyYWN0ZXJJZCk7XHJcbiAgICBcclxuICAgIGlmIChyZXN1bHQuc3VjY2Vzcykge1xyXG4gICAgICBjb25zb2xlLmxvZyhgW3JlbW92ZUNoYXJhY3RlckVmZmVjdHNPbkRlbGV0ZV0g4pyFIENoYXJhY3RlciBsb2cgZW50cmllcyByZW1vdmVkIHN1Y2Nlc3NmdWxseSBmb3IgY2hhcmFjdGVyOiAke2NoYXJhY3RlcklkfWApO1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgY29uc29sZS5lcnJvcihgW3JlbW92ZUNoYXJhY3RlckVmZmVjdHNPbkRlbGV0ZV0gRmFpbGVkIHRvIHJlbW92ZSBjaGFyYWN0ZXIgbG9nIGVudHJpZXM6ICR7cmVzdWx0Lm1lc3NhZ2V9YCk7XHJcbiAgICB9XHJcbiAgICBcclxuICAgIGNvbnNvbGUubG9nKGBbcmVtb3ZlQ2hhcmFjdGVyRWZmZWN0c09uRGVsZXRlXSDinIUgQ2xlYXJlZCBlZmZlY3RzLCByZW1vdmVkIGxpbmtzLCBhbmQgcmVtb3ZlZCBsb2cgZW50cmllcyBmb3IgY2hhcmFjdGVyICR7Y2hhcmFjdGVySWR9YCk7XHJcbiAgfSBjYXRjaCAoZXJyb3IpIHtcclxuICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIHJlbW92aW5nIGNoYXJhY3RlciBlZmZlY3RzOicsIGVycm9yKTtcclxuICB9XHJcbn1cclxuXHJcbi8qKlxyXG4gKiBMb2cgY2hhcmFjdGVyIGVmZmVjdCBmcm9tIHRhc2sgY29tcGxldGlvblxyXG4gKiBUaGlzIGlzIGN1cnJlbnRseSBhIG5vLW9wIHNpbmNlIHRhc2tzIGRvbid0IGF3YXJkIGp1bmdsZSBjb2lucyBhbnltb3JlXHJcbiAqIEokIGFyZSBvbmx5IGVhcm5lZCB2aWEgUG9pbnRzIEV4Y2hhbmdlXHJcbiAqL1xyXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gbG9nQ2hhcmFjdGVyRWZmZWN0KHRhc2s6IFRhc2spOiBQcm9taXNlPHZvaWQ+IHtcclxuICAvLyBKJCBubyBsb25nZXIgYXdhcmRlZCBhcyB0YXNrIHJld2FyZHMgLSBvbmx5IGVhcm5lZCB2aWEgUG9pbnRzIEV4Y2hhbmdlXHJcbiAgLy8gVGhpcyBmdW5jdGlvbiBpcyBub3cgYSBuby1vcCBzaW5jZSB0YXNrcyBkb24ndCBhd2FyZCBKJCBhbnltb3JlXHJcbiAgcmV0dXJuO1xyXG59XHJcblxyXG4vKipcclxuICogTG9nIGNoYXJhY3RlciBlZmZlY3QgZnJvbSBmaW5hbmNpYWwgcmVjb3JkXHJcbiAqIFRoaXMgbG9ncyB0aGUganVuZ2xlIGNvaW5zIGF3YXJkZWQgdG8gdGhlIGNoYXJhY3RlciBmcm9tIGEgZmluYW5jaWFsIHJlY29yZFxyXG4gKi9cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGxvZ0NoYXJhY3RlckVmZmVjdEZyb21SZWNvcmQocmVjb3JkOiBGaW5hbmNpYWxSZWNvcmQpOiBQcm9taXNlPHZvaWQ+IHtcclxuICB0cnkge1xyXG4gICAgY29uc29sZS5sb2coYFtsb2dDaGFyYWN0ZXJFZmZlY3RGcm9tUmVjb3JkXSBMb2dnaW5nIGNoYXJhY3RlciBlZmZlY3QgZm9yIHJlY29yZDogJHtyZWNvcmQubmFtZX0gKCR7cmVjb3JkLmlkfSlgKTtcclxuICAgIFxyXG4gICAgLy8gT25seSBsb2cgaWYgdGhlcmUgYXJlIGp1bmdsZSBjb2lucyB0byBhd2FyZFxyXG4gICAgaWYgKCFyZWNvcmQuanVuZ2xlQ29pbnMgfHwgcmVjb3JkLmp1bmdsZUNvaW5zIDw9IDApIHtcclxuICAgICAgY29uc29sZS5sb2coJ1tsb2dDaGFyYWN0ZXJFZmZlY3RGcm9tUmVjb3JkXSBObyBqdW5nbGUgY29pbnMgdG8gbG9nLCBza2lwcGluZycpO1xyXG4gICAgICByZXR1cm47XHJcbiAgICB9XHJcbiAgICBcclxuICAgIC8vIEdldCBtYWluIGNoYXJhY3RlciBJRCAoVjAuMSBjb25zdGFudClcclxuICAgIGNvbnN0IG1haW5DaGFyYWN0ZXJJZCA9ICdDSEFSQUNURVJfT05FX0lEJztcclxuICAgIFxyXG4gICAgYXdhaXQgYXBwZW5kQ2hhcmFjdGVySnVuZ2xlQ29pbnNMb2coXHJcbiAgICAgIG1haW5DaGFyYWN0ZXJJZCxcclxuICAgICAgcmVjb3JkLmp1bmdsZUNvaW5zLFxyXG4gICAgICByZWNvcmQuaWQsXHJcbiAgICAgICdmaW5hbmNpYWwnXHJcbiAgICApO1xyXG4gICAgXHJcbiAgICBjb25zb2xlLmxvZyhgW2xvZ0NoYXJhY3RlckVmZmVjdEZyb21SZWNvcmRdIOKchSBDaGFyYWN0ZXIgZWZmZWN0IGxvZ2dlZCBzdWNjZXNzZnVsbHkgZm9yICR7cmVjb3JkLm5hbWV9YCk7XHJcbiAgfSBjYXRjaCAoZXJyb3IpIHtcclxuICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGxvZ2dpbmcgY2hhcmFjdGVyIGVmZmVjdCBmcm9tIHJlY29yZDonLCBlcnJvcik7XHJcbiAgfVxyXG59XHJcblxyXG4vKipcclxuICogTG9nIGNoYXJhY3RlciB1cGRhdGUgZnJvbSB0YXNrIGNoYW5nZXNcclxuICogVGhpcyBpcyBjdXJyZW50bHkgYSBuby1vcCBzaW5jZSB0YXNrcyBkb24ndCBhd2FyZCBqdW5nbGUgY29pbnMgYW55bW9yZVxyXG4gKiBKJCBhcmUgb25seSBlYXJuZWQgdmlhIFBvaW50cyBFeGNoYW5nZVxyXG4gKi9cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGxvZ0NoYXJhY3RlclVwZGF0ZUZyb21UYXNrKHRhc2s6IFRhc2ssIG9sZFRhc2s6IFRhc2spOiBQcm9taXNlPHZvaWQ+IHtcclxuICAvLyBKJCBubyBsb25nZXIgYXdhcmRlZCBhcyB0YXNrIHJld2FyZHMgLSBvbmx5IGVhcm5lZCB2aWEgUG9pbnRzIEV4Y2hhbmdlXHJcbiAgLy8gVGhpcyBmdW5jdGlvbiBpcyBub3cgYSBuby1vcCBzaW5jZSB0YXNrcyBkb24ndCBhd2FyZCBKJCBhbnltb3JlXHJcbiAgcmV0dXJuO1xyXG59Il0sIm5hbWVzIjpbImFwcGVuZEVudGl0eUxvZyIsInVwZGF0ZUVudGl0eUxvZ0ZpZWxkIiwiaGFzRWZmZWN0IiwibWFya0VmZmVjdCIsImNsZWFyRWZmZWN0IiwiY2xlYXJFZmZlY3RzQnlQcmVmaXgiLCJDbGllbnRBUEkiLCJhcHBlbmRDaGFyYWN0ZXJKdW5nbGVDb2luc0xvZyIsIlNUQVRFX0ZJRUxEUyIsIkRFU0NSSVBUSVZFX0ZJRUxEUyIsIm9uQ2hhcmFjdGVyVXBzZXJ0IiwiY2hhcmFjdGVyIiwicHJldmlvdXNDaGFyYWN0ZXIiLCJlZmZlY3RLZXkiLCJpZCIsIm5hbWUiLCJyb2xlcyIsInJvbGVzQ2hhbmdlZCIsIkpTT04iLCJzdHJpbmdpZnkiLCJvbGRSb2xlcyIsIm5ld1JvbGVzIiwiaGFzU2lnbmlmaWNhbnRDaGFuZ2VzIiwiaXNBY3RpdmUiLCJmaWVsZCIsInJlbW92ZUNoYXJhY3RlckVmZmVjdHNPbkRlbGV0ZSIsImNoYXJhY3RlcklkIiwiY29uc29sZSIsImxvZyIsImNoYXJhY3RlckxpbmtzIiwiZ2V0TGlua3NGb3IiLCJ0eXBlIiwibGVuZ3RoIiwibGluayIsInJlbW92ZUxpbmsiLCJsaW5rVHlwZSIsImVycm9yIiwicmVzdWx0IiwicmVtb3ZlTG9nRW50cnkiLCJzdWNjZXNzIiwibWVzc2FnZSIsImxvZ0NoYXJhY3RlckVmZmVjdCIsInRhc2siLCJsb2dDaGFyYWN0ZXJFZmZlY3RGcm9tUmVjb3JkIiwicmVjb3JkIiwianVuZ2xlQ29pbnMiLCJtYWluQ2hhcmFjdGVySWQiLCJsb2dDaGFyYWN0ZXJVcGRhdGVGcm9tVGFzayIsIm9sZFRhc2siXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./workflows/entities-workflows/character.workflow.ts\n");

/***/ }),

/***/ "(rsc)/./workflows/entities-workflows/financial.workflow.ts":
/*!************************************************************!*\
  !*** ./workflows/entities-workflows/financial.workflow.ts ***!
  \************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   onFinancialUpsert: () => (/* binding */ onFinancialUpsert),\n/* harmony export */   removeRecordEffectsOnDelete: () => (/* binding */ removeRecordEffectsOnDelete)\n/* harmony export */ });\n/* harmony import */ var _entities_logging__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../entities-logging */ \"(rsc)/./workflows/entities-logging.ts\");\n/* harmony import */ var _data_store_effects_registry__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @/data-store/effects-registry */ \"(rsc)/./data-store/effects-registry.ts\");\n/* harmony import */ var _lib_client_api__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @/lib/client-api */ \"(rsc)/./lib/client-api.ts\");\n/* harmony import */ var _item_creation_utils__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../item-creation-utils */ \"(rsc)/./workflows/item-creation-utils.ts\");\n/* harmony import */ var _points_rewards_utils__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../points-rewards-utils */ \"(rsc)/./workflows/points-rewards-utils.ts\");\n/* harmony import */ var _update_propagation_utils__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../update-propagation-utils */ \"(rsc)/./workflows/update-propagation-utils.ts\");\n// workflows/entities-workflows/financial.workflow.ts\n// Financial-specific workflow with CHARGED, COLLECTED events\n\n\n\n\n\n\nconst STATE_FIELDS = [\n    \"isNotPaid\",\n    \"isNotCharged\",\n    \"isCollected\"\n];\nconst DESCRIPTIVE_FIELDS = [\n    \"name\",\n    \"description\",\n    \"cost\",\n    \"revenue\",\n    \"jungleCoins\",\n    \"notes\"\n];\nasync function onFinancialUpsert(financial, previousFinancial) {\n    // New financial record creation\n    if (!previousFinancial) {\n        const effectKey = `financial:${financial.id}:created`;\n        if (await (0,_data_store_effects_registry__WEBPACK_IMPORTED_MODULE_1__.hasEffect)(effectKey)) return;\n        await (0,_entities_logging__WEBPACK_IMPORTED_MODULE_0__.appendEntityLog)(\"financial\", financial.id, \"CREATED\", {\n            name: financial.name,\n            type: financial.type,\n            station: financial.station\n        });\n        await (0,_data_store_effects_registry__WEBPACK_IMPORTED_MODULE_1__.markEffect)(effectKey);\n        // Item creation from emissary fields - on record creation\n        if (financial.outputItemType && financial.outputQuantity) {\n            const itemEffectKey = `financial:${financial.id}:itemCreated`;\n            if (!await (0,_data_store_effects_registry__WEBPACK_IMPORTED_MODULE_1__.hasEffect)(itemEffectKey)) {\n                console.log(`[onFinancialUpsert] Creating item from financial record emissary fields: ${financial.name}`);\n                const createdItem = await (0,_item_creation_utils__WEBPACK_IMPORTED_MODULE_3__.createItemFromRecord)(financial);\n                if (createdItem) {\n                    await (0,_data_store_effects_registry__WEBPACK_IMPORTED_MODULE_1__.markEffect)(itemEffectKey);\n                    console.log(`[onFinancialUpsert] ✅ Item created and effect marked: ${createdItem.name}`);\n                }\n            }\n        }\n        // Points awarding - on record creation with rewards\n        if (financial.rewards?.points) {\n            const pointsEffectKey = `financial:${financial.id}:pointsAwarded`;\n            if (!await (0,_data_store_effects_registry__WEBPACK_IMPORTED_MODULE_1__.hasEffect)(pointsEffectKey)) {\n                console.log(`[onFinancialUpsert] Awarding points from financial record: ${financial.name}`);\n                await (0,_points_rewards_utils__WEBPACK_IMPORTED_MODULE_4__.awardPointsToPlayer)((0,_points_rewards_utils__WEBPACK_IMPORTED_MODULE_4__.getMainPlayerId)(), {\n                    xp: financial.rewards.points.xp || 0,\n                    rp: financial.rewards.points.rp || 0,\n                    fp: financial.rewards.points.fp || 0,\n                    hp: financial.rewards.points.hp || 0\n                }, financial.id, \"financial\");\n                await (0,_data_store_effects_registry__WEBPACK_IMPORTED_MODULE_1__.markEffect)(pointsEffectKey);\n                console.log(`[onFinancialUpsert] ✅ Points awarded and effect marked for record: ${financial.name}`);\n            }\n        }\n        // Jungle coins awarding - on record creation\n        if (financial.jungleCoins && financial.jungleCoins > 0) {\n            const jungleCoinsEffectKey = `financial:${financial.id}:jungleCoinsAwarded`;\n            if (!await (0,_data_store_effects_registry__WEBPACK_IMPORTED_MODULE_1__.hasEffect)(jungleCoinsEffectKey)) {\n                console.log(`[onFinancialUpsert] Awarding jungle coins from financial record: ${financial.name}`);\n                await (0,_points_rewards_utils__WEBPACK_IMPORTED_MODULE_4__.awardJungleCoinsToCharacter)((0,_points_rewards_utils__WEBPACK_IMPORTED_MODULE_4__.getMainCharacterId)(), financial.jungleCoins, financial.id, \"financial\");\n                await (0,_data_store_effects_registry__WEBPACK_IMPORTED_MODULE_1__.markEffect)(jungleCoinsEffectKey);\n                console.log(`[onFinancialUpsert] ✅ Jungle coins awarded and effect marked for record: ${financial.name}`);\n            }\n        }\n        return;\n    }\n    // Payment status changes - CHARGED event\n    if (previousFinancial.isNotCharged && !financial.isNotCharged) {\n        await (0,_entities_logging__WEBPACK_IMPORTED_MODULE_0__.appendEntityLog)(\"financial\", financial.id, \"CHARGED\", {\n            name: financial.name,\n            revenue: financial.revenue,\n            chargedAt: new Date().toISOString()\n        });\n    }\n    // Collection status - COLLECTED event\n    if (!previousFinancial.isCollected && financial.isCollected) {\n        await (0,_entities_logging__WEBPACK_IMPORTED_MODULE_0__.appendEntityLog)(\"financial\", financial.id, \"COLLECTED\", {\n            name: financial.name,\n            collectedAt: new Date().toISOString()\n        });\n    }\n    // COMPREHENSIVE UPDATE PROPAGATION - when financial record properties change\n    if (previousFinancial) {\n        // Propagate to Tasks\n        if ((0,_update_propagation_utils__WEBPACK_IMPORTED_MODULE_5__.hasFinancialPropsChanged)(financial, previousFinancial)) {\n            console.log(`[onFinancialUpsert] Propagating financial changes to tasks: ${financial.name}`);\n            await (0,_update_propagation_utils__WEBPACK_IMPORTED_MODULE_5__.updateTasksFromFinancialRecord)(financial, previousFinancial);\n        }\n        // Propagate to Items\n        if ((0,_update_propagation_utils__WEBPACK_IMPORTED_MODULE_5__.hasOutputPropsChanged)(financial, previousFinancial)) {\n            console.log(`[onFinancialUpsert] Propagating output changes to items: ${financial.name}`);\n            await (0,_update_propagation_utils__WEBPACK_IMPORTED_MODULE_5__.updateItemsCreatedByRecord)(financial, previousFinancial);\n        }\n        // Propagate to Player (points delta)\n        if ((0,_update_propagation_utils__WEBPACK_IMPORTED_MODULE_5__.hasRewardsChanged)(financial, previousFinancial)) {\n            console.log(`[onFinancialUpsert] Propagating points changes to player: ${financial.name}`);\n            await (0,_update_propagation_utils__WEBPACK_IMPORTED_MODULE_5__.updatePlayerPointsFromSource)(\"financial\", financial, previousFinancial);\n        }\n        // Propagate to Character (jungle coins delta)\n        if ((0,_update_propagation_utils__WEBPACK_IMPORTED_MODULE_5__.hasJungleCoinsChanged)(financial, previousFinancial)) {\n            console.log(`[onFinancialUpsert] Propagating jungle coins changes to character: ${financial.name}`);\n            await (0,_update_propagation_utils__WEBPACK_IMPORTED_MODULE_5__.updateCharacterJungleCoinsFromRecord)(financial, previousFinancial);\n        }\n    }\n    // Descriptive changes - update in-place\n    for (const field of DESCRIPTIVE_FIELDS){\n        if (previousFinancial[field] !== financial[field]) {\n            await (0,_entities_logging__WEBPACK_IMPORTED_MODULE_0__.updateEntityLogField)(\"financial\", financial.id, field, previousFinancial[field], financial[field]);\n        }\n    }\n}\n/**\r\n * Remove financial record effects when record is deleted\r\n * Financial records can have entries in multiple logs: financials, character, player, items\r\n */ async function removeRecordEffectsOnDelete(recordId) {\n    try {\n        console.log(`[removeRecordEffectsOnDelete] Starting cleanup for record: ${recordId}`);\n        // 1. Remove items created by this record\n        await (0,_item_creation_utils__WEBPACK_IMPORTED_MODULE_3__.removeItemsCreatedByRecord)(recordId);\n        // 2. Remove player points that were awarded by this record (if points were badly given)\n        await removePlayerPointsFromRecord(recordId);\n        // 3. Remove jungle coins that were awarded by this record\n        await removeJungleCoinsFromRecord(recordId);\n        // 4. Remove all Links related to this record\n        const recordLinks = await _lib_client_api__WEBPACK_IMPORTED_MODULE_2__.ClientAPI.getLinksFor({\n            type: \"financial\",\n            id: recordId\n        });\n        console.log(`[removeRecordEffectsOnDelete] Found ${recordLinks.length} links to remove`);\n        for (const link of recordLinks){\n            try {\n                await _lib_client_api__WEBPACK_IMPORTED_MODULE_2__.ClientAPI.removeLink(link.id);\n                console.log(`[removeRecordEffectsOnDelete] ✅ Removed link: ${link.linkType}`);\n            } catch (error) {\n                console.error(`[removeRecordEffectsOnDelete] ❌ Failed to remove link ${link.id}:`, error);\n            }\n        }\n        // 5. Clear effects registry\n        await (0,_data_store_effects_registry__WEBPACK_IMPORTED_MODULE_1__.clearEffect)(`financial:${recordId}:created`);\n        await (0,_data_store_effects_registry__WEBPACK_IMPORTED_MODULE_1__.clearEffect)(`financial:${recordId}:itemCreated`);\n        await (0,_data_store_effects_registry__WEBPACK_IMPORTED_MODULE_1__.clearEffect)(`financial:${recordId}:pointsAwarded`);\n        await (0,_data_store_effects_registry__WEBPACK_IMPORTED_MODULE_1__.clearEffect)(`financial:${recordId}:jungleCoinsAwarded`);\n        await (0,_data_store_effects_registry__WEBPACK_IMPORTED_MODULE_1__.clearEffectsByPrefix)(\"financial\", recordId, \"pointsLogged:\");\n        await (0,_data_store_effects_registry__WEBPACK_IMPORTED_MODULE_1__.clearEffectsByPrefix)(\"financial\", recordId, \"financialLogged:\");\n        // 6. Remove log entries from all relevant logs\n        console.log(`[removeRecordEffectsOnDelete] Starting log entry removal for record: ${recordId}`);\n        const removals = await Promise.all([\n            _lib_client_api__WEBPACK_IMPORTED_MODULE_2__.ClientAPI.removeLogEntry(\"financials\", recordId).then((r)=>{\n                console.log(`[removeRecordEffectsOnDelete] Financials log removal result:`, r);\n                return r;\n            }).catch((e)=>({\n                    success: false,\n                    message: String(e)\n                })),\n            _lib_client_api__WEBPACK_IMPORTED_MODULE_2__.ClientAPI.removeLogEntry(\"character\", recordId).then((r)=>{\n                console.log(`[removeRecordEffectsOnDelete] Character log removal result:`, r);\n                return r;\n            }).catch((e)=>({\n                    success: false,\n                    message: String(e)\n                })),\n            _lib_client_api__WEBPACK_IMPORTED_MODULE_2__.ClientAPI.removeLogEntry(\"player\", recordId).then((r)=>{\n                console.log(`[removeRecordEffectsOnDelete] Player log removal result:`, r);\n                return r;\n            }).catch((e)=>({\n                    success: false,\n                    message: String(e)\n                })),\n            _lib_client_api__WEBPACK_IMPORTED_MODULE_2__.ClientAPI.removeLogEntry(\"items\", recordId).then((r)=>{\n                console.log(`[removeRecordEffectsOnDelete] Items log removal result:`, r);\n                return r;\n            }).catch((e)=>({\n                    success: false,\n                    message: String(e)\n                }))\n        ]);\n        console.log(`[removeRecordEffectsOnDelete] All removal results:`, removals);\n        const failed = removals.filter((r)=>!r.success);\n        if (failed.length > 0) {\n            console.error(\"[removeRecordEffectsOnDelete] Some log removals failed:\", failed);\n        } else {\n            console.log(`[removeRecordEffectsOnDelete] ✅ All log entries removed successfully for record: ${recordId}`);\n        }\n        console.log(`[removeRecordEffectsOnDelete] ✅ Cleared effects, removed links, deleted created items, and removed log entries for record ${recordId}`);\n    } catch (error) {\n        console.error(\"Error removing record effects:\", error);\n    }\n}\n/**\r\n * Remove player points that were awarded by a specific financial record\r\n * This is used when rolling back a record that incorrectly awarded points\r\n */ async function removePlayerPointsFromRecord(recordId) {\n    try {\n        console.log(`[removePlayerPointsFromRecord] Removing points for record: ${recordId}`);\n        // Get the record to find what points were awarded\n        const records = await _lib_client_api__WEBPACK_IMPORTED_MODULE_2__.ClientAPI.getFinancialRecords();\n        const record = records.find((r)=>r.id === recordId);\n        if (!record || !record.rewards?.points) {\n            console.log(`[removePlayerPointsFromRecord] Record ${recordId} has no points to remove`);\n            return;\n        }\n        // Get the main player\n        const mainPlayerId = (0,_points_rewards_utils__WEBPACK_IMPORTED_MODULE_4__.getMainPlayerId)();\n        const players = await _lib_client_api__WEBPACK_IMPORTED_MODULE_2__.ClientAPI.getPlayers();\n        const mainPlayer = players.find((p)=>p.id === mainPlayerId);\n        if (!mainPlayer) {\n            console.log(`[removePlayerPointsFromRecord] Main player not found, skipping points removal`);\n            return;\n        }\n        // Check if any points were actually awarded\n        const pointsToRemove = record.rewards.points;\n        const hasPoints = (pointsToRemove.xp || 0) > 0 || (pointsToRemove.rp || 0) > 0 || (pointsToRemove.fp || 0) > 0 || (pointsToRemove.hp || 0) > 0;\n        if (!hasPoints) {\n            console.log(`[removePlayerPointsFromRecord] No points to remove from record ${recordId}`);\n            return;\n        }\n        // Remove the points from the player\n        await (0,_points_rewards_utils__WEBPACK_IMPORTED_MODULE_4__.removePointsFromPlayer)(mainPlayerId, {\n            xp: pointsToRemove.xp || 0,\n            rp: pointsToRemove.rp || 0,\n            fp: pointsToRemove.fp || 0,\n            hp: pointsToRemove.hp || 0\n        });\n        console.log(`[removePlayerPointsFromRecord] ✅ Removed points from player: ${JSON.stringify(pointsToRemove)}`);\n    } catch (error) {\n        console.error(`[removePlayerPointsFromRecord] ❌ Failed to remove player points for record ${recordId}:`, error);\n    }\n}\n/**\r\n * Remove jungle coins that were awarded by a specific financial record\r\n * This is used when rolling back a record that incorrectly awarded jungle coins\r\n */ async function removeJungleCoinsFromRecord(recordId) {\n    try {\n        console.log(`[removeJungleCoinsFromRecord] Removing jungle coins for record: ${recordId}`);\n        // Get the record to find what jungle coins were awarded\n        const records = await _lib_client_api__WEBPACK_IMPORTED_MODULE_2__.ClientAPI.getFinancialRecords();\n        const record = records.find((r)=>r.id === recordId);\n        if (!record || !record.jungleCoins || record.jungleCoins <= 0) {\n            console.log(`[removeJungleCoinsFromRecord] Record ${recordId} has no jungle coins to remove`);\n            return;\n        }\n        // Get the main character\n        const mainCharacterId = (0,_points_rewards_utils__WEBPACK_IMPORTED_MODULE_4__.getMainCharacterId)();\n        const characters = await _lib_client_api__WEBPACK_IMPORTED_MODULE_2__.ClientAPI.getCharacters();\n        const mainCharacter = characters.find((c)=>c.id === mainCharacterId);\n        if (!mainCharacter) {\n            console.log(`[removeJungleCoinsFromRecord] Main character not found, skipping jungle coins removal`);\n            return;\n        }\n        // Remove the jungle coins from the character\n        await (0,_points_rewards_utils__WEBPACK_IMPORTED_MODULE_4__.removeJungleCoinsFromCharacter)(mainCharacterId, record.jungleCoins);\n        console.log(`[removeJungleCoinsFromRecord] ✅ Removed ${record.jungleCoins} jungle coins from character`);\n    } catch (error) {\n        console.error(`[removeJungleCoinsFromRecord] ❌ Failed to remove jungle coins for record ${recordId}:`, error);\n    }\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi93b3JrZmxvd3MvZW50aXRpZXMtd29ya2Zsb3dzL2ZpbmFuY2lhbC53b3JrZmxvdy50cyIsIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7OztBQUFBLHFEQUFxRDtBQUNyRCw2REFBNkQ7QUFHZTtBQUM2QjtBQUM1RDtBQUM2QztBQUM4RjtBQVVuSjtBQUVyQyxNQUFNdUIsZUFBZTtJQUFDO0lBQWE7SUFBZ0I7Q0FBYztBQUNqRSxNQUFNQyxxQkFBcUI7SUFBQztJQUFRO0lBQWU7SUFBUTtJQUFXO0lBQWU7Q0FBUTtBQUV0RixlQUFlQyxrQkFBa0JDLFNBQTBCLEVBQUVDLGlCQUFtQztJQUNyRyxnQ0FBZ0M7SUFDaEMsSUFBSSxDQUFDQSxtQkFBbUI7UUFDdEIsTUFBTUMsWUFBWSxDQUFDLFVBQVUsRUFBRUYsVUFBVUcsRUFBRSxDQUFDLFFBQVEsQ0FBQztRQUNyRCxJQUFJLE1BQU0zQix1RUFBU0EsQ0FBQzBCLFlBQVk7UUFFaEMsTUFBTTVCLGtFQUFlQSxDQUFDLGFBQWEwQixVQUFVRyxFQUFFLEVBQUUsV0FBVztZQUMxREMsTUFBTUosVUFBVUksSUFBSTtZQUNwQkMsTUFBTUwsVUFBVUssSUFBSTtZQUNwQkMsU0FBU04sVUFBVU0sT0FBTztRQUM1QjtRQUNBLE1BQU03Qix3RUFBVUEsQ0FBQ3lCO1FBRWpCLDBEQUEwRDtRQUMxRCxJQUFJRixVQUFVTyxjQUFjLElBQUlQLFVBQVVRLGNBQWMsRUFBRTtZQUN4RCxNQUFNQyxnQkFBZ0IsQ0FBQyxVQUFVLEVBQUVULFVBQVVHLEVBQUUsQ0FBQyxZQUFZLENBQUM7WUFDN0QsSUFBSSxDQUFFLE1BQU0zQix1RUFBU0EsQ0FBQ2lDLGdCQUFpQjtnQkFDckNDLFFBQVFDLEdBQUcsQ0FBQyxDQUFDLHlFQUF5RSxFQUFFWCxVQUFVSSxJQUFJLENBQUMsQ0FBQztnQkFDeEcsTUFBTVEsY0FBYyxNQUFNL0IsMEVBQW9CQSxDQUFDbUI7Z0JBQy9DLElBQUlZLGFBQWE7b0JBQ2YsTUFBTW5DLHdFQUFVQSxDQUFDZ0M7b0JB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QVFDLEdBQUcsQ0FBQyxDQUFDLHFGQUFxRixDQUFDO1lBQ25HO1FBQ0Y7UUFFQSw2Q0FBNkM7UUFDN0MsTUFBTXpCLHFGQUE4QkEsQ0FBQ2lGLGlCQUFpQlgsT0FBT3BDLFdBQVc7UUFDeEVWLFFBQVFDLEdBQUcsQ0FBQyxDQUFDLHdDQUF3QyxFQUFFNkMsT0FBT3BDLFdBQVcsQ0FBQyw0QkFBNEIsQ0FBQztJQUV6RyxFQUFFLE9BQU9vQixPQUFPO1FBQ2Q5QixRQUFROEIsS0FBSyxDQUFDLENBQUMseUVBQXlFLEVBQUVULFNBQVMsQ0FBQyxDQUFDLEVBQUVTO0lBQ3pHO0FBQ0YiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly90aGVnYW1lLWFkbWluLy4vd29ya2Zsb3dzL2VudGl0aWVzLXdvcmtmbG93cy9maW5hbmNpYWwud29ya2Zsb3cudHM/M2M0ZiJdLCJzb3VyY2VzQ29udGVudCI6WyIvLyB3b3JrZmxvd3MvZW50aXRpZXMtd29ya2Zsb3dzL2ZpbmFuY2lhbC53b3JrZmxvdy50c1xyXG4vLyBGaW5hbmNpYWwtc3BlY2lmaWMgd29ya2Zsb3cgd2l0aCBDSEFSR0VELCBDT0xMRUNURUQgZXZlbnRzXHJcblxyXG5pbXBvcnQgdHlwZSB7IEZpbmFuY2lhbFJlY29yZCB9IGZyb20gJ0AvdHlwZXMvZW50aXRpZXMnO1xyXG5pbXBvcnQgeyBhcHBlbmRFbnRpdHlMb2csIHVwZGF0ZUVudGl0eUxvZ0ZpZWxkIH0gZnJvbSAnLi4vZW50aXRpZXMtbG9nZ2luZyc7XHJcbmltcG9ydCB7IGhhc0VmZmVjdCwgbWFya0VmZmVjdCwgY2xlYXJFZmZlY3QsIGNsZWFyRWZmZWN0c0J5UHJlZml4IH0gZnJvbSAnQC9kYXRhLXN0b3JlL2VmZmVjdHMtcmVnaXN0cnknO1xyXG5pbXBvcnQgeyBDbGllbnRBUEkgfSBmcm9tICdAL2xpYi9jbGllbnQtYXBpJztcclxuaW1wb3J0IHsgY3JlYXRlSXRlbUZyb21SZWNvcmQsIHJlbW92ZUl0ZW1zQ3JlYXRlZEJ5UmVjb3JkIH0gZnJvbSAnLi4vaXRlbS1jcmVhdGlvbi11dGlscyc7XHJcbmltcG9ydCB7IGF3YXJkUG9pbnRzVG9QbGF5ZXIsIHJlbW92ZVBvaW50c0Zyb21QbGF5ZXIsIGF3YXJkSnVuZ2xlQ29pbnNUb0NoYXJhY3RlciwgcmVtb3ZlSnVuZ2xlQ29pbnNGcm9tQ2hhcmFjdGVyLCBnZXRNYWluUGxheWVySWQsIGdldE1haW5DaGFyYWN0ZXJJZCB9IGZyb20gJy4uL3BvaW50cy1yZXdhcmRzLXV0aWxzJztcclxuaW1wb3J0IHsgXHJcbiAgdXBkYXRlVGFza3NGcm9tRmluYW5jaWFsUmVjb3JkLCBcclxuICB1cGRhdGVJdGVtc0NyZWF0ZWRCeVJlY29yZCwgXHJcbiAgdXBkYXRlUGxheWVyUG9pbnRzRnJvbVNvdXJjZSxcclxuICB1cGRhdGVDaGFyYWN0ZXJKdW5nbGVDb2luc0Zyb21SZWNvcmQsXHJcbiAgaGFzRmluYW5jaWFsUHJvcHNDaGFuZ2VkLFxyXG4gIGhhc091dHB1dFByb3BzQ2hhbmdlZCxcclxuICBoYXNSZXdhcmRzQ2hhbmdlZCxcclxuICBoYXNKdW5nbGVDb2luc0NoYW5nZWRcclxufSBmcm9tICcuLi91cGRhdGUtcHJvcGFnYXRpb24tdXRpbHMnO1xyXG5cclxuY29uc3QgU1RBVEVfRklFTERTID0gWydpc05vdFBhaWQnLCAnaXNOb3RDaGFyZ2VkJywgJ2lzQ29sbGVjdGVkJ107XHJcbmNvbnN0IERFU0NSSVBUSVZFX0ZJRUxEUyA9IFsnbmFtZScsICdkZXNjcmlwdGlvbicsICdjb3N0JywgJ3JldmVudWUnLCAnanVuZ2xlQ29pbnMnLCAnbm90ZXMnXTtcclxuXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBvbkZpbmFuY2lhbFVwc2VydChmaW5hbmNpYWw6IEZpbmFuY2lhbFJlY29yZCwgcHJldmlvdXNGaW5hbmNpYWw/OiBGaW5hbmNpYWxSZWNvcmQpOiBQcm9taXNlPHZvaWQ+IHtcclxuICAvLyBOZXcgZmluYW5jaWFsIHJlY29yZCBjcmVhdGlvblxyXG4gIGlmICghcHJldmlvdXNGaW5hbmNpYWwpIHtcclxuICAgIGNvbnN0IGVmZmVjdEtleSA9IGBmaW5hbmNpYWw6JHtmaW5hbmNpYWwuaWR9OmNyZWF0ZWRgO1xyXG4gICAgaWYgKGF3YWl0IGhhc0VmZmVjdChlZmZlY3RLZXkpKSByZXR1cm47XHJcbiAgICBcclxuICAgIGF3YWl0IGFwcGVuZEVudGl0eUxvZygnZmluYW5jaWFsJywgZmluYW5jaWFsLmlkLCAnQ1JFQVRFRCcsIHsgXHJcbiAgICAgIG5hbWU6IGZpbmFuY2lhbC5uYW1lLCBcclxuICAgICAgdHlwZTogZmluYW5jaWFsLnR5cGUsXHJcbiAgICAgIHN0YXRpb246IGZpbmFuY2lhbC5zdGF0aW9uLFxyXG4gICAgfSk7XHJcbiAgICBhd2FpdCBtYXJrRWZmZWN0KGVmZmVjdEtleSk7XHJcbiAgICBcclxuICAgIC8vIEl0ZW0gY3JlYXRpb24gZnJvbSBlbWlzc2FyeSBmaWVsZHMgLSBvbiByZWNvcmQgY3JlYXRpb25cclxuICAgIGlmIChmaW5hbmNpYWwub3V0cHV0SXRlbVR5cGUgJiYgZmluYW5jaWFsLm91dHB1dFF1YW50aXR5KSB7XHJcbiAgICAgIGNvbnN0IGl0ZW1FZmZlY3RLZXkgPSBgZmluYW5jaWFsOiR7ZmluYW5jaWFsLmlkfTppdGVtQ3JlYXRlZGA7XHJcbiAgICAgIGlmICghKGF3YWl0IGhhc0VmZmVjdChpdGVtRWZmZWN0S2V5KSkpIHtcclxuICAgICAgICBjb25zb2xlLmxvZyhgW29uRmluYW5jaWFsVXBzZXJ0XSBDcmVhdGluZyBpdGVtIGZyb20gZmluYW5jaWFsIHJlY29yZCBlbWlzc2FyeSBmaWVsZHM6ICR7ZmluYW5jaWFsLm5hbWV9YCk7XHJcbiAgICAgICAgY29uc3QgY3JlYXRlZEl0ZW0gPSBhd2FpdCBjcmVhdGVJdGVtRnJvbVJlY29yZChmaW5hbmNpYWwpO1xyXG4gICAgICAgIGlmIChjcmVhdGVkSXRlbSkge1xyXG4gICAgICAgICAgYXdhaXQgbWFya0VmZmVjdChpdGVtRWZmZWN0S2V5KTtcclxuICAgICAgICAgIGNvbnNvbGUubG9nKGBbb25GaW5hbmNpYWxVcHNlcnRdIOKchSBJdGVtIGNyZWF0ZWQgYW5kIGVmZmVjdCBtYXJrZWQ6ICR7Y3JlYXRlZEl0ZW0ubmFtZX1gKTtcclxuICAgICAgICB9XHJcbiAgICAgIH1cclxuICAgIH1cclxuICAgIFxyXG4gICAgLy8gUG9pbnRzIGF3YXJkaW5nIC0gb24gcmVjb3JkIGNyZWF0aW9uIHdpdGggcmV3YXJkc1xyXG4gICAgaWYgKGZpbmFuY2lhbC5yZXdhcmRzPy5wb2ludHMpIHtcclxuICAgICAgY29uc3QgcG9pbnRzRWZmZWN0S2V5ID0gYGZpbmFuY2lhbDoke2ZpbmFuY2lhbC5pZH06cG9pbnRzQXdhcmRlZGA7XHJcbiAgICAgIGlmICghKGF3YWl0IGhhc0VmZmVjdChwb2ludHNFZmZlY3RLZXkpKSkge1xyXG4gICAgICAgIGNvbnNvbGUubG9nKGBbb25GaW5hbmNpYWxVcHNlcnRdIEF3YXJkaW5nIHBvaW50cyBmcm9tIGZpbmFuY2lhbCByZWNvcmQ6ICR7ZmluYW5jaWFsLm5hbWV9YCk7XHJcbiAgICAgICAgYXdhaXQgYXdhcmRQb2ludHNUb1BsYXllcihnZXRNYWluUGxheWVySWQoKSwge1xyXG4gICAgICAgICAgeHA6IGZpbmFuY2lhbC5yZXdhcmRzLnBvaW50cy54cCB8fCAwLFxyXG4gICAgICAgICAgcnA6IGZpbmFuY2lhbC5yZXdhcmRzLnBvaW50cy5ycCB8fCAwLFxyXG4gICAgICAgICAgZnA6IGZpbmFuY2lhbC5yZXdhcmRzLnBvaW50cy5mcCB8fCAwLFxyXG4gICAgICAgICAgaHA6IGZpbmFuY2lhbC5yZXdhcmRzLnBvaW50cy5ocCB8fCAwXHJcbiAgICAgICAgfSwgZmluYW5jaWFsLmlkLCAnZmluYW5jaWFsJyk7XHJcbiAgICAgICAgYXdhaXQgbWFya0VmZmVjdChwb2ludHNFZmZlY3RLZXkpO1xyXG4gICAgICAgIGNvbnNvbGUubG9nKGBbb25GaW5hbmNpYWxVcHNlcnRdIOKchSBQb2ludHMgYXdhcmRlZCBhbmQgZWZmZWN0IG1hcmtlZCBmb3IgcmVjb3JkOiAke2ZpbmFuY2lhbC5uYW1lfWApO1xyXG4gICAgICB9XHJcbiAgICB9XHJcbiAgICBcclxuICAgIC8vIEp1bmdsZSBjb2lucyBhd2FyZGluZyAtIG9uIHJlY29yZCBjcmVhdGlvblxyXG4gICAgaWYgKGZpbmFuY2lhbC5qdW5nbGVDb2lucyAmJiBmaW5hbmNpYWwuanVuZ2xlQ29pbnMgPiAwKSB7XHJcbiAgICAgIGNvbnN0IGp1bmdsZUNvaW5zRWZmZWN0S2V5ID0gYGZpbmFuY2lhbDoke2ZpbmFuY2lhbC5pZH06anVuZ2xlQ29pbnNBd2FyZGVkYDtcclxuICAgICAgaWYgKCEoYXdhaXQgaGFzRWZmZWN0KGp1bmdsZUNvaW5zRWZmZWN0S2V5KSkpIHtcclxuICAgICAgICBjb25zb2xlLmxvZyhgW29uRmluYW5jaWFsVXBzZXJ0XSBBd2FyZGluZyBqdW5nbGUgY29pbnMgZnJvbSBmaW5hbmNpYWwgcmVjb3JkOiAke2ZpbmFuY2lhbC5uYW1lfWApO1xyXG4gICAgICAgIGF3YWl0IGF3YXJkSnVuZ2xlQ29pbnNUb0NoYXJhY3RlcihnZXRNYWluQ2hhcmFjdGVySWQoKSwgZmluYW5jaWFsLmp1bmdsZUNvaW5zLCBmaW5hbmNpYWwuaWQsICdmaW5hbmNpYWwnKTtcclxuICAgICAgICBhd2FpdCBtYXJrRWZmZWN0KGp1bmdsZUNvaW5zRWZmZWN0S2V5KTtcclxuICAgICAgICBjb25zb2xlLmxvZyhgW29uRmluYW5jaWFsVXBzZXJ0XSDinIUgSnVuZ2xlIGNvaW5zIGF3YXJkZWQgYW5kIGVmZmVjdCBtYXJrZWQgZm9yIHJlY29yZDogJHtmaW5hbmNpYWwubmFtZX1gKTtcclxuICAgICAgfVxyXG4gICAgfVxyXG4gICAgXHJcbiAgICByZXR1cm47XHJcbiAgfVxyXG4gIFxyXG4gIC8vIFBheW1lbnQgc3RhdHVzIGNoYW5nZXMgLSBDSEFSR0VEIGV2ZW50XHJcbiAgaWYgKHByZXZpb3VzRmluYW5jaWFsLmlzTm90Q2hhcmdlZCAmJiAhZmluYW5jaWFsLmlzTm90Q2hhcmdlZCkge1xyXG4gICAgYXdhaXQgYXBwZW5kRW50aXR5TG9nKCdmaW5hbmNpYWwnLCBmaW5hbmNpYWwuaWQsICdDSEFSR0VEJywge1xyXG4gICAgICBuYW1lOiBmaW5hbmNpYWwubmFtZSxcclxuICAgICAgcmV2ZW51ZTogZmluYW5jaWFsLnJldmVudWUsXHJcbiAgICAgIGNoYXJnZWRBdDogbmV3IERhdGUoKS50b0lTT1N0cmluZygpXHJcbiAgICB9KTtcclxuICB9XHJcbiAgXHJcbiAgLy8gQ29sbGVjdGlvbiBzdGF0dXMgLSBDT0xMRUNURUQgZXZlbnRcclxuICBpZiAoIXByZXZpb3VzRmluYW5jaWFsLmlzQ29sbGVjdGVkICYmIGZpbmFuY2lhbC5pc0NvbGxlY3RlZCkge1xyXG4gICAgYXdhaXQgYXBwZW5kRW50aXR5TG9nKCdmaW5hbmNpYWwnLCBmaW5hbmNpYWwuaWQsICdDT0xMRUNURUQnLCB7XHJcbiAgICAgIG5hbWU6IGZpbmFuY2lhbC5uYW1lLFxyXG4gICAgICBjb2xsZWN0ZWRBdDogbmV3IERhdGUoKS50b0lTT1N0cmluZygpXHJcbiAgICB9KTtcclxuICB9XHJcbiAgXHJcbiAgLy8gQ09NUFJFSEVOU0lWRSBVUERBVEUgUFJPUEFHQVRJT04gLSB3aGVuIGZpbmFuY2lhbCByZWNvcmQgcHJvcGVydGllcyBjaGFuZ2VcclxuICBpZiAocHJldmlvdXNGaW5hbmNpYWwpIHtcclxuICAgIC8vIFByb3BhZ2F0ZSB0byBUYXNrc1xyXG4gICAgaWYgKGhhc0ZpbmFuY2lhbFByb3BzQ2hhbmdlZChmaW5hbmNpYWwsIHByZXZpb3VzRmluYW5jaWFsKSkge1xyXG4gICAgICBjb25zb2xlLmxvZyhgW29uRmluYW5jaWFsVXBzZXJ0XSBQcm9wYWdhdGluZyBmaW5hbmNpYWwgY2hhbmdlcyB0byB0YXNrczogJHtmaW5hbmNpYWwubmFtZX1gKTtcclxuICAgICAgYXdhaXQgdXBkYXRlVGFza3NGcm9tRmluYW5jaWFsUmVjb3JkKGZpbmFuY2lhbCwgcHJldmlvdXNGaW5hbmNpYWwpO1xyXG4gICAgfVxyXG4gICAgXHJcbiAgICAvLyBQcm9wYWdhdGUgdG8gSXRlbXNcclxuICAgIGlmIChoYXNPdXRwdXRQcm9wc0NoYW5nZWQoZmluYW5jaWFsLCBwcmV2aW91c0ZpbmFuY2lhbCkpIHtcclxuICAgICAgY29uc29sZS5sb2coYFtvbkZpbmFuY2lhbFVwc2VydF0gUHJvcGFnYXRpbmcgb3V0cHV0IGNoYW5nZXMgdG8gaXRlbXM6ICR7ZmluYW5jaWFsLm5hbWV9YCk7XHJcbiAgICAgIGF3YWl0IHVwZGF0ZUl0ZW1zQ3JlYXRlZEJ5UmVjb3JkKGZpbmFuY2lhbCwgcHJldmlvdXNGaW5hbmNpYWwpO1xyXG4gICAgfVxyXG4gICAgXHJcbiAgICAvLyBQcm9wYWdhdGUgdG8gUGxheWVyIChwb2ludHMgZGVsdGEpXHJcbiAgICBpZiAoaGFzUmV3YXJkc0NoYW5nZWQoZmluYW5jaWFsLCBwcmV2aW91c0ZpbmFuY2lhbCkpIHtcclxuICAgICAgY29uc29sZS5sb2coYFtvbkZpbmFuY2lhbFVwc2VydF0gUHJvcGFnYXRpbmcgcG9pbnRzIGNoYW5nZXMgdG8gcGxheWVyOiAke2ZpbmFuY2lhbC5uYW1lfWApO1xyXG4gICAgICBhd2FpdCB1cGRhdGVQbGF5ZXJQb2ludHNGcm9tU291cmNlKCdmaW5hbmNpYWwnLCBmaW5hbmNpYWwsIHByZXZpb3VzRmluYW5jaWFsKTtcclxuICAgIH1cclxuICAgIFxyXG4gICAgLy8gUHJvcGFnYXRlIHRvIENoYXJhY3RlciAoanVuZ2xlIGNvaW5zIGRlbHRhKVxyXG4gICAgaWYgKGhhc0p1bmdsZUNvaW5zQ2hhbmdlZChmaW5hbmNpYWwsIHByZXZpb3VzRmluYW5jaWFsKSkge1xyXG4gICAgICBjb25zb2xlLmxvZyhgW29uRmluYW5jaWFsVXBzZXJ0XSBQcm9wYWdhdGluZyBqdW5nbGUgY29pbnMgY2hhbmdlcyB0byBjaGFyYWN0ZXI6ICR7ZmluYW5jaWFsLm5hbWV9YCk7XHJcbiAgICAgIGF3YWl0IHVwZGF0ZUNoYXJhY3Rlckp1bmdsZUNvaW5zRnJvbVJlY29yZChmaW5hbmNpYWwsIHByZXZpb3VzRmluYW5jaWFsKTtcclxuICAgIH1cclxuICB9XHJcbiAgXHJcbiAgLy8gRGVzY3JpcHRpdmUgY2hhbmdlcyAtIHVwZGF0ZSBpbi1wbGFjZVxyXG4gIGZvciAoY29uc3QgZmllbGQgb2YgREVTQ1JJUFRJVkVfRklFTERTKSB7XHJcbiAgICBpZiAoKHByZXZpb3VzRmluYW5jaWFsIGFzIGFueSlbZmllbGRdICE9PSAoZmluYW5jaWFsIGFzIGFueSlbZmllbGRdKSB7XHJcbiAgICAgIGF3YWl0IHVwZGF0ZUVudGl0eUxvZ0ZpZWxkKCdmaW5hbmNpYWwnLCBmaW5hbmNpYWwuaWQsIGZpZWxkLCAocHJldmlvdXNGaW5hbmNpYWwgYXMgYW55KVtmaWVsZF0sIChmaW5hbmNpYWwgYXMgYW55KVtmaWVsZF0pO1xyXG4gICAgfVxyXG4gIH1cclxufVxyXG5cclxuLyoqXHJcbiAqIFJlbW92ZSBmaW5hbmNpYWwgcmVjb3JkIGVmZmVjdHMgd2hlbiByZWNvcmQgaXMgZGVsZXRlZFxyXG4gKiBGaW5hbmNpYWwgcmVjb3JkcyBjYW4gaGF2ZSBlbnRyaWVzIGluIG11bHRpcGxlIGxvZ3M6IGZpbmFuY2lhbHMsIGNoYXJhY3RlciwgcGxheWVyLCBpdGVtc1xyXG4gKi9cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIHJlbW92ZVJlY29yZEVmZmVjdHNPbkRlbGV0ZShyZWNvcmRJZDogc3RyaW5nKTogUHJvbWlzZTx2b2lkPiB7XHJcbiAgdHJ5IHtcclxuICAgIGNvbnNvbGUubG9nKGBbcmVtb3ZlUmVjb3JkRWZmZWN0c09uRGVsZXRlXSBTdGFydGluZyBjbGVhbnVwIGZvciByZWNvcmQ6ICR7cmVjb3JkSWR9YCk7XHJcbiAgICBcclxuICAgIC8vIDEuIFJlbW92ZSBpdGVtcyBjcmVhdGVkIGJ5IHRoaXMgcmVjb3JkXHJcbiAgICBhd2FpdCByZW1vdmVJdGVtc0NyZWF0ZWRCeVJlY29yZChyZWNvcmRJZCk7XHJcbiAgICBcclxuICAgIC8vIDIuIFJlbW92ZSBwbGF5ZXIgcG9pbnRzIHRoYXQgd2VyZSBhd2FyZGVkIGJ5IHRoaXMgcmVjb3JkIChpZiBwb2ludHMgd2VyZSBiYWRseSBnaXZlbilcclxuICAgIGF3YWl0IHJlbW92ZVBsYXllclBvaW50c0Zyb21SZWNvcmQocmVjb3JkSWQpO1xyXG4gICAgXHJcbiAgICAvLyAzLiBSZW1vdmUganVuZ2xlIGNvaW5zIHRoYXQgd2VyZSBhd2FyZGVkIGJ5IHRoaXMgcmVjb3JkXHJcbiAgICBhd2FpdCByZW1vdmVKdW5nbGVDb2luc0Zyb21SZWNvcmQocmVjb3JkSWQpO1xyXG4gICAgXHJcbiAgICAvLyA0LiBSZW1vdmUgYWxsIExpbmtzIHJlbGF0ZWQgdG8gdGhpcyByZWNvcmRcclxuICAgIGNvbnN0IHJlY29yZExpbmtzID0gYXdhaXQgQ2xpZW50QVBJLmdldExpbmtzRm9yKHsgdHlwZTogJ2ZpbmFuY2lhbCcsIGlkOiByZWNvcmRJZCB9KTtcclxuICAgIGNvbnNvbGUubG9nKGBbcmVtb3ZlUmVjb3JkRWZmZWN0c09uRGVsZXRlXSBGb3VuZCAke3JlY29yZExpbmtzLmxlbmd0aH0gbGlua3MgdG8gcmVtb3ZlYCk7XHJcbiAgICBcclxuICAgIGZvciAoY29uc3QgbGluayBvZiByZWNvcmRMaW5rcykge1xyXG4gICAgICB0cnkge1xyXG4gICAgICAgIGF3YWl0IENsaWVudEFQSS5yZW1vdmVMaW5rKGxpbmsuaWQpO1xyXG4gICAgICAgIGNvbnNvbGUubG9nKGBbcmVtb3ZlUmVjb3JkRWZmZWN0c09uRGVsZXRlXSDinIUgUmVtb3ZlZCBsaW5rOiAke2xpbmsubGlua1R5cGV9YCk7XHJcbiAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XHJcbiAgICAgICAgY29uc29sZS5lcnJvcihgW3JlbW92ZVJlY29yZEVmZmVjdHNPbkRlbGV0ZV0g4p2MIEZhaWxlZCB0byByZW1vdmUgbGluayAke2xpbmsuaWR9OmAsIGVycm9yKTtcclxuICAgICAgfVxyXG4gICAgfVxyXG4gICAgXHJcbiAgICAvLyA1LiBDbGVhciBlZmZlY3RzIHJlZ2lzdHJ5XHJcbiAgICBhd2FpdCBjbGVhckVmZmVjdChgZmluYW5jaWFsOiR7cmVjb3JkSWR9OmNyZWF0ZWRgKTtcclxuICAgIGF3YWl0IGNsZWFyRWZmZWN0KGBmaW5hbmNpYWw6JHtyZWNvcmRJZH06aXRlbUNyZWF0ZWRgKTtcclxuICAgIGF3YWl0IGNsZWFyRWZmZWN0KGBmaW5hbmNpYWw6JHtyZWNvcmRJZH06cG9pbnRzQXdhcmRlZGApO1xyXG4gICAgYXdhaXQgY2xlYXJFZmZlY3QoYGZpbmFuY2lhbDoke3JlY29yZElkfTpqdW5nbGVDb2luc0F3YXJkZWRgKTtcclxuICAgIGF3YWl0IGNsZWFyRWZmZWN0c0J5UHJlZml4KCdmaW5hbmNpYWwnLCByZWNvcmRJZCwgJ3BvaW50c0xvZ2dlZDonKTtcclxuICAgIGF3YWl0IGNsZWFyRWZmZWN0c0J5UHJlZml4KCdmaW5hbmNpYWwnLCByZWNvcmRJZCwgJ2ZpbmFuY2lhbExvZ2dlZDonKTtcclxuICAgIFxyXG4gICAgLy8gNi4gUmVtb3ZlIGxvZyBlbnRyaWVzIGZyb20gYWxsIHJlbGV2YW50IGxvZ3NcclxuICAgIGNvbnNvbGUubG9nKGBbcmVtb3ZlUmVjb3JkRWZmZWN0c09uRGVsZXRlXSBTdGFydGluZyBsb2cgZW50cnkgcmVtb3ZhbCBmb3IgcmVjb3JkOiAke3JlY29yZElkfWApO1xyXG4gICAgXHJcbiAgICBjb25zdCByZW1vdmFscyA9IGF3YWl0IFByb21pc2UuYWxsKFtcclxuICAgICAgQ2xpZW50QVBJLnJlbW92ZUxvZ0VudHJ5KCdmaW5hbmNpYWxzJywgcmVjb3JkSWQpLnRoZW4ociA9PiB7IGNvbnNvbGUubG9nKGBbcmVtb3ZlUmVjb3JkRWZmZWN0c09uRGVsZXRlXSBGaW5hbmNpYWxzIGxvZyByZW1vdmFsIHJlc3VsdDpgLCByKTsgcmV0dXJuIHI7IH0pLmNhdGNoKGUgPT4gKHsgc3VjY2VzczogZmFsc2UsIG1lc3NhZ2U6IFN0cmluZyhlKSB9KSksXHJcbiAgICAgIENsaWVudEFQSS5yZW1vdmVMb2dFbnRyeSgnY2hhcmFjdGVyJywgcmVjb3JkSWQpLnRoZW4ociA9PiB7IGNvbnNvbGUubG9nKGBbcmVtb3ZlUmVjb3JkRWZmZWN0c09uRGVsZXRlXSBDaGFyYWN0ZXIgbG9nIHJlbW92YWwgcmVzdWx0OmAsIHIpOyByZXR1cm4gcjsgfSkuY2F0Y2goZSA9PiAoeyBzdWNjZXNzOiBmYWxzZSwgbWVzc2FnZTogU3RyaW5nKGUpIH0pKSxcclxuICAgICAgQ2xpZW50QVBJLnJlbW92ZUxvZ0VudHJ5KCdwbGF5ZXInLCByZWNvcmRJZCkudGhlbihyID0+IHsgY29uc29sZS5sb2coYFtyZW1vdmVSZWNvcmRFZmZlY3RzT25EZWxldGVdIFBsYXllciBsb2cgcmVtb3ZhbCByZXN1bHQ6YCwgcik7IHJldHVybiByOyB9KS5jYXRjaChlID0+ICh7IHN1Y2Nlc3M6IGZhbHNlLCBtZXNzYWdlOiBTdHJpbmcoZSkgfSkpLFxyXG4gICAgICBDbGllbnRBUEkucmVtb3ZlTG9nRW50cnkoJ2l0ZW1zJywgcmVjb3JkSWQpLnRoZW4ociA9PiB7IGNvbnNvbGUubG9nKGBbcmVtb3ZlUmVjb3JkRWZmZWN0c09uRGVsZXRlXSBJdGVtcyBsb2cgcmVtb3ZhbCByZXN1bHQ6YCwgcik7IHJldHVybiByOyB9KS5jYXRjaChlID0+ICh7IHN1Y2Nlc3M6IGZhbHNlLCBtZXNzYWdlOiBTdHJpbmcoZSkgfSkpLFxyXG4gICAgXSk7XHJcblxyXG4gICAgY29uc29sZS5sb2coYFtyZW1vdmVSZWNvcmRFZmZlY3RzT25EZWxldGVdIEFsbCByZW1vdmFsIHJlc3VsdHM6YCwgcmVtb3ZhbHMpO1xyXG4gICAgY29uc3QgZmFpbGVkID0gcmVtb3ZhbHMuZmlsdGVyKHIgPT4gIXIuc3VjY2Vzcyk7XHJcbiAgICBpZiAoZmFpbGVkLmxlbmd0aCA+IDApIHtcclxuICAgICAgY29uc29sZS5lcnJvcignW3JlbW92ZVJlY29yZEVmZmVjdHNPbkRlbGV0ZV0gU29tZSBsb2cgcmVtb3ZhbHMgZmFpbGVkOicsIGZhaWxlZCk7XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICBjb25zb2xlLmxvZyhgW3JlbW92ZVJlY29yZEVmZmVjdHNPbkRlbGV0ZV0g4pyFIEFsbCBsb2cgZW50cmllcyByZW1vdmVkIHN1Y2Nlc3NmdWxseSBmb3IgcmVjb3JkOiAke3JlY29yZElkfWApO1xyXG4gICAgfVxyXG4gICAgXHJcbiAgICBjb25zb2xlLmxvZyhgW3JlbW92ZVJlY29yZEVmZmVjdHNPbkRlbGV0ZV0g4pyFIENsZWFyZWQgZWZmZWN0cywgcmVtb3ZlZCBsaW5rcywgZGVsZXRlZCBjcmVhdGVkIGl0ZW1zLCBhbmQgcmVtb3ZlZCBsb2cgZW50cmllcyBmb3IgcmVjb3JkICR7cmVjb3JkSWR9YCk7XHJcbiAgfSBjYXRjaCAoZXJyb3IpIHtcclxuICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIHJlbW92aW5nIHJlY29yZCBlZmZlY3RzOicsIGVycm9yKTtcclxuICB9XHJcbn1cclxuXHJcbi8qKlxyXG4gKiBSZW1vdmUgcGxheWVyIHBvaW50cyB0aGF0IHdlcmUgYXdhcmRlZCBieSBhIHNwZWNpZmljIGZpbmFuY2lhbCByZWNvcmRcclxuICogVGhpcyBpcyB1c2VkIHdoZW4gcm9sbGluZyBiYWNrIGEgcmVjb3JkIHRoYXQgaW5jb3JyZWN0bHkgYXdhcmRlZCBwb2ludHNcclxuICovXHJcbmFzeW5jIGZ1bmN0aW9uIHJlbW92ZVBsYXllclBvaW50c0Zyb21SZWNvcmQocmVjb3JkSWQ6IHN0cmluZyk6IFByb21pc2U8dm9pZD4ge1xyXG4gIHRyeSB7XHJcbiAgICBjb25zb2xlLmxvZyhgW3JlbW92ZVBsYXllclBvaW50c0Zyb21SZWNvcmRdIFJlbW92aW5nIHBvaW50cyBmb3IgcmVjb3JkOiAke3JlY29yZElkfWApO1xyXG4gICAgXHJcbiAgICAvLyBHZXQgdGhlIHJlY29yZCB0byBmaW5kIHdoYXQgcG9pbnRzIHdlcmUgYXdhcmRlZFxyXG4gICAgY29uc3QgcmVjb3JkcyA9IGF3YWl0IENsaWVudEFQSS5nZXRGaW5hbmNpYWxSZWNvcmRzKCk7XHJcbiAgICBjb25zdCByZWNvcmQgPSByZWNvcmRzLmZpbmQociA9PiByLmlkID09PSByZWNvcmRJZCk7XHJcbiAgICBcclxuICAgIGlmICghcmVjb3JkIHx8ICFyZWNvcmQucmV3YXJkcz8ucG9pbnRzKSB7XHJcbiAgICAgIGNvbnNvbGUubG9nKGBbcmVtb3ZlUGxheWVyUG9pbnRzRnJvbVJlY29yZF0gUmVjb3JkICR7cmVjb3JkSWR9IGhhcyBubyBwb2ludHMgdG8gcmVtb3ZlYCk7XHJcbiAgICAgIHJldHVybjtcclxuICAgIH1cclxuICAgIFxyXG4gICAgLy8gR2V0IHRoZSBtYWluIHBsYXllclxyXG4gICAgY29uc3QgbWFpblBsYXllcklkID0gZ2V0TWFpblBsYXllcklkKCk7XHJcbiAgICBjb25zdCBwbGF5ZXJzID0gYXdhaXQgQ2xpZW50QVBJLmdldFBsYXllcnMoKTtcclxuICAgIGNvbnN0IG1haW5QbGF5ZXIgPSBwbGF5ZXJzLmZpbmQocCA9PiBwLmlkID09PSBtYWluUGxheWVySWQpO1xyXG4gICAgXHJcbiAgICBpZiAoIW1haW5QbGF5ZXIpIHtcclxuICAgICAgY29uc29sZS5sb2coYFtyZW1vdmVQbGF5ZXJQb2ludHNGcm9tUmVjb3JkXSBNYWluIHBsYXllciBub3QgZm91bmQsIHNraXBwaW5nIHBvaW50cyByZW1vdmFsYCk7XHJcbiAgICAgIHJldHVybjtcclxuICAgIH1cclxuICAgIFxyXG4gICAgLy8gQ2hlY2sgaWYgYW55IHBvaW50cyB3ZXJlIGFjdHVhbGx5IGF3YXJkZWRcclxuICAgIGNvbnN0IHBvaW50c1RvUmVtb3ZlID0gcmVjb3JkLnJld2FyZHMucG9pbnRzO1xyXG4gICAgY29uc3QgaGFzUG9pbnRzID0gKHBvaW50c1RvUmVtb3ZlLnhwIHx8IDApID4gMCB8fCAocG9pbnRzVG9SZW1vdmUucnAgfHwgMCkgPiAwIHx8IFxyXG4gICAgICAgICAgICAgICAgICAgICAocG9pbnRzVG9SZW1vdmUuZnAgfHwgMCkgPiAwIHx8IChwb2ludHNUb1JlbW92ZS5ocCB8fCAwKSA+IDA7XHJcbiAgICBcclxuICAgIGlmICghaGFzUG9pbnRzKSB7XHJcbiAgICAgIGNvbnNvbGUubG9nKGBbcmVtb3ZlUGxheWVyUG9pbnRzRnJvbVJlY29yZF0gTm8gcG9pbnRzIHRvIHJlbW92ZSBmcm9tIHJlY29yZCAke3JlY29yZElkfWApO1xyXG4gICAgICByZXR1cm47XHJcbiAgICB9XHJcbiAgICBcclxuICAgIC8vIFJlbW92ZSB0aGUgcG9pbnRzIGZyb20gdGhlIHBsYXllclxyXG4gICAgYXdhaXQgcmVtb3ZlUG9pbnRzRnJvbVBsYXllcihtYWluUGxheWVySWQsIHtcclxuICAgICAgeHA6IHBvaW50c1RvUmVtb3ZlLnhwIHx8IDAsXHJcbiAgICAgIHJwOiBwb2ludHNUb1JlbW92ZS5ycCB8fCAwLFxyXG4gICAgICBmcDogcG9pbnRzVG9SZW1vdmUuZnAgfHwgMCxcclxuICAgICAgaHA6IHBvaW50c1RvUmVtb3ZlLmhwIHx8IDBcclxuICAgIH0pO1xyXG4gICAgY29uc29sZS5sb2coYFtyZW1vdmVQbGF5ZXJQb2ludHNGcm9tUmVjb3JkXSDinIUgUmVtb3ZlZCBwb2ludHMgZnJvbSBwbGF5ZXI6ICR7SlNPTi5zdHJpbmdpZnkocG9pbnRzVG9SZW1vdmUpfWApO1xyXG4gICAgXHJcbiAgfSBjYXRjaCAoZXJyb3IpIHtcclxuICAgIGNvbnNvbGUuZXJyb3IoYFtyZW1vdmVQbGF5ZXJQb2ludHNGcm9tUmVjb3JkXSDinYwgRmFpbGVkIHRvIHJlbW92ZSBwbGF5ZXIgcG9pbnRzIGZvciByZWNvcmQgJHtyZWNvcmRJZH06YCwgZXJyb3IpO1xyXG4gIH1cclxufVxyXG5cclxuLyoqXHJcbiAqIFJlbW92ZSBqdW5nbGUgY29pbnMgdGhhdCB3ZXJlIGF3YXJkZWQgYnkgYSBzcGVjaWZpYyBmaW5hbmNpYWwgcmVjb3JkXHJcbiAqIFRoaXMgaXMgdXNlZCB3aGVuIHJvbGxpbmcgYmFjayBhIHJlY29yZCB0aGF0IGluY29ycmVjdGx5IGF3YXJkZWQganVuZ2xlIGNvaW5zXHJcbiAqL1xyXG5hc3luYyBmdW5jdGlvbiByZW1vdmVKdW5nbGVDb2luc0Zyb21SZWNvcmQocmVjb3JkSWQ6IHN0cmluZyk6IFByb21pc2U8dm9pZD4ge1xyXG4gIHRyeSB7XHJcbiAgICBjb25zb2xlLmxvZyhgW3JlbW92ZUp1bmdsZUNvaW5zRnJvbVJlY29yZF0gUmVtb3ZpbmcganVuZ2xlIGNvaW5zIGZvciByZWNvcmQ6ICR7cmVjb3JkSWR9YCk7XHJcbiAgICBcclxuICAgIC8vIEdldCB0aGUgcmVjb3JkIHRvIGZpbmQgd2hhdCBqdW5nbGUgY29pbnMgd2VyZSBhd2FyZGVkXHJcbiAgICBjb25zdCByZWNvcmRzID0gYXdhaXQgQ2xpZW50QVBJLmdldEZpbmFuY2lhbFJlY29yZHMoKTtcclxuICAgIGNvbnN0IHJlY29yZCA9IHJlY29yZHMuZmluZChyID0+IHIuaWQgPT09IHJlY29yZElkKTtcclxuICAgIFxyXG4gICAgaWYgKCFyZWNvcmQgfHwgIXJlY29yZC5qdW5nbGVDb2lucyB8fCByZWNvcmQuanVuZ2xlQ29pbnMgPD0gMCkge1xyXG4gICAgICBjb25zb2xlLmxvZyhgW3JlbW92ZUp1bmdsZUNvaW5zRnJvbVJlY29yZF0gUmVjb3JkICR7cmVjb3JkSWR9IGhhcyBubyBqdW5nbGUgY29pbnMgdG8gcmVtb3ZlYCk7XHJcbiAgICAgIHJldHVybjtcclxuICAgIH1cclxuICAgIFxyXG4gICAgLy8gR2V0IHRoZSBtYWluIGNoYXJhY3RlclxyXG4gICAgY29uc3QgbWFpbkNoYXJhY3RlcklkID0gZ2V0TWFpbkNoYXJhY3RlcklkKCk7XHJcbiAgICBjb25zdCBjaGFyYWN0ZXJzID0gYXdhaXQgQ2xpZW50QVBJLmdldENoYXJhY3RlcnMoKTtcclxuICAgIGNvbnN0IG1haW5DaGFyYWN0ZXIgPSBjaGFyYWN0ZXJzLmZpbmQoYyA9PiBjLmlkID09PSBtYWluQ2hhcmFjdGVySWQpO1xyXG4gICAgXHJcbiAgICBpZiAoIW1haW5DaGFyYWN0ZXIpIHtcclxuICAgICAgY29uc29sZS5sb2coYFtyZW1vdmVKdW5nbGVDb2luc0Zyb21SZWNvcmRdIE1haW4gY2hhcmFjdGVyIG5vdCBmb3VuZCwgc2tpcHBpbmcganVuZ2xlIGNvaW5zIHJlbW92YWxgKTtcclxuICAgICAgcmV0dXJuO1xyXG4gICAgfVxyXG4gICAgXHJcbiAgICAvLyBSZW1vdmUgdGhlIGp1bmdsZSBjb2lucyBmcm9tIHRoZSBjaGFyYWN0ZXJcclxuICAgIGF3YWl0IHJlbW92ZUp1bmdsZUNvaW5zRnJvbUNoYXJhY3RlcihtYWluQ2hhcmFjdGVySWQsIHJlY29yZC5qdW5nbGVDb2lucyk7XHJcbiAgICBjb25zb2xlLmxvZyhgW3JlbW92ZUp1bmdsZUNvaW5zRnJvbVJlY29yZF0g4pyFIFJlbW92ZWQgJHtyZWNvcmQuanVuZ2xlQ29pbnN9IGp1bmdsZSBjb2lucyBmcm9tIGNoYXJhY3RlcmApO1xyXG4gICAgXHJcbiAgfSBjYXRjaCAoZXJyb3IpIHtcclxuICAgIGNvbnNvbGUuZXJyb3IoYFtyZW1vdmVKdW5nbGVDb2luc0Zyb21SZWNvcmRdIOKdjCBGYWlsZWQgdG8gcmVtb3ZlIGp1bmdsZSBjb2lucyBmb3IgcmVjb3JkICR7cmVjb3JkSWR9OmAsIGVycm9yKTtcclxuICB9XHJcbn0iXSwibmFtZXMiOlsiYXBwZW5kRW50aXR5TG9nIiwidXBkYXRlRW50aXR5TG9nRmllbGQiLCJoYXNFZmZlY3QiLCJtYXJrRWZmZWN0IiwiY2xlYXJFZmZlY3QiLCJjbGVhckVmZmVjdHNCeVByZWZpeCIsIkNsaWVudEFQSSIsImNyZWF0ZUl0ZW1Gcm9tUmVjb3JkIiwicmVtb3ZlSXRlbXNDcmVhdGVkQnlSZWNvcmQiLCJhd2FyZFBvaW50c1RvUGxheWVyIiwicmVtb3ZlUG9pbnRzRnJvbVBsYXllciIsImF3YXJkSnVuZ2xlQ29pbnNUb0NoYXJhY3RlciIsInJlbW92ZUp1bmdsZUNvaW5zRnJvbUNoYXJhY3RlciIsImdldE1haW5QbGF5ZXJJZCIsImdldE1haW5DaGFyYWN0ZXJJZCIsInVwZGF0ZVRhc2tzRnJvbUZpbmFuY2lhbFJlY29yZCIsInVwZGF0ZUl0ZW1zQ3JlYXRlZEJ5UmVjb3JkIiwidXBkYXRlUGxheWVyUG9pbnRzRnJvbVNvdXJjZSIsInVwZGF0ZUNoYXJhY3Rlckp1bmdsZUNvaW5zRnJvbVJlY29yZCIsImhhc0ZpbmFuY2lhbFByb3BzQ2hhbmdlZCIsImhhc091dHB1dFByb3BzQ2hhbmdlZCIsImhhc1Jld2FyZHNDaGFuZ2VkIiwiaGFzSnVuZ2xlQ29pbnNDaGFuZ2VkIiwiU1RBVEVfRklFTERTIiwiREVTQ1JJUFRJVkVfRklFTERTIiwib25GaW5hbmNpYWxVcHNlcnQiLCJmaW5hbmNpYWwiLCJwcmV2aW91c0ZpbmFuY2lhbCIsImVmZmVjdEtleSIsImlkIiwibmFtZSIsInR5cGUiLCJzdGF0aW9uIiwib3V0cHV0SXRlbVR5cGUiLCJvdXRwdXRRdWFudGl0eSIsIml0ZW1FZmZlY3RLZXkiLCJjb25zb2xlIiwibG9nIiwiY3JlYXRlZEl0ZW0iLCJyZXdhcmRzIiwicG9pbnRzIiwicG9pbnRzRWZmZWN0S2V5IiwieHAiLCJycCIsImZwIiwiaHAiLCJqdW5nbGVDb2lucyIsImp1bmdsZUNvaW5zRWZmZWN0S2V5IiwiaXNOb3RDaGFyZ2VkIiwicmV2ZW51ZSIsImNoYXJnZWRBdCIsIkRhdGUiLCJ0b0lTT1N0cmluZyIsImlzQ29sbGVjdGVkIiwiY29sbGVjdGVkQXQiLCJmaWVsZCIsInJlbW92ZVJlY29yZEVmZmVjdHNPbkRlbGV0ZSIsInJlY29yZElkIiwicmVtb3ZlUGxheWVyUG9pbnRzRnJvbVJlY29yZCIsInJlbW92ZUp1bmdsZUNvaW5zRnJvbVJlY29yZCIsInJlY29yZExpbmtzIiwiZ2V0TGlua3NGb3IiLCJsZW5ndGgiLCJsaW5rIiwicmVtb3ZlTGluayIsImxpbmtUeXBlIiwiZXJyb3IiLCJyZW1vdmFscyIsIlByb21pc2UiLCJhbGwiLCJyZW1vdmVMb2dFbnRyeSIsInRoZW4iLCJyIiwiY2F0Y2giLCJlIiwic3VjY2VzcyIsIm1lc3NhZ2UiLCJTdHJpbmciLCJmYWlsZWQiLCJmaWx0ZXIiLCJyZWNvcmRzIiwiZ2V0RmluYW5jaWFsUmVjb3JkcyIsInJlY29yZCIsImZpbmQiLCJtYWluUGxheWVySWQiLCJwbGF5ZXJzIiwiZ2V0UGxheWVycyIsIm1haW5QbGF5ZXIiLCJwIiwicG9pbnRzVG9SZW1vdmUiLCJoYXNQb2ludHMiLCJKU09OIiwic3RyaW5naWZ5IiwibWFpbkNoYXJhY3RlcklkIiwiY2hhcmFjdGVycyIsImdldENoYXJhY3RlcnMiLCJtYWluQ2hhcmFjdGVyIiwiYyJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./workflows/entities-workflows/financial.workflow.ts\n");

/***/ }),

/***/ "(rsc)/./workflows/entities-workflows/item.workflow.ts":
/*!*******************************************************!*\
  !*** ./workflows/entities-workflows/item.workflow.ts ***!
  \*******************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   logItemCreationForItem: () => (/* binding */ logItemCreationForItem),\n/* harmony export */   onItemUpsert: () => (/* binding */ onItemUpsert),\n/* harmony export */   processItemCreationEffects: () => (/* binding */ processItemCreationEffects),\n/* harmony export */   removeItemEffectsOnDelete: () => (/* binding */ removeItemEffectsOnDelete),\n/* harmony export */   updateAllItemLogEntries: () => (/* binding */ updateAllItemLogEntries),\n/* harmony export */   updateItemLogEntryForItem: () => (/* binding */ updateItemLogEntryForItem)\n/* harmony export */ });\n/* harmony import */ var _entities_logging__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../entities-logging */ \"(rsc)/./workflows/entities-logging.ts\");\n/* harmony import */ var _data_store_effects_registry__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @/data-store/effects-registry */ \"(rsc)/./data-store/effects-registry.ts\");\n/* harmony import */ var _lib_client_api__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @/lib/client-api */ \"(rsc)/./lib/client-api.ts\");\n// workflows/entities-workflows/item.workflow.ts\n// Item-specific workflow with MOVED, SOLD, COLLECTED events\n\n\n\nconst STATE_FIELDS = [\n    \"status\",\n    \"stock\",\n    \"quantitySold\",\n    \"isCollected\"\n];\nconst DESCRIPTIVE_FIELDS = [\n    \"name\",\n    \"description\",\n    \"price\",\n    \"unitCost\",\n    \"additionalCost\",\n    \"value\"\n];\nasync function onItemUpsert(item, previousItem) {\n    // New item creation\n    if (!previousItem) {\n        const effectKey = `item:${item.id}:created`;\n        if (await (0,_data_store_effects_registry__WEBPACK_IMPORTED_MODULE_1__.hasEffect)(effectKey)) return;\n        await (0,_entities_logging__WEBPACK_IMPORTED_MODULE_0__.appendEntityLog)(\"item\", item.id, \"CREATED\", {\n            name: item.name,\n            type: item.type,\n            station: item.station\n        });\n        // Log item creation with source tracking\n        const sourceType = item.sourceTaskId ? \"task\" : item.sourceRecordId ? \"record\" : \"direct\";\n        const sourceId = item.sourceTaskId || item.sourceRecordId || undefined;\n        await (0,_entities_logging__WEBPACK_IMPORTED_MODULE_0__.appendItemCreationLog)(item, sourceType, sourceId);\n        await (0,_data_store_effects_registry__WEBPACK_IMPORTED_MODULE_1__.markEffect)(effectKey);\n        return;\n    }\n    // Stock changes - MOVED event\n    const stockChanged = JSON.stringify(previousItem.stock) !== JSON.stringify(item.stock);\n    if (stockChanged) {\n        await (0,_entities_logging__WEBPACK_IMPORTED_MODULE_0__.appendEntityLog)(\"item\", item.id, \"MOVED\", {\n            name: item.name,\n            oldStock: previousItem.stock,\n            newStock: item.stock\n        });\n    }\n    // Quantity sold changes - SOLD event\n    if (previousItem.quantitySold !== item.quantitySold && item.quantitySold > previousItem.quantitySold) {\n        await (0,_entities_logging__WEBPACK_IMPORTED_MODULE_0__.appendEntityLog)(\"item\", item.id, \"SOLD\", {\n            name: item.name,\n            quantitySold: item.quantitySold,\n            oldQuantitySold: previousItem.quantitySold\n        });\n    }\n    // Collection status - COLLECTED event\n    if (!previousItem.isCollected && item.isCollected) {\n        await (0,_entities_logging__WEBPACK_IMPORTED_MODULE_0__.appendEntityLog)(\"item\", item.id, \"COLLECTED\", {\n            name: item.name,\n            collectedAt: new Date().toISOString()\n        });\n    }\n    // Descriptive changes - update in-place\n    for (const field of DESCRIPTIVE_FIELDS){\n        if (previousItem[field] !== item[field]) {\n            await (0,_entities_logging__WEBPACK_IMPORTED_MODULE_0__.updateEntityLogField)(\"item\", item.id, field, previousItem[field], item[field]);\n        }\n    }\n}\n/**\r\n * Remove item effects when item is deleted\r\n * Items can have entries in items log and related links\r\n */ async function removeItemEffectsOnDelete(itemId) {\n    try {\n        console.log(`[removeItemEffectsOnDelete] Starting cleanup for item: ${itemId}`);\n        // 1. Remove all Links related to this item\n        const itemLinks = await _lib_client_api__WEBPACK_IMPORTED_MODULE_2__.ClientAPI.getLinksFor({\n            type: \"item\",\n            id: itemId\n        });\n        console.log(`[removeItemEffectsOnDelete] Found ${itemLinks.length} links to remove`);\n        for (const link of itemLinks){\n            try {\n                await _lib_client_api__WEBPACK_IMPORTED_MODULE_2__.ClientAPI.removeLink(link.id);\n                console.log(`[removeItemEffectsOnDelete] ✅ Removed link: ${link.linkType}`);\n            } catch (error) {\n                console.error(`[removeItemEffectsOnDelete] ❌ Failed to remove link ${link.id}:`, error);\n            }\n        }\n        // 2. Clear all effects for this item\n        await (0,_data_store_effects_registry__WEBPACK_IMPORTED_MODULE_1__.clearEffect)(`item:${itemId}:created`);\n        await (0,_data_store_effects_registry__WEBPACK_IMPORTED_MODULE_1__.clearEffectsByPrefix)(\"item\", itemId, \"financialLogged:\");\n        await (0,_data_store_effects_registry__WEBPACK_IMPORTED_MODULE_1__.clearEffectsByPrefix)(\"item\", itemId, \"pointsLogged:\");\n        // 3. Remove log entries from items log only (Items don't have financial/player effects)\n        console.log(`[removeItemEffectsOnDelete] Starting log entry removal for item: ${itemId}`);\n        const result = await _lib_client_api__WEBPACK_IMPORTED_MODULE_2__.ClientAPI.removeLogEntry(\"items\", itemId);\n        if (result.success) {\n            console.log(`[removeItemEffectsOnDelete] ✅ Item log entries removed successfully for item: ${itemId}`);\n        } else {\n            console.error(`[removeItemEffectsOnDelete] Failed to remove item log entries: ${result.message}`);\n        }\n        console.log(`[removeItemEffectsOnDelete] ✅ Cleared effects, removed links, and removed log entries for item ${itemId}`);\n    } catch (error) {\n        console.error(\"Error removing item effects:\", error);\n    }\n}\n/**\r\n * Process item creation effects when item is created\r\n * Handles side effects when item is created directly (not from task/record)\r\n */ async function processItemCreationEffects(item) {\n    console.log(`[processItemCreationEffects] Processing item creation effects for: ${item.name} (${item.id})`);\n    // Log item creation once (with idempotency)\n    const itemCreated = await (0,_data_store_effects_registry__WEBPACK_IMPORTED_MODULE_1__.hasEffect)(`item:${item.id}:itemCreated`);\n    if (!itemCreated) {\n        await logItemCreationForItem(item);\n        await (0,_data_store_effects_registry__WEBPACK_IMPORTED_MODULE_1__.markEffect)(`item:${item.id}:itemCreated`);\n    }\n// Items created from Item Modal have NO financial effects\n// Items are just inventory/assets - financial effects come from Tasks/Records\n// This is different from Tasks/Records which have cost/revenue properties\n}\n/**\r\n * Log item creation when item is created directly (not from task/record)\r\n */ async function logItemCreationForItem(item) {\n    try {\n        console.log(`[logItemCreationForItem] Logging direct item creation: ${item.name} (${item.id})`);\n        await (0,_entities_logging__WEBPACK_IMPORTED_MODULE_0__.appendItemCreationLog)(item, \"direct\");\n        console.log(`[logItemCreationForItem] ✅ Direct item creation logged successfully for ${item.name}`);\n    } catch (error) {\n        console.error(\"Error logging direct item creation:\", error);\n    }\n}\n/**\r\n * Update item log entry when item properties change\r\n * This function updates existing item log entries with new item data\r\n */ async function updateItemLogEntryForItem(item, dispatchEvents = true) {\n    try {\n        const updates = {\n            itemName: item.name,\n            itemType: item.type,\n            collection: item.collection,\n            status: item.status,\n            quantity: item.stock?.reduce((sum, stock)=>sum + stock.quantity, 0) || 0,\n            unitCost: item.unitCost || 0,\n            price: item.price || 0,\n            station: item.station,\n            year: item.year,\n            description: `Item created directly: ${item.type} (${item.stock?.reduce((sum, stock)=>sum + stock.quantity, 0) || 0}x)`\n        };\n        // Update the most recent log entry for this item\n        await (0,_entities_logging__WEBPACK_IMPORTED_MODULE_0__.updateEntityLogField)(\"item\", item.id, \"itemName\", \"\", item.name);\n        await (0,_entities_logging__WEBPACK_IMPORTED_MODULE_0__.updateEntityLogField)(\"item\", item.id, \"itemType\", \"\", item.type);\n        await (0,_entities_logging__WEBPACK_IMPORTED_MODULE_0__.updateEntityLogField)(\"item\", item.id, \"status\", \"\", item.status);\n        await (0,_entities_logging__WEBPACK_IMPORTED_MODULE_0__.updateEntityLogField)(\"item\", item.id, \"quantity\", \"\", item.stock?.reduce((sum, stock)=>sum + stock.quantity, 0) || 0);\n        await (0,_entities_logging__WEBPACK_IMPORTED_MODULE_0__.updateEntityLogField)(\"item\", item.id, \"unitCost\", \"\", item.unitCost || 0);\n        await (0,_entities_logging__WEBPACK_IMPORTED_MODULE_0__.updateEntityLogField)(\"item\", item.id, \"price\", \"\", item.price || 0);\n        console.log(`[updateItemLogEntryForItem] ✅ Item log entry updated successfully for ${item.name}`);\n        // Dispatch event to notify frontend of items update\n        if (dispatchEvents && \"undefined\" !== \"undefined\") {}\n    } catch (error) {\n        console.error(\"Error updating item log entry:\", error);\n    }\n}\n/**\r\n * Update all log entries when item properties change\r\n * This function updates existing log entries across all log types with new item data\r\n */ async function updateAllItemLogEntries(item, dispatchEvents = true) {\n    try {\n        console.log(`[updateAllItemLogEntries] Updating all log entries for item: ${item.name} (${item.id})`);\n        // Update item log entries\n        await updateItemLogEntryForItem(item, false);\n        // Dispatch event to notify frontend of items update\n        if (dispatchEvents && \"undefined\" !== \"undefined\") {}\n        console.log(`[updateAllItemLogEntries] ✅ All log entries updated successfully for ${item.name}`);\n    } catch (error) {\n        console.error(\"Error updating all item log entries:\", error);\n    }\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi93b3JrZmxvd3MvZW50aXRpZXMtd29ya2Zsb3dzL2l0ZW0ud29ya2Zsb3cudHMiLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7O0FBQUEsZ0RBQWdEO0FBQ2hELDREQUE0RDtBQUd1QztBQUNNO0FBQzVEO0FBRTdDLE1BQU1RLGVBQWU7SUFBQztJQUFVO0lBQVM7SUFBZ0I7Q0FBYztBQUN2RSxNQUFNQyxxQkFBcUI7SUFBQztJQUFRO0lBQWU7SUFBUztJQUFZO0lBQWtCO0NBQVE7QUFFM0YsZUFBZUMsYUFBYUMsSUFBVSxFQUFFQyxZQUFtQjtJQUNoRSxvQkFBb0I7SUFDcEIsSUFBSSxDQUFDQSxjQUFjO1FBQ2pCLE1BQU1DLFlBQVksQ0FBQyxLQUFLLEVBQUVGLEtBQUtHLEVBQUUsQ0FBQyxRQUFRLENBQUM7UUFDM0MsSUFBSSxNQUFNWCx1RUFBU0EsQ0FBQ1UsWUFBWTtRQUVoQyxNQUFNYixrRUFBZUEsQ0FBQyxRQUFRVyxLQUFLRyxFQUFFLEVBQUUsV0FBVztZQUNoREMsTUFBTUosS0FBS0ksSUFBSTtZQUNmQyxNQUFNTCxLQUFLSyxJQUFJO1lBQ2ZDLFNBQVNOLEtBQUtNLE9BQU87UUFDdkI7UUFFQSx5Q0FBeUM7UUFDekMsTUFBTUMsYUFBYVAsS0FBS1EsWUFBWSxHQUFHLFNBQVNSLEtBQUtTLGNBQWMsR0FBRyxXQUFXO1FBQ2pGLE1BQU1DLFdBQVdWLEtBQUtRLFlBQVksSUFBSVIsS0FBS1MsY0FBYyxJQUFJRTtRQUM3RCxNQUFNcEIsd0VBQXFCQSxDQUFDUyxNQUFNTyxZQUFZRztRQUU5QyxNQUFNakIsd0VBQVVBLENBQUNTO1FBQ2pCO0lBQ0Y7SUFFQSw4QkFBOEI7SUFDOUIsTUFBTVUsZUFBZUMsS0FBS0MsU0FBUyxDQUFDYixhQUFhYyxLQUFLLE1BQU1GLEtBQUtDLFNBQVMsQ0FBQ2QsS0FBS2UsS0FBSztJQUNyRixJQUFJSCxjQUFjO1FBQ2hCLE1BQU12QixrRUFBZUEsQ0FBQyxRQUFRVyxLQUFLRyxFQUFFLEVBQUUsU0FBUztZQUM5Q0Ms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LEVBQUUsT0FBT1QsT0FBTztRQUNkUixRQUFRUSxLQUFLLENBQUMsa0NBQWtDQTtJQUNsRDtBQUNGO0FBRUE7OztDQUdDLEdBQ00sZUFBZXlCLHdCQUF3QjVELElBQVUsRUFBRTRDLGlCQUEwQixJQUFJO0lBQ3RGLElBQUk7UUFDRmpCLFFBQVFDLEdBQUcsQ0FBQyxDQUFDLDZEQUE2RCxFQUFFNUIsS0FBS0ksSUFBSSxDQUFDLEVBQUUsRUFBRUosS0FBS0csRUFBRSxDQUFDLENBQUMsQ0FBQztRQUVwRywwQkFBMEI7UUFDMUIsTUFBTXdDLDBCQUEwQjNDLE1BQU07UUFFdEMsb0RBQW9EO1FBQ3BELElBQUk0QyxrQkFBa0IsZ0JBQWtCLGFBQWEsRUFFcEQ7UUFFRGpCLFFBQVFDLEdBQUcsQ0FBQyxDQUFDLHFFQUFxRSxFQUFFNUIsS0FBS0ksSUFBSSxDQUFDLENBQUM7SUFDakcsRUFBRSxPQUFPK0IsT0FBTztRQUNkUixRQUFRUSxLQUFLLENBQUMsd0NBQXdDQTtJQUN4RDtBQUNGIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vdGhlZ2FtZS1hZG1pbi8uL3dvcmtmbG93cy9lbnRpdGllcy13b3JrZmxvd3MvaXRlbS53b3JrZmxvdy50cz81NTNjIl0sInNvdXJjZXNDb250ZW50IjpbIi8vIHdvcmtmbG93cy9lbnRpdGllcy13b3JrZmxvd3MvaXRlbS53b3JrZmxvdy50c1xyXG4vLyBJdGVtLXNwZWNpZmljIHdvcmtmbG93IHdpdGggTU9WRUQsIFNPTEQsIENPTExFQ1RFRCBldmVudHNcclxuXHJcbmltcG9ydCB0eXBlIHsgSXRlbSB9IGZyb20gJ0AvdHlwZXMvZW50aXRpZXMnO1xyXG5pbXBvcnQgeyBhcHBlbmRFbnRpdHlMb2csIHVwZGF0ZUVudGl0eUxvZ0ZpZWxkLCBhcHBlbmRJdGVtQ3JlYXRpb25Mb2cgfSBmcm9tICcuLi9lbnRpdGllcy1sb2dnaW5nJztcclxuaW1wb3J0IHsgaGFzRWZmZWN0LCBtYXJrRWZmZWN0LCBjbGVhckVmZmVjdCwgY2xlYXJFZmZlY3RzQnlQcmVmaXggfSBmcm9tICdAL2RhdGEtc3RvcmUvZWZmZWN0cy1yZWdpc3RyeSc7XHJcbmltcG9ydCB7IENsaWVudEFQSSB9IGZyb20gJ0AvbGliL2NsaWVudC1hcGknO1xyXG5cclxuY29uc3QgU1RBVEVfRklFTERTID0gWydzdGF0dXMnLCAnc3RvY2snLCAncXVhbnRpdHlTb2xkJywgJ2lzQ29sbGVjdGVkJ107XHJcbmNvbnN0IERFU0NSSVBUSVZFX0ZJRUxEUyA9IFsnbmFtZScsICdkZXNjcmlwdGlvbicsICdwcmljZScsICd1bml0Q29zdCcsICdhZGRpdGlvbmFsQ29zdCcsICd2YWx1ZSddO1xyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIG9uSXRlbVVwc2VydChpdGVtOiBJdGVtLCBwcmV2aW91c0l0ZW0/OiBJdGVtKTogUHJvbWlzZTx2b2lkPiB7XHJcbiAgLy8gTmV3IGl0ZW0gY3JlYXRpb25cclxuICBpZiAoIXByZXZpb3VzSXRlbSkge1xyXG4gICAgY29uc3QgZWZmZWN0S2V5ID0gYGl0ZW06JHtpdGVtLmlkfTpjcmVhdGVkYDtcclxuICAgIGlmIChhd2FpdCBoYXNFZmZlY3QoZWZmZWN0S2V5KSkgcmV0dXJuO1xyXG4gICAgXHJcbiAgICBhd2FpdCBhcHBlbmRFbnRpdHlMb2coJ2l0ZW0nLCBpdGVtLmlkLCAnQ1JFQVRFRCcsIHsgXHJcbiAgICAgIG5hbWU6IGl0ZW0ubmFtZSwgXHJcbiAgICAgIHR5cGU6IGl0ZW0udHlwZSxcclxuICAgICAgc3RhdGlvbjogaXRlbS5zdGF0aW9uIFxyXG4gICAgfSk7XHJcbiAgICBcclxuICAgIC8vIExvZyBpdGVtIGNyZWF0aW9uIHdpdGggc291cmNlIHRyYWNraW5nXHJcbiAgICBjb25zdCBzb3VyY2VUeXBlID0gaXRlbS5zb3VyY2VUYXNrSWQgPyAndGFzaycgOiBpdGVtLnNvdXJjZVJlY29yZElkID8gJ3JlY29yZCcgOiAnZGlyZWN0JztcclxuICAgIGNvbnN0IHNvdXJjZUlkID0gaXRlbS5zb3VyY2VUYXNrSWQgfHwgaXRlbS5zb3VyY2VSZWNvcmRJZCB8fCB1bmRlZmluZWQ7XHJcbiAgICBhd2FpdCBhcHBlbmRJdGVtQ3JlYXRpb25Mb2coaXRlbSwgc291cmNlVHlwZSwgc291cmNlSWQpO1xyXG4gICAgXHJcbiAgICBhd2FpdCBtYXJrRWZmZWN0KGVmZmVjdEtleSk7XHJcbiAgICByZXR1cm47XHJcbiAgfVxyXG4gIFxyXG4gIC8vIFN0b2NrIGNoYW5nZXMgLSBNT1ZFRCBldmVudFxyXG4gIGNvbnN0IHN0b2NrQ2hhbmdlZCA9IEpTT04uc3RyaW5naWZ5KHByZXZpb3VzSXRlbS5zdG9jaykgIT09IEpTT04uc3RyaW5naWZ5KGl0ZW0uc3RvY2spO1xyXG4gIGlmIChzdG9ja0NoYW5nZWQpIHtcclxuICAgIGF3YWl0IGFwcGVuZEVudGl0eUxvZygnaXRlbScsIGl0ZW0uaWQsICdNT1ZFRCcsIHtcclxuICAgICAgbmFtZTogaXRlbS5uYW1lLFxyXG4gICAgICBvbGRTdG9jazogcHJldmlvdXNJdGVtLnN0b2NrLFxyXG4gICAgICBuZXdTdG9jazogaXRlbS5zdG9ja1xyXG4gICAgfSk7XHJcbiAgfVxyXG4gIFxyXG4gIC8vIFF1YW50aXR5IHNvbGQgY2hhbmdlcyAtIFNPTEQgZXZlbnRcclxuICBpZiAocHJldmlvdXNJdGVtLnF1YW50aXR5U29sZCAhPT0gaXRlbS5xdWFudGl0eVNvbGQgJiYgaXRlbS5xdWFudGl0eVNvbGQgPiBwcmV2aW91c0l0ZW0ucXVhbnRpdHlTb2xkKSB7XHJcbiAgICBhd2FpdCBhcHBlbmRFbnRpdHlMb2coJ2l0ZW0nLCBpdGVtLmlkLCAnU09MRCcsIHtcclxuICAgICAgbmFtZTogaXRlbS5uYW1lLFxyXG4gICAgICBxdWFudGl0eVNvbGQ6IGl0ZW0ucXVhbnRpdHlTb2xkLFxyXG4gICAgICBvbGRRdWFudGl0eVNvbGQ6IHByZXZpb3VzSXRlbS5xdWFudGl0eVNvbGRcclxuICAgIH0pO1xyXG4gIH1cclxuICBcclxuICAvLyBDb2xsZWN0aW9uIHN0YXR1cyAtIENPTExFQ1RFRCBldmVudFxyXG4gIGlmICghcHJldmlvdXNJdGVtLmlzQ29sbGVjdGVkICYmIGl0ZW0uaXNDb2xsZWN0ZWQpIHtcclxuICAgIGF3YWl0IGFwcGVuZEVudGl0eUxvZygnaXRlbScsIGl0ZW0uaWQsICdDT0xMRUNURUQnLCB7XHJcbiAgICAgIG5hbWU6IGl0ZW0ubmFtZSxcclxuICAgICAgY29sbGVjdGVkQXQ6IG5ldyBEYXRlKCkudG9JU09TdHJpbmcoKVxyXG4gICAgfSk7XHJcbiAgfVxyXG4gIFxyXG4gIC8vIERlc2NyaXB0aXZlIGNoYW5nZXMgLSB1cGRhdGUgaW4tcGxhY2VcclxuICBmb3IgKGNvbnN0IGZpZWxkIG9mIERFU0NSSVBUSVZFX0ZJRUxEUykge1xyXG4gICAgaWYgKChwcmV2aW91c0l0ZW0gYXMgYW55KVtmaWVsZF0gIT09IChpdGVtIGFzIGFueSlbZmllbGRdKSB7XHJcbiAgICAgIGF3YWl0IHVwZGF0ZUVudGl0eUxvZ0ZpZWxkKCdpdGVtJywgaXRlbS5pZCwgZmllbGQsIChwcmV2aW91c0l0ZW0gYXMgYW55KVtmaWVsZF0sIChpdGVtIGFzIGFueSlbZmllbGRdKTtcclxuICAgIH1cclxuICB9XHJcbn1cclxuXHJcbi8qKlxyXG4gKiBSZW1vdmUgaXRlbSBlZmZlY3RzIHdoZW4gaXRlbSBpcyBkZWxldGVkXHJcbiAqIEl0ZW1zIGNhbiBoYXZlIGVudHJpZXMgaW4gaXRlbXMgbG9nIGFuZCByZWxhdGVkIGxpbmtzXHJcbiAqL1xyXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gcmVtb3ZlSXRlbUVmZmVjdHNPbkRlbGV0ZShpdGVtSWQ6IHN0cmluZyk6IFByb21pc2U8dm9pZD4ge1xyXG4gIHRyeSB7XHJcbiAgICBjb25zb2xlLmxvZyhgW3JlbW92ZUl0ZW1FZmZlY3RzT25EZWxldGVdIFN0YXJ0aW5nIGNsZWFudXAgZm9yIGl0ZW06ICR7aXRlbUlkfWApO1xyXG4gICAgXHJcbiAgICAvLyAxLiBSZW1vdmUgYWxsIExpbmtzIHJlbGF0ZWQgdG8gdGhpcyBpdGVtXHJcbiAgICBjb25zdCBpdGVtTGlua3MgPSBhd2FpdCBDbGllbnRBUEkuZ2V0TGlua3NGb3IoeyB0eXBlOiAnaXRlbScsIGlkOiBpdGVtSWQgfSk7XHJcbiAgICBjb25zb2xlLmxvZyhgW3JlbW92ZUl0ZW1FZmZlY3RzT25EZWxldGVdIEZvdW5kICR7aXRlbUxpbmtzLmxlbmd0aH0gbGlua3MgdG8gcmVtb3ZlYCk7XHJcbiAgICBcclxuICAgIGZvciAoY29uc3QgbGluayBvZiBpdGVtTGlua3MpIHtcclxuICAgICAgdHJ5IHtcclxuICAgICAgICBhd2FpdCBDbGllbnRBUEkucmVtb3ZlTGluayhsaW5rLmlkKTtcclxuICAgICAgICBjb25zb2xlLmxvZyhgW3JlbW92ZUl0ZW1FZmZlY3RzT25EZWxldGVdIOKchSBSZW1vdmVkIGxpbms6ICR7bGluay5saW5rVHlwZX1gKTtcclxuICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcclxuICAgICAgICBjb25zb2xlLmVycm9yKGBbcmVtb3ZlSXRlbUVmZmVjdHNPbkRlbGV0ZV0g4p2MIEZhaWxlZCB0byByZW1vdmUgbGluayAke2xpbmsuaWR9OmAsIGVycm9yKTtcclxuICAgICAgfVxyXG4gICAgfVxyXG4gICAgXHJcbiAgICAvLyAyLiBDbGVhciBhbGwgZWZmZWN0cyBmb3IgdGhpcyBpdGVtXHJcbiAgICBhd2FpdCBjbGVhckVmZmVjdChgaXRlbToke2l0ZW1JZH06Y3JlYXRlZGApO1xyXG4gICAgYXdhaXQgY2xlYXJFZmZlY3RzQnlQcmVmaXgoJ2l0ZW0nLCBpdGVtSWQsICdmaW5hbmNpYWxMb2dnZWQ6Jyk7XHJcbiAgICBhd2FpdCBjbGVhckVmZmVjdHNCeVByZWZpeCgnaXRlbScsIGl0ZW1JZCwgJ3BvaW50c0xvZ2dlZDonKTtcclxuICAgIFxyXG4gICAgLy8gMy4gUmVtb3ZlIGxvZyBlbnRyaWVzIGZyb20gaXRlbXMgbG9nIG9ubHkgKEl0ZW1zIGRvbid0IGhhdmUgZmluYW5jaWFsL3BsYXllciBlZmZlY3RzKVxyXG4gICAgY29uc29sZS5sb2coYFtyZW1vdmVJdGVtRWZmZWN0c09uRGVsZXRlXSBTdGFydGluZyBsb2cgZW50cnkgcmVtb3ZhbCBmb3IgaXRlbTogJHtpdGVtSWR9YCk7XHJcbiAgICBcclxuICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IENsaWVudEFQSS5yZW1vdmVMb2dFbnRyeSgnaXRlbXMnLCBpdGVtSWQpO1xyXG4gICAgXHJcbiAgICBpZiAocmVzdWx0LnN1Y2Nlc3MpIHtcclxuICAgICAgY29uc29sZS5sb2coYFtyZW1vdmVJdGVtRWZmZWN0c09uRGVsZXRlXSDinIUgSXRlbSBsb2cgZW50cmllcyByZW1vdmVkIHN1Y2Nlc3NmdWxseSBmb3IgaXRlbTogJHtpdGVtSWR9YCk7XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICBjb25zb2xlLmVycm9yKGBbcmVtb3ZlSXRlbUVmZmVjdHNPbkRlbGV0ZV0gRmFpbGVkIHRvIHJlbW92ZSBpdGVtIGxvZyBlbnRyaWVzOiAke3Jlc3VsdC5tZXNzYWdlfWApO1xyXG4gICAgfVxyXG4gICAgXHJcbiAgICBjb25zb2xlLmxvZyhgW3JlbW92ZUl0ZW1FZmZlY3RzT25EZWxldGVdIOKchSBDbGVhcmVkIGVmZmVjdHMsIHJlbW92ZWQgbGlua3MsIGFuZCByZW1vdmVkIGxvZyBlbnRyaWVzIGZvciBpdGVtICR7aXRlbUlkfWApO1xyXG4gIH0gY2F0Y2ggKGVycm9yKSB7XHJcbiAgICBjb25zb2xlLmVycm9yKCdFcnJvciByZW1vdmluZyBpdGVtIGVmZmVjdHM6JywgZXJyb3IpO1xyXG4gIH1cclxufVxyXG5cclxuLyoqXHJcbiAqIFByb2Nlc3MgaXRlbSBjcmVhdGlvbiBlZmZlY3RzIHdoZW4gaXRlbSBpcyBjcmVhdGVkXHJcbiAqIEhhbmRsZXMgc2lkZSBlZmZlY3RzIHdoZW4gaXRlbSBpcyBjcmVhdGVkIGRpcmVjdGx5IChub3QgZnJvbSB0YXNrL3JlY29yZClcclxuICovXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBwcm9jZXNzSXRlbUNyZWF0aW9uRWZmZWN0cyhpdGVtOiBJdGVtKTogUHJvbWlzZTx2b2lkPiB7XHJcbiAgY29uc29sZS5sb2coYFtwcm9jZXNzSXRlbUNyZWF0aW9uRWZmZWN0c10gUHJvY2Vzc2luZyBpdGVtIGNyZWF0aW9uIGVmZmVjdHMgZm9yOiAke2l0ZW0ubmFtZX0gKCR7aXRlbS5pZH0pYCk7XHJcbiAgXHJcbiAgLy8gTG9nIGl0ZW0gY3JlYXRpb24gb25jZSAod2l0aCBpZGVtcG90ZW5jeSlcclxuICBjb25zdCBpdGVtQ3JlYXRlZCA9IGF3YWl0IGhhc0VmZmVjdChgaXRlbToke2l0ZW0uaWR9Oml0ZW1DcmVhdGVkYCk7XHJcbiAgaWYgKCFpdGVtQ3JlYXRlZCkge1xyXG4gICAgYXdhaXQgbG9nSXRlbUNyZWF0aW9uRm9ySXRlbShpdGVtKTtcclxuICAgIGF3YWl0IG1hcmtFZmZlY3QoYGl0ZW06JHtpdGVtLmlkfTppdGVtQ3JlYXRlZGApO1xyXG4gIH1cclxuXHJcbiAgLy8gSXRlbXMgY3JlYXRlZCBmcm9tIEl0ZW0gTW9kYWwgaGF2ZSBOTyBmaW5hbmNpYWwgZWZmZWN0c1xyXG4gIC8vIEl0ZW1zIGFyZSBqdXN0IGludmVudG9yeS9hc3NldHMgLSBmaW5hbmNpYWwgZWZmZWN0cyBjb21lIGZyb20gVGFza3MvUmVjb3Jkc1xyXG4gIC8vIFRoaXMgaXMgZGlmZmVyZW50IGZyb20gVGFza3MvUmVjb3JkcyB3aGljaCBoYXZlIGNvc3QvcmV2ZW51ZSBwcm9wZXJ0aWVzXHJcbn1cclxuXHJcbi8qKlxyXG4gKiBMb2cgaXRlbSBjcmVhdGlvbiB3aGVuIGl0ZW0gaXMgY3JlYXRlZCBkaXJlY3RseSAobm90IGZyb20gdGFzay9yZWNvcmQpXHJcbiAqL1xyXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gbG9nSXRlbUNyZWF0aW9uRm9ySXRlbShpdGVtOiBJdGVtKTogUHJvbWlzZTx2b2lkPiB7XHJcbiAgdHJ5IHtcclxuICAgIGNvbnNvbGUubG9nKGBbbG9nSXRlbUNyZWF0aW9uRm9ySXRlbV0gTG9nZ2luZyBkaXJlY3QgaXRlbSBjcmVhdGlvbjogJHtpdGVtLm5hbWV9ICgke2l0ZW0uaWR9KWApO1xyXG4gICAgXHJcbiAgICBhd2FpdCBhcHBlbmRJdGVtQ3JlYXRpb25Mb2coaXRlbSwgJ2RpcmVjdCcpO1xyXG4gICAgY29uc29sZS5sb2coYFtsb2dJdGVtQ3JlYXRpb25Gb3JJdGVtXSDinIUgRGlyZWN0IGl0ZW0gY3JlYXRpb24gbG9nZ2VkIHN1Y2Nlc3NmdWxseSBmb3IgJHtpdGVtLm5hbWV9YCk7XHJcbiAgfSBjYXRjaCAoZXJyb3IpIHtcclxuICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGxvZ2dpbmcgZGlyZWN0IGl0ZW0gY3JlYXRpb246JywgZXJyb3IpO1xyXG4gIH1cclxufVxyXG5cclxuLyoqXHJcbiAqIFVwZGF0ZSBpdGVtIGxvZyBlbnRyeSB3aGVuIGl0ZW0gcHJvcGVydGllcyBjaGFuZ2VcclxuICogVGhpcyBmdW5jdGlvbiB1cGRhdGVzIGV4aXN0aW5nIGl0ZW0gbG9nIGVudHJpZXMgd2l0aCBuZXcgaXRlbSBkYXRhXHJcbiAqL1xyXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gdXBkYXRlSXRlbUxvZ0VudHJ5Rm9ySXRlbShpdGVtOiBJdGVtLCBkaXNwYXRjaEV2ZW50czogYm9vbGVhbiA9IHRydWUpOiBQcm9taXNlPHZvaWQ+IHtcclxuICB0cnkge1xyXG4gICAgY29uc3QgdXBkYXRlcyA9IHtcclxuICAgICAgaXRlbU5hbWU6IGl0ZW0ubmFtZSxcclxuICAgICAgaXRlbVR5cGU6IGl0ZW0udHlwZSxcclxuICAgICAgY29sbGVjdGlvbjogaXRlbS5jb2xsZWN0aW9uLFxyXG4gICAgICBzdGF0dXM6IGl0ZW0uc3RhdHVzLFxyXG4gICAgICBxdWFudGl0eTogaXRlbS5zdG9jaz8ucmVkdWNlKChzdW06IG51bWJlciwgc3RvY2s6IGFueSkgPT4gc3VtICsgc3RvY2sucXVhbnRpdHksIDApIHx8IDAsXHJcbiAgICAgIHVuaXRDb3N0OiBpdGVtLnVuaXRDb3N0IHx8IDAsXHJcbiAgICAgIHByaWNlOiBpdGVtLnByaWNlIHx8IDAsXHJcbiAgICAgIHN0YXRpb246IGl0ZW0uc3RhdGlvbixcclxuICAgICAgeWVhcjogaXRlbS55ZWFyLFxyXG4gICAgICBkZXNjcmlwdGlvbjogYEl0ZW0gY3JlYXRlZCBkaXJlY3RseTogJHtpdGVtLnR5cGV9ICgke2l0ZW0uc3RvY2s/LnJlZHVjZSgoc3VtOiBudW1iZXIsIHN0b2NrOiBhbnkpID0+IHN1bSArIHN0b2NrLnF1YW50aXR5LCAwKSB8fCAwfXgpYFxyXG4gICAgfTtcclxuXHJcbiAgICAvLyBVcGRhdGUgdGhlIG1vc3QgcmVjZW50IGxvZyBlbnRyeSBmb3IgdGhpcyBpdGVtXHJcbiAgICBhd2FpdCB1cGRhdGVFbnRpdHlMb2dGaWVsZCgnaXRlbScsIGl0ZW0uaWQsICdpdGVtTmFtZScsICcnLCBpdGVtLm5hbWUpO1xyXG4gICAgYXdhaXQgdXBkYXRlRW50aXR5TG9nRmllbGQoJ2l0ZW0nLCBpdGVtLmlkLCAnaXRlbVR5cGUnLCAnJywgaXRlbS50eXBlKTtcclxuICAgIGF3YWl0IHVwZGF0ZUVudGl0eUxvZ0ZpZWxkKCdpdGVtJywgaXRlbS5pZCwgJ3N0YXR1cycsICcnLCBpdGVtLnN0YXR1cyk7XHJcbiAgICBhd2FpdCB1cGRhdGVFbnRpdHlMb2dGaWVsZCgnaXRlbScsIGl0ZW0uaWQsICdxdWFudGl0eScsICcnLCBpdGVtLnN0b2NrPy5yZWR1Y2UoKHN1bTogbnVtYmVyLCBzdG9jazogYW55KSA9PiBzdW0gKyBzdG9jay5xdWFudGl0eSwgMCkgfHwgMCk7XHJcbiAgICBhd2FpdCB1cGRhdGVFbnRpdHlMb2dGaWVsZCgnaXRlbScsIGl0ZW0uaWQsICd1bml0Q29zdCcsICcnLCBpdGVtLnVuaXRDb3N0IHx8IDApO1xyXG4gICAgYXdhaXQgdXBkYXRlRW50aXR5TG9nRmllbGQoJ2l0ZW0nLCBpdGVtLmlkLCAncHJpY2UnLCAnJywgaXRlbS5wcmljZSB8fCAwKTtcclxuXHJcbiAgICBjb25zb2xlLmxvZyhgW3VwZGF0ZUl0ZW1Mb2dFbnRyeUZvckl0ZW1dIOKchSBJdGVtIGxvZyBlbnRyeSB1cGRhdGVkIHN1Y2Nlc3NmdWxseSBmb3IgJHtpdGVtLm5hbWV9YCk7XHJcbiAgICBcclxuICAgIC8vIERpc3BhdGNoIGV2ZW50IHRvIG5vdGlmeSBmcm9udGVuZCBvZiBpdGVtcyB1cGRhdGVcclxuICAgIGlmIChkaXNwYXRjaEV2ZW50cyAmJiB0eXBlb2Ygd2luZG93ICE9PSAndW5kZWZpbmVkJykge1xyXG4gICAgICB3aW5kb3cuZGlzcGF0Y2hFdmVudChuZXcgQ3VzdG9tRXZlbnQoJ2l0ZW1zVXBkYXRlZCcpKTtcclxuICAgIH1cclxuICB9IGNhdGNoIChlcnJvcikge1xyXG4gICAgY29uc29sZS5lcnJvcignRXJyb3IgdXBkYXRpbmcgaXRlbSBsb2cgZW50cnk6JywgZXJyb3IpO1xyXG4gIH1cclxufVxyXG5cclxuLyoqXHJcbiAqIFVwZGF0ZSBhbGwgbG9nIGVudHJpZXMgd2hlbiBpdGVtIHByb3BlcnRpZXMgY2hhbmdlXHJcbiAqIFRoaXMgZnVuY3Rpb24gdXBkYXRlcyBleGlzdGluZyBsb2cgZW50cmllcyBhY3Jvc3MgYWxsIGxvZyB0eXBlcyB3aXRoIG5ldyBpdGVtIGRhdGFcclxuICovXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiB1cGRhdGVBbGxJdGVtTG9nRW50cmllcyhpdGVtOiBJdGVtLCBkaXNwYXRjaEV2ZW50czogYm9vbGVhbiA9IHRydWUpOiBQcm9taXNlPHZvaWQ+IHtcclxuICB0cnkge1xyXG4gICAgY29uc29sZS5sb2coYFt1cGRhdGVBbGxJdGVtTG9nRW50cmllc10gVXBkYXRpbmcgYWxsIGxvZyBlbnRyaWVzIGZvciBpdGVtOiAke2l0ZW0ubmFtZX0gKCR7aXRlbS5pZH0pYCk7XHJcbiAgICBcclxuICAgIC8vIFVwZGF0ZSBpdGVtIGxvZyBlbnRyaWVzXHJcbiAgICBhd2FpdCB1cGRhdGVJdGVtTG9nRW50cnlGb3JJdGVtKGl0ZW0sIGZhbHNlKTtcclxuICAgIFxyXG4gICAgLy8gRGlzcGF0Y2ggZXZlbnQgdG8gbm90aWZ5IGZyb250ZW5kIG9mIGl0ZW1zIHVwZGF0ZVxyXG4gICAgaWYgKGRpc3BhdGNoRXZlbnRzICYmIHR5cGVvZiB3aW5kb3cgIT09ICd1bmRlZmluZWQnKSB7XHJcbiAgICAgIHdpbmRvdy5kaXNwYXRjaEV2ZW50KG5ldyBDdXN0b21FdmVudCgnaXRlbXNVcGRhdGVkJykpO1xyXG4gICAgfVxyXG4gICAgXHJcbiAgICBjb25zb2xlLmxvZyhgW3VwZGF0ZUFsbEl0ZW1Mb2dFbnRyaWVzXSDinIUgQWxsIGxvZyBlbnRyaWVzIHVwZGF0ZWQgc3VjY2Vzc2Z1bGx5IGZvciAke2l0ZW0ubmFtZX1gKTtcclxuICB9IGNhdGNoIChlcnJvcikge1xyXG4gICAgY29uc29sZS5lcnJvcignRXJyb3IgdXBkYXRpbmcgYWxsIGl0ZW0gbG9nIGVudHJpZXM6JywgZXJyb3IpO1xyXG4gIH1cclxufSJdLCJuYW1lcyI6WyJhcHBlbmRFbnRpdHlMb2ciLCJ1cGRhdGVFbnRpdHlMb2dGaWVsZCIsImFwcGVuZEl0ZW1DcmVhdGlvbkxvZyIsImhhc0VmZmVjdCIsIm1hcmtFZmZlY3QiLCJjbGVhckVmZmVjdCIsImNsZWFyRWZmZWN0c0J5UHJlZml4IiwiQ2xpZW50QVBJIiwiU1RBVEVfRklFTERTIiwiREVTQ1JJUFRJVkVfRklFTERTIiwib25JdGVtVXBzZXJ0IiwiaXRlbSIsInByZXZpb3VzSXRlbSIsImVmZmVjdEtleSIsImlkIiwibmFtZSIsInR5cGUiLCJzdGF0aW9uIiwic291cmNlVHlwZSIsInNvdXJjZVRhc2tJZCIsInNvdXJjZVJlY29yZElkIiwic291cmNlSWQiLCJ1bmRlZmluZWQiLCJzdG9ja0NoYW5nZWQiLCJKU09OIiwic3RyaW5naWZ5Iiwic3RvY2siLCJvbGRTdG9jayIsIm5ld1N0b2NrIiwicXVhbnRpdHlTb2xkIiwib2xkUXVhbnRpdHlTb2xkIiwiaXNDb2xsZWN0ZWQiLCJjb2xsZWN0ZWRBdCIsIkRhdGUiLCJ0b0lTT1N0cmluZyIsImZpZWxkIiwicmVtb3ZlSXRlbUVmZmVjdHNPbkRlbGV0ZSIsIml0ZW1JZCIsImNvbnNvbGUiLCJsb2ciLCJpdGVtTGlua3MiLCJnZXRMaW5rc0ZvciIsImxlbmd0aCIsImxpbmsiLCJyZW1vdmVMaW5rIiwibGlua1R5cGUiLCJlcnJvciIsInJlc3VsdCIsInJlbW92ZUxvZ0VudHJ5Iiwic3VjY2VzcyIsIm1lc3NhZ2UiLCJwcm9jZXNzSXRlbUNyZWF0aW9uRWZmZWN0cyIsIml0ZW1DcmVhdGVkIiwibG9nSXRlbUNyZWF0aW9uRm9ySXRlbSIsInVwZGF0ZUl0ZW1Mb2dFbnRyeUZvckl0ZW0iLCJkaXNwYXRjaEV2ZW50cyIsInVwZGF0ZXMiLCJpdGVtTmFtZSIsIml0ZW1UeXBlIiwiY29sbGVjdGlvbiIsInN0YXR1cyIsInF1YW50aXR5IiwicmVkdWNlIiwic3VtIiwidW5pdENvc3QiLCJwcmljZSIsInllYXIiLCJkZXNjcmlwdGlvbiIsIndpbmRvdyIsImRpc3BhdGNoRXZlbnQiLCJDdXN0b21FdmVudCIsInVwZGF0ZUFsbEl0ZW1Mb2dFbnRyaWVzIl0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(rsc)/./workflows/entities-workflows/item.workflow.ts\n");

/***/ }),

/***/ "(rsc)/./workflows/entities-workflows/player.workflow.ts":
/*!*********************************************************!*\
  !*** ./workflows/entities-workflows/player.workflow.ts ***!
  \*********************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   logPlayerEffect: () => (/* binding */ logPlayerEffect),\n/* harmony export */   logPlayerEffectFromRecord: () => (/* binding */ logPlayerEffectFromRecord),\n/* harmony export */   logPlayerUpdateFromTask: () => (/* binding */ logPlayerUpdateFromTask),\n/* harmony export */   onPlayerUpsert: () => (/* binding */ onPlayerUpsert),\n/* harmony export */   removePlayerEffectsOnDelete: () => (/* binding */ removePlayerEffectsOnDelete),\n/* harmony export */   updatePlayerPointsFromTask: () => (/* binding */ updatePlayerPointsFromTask)\n/* harmony export */ });\n/* harmony import */ var _entities_logging__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../entities-logging */ \"(rsc)/./workflows/entities-logging.ts\");\n/* harmony import */ var _data_store_effects_registry__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @/data-store/effects-registry */ \"(rsc)/./data-store/effects-registry.ts\");\n/* harmony import */ var _lib_client_api__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @/lib/client-api */ \"(rsc)/./lib/client-api.ts\");\n// workflows/entities-workflows/player.workflow.ts\n// Player-specific workflow with LEVEL_UP, POINTS_CHANGED events\n\n\n\n\nconst STATE_FIELDS = [\n    \"level\",\n    \"totalPoints\",\n    \"points\",\n    \"isActive\"\n];\nconst DESCRIPTIVE_FIELDS = [\n    \"name\",\n    \"email\"\n];\nasync function onPlayerUpsert(player, previousPlayer) {\n    // New player creation\n    if (!previousPlayer) {\n        const effectKey = `player:${player.id}:created`;\n        if (await (0,_data_store_effects_registry__WEBPACK_IMPORTED_MODULE_1__.hasEffect)(effectKey)) return;\n        await (0,_entities_logging__WEBPACK_IMPORTED_MODULE_0__.appendEntityLog)(\"player\", player.id, \"CREATED\", {\n            name: player.name,\n            level: player.level\n        });\n        await (0,_data_store_effects_registry__WEBPACK_IMPORTED_MODULE_1__.markEffect)(effectKey);\n        return;\n    }\n    // Level up - LEVEL_UP event\n    if (previousPlayer.level < player.level) {\n        await (0,_entities_logging__WEBPACK_IMPORTED_MODULE_0__.appendEntityLog)(\"player\", player.id, \"LEVEL_UP\", {\n            name: player.name,\n            oldLevel: previousPlayer.level,\n            newLevel: player.level\n        });\n    }\n    // Points changes - POINTS_CHANGED event\n    const pointsChanged = JSON.stringify(previousPlayer.totalPoints) !== JSON.stringify(player.totalPoints) || JSON.stringify(previousPlayer.points) !== JSON.stringify(player.points);\n    if (pointsChanged) {\n        await (0,_entities_logging__WEBPACK_IMPORTED_MODULE_0__.appendEntityLog)(\"player\", player.id, \"POINTS_CHANGED\", {\n            name: player.name,\n            totalPoints: player.totalPoints,\n            points: player.points\n        });\n    }\n    // General updates - UPDATED event\n    const hasSignificantChanges = previousPlayer.isActive !== player.isActive;\n    if (hasSignificantChanges) {\n        await (0,_entities_logging__WEBPACK_IMPORTED_MODULE_0__.appendEntityLog)(\"player\", player.id, \"UPDATED\", {\n            name: player.name,\n            isActive: player.isActive\n        });\n    }\n    // Descriptive changes - update in-place\n    for (const field of DESCRIPTIVE_FIELDS){\n        if (previousPlayer[field] !== player[field]) {\n            await (0,_entities_logging__WEBPACK_IMPORTED_MODULE_0__.updateEntityLogField)(\"player\", player.id, field, previousPlayer[field], player[field]);\n        }\n    }\n}\n/**\r\n * Remove player effects when player is deleted\r\n * Players can have entries in player log and related links\r\n */ async function removePlayerEffectsOnDelete(playerId) {\n    try {\n        console.log(`[removePlayerEffectsOnDelete] Starting cleanup for player: ${playerId}`);\n        // 1. Remove all Links related to this player\n        const playerLinks = await _lib_client_api__WEBPACK_IMPORTED_MODULE_2__.ClientAPI.getLinksFor({\n            type: \"player\",\n            id: playerId\n        });\n        console.log(`[removePlayerEffectsOnDelete] Found ${playerLinks.length} links to remove`);\n        for (const link of playerLinks){\n            try {\n                await _lib_client_api__WEBPACK_IMPORTED_MODULE_2__.ClientAPI.removeLink(link.id);\n                console.log(`[removePlayerEffectsOnDelete] ✅ Removed link: ${link.linkType}`);\n            } catch (error) {\n                console.error(`[removePlayerEffectsOnDelete] ❌ Failed to remove link ${link.id}:`, error);\n            }\n        }\n        // 2. Clear all effects for this player\n        await (0,_data_store_effects_registry__WEBPACK_IMPORTED_MODULE_1__.clearEffect)(`player:${playerId}:created`);\n        await (0,_data_store_effects_registry__WEBPACK_IMPORTED_MODULE_1__.clearEffectsByPrefix)(\"player\", playerId, \"\");\n        // 3. Remove log entries from player log\n        console.log(`[removePlayerEffectsOnDelete] Starting log entry removal for player: ${playerId}`);\n        const result = await _lib_client_api__WEBPACK_IMPORTED_MODULE_2__.ClientAPI.removeLogEntry(\"player\", playerId);\n        if (result.success) {\n            console.log(`[removePlayerEffectsOnDelete] ✅ Player log entries removed successfully for player: ${playerId}`);\n        } else {\n            console.error(`[removePlayerEffectsOnDelete] Failed to remove player log entries: ${result.message}`);\n        }\n        console.log(`[removePlayerEffectsOnDelete] ✅ Cleared effects, removed links, and removed log entries for player ${playerId}`);\n    } catch (error) {\n        console.error(\"Error removing player effects:\", error);\n    }\n}\n/**\r\n * Log player effect from task completion\r\n * This logs the points awarded to the player from completing a task\r\n */ async function logPlayerEffect(task) {\n    try {\n        console.log(`[logPlayerEffect] Logging player effect for task: ${task.name} (${task.id})`);\n        // Only log if there are points to award\n        const hasPoints = task.rewards?.points && ((task.rewards.points.xp || 0) > 0 || (task.rewards.points.rp || 0) > 0 || (task.rewards.points.fp || 0) > 0 || (task.rewards.points.hp || 0) > 0);\n        if (!hasPoints) {\n            console.log(\"[logPlayerEffect] No points to log, skipping\");\n            return;\n        }\n        // Get main player ID (V0.1 constant)\n        const mainPlayerId = \"PLAYER_ONE_ID\";\n        await (0,_entities_logging__WEBPACK_IMPORTED_MODULE_0__.appendPlayerPointsLog)(mainPlayerId, {\n            xp: task.rewards.points.xp || 0,\n            rp: task.rewards.points.rp || 0,\n            fp: task.rewards.points.fp || 0,\n            hp: task.rewards.points.hp || 0\n        }, task.id, \"task\");\n        console.log(`[logPlayerEffect] ✅ Player effect logged successfully for ${task.name}`);\n    } catch (error) {\n        console.error(\"Error logging player effect:\", error);\n    }\n}\n/**\r\n * Log player effect from financial record\r\n * This logs the points awarded to the player from a financial record\r\n */ async function logPlayerEffectFromRecord(record) {\n    try {\n        console.log(`[logPlayerEffectFromRecord] Logging player effect for record: ${record.name} (${record.id})`);\n        // Only log if there are points to award\n        const hasPoints = record.rewards?.points && ((record.rewards.points.xp || 0) > 0 || (record.rewards.points.rp || 0) > 0 || (record.rewards.points.fp || 0) > 0 || (record.rewards.points.hp || 0) > 0);\n        if (!hasPoints) {\n            console.log(\"[logPlayerEffectFromRecord] No points to log, skipping\");\n            return;\n        }\n        // Get main player ID (V0.1 constant)\n        const mainPlayerId = \"PLAYER_ONE_ID\";\n        await (0,_entities_logging__WEBPACK_IMPORTED_MODULE_0__.appendPlayerPointsLog)(mainPlayerId, {\n            xp: record.rewards?.points?.xp || 0,\n            rp: record.rewards?.points?.rp || 0,\n            fp: record.rewards?.points?.fp || 0,\n            hp: record.rewards?.points?.hp || 0\n        }, record.id, \"financial\");\n        console.log(`[logPlayerEffectFromRecord] ✅ Player effect logged successfully for ${record.name}`);\n    } catch (error) {\n        console.error(\"Error logging player effect from record:\", error);\n    }\n}\n/**\r\n * Log player update from task changes\r\n * This logs when task rewards change and player points need to be updated\r\n */ async function logPlayerUpdateFromTask(task, oldTask) {\n    try {\n        console.log(`[logPlayerUpdateFromTask] Logging player update for task: ${task.name} (${task.id})`);\n        const oldRewards = oldTask.rewards?.points || {\n            xp: 0,\n            rp: 0,\n            fp: 0,\n            hp: 0\n        };\n        const newRewards = task.rewards?.points || {\n            xp: 0,\n            rp: 0,\n            fp: 0,\n            hp: 0\n        };\n        // Check if rewards actually changed\n        const rewardsChanged = JSON.stringify(oldRewards) !== JSON.stringify(newRewards);\n        if (!rewardsChanged) {\n            console.log(\"[logPlayerUpdateFromTask] No reward changes to log, skipping\");\n            return;\n        }\n        // Get main player ID (V0.1 constant)\n        const mainPlayerId = \"PLAYER_ONE_ID\";\n        await (0,_entities_logging__WEBPACK_IMPORTED_MODULE_0__.appendPlayerPointsUpdateLog)(mainPlayerId, {\n            xp: oldRewards.xp || 0,\n            rp: oldRewards.rp || 0,\n            fp: oldRewards.fp || 0,\n            hp: oldRewards.hp || 0\n        }, {\n            xp: newRewards.xp || 0,\n            rp: newRewards.rp || 0,\n            fp: newRewards.fp || 0,\n            hp: newRewards.hp || 0\n        }, task.id);\n        console.log(`[logPlayerUpdateFromTask] ✅ Player update logged successfully for ${task.name}`);\n    } catch (error) {\n        console.error(\"Error logging player update from task:\", error);\n    }\n}\n/**\r\n * Update player points from task changes\r\n * This updates the player's points when task rewards change\r\n */ async function updatePlayerPointsFromTask(task, oldTask) {\n    try {\n        console.log(`[updatePlayerPointsFromTask] Updating player points for task: ${task.name} (${task.id})`);\n        const oldRewards = oldTask.rewards?.points || {\n            xp: 0,\n            rp: 0,\n            fp: 0,\n            hp: 0\n        };\n        const newRewards = task.rewards?.points || {\n            xp: 0,\n            rp: 0,\n            fp: 0,\n            hp: 0\n        };\n        // Calculate point delta\n        const delta = {\n            xp: (newRewards.xp || 0) - (oldRewards.xp || 0),\n            rp: (newRewards.rp || 0) - (oldRewards.rp || 0),\n            fp: (newRewards.fp || 0) - (oldRewards.fp || 0),\n            hp: (newRewards.hp || 0) - (oldRewards.hp || 0)\n        };\n        // Check if there are any changes\n        const hasChanges = delta.xp !== 0 || delta.rp !== 0 || delta.fp !== 0 || delta.hp !== 0;\n        if (!hasChanges) {\n            console.log(\"[updatePlayerPointsFromTask] No point changes to apply, skipping\");\n            return;\n        }\n        // Get main player\n        const mainPlayerId = \"PLAYER_ONE_ID\";\n        const players = await _lib_client_api__WEBPACK_IMPORTED_MODULE_2__.ClientAPI.getPlayers();\n        const mainPlayer = players.find((p)=>p.id === mainPlayerId);\n        if (!mainPlayer) {\n            console.log(\"[updatePlayerPointsFromTask] Main player not found, skipping\");\n            return;\n        }\n        // Apply delta to player points\n        const updatedPlayer = {\n            ...mainPlayer,\n            points: {\n                xp: Math.max(0, (mainPlayer.points?.xp || 0) + delta.xp),\n                rp: Math.max(0, (mainPlayer.points?.rp || 0) + delta.rp),\n                fp: Math.max(0, (mainPlayer.points?.fp || 0) + delta.fp),\n                hp: Math.max(0, (mainPlayer.points?.hp || 0) + delta.hp)\n            },\n            totalPoints: {\n                xp: Math.max(0, (mainPlayer.totalPoints?.xp || 0) + delta.xp),\n                rp: Math.max(0, (mainPlayer.totalPoints?.rp || 0) + delta.rp),\n                fp: Math.max(0, (mainPlayer.totalPoints?.fp || 0) + delta.fp),\n                hp: Math.max(0, (mainPlayer.totalPoints?.hp || 0) + delta.hp)\n            },\n            updatedAt: new Date()\n        };\n        // Store the updated player\n        console.log(`[updatePlayerPointsFromTask] Applying point delta:`, delta);\n        await _lib_client_api__WEBPACK_IMPORTED_MODULE_2__.ClientAPI.upsertPlayer(updatedPlayer);\n        console.log(`[updatePlayerPointsFromTask] ✅ Player points updated successfully`);\n    } catch (error) {\n        console.error(\"Error updating player points from task:\", error);\n    }\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi93b3JrZmxvd3MvZW50aXRpZXMtd29ya2Zsb3dzL3BsYXllci53b3JrZmxvdy50cyIsIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7QUFBQSxrREFBa0Q7QUFDbEQsZ0VBQWdFO0FBR1k7QUFDNkI7QUFDNUQ7QUFDNEM7QUFHekYsTUFBTVMsZUFBZTtJQUFDO0lBQVM7SUFBZTtJQUFVO0NBQVc7QUFDbkUsTUFBTUMscUJBQXFCO0lBQUM7SUFBUTtDQUFRO0FBRXJDLGVBQWVDLGVBQWVDLE1BQWMsRUFBRUMsY0FBdUI7SUFDMUUsc0JBQXNCO0lBQ3RCLElBQUksQ0FBQ0EsZ0JBQWdCO1FBQ25CLE1BQU1DLFlBQVksQ0FBQyxPQUFPLEVBQUVGLE9BQU9HLEVBQUUsQ0FBQyxRQUFRLENBQUM7UUFDL0MsSUFBSSxNQUFNYix1RUFBU0EsQ0FBQ1ksWUFBWTtRQUVoQyxNQUFNZCxrRUFBZUEsQ0FBQyxVQUFVWSxPQUFPRyxFQUFFLEVBQUUsV0FBVztZQUNwREMsTUFBTUosT0FBT0ksSUFBSTtZQUNqQkMsT0FBT0wsT0FBT0ssS0FBSztRQUNyQjtRQUNBLE1BQU1kLHdFQUFVQSxDQUFDVztRQUNqQjtJQUNGO0lBRUEsNEJBQTRCO0lBQzVCLElBQUlELGVBQWVJLEtBQUssR0FBR0wsT0FBT0ssS0FBSyxFQUFFO1FBQ3ZDLE1BQU1qQixrRUFBZUEsQ0FBQyxVQUFVWSxPQUFPRyxFQUFFLEVBQUUsWUFBWTtZQUNyREMsTUFBTUosT0FBT0ksSUFBSTtZQUNqQkUsVUFBVUwsZUFBZUksS0FBSztZQUM5QkUsVUFBVVAsT0FBT0ssS0FBSztRQUN4QjtJQUNGO0lBRUEsd0NBQXdDO0lBQ3hDLE1BQU1HLGdCQUFnQkMsS0FBS0MsU0FBUyxDQUFDVCxlQUFlVSxXQUFXLE1BQU1GLEtBQUtDLFNBQVMsQ0FBQ1YsT0FBT1csV0FBVyxLQUNqRkYsS0FBS0MsU0FBUyxDQUFDVCxlQUFlVyxNQUFNLE1BQU1ILEtBQUtDLFNBQVMsQ0FBQ1YsT0FBT1ksTUFBTTtJQUMzRixJQUFJSixl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S0FBS0MsR0FBRyxDQUFDLEdBQUcsQ0FBQ0wsV0FBV3pDLE1BQU0sRUFBRXlCLE1BQU0sS0FBS1ksTUFBTVosRUFBRTtnQkFDdkRDLElBQUltQixLQUFLQyxHQUFHLENBQUMsR0FBRyxDQUFDTCxXQUFXekMsTUFBTSxFQUFFMEIsTUFBTSxLQUFLVyxNQUFNWCxFQUFFO2dCQUN2REMsSUFBSWtCLEtBQUtDLEdBQUcsQ0FBQyxHQUFHLENBQUNMLFdBQVd6QyxNQUFNLEVBQUUyQixNQUFNLEtBQUtVLE1BQU1WLEVBQUU7WUFDekQ7WUFDQTVCLGFBQWE7Z0JBQ1h5QixJQUFJcUIsS0FBS0MsR0FBRyxDQUFDLEdBQUcsQ0FBQ0wsV0FBVzFDLFdBQVcsRUFBRXlCLE1BQU0sS0FBS2EsTUFBTWIsRUFBRTtnQkFDNURDLElBQUlvQixLQUFLQyxHQUFHLENBQUMsR0FBRyxDQUFDTCxXQUFXMUMsV0FBVyxFQUFFMEIsTUFBTSxLQUFLWSxNQUFNWixFQUFFO2dCQUM1REMsSUFBSW1CLEtBQUtDLEdBQUcsQ0FBQyxHQUFHLENBQUNMLFdBQVcxQyxXQUFXLEVBQUUyQixNQUFNLEtBQUtXLE1BQU1YLEVBQUU7Z0JBQzVEQyxJQUFJa0IsS0FBS0MsR0FBRyxDQUFDLEdBQUcsQ0FBQ0wsV0FBVzFDLFdBQVcsRUFBRTRCLE1BQU0sS0FBS1UsTUFBTVYsRUFBRTtZQUM5RDtZQUNBb0IsV0FBVyxJQUFJQztRQUNqQjtRQUVBLDJCQUEyQjtRQUMzQjFDLFFBQVFDLEdBQUcsQ0FBQyxDQUFDLGtEQUFrRCxDQUFDLEVBQUU4QjtRQUNsRSxNQUFNdkQsc0RBQVNBLENBQUNtRSxZQUFZLENBQUNMO1FBRTdCdEMsUUFBUUMsR0FBRyxDQUFDLENBQUMsaUVBQWlFLENBQUM7SUFDakYsRUFBRSxPQUFPUSxPQUFPO1FBQ2RULFFBQVFTLEtBQUssQ0FBQywyQ0FBMkNBO0lBQzNEO0FBQ0YiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly90aGVnYW1lLWFkbWluLy4vd29ya2Zsb3dzL2VudGl0aWVzLXdvcmtmbG93cy9wbGF5ZXIud29ya2Zsb3cudHM/ODgzYiJdLCJzb3VyY2VzQ29udGVudCI6WyIvLyB3b3JrZmxvd3MvZW50aXRpZXMtd29ya2Zsb3dzL3BsYXllci53b3JrZmxvdy50c1xyXG4vLyBQbGF5ZXItc3BlY2lmaWMgd29ya2Zsb3cgd2l0aCBMRVZFTF9VUCwgUE9JTlRTX0NIQU5HRUQgZXZlbnRzXHJcblxyXG5pbXBvcnQgdHlwZSB7IFBsYXllciB9IGZyb20gJ0AvdHlwZXMvZW50aXRpZXMnO1xyXG5pbXBvcnQgeyBhcHBlbmRFbnRpdHlMb2csIHVwZGF0ZUVudGl0eUxvZ0ZpZWxkIH0gZnJvbSAnLi4vZW50aXRpZXMtbG9nZ2luZyc7XHJcbmltcG9ydCB7IGhhc0VmZmVjdCwgbWFya0VmZmVjdCwgY2xlYXJFZmZlY3QsIGNsZWFyRWZmZWN0c0J5UHJlZml4IH0gZnJvbSAnQC9kYXRhLXN0b3JlL2VmZmVjdHMtcmVnaXN0cnknO1xyXG5pbXBvcnQgeyBDbGllbnRBUEkgfSBmcm9tICdAL2xpYi9jbGllbnQtYXBpJztcclxuaW1wb3J0IHsgYXBwZW5kUGxheWVyUG9pbnRzTG9nLCBhcHBlbmRQbGF5ZXJQb2ludHNVcGRhdGVMb2cgfSBmcm9tICcuLi9lbnRpdGllcy1sb2dnaW5nJztcclxuaW1wb3J0IHR5cGUgeyBUYXNrLCBGaW5hbmNpYWxSZWNvcmQgfSBmcm9tICdAL3R5cGVzL2VudGl0aWVzJztcclxuXHJcbmNvbnN0IFNUQVRFX0ZJRUxEUyA9IFsnbGV2ZWwnLCAndG90YWxQb2ludHMnLCAncG9pbnRzJywgJ2lzQWN0aXZlJ107XHJcbmNvbnN0IERFU0NSSVBUSVZFX0ZJRUxEUyA9IFsnbmFtZScsICdlbWFpbCddO1xyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIG9uUGxheWVyVXBzZXJ0KHBsYXllcjogUGxheWVyLCBwcmV2aW91c1BsYXllcj86IFBsYXllcik6IFByb21pc2U8dm9pZD4ge1xyXG4gIC8vIE5ldyBwbGF5ZXIgY3JlYXRpb25cclxuICBpZiAoIXByZXZpb3VzUGxheWVyKSB7XHJcbiAgICBjb25zdCBlZmZlY3RLZXkgPSBgcGxheWVyOiR7cGxheWVyLmlkfTpjcmVhdGVkYDtcclxuICAgIGlmIChhd2FpdCBoYXNFZmZlY3QoZWZmZWN0S2V5KSkgcmV0dXJuO1xyXG4gICAgXHJcbiAgICBhd2FpdCBhcHBlbmRFbnRpdHlMb2coJ3BsYXllcicsIHBsYXllci5pZCwgJ0NSRUFURUQnLCB7IFxyXG4gICAgICBuYW1lOiBwbGF5ZXIubmFtZSwgXHJcbiAgICAgIGxldmVsOiBwbGF5ZXIubGV2ZWxcclxuICAgIH0pO1xyXG4gICAgYXdhaXQgbWFya0VmZmVjdChlZmZlY3RLZXkpO1xyXG4gICAgcmV0dXJuO1xyXG4gIH1cclxuICBcclxuICAvLyBMZXZlbCB1cCAtIExFVkVMX1VQIGV2ZW50XHJcbiAgaWYgKHByZXZpb3VzUGxheWVyLmxldmVsIDwgcGxheWVyLmxldmVsKSB7XHJcbiAgICBhd2FpdCBhcHBlbmRFbnRpdHlMb2coJ3BsYXllcicsIHBsYXllci5pZCwgJ0xFVkVMX1VQJywge1xyXG4gICAgICBuYW1lOiBwbGF5ZXIubmFtZSxcclxuICAgICAgb2xkTGV2ZWw6IHByZXZpb3VzUGxheWVyLmxldmVsLFxyXG4gICAgICBuZXdMZXZlbDogcGxheWVyLmxldmVsXHJcbiAgICB9KTtcclxuICB9XHJcbiAgXHJcbiAgLy8gUG9pbnRzIGNoYW5nZXMgLSBQT0lOVFNfQ0hBTkdFRCBldmVudFxyXG4gIGNvbnN0IHBvaW50c0NoYW5nZWQgPSBKU09OLnN0cmluZ2lmeShwcmV2aW91c1BsYXllci50b3RhbFBvaW50cykgIT09IEpTT04uc3RyaW5naWZ5KHBsYXllci50b3RhbFBvaW50cykgfHxcclxuICAgICAgICAgICAgICAgICAgICAgICBKU09OLnN0cmluZ2lmeShwcmV2aW91c1BsYXllci5wb2ludHMpICE9PSBKU09OLnN0cmluZ2lmeShwbGF5ZXIucG9pbnRzKTtcclxuICBpZiAocG9pbnRzQ2hhbmdlZCkge1xyXG4gICAgYXdhaXQgYXBwZW5kRW50aXR5TG9nKCdwbGF5ZXInLCBwbGF5ZXIuaWQsICdQT0lOVFNfQ0hBTkdFRCcsIHtcclxuICAgICAgbmFtZTogcGxheWVyLm5hbWUsXHJcbiAgICAgIHRvdGFsUG9pbnRzOiBwbGF5ZXIudG90YWxQb2ludHMsXHJcbiAgICAgIHBvaW50czogcGxheWVyLnBvaW50c1xyXG4gICAgfSk7XHJcbiAgfVxyXG4gIFxyXG4gIC8vIEdlbmVyYWwgdXBkYXRlcyAtIFVQREFURUQgZXZlbnRcclxuICBjb25zdCBoYXNTaWduaWZpY2FudENoYW5nZXMgPSBwcmV2aW91c1BsYXllci5pc0FjdGl2ZSAhPT0gcGxheWVyLmlzQWN0aXZlO1xyXG4gIGlmIChoYXNTaWduaWZpY2FudENoYW5nZXMpIHtcclxuICAgIGF3YWl0IGFwcGVuZEVudGl0eUxvZygncGxheWVyJywgcGxheWVyLmlkLCAnVVBEQVRFRCcsIHtcclxuICAgICAgbmFtZTogcGxheWVyLm5hbWUsXHJcbiAgICAgIGlzQWN0aXZlOiBwbGF5ZXIuaXNBY3RpdmVcclxuICAgIH0pO1xyXG4gIH1cclxuICBcclxuICAvLyBEZXNjcmlwdGl2ZSBjaGFuZ2VzIC0gdXBkYXRlIGluLXBsYWNlXHJcbiAgZm9yIChjb25zdCBmaWVsZCBvZiBERVNDUklQVElWRV9GSUVMRFMpIHtcclxuICAgIGlmICgocHJldmlvdXNQbGF5ZXIgYXMgYW55KVtmaWVsZF0gIT09IChwbGF5ZXIgYXMgYW55KVtmaWVsZF0pIHtcclxuICAgICAgYXdhaXQgdXBkYXRlRW50aXR5TG9nRmllbGQoJ3BsYXllcicsIHBsYXllci5pZCwgZmllbGQsIChwcmV2aW91c1BsYXllciBhcyBhbnkpW2ZpZWxkXSwgKHBsYXllciBhcyBhbnkpW2ZpZWxkXSk7XHJcbiAgICB9XHJcbiAgfVxyXG59XHJcblxyXG4vKipcclxuICogUmVtb3ZlIHBsYXllciBlZmZlY3RzIHdoZW4gcGxheWVyIGlzIGRlbGV0ZWRcclxuICogUGxheWVycyBjYW4gaGF2ZSBlbnRyaWVzIGluIHBsYXllciBsb2cgYW5kIHJlbGF0ZWQgbGlua3NcclxuICovXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiByZW1vdmVQbGF5ZXJFZmZlY3RzT25EZWxldGUocGxheWVySWQ6IHN0cmluZyk6IFByb21pc2U8dm9pZD4ge1xyXG4gIHRyeSB7XHJcbiAgICBjb25zb2xlLmxvZyhgW3JlbW92ZVBsYXllckVmZmVjdHNPbkRlbGV0ZV0gU3RhcnRpbmcgY2xlYW51cCBmb3IgcGxheWVyOiAke3BsYXllcklkfWApO1xyXG4gICAgXHJcbiAgICAvLyAxLiBSZW1vdmUgYWxsIExpbmtzIHJlbGF0ZWQgdG8gdGhpcyBwbGF5ZXJcclxuICAgIGNvbnN0IHBsYXllckxpbmtzID0gYXdhaXQgQ2xpZW50QVBJLmdldExpbmtzRm9yKHsgdHlwZTogJ3BsYXllcicsIGlkOiBwbGF5ZXJJZCB9KTtcclxuICAgIGNvbnNvbGUubG9nKGBbcmVtb3ZlUGxheWVyRWZmZWN0c09uRGVsZXRlXSBGb3VuZCAke3BsYXllckxpbmtzLmxlbmd0aH0gbGlua3MgdG8gcmVtb3ZlYCk7XHJcbiAgICBcclxuICAgIGZvciAoY29uc3QgbGluayBvZiBwbGF5ZXJMaW5rcykge1xyXG4gICAgICB0cnkge1xyXG4gICAgICAgIGF3YWl0IENsaWVudEFQSS5yZW1vdmVMaW5rKGxpbmsuaWQpO1xyXG4gICAgICAgIGNvbnNvbGUubG9nKGBbcmVtb3ZlUGxheWVyRWZmZWN0c09uRGVsZXRlXSDinIUgUmVtb3ZlZCBsaW5rOiAke2xpbmsubGlua1R5cGV9YCk7XHJcbiAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XHJcbiAgICAgICAgY29uc29sZS5lcnJvcihgW3JlbW92ZVBsYXllckVmZmVjdHNPbkRlbGV0ZV0g4p2MIEZhaWxlZCB0byByZW1vdmUgbGluayAke2xpbmsuaWR9OmAsIGVycm9yKTtcclxuICAgICAgfVxyXG4gICAgfVxyXG4gICAgXHJcbiAgICAvLyAyLiBDbGVhciBhbGwgZWZmZWN0cyBmb3IgdGhpcyBwbGF5ZXJcclxuICAgIGF3YWl0IGNsZWFyRWZmZWN0KGBwbGF5ZXI6JHtwbGF5ZXJJZH06Y3JlYXRlZGApO1xyXG4gICAgYXdhaXQgY2xlYXJFZmZlY3RzQnlQcmVmaXgoJ3BsYXllcicsIHBsYXllcklkLCAnJyk7XHJcbiAgICBcclxuICAgIC8vIDMuIFJlbW92ZSBsb2cgZW50cmllcyBmcm9tIHBsYXllciBsb2dcclxuICAgIGNvbnNvbGUubG9nKGBbcmVtb3ZlUGxheWVyRWZmZWN0c09uRGVsZXRlXSBTdGFydGluZyBsb2cgZW50cnkgcmVtb3ZhbCBmb3IgcGxheWVyOiAke3BsYXllcklkfWApO1xyXG4gICAgXHJcbiAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBDbGllbnRBUEkucmVtb3ZlTG9nRW50cnkoJ3BsYXllcicsIHBsYXllcklkKTtcclxuICAgIFxyXG4gICAgaWYgKHJlc3VsdC5zdWNjZXNzKSB7XHJcbiAgICAgIGNvbnNvbGUubG9nKGBbcmVtb3ZlUGxheWVyRWZmZWN0c09uRGVsZXRlXSDinIUgUGxheWVyIGxvZyBlbnRyaWVzIHJlbW92ZWQgc3VjY2Vzc2Z1bGx5IGZvciBwbGF5ZXI6ICR7cGxheWVySWR9YCk7XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICBjb25zb2xlLmVycm9yKGBbcmVtb3ZlUGxheWVyRWZmZWN0c09uRGVsZXRlXSBGYWlsZWQgdG8gcmVtb3ZlIHBsYXllciBsb2cgZW50cmllczogJHtyZXN1bHQubWVzc2FnZX1gKTtcclxuICAgIH1cclxuICAgIFxyXG4gICAgY29uc29sZS5sb2coYFtyZW1vdmVQbGF5ZXJFZmZlY3RzT25EZWxldGVdIOKchSBDbGVhcmVkIGVmZmVjdHMsIHJlbW92ZWQgbGlua3MsIGFuZCByZW1vdmVkIGxvZyBlbnRyaWVzIGZvciBwbGF5ZXIgJHtwbGF5ZXJJZH1gKTtcclxuICB9IGNhdGNoIChlcnJvcikge1xyXG4gICAgY29uc29sZS5lcnJvcignRXJyb3IgcmVtb3ZpbmcgcGxheWVyIGVmZmVjdHM6JywgZXJyb3IpO1xyXG4gIH1cclxufVxyXG5cclxuLyoqXHJcbiAqIExvZyBwbGF5ZXIgZWZmZWN0IGZyb20gdGFzayBjb21wbGV0aW9uXHJcbiAqIFRoaXMgbG9ncyB0aGUgcG9pbnRzIGF3YXJkZWQgdG8gdGhlIHBsYXllciBmcm9tIGNvbXBsZXRpbmcgYSB0YXNrXHJcbiAqL1xyXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gbG9nUGxheWVyRWZmZWN0KHRhc2s6IFRhc2spOiBQcm9taXNlPHZvaWQ+IHtcclxuICB0cnkge1xyXG4gICAgY29uc29sZS5sb2coYFtsb2dQbGF5ZXJFZmZlY3RdIExvZ2dpbmcgcGxheWVyIGVmZmVjdCBmb3IgdGFzazogJHt0YXNrLm5hbWV9ICgke3Rhc2suaWR9KWApO1xyXG4gICAgXHJcbiAgICAvLyBPbmx5IGxvZyBpZiB0aGVyZSBhcmUgcG9pbnRzIHRvIGF3YXJkXHJcbiAgICBjb25zdCBoYXNQb2ludHMgPSB0YXNrLnJld2FyZHM/LnBvaW50cyAmJiAoXHJcbiAgICAgICh0YXNrLnJld2FyZHMucG9pbnRzLnhwIHx8IDApID4gMCB8fFxyXG4gICAgICAodGFzay5yZXdhcmRzLnBvaW50cy5ycCB8fCAwKSA+IDAgfHxcclxuICAgICAgKHRhc2sucmV3YXJkcy5wb2ludHMuZnAgfHwgMCkgPiAwIHx8XHJcbiAgICAgICh0YXNrLnJld2FyZHMucG9pbnRzLmhwIHx8IDApID4gMFxyXG4gICAgKTtcclxuICAgIFxyXG4gICAgaWYgKCFoYXNQb2ludHMpIHtcclxuICAgICAgY29uc29sZS5sb2coJ1tsb2dQbGF5ZXJFZmZlY3RdIE5vIHBvaW50cyB0byBsb2csIHNraXBwaW5nJyk7XHJcbiAgICAgIHJldHVybjtcclxuICAgIH1cclxuICAgIFxyXG4gICAgLy8gR2V0IG1haW4gcGxheWVyIElEIChWMC4xIGNvbnN0YW50KVxyXG4gICAgY29uc3QgbWFpblBsYXllcklkID0gJ1BMQVlFUl9PTkVfSUQnO1xyXG4gICAgXHJcbiAgICBhd2FpdCBhcHBlbmRQbGF5ZXJQb2ludHNMb2coXHJcbiAgICAgIG1haW5QbGF5ZXJJZCxcclxuICAgICAge1xyXG4gICAgICAgIHhwOiB0YXNrLnJld2FyZHMucG9pbnRzLnhwIHx8IDAsXHJcbiAgICAgICAgcnA6IHRhc2sucmV3YXJkcy5wb2ludHMucnAgfHwgMCxcclxuICAgICAgICBmcDogdGFzay5yZXdhcmRzLnBvaW50cy5mcCB8fCAwLFxyXG4gICAgICAgIGhwOiB0YXNrLnJld2FyZHMucG9pbnRzLmhwIHx8IDBcclxuICAgICAgfSxcclxuICAgICAgdGFzay5pZCxcclxuICAgICAgJ3Rhc2snXHJcbiAgICApO1xyXG4gICAgXHJcbiAgICBjb25zb2xlLmxvZyhgW2xvZ1BsYXllckVmZmVjdF0g4pyFIFBsYXllciBlZmZlY3QgbG9nZ2VkIHN1Y2Nlc3NmdWxseSBmb3IgJHt0YXNrLm5hbWV9YCk7XHJcbiAgfSBjYXRjaCAoZXJyb3IpIHtcclxuICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGxvZ2dpbmcgcGxheWVyIGVmZmVjdDonLCBlcnJvcik7XHJcbiAgfVxyXG59XHJcblxyXG4vKipcclxuICogTG9nIHBsYXllciBlZmZlY3QgZnJvbSBmaW5hbmNpYWwgcmVjb3JkXHJcbiAqIFRoaXMgbG9ncyB0aGUgcG9pbnRzIGF3YXJkZWQgdG8gdGhlIHBsYXllciBmcm9tIGEgZmluYW5jaWFsIHJlY29yZFxyXG4gKi9cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGxvZ1BsYXllckVmZmVjdEZyb21SZWNvcmQocmVjb3JkOiBGaW5hbmNpYWxSZWNvcmQpOiBQcm9taXNlPHZvaWQ+IHtcclxuICB0cnkge1xyXG4gICAgY29uc29sZS5sb2coYFtsb2dQbGF5ZXJFZmZlY3RGcm9tUmVjb3JkXSBMb2dnaW5nIHBsYXllciBlZmZlY3QgZm9yIHJlY29yZDogJHtyZWNvcmQubmFtZX0gKCR7cmVjb3JkLmlkfSlgKTtcclxuICAgIFxyXG4gICAgLy8gT25seSBsb2cgaWYgdGhlcmUgYXJlIHBvaW50cyB0byBhd2FyZFxyXG4gICAgY29uc3QgaGFzUG9pbnRzID0gcmVjb3JkLnJld2FyZHM/LnBvaW50cyAmJiAoXHJcbiAgICAgIChyZWNvcmQucmV3YXJkcy5wb2ludHMueHAgfHwgMCkgPiAwIHx8XHJcbiAgICAgIChyZWNvcmQucmV3YXJkcy5wb2ludHMucnAgfHwgMCkgPiAwIHx8XHJcbiAgICAgIChyZWNvcmQucmV3YXJkcy5wb2ludHMuZnAgfHwgMCkgPiAwIHx8XHJcbiAgICAgIChyZWNvcmQucmV3YXJkcy5wb2ludHMuaHAgfHwgMCkgPiAwXHJcbiAgICApO1xyXG4gICAgXHJcbiAgICBpZiAoIWhhc1BvaW50cykge1xyXG4gICAgICBjb25zb2xlLmxvZygnW2xvZ1BsYXllckVmZmVjdEZyb21SZWNvcmRdIE5vIHBvaW50cyB0byBsb2csIHNraXBwaW5nJyk7XHJcbiAgICAgIHJldHVybjtcclxuICAgIH1cclxuICAgIFxyXG4gICAgLy8gR2V0IG1haW4gcGxheWVyIElEIChWMC4xIGNvbnN0YW50KVxyXG4gICAgY29uc3QgbWFpblBsYXllcklkID0gJ1BMQVlFUl9PTkVfSUQnO1xyXG4gICAgXHJcbiAgICBhd2FpdCBhcHBlbmRQbGF5ZXJQb2ludHNMb2coXHJcbiAgICAgIG1haW5QbGF5ZXJJZCxcclxuICAgICAge1xyXG4gICAgICAgIHhwOiByZWNvcmQucmV3YXJkcz8ucG9pbnRzPy54cCB8fCAwLFxyXG4gICAgICAgIHJwOiByZWNvcmQucmV3YXJkcz8ucG9pbnRzPy5ycCB8fCAwLFxyXG4gICAgICAgIGZwOiByZWNvcmQucmV3YXJkcz8ucG9pbnRzPy5mcCB8fCAwLFxyXG4gICAgICAgIGhwOiByZWNvcmQucmV3YXJkcz8ucG9pbnRzPy5ocCB8fCAwXHJcbiAgICAgIH0sXHJcbiAgICAgIHJlY29yZC5pZCxcclxuICAgICAgJ2ZpbmFuY2lhbCdcclxuICAgICk7XHJcbiAgICBcclxuICAgIGNvbnNvbGUubG9nKGBbbG9nUGxheWVyRWZmZWN0RnJvbVJlY29yZF0g4pyFIFBsYXllciBlZmZlY3QgbG9nZ2VkIHN1Y2Nlc3NmdWxseSBmb3IgJHtyZWNvcmQubmFtZX1gKTtcclxuICB9IGNhdGNoIChlcnJvcikge1xyXG4gICAgY29uc29sZS5lcnJvcignRXJyb3IgbG9nZ2luZyBwbGF5ZXIgZWZmZWN0IGZyb20gcmVjb3JkOicsIGVycm9yKTtcclxuICB9XHJcbn1cclxuXHJcbi8qKlxyXG4gKiBMb2cgcGxheWVyIHVwZGF0ZSBmcm9tIHRhc2sgY2hhbmdlc1xyXG4gKiBUaGlzIGxvZ3Mgd2hlbiB0YXNrIHJld2FyZHMgY2hhbmdlIGFuZCBwbGF5ZXIgcG9pbnRzIG5lZWQgdG8gYmUgdXBkYXRlZFxyXG4gKi9cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGxvZ1BsYXllclVwZGF0ZUZyb21UYXNrKHRhc2s6IFRhc2ssIG9sZFRhc2s6IFRhc2spOiBQcm9taXNlPHZvaWQ+IHtcclxuICB0cnkge1xyXG4gICAgY29uc29sZS5sb2coYFtsb2dQbGF5ZXJVcGRhdGVGcm9tVGFza10gTG9nZ2luZyBwbGF5ZXIgdXBkYXRlIGZvciB0YXNrOiAke3Rhc2submFtZX0gKCR7dGFzay5pZH0pYCk7XHJcbiAgICBcclxuICAgIGNvbnN0IG9sZFJld2FyZHMgPSBvbGRUYXNrLnJld2FyZHM/LnBvaW50cyB8fCB7IHhwOiAwLCBycDogMCwgZnA6IDAsIGhwOiAwIH07XHJcbiAgICBjb25zdCBuZXdSZXdhcmRzID0gdGFzay5yZXdhcmRzPy5wb2ludHMgfHwgeyB4cDogMCwgcnA6IDAsIGZwOiAwLCBocDogMCB9O1xyXG4gICAgXHJcbiAgICAvLyBDaGVjayBpZiByZXdhcmRzIGFjdHVhbGx5IGNoYW5nZWRcclxuICAgIGNvbnN0IHJld2FyZHNDaGFuZ2VkID0gSlNPTi5zdHJpbmdpZnkob2xkUmV3YXJkcykgIT09IEpTT04uc3RyaW5naWZ5KG5ld1Jld2FyZHMpO1xyXG4gICAgXHJcbiAgICBpZiAoIXJld2FyZHNDaGFuZ2VkKSB7XHJcbiAgICAgIGNvbnNvbGUubG9nKCdbbG9nUGxheWVyVXBkYXRlRnJvbVRhc2tdIE5vIHJld2FyZCBjaGFuZ2VzIHRvIGxvZywgc2tpcHBpbmcnKTtcclxuICAgICAgcmV0dXJuO1xyXG4gICAgfVxyXG4gICAgXHJcbiAgICAvLyBHZXQgbWFpbiBwbGF5ZXIgSUQgKFYwLjEgY29uc3RhbnQpXHJcbiAgICBjb25zdCBtYWluUGxheWVySWQgPSAnUExBWUVSX09ORV9JRCc7XHJcbiAgICBcclxuICAgIGF3YWl0IGFwcGVuZFBsYXllclBvaW50c1VwZGF0ZUxvZyhcclxuICAgICAgbWFpblBsYXllcklkLFxyXG4gICAgICB7XHJcbiAgICAgICAgeHA6IG9sZFJld2FyZHMueHAgfHwgMCxcclxuICAgICAgICBycDogb2xkUmV3YXJkcy5ycCB8fCAwLFxyXG4gICAgICAgIGZwOiBvbGRSZXdhcmRzLmZwIHx8IDAsXHJcbiAgICAgICAgaHA6IG9sZFJld2FyZHMuaHAgfHwgMFxyXG4gICAgICB9LFxyXG4gICAgICB7XHJcbiAgICAgICAgeHA6IG5ld1Jld2FyZHMueHAgfHwgMCxcclxuICAgICAgICBycDogbmV3UmV3YXJkcy5ycCB8fCAwLFxyXG4gICAgICAgIGZwOiBuZXdSZXdhcmRzLmZwIHx8IDAsXHJcbiAgICAgICAgaHA6IG5ld1Jld2FyZHMuaHAgfHwgMFxyXG4gICAgICB9LFxyXG4gICAgICB0YXNrLmlkXHJcbiAgICApO1xyXG4gICAgXHJcbiAgICBjb25zb2xlLmxvZyhgW2xvZ1BsYXllclVwZGF0ZUZyb21UYXNrXSDinIUgUGxheWVyIHVwZGF0ZSBsb2dnZWQgc3VjY2Vzc2Z1bGx5IGZvciAke3Rhc2submFtZX1gKTtcclxuICB9IGNhdGNoIChlcnJvcikge1xyXG4gICAgY29uc29sZS5lcnJvcignRXJyb3IgbG9nZ2luZyBwbGF5ZXIgdXBkYXRlIGZyb20gdGFzazonLCBlcnJvcik7XHJcbiAgfVxyXG59XHJcblxyXG4vKipcclxuICogVXBkYXRlIHBsYXllciBwb2ludHMgZnJvbSB0YXNrIGNoYW5nZXNcclxuICogVGhpcyB1cGRhdGVzIHRoZSBwbGF5ZXIncyBwb2ludHMgd2hlbiB0YXNrIHJld2FyZHMgY2hhbmdlXHJcbiAqL1xyXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gdXBkYXRlUGxheWVyUG9pbnRzRnJvbVRhc2sodGFzazogVGFzaywgb2xkVGFzazogVGFzayk6IFByb21pc2U8dm9pZD4ge1xyXG4gIHRyeSB7XHJcbiAgICBjb25zb2xlLmxvZyhgW3VwZGF0ZVBsYXllclBvaW50c0Zyb21UYXNrXSBVcGRhdGluZyBwbGF5ZXIgcG9pbnRzIGZvciB0YXNrOiAke3Rhc2submFtZX0gKCR7dGFzay5pZH0pYCk7XHJcbiAgICBcclxuICAgIGNvbnN0IG9sZFJld2FyZHMgPSBvbGRUYXNrLnJld2FyZHM/LnBvaW50cyB8fCB7IHhwOiAwLCBycDogMCwgZnA6IDAsIGhwOiAwIH07XHJcbiAgICBjb25zdCBuZXdSZXdhcmRzID0gdGFzay5yZXdhcmRzPy5wb2ludHMgfHwgeyB4cDogMCwgcnA6IDAsIGZwOiAwLCBocDogMCB9O1xyXG4gICAgXHJcbiAgICAvLyBDYWxjdWxhdGUgcG9pbnQgZGVsdGFcclxuICAgIGNvbnN0IGRlbHRhID0ge1xyXG4gICAgICB4cDogKG5ld1Jld2FyZHMueHAgfHwgMCkgLSAob2xkUmV3YXJkcy54cCB8fCAwKSxcclxuICAgICAgcnA6IChuZXdSZXdhcmRzLnJwIHx8IDApIC0gKG9sZFJld2FyZHMucnAgfHwgMCksXHJcbiAgICAgIGZwOiAobmV3UmV3YXJkcy5mcCB8fCAwKSAtIChvbGRSZXdhcmRzLmZwIHx8IDApLFxyXG4gICAgICBocDogKG5ld1Jld2FyZHMuaHAgfHwgMCkgLSAob2xkUmV3YXJkcy5ocCB8fCAwKVxyXG4gICAgfTtcclxuICAgIFxyXG4gICAgLy8gQ2hlY2sgaWYgdGhlcmUgYXJlIGFueSBjaGFuZ2VzXHJcbiAgICBjb25zdCBoYXNDaGFuZ2VzID0gZGVsdGEueHAgIT09IDAgfHwgZGVsdGEucnAgIT09IDAgfHwgZGVsdGEuZnAgIT09IDAgfHwgZGVsdGEuaHAgIT09IDA7XHJcbiAgICBcclxuICAgIGlmICghaGFzQ2hhbmdlcykge1xyXG4gICAgICBjb25zb2xlLmxvZygnW3VwZGF0ZVBsYXllclBvaW50c0Zyb21UYXNrXSBObyBwb2ludCBjaGFuZ2VzIHRvIGFwcGx5LCBza2lwcGluZycpO1xyXG4gICAgICByZXR1cm47XHJcbiAgICB9XHJcbiAgICBcclxuICAgIC8vIEdldCBtYWluIHBsYXllclxyXG4gICAgY29uc3QgbWFpblBsYXllcklkID0gJ1BMQVlFUl9PTkVfSUQnO1xyXG4gICAgY29uc3QgcGxheWVycyA9IGF3YWl0IENsaWVudEFQSS5nZXRQbGF5ZXJzKCk7XHJcbiAgICBjb25zdCBtYWluUGxheWVyID0gcGxheWVycy5maW5kKHAgPT4gcC5pZCA9PT0gbWFpblBsYXllcklkKTtcclxuICAgIFxyXG4gICAgaWYgKCFtYWluUGxheWVyKSB7XHJcbiAgICAgIGNvbnNvbGUubG9nKCdbdXBkYXRlUGxheWVyUG9pbnRzRnJvbVRhc2tdIE1haW4gcGxheWVyIG5vdCBmb3VuZCwgc2tpcHBpbmcnKTtcclxuICAgICAgcmV0dXJuO1xyXG4gICAgfVxyXG4gICAgXHJcbiAgICAvLyBBcHBseSBkZWx0YSB0byBwbGF5ZXIgcG9pbnRzXHJcbiAgICBjb25zdCB1cGRhdGVkUGxheWVyOiBQbGF5ZXIgPSB7XHJcbiAgICAgIC4uLm1haW5QbGF5ZXIsXHJcbiAgICAgIHBvaW50czoge1xyXG4gICAgICAgIHhwOiBNYXRoLm1heCgwLCAobWFpblBsYXllci5wb2ludHM/LnhwIHx8IDApICsgZGVsdGEueHApLFxyXG4gICAgICAgIHJwOiBNYXRoLm1heCgwLCAobWFpblBsYXllci5wb2ludHM/LnJwIHx8IDApICsgZGVsdGEucnApLFxyXG4gICAgICAgIGZwOiBNYXRoLm1heCgwLCAobWFpblBsYXllci5wb2ludHM/LmZwIHx8IDApICsgZGVsdGEuZnApLFxyXG4gICAgICAgIGhwOiBNYXRoLm1heCgwLCAobWFpblBsYXllci5wb2ludHM/LmhwIHx8IDApICsgZGVsdGEuaHApXHJcbiAgICAgIH0sXHJcbiAgICAgIHRvdGFsUG9pbnRzOiB7XHJcbiAgICAgICAgeHA6IE1hdGgubWF4KDAsIChtYWluUGxheWVyLnRvdGFsUG9pbnRzPy54cCB8fCAwKSArIGRlbHRhLnhwKSxcclxuICAgICAgICBycDogTWF0aC5tYXgoMCwgKG1haW5QbGF5ZXIudG90YWxQb2ludHM/LnJwIHx8IDApICsgZGVsdGEucnApLFxyXG4gICAgICAgIGZwOiBNYXRoLm1heCgwLCAobWFpblBsYXllci50b3RhbFBvaW50cz8uZnAgfHwgMCkgKyBkZWx0YS5mcCksXHJcbiAgICAgICAgaHA6IE1hdGgubWF4KDAsIChtYWluUGxheWVyLnRvdGFsUG9pbnRzPy5ocCB8fCAwKSArIGRlbHRhLmhwKVxyXG4gICAgICB9LFxyXG4gICAgICB1cGRhdGVkQXQ6IG5ldyBEYXRlKClcclxuICAgIH07XHJcbiAgICBcclxuICAgIC8vIFN0b3JlIHRoZSB1cGRhdGVkIHBsYXllclxyXG4gICAgY29uc29sZS5sb2coYFt1cGRhdGVQbGF5ZXJQb2ludHNGcm9tVGFza10gQXBwbHlpbmcgcG9pbnQgZGVsdGE6YCwgZGVsdGEpO1xyXG4gICAgYXdhaXQgQ2xpZW50QVBJLnVwc2VydFBsYXllcih1cGRhdGVkUGxheWVyKTtcclxuICAgIFxyXG4gICAgY29uc29sZS5sb2coYFt1cGRhdGVQbGF5ZXJQb2ludHNGcm9tVGFza10g4pyFIFBsYXllciBwb2ludHMgdXBkYXRlZCBzdWNjZXNzZnVsbHlgKTtcclxuICB9IGNhdGNoIChlcnJvcikge1xyXG4gICAgY29uc29sZS5lcnJvcignRXJyb3IgdXBkYXRpbmcgcGxheWVyIHBvaW50cyBmcm9tIHRhc2s6JywgZXJyb3IpO1xyXG4gIH1cclxufSJdLCJuYW1lcyI6WyJhcHBlbmRFbnRpdHlMb2ciLCJ1cGRhdGVFbnRpdHlMb2dGaWVsZCIsImhhc0VmZmVjdCIsIm1hcmtFZmZlY3QiLCJjbGVhckVmZmVjdCIsImNsZWFyRWZmZWN0c0J5UHJlZml4IiwiQ2xpZW50QVBJIiwiYXBwZW5kUGxheWVyUG9pbnRzTG9nIiwiYXBwZW5kUGxheWVyUG9pbnRzVXBkYXRlTG9nIiwiU1RBVEVfRklFTERTIiwiREVTQ1JJUFRJVkVfRklFTERTIiwib25QbGF5ZXJVcHNlcnQiLCJwbGF5ZXIiLCJwcmV2aW91c1BsYXllciIsImVmZmVjdEtleSIsImlkIiwibmFtZSIsImxldmVsIiwib2xkTGV2ZWwiLCJuZXdMZXZlbCIsInBvaW50c0NoYW5nZWQiLCJKU09OIiwic3RyaW5naWZ5IiwidG90YWxQb2ludHMiLCJwb2ludHMiLCJoYXNTaWduaWZpY2FudENoYW5nZXMiLCJpc0FjdGl2ZSIsImZpZWxkIiwicmVtb3ZlUGxheWVyRWZmZWN0c09uRGVsZXRlIiwicGxheWVySWQiLCJjb25zb2xlIiwibG9nIiwicGxheWVyTGlua3MiLCJnZXRMaW5rc0ZvciIsInR5cGUiLCJsZW5ndGgiLCJsaW5rIiwicmVtb3ZlTGluayIsImxpbmtUeXBlIiwiZXJyb3IiLCJyZXN1bHQiLCJyZW1vdmVMb2dFbnRyeSIsInN1Y2Nlc3MiLCJtZXNzYWdlIiwibG9nUGxheWVyRWZmZWN0IiwidGFzayIsImhhc1BvaW50cyIsInJld2FyZHMiLCJ4cCIsInJwIiwiZnAiLCJocCIsIm1haW5QbGF5ZXJJZCIsImxvZ1BsYXllckVmZmVjdEZyb21SZWNvcmQiLCJyZWNvcmQiLCJsb2dQbGF5ZXJVcGRhdGVGcm9tVGFzayIsIm9sZFRhc2siLCJvbGRSZXdhcmRzIiwibmV3UmV3YXJkcyIsInJld2FyZHNDaGFuZ2VkIiwidXBkYXRlUGxheWVyUG9pbnRzRnJvbVRhc2siLCJkZWx0YSIsImhhc0NoYW5nZXMiLCJwbGF5ZXJzIiwiZ2V0UGxheWVycyIsIm1haW5QbGF5ZXIiLCJmaW5kIiwicCIsInVwZGF0ZWRQbGF5ZXIiLCJNYXRoIiwibWF4IiwidXBkYXRlZEF0IiwiRGF0ZSIsInVwc2VydFBsYXllciJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./workflows/entities-workflows/player.workflow.ts\n");

/***/ }),

/***/ "(rsc)/./workflows/entities-workflows/sale.workflow.ts":
/*!*******************************************************!*\
  !*** ./workflows/entities-workflows/sale.workflow.ts ***!
  \*******************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   onSaleUpsert: () => (/* binding */ onSaleUpsert),\n/* harmony export */   removeSaleEffectsOnDelete: () => (/* binding */ removeSaleEffectsOnDelete)\n/* harmony export */ });\n/* harmony import */ var _entities_logging__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../entities-logging */ \"(rsc)/./workflows/entities-logging.ts\");\n/* harmony import */ var _data_store_effects_registry__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @/data-store/effects-registry */ \"(rsc)/./data-store/effects-registry.ts\");\n/* harmony import */ var _lib_client_api__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @/lib/client-api */ \"(rsc)/./lib/client-api.ts\");\n/* harmony import */ var _points_rewards_utils__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../points-rewards-utils */ \"(rsc)/./workflows/points-rewards-utils.ts\");\n/* harmony import */ var _sale_line_utils__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../sale-line-utils */ \"(rsc)/./workflows/sale-line-utils.ts\");\n/* harmony import */ var _update_propagation_utils__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../update-propagation-utils */ \"(rsc)/./workflows/update-propagation-utils.ts\");\n// workflows/entities-workflows/sale.workflow.ts\n// Sale-specific workflow with CHARGED, CANCELLED, COLLECTED events\n\n\n\n\n\n\nconst STATE_FIELDS = [\n    \"status\",\n    \"isNotPaid\",\n    \"isNotCharged\",\n    \"isCollected\",\n    \"postedAt\",\n    \"doneAt\",\n    \"cancelledAt\"\n];\nconst DESCRIPTIVE_FIELDS = [\n    \"counterpartyName\",\n    \"totals\"\n];\nasync function onSaleUpsert(sale, previousSale) {\n    // New sale creation\n    if (!previousSale) {\n        const effectKey = `sale:${sale.id}:created`;\n        if (await (0,_data_store_effects_registry__WEBPACK_IMPORTED_MODULE_1__.hasEffect)(effectKey)) return;\n        await (0,_entities_logging__WEBPACK_IMPORTED_MODULE_0__.appendEntityLog)(\"sale\", sale.id, \"CREATED\", {\n            type: sale.type,\n            status: sale.status,\n            counterpartyName: sale.counterpartyName,\n            totalRevenue: sale.totals.totalRevenue\n        });\n        await (0,_data_store_effects_registry__WEBPACK_IMPORTED_MODULE_1__.markEffect)(effectKey);\n        // Points awarding - on sale creation with revenue\n        if (sale.totals.totalRevenue > 0) {\n            const pointsEffectKey = `sale:${sale.id}:pointsAwarded`;\n            if (!await (0,_data_store_effects_registry__WEBPACK_IMPORTED_MODULE_1__.hasEffect)(pointsEffectKey)) {\n                console.log(`[onSaleUpsert] Awarding points from sale revenue: ${sale.counterpartyName}`);\n                const points = (0,_points_rewards_utils__WEBPACK_IMPORTED_MODULE_3__.calculatePointsFromRevenue)(sale.totals.totalRevenue);\n                await (0,_points_rewards_utils__WEBPACK_IMPORTED_MODULE_3__.awardPointsToPlayer)((0,_points_rewards_utils__WEBPACK_IMPORTED_MODULE_3__.getMainPlayerId)(), points, sale.id, \"sale\");\n                await (0,_data_store_effects_registry__WEBPACK_IMPORTED_MODULE_1__.markEffect)(pointsEffectKey);\n                console.log(`[onSaleUpsert] ✅ Points awarded and effect marked for sale: ${sale.counterpartyName}`);\n            }\n        }\n        return;\n    }\n    // Status changes\n    if (previousSale.status !== sale.status) {\n        if (sale.status === \"CHARGED\") {\n            await (0,_entities_logging__WEBPACK_IMPORTED_MODULE_0__.appendEntityLog)(\"sale\", sale.id, \"CHARGED\", {\n                counterpartyName: sale.counterpartyName,\n                totalRevenue: sale.totals.totalRevenue,\n                chargedAt: new Date().toISOString()\n            });\n            // Process sale lines when sale is charged\n            const linesProcessedKey = `sale:${sale.id}:linesProcessed`;\n            if (!await (0,_data_store_effects_registry__WEBPACK_IMPORTED_MODULE_1__.hasEffect)(linesProcessedKey)) {\n                console.log(`[onSaleUpsert] Processing sale lines for charged sale: ${sale.counterpartyName}`);\n                await (0,_sale_line_utils__WEBPACK_IMPORTED_MODULE_4__.processSaleLines)(sale);\n                await (0,_data_store_effects_registry__WEBPACK_IMPORTED_MODULE_1__.markEffect)(linesProcessedKey);\n                console.log(`[onSaleUpsert] ✅ Sale lines processed and effect marked: ${sale.counterpartyName}`);\n            }\n        } else if (sale.status === \"CANCELLED\") {\n            await (0,_entities_logging__WEBPACK_IMPORTED_MODULE_0__.appendEntityLog)(\"sale\", sale.id, \"CANCELLED\", {\n                counterpartyName: sale.counterpartyName,\n                cancelledAt: sale.cancelledAt || new Date().toISOString()\n            });\n        }\n    }\n    // Collection status - COLLECTED event\n    if (!previousSale.isCollected && sale.isCollected) {\n        await (0,_entities_logging__WEBPACK_IMPORTED_MODULE_0__.appendEntityLog)(\"sale\", sale.id, \"COLLECTED\", {\n            counterpartyName: sale.counterpartyName,\n            collectedAt: new Date().toISOString()\n        });\n    }\n    // COMPREHENSIVE UPDATE PROPAGATION - when sale properties change\n    if (previousSale) {\n        // Propagate to Financial Records\n        if ((0,_update_propagation_utils__WEBPACK_IMPORTED_MODULE_5__.hasRevenueChanged)(sale, previousSale)) {\n            console.log(`[onSaleUpsert] Propagating revenue changes to financial records: ${sale.counterpartyName}`);\n            await (0,_update_propagation_utils__WEBPACK_IMPORTED_MODULE_5__.updateFinancialRecordsFromSale)(sale, previousSale);\n        }\n        // Propagate to Items (stock updates)\n        if ((0,_update_propagation_utils__WEBPACK_IMPORTED_MODULE_5__.hasLinesChanged)(sale, previousSale)) {\n            console.log(`[onSaleUpsert] Propagating line changes to items: ${sale.counterpartyName}`);\n            await (0,_update_propagation_utils__WEBPACK_IMPORTED_MODULE_5__.updateItemsFromSale)(sale, previousSale);\n        }\n        // Propagate to Player (points delta from revenue)\n        if ((0,_update_propagation_utils__WEBPACK_IMPORTED_MODULE_5__.hasRevenueChanged)(sale, previousSale)) {\n            console.log(`[onSaleUpsert] Propagating revenue changes to player points: ${sale.counterpartyName}`);\n            await (0,_update_propagation_utils__WEBPACK_IMPORTED_MODULE_5__.updatePlayerPointsFromSource)(\"sale\", sale, previousSale);\n        }\n    }\n    // Descriptive changes - update in-place\n    for (const field of DESCRIPTIVE_FIELDS){\n        if (previousSale[field] !== sale[field]) {\n            await (0,_entities_logging__WEBPACK_IMPORTED_MODULE_0__.updateEntityLogField)(\"sale\", sale.id, field, previousSale[field], sale[field]);\n        }\n    }\n}\n/**\r\n * Remove sale effects when sale is deleted\r\n * Sales can have entries in multiple logs: sales, financials, character, items\r\n */ async function removeSaleEffectsOnDelete(saleId) {\n    try {\n        console.log(`[removeSaleEffectsOnDelete] Starting cleanup for sale: ${saleId}`);\n        // 1. Remove player points that were awarded by this sale (if points were badly given)\n        await removePlayerPointsFromSale(saleId);\n        // 2. Remove all Links related to this sale\n        const saleLinks = await _lib_client_api__WEBPACK_IMPORTED_MODULE_2__.ClientAPI.getLinksFor({\n            type: \"sale\",\n            id: saleId\n        });\n        console.log(`[removeSaleEffectsOnDelete] Found ${saleLinks.length} links to remove`);\n        for (const link of saleLinks){\n            try {\n                await _lib_client_api__WEBPACK_IMPORTED_MODULE_2__.ClientAPI.removeLink(link.id);\n                console.log(`[removeSaleEffectsOnDelete] ✅ Removed link: ${link.linkType}`);\n            } catch (error) {\n                console.error(`[removeSaleEffectsOnDelete] ❌ Failed to remove link ${link.id}:`, error);\n            }\n        }\n        // 3. Clear effects registry\n        await (0,_data_store_effects_registry__WEBPACK_IMPORTED_MODULE_1__.clearEffectsByPrefix)(\"sale\", saleId, \"sale:\");\n        await (0,_data_store_effects_registry__WEBPACK_IMPORTED_MODULE_1__.clearEffectsByPrefix)(\"sale\", saleId, \"pointsAwarded:\");\n        // 4. Remove log entries from all relevant logs\n        console.log(`[removeSaleEffectsOnDelete] Starting log entry removal for sale: ${saleId}`);\n        const removals = await Promise.all([\n            _lib_client_api__WEBPACK_IMPORTED_MODULE_2__.ClientAPI.removeLogEntry(\"sales\", saleId).then((r)=>{\n                console.log(`[removeSaleEffectsOnDelete] Sales log removal result:`, r);\n                return r;\n            }).catch((e)=>({\n                    success: false,\n                    message: String(e)\n                })),\n            _lib_client_api__WEBPACK_IMPORTED_MODULE_2__.ClientAPI.removeLogEntry(\"financials\", saleId).then((r)=>{\n                console.log(`[removeSaleEffectsOnDelete] Financials log removal result:`, r);\n                return r;\n            }).catch((e)=>({\n                    success: false,\n                    message: String(e)\n                })),\n            _lib_client_api__WEBPACK_IMPORTED_MODULE_2__.ClientAPI.removeLogEntry(\"character\", saleId).then((r)=>{\n                console.log(`[removeSaleEffectsOnDelete] Character log removal result:`, r);\n                return r;\n            }).catch((e)=>({\n                    success: false,\n                    message: String(e)\n                })),\n            _lib_client_api__WEBPACK_IMPORTED_MODULE_2__.ClientAPI.removeLogEntry(\"items\", saleId).then((r)=>{\n                console.log(`[removeSaleEffectsOnDelete] Items log removal result:`, r);\n                return r;\n            }).catch((e)=>({\n                    success: false,\n                    message: String(e)\n                }))\n        ]);\n        console.log(`[removeSaleEffectsOnDelete] All removal results:`, removals);\n        const failed = removals.filter((r)=>!r.success);\n        if (failed.length > 0) {\n            console.error(\"[removeSaleEffectsOnDelete] Some log removals failed:\", failed);\n        } else {\n            console.log(`[removeSaleEffectsOnDelete] ✅ All log entries removed successfully for sale: ${saleId}`);\n        }\n        console.log(`[removeSaleEffectsOnDelete] ✅ Cleared effects, removed links, and removed log entries for sale ${saleId}`);\n    } catch (error) {\n        console.error(\"Error removing sale effects:\", error);\n    }\n}\n/**\r\n * Remove player points that were awarded by a specific sale\r\n * This is used when rolling back a sale that incorrectly awarded points\r\n */ async function removePlayerPointsFromSale(saleId) {\n    try {\n        console.log(`[removePlayerPointsFromSale] Removing points for sale: ${saleId}`);\n        // Get the sale to find what points were awarded\n        const sales = await _lib_client_api__WEBPACK_IMPORTED_MODULE_2__.ClientAPI.getSales();\n        const sale = sales.find((s)=>s.id === saleId);\n        if (!sale || sale.totals.totalRevenue <= 0) {\n            console.log(`[removePlayerPointsFromSale] Sale ${saleId} has no revenue to remove points from`);\n            return;\n        }\n        // Get the main player\n        const mainPlayerId = (0,_points_rewards_utils__WEBPACK_IMPORTED_MODULE_3__.getMainPlayerId)();\n        const players = await _lib_client_api__WEBPACK_IMPORTED_MODULE_2__.ClientAPI.getPlayers();\n        const mainPlayer = players.find((p)=>p.id === mainPlayerId);\n        if (!mainPlayer) {\n            console.log(`[removePlayerPointsFromSale] Main player not found, skipping points removal`);\n            return;\n        }\n        // Calculate points to remove based on sale revenue (1 Point = $100)\n        const pointsToRemove = (0,_points_rewards_utils__WEBPACK_IMPORTED_MODULE_3__.calculatePointsFromRevenue)(sale.totals.totalRevenue);\n        // Check if any points were actually awarded\n        const hasPoints = (pointsToRemove.xp || 0) > 0 || (pointsToRemove.rp || 0) > 0 || (pointsToRemove.fp || 0) > 0 || (pointsToRemove.hp || 0) > 0;\n        if (!hasPoints) {\n            console.log(`[removePlayerPointsFromSale] No points to remove from sale ${saleId} (revenue: ${sale.totals.totalRevenue})`);\n            return;\n        }\n        // Remove the points from the player\n        await (0,_points_rewards_utils__WEBPACK_IMPORTED_MODULE_3__.removePointsFromPlayer)(mainPlayerId, pointsToRemove);\n        console.log(`[removePlayerPointsFromSale] ✅ Removed points from player: ${JSON.stringify(pointsToRemove)} (sale revenue: ${sale.totals.totalRevenue})`);\n    } catch (error) {\n        console.error(`[removePlayerPointsFromSale] ❌ Failed to remove player points for sale ${saleId}:`, error);\n    }\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi93b3JrZmxvd3MvZW50aXRpZXMtd29ya2Zsb3dzL3NhbGUud29ya2Zsb3cudHMiLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7QUFBQSxnREFBZ0Q7QUFDaEQsbUVBQW1FO0FBR1M7QUFDZ0I7QUFDL0M7QUFDc0Y7QUFDN0U7QUFPakI7QUFFckMsTUFBTWdCLGVBQWU7SUFBQztJQUFVO0lBQWE7SUFBZ0I7SUFBZTtJQUFZO0lBQVU7Q0FBYztBQUNoSCxNQUFNQyxxQkFBcUI7SUFBQztJQUFvQjtDQUFTO0FBRWxELGVBQWVDLGFBQWFDLElBQVUsRUFBRUMsWUFBbUI7SUFDaEUsb0JBQW9CO0lBQ3BCLElBQUksQ0FBQ0EsY0FBYztRQUNqQixNQUFNQyxZQUFZLENBQUMsS0FBSyxFQUFFRixLQUFLRyxFQUFFLENBQUMsUUFBUSxDQUFDO1FBQzNDLElBQUksTUFBTXBCLHVFQUFTQSxDQUFDbUIsWUFBWTtRQUVoQyxNQUFNckIsa0VBQWVBLENBQUMsUUFBUW1CLEtBQUtHLEVBQUUsRUFBRSxXQUFXO1lBQ2hEQyxNQUFNSixLQUFLSSxJQUFJO1lBQ2ZDLFFBQVFMLEtBQUtLLE1BQU07WUFDbkJDLGtCQUFrQk4sS0FBS00sZ0JBQWdCO1lBQ3ZDQyxjQUFjUCxLQUFLUSxNQUFNLENBQUNELFlBQVk7UUFDeEM7UUFDQSxNQUFNdkIsd0VBQVVBLENBQUNrQjtRQUVqQixrREFBa0Q7UUFDbEQsSUFBSUYsS0FBS1EsTUFBTSxDQUFDRCxZQUFZLEdBQUcsR0FBRztZQUNoQyxNQUFNRSxrQkFBa0IsQ0FBQyxLQUFLLEVBQUVULEtBQUtHLEVBQUUsQ0FBQyxjQUFjLENBQUM7WUFDdkQsSUFBSSxDQUFFLE1BQU1wQix1RUFBU0EsQ0FBQzBCLGtCQUFtQjtnQkFDdkNDLFFBQVFDLEdBQUcsQ0FBQyxDQUFDLGtEQUFrRCxFQUFFWCxLQUFLTSxnQkFBZ0IsQ0FBQyxDQUFDO2dCQUN4RixNQUFNTSxTQUFTdkIsaUZBQTBCQSxDQUFDVyxLQUFLUSxNQUFNLENBQUNELFlBQVk7Z0JB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QyxHQUFHLENBQUMsQ0FBQywyREFBMkQsRUFBRVcsT0FBTyxXQUFXLEVBQUV0QixLQUFLUSxNQUFNLENBQUNELFlBQVksQ0FBQyxDQUFDLENBQUM7WUFDekg7UUFDRjtRQUVBLG9DQUFvQztRQUNwQyxNQUFNbkIsNkVBQXNCQSxDQUFDNEQsY0FBY0s7UUFDM0MzQyxRQUFRQyxHQUFHLENBQUMsQ0FBQywyREFBMkQsRUFBRWdELEtBQUtDLFNBQVMsQ0FBQ1AsZ0JBQWdCLGdCQUFnQixFQUFFckQsS0FBS1EsTUFBTSxDQUFDRCxZQUFZLENBQUMsQ0FBQyxDQUFDO0lBRXhKLEVBQUUsT0FBT3VCLE9BQU87UUFDZHBCLFFBQVFvQixLQUFLLENBQUMsQ0FBQyx1RUFBdUUsRUFBRVIsT0FBTyxDQUFDLENBQUMsRUFBRVE7SUFDckc7QUFDRiIsInNvdXJjZXMiOlsid2VicGFjazovL3RoZWdhbWUtYWRtaW4vLi93b3JrZmxvd3MvZW50aXRpZXMtd29ya2Zsb3dzL3NhbGUud29ya2Zsb3cudHM/MmY0OCJdLCJzb3VyY2VzQ29udGVudCI6WyIvLyB3b3JrZmxvd3MvZW50aXRpZXMtd29ya2Zsb3dzL3NhbGUud29ya2Zsb3cudHNcclxuLy8gU2FsZS1zcGVjaWZpYyB3b3JrZmxvdyB3aXRoIENIQVJHRUQsIENBTkNFTExFRCwgQ09MTEVDVEVEIGV2ZW50c1xyXG5cclxuaW1wb3J0IHR5cGUgeyBTYWxlIH0gZnJvbSAnQC90eXBlcy9lbnRpdGllcyc7XHJcbmltcG9ydCB7IGFwcGVuZEVudGl0eUxvZywgdXBkYXRlRW50aXR5TG9nRmllbGQgfSBmcm9tICcuLi9lbnRpdGllcy1sb2dnaW5nJztcclxuaW1wb3J0IHsgaGFzRWZmZWN0LCBtYXJrRWZmZWN0LCBjbGVhckVmZmVjdHNCeVByZWZpeCB9IGZyb20gJ0AvZGF0YS1zdG9yZS9lZmZlY3RzLXJlZ2lzdHJ5JztcclxuaW1wb3J0IHsgQ2xpZW50QVBJIH0gZnJvbSAnQC9saWIvY2xpZW50LWFwaSc7XHJcbmltcG9ydCB7IGF3YXJkUG9pbnRzVG9QbGF5ZXIsIHJlbW92ZVBvaW50c0Zyb21QbGF5ZXIsIGNhbGN1bGF0ZVBvaW50c0Zyb21SZXZlbnVlLCBnZXRNYWluUGxheWVySWQgfSBmcm9tICcuLi9wb2ludHMtcmV3YXJkcy11dGlscyc7XHJcbmltcG9ydCB7IHByb2Nlc3NTYWxlTGluZXMgfSBmcm9tICcuLi9zYWxlLWxpbmUtdXRpbHMnO1xyXG5pbXBvcnQgeyBcclxuICB1cGRhdGVGaW5hbmNpYWxSZWNvcmRzRnJvbVNhbGUsIFxyXG4gIHVwZGF0ZUl0ZW1zRnJvbVNhbGUsIFxyXG4gIHVwZGF0ZVBsYXllclBvaW50c0Zyb21Tb3VyY2UsXHJcbiAgaGFzUmV2ZW51ZUNoYW5nZWQsXHJcbiAgaGFzTGluZXNDaGFuZ2VkXHJcbn0gZnJvbSAnLi4vdXBkYXRlLXByb3BhZ2F0aW9uLXV0aWxzJztcclxuXHJcbmNvbnN0IFNUQVRFX0ZJRUxEUyA9IFsnc3RhdHVzJywgJ2lzTm90UGFpZCcsICdpc05vdENoYXJnZWQnLCAnaXNDb2xsZWN0ZWQnLCAncG9zdGVkQXQnLCAnZG9uZUF0JywgJ2NhbmNlbGxlZEF0J107XHJcbmNvbnN0IERFU0NSSVBUSVZFX0ZJRUxEUyA9IFsnY291bnRlcnBhcnR5TmFtZScsICd0b3RhbHMnXTtcclxuXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBvblNhbGVVcHNlcnQoc2FsZTogU2FsZSwgcHJldmlvdXNTYWxlPzogU2FsZSk6IFByb21pc2U8dm9pZD4ge1xyXG4gIC8vIE5ldyBzYWxlIGNyZWF0aW9uXHJcbiAgaWYgKCFwcmV2aW91c1NhbGUpIHtcclxuICAgIGNvbnN0IGVmZmVjdEtleSA9IGBzYWxlOiR7c2FsZS5pZH06Y3JlYXRlZGA7XHJcbiAgICBpZiAoYXdhaXQgaGFzRWZmZWN0KGVmZmVjdEtleSkpIHJldHVybjtcclxuICAgIFxyXG4gICAgYXdhaXQgYXBwZW5kRW50aXR5TG9nKCdzYWxlJywgc2FsZS5pZCwgJ0NSRUFURUQnLCB7IFxyXG4gICAgICB0eXBlOiBzYWxlLnR5cGUsXHJcbiAgICAgIHN0YXR1czogc2FsZS5zdGF0dXMsXHJcbiAgICAgIGNvdW50ZXJwYXJ0eU5hbWU6IHNhbGUuY291bnRlcnBhcnR5TmFtZSxcclxuICAgICAgdG90YWxSZXZlbnVlOiBzYWxlLnRvdGFscy50b3RhbFJldmVudWVcclxuICAgIH0pO1xyXG4gICAgYXdhaXQgbWFya0VmZmVjdChlZmZlY3RLZXkpO1xyXG4gICAgXHJcbiAgICAvLyBQb2ludHMgYXdhcmRpbmcgLSBvbiBzYWxlIGNyZWF0aW9uIHdpdGggcmV2ZW51ZVxyXG4gICAgaWYgKHNhbGUudG90YWxzLnRvdGFsUmV2ZW51ZSA+IDApIHtcclxuICAgICAgY29uc3QgcG9pbnRzRWZmZWN0S2V5ID0gYHNhbGU6JHtzYWxlLmlkfTpwb2ludHNBd2FyZGVkYDtcclxuICAgICAgaWYgKCEoYXdhaXQgaGFzRWZmZWN0KHBvaW50c0VmZmVjdEtleSkpKSB7XHJcbiAgICAgICAgY29uc29sZS5sb2coYFtvblNhbGVVcHNlcnRdIEF3YXJkaW5nIHBvaW50cyBmcm9tIHNhbGUgcmV2ZW51ZTogJHtzYWxlLmNvdW50ZXJwYXJ0eU5hbWV9YCk7XHJcbiAgICAgICAgY29uc3QgcG9pbnRzID0gY2FsY3VsYXRlUG9pbnRzRnJvbVJldmVudWUoc2FsZS50b3RhbHMudG90YWxSZXZlbnVlKTtcclxuICAgICAgICBhd2FpdCBhd2FyZFBvaW50c1RvUGxheWVyKGdldE1haW5QbGF5ZXJJZCgpLCBwb2ludHMsIHNhbGUuaWQsICdzYWxlJyk7XHJcbiAgICAgICAgYXdhaXQgbWFya0VmZmVjdChwb2ludHNFZmZlY3RLZXkpO1xyXG4gICAgICAgIGNvbnNvbGUubG9nKGBbb25TYWxlVXBzZXJ0XSDinIUgUG9pbnRzIGF3YXJkZWQgYW5kIGVmZmVjdCBtYXJrZWQgZm9yIHNhbGU6ICR7c2FsZS5jb3VudGVycGFydHlOYW1lfWApO1xyXG4gICAgICB9XHJcbiAgICB9XHJcbiAgICBcclxuICAgIHJldHVybjtcclxuICB9XHJcbiAgXHJcbiAgLy8gU3RhdHVzIGNoYW5nZXNcclxuICBpZiAocHJldmlvdXNTYWxlLnN0YXR1cyAhPT0gc2FsZS5zdGF0dXMpIHtcclxuICAgIGlmIChzYWxlLnN0YXR1cyA9PT0gJ0NIQVJHRUQnKSB7XHJcbiAgICAgIGF3YWl0IGFwcGVuZEVudGl0eUxvZygnc2FsZScsIHNhbGUuaWQsICdDSEFSR0VEJywge1xyXG4gICAgICAgIGNvdW50ZXJwYXJ0eU5hbWU6IHNhbGUuY291bnRlcnBhcnR5TmFtZSxcclxuICAgICAgICB0b3RhbFJldmVudWU6IHNhbGUudG90YWxzLnRvdGFsUmV2ZW51ZSxcclxuICAgICAgICBjaGFyZ2VkQXQ6IG5ldyBEYXRlKCkudG9JU09TdHJpbmcoKVxyXG4gICAgICB9KTtcclxuICAgICAgXHJcbiAgICAgIC8vIFByb2Nlc3Mgc2FsZSBsaW5lcyB3aGVuIHNhbGUgaXMgY2hhcmdlZFxyXG4gICAgICBjb25zdCBsaW5lc1Byb2Nlc3NlZEtleSA9IGBzYWxlOiR7c2FsZS5pZH06bGluZXNQcm9jZXNzZWRgO1xyXG4gICAgICBpZiAoIShhd2FpdCBoYXNFZmZlY3QobGluZXNQcm9jZXNzZWRLZXkpKSkge1xyXG4gICAgICAgIGNvbnNvbGUubG9nKGBbb25TYWxlVXBzZXJ0XSBQcm9jZXNzaW5nIHNhbGUgbGluZXMgZm9yIGNoYXJnZWQgc2FsZTogJHtzYWxlLmNvdW50ZXJwYXJ0eU5hbWV9YCk7XHJcbiAgICAgICAgYXdhaXQgcHJvY2Vzc1NhbGVMaW5lcyhzYWxlKTtcclxuICAgICAgICBhd2FpdCBtYXJrRWZmZWN0KGxpbmVzUHJvY2Vzc2VkS2V5KTtcclxuICAgICAgICBjb25zb2xlLmxvZyhgW29uU2FsZVVwc2VydF0g4pyFIFNhbGUgbGluZXMgcHJvY2Vzc2VkIGFuZCBlZmZlY3QgbWFya2VkOiAke3NhbGUuY291bnRlcnBhcnR5TmFtZX1gKTtcclxuICAgICAgfVxyXG4gICAgfSBlbHNlIGlmIChzYWxlLnN0YXR1cyA9PT0gJ0NBTkNFTExFRCcpIHtcclxuICAgICAgYXdhaXQgYXBwZW5kRW50aXR5TG9nKCdzYWxlJywgc2FsZS5pZCwgJ0NBTkNFTExFRCcsIHtcclxuICAgICAgICBjb3VudGVycGFydHlOYW1lOiBzYWxlLmNvdW50ZXJwYXJ0eU5hbWUsXHJcbiAgICAgICAgY2FuY2VsbGVkQXQ6IHNhbGUuY2FuY2VsbGVkQXQgfHwgbmV3IERhdGUoKS50b0lTT1N0cmluZygpXHJcbiAgICAgIH0pO1xyXG4gICAgfVxyXG4gIH1cclxuICBcclxuICAvLyBDb2xsZWN0aW9uIHN0YXR1cyAtIENPTExFQ1RFRCBldmVudFxyXG4gIGlmICghcHJldmlvdXNTYWxlLmlzQ29sbGVjdGVkICYmIHNhbGUuaXNDb2xsZWN0ZWQpIHtcclxuICAgIGF3YWl0IGFwcGVuZEVudGl0eUxvZygnc2FsZScsIHNhbGUuaWQsICdDT0xMRUNURUQnLCB7XHJcbiAgICAgIGNvdW50ZXJwYXJ0eU5hbWU6IHNhbGUuY291bnRlcnBhcnR5TmFtZSxcclxuICAgICAgY29sbGVjdGVkQXQ6IG5ldyBEYXRlKCkudG9JU09TdHJpbmcoKVxyXG4gICAgfSk7XHJcbiAgfVxyXG4gIFxyXG4gIC8vIENPTVBSRUhFTlNJVkUgVVBEQVRFIFBST1BBR0FUSU9OIC0gd2hlbiBzYWxlIHByb3BlcnRpZXMgY2hhbmdlXHJcbiAgaWYgKHByZXZpb3VzU2FsZSkge1xyXG4gICAgLy8gUHJvcGFnYXRlIHRvIEZpbmFuY2lhbCBSZWNvcmRzXHJcbiAgICBpZiAoaGFzUmV2ZW51ZUNoYW5nZWQoc2FsZSwgcHJldmlvdXNTYWxlKSkge1xyXG4gICAgICBjb25zb2xlLmxvZyhgW29uU2FsZVVwc2VydF0gUHJvcGFnYXRpbmcgcmV2ZW51ZSBjaGFuZ2VzIHRvIGZpbmFuY2lhbCByZWNvcmRzOiAke3NhbGUuY291bnRlcnBhcnR5TmFtZX1gKTtcclxuICAgICAgYXdhaXQgdXBkYXRlRmluYW5jaWFsUmVjb3Jkc0Zyb21TYWxlKHNhbGUsIHByZXZpb3VzU2FsZSk7XHJcbiAgICB9XHJcbiAgICBcclxuICAgIC8vIFByb3BhZ2F0ZSB0byBJdGVtcyAoc3RvY2sgdXBkYXRlcylcclxuICAgIGlmIChoYXNMaW5lc0NoYW5nZWQoc2FsZSwgcHJldmlvdXNTYWxlKSkge1xyXG4gICAgICBjb25zb2xlLmxvZyhgW29uU2FsZVVwc2VydF0gUHJvcGFnYXRpbmcgbGluZSBjaGFuZ2VzIHRvIGl0ZW1zOiAke3NhbGUuY291bnRlcnBhcnR5TmFtZX1gKTtcclxuICAgICAgYXdhaXQgdXBkYXRlSXRlbXNGcm9tU2FsZShzYWxlLCBwcmV2aW91c1NhbGUpO1xyXG4gICAgfVxyXG4gICAgXHJcbiAgICAvLyBQcm9wYWdhdGUgdG8gUGxheWVyIChwb2ludHMgZGVsdGEgZnJvbSByZXZlbnVlKVxyXG4gICAgaWYgKGhhc1JldmVudWVDaGFuZ2VkKHNhbGUsIHByZXZpb3VzU2FsZSkpIHtcclxuICAgICAgY29uc29sZS5sb2coYFtvblNhbGVVcHNlcnRdIFByb3BhZ2F0aW5nIHJldmVudWUgY2hhbmdlcyB0byBwbGF5ZXIgcG9pbnRzOiAke3NhbGUuY291bnRlcnBhcnR5TmFtZX1gKTtcclxuICAgICAgYXdhaXQgdXBkYXRlUGxheWVyUG9pbnRzRnJvbVNvdXJjZSgnc2FsZScsIHNhbGUsIHByZXZpb3VzU2FsZSk7XHJcbiAgICB9XHJcbiAgfVxyXG4gIFxyXG4gIC8vIERlc2NyaXB0aXZlIGNoYW5nZXMgLSB1cGRhdGUgaW4tcGxhY2VcclxuICBmb3IgKGNvbnN0IGZpZWxkIG9mIERFU0NSSVBUSVZFX0ZJRUxEUykge1xyXG4gICAgaWYgKChwcmV2aW91c1NhbGUgYXMgYW55KVtmaWVsZF0gIT09IChzYWxlIGFzIGFueSlbZmllbGRdKSB7XHJcbiAgICAgIGF3YWl0IHVwZGF0ZUVudGl0eUxvZ0ZpZWxkKCdzYWxlJywgc2FsZS5pZCwgZmllbGQsIChwcmV2aW91c1NhbGUgYXMgYW55KVtmaWVsZF0sIChzYWxlIGFzIGFueSlbZmllbGRdKTtcclxuICAgIH1cclxuICB9XHJcbn1cclxuXHJcbi8qKlxyXG4gKiBSZW1vdmUgc2FsZSBlZmZlY3RzIHdoZW4gc2FsZSBpcyBkZWxldGVkXHJcbiAqIFNhbGVzIGNhbiBoYXZlIGVudHJpZXMgaW4gbXVsdGlwbGUgbG9nczogc2FsZXMsIGZpbmFuY2lhbHMsIGNoYXJhY3RlciwgaXRlbXNcclxuICovXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiByZW1vdmVTYWxlRWZmZWN0c09uRGVsZXRlKHNhbGVJZDogc3RyaW5nKTogUHJvbWlzZTx2b2lkPiB7XHJcbiAgdHJ5IHtcclxuICAgIGNvbnNvbGUubG9nKGBbcmVtb3ZlU2FsZUVmZmVjdHNPbkRlbGV0ZV0gU3RhcnRpbmcgY2xlYW51cCBmb3Igc2FsZTogJHtzYWxlSWR9YCk7XHJcbiAgICBcclxuICAgIC8vIDEuIFJlbW92ZSBwbGF5ZXIgcG9pbnRzIHRoYXQgd2VyZSBhd2FyZGVkIGJ5IHRoaXMgc2FsZSAoaWYgcG9pbnRzIHdlcmUgYmFkbHkgZ2l2ZW4pXHJcbiAgICBhd2FpdCByZW1vdmVQbGF5ZXJQb2ludHNGcm9tU2FsZShzYWxlSWQpO1xyXG4gICAgXHJcbiAgICAvLyAyLiBSZW1vdmUgYWxsIExpbmtzIHJlbGF0ZWQgdG8gdGhpcyBzYWxlXHJcbiAgICBjb25zdCBzYWxlTGlua3MgPSBhd2FpdCBDbGllbnRBUEkuZ2V0TGlua3NGb3IoeyB0eXBlOiAnc2FsZScsIGlkOiBzYWxlSWQgfSk7XHJcbiAgICBjb25zb2xlLmxvZyhgW3JlbW92ZVNhbGVFZmZlY3RzT25EZWxldGVdIEZvdW5kICR7c2FsZUxpbmtzLmxlbmd0aH0gbGlua3MgdG8gcmVtb3ZlYCk7XHJcbiAgICBcclxuICAgIGZvciAoY29uc3QgbGluayBvZiBzYWxlTGlua3MpIHtcclxuICAgICAgdHJ5IHtcclxuICAgICAgICBhd2FpdCBDbGllbnRBUEkucmVtb3ZlTGluayhsaW5rLmlkKTtcclxuICAgICAgICBjb25zb2xlLmxvZyhgW3JlbW92ZVNhbGVFZmZlY3RzT25EZWxldGVdIOKchSBSZW1vdmVkIGxpbms6ICR7bGluay5saW5rVHlwZX1gKTtcclxuICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcclxuICAgICAgICBjb25zb2xlLmVycm9yKGBbcmVtb3ZlU2FsZUVmZmVjdHNPbkRlbGV0ZV0g4p2MIEZhaWxlZCB0byByZW1vdmUgbGluayAke2xpbmsuaWR9OmAsIGVycm9yKTtcclxuICAgICAgfVxyXG4gICAgfVxyXG4gICAgXHJcbiAgICAvLyAzLiBDbGVhciBlZmZlY3RzIHJlZ2lzdHJ5XHJcbiAgICBhd2FpdCBjbGVhckVmZmVjdHNCeVByZWZpeCgnc2FsZScsIHNhbGVJZCwgJ3NhbGU6Jyk7XHJcbiAgICBhd2FpdCBjbGVhckVmZmVjdHNCeVByZWZpeCgnc2FsZScsIHNhbGVJZCwgJ3BvaW50c0F3YXJkZWQ6Jyk7XHJcbiAgICBcclxuICAgIC8vIDQuIFJlbW92ZSBsb2cgZW50cmllcyBmcm9tIGFsbCByZWxldmFudCBsb2dzXHJcbiAgICBjb25zb2xlLmxvZyhgW3JlbW92ZVNhbGVFZmZlY3RzT25EZWxldGVdIFN0YXJ0aW5nIGxvZyBlbnRyeSByZW1vdmFsIGZvciBzYWxlOiAke3NhbGVJZH1gKTtcclxuICAgIFxyXG4gICAgY29uc3QgcmVtb3ZhbHMgPSBhd2FpdCBQcm9taXNlLmFsbChbXHJcbiAgICAgIENsaWVudEFQSS5yZW1vdmVMb2dFbnRyeSgnc2FsZXMnLCBzYWxlSWQpLnRoZW4ociA9PiB7IGNvbnNvbGUubG9nKGBbcmVtb3ZlU2FsZUVmZmVjdHNPbkRlbGV0ZV0gU2FsZXMgbG9nIHJlbW92YWwgcmVzdWx0OmAsIHIpOyByZXR1cm4gcjsgfSkuY2F0Y2goZSA9PiAoeyBzdWNjZXNzOiBmYWxzZSwgbWVzc2FnZTogU3RyaW5nKGUpIH0pKSxcclxuICAgICAgQ2xpZW50QVBJLnJlbW92ZUxvZ0VudHJ5KCdmaW5hbmNpYWxzJywgc2FsZUlkKS50aGVuKHIgPT4geyBjb25zb2xlLmxvZyhgW3JlbW92ZVNhbGVFZmZlY3RzT25EZWxldGVdIEZpbmFuY2lhbHMgbG9nIHJlbW92YWwgcmVzdWx0OmAsIHIpOyByZXR1cm4gcjsgfSkuY2F0Y2goZSA9PiAoeyBzdWNjZXNzOiBmYWxzZSwgbWVzc2FnZTogU3RyaW5nKGUpIH0pKSxcclxuICAgICAgQ2xpZW50QVBJLnJlbW92ZUxvZ0VudHJ5KCdjaGFyYWN0ZXInLCBzYWxlSWQpLnRoZW4ociA9PiB7IGNvbnNvbGUubG9nKGBbcmVtb3ZlU2FsZUVmZmVjdHNPbkRlbGV0ZV0gQ2hhcmFjdGVyIGxvZyByZW1vdmFsIHJlc3VsdDpgLCByKTsgcmV0dXJuIHI7IH0pLmNhdGNoKGUgPT4gKHsgc3VjY2VzczogZmFsc2UsIG1lc3NhZ2U6IFN0cmluZyhlKSB9KSksXHJcbiAgICAgIENsaWVudEFQSS5yZW1vdmVMb2dFbnRyeSgnaXRlbXMnLCBzYWxlSWQpLnRoZW4ociA9PiB7IGNvbnNvbGUubG9nKGBbcmVtb3ZlU2FsZUVmZmVjdHNPbkRlbGV0ZV0gSXRlbXMgbG9nIHJlbW92YWwgcmVzdWx0OmAsIHIpOyByZXR1cm4gcjsgfSkuY2F0Y2goZSA9PiAoeyBzdWNjZXNzOiBmYWxzZSwgbWVzc2FnZTogU3RyaW5nKGUpIH0pKSxcclxuICAgIF0pO1xyXG5cclxuICAgIGNvbnNvbGUubG9nKGBbcmVtb3ZlU2FsZUVmZmVjdHNPbkRlbGV0ZV0gQWxsIHJlbW92YWwgcmVzdWx0czpgLCByZW1vdmFscyk7XHJcbiAgICBjb25zdCBmYWlsZWQgPSByZW1vdmFscy5maWx0ZXIociA9PiAhci5zdWNjZXNzKTtcclxuICAgIGlmIChmYWlsZWQubGVuZ3RoID4gMCkge1xyXG4gICAgICBjb25zb2xlLmVycm9yKCdbcmVtb3ZlU2FsZUVmZmVjdHNPbkRlbGV0ZV0gU29tZSBsb2cgcmVtb3ZhbHMgZmFpbGVkOicsIGZhaWxlZCk7XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICBjb25zb2xlLmxvZyhgW3JlbW92ZVNhbGVFZmZlY3RzT25EZWxldGVdIOKchSBBbGwgbG9nIGVudHJpZXMgcmVtb3ZlZCBzdWNjZXNzZnVsbHkgZm9yIHNhbGU6ICR7c2FsZUlkfWApO1xyXG4gICAgfVxyXG4gICAgXHJcbiAgICBjb25zb2xlLmxvZyhgW3JlbW92ZVNhbGVFZmZlY3RzT25EZWxldGVdIOKchSBDbGVhcmVkIGVmZmVjdHMsIHJlbW92ZWQgbGlua3MsIGFuZCByZW1vdmVkIGxvZyBlbnRyaWVzIGZvciBzYWxlICR7c2FsZUlkfWApO1xyXG4gIH0gY2F0Y2ggKGVycm9yKSB7XHJcbiAgICBjb25zb2xlLmVycm9yKCdFcnJvciByZW1vdmluZyBzYWxlIGVmZmVjdHM6JywgZXJyb3IpO1xyXG4gIH1cclxufVxyXG5cclxuLyoqXHJcbiAqIFJlbW92ZSBwbGF5ZXIgcG9pbnRzIHRoYXQgd2VyZSBhd2FyZGVkIGJ5IGEgc3BlY2lmaWMgc2FsZVxyXG4gKiBUaGlzIGlzIHVzZWQgd2hlbiByb2xsaW5nIGJhY2sgYSBzYWxlIHRoYXQgaW5jb3JyZWN0bHkgYXdhcmRlZCBwb2ludHNcclxuICovXHJcbmFzeW5jIGZ1bmN0aW9uIHJlbW92ZVBsYXllclBvaW50c0Zyb21TYWxlKHNhbGVJZDogc3RyaW5nKTogUHJvbWlzZTx2b2lkPiB7XHJcbiAgdHJ5IHtcclxuICAgIGNvbnNvbGUubG9nKGBbcmVtb3ZlUGxheWVyUG9pbnRzRnJvbVNhbGVdIFJlbW92aW5nIHBvaW50cyBmb3Igc2FsZTogJHtzYWxlSWR9YCk7XHJcbiAgICBcclxuICAgIC8vIEdldCB0aGUgc2FsZSB0byBmaW5kIHdoYXQgcG9pbnRzIHdlcmUgYXdhcmRlZFxyXG4gICAgY29uc3Qgc2FsZXMgPSBhd2FpdCBDbGllbnRBUEkuZ2V0U2FsZXMoKTtcclxuICAgIGNvbnN0IHNhbGUgPSBzYWxlcy5maW5kKHMgPT4gcy5pZCA9PT0gc2FsZUlkKTtcclxuICAgIFxyXG4gICAgaWYgKCFzYWxlIHx8IHNhbGUudG90YWxzLnRvdGFsUmV2ZW51ZSA8PSAwKSB7XHJcbiAgICAgIGNvbnNvbGUubG9nKGBbcmVtb3ZlUGxheWVyUG9pbnRzRnJvbVNhbGVdIFNhbGUgJHtzYWxlSWR9IGhhcyBubyByZXZlbnVlIHRvIHJlbW92ZSBwb2ludHMgZnJvbWApO1xyXG4gICAgICByZXR1cm47XHJcbiAgICB9XHJcbiAgICBcclxuICAgIC8vIEdldCB0aGUgbWFpbiBwbGF5ZXJcclxuICAgIGNvbnN0IG1haW5QbGF5ZXJJZCA9IGdldE1haW5QbGF5ZXJJZCgpO1xyXG4gICAgY29uc3QgcGxheWVycyA9IGF3YWl0IENsaWVudEFQSS5nZXRQbGF5ZXJzKCk7XHJcbiAgICBjb25zdCBtYWluUGxheWVyID0gcGxheWVycy5maW5kKHAgPT4gcC5pZCA9PT0gbWFpblBsYXllcklkKTtcclxuICAgIFxyXG4gICAgaWYgKCFtYWluUGxheWVyKSB7XHJcbiAgICAgIGNvbnNvbGUubG9nKGBbcmVtb3ZlUGxheWVyUG9pbnRzRnJvbVNhbGVdIE1haW4gcGxheWVyIG5vdCBmb3VuZCwgc2tpcHBpbmcgcG9pbnRzIHJlbW92YWxgKTtcclxuICAgICAgcmV0dXJuO1xyXG4gICAgfVxyXG4gICAgXHJcbiAgICAvLyBDYWxjdWxhdGUgcG9pbnRzIHRvIHJlbW92ZSBiYXNlZCBvbiBzYWxlIHJldmVudWUgKDEgUG9pbnQgPSAkMTAwKVxyXG4gICAgY29uc3QgcG9pbnRzVG9SZW1vdmUgPSBjYWxjdWxhdGVQb2ludHNGcm9tUmV2ZW51ZShzYWxlLnRvdGFscy50b3RhbFJldmVudWUpO1xyXG4gICAgXHJcbiAgICAvLyBDaGVjayBpZiBhbnkgcG9pbnRzIHdlcmUgYWN0dWFsbHkgYXdhcmRlZFxyXG4gICAgY29uc3QgaGFzUG9pbnRzID0gKHBvaW50c1RvUmVtb3ZlLnhwIHx8IDApID4gMCB8fCAocG9pbnRzVG9SZW1vdmUucnAgfHwgMCkgPiAwIHx8IFxyXG4gICAgICAgICAgICAgICAgICAgICAocG9pbnRzVG9SZW1vdmUuZnAgfHwgMCkgPiAwIHx8IChwb2ludHNUb1JlbW92ZS5ocCB8fCAwKSA+IDA7XHJcbiAgICBcclxuICAgIGlmICghaGFzUG9pbnRzKSB7XHJcbiAgICAgIGNvbnNvbGUubG9nKGBbcmVtb3ZlUGxheWVyUG9pbnRzRnJvbVNhbGVdIE5vIHBvaW50cyB0byByZW1vdmUgZnJvbSBzYWxlICR7c2FsZUlkfSAocmV2ZW51ZTogJHtzYWxlLnRvdGFscy50b3RhbFJldmVudWV9KWApO1xyXG4gICAgICByZXR1cm47XHJcbiAgICB9XHJcbiAgICBcclxuICAgIC8vIFJlbW92ZSB0aGUgcG9pbnRzIGZyb20gdGhlIHBsYXllclxyXG4gICAgYXdhaXQgcmVtb3ZlUG9pbnRzRnJvbVBsYXllcihtYWluUGxheWVySWQsIHBvaW50c1RvUmVtb3ZlKTtcclxuICAgIGNvbnNvbGUubG9nKGBbcmVtb3ZlUGxheWVyUG9pbnRzRnJvbVNhbGVdIOKchSBSZW1vdmVkIHBvaW50cyBmcm9tIHBsYXllcjogJHtKU09OLnN0cmluZ2lmeShwb2ludHNUb1JlbW92ZSl9IChzYWxlIHJldmVudWU6ICR7c2FsZS50b3RhbHMudG90YWxSZXZlbnVlfSlgKTtcclxuICAgIFxyXG4gIH0gY2F0Y2ggKGVycm9yKSB7XHJcbiAgICBjb25zb2xlLmVycm9yKGBbcmVtb3ZlUGxheWVyUG9pbnRzRnJvbVNhbGVdIOKdjCBGYWlsZWQgdG8gcmVtb3ZlIHBsYXllciBwb2ludHMgZm9yIHNhbGUgJHtzYWxlSWR9OmAsIGVycm9yKTtcclxuICB9XHJcbn0iXSwibmFtZXMiOlsiYXBwZW5kRW50aXR5TG9nIiwidXBkYXRlRW50aXR5TG9nRmllbGQiLCJoYXNFZmZlY3QiLCJtYXJrRWZmZWN0IiwiY2xlYXJFZmZlY3RzQnlQcmVmaXgiLCJDbGllbnRBUEkiLCJhd2FyZFBvaW50c1RvUGxheWVyIiwicmVtb3ZlUG9pbnRzRnJvbVBsYXllciIsImNhbGN1bGF0ZVBvaW50c0Zyb21SZXZlbnVlIiwiZ2V0TWFpblBsYXllcklkIiwicHJvY2Vzc1NhbGVMaW5lcyIsInVwZGF0ZUZpbmFuY2lhbFJlY29yZHNGcm9tU2FsZSIsInVwZGF0ZUl0ZW1zRnJvbVNhbGUiLCJ1cGRhdGVQbGF5ZXJQb2ludHNGcm9tU291cmNlIiwiaGFzUmV2ZW51ZUNoYW5nZWQiLCJoYXNMaW5lc0NoYW5nZWQiLCJTVEFURV9GSUVMRFMiLCJERVNDUklQVElWRV9GSUVMRFMiLCJvblNhbGVVcHNlcnQiLCJzYWxlIiwicHJldmlvdXNTYWxlIiwiZWZmZWN0S2V5IiwiaWQiLCJ0eXBlIiwic3RhdHVzIiwiY291bnRlcnBhcnR5TmFtZSIsInRvdGFsUmV2ZW51ZSIsInRvdGFscyIsInBvaW50c0VmZmVjdEtleSIsImNvbnNvbGUiLCJsb2ciLCJwb2ludHMiLCJjaGFyZ2VkQXQiLCJEYXRlIiwidG9JU09TdHJpbmciLCJsaW5lc1Byb2Nlc3NlZEtleSIsImNhbmNlbGxlZEF0IiwiaXNDb2xsZWN0ZWQiLCJjb2xsZWN0ZWRBdCIsImZpZWxkIiwicmVtb3ZlU2FsZUVmZmVjdHNPbkRlbGV0ZSIsInNhbGVJZCIsInJlbW92ZVBsYXllclBvaW50c0Zyb21TYWxlIiwic2FsZUxpbmtzIiwiZ2V0TGlua3NGb3IiLCJsZW5ndGgiLCJsaW5rIiwicmVtb3ZlTGluayIsImxpbmtUeXBlIiwiZXJyb3IiLCJyZW1vdmFscyIsIlByb21pc2UiLCJhbGwiLCJyZW1vdmVMb2dFbnRyeSIsInRoZW4iLCJyIiwiY2F0Y2giLCJlIiwic3VjY2VzcyIsIm1lc3NhZ2UiLCJTdHJpbmciLCJmYWlsZWQiLCJmaWx0ZXIiLCJzYWxlcyIsImdldFNhbGVzIiwiZmluZCIsInMiLCJtYWluUGxheWVySWQiLCJwbGF5ZXJzIiwiZ2V0UGxheWVycyIsIm1haW5QbGF5ZXIiLCJwIiwicG9pbnRzVG9SZW1vdmUiLCJoYXNQb2ludHMiLCJ4cCIsInJwIiwiZnAiLCJocCIsIkpTT04iLCJzdHJpbmdpZnkiXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./workflows/entities-workflows/sale.workflow.ts\n");

/***/ }),

/***/ "(rsc)/./workflows/entities-workflows/site.workflow.ts":
/*!*******************************************************!*\
  !*** ./workflows/entities-workflows/site.workflow.ts ***!
  \*******************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   onSiteUpsert: () => (/* binding */ onSiteUpsert),\n/* harmony export */   removeSiteEffectsOnDelete: () => (/* binding */ removeSiteEffectsOnDelete)\n/* harmony export */ });\n/* harmony import */ var _entities_logging__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../entities-logging */ \"(rsc)/./workflows/entities-logging.ts\");\n/* harmony import */ var _data_store_effects_registry__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @/data-store/effects-registry */ \"(rsc)/./data-store/effects-registry.ts\");\n/* harmony import */ var _lib_client_api__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @/lib/client-api */ \"(rsc)/./lib/client-api.ts\");\n// workflows/entities-workflows/site.workflow.ts\n// Site-specific workflow with ACTIVATED, DEACTIVATED events\n\n\n\nconst STATE_FIELDS = [\n    \"isActive\",\n    \"status\"\n];\nconst DESCRIPTIVE_FIELDS = [\n    \"name\",\n    \"description\",\n    \"metadata\"\n];\nasync function onSiteUpsert(site, previousSite) {\n    // New site creation\n    if (!previousSite) {\n        const effectKey = `site:${site.id}:created`;\n        if (await (0,_data_store_effects_registry__WEBPACK_IMPORTED_MODULE_1__.hasEffect)(effectKey)) return;\n        await (0,_entities_logging__WEBPACK_IMPORTED_MODULE_0__.appendEntityLog)(\"site\", site.id, \"CREATED\", {\n            name: site.name,\n            type: site.metadata.type,\n            isActive: site.isActive\n        });\n        await (0,_data_store_effects_registry__WEBPACK_IMPORTED_MODULE_1__.markEffect)(effectKey);\n        return;\n    }\n    // Activation status changes\n    if (previousSite.isActive !== site.isActive) {\n        if (site.isActive) {\n            await (0,_entities_logging__WEBPACK_IMPORTED_MODULE_0__.appendEntityLog)(\"site\", site.id, \"ACTIVATED\", {\n                name: site.name,\n                activatedAt: new Date().toISOString()\n            });\n        } else {\n            await (0,_entities_logging__WEBPACK_IMPORTED_MODULE_0__.appendEntityLog)(\"site\", site.id, \"DEACTIVATED\", {\n                name: site.name,\n                deactivatedAt: new Date().toISOString()\n            });\n        }\n    }\n    // Status changes - UPDATED event\n    if (previousSite.status !== site.status) {\n        await (0,_entities_logging__WEBPACK_IMPORTED_MODULE_0__.appendEntityLog)(\"site\", site.id, \"UPDATED\", {\n            name: site.name,\n            oldStatus: previousSite.status,\n            newStatus: site.status\n        });\n    }\n    // Descriptive changes - update in-place\n    for (const field of DESCRIPTIVE_FIELDS){\n        if (previousSite[field] !== site[field]) {\n            await (0,_entities_logging__WEBPACK_IMPORTED_MODULE_0__.updateEntityLogField)(\"site\", site.id, field, previousSite[field], site[field]);\n        }\n    }\n}\n/**\r\n * Remove site effects when site is deleted\r\n * Sites can have entries in sites log and related links\r\n */ async function removeSiteEffectsOnDelete(siteId) {\n    try {\n        console.log(`[removeSiteEffectsOnDelete] Starting cleanup for site: ${siteId}`);\n        // 1. Remove all Links related to this site\n        const siteLinks = await _lib_client_api__WEBPACK_IMPORTED_MODULE_2__.ClientAPI.getLinksFor({\n            type: \"site\",\n            id: siteId\n        });\n        console.log(`[removeSiteEffectsOnDelete] Found ${siteLinks.length} links to remove`);\n        for (const link of siteLinks){\n            try {\n                await _lib_client_api__WEBPACK_IMPORTED_MODULE_2__.ClientAPI.removeLink(link.id);\n                console.log(`[removeSiteEffectsOnDelete] ✅ Removed link: ${link.linkType}`);\n            } catch (error) {\n                console.error(`[removeSiteEffectsOnDelete] ❌ Failed to remove link ${link.id}:`, error);\n            }\n        }\n        // 2. Clear all effects for this site\n        await (0,_data_store_effects_registry__WEBPACK_IMPORTED_MODULE_1__.clearEffect)(`site:${siteId}:created`);\n        await (0,_data_store_effects_registry__WEBPACK_IMPORTED_MODULE_1__.clearEffectsByPrefix)(\"site\", siteId, \"\");\n        // 3. Remove log entries from sites log\n        console.log(`[removeSiteEffectsOnDelete] Starting log entry removal for site: ${siteId}`);\n        const result = await _lib_client_api__WEBPACK_IMPORTED_MODULE_2__.ClientAPI.removeLogEntry(\"sites\", siteId);\n        if (result.success) {\n            console.log(`[removeSiteEffectsOnDelete] ✅ Site log entries removed successfully for site: ${siteId}`);\n        } else if (result.message === \"No matching entries found\") {\n            console.log(`[removeSiteEffectsOnDelete] ⏭️ No log entries found for site: ${siteId} (this is normal)`);\n        } else {\n            console.error(`[removeSiteEffectsOnDelete] Failed to remove site log entries: ${result.message}`);\n        }\n        console.log(`[removeSiteEffectsOnDelete] ✅ Cleared effects, removed links, and removed log entries for site ${siteId}`);\n    } catch (error) {\n        console.error(\"Error removing site effects:\", error);\n    }\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi93b3JrZmxvd3MvZW50aXRpZXMtd29ya2Zsb3dzL3NpdGUud29ya2Zsb3cudHMiLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7QUFBQSxnREFBZ0Q7QUFDaEQsNERBQTREO0FBR2dCO0FBQzZCO0FBQzVEO0FBRTdDLE1BQU1PLGVBQWU7SUFBQztJQUFZO0NBQVM7QUFDM0MsTUFBTUMscUJBQXFCO0lBQUM7SUFBUTtJQUFlO0NBQVc7QUFFdkQsZUFBZUMsYUFBYUMsSUFBVSxFQUFFQyxZQUFtQjtJQUNoRSxvQkFBb0I7SUFDcEIsSUFBSSxDQUFDQSxjQUFjO1FBQ2pCLE1BQU1DLFlBQVksQ0FBQyxLQUFLLEVBQUVGLEtBQUtHLEVBQUUsQ0FBQyxRQUFRLENBQUM7UUFDM0MsSUFBSSxNQUFNWCx1RUFBU0EsQ0FBQ1UsWUFBWTtRQUVoQyxNQUFNWixrRUFBZUEsQ0FBQyxRQUFRVSxLQUFLRyxFQUFFLEVBQUUsV0FBVztZQUNoREMsTUFBTUosS0FBS0ksSUFBSTtZQUNmQyxNQUFNTCxLQUFLTSxRQUFRLENBQUNELElBQUk7WUFDeEJFLFVBQVVQLEtBQUtPLFFBQVE7UUFDekI7UUFDQSxNQUFNZCx3RUFBVUEsQ0FBQ1M7UUFDakI7SUFDRjtJQUVBLDRCQUE0QjtJQUM1QixJQUFJRCxhQUFhTSxRQUFRLEtBQUtQLEtBQUtPLFFBQVEsRUFBRTtRQUMzQyxJQUFJUCxLQUFLTyxRQUFRLEVBQUU7WUFDakIsTUFBTWpCLGtFQUFlQSxDQUFDLFFBQVFVLEtBQUtHLEVBQUUsRUFBRSxhQUFhO2dCQUNsREMsTUFBTUosS0FBS0ksSUFBSTtnQkFDZkksYUFBYSxJQUFJQyxPQUFPQyxXQUFXO1lBQ3JDO1FBQ0YsT0FBTztZQUNMLE1BQU1wQixrRUFBZUEsQ0FBQyxRQUFRVSxLQUFLRyxFQUFFLEVBQUUsZUFBZTtnQkFDcERDLE1BQU1KLEtBQUtJLElBQUk7Z0JBQ2ZPLGVBQWUsSUFBSUYsT0FBT0MsV0FBVztZQUN2QztRQUNGO0lBQ0Y7SUFFQSxpQ0FBaUM7SUFDakMsSUFBSVQsYUFBYVcsTUFBTSxLQUFLWixLQUFLWSxNQUFNLEVBQUU7UUFDdkMsTUFBTXRCLGtFQUFlQSxDQUFDLFFBQVFVLEtBQUtHLEVBQUUsRUFBRSxXQUFXO1lBQ2hEQyxNQUFNSixLQUFLSSxJQUFJO1lBQ2ZTLFdBQVdaLGFBQWFXLE1BQU07WUFDOUJFLFdBQVdkLEtBQUtZLE1BQU07UUFDeEI7SUFDRjtJQUVBLHdDQUF3QztJQUN4QyxLQUFLLE1BQU1HLFNBQVNqQixtQkFBb0I7UUFDdEMsSUFBSSxZQUFxQixDQUFDaUIsTUFBTSxLQUFLLElBQWEsQ0FBQ0EsTUFBTSxFQUFFO1lBQ3pELE1BQU14Qix1RUFBb0JBLENBQUMsUUFBUVMsS0FBS0csRUFBRSxFQUFFWSxPQUFPLFlBQXFCLENBQUNBLE1BQU0sRUFBRSxJQUFhLENBQUNBLE1BQU07UUFDdkc7SUFDRjtBQUNGO0FBRUE7OztDQUdDLEdBQ00sZUFBZUMsMEJBQTBCQyxNQUFjO0lBQzVELElBQUk7UUFDRkMsUUFBUUMsR0FBRyxDQUFDLENBQUMsdURBQXVELEVBQUVGLE9BQU8sQ0FBQztRQUU5RSwyQ0FBMkM7UUFDM0MsTUFBTUcsWUFBWSxNQUFNeEIsc0RBQVNBLENBQUN5QixXQUFXLENBQUM7WUFBRWhCLE1BQU07WUFBUUYsSUFBSWM7UUFBTztRQUN6RUMsUUFBUUMsR0FBRyxDQUFDLENBQUMsa0NBQWtDLEVBQUVDLFVBQVVFLE1BQU0sQ0FBQyxnQkFBZ0IsQ0FBQztRQUVuRixLQUFLLE1BQU1DLFFBQVFILFVBQVc7WUFDNUIsSUFBSTtnQkFDRixNQUFNeEIsc0RBQVNBLENBQUM0QixVQUFVLENBQUNELEtBQUtwQixFQUFFO2dCQUNsQ2UsUUFBUUMsR0FBRyxDQUFDLENBQUMsNENBQTRDLEVBQUVJLEtBQUtFLFFBQVEsQ0FBQyxDQUFDO1lBQzVFLEVBQUUsT0FBT0MsT0FBTztnQkFDZFIsUUFBUVEsS0FBSyxDQUFDLENBQUMsb0RBQW9ELEVBQUVILEtBQUtwQixFQUFFLENBQUMsQ0FBQyxDQUFDLEVBQUV1QjtZQUNuRjtRQUNGO1FBRUEscUNBQXFDO1FBQ3JDLE1BQU1oQyx5RUFBV0EsQ0FBQyxDQUFDLEtBQUssRUFBRXVCLE9BQU8sUUFBUSxDQUFDO1FBQzFDLE1BQU10QixrRkFBb0JBLENBQUMsUUFBUXNCLFFBQVE7UUFFM0MsdUNBQXVDO1FBQ3ZDQyxRQUFRQyxHQUFHLENBQUMsQ0FBQyxpRUFBaUUsRUFBRUYsT0FBTyxDQUFDO1FBRXhGLE1BQU1VLFNBQVMsTUFBTS9CLHNEQUFTQSxDQUFDZ0MsY0FBYyxDQUFDLFNBQVNYO1FBRXZELElBQUlVLE9BQU9FLE9BQU8sRUFBRTtZQUNsQlgsUUFBUUMsR0FBRyxDQUFDLENBQUMsOEVBQThFLEVBQUVGLE9BQU8sQ0FBQztRQUN2RyxPQUFPLElBQUlVLE9BQU9HLE9BQU8sS0FBSyw2QkFBNkI7WUFDekRaLFFBQVFDLEdBQUcsQ0FBQyxDQUFDLDhEQUE4RCxFQUFFRixPQUFPLGlCQUFpQixDQUFDO1FBQ3hHLE9BQU87WUFDTEMsUUFBUVEsS0FBSyxDQUFDLENBQUMsK0RBQStELEVBQUVDLE9BQU9HLE9BQU8sQ0FBQyxDQUFDO1FBQ2xHO1FBRUFaLFFBQVFDLEdBQUcsQ0FBQyxDQUFDLCtGQUErRixFQUFFRixPQUFPLENBQUM7SUFDeEgsRUFBRSxPQUFPUyxPQUFPO1FBQ2RSLFFBQVFRLEtBQUssQ0FBQyxnQ0FBZ0NBO0lBQ2hEO0FBQ0YiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly90aGVnYW1lLWFkbWluLy4vd29ya2Zsb3dzL2VudGl0aWVzLXdvcmtmbG93cy9zaXRlLndvcmtmbG93LnRzP2EyYmQiXSwic291cmNlc0NvbnRlbnQiOlsiLy8gd29ya2Zsb3dzL2VudGl0aWVzLXdvcmtmbG93cy9zaXRlLndvcmtmbG93LnRzXHJcbi8vIFNpdGUtc3BlY2lmaWMgd29ya2Zsb3cgd2l0aCBBQ1RJVkFURUQsIERFQUNUSVZBVEVEIGV2ZW50c1xyXG5cclxuaW1wb3J0IHR5cGUgeyBTaXRlIH0gZnJvbSAnQC90eXBlcy9lbnRpdGllcyc7XHJcbmltcG9ydCB7IGFwcGVuZEVudGl0eUxvZywgdXBkYXRlRW50aXR5TG9nRmllbGQgfSBmcm9tICcuLi9lbnRpdGllcy1sb2dnaW5nJztcclxuaW1wb3J0IHsgaGFzRWZmZWN0LCBtYXJrRWZmZWN0LCBjbGVhckVmZmVjdCwgY2xlYXJFZmZlY3RzQnlQcmVmaXggfSBmcm9tICdAL2RhdGEtc3RvcmUvZWZmZWN0cy1yZWdpc3RyeSc7XHJcbmltcG9ydCB7IENsaWVudEFQSSB9IGZyb20gJ0AvbGliL2NsaWVudC1hcGknO1xyXG5cclxuY29uc3QgU1RBVEVfRklFTERTID0gWydpc0FjdGl2ZScsICdzdGF0dXMnXTtcclxuY29uc3QgREVTQ1JJUFRJVkVfRklFTERTID0gWyduYW1lJywgJ2Rlc2NyaXB0aW9uJywgJ21ldGFkYXRhJ107XHJcblxyXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gb25TaXRlVXBzZXJ0KHNpdGU6IFNpdGUsIHByZXZpb3VzU2l0ZT86IFNpdGUpOiBQcm9taXNlPHZvaWQ+IHtcclxuICAvLyBOZXcgc2l0ZSBjcmVhdGlvblxyXG4gIGlmICghcHJldmlvdXNTaXRlKSB7XHJcbiAgICBjb25zdCBlZmZlY3RLZXkgPSBgc2l0ZToke3NpdGUuaWR9OmNyZWF0ZWRgO1xyXG4gICAgaWYgKGF3YWl0IGhhc0VmZmVjdChlZmZlY3RLZXkpKSByZXR1cm47XHJcbiAgICBcclxuICAgIGF3YWl0IGFwcGVuZEVudGl0eUxvZygnc2l0ZScsIHNpdGUuaWQsICdDUkVBVEVEJywgeyBcclxuICAgICAgbmFtZTogc2l0ZS5uYW1lLCBcclxuICAgICAgdHlwZTogc2l0ZS5tZXRhZGF0YS50eXBlLFxyXG4gICAgICBpc0FjdGl2ZTogc2l0ZS5pc0FjdGl2ZVxyXG4gICAgfSk7XHJcbiAgICBhd2FpdCBtYXJrRWZmZWN0KGVmZmVjdEtleSk7XHJcbiAgICByZXR1cm47XHJcbiAgfVxyXG4gIFxyXG4gIC8vIEFjdGl2YXRpb24gc3RhdHVzIGNoYW5nZXNcclxuICBpZiAocHJldmlvdXNTaXRlLmlzQWN0aXZlICE9PSBzaXRlLmlzQWN0aXZlKSB7XHJcbiAgICBpZiAoc2l0ZS5pc0FjdGl2ZSkge1xyXG4gICAgICBhd2FpdCBhcHBlbmRFbnRpdHlMb2coJ3NpdGUnLCBzaXRlLmlkLCAnQUNUSVZBVEVEJywge1xyXG4gICAgICAgIG5hbWU6IHNpdGUubmFtZSxcclxuICAgICAgICBhY3RpdmF0ZWRBdDogbmV3IERhdGUoKS50b0lTT1N0cmluZygpXHJcbiAgICAgIH0pO1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgYXdhaXQgYXBwZW5kRW50aXR5TG9nKCdzaXRlJywgc2l0ZS5pZCwgJ0RFQUNUSVZBVEVEJywge1xyXG4gICAgICAgIG5hbWU6IHNpdGUubmFtZSxcclxuICAgICAgICBkZWFjdGl2YXRlZEF0OiBuZXcgRGF0ZSgpLnRvSVNPU3RyaW5nKClcclxuICAgICAgfSk7XHJcbiAgICB9XHJcbiAgfVxyXG4gIFxyXG4gIC8vIFN0YXR1cyBjaGFuZ2VzIC0gVVBEQVRFRCBldmVudFxyXG4gIGlmIChwcmV2aW91c1NpdGUuc3RhdHVzICE9PSBzaXRlLnN0YXR1cykge1xyXG4gICAgYXdhaXQgYXBwZW5kRW50aXR5TG9nKCdzaXRlJywgc2l0ZS5pZCwgJ1VQREFURUQnLCB7XHJcbiAgICAgIG5hbWU6IHNpdGUubmFtZSxcclxuICAgICAgb2xkU3RhdHVzOiBwcmV2aW91c1NpdGUuc3RhdHVzLFxyXG4gICAgICBuZXdTdGF0dXM6IHNpdGUuc3RhdHVzXHJcbiAgICB9KTtcclxuICB9XHJcbiAgXHJcbiAgLy8gRGVzY3JpcHRpdmUgY2hhbmdlcyAtIHVwZGF0ZSBpbi1wbGFjZVxyXG4gIGZvciAoY29uc3QgZmllbGQgb2YgREVTQ1JJUFRJVkVfRklFTERTKSB7XHJcbiAgICBpZiAoKHByZXZpb3VzU2l0ZSBhcyBhbnkpW2ZpZWxkXSAhPT0gKHNpdGUgYXMgYW55KVtmaWVsZF0pIHtcclxuICAgICAgYXdhaXQgdXBkYXRlRW50aXR5TG9nRmllbGQoJ3NpdGUnLCBzaXRlLmlkLCBmaWVsZCwgKHByZXZpb3VzU2l0ZSBhcyBhbnkpW2ZpZWxkXSwgKHNpdGUgYXMgYW55KVtmaWVsZF0pO1xyXG4gICAgfVxyXG4gIH1cclxufVxyXG5cclxuLyoqXHJcbiAqIFJlbW92ZSBzaXRlIGVmZmVjdHMgd2hlbiBzaXRlIGlzIGRlbGV0ZWRcclxuICogU2l0ZXMgY2FuIGhhdmUgZW50cmllcyBpbiBzaXRlcyBsb2cgYW5kIHJlbGF0ZWQgbGlua3NcclxuICovXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiByZW1vdmVTaXRlRWZmZWN0c09uRGVsZXRlKHNpdGVJZDogc3RyaW5nKTogUHJvbWlzZTx2b2lkPiB7XHJcbiAgdHJ5IHtcclxuICAgIGNvbnNvbGUubG9nKGBbcmVtb3ZlU2l0ZUVmZmVjdHNPbkRlbGV0ZV0gU3RhcnRpbmcgY2xlYW51cCBmb3Igc2l0ZTogJHtzaXRlSWR9YCk7XHJcbiAgICBcclxuICAgIC8vIDEuIFJlbW92ZSBhbGwgTGlua3MgcmVsYXRlZCB0byB0aGlzIHNpdGVcclxuICAgIGNvbnN0IHNpdGVMaW5rcyA9IGF3YWl0IENsaWVudEFQSS5nZXRMaW5rc0Zvcih7IHR5cGU6ICdzaXRlJywgaWQ6IHNpdGVJZCB9KTtcclxuICAgIGNvbnNvbGUubG9nKGBbcmVtb3ZlU2l0ZUVmZmVjdHNPbkRlbGV0ZV0gRm91bmQgJHtzaXRlTGlua3MubGVuZ3RofSBsaW5rcyB0byByZW1vdmVgKTtcclxuICAgIFxyXG4gICAgZm9yIChjb25zdCBsaW5rIG9mIHNpdGVMaW5rcykge1xyXG4gICAgICB0cnkge1xyXG4gICAgICAgIGF3YWl0IENsaWVudEFQSS5yZW1vdmVMaW5rKGxpbmsuaWQpO1xyXG4gICAgICAgIGNvbnNvbGUubG9nKGBbcmVtb3ZlU2l0ZUVmZmVjdHNPbkRlbGV0ZV0g4pyFIFJlbW92ZWQgbGluazogJHtsaW5rLmxpbmtUeXBlfWApO1xyXG4gICAgICB9IGNhdGNoIChlcnJvcikge1xyXG4gICAgICAgIGNvbnNvbGUuZXJyb3IoYFtyZW1vdmVTaXRlRWZmZWN0c09uRGVsZXRlXSDinYwgRmFpbGVkIHRvIHJlbW92ZSBsaW5rICR7bGluay5pZH06YCwgZXJyb3IpO1xyXG4gICAgICB9XHJcbiAgICB9XHJcbiAgICBcclxuICAgIC8vIDIuIENsZWFyIGFsbCBlZmZlY3RzIGZvciB0aGlzIHNpdGVcclxuICAgIGF3YWl0IGNsZWFyRWZmZWN0KGBzaXRlOiR7c2l0ZUlkfTpjcmVhdGVkYCk7XHJcbiAgICBhd2FpdCBjbGVhckVmZmVjdHNCeVByZWZpeCgnc2l0ZScsIHNpdGVJZCwgJycpO1xyXG4gICAgXHJcbiAgICAvLyAzLiBSZW1vdmUgbG9nIGVudHJpZXMgZnJvbSBzaXRlcyBsb2dcclxuICAgIGNvbnNvbGUubG9nKGBbcmVtb3ZlU2l0ZUVmZmVjdHNPbkRlbGV0ZV0gU3RhcnRpbmcgbG9nIGVudHJ5IHJlbW92YWwgZm9yIHNpdGU6ICR7c2l0ZUlkfWApO1xyXG4gICAgXHJcbiAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBDbGllbnRBUEkucmVtb3ZlTG9nRW50cnkoJ3NpdGVzJywgc2l0ZUlkKTtcclxuICAgIFxyXG4gICAgaWYgKHJlc3VsdC5zdWNjZXNzKSB7XHJcbiAgICAgIGNvbnNvbGUubG9nKGBbcmVtb3ZlU2l0ZUVmZmVjdHNPbkRlbGV0ZV0g4pyFIFNpdGUgbG9nIGVudHJpZXMgcmVtb3ZlZCBzdWNjZXNzZnVsbHkgZm9yIHNpdGU6ICR7c2l0ZUlkfWApO1xyXG4gICAgfSBlbHNlIGlmIChyZXN1bHQubWVzc2FnZSA9PT0gJ05vIG1hdGNoaW5nIGVudHJpZXMgZm91bmQnKSB7XHJcbiAgICAgIGNvbnNvbGUubG9nKGBbcmVtb3ZlU2l0ZUVmZmVjdHNPbkRlbGV0ZV0g4o+t77iPIE5vIGxvZyBlbnRyaWVzIGZvdW5kIGZvciBzaXRlOiAke3NpdGVJZH0gKHRoaXMgaXMgbm9ybWFsKWApO1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgY29uc29sZS5lcnJvcihgW3JlbW92ZVNpdGVFZmZlY3RzT25EZWxldGVdIEZhaWxlZCB0byByZW1vdmUgc2l0ZSBsb2cgZW50cmllczogJHtyZXN1bHQubWVzc2FnZX1gKTtcclxuICAgIH1cclxuICAgIFxyXG4gICAgY29uc29sZS5sb2coYFtyZW1vdmVTaXRlRWZmZWN0c09uRGVsZXRlXSDinIUgQ2xlYXJlZCBlZmZlY3RzLCByZW1vdmVkIGxpbmtzLCBhbmQgcmVtb3ZlZCBsb2cgZW50cmllcyBmb3Igc2l0ZSAke3NpdGVJZH1gKTtcclxuICB9IGNhdGNoIChlcnJvcikge1xyXG4gICAgY29uc29sZS5lcnJvcignRXJyb3IgcmVtb3Zpbmcgc2l0ZSBlZmZlY3RzOicsIGVycm9yKTtcclxuICB9XHJcbn0iXSwibmFtZXMiOlsiYXBwZW5kRW50aXR5TG9nIiwidXBkYXRlRW50aXR5TG9nRmllbGQiLCJoYXNFZmZlY3QiLCJtYXJrRWZmZWN0IiwiY2xlYXJFZmZlY3QiLCJjbGVhckVmZmVjdHNCeVByZWZpeCIsIkNsaWVudEFQSSIsIlNUQVRFX0ZJRUxEUyIsIkRFU0NSSVBUSVZFX0ZJRUxEUyIsIm9uU2l0ZVVwc2VydCIsInNpdGUiLCJwcmV2aW91c1NpdGUiLCJlZmZlY3RLZXkiLCJpZCIsIm5hbWUiLCJ0eXBlIiwibWV0YWRhdGEiLCJpc0FjdGl2ZSIsImFjdGl2YXRlZEF0IiwiRGF0ZSIsInRvSVNPU3RyaW5nIiwiZGVhY3RpdmF0ZWRBdCIsInN0YXR1cyIsIm9sZFN0YXR1cyIsIm5ld1N0YXR1cyIsImZpZWxkIiwicmVtb3ZlU2l0ZUVmZmVjdHNPbkRlbGV0ZSIsInNpdGVJZCIsImNvbnNvbGUiLCJsb2ciLCJzaXRlTGlua3MiLCJnZXRMaW5rc0ZvciIsImxlbmd0aCIsImxpbmsiLCJyZW1vdmVMaW5rIiwibGlua1R5cGUiLCJlcnJvciIsInJlc3VsdCIsInJlbW92ZUxvZ0VudHJ5Iiwic3VjY2VzcyIsIm1lc3NhZ2UiXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./workflows/entities-workflows/site.workflow.ts\n");

/***/ }),

/***/ "(rsc)/./workflows/entities-workflows/task.workflow.ts":
/*!*******************************************************!*\
  !*** ./workflows/entities-workflows/task.workflow.ts ***!
  \*******************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   onTaskUpsert: () => (/* binding */ onTaskUpsert),\n/* harmony export */   removeTaskLogEntriesOnDelete: () => (/* binding */ removeTaskLogEntriesOnDelete),\n/* harmony export */   uncompleteTask: () => (/* binding */ uncompleteTask)\n/* harmony export */ });\n/* harmony import */ var _types_enums__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @/types/enums */ \"(rsc)/./types/enums.ts\");\n/* harmony import */ var _entities_logging__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../entities-logging */ \"(rsc)/./workflows/entities-logging.ts\");\n/* harmony import */ var _data_store_effects_registry__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @/data-store/effects-registry */ \"(rsc)/./data-store/effects-registry.ts\");\n/* harmony import */ var _data_store_datastore__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! @/data-store/datastore */ \"(rsc)/./data-store/datastore.ts\");\n/* harmony import */ var _links_link_registry__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! @/links/link-registry */ \"(rsc)/./links/link-registry.ts\");\n/* harmony import */ var _item_creation_utils__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../item-creation-utils */ \"(rsc)/./workflows/item-creation-utils.ts\");\n/* harmony import */ var _points_rewards_utils__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../points-rewards-utils */ \"(rsc)/./workflows/points-rewards-utils.ts\");\n/* harmony import */ var _financial_record_utils__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../financial-record-utils */ \"(rsc)/./workflows/financial-record-utils.ts\");\n/* harmony import */ var _update_propagation_utils__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ../update-propagation-utils */ \"(rsc)/./workflows/update-propagation-utils.ts\");\n// workflows/entities-workflows/task.workflow.ts\n// Task-specific workflow with state vs descriptive field detection\n\n\n\n\n\n\n\n\n\nconst STATE_FIELDS = [\n    \"status\",\n    \"progress\",\n    \"doneAt\",\n    \"collectedAt\",\n    \"siteId\",\n    \"targetSiteId\"\n];\nconst DESCRIPTIVE_FIELDS = [\n    \"name\",\n    \"description\",\n    \"cost\",\n    \"revenue\",\n    \"rewards\",\n    \"priority\"\n];\nasync function onTaskUpsert(task, previousTask) {\n    // New task creation\n    if (!previousTask) {\n        const effectKey = `task:${task.id}:created`;\n        if (await (0,_data_store_effects_registry__WEBPACK_IMPORTED_MODULE_2__.hasEffect)(effectKey)) return;\n        await (0,_entities_logging__WEBPACK_IMPORTED_MODULE_1__.appendEntityLog)(\"task\", task.id, \"CREATED\", {\n            name: task.name,\n            status: task.status,\n            station: task.station\n        });\n        await (0,_data_store_effects_registry__WEBPACK_IMPORTED_MODULE_2__.markEffect)(effectKey);\n        return;\n    }\n    // State changes - append new log\n    if (previousTask.status !== task.status) {\n        console.log(`[onTaskUpsert] Task status changed: ${previousTask.status} → ${task.status}`);\n        // Log status change with transition context\n        await (0,_entities_logging__WEBPACK_IMPORTED_MODULE_1__.appendEntityLog)(\"task\", task.id, \"STATUS_CHANGED\", {\n            oldStatus: previousTask.status,\n            newStatus: task.status,\n            name: task.name,\n            transition: `${previousTask.status} → ${task.status}`,\n            changedAt: new Date().toISOString()\n        });\n        // Handle uncompletion (Done → Other status)\n        if (previousTask.status === \"Done\" && task.status !== \"Done\" && task.status !== \"Collected\") {\n            console.log(`[onTaskUpsert] Task uncompleted: ${task.name} (${previousTask.status} → ${task.status})`);\n            // Uncomplete the task and remove effects\n            await uncompleteTask(task.id);\n        }\n    }\n    if (!previousTask.doneAt && task.doneAt) {\n        await (0,_entities_logging__WEBPACK_IMPORTED_MODULE_1__.appendEntityLog)(\"task\", task.id, \"DONE\", {\n            name: task.name,\n            doneAt: task.doneAt\n        });\n    }\n    if (!previousTask.collectedAt && task.collectedAt) {\n        await (0,_entities_logging__WEBPACK_IMPORTED_MODULE_1__.appendEntityLog)(\"task\", task.id, \"COLLECTED\", {\n            name: task.name,\n            collectedAt: task.collectedAt\n        });\n    }\n    // Site changes - MOVED event\n    if (previousTask.siteId !== task.siteId || previousTask.targetSiteId !== task.targetSiteId) {\n        await (0,_entities_logging__WEBPACK_IMPORTED_MODULE_1__.appendEntityLog)(\"task\", task.id, \"MOVED\", {\n            name: task.name,\n            oldSiteId: previousTask.siteId,\n            newSiteId: task.siteId,\n            oldTargetSiteId: previousTask.targetSiteId,\n            newTargetSiteId: task.targetSiteId\n        });\n    }\n    // Item creation from emissary fields - when task is completed\n    if (task.outputItemType && task.outputQuantity && task.status === \"Done\") {\n        const effectKey = `task:${task.id}:itemCreated`;\n        if (!await (0,_data_store_effects_registry__WEBPACK_IMPORTED_MODULE_2__.hasEffect)(effectKey)) {\n            console.log(`[onTaskUpsert] Creating item from task emissary fields: ${task.name}`);\n            const createdItem = await (0,_item_creation_utils__WEBPACK_IMPORTED_MODULE_5__.createItemFromTask)(task);\n            if (createdItem) {\n                await (0,_data_store_effects_registry__WEBPACK_IMPORTED_MODULE_2__.markEffect)(effectKey);\n                console.log(`[onTaskUpsert] ✅ Item created and effect marked: ${createdItem.name}`);\n            }\n        }\n    }\n    // Points awarding - when task is completed with rewards\n    if (task.status === \"Done\" && task.rewards?.points) {\n        const effectKey = `task:${task.id}:pointsAwarded`;\n        if (!await (0,_data_store_effects_registry__WEBPACK_IMPORTED_MODULE_2__.hasEffect)(effectKey)) {\n            console.log(`[onTaskUpsert] Awarding points from task completion: ${task.name}`);\n            await (0,_points_rewards_utils__WEBPACK_IMPORTED_MODULE_6__.awardPointsToPlayer)((0,_points_rewards_utils__WEBPACK_IMPORTED_MODULE_6__.getMainPlayerId)(), task.rewards.points, task.id, \"task\");\n            await (0,_data_store_effects_registry__WEBPACK_IMPORTED_MODULE_2__.markEffect)(effectKey);\n            console.log(`[onTaskUpsert] ✅ Points awarded and effect marked for task: ${task.name}`);\n        }\n    }\n    // Financial record creation from task - when task has cost or revenue\n    if (task.cost || task.revenue) {\n        const effectKey = `task:${task.id}:financialCreated`;\n        if (!await (0,_data_store_effects_registry__WEBPACK_IMPORTED_MODULE_2__.hasEffect)(effectKey)) {\n            console.log(`[onTaskUpsert] Creating financial record from task: ${task.name}`);\n            const createdFinancial = await (0,_financial_record_utils__WEBPACK_IMPORTED_MODULE_7__.createFinancialRecordFromTask)(task);\n            if (createdFinancial) {\n                await (0,_data_store_effects_registry__WEBPACK_IMPORTED_MODULE_2__.markEffect)(effectKey);\n                console.log(`[onTaskUpsert] ✅ Financial record created and effect marked: ${createdFinancial.name}`);\n            }\n        }\n    }\n    // COMPREHENSIVE UPDATE PROPAGATION - when task properties change\n    if (previousTask) {\n        // Propagate to Financial Records\n        if ((0,_update_propagation_utils__WEBPACK_IMPORTED_MODULE_8__.hasFinancialPropsChanged)(task, previousTask)) {\n            console.log(`[onTaskUpsert] Propagating financial changes from task: ${task.name}`);\n            await (0,_update_propagation_utils__WEBPACK_IMPORTED_MODULE_8__.updateFinancialRecordsFromTask)(task, previousTask);\n        }\n        // Propagate to Items\n        if ((0,_update_propagation_utils__WEBPACK_IMPORTED_MODULE_8__.hasOutputPropsChanged)(task, previousTask)) {\n            console.log(`[onTaskUpsert] Propagating output changes from task: ${task.name}`);\n            await (0,_update_propagation_utils__WEBPACK_IMPORTED_MODULE_8__.updateItemsCreatedByTask)(task, previousTask);\n        }\n        // Propagate to Player (points delta)\n        if ((0,_update_propagation_utils__WEBPACK_IMPORTED_MODULE_8__.hasRewardsChanged)(task, previousTask)) {\n            console.log(`[onTaskUpsert] Propagating points changes from task: ${task.name}`);\n            await (0,_update_propagation_utils__WEBPACK_IMPORTED_MODULE_8__.updatePlayerPointsFromSource)(\"task\", task, previousTask);\n        }\n    }\n    // Descriptive changes - update in-place\n    for (const field of DESCRIPTIVE_FIELDS){\n        if (previousTask[field] !== task[field]) {\n            await (0,_entities_logging__WEBPACK_IMPORTED_MODULE_1__.updateEntityLogField)(\"task\", task.id, field, previousTask[field], task[field]);\n        }\n    }\n}\n/**\r\n * Remove task effects when task is deleted\r\n * Tasks can have entries in multiple logs: tasks, financials, character, player, items\r\n */ async function removeTaskLogEntriesOnDelete(taskId) {\n    try {\n        console.log(`[removeTaskLogEntriesOnDelete] Starting cleanup for task: ${taskId}`);\n        // 1. Remove items created by this task\n        await (0,_item_creation_utils__WEBPACK_IMPORTED_MODULE_5__.removeItemsCreatedByTask)(taskId);\n        // 2. Remove financial records created by this task\n        await (0,_financial_record_utils__WEBPACK_IMPORTED_MODULE_7__.removeFinancialRecordsCreatedByTask)(taskId);\n        // 3. Remove player points that were awarded by this task (if points were badly given)\n        await removePlayerPointsFromTask(taskId);\n        // 3. Remove all Links related to this task\n        const taskLinks = await (0,_links_link_registry__WEBPACK_IMPORTED_MODULE_4__.getLinksFor)({\n            type: _types_enums__WEBPACK_IMPORTED_MODULE_0__.EntityType.TASK,\n            id: taskId\n        });\n        console.log(`[removeTaskLogEntriesOnDelete] Found ${taskLinks.length} links to remove`);\n        for (const link of taskLinks){\n            try {\n                await (0,_links_link_registry__WEBPACK_IMPORTED_MODULE_4__.removeLink)(link.id);\n                console.log(`[removeTaskLogEntriesOnDelete] ✅ Removed link: ${link.linkType}`);\n            } catch (error) {\n                console.error(`[removeTaskLogEntriesOnDelete] ❌ Failed to remove link ${link.id}:`, error);\n            }\n        }\n        // 4. Clear effects registry\n        await (0,_data_store_effects_registry__WEBPACK_IMPORTED_MODULE_2__.clearEffect)(`task:${taskId}:created`);\n        await (0,_data_store_effects_registry__WEBPACK_IMPORTED_MODULE_2__.clearEffect)(`task:${taskId}:itemCreated`);\n        await (0,_data_store_effects_registry__WEBPACK_IMPORTED_MODULE_2__.clearEffect)(`task:${taskId}:financialCreated`);\n        await (0,_data_store_effects_registry__WEBPACK_IMPORTED_MODULE_2__.clearEffect)(`task:${taskId}:pointsAwarded`);\n        await (0,_data_store_effects_registry__WEBPACK_IMPORTED_MODULE_2__.clearEffectsByPrefix)(\"task\", taskId, \"pointsLogged:\");\n        await (0,_data_store_effects_registry__WEBPACK_IMPORTED_MODULE_2__.clearEffectsByPrefix)(\"task\", taskId, \"financialLogged:\");\n        // 5. Remove log entries from all relevant logs\n        // Note: Log removal is handled client-side via API calls\n        // Server-side log removal would require implementing removeLogEntry in entities-logging.ts\n        console.log(`[removeTaskLogEntriesOnDelete] Log entry removal handled client-side for task: ${taskId}`);\n        console.log(`[removeTaskLogEntriesOnDelete] ✅ Cleared effects, removed links for task ${taskId}`);\n    } catch (error) {\n        console.error(\"Error removing task effects:\", error);\n    }\n}\n/**\r\n * Remove player points that were awarded by a specific task\r\n * This is used when rolling back a task that incorrectly awarded points\r\n */ async function removePlayerPointsFromTask(taskId) {\n    try {\n        console.log(`[removePlayerPointsFromTask] Removing points for task: ${taskId}`);\n        // Get the task to find what points were awarded\n        const tasks = await (0,_data_store_datastore__WEBPACK_IMPORTED_MODULE_3__.getAllTasks)();\n        const task = tasks.find((t)=>t.id === taskId);\n        if (!task || !task.rewards?.points) {\n            console.log(`[removePlayerPointsFromTask] Task ${taskId} has no points to remove`);\n            return;\n        }\n        // Get the main player\n        const mainPlayerId = (0,_points_rewards_utils__WEBPACK_IMPORTED_MODULE_6__.getMainPlayerId)();\n        const players = await (0,_data_store_datastore__WEBPACK_IMPORTED_MODULE_3__.getAllPlayers)();\n        const mainPlayer = players.find((p)=>p.id === mainPlayerId);\n        if (!mainPlayer) {\n            console.log(`[removePlayerPointsFromTask] Main player not found, skipping points removal`);\n            return;\n        }\n        // Check if any points were actually awarded\n        const pointsToRemove = task.rewards.points;\n        const hasPoints = (pointsToRemove.xp || 0) > 0 || (pointsToRemove.rp || 0) > 0 || (pointsToRemove.fp || 0) > 0 || (pointsToRemove.hp || 0) > 0;\n        if (!hasPoints) {\n            console.log(`[removePlayerPointsFromTask] No points to remove from task ${taskId}`);\n            return;\n        }\n        // Remove the points from the player\n        await (0,_points_rewards_utils__WEBPACK_IMPORTED_MODULE_6__.removePointsFromPlayer)(mainPlayerId, pointsToRemove);\n        console.log(`[removePlayerPointsFromTask] ✅ Removed points from player: ${JSON.stringify(pointsToRemove)}`);\n    } catch (error) {\n        console.error(`[removePlayerPointsFromTask] ❌ Failed to remove player points for task ${taskId}:`, error);\n    }\n}\n/**\r\n * Uncomplete a task and remove effects\r\n * This function handles when a task status changes back from Done\r\n * Reverses all side effects that were applied during completion\r\n */ async function uncompleteTask(taskId) {\n    try {\n        console.log(`[uncompleteTask] Uncompleting task: ${taskId}`);\n        // Get the task\n        const tasks = await (0,_data_store_datastore__WEBPACK_IMPORTED_MODULE_3__.getAllTasks)();\n        const task = tasks.find((t)=>t.id === taskId);\n        if (!task) {\n            console.log(`[uncompleteTask] Task ${taskId} not found`);\n            return;\n        }\n        // Check if task was previously completed (has doneAt)\n        if (!task.doneAt) {\n            console.log(`[uncompleteTask] Task ${taskId} was not completed, nothing to uncomplete`);\n            return;\n        }\n        console.log(`[uncompleteTask] Reversing completion for task: ${task.name}`);\n        // 1. Remove items created by this task\n        await (0,_item_creation_utils__WEBPACK_IMPORTED_MODULE_5__.removeItemsCreatedByTask)(taskId);\n        console.log(`[uncompleteTask] ✅ Removed items created by task`);\n        // 2. Remove points awarded by this task\n        await removePlayerPointsFromTask(taskId);\n        console.log(`[uncompleteTask] ✅ Removed points awarded by task`);\n        // 3. Clear effects registry entries\n        await (0,_data_store_effects_registry__WEBPACK_IMPORTED_MODULE_2__.clearEffect)(`task:${taskId}:itemCreated`);\n        await (0,_data_store_effects_registry__WEBPACK_IMPORTED_MODULE_2__.clearEffect)(`task:${taskId}:pointsAwarded`);\n        console.log(`[uncompleteTask] ✅ Cleared effects registry entries`);\n        // 4. Log UNCOMPLETED event\n        await (0,_entities_logging__WEBPACK_IMPORTED_MODULE_1__.appendEntityLog)(\"task\", taskId, \"UNCOMPLETED\", {\n            name: task.name,\n            previousStatus: \"Done\",\n            uncompletedAt: new Date().toISOString()\n        });\n        console.log(`[uncompleteTask] ✅ Logged UNCOMPLETED event`);\n        console.log(`[uncompleteTask] ✅ Successfully uncompleted task: ${task.name}`);\n    } catch (error) {\n        console.error(`[uncompleteTask] ❌ Failed to uncomplete task ${taskId}:`, error);\n        throw error;\n    }\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi93b3JrZmxvd3MvZW50aXRpZXMtd29ya2Zsb3dzL3Rhc2sud29ya2Zsb3cudHMiLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7Ozs7O0FBQUEsZ0RBQWdEO0FBQ2hELG1FQUFtRTtBQUV4QjtBQUVpQztBQUM2QjtBQUVyQztBQUNKO0FBQ3NCO0FBQ2lCO0FBQ3VDO0FBUXpHO0FBRXJDLE1BQU13QixlQUFlO0lBQUM7SUFBVTtJQUFZO0lBQVU7SUFBZTtJQUFVO0NBQWU7QUFDOUYsTUFBTUMscUJBQXFCO0lBQUM7SUFBUTtJQUFlO0lBQVE7SUFBVztJQUFXO0NBQVc7QUFFckYsZUFBZUMsYUFBYUMsSUFBVSxFQUFFQyxZQUFtQjtJQUNoRSxvQkFBb0I7SUFDcEIsSUFBSSxDQUFDQSxjQUFjO1FBQ2pCLE1BQU1DLFlBQVksQ0FBQyxLQUFLLEVBQUVGLEtBQUtHLEVBQUUsQ0FBQyxRQUFRLENBQUM7UUFDM0MsSUFBSSxNQUFNM0IsdUVBQVNBLENBQUMwQixZQUFZO1FBRWhDLE1BQU01QixrRUFBZUEsQ0FBQyxRQUFRMEIsS0FBS0csRUFBRSxFQUFFLFdBQVc7WUFDaERDLE1BQU1KLEtBQUtJLElBQUk7WUFDZkMsUUFBUUwsS0FBS0ssTUFBTTtZQUNuQkMsU0FBU04sS0FBS00sT0FBTztRQUN2QjtRQUNBLE1BQU03Qix3RUFBVUEsQ0FBQ3lCO1FBQ2pCO0lBQ0Y7SUFFQSxpQ0FBaUM7SUFDakMsSUFBSUQsYUFBYUksTUFBTSxLQUFLTCxLQUFLSyxNQUFNLEVBQUU7UUFDdkNFLFFBQVFDLEdBQUcsQ0FBQyxDQUFDLG9DQUFvQyxFQUFFUCxhQUFhSSxNQUFNLENBQUMsR0FBRyxFQUFFTCxLQUFLSyxNQUFNLENBQUMsQ0FBQztRQUV6Riw0Q0FBNEM7UUFDNUMsTUFBTS9CLGtFQUFlQSxDQUFDLFFBQVEwQixLQUFLRyxFQUFFLEVBQUUsa0JBQWtCO1lBQ3ZETSxXQUFXUixhQUFhSSxNQUFNO1lBQzlCSyxXQUFXVixLQUFLSyxNQUFNO1lBQ3RCRCxNQUFNSixLQUFL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ZWdhbWUtYWRtaW4vLi93b3JrZmxvd3MvZW50aXRpZXMtd29ya2Zsb3dzL3Rhc2sud29ya2Zsb3cudHM/Nzg2OSJdLCJzb3VyY2VzQ29udGVudCI6WyIvLyB3b3JrZmxvd3MvZW50aXRpZXMtd29ya2Zsb3dzL3Rhc2sud29ya2Zsb3cudHNcclxuLy8gVGFzay1zcGVjaWZpYyB3b3JrZmxvdyB3aXRoIHN0YXRlIHZzIGRlc2NyaXB0aXZlIGZpZWxkIGRldGVjdGlvblxyXG5cclxuaW1wb3J0IHsgRW50aXR5VHlwZSB9IGZyb20gJ0AvdHlwZXMvZW51bXMnO1xyXG5pbXBvcnQgdHlwZSB7IFRhc2sgfSBmcm9tICdAL3R5cGVzL2VudGl0aWVzJztcclxuaW1wb3J0IHsgYXBwZW5kRW50aXR5TG9nLCB1cGRhdGVFbnRpdHlMb2dGaWVsZCB9IGZyb20gJy4uL2VudGl0aWVzLWxvZ2dpbmcnO1xyXG5pbXBvcnQgeyBoYXNFZmZlY3QsIG1hcmtFZmZlY3QsIGNsZWFyRWZmZWN0LCBjbGVhckVmZmVjdHNCeVByZWZpeCB9IGZyb20gJ0AvZGF0YS1zdG9yZS9lZmZlY3RzLXJlZ2lzdHJ5JztcclxuaW1wb3J0IHsgQ2xpZW50QVBJIH0gZnJvbSAnQC9saWIvY2xpZW50LWFwaSc7XHJcbmltcG9ydCB7IGdldEFsbFRhc2tzLCBnZXRBbGxQbGF5ZXJzIH0gZnJvbSAnQC9kYXRhLXN0b3JlL2RhdGFzdG9yZSc7XHJcbmltcG9ydCB7IGdldExpbmtzRm9yLCByZW1vdmVMaW5rIH0gZnJvbSAnQC9saW5rcy9saW5rLXJlZ2lzdHJ5JztcclxuaW1wb3J0IHsgY3JlYXRlSXRlbUZyb21UYXNrLCByZW1vdmVJdGVtc0NyZWF0ZWRCeVRhc2sgfSBmcm9tICcuLi9pdGVtLWNyZWF0aW9uLXV0aWxzJztcclxuaW1wb3J0IHsgYXdhcmRQb2ludHNUb1BsYXllciwgcmVtb3ZlUG9pbnRzRnJvbVBsYXllciwgZ2V0TWFpblBsYXllcklkIH0gZnJvbSAnLi4vcG9pbnRzLXJld2FyZHMtdXRpbHMnO1xyXG5pbXBvcnQgeyBjcmVhdGVGaW5hbmNpYWxSZWNvcmRGcm9tVGFzaywgdXBkYXRlRmluYW5jaWFsUmVjb3JkRnJvbVRhc2ssIHJlbW92ZUZpbmFuY2lhbFJlY29yZHNDcmVhdGVkQnlUYXNrIH0gZnJvbSAnLi4vZmluYW5jaWFsLXJlY29yZC11dGlscyc7XHJcbmltcG9ydCB7IFxyXG4gIHVwZGF0ZUZpbmFuY2lhbFJlY29yZHNGcm9tVGFzaywgXHJcbiAgdXBkYXRlSXRlbXNDcmVhdGVkQnlUYXNrLCBcclxuICB1cGRhdGVQbGF5ZXJQb2ludHNGcm9tU291cmNlLFxyXG4gIGhhc0ZpbmFuY2lhbFByb3BzQ2hhbmdlZCxcclxuICBoYXNPdXRwdXRQcm9wc0NoYW5nZWQsXHJcbiAgaGFzUmV3YXJkc0NoYW5nZWRcclxufSBmcm9tICcuLi91cGRhdGUtcHJvcGFnYXRpb24tdXRpbHMnO1xyXG5cclxuY29uc3QgU1RBVEVfRklFTERTID0gWydzdGF0dXMnLCAncHJvZ3Jlc3MnLCAnZG9uZUF0JywgJ2NvbGxlY3RlZEF0JywgJ3NpdGVJZCcsICd0YXJnZXRTaXRlSWQnXTtcclxuY29uc3QgREVTQ1JJUFRJVkVfRklFTERTID0gWyduYW1lJywgJ2Rlc2NyaXB0aW9uJywgJ2Nvc3QnLCAncmV2ZW51ZScsICdyZXdhcmRzJywgJ3ByaW9yaXR5J107XHJcblxyXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gb25UYXNrVXBzZXJ0KHRhc2s6IFRhc2ssIHByZXZpb3VzVGFzaz86IFRhc2spOiBQcm9taXNlPHZvaWQ+IHtcclxuICAvLyBOZXcgdGFzayBjcmVhdGlvblxyXG4gIGlmICghcHJldmlvdXNUYXNrKSB7XHJcbiAgICBjb25zdCBlZmZlY3RLZXkgPSBgdGFzazoke3Rhc2suaWR9OmNyZWF0ZWRgO1xyXG4gICAgaWYgKGF3YWl0IGhhc0VmZmVjdChlZmZlY3RLZXkpKSByZXR1cm47XHJcbiAgICBcclxuICAgIGF3YWl0IGFwcGVuZEVudGl0eUxvZygndGFzaycsIHRhc2suaWQsICdDUkVBVEVEJywgeyBcclxuICAgICAgbmFtZTogdGFzay5uYW1lLCBcclxuICAgICAgc3RhdHVzOiB0YXNrLnN0YXR1cyxcclxuICAgICAgc3RhdGlvbjogdGFzay5zdGF0aW9uIFxyXG4gICAgfSk7XHJcbiAgICBhd2FpdCBtYXJrRWZmZWN0KGVmZmVjdEtleSk7XHJcbiAgICByZXR1cm47XHJcbiAgfVxyXG4gIFxyXG4gIC8vIFN0YXRlIGNoYW5nZXMgLSBhcHBlbmQgbmV3IGxvZ1xyXG4gIGlmIChwcmV2aW91c1Rhc2suc3RhdHVzICE9PSB0YXNrLnN0YXR1cykge1xyXG4gICAgY29uc29sZS5sb2coYFtvblRhc2tVcHNlcnRdIFRhc2sgc3RhdHVzIGNoYW5nZWQ6ICR7cHJldmlvdXNUYXNrLnN0YXR1c30g4oaSICR7dGFzay5zdGF0dXN9YCk7XHJcbiAgICBcclxuICAgIC8vIExvZyBzdGF0dXMgY2hhbmdlIHdpdGggdHJhbnNpdGlvbiBjb250ZXh0XHJcbiAgICBhd2FpdCBhcHBlbmRFbnRpdHlMb2coJ3Rhc2snLCB0YXNrLmlkLCAnU1RBVFVTX0NIQU5HRUQnLCB7XHJcbiAgICAgIG9sZFN0YXR1czogcHJldmlvdXNUYXNrLnN0YXR1cyxcclxuICAgICAgbmV3U3RhdHVzOiB0YXNrLnN0YXR1cyxcclxuICAgICAgbmFtZTogdGFzay5uYW1lLFxyXG4gICAgICB0cmFuc2l0aW9uOiBgJHtwcmV2aW91c1Rhc2suc3RhdHVzfSDihpIgJHt0YXNrLnN0YXR1c31gLFxyXG4gICAgICBjaGFuZ2VkQXQ6IG5ldyBEYXRlKCkudG9JU09TdHJpbmcoKVxyXG4gICAgfSk7XHJcbiAgICBcclxuICAgIC8vIEhhbmRsZSB1bmNvbXBsZXRpb24gKERvbmUg4oaSIE90aGVyIHN0YXR1cylcclxuICAgIGlmIChwcmV2aW91c1Rhc2suc3RhdHVzID09PSAnRG9uZScgJiYgdGFzay5zdGF0dXMgIT09ICdEb25lJyAmJiB0YXNrLnN0YXR1cyAhPT0gJ0NvbGxlY3RlZCcpIHtcclxuICAgICAgY29uc29sZS5sb2coYFtvblRhc2tVcHNlcnRdIFRhc2sgdW5jb21wbGV0ZWQ6ICR7dGFzay5uYW1lfSAoJHtwcmV2aW91c1Rhc2suc3RhdHVzfSDihpIgJHt0YXNrLnN0YXR1c30pYCk7XHJcbiAgICAgIFxyXG4gICAgICAvLyBVbmNvbXBsZXRlIHRoZSB0YXNrIGFuZCByZW1vdmUgZWZmZWN0c1xyXG4gICAgICBhd2FpdCB1bmNvbXBsZXRlVGFzayh0YXNrLmlkKTtcclxuICAgIH1cclxuICB9XHJcbiAgXHJcbiAgaWYgKCFwcmV2aW91c1Rhc2suZG9uZUF0ICYmIHRhc2suZG9uZUF0KSB7XHJcbiAgICBhd2FpdCBhcHBlbmRFbnRpdHlMb2coJ3Rhc2snLCB0YXNrLmlkLCAnRE9ORScsIHtcclxuICAgICAgbmFtZTogdGFzay5uYW1lLFxyXG4gICAgICBkb25lQXQ6IHRhc2suZG9uZUF0XHJcbiAgICB9KTtcclxuICB9XHJcbiAgXHJcbiAgaWYgKCFwcmV2aW91c1Rhc2suY29sbGVjdGVkQXQgJiYgdGFzay5jb2xsZWN0ZWRBdCkge1xyXG4gICAgYXdhaXQgYXBwZW5kRW50aXR5TG9nKCd0YXNrJywgdGFzay5pZCwgJ0NPTExFQ1RFRCcsIHtcclxuICAgICAgbmFtZTogdGFzay5uYW1lLFxyXG4gICAgICBjb2xsZWN0ZWRBdDogdGFzay5jb2xsZWN0ZWRBdFxyXG4gICAgfSk7XHJcbiAgfVxyXG4gIFxyXG4gIC8vIFNpdGUgY2hhbmdlcyAtIE1PVkVEIGV2ZW50XHJcbiAgaWYgKHByZXZpb3VzVGFzay5zaXRlSWQgIT09IHRhc2suc2l0ZUlkIHx8IHByZXZpb3VzVGFzay50YXJnZXRTaXRlSWQgIT09IHRhc2sudGFyZ2V0U2l0ZUlkKSB7XHJcbiAgICBhd2FpdCBhcHBlbmRFbnRpdHlMb2coJ3Rhc2snLCB0YXNrLmlkLCAnTU9WRUQnLCB7XHJcbiAgICAgIG5hbWU6IHRhc2submFtZSxcclxuICAgICAgb2xkU2l0ZUlkOiBwcmV2aW91c1Rhc2suc2l0ZUlkLFxyXG4gICAgICBuZXdTaXRlSWQ6IHRhc2suc2l0ZUlkLFxyXG4gICAgICBvbGRUYXJnZXRTaXRlSWQ6IHByZXZpb3VzVGFzay50YXJnZXRTaXRlSWQsXHJcbiAgICAgIG5ld1RhcmdldFNpdGVJZDogdGFzay50YXJnZXRTaXRlSWRcclxuICAgIH0pO1xyXG4gIH1cclxuICBcclxuICAvLyBJdGVtIGNyZWF0aW9uIGZyb20gZW1pc3NhcnkgZmllbGRzIC0gd2hlbiB0YXNrIGlzIGNvbXBsZXRlZFxyXG4gIGlmICh0YXNrLm91dHB1dEl0ZW1UeXBlICYmIHRhc2sub3V0cHV0UXVhbnRpdHkgJiYgdGFzay5zdGF0dXMgPT09ICdEb25lJykge1xyXG4gICAgY29uc3QgZWZmZWN0S2V5ID0gYHRhc2s6JHt0YXNrLmlkfTppdGVtQ3JlYXRlZGA7XHJcbiAgICBpZiAoIShhd2FpdCBoYXNFZmZlY3QoZWZmZWN0S2V5KSkpIHtcclxuICAgICAgY29uc29sZS5sb2coYFtvblRhc2tVcHNlcnRdIENyZWF0aW5nIGl0ZW0gZnJvbSB0YXNrIGVtaXNzYXJ5IGZpZWxkczogJHt0YXNrLm5hbWV9YCk7XHJcbiAgICAgIGNvbnN0IGNyZWF0ZWRJdGVtID0gYXdhaXQgY3JlYXRlSXRlbUZyb21UYXNrKHRhc2spO1xyXG4gICAgICBpZiAoY3JlYXRlZEl0ZW0pIHtcclxuICAgICAgICBhd2FpdCBtYXJrRWZmZWN0KGVmZmVjdEtleSk7XHJcbiAgICAgICAgY29uc29sZS5sb2coYFtvblRhc2tVcHNlcnRdIOKchSBJdGVtIGNyZWF0ZWQgYW5kIGVmZmVjdCBtYXJrZWQ6ICR7Y3JlYXRlZEl0ZW0ubmFtZX1gKTtcclxuICAgICAgfVxyXG4gICAgfVxyXG4gIH1cclxuICBcclxuICAvLyBQb2ludHMgYXdhcmRpbmcgLSB3aGVuIHRhc2sgaXMgY29tcGxldGVkIHdpdGggcmV3YXJkc1xyXG4gIGlmICh0YXNrLnN0YXR1cyA9PT0gJ0RvbmUnICYmIHRhc2sucmV3YXJkcz8ucG9pbnRzKSB7XHJcbiAgICBjb25zdCBlZmZlY3RLZXkgPSBgdGFzazoke3Rhc2suaWR9OnBvaW50c0F3YXJkZWRgO1xyXG4gICAgaWYgKCEoYXdhaXQgaGFzRWZmZWN0KGVmZmVjdEtleSkpKSB7XHJcbiAgICAgIGNvbnNvbGUubG9nKGBbb25UYXNrVXBzZXJ0XSBBd2FyZGluZyBwb2ludHMgZnJvbSB0YXNrIGNvbXBsZXRpb246ICR7dGFzay5uYW1lfWApO1xyXG4gICAgICBhd2FpdCBhd2FyZFBvaW50c1RvUGxheWVyKGdldE1haW5QbGF5ZXJJZCgpLCB0YXNrLnJld2FyZHMucG9pbnRzLCB0YXNrLmlkLCAndGFzaycpO1xyXG4gICAgICBhd2FpdCBtYXJrRWZmZWN0KGVmZmVjdEtleSk7XHJcbiAgICAgIGNvbnNvbGUubG9nKGBbb25UYXNrVXBzZXJ0XSDinIUgUG9pbnRzIGF3YXJkZWQgYW5kIGVmZmVjdCBtYXJrZWQgZm9yIHRhc2s6ICR7dGFzay5uYW1lfWApO1xyXG4gICAgfVxyXG4gIH1cclxuICBcclxuICAvLyBGaW5hbmNpYWwgcmVjb3JkIGNyZWF0aW9uIGZyb20gdGFzayAtIHdoZW4gdGFzayBoYXMgY29zdCBvciByZXZlbnVlXHJcbiAgaWYgKHRhc2suY29zdCB8fCB0YXNrLnJldmVudWUpIHtcclxuICAgIGNvbnN0IGVmZmVjdEtleSA9IGB0YXNrOiR7dGFzay5pZH06ZmluYW5jaWFsQ3JlYXRlZGA7XHJcbiAgICBpZiAoIShhd2FpdCBoYXNFZmZlY3QoZWZmZWN0S2V5KSkpIHtcclxuICAgICAgY29uc29sZS5sb2coYFtvblRhc2tVcHNlcnRdIENyZWF0aW5nIGZpbmFuY2lhbCByZWNvcmQgZnJvbSB0YXNrOiAke3Rhc2submFtZX1gKTtcclxuICAgICAgY29uc3QgY3JlYXRlZEZpbmFuY2lhbCA9IGF3YWl0IGNyZWF0ZUZpbmFuY2lhbFJlY29yZEZyb21UYXNrKHRhc2spO1xyXG4gICAgICBpZiAoY3JlYXRlZEZpbmFuY2lhbCkge1xyXG4gICAgICAgIGF3YWl0IG1hcmtFZmZlY3QoZWZmZWN0S2V5KTtcclxuICAgICAgICBjb25zb2xlLmxvZyhgW29uVGFza1Vwc2VydF0g4pyFIEZpbmFuY2lhbCByZWNvcmQgY3JlYXRlZCBhbmQgZWZmZWN0IG1hcmtlZDogJHtjcmVhdGVkRmluYW5jaWFsLm5hbWV9YCk7XHJcbiAgICAgIH1cclxuICAgIH1cclxuICB9XHJcbiAgXHJcbiAgLy8gQ09NUFJFSEVOU0lWRSBVUERBVEUgUFJPUEFHQVRJT04gLSB3aGVuIHRhc2sgcHJvcGVydGllcyBjaGFuZ2VcclxuICBpZiAocHJldmlvdXNUYXNrKSB7XHJcbiAgICAvLyBQcm9wYWdhdGUgdG8gRmluYW5jaWFsIFJlY29yZHNcclxuICAgIGlmIChoYXNGaW5hbmNpYWxQcm9wc0NoYW5nZWQodGFzaywgcHJldmlvdXNUYXNrKSkge1xyXG4gICAgICBjb25zb2xlLmxvZyhgW29uVGFza1Vwc2VydF0gUHJvcGFnYXRpbmcgZmluYW5jaWFsIGNoYW5nZXMgZnJvbSB0YXNrOiAke3Rhc2submFtZX1gKTtcclxuICAgICAgYXdhaXQgdXBkYXRlRmluYW5jaWFsUmVjb3Jkc0Zyb21UYXNrKHRhc2ssIHByZXZpb3VzVGFzayk7XHJcbiAgICB9XHJcbiAgICBcclxuICAgIC8vIFByb3BhZ2F0ZSB0byBJdGVtc1xyXG4gICAgaWYgKGhhc091dHB1dFByb3BzQ2hhbmdlZCh0YXNrLCBwcmV2aW91c1Rhc2spKSB7XHJcbiAgICAgIGNvbnNvbGUubG9nKGBbb25UYXNrVXBzZXJ0XSBQcm9wYWdhdGluZyBvdXRwdXQgY2hhbmdlcyBmcm9tIHRhc2s6ICR7dGFzay5uYW1lfWApO1xyXG4gICAgICBhd2FpdCB1cGRhdGVJdGVtc0NyZWF0ZWRCeVRhc2sodGFzaywgcHJldmlvdXNUYXNrKTtcclxuICAgIH1cclxuICAgIFxyXG4gICAgLy8gUHJvcGFnYXRlIHRvIFBsYXllciAocG9pbnRzIGRlbHRhKVxyXG4gICAgaWYgKGhhc1Jld2FyZHNDaGFuZ2VkKHRhc2ssIHByZXZpb3VzVGFzaykpIHtcclxuICAgICAgY29uc29sZS5sb2coYFtvblRhc2tVcHNlcnRdIFByb3BhZ2F0aW5nIHBvaW50cyBjaGFuZ2VzIGZyb20gdGFzazogJHt0YXNrLm5hbWV9YCk7XHJcbiAgICAgIGF3YWl0IHVwZGF0ZVBsYXllclBvaW50c0Zyb21Tb3VyY2UoJ3Rhc2snLCB0YXNrLCBwcmV2aW91c1Rhc2spO1xyXG4gICAgfVxyXG4gIH1cclxuICBcclxuICAvLyBEZXNjcmlwdGl2ZSBjaGFuZ2VzIC0gdXBkYXRlIGluLXBsYWNlXHJcbiAgZm9yIChjb25zdCBmaWVsZCBvZiBERVNDUklQVElWRV9GSUVMRFMpIHtcclxuICAgIGlmICgocHJldmlvdXNUYXNrIGFzIGFueSlbZmllbGRdICE9PSAodGFzayBhcyBhbnkpW2ZpZWxkXSkge1xyXG4gICAgICBhd2FpdCB1cGRhdGVFbnRpdHlMb2dGaWVsZCgndGFzaycsIHRhc2suaWQsIGZpZWxkLCAocHJldmlvdXNUYXNrIGFzIGFueSlbZmllbGRdLCAodGFzayBhcyBhbnkpW2ZpZWxkXSk7XHJcbiAgICB9XHJcbiAgfVxyXG59XHJcblxyXG4vKipcclxuICogUmVtb3ZlIHRhc2sgZWZmZWN0cyB3aGVuIHRhc2sgaXMgZGVsZXRlZFxyXG4gKiBUYXNrcyBjYW4gaGF2ZSBlbnRyaWVzIGluIG11bHRpcGxlIGxvZ3M6IHRhc2tzLCBmaW5hbmNpYWxzLCBjaGFyYWN0ZXIsIHBsYXllciwgaXRlbXNcclxuICovXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiByZW1vdmVUYXNrTG9nRW50cmllc09uRGVsZXRlKHRhc2tJZDogc3RyaW5nKTogUHJvbWlzZTx2b2lkPiB7XHJcbiAgdHJ5IHtcclxuICAgIGNvbnNvbGUubG9nKGBbcmVtb3ZlVGFza0xvZ0VudHJpZXNPbkRlbGV0ZV0gU3RhcnRpbmcgY2xlYW51cCBmb3IgdGFzazogJHt0YXNrSWR9YCk7XHJcbiAgICBcclxuICAgIC8vIDEuIFJlbW92ZSBpdGVtcyBjcmVhdGVkIGJ5IHRoaXMgdGFza1xyXG4gICAgYXdhaXQgcmVtb3ZlSXRlbXNDcmVhdGVkQnlUYXNrKHRhc2tJZCk7XHJcbiAgICBcclxuICAgIC8vIDIuIFJlbW92ZSBmaW5hbmNpYWwgcmVjb3JkcyBjcmVhdGVkIGJ5IHRoaXMgdGFza1xyXG4gICAgYXdhaXQgcmVtb3ZlRmluYW5jaWFsUmVjb3Jkc0NyZWF0ZWRCeVRhc2sodGFza0lkKTtcclxuICAgIFxyXG4gICAgLy8gMy4gUmVtb3ZlIHBsYXllciBwb2ludHMgdGhhdCB3ZXJlIGF3YXJkZWQgYnkgdGhpcyB0YXNrIChpZiBwb2ludHMgd2VyZSBiYWRseSBnaXZlbilcclxuICAgIGF3YWl0IHJlbW92ZVBsYXllclBvaW50c0Zyb21UYXNrKHRhc2tJZCk7XHJcbiAgICBcclxuICAgIC8vIDMuIFJlbW92ZSBhbGwgTGlua3MgcmVsYXRlZCB0byB0aGlzIHRhc2tcclxuICAgIGNvbnN0IHRhc2tMaW5rcyA9IGF3YWl0IGdldExpbmtzRm9yKHsgdHlwZTogRW50aXR5VHlwZS5UQVNLLCBpZDogdGFza0lkIH0pO1xyXG4gICAgY29uc29sZS5sb2coYFtyZW1vdmVUYXNrTG9nRW50cmllc09uRGVsZXRlXSBGb3VuZCAke3Rhc2tMaW5rcy5sZW5ndGh9IGxpbmtzIHRvIHJlbW92ZWApO1xyXG4gICAgXHJcbiAgICBmb3IgKGNvbnN0IGxpbmsgb2YgdGFza0xpbmtzKSB7XHJcbiAgICAgIHRyeSB7XHJcbiAgICAgICAgYXdhaXQgcmVtb3ZlTGluayhsaW5rLmlkKTtcclxuICAgICAgICBjb25zb2xlLmxvZyhgW3JlbW92ZVRhc2tMb2dFbnRyaWVzT25EZWxldGVdIOKchSBSZW1vdmVkIGxpbms6ICR7bGluay5saW5rVHlwZX1gKTtcclxuICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcclxuICAgICAgICBjb25zb2xlLmVycm9yKGBbcmVtb3ZlVGFza0xvZ0VudHJpZXNPbkRlbGV0ZV0g4p2MIEZhaWxlZCB0byByZW1vdmUgbGluayAke2xpbmsuaWR9OmAsIGVycm9yKTtcclxuICAgICAgfVxyXG4gICAgfVxyXG4gICAgXHJcbiAgICAvLyA0LiBDbGVhciBlZmZlY3RzIHJlZ2lzdHJ5XHJcbiAgICBhd2FpdCBjbGVhckVmZmVjdChgdGFzazoke3Rhc2tJZH06Y3JlYXRlZGApO1xyXG4gICAgYXdhaXQgY2xlYXJFZmZlY3QoYHRhc2s6JHt0YXNrSWR9Oml0ZW1DcmVhdGVkYCk7XHJcbiAgICBhd2FpdCBjbGVhckVmZmVjdChgdGFzazoke3Rhc2tJZH06ZmluYW5jaWFsQ3JlYXRlZGApO1xyXG4gICAgYXdhaXQgY2xlYXJFZmZlY3QoYHRhc2s6JHt0YXNrSWR9OnBvaW50c0F3YXJkZWRgKTtcclxuICAgIGF3YWl0IGNsZWFyRWZmZWN0c0J5UHJlZml4KCd0YXNrJywgdGFza0lkLCAncG9pbnRzTG9nZ2VkOicpO1xyXG4gICAgYXdhaXQgY2xlYXJFZmZlY3RzQnlQcmVmaXgoJ3Rhc2snLCB0YXNrSWQsICdmaW5hbmNpYWxMb2dnZWQ6Jyk7XHJcbiAgICBcclxuICAgIC8vIDUuIFJlbW92ZSBsb2cgZW50cmllcyBmcm9tIGFsbCByZWxldmFudCBsb2dzXHJcbiAgICAvLyBOb3RlOiBMb2cgcmVtb3ZhbCBpcyBoYW5kbGVkIGNsaWVudC1zaWRlIHZpYSBBUEkgY2FsbHNcclxuICAgIC8vIFNlcnZlci1zaWRlIGxvZyByZW1vdmFsIHdvdWxkIHJlcXVpcmUgaW1wbGVtZW50aW5nIHJlbW92ZUxvZ0VudHJ5IGluIGVudGl0aWVzLWxvZ2dpbmcudHNcclxuICAgIGNvbnNvbGUubG9nKGBbcmVtb3ZlVGFza0xvZ0VudHJpZXNPbkRlbGV0ZV0gTG9nIGVudHJ5IHJlbW92YWwgaGFuZGxlZCBjbGllbnQtc2lkZSBmb3IgdGFzazogJHt0YXNrSWR9YCk7XHJcbiAgICBcclxuICAgIGNvbnNvbGUubG9nKGBbcmVtb3ZlVGFza0xvZ0VudHJpZXNPbkRlbGV0ZV0g4pyFIENsZWFyZWQgZWZmZWN0cywgcmVtb3ZlZCBsaW5rcyBmb3IgdGFzayAke3Rhc2tJZH1gKTtcclxuICB9IGNhdGNoIChlcnJvcikge1xyXG4gICAgY29uc29sZS5lcnJvcignRXJyb3IgcmVtb3ZpbmcgdGFzayBlZmZlY3RzOicsIGVycm9yKTtcclxuICB9XHJcbn1cclxuXHJcbi8qKlxyXG4gKiBSZW1vdmUgcGxheWVyIHBvaW50cyB0aGF0IHdlcmUgYXdhcmRlZCBieSBhIHNwZWNpZmljIHRhc2tcclxuICogVGhpcyBpcyB1c2VkIHdoZW4gcm9sbGluZyBiYWNrIGEgdGFzayB0aGF0IGluY29ycmVjdGx5IGF3YXJkZWQgcG9pbnRzXHJcbiAqL1xyXG5hc3luYyBmdW5jdGlvbiByZW1vdmVQbGF5ZXJQb2ludHNGcm9tVGFzayh0YXNrSWQ6IHN0cmluZyk6IFByb21pc2U8dm9pZD4ge1xyXG4gIHRyeSB7XHJcbiAgICBjb25zb2xlLmxvZyhgW3JlbW92ZVBsYXllclBvaW50c0Zyb21UYXNrXSBSZW1vdmluZyBwb2ludHMgZm9yIHRhc2s6ICR7dGFza0lkfWApO1xyXG4gICAgXHJcbiAgICAvLyBHZXQgdGhlIHRhc2sgdG8gZmluZCB3aGF0IHBvaW50cyB3ZXJlIGF3YXJkZWRcclxuICAgIGNvbnN0IHRhc2tzID0gYXdhaXQgZ2V0QWxsVGFza3MoKTtcclxuICAgIGNvbnN0IHRhc2sgPSB0YXNrcy5maW5kKHQgPT4gdC5pZCA9PT0gdGFza0lkKTtcclxuICAgIFxyXG4gICAgaWYgKCF0YXNrIHx8ICF0YXNrLnJld2FyZHM/LnBvaW50cykge1xyXG4gICAgICBjb25zb2xlLmxvZyhgW3JlbW92ZVBsYXllclBvaW50c0Zyb21UYXNrXSBUYXNrICR7dGFza0lkfSBoYXMgbm8gcG9pbnRzIHRvIHJlbW92ZWApO1xyXG4gICAgICByZXR1cm47XHJcbiAgICB9XHJcbiAgICBcclxuICAgIC8vIEdldCB0aGUgbWFpbiBwbGF5ZXJcclxuICAgIGNvbnN0IG1haW5QbGF5ZXJJZCA9IGdldE1haW5QbGF5ZXJJZCgpO1xyXG4gICAgY29uc3QgcGxheWVycyA9IGF3YWl0IGdldEFsbFBsYXllcnMoKTtcclxuICAgIGNvbnN0IG1haW5QbGF5ZXIgPSBwbGF5ZXJzLmZpbmQocCA9PiBwLmlkID09PSBtYWluUGxheWVySWQpO1xyXG4gICAgXHJcbiAgICBpZiAoIW1haW5QbGF5ZXIpIHtcclxuICAgICAgY29uc29sZS5sb2coYFtyZW1vdmVQbGF5ZXJQb2ludHNGcm9tVGFza10gTWFpbiBwbGF5ZXIgbm90IGZvdW5kLCBza2lwcGluZyBwb2ludHMgcmVtb3ZhbGApO1xyXG4gICAgICByZXR1cm47XHJcbiAgICB9XHJcbiAgICBcclxuICAgIC8vIENoZWNrIGlmIGFueSBwb2ludHMgd2VyZSBhY3R1YWxseSBhd2FyZGVkXHJcbiAgICBjb25zdCBwb2ludHNUb1JlbW92ZSA9IHRhc2sucmV3YXJkcy5wb2ludHM7XHJcbiAgICBjb25zdCBoYXNQb2ludHMgPSAocG9pbnRzVG9SZW1vdmUueHAgfHwgMCkgPiAwIHx8IChwb2ludHNUb1JlbW92ZS5ycCB8fCAwKSA+IDAgfHwgXHJcbiAgICAgICAgICAgICAgICAgICAgIChwb2ludHNUb1JlbW92ZS5mcCB8fCAwKSA+IDAgfHwgKHBvaW50c1RvUmVtb3ZlLmhwIHx8IDApID4gMDtcclxuICAgIFxyXG4gICAgaWYgKCFoYXNQb2ludHMpIHtcclxuICAgICAgY29uc29sZS5sb2coYFtyZW1vdmVQbGF5ZXJQb2ludHNGcm9tVGFza10gTm8gcG9pbnRzIHRvIHJlbW92ZSBmcm9tIHRhc2sgJHt0YXNrSWR9YCk7XHJcbiAgICAgIHJldHVybjtcclxuICAgIH1cclxuICAgIFxyXG4gICAgLy8gUmVtb3ZlIHRoZSBwb2ludHMgZnJvbSB0aGUgcGxheWVyXHJcbiAgICBhd2FpdCByZW1vdmVQb2ludHNGcm9tUGxheWVyKG1haW5QbGF5ZXJJZCwgcG9pbnRzVG9SZW1vdmUpO1xyXG4gICAgY29uc29sZS5sb2coYFtyZW1vdmVQbGF5ZXJQb2ludHNGcm9tVGFza10g4pyFIFJlbW92ZWQgcG9pbnRzIGZyb20gcGxheWVyOiAke0pTT04uc3RyaW5naWZ5KHBvaW50c1RvUmVtb3ZlKX1gKTtcclxuICAgIFxyXG4gIH0gY2F0Y2ggKGVycm9yKSB7XHJcbiAgICBjb25zb2xlLmVycm9yKGBbcmVtb3ZlUGxheWVyUG9pbnRzRnJvbVRhc2tdIOKdjCBGYWlsZWQgdG8gcmVtb3ZlIHBsYXllciBwb2ludHMgZm9yIHRhc2sgJHt0YXNrSWR9OmAsIGVycm9yKTtcclxuICB9XHJcbn1cclxuXHJcbi8qKlxyXG4gKiBVbmNvbXBsZXRlIGEgdGFzayBhbmQgcmVtb3ZlIGVmZmVjdHNcclxuICogVGhpcyBmdW5jdGlvbiBoYW5kbGVzIHdoZW4gYSB0YXNrIHN0YXR1cyBjaGFuZ2VzIGJhY2sgZnJvbSBEb25lXHJcbiAqIFJldmVyc2VzIGFsbCBzaWRlIGVmZmVjdHMgdGhhdCB3ZXJlIGFwcGxpZWQgZHVyaW5nIGNvbXBsZXRpb25cclxuICovXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiB1bmNvbXBsZXRlVGFzayh0YXNrSWQ6IHN0cmluZyk6IFByb21pc2U8dm9pZD4ge1xyXG4gIHRyeSB7XHJcbiAgICBjb25zb2xlLmxvZyhgW3VuY29tcGxldGVUYXNrXSBVbmNvbXBsZXRpbmcgdGFzazogJHt0YXNrSWR9YCk7XHJcbiAgICBcclxuICAgIC8vIEdldCB0aGUgdGFza1xyXG4gICAgY29uc3QgdGFza3MgPSBhd2FpdCBnZXRBbGxUYXNrcygpO1xyXG4gICAgY29uc3QgdGFzayA9IHRhc2tzLmZpbmQodCA9PiB0LmlkID09PSB0YXNrSWQpO1xyXG4gICAgXHJcbiAgICBpZiAoIXRhc2spIHtcclxuICAgICAgY29uc29sZS5sb2coYFt1bmNvbXBsZXRlVGFza10gVGFzayAke3Rhc2tJZH0gbm90IGZvdW5kYCk7XHJcbiAgICAgIHJldHVybjtcclxuICAgIH1cclxuICAgIFxyXG4gICAgLy8gQ2hlY2sgaWYgdGFzayB3YXMgcHJldmlvdXNseSBjb21wbGV0ZWQgKGhhcyBkb25lQXQpXHJcbiAgICBpZiAoIXRhc2suZG9uZUF0KSB7XHJcbiAgICAgIGNvbnNvbGUubG9nKGBbdW5jb21wbGV0ZVRhc2tdIFRhc2sgJHt0YXNrSWR9IHdhcyBub3QgY29tcGxldGVkLCBub3RoaW5nIHRvIHVuY29tcGxldGVgKTtcclxuICAgICAgcmV0dXJuO1xyXG4gICAgfVxyXG4gICAgXHJcbiAgICBjb25zb2xlLmxvZyhgW3VuY29tcGxldGVUYXNrXSBSZXZlcnNpbmcgY29tcGxldGlvbiBmb3IgdGFzazogJHt0YXNrLm5hbWV9YCk7XHJcbiAgICBcclxuICAgIC8vIDEuIFJlbW92ZSBpdGVtcyBjcmVhdGVkIGJ5IHRoaXMgdGFza1xyXG4gICAgYXdhaXQgcmVtb3ZlSXRlbXNDcmVhdGVkQnlUYXNrKHRhc2tJZCk7XHJcbiAgICBjb25zb2xlLmxvZyhgW3VuY29tcGxldGVUYXNrXSDinIUgUmVtb3ZlZCBpdGVtcyBjcmVhdGVkIGJ5IHRhc2tgKTtcclxuICAgIFxyXG4gICAgLy8gMi4gUmVtb3ZlIHBvaW50cyBhd2FyZGVkIGJ5IHRoaXMgdGFza1xyXG4gICAgYXdhaXQgcmVtb3ZlUGxheWVyUG9pbnRzRnJvbVRhc2sodGFza0lkKTtcclxuICAgIGNvbnNvbGUubG9nKGBbdW5jb21wbGV0ZVRhc2tdIOKchSBSZW1vdmVkIHBvaW50cyBhd2FyZGVkIGJ5IHRhc2tgKTtcclxuICAgIFxyXG4gICAgLy8gMy4gQ2xlYXIgZWZmZWN0cyByZWdpc3RyeSBlbnRyaWVzXHJcbiAgICBhd2FpdCBjbGVhckVmZmVjdChgdGFzazoke3Rhc2tJZH06aXRlbUNyZWF0ZWRgKTtcclxuICAgIGF3YWl0IGNsZWFyRWZmZWN0KGB0YXNrOiR7dGFza0lkfTpwb2ludHNBd2FyZGVkYCk7XHJcbiAgICBjb25zb2xlLmxvZyhgW3VuY29tcGxldGVUYXNrXSDinIUgQ2xlYXJlZCBlZmZlY3RzIHJlZ2lzdHJ5IGVudHJpZXNgKTtcclxuICAgIFxyXG4gICAgLy8gNC4gTG9nIFVOQ09NUExFVEVEIGV2ZW50XHJcbiAgICBhd2FpdCBhcHBlbmRFbnRpdHlMb2coJ3Rhc2snLCB0YXNrSWQsICdVTkNPTVBMRVRFRCcsIHtcclxuICAgICAgbmFtZTogdGFzay5uYW1lLFxyXG4gICAgICBwcmV2aW91c1N0YXR1czogJ0RvbmUnLFxyXG4gICAgICB1bmNvbXBsZXRlZEF0OiBuZXcgRGF0ZSgpLnRvSVNPU3RyaW5nKClcclxuICAgIH0pO1xyXG4gICAgY29uc29sZS5sb2coYFt1bmNvbXBsZXRlVGFza10g4pyFIExvZ2dlZCBVTkNPTVBMRVRFRCBldmVudGApO1xyXG4gICAgXHJcbiAgICBjb25zb2xlLmxvZyhgW3VuY29tcGxldGVUYXNrXSDinIUgU3VjY2Vzc2Z1bGx5IHVuY29tcGxldGVkIHRhc2s6ICR7dGFzay5uYW1lfWApO1xyXG4gICAgXHJcbiAgfSBjYXRjaCAoZXJyb3IpIHtcclxuICAgIGNvbnNvbGUuZXJyb3IoYFt1bmNvbXBsZXRlVGFza10g4p2MIEZhaWxlZCB0byB1bmNvbXBsZXRlIHRhc2sgJHt0YXNrSWR9OmAsIGVycm9yKTtcclxuICAgIHRocm93IGVycm9yO1xyXG4gIH1cclxufVxyXG4iXSwibmFtZXMiOlsiRW50aXR5VHlwZSIsImFwcGVuZEVudGl0eUxvZyIsInVwZGF0ZUVudGl0eUxvZ0ZpZWxkIiwiaGFzRWZmZWN0IiwibWFya0VmZmVjdCIsImNsZWFyRWZmZWN0IiwiY2xlYXJFZmZlY3RzQnlQcmVmaXgiLCJnZXRBbGxUYXNrcyIsImdldEFsbFBsYXllcnMiLCJnZXRMaW5rc0ZvciIsInJlbW92ZUxpbmsiLCJjcmVhdGVJdGVtRnJvbVRhc2siLCJyZW1vdmVJdGVtc0NyZWF0ZWRCeVRhc2siLCJhd2FyZFBvaW50c1RvUGxheWVyIiwicmVtb3ZlUG9pbnRzRnJvbVBsYXllciIsImdldE1haW5QbGF5ZXJJZCIsImNyZWF0ZUZpbmFuY2lhbFJlY29yZEZyb21UYXNrIiwicmVtb3ZlRmluYW5jaWFsUmVjb3Jkc0NyZWF0ZWRCeVRhc2siLCJ1cGRhdGVGaW5hbmNpYWxSZWNvcmRzRnJvbVRhc2siLCJ1cGRhdGVJdGVtc0NyZWF0ZWRCeVRhc2siLCJ1cGRhdGVQbGF5ZXJQb2ludHNGcm9tU291cmNlIiwiaGFzRmluYW5jaWFsUHJvcHNDaGFuZ2VkIiwiaGFzT3V0cHV0UHJvcHNDaGFuZ2VkIiwiaGFzUmV3YXJkc0NoYW5nZWQiLCJTVEFURV9GSUVMRFMiLCJERVNDUklQVElWRV9GSUVMRFMiLCJvblRhc2tVcHNlcnQiLCJ0YXNrIiwicHJldmlvdXNUYXNrIiwiZWZmZWN0S2V5IiwiaWQiLCJuYW1lIiwic3RhdHVzIiwic3RhdGlvbiIsImNvbnNvbGUiLCJsb2ciLCJvbGRTdGF0dXMiLCJuZXdTdGF0dXMiLCJ0cmFuc2l0aW9uIiwiY2hhbmdlZEF0IiwiRGF0ZSIsInRvSVNPU3RyaW5nIiwidW5jb21wbGV0ZVRhc2siLCJkb25lQXQiLCJjb2xsZWN0ZWRBdCIsInNpdGVJZCIsInRhcmdldFNpdGVJZCIsIm9sZFNpdGVJZCIsIm5ld1NpdGVJZCIsIm9sZFRhcmdldFNpdGVJZCIsIm5ld1RhcmdldFNpdGVJZCIsIm91dHB1dEl0ZW1UeXBlIiwib3V0cHV0UXVhbnRpdHkiLCJjcmVhdGVkSXRlbSIsInJld2FyZHMiLCJwb2ludHMiLCJjb3N0IiwicmV2ZW51ZSIsImNyZWF0ZWRGaW5hbmNpYWwiLCJmaWVsZCIsInJlbW92ZVRhc2tMb2dFbnRyaWVzT25EZWxldGUiLCJ0YXNrSWQiLCJyZW1vdmVQbGF5ZXJQb2ludHNGcm9tVGFzayIsInRhc2tMaW5rcyIsInR5cGUiLCJUQVNLIiwibGVuZ3RoIiwibGluayIsImxpbmtUeXBlIiwiZXJyb3IiLCJ0YXNrcyIsImZpbmQiLCJ0IiwibWFpblBsYXllcklkIiwicGxheWVycyIsIm1haW5QbGF5ZXIiLCJwIiwicG9pbnRzVG9SZW1vdmUiLCJoYXNQb2ludHMiLCJ4cCIsInJwIiwiZnAiLCJocCIsIkpTT04iLCJzdHJpbmdpZnkiLCJwcmV2aW91c1N0YXR1cyIsInVuY29tcGxldGVkQXQiXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./workflows/entities-workflows/task.workflow.ts\n");

/***/ }),

/***/ "(rsc)/./workflows/financial-record-utils.ts":
/*!*********************************************!*\
  !*** ./workflows/financial-record-utils.ts ***!
  \*********************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   createFinancialRecordFromSale: () => (/* binding */ createFinancialRecordFromSale),\n/* harmony export */   createFinancialRecordFromTask: () => (/* binding */ createFinancialRecordFromTask),\n/* harmony export */   processFinancialRecordCreationWithLinks: () => (/* binding */ processFinancialRecordCreationWithLinks),\n/* harmony export */   removeFinancialRecordsCreatedByTask: () => (/* binding */ removeFinancialRecordsCreatedByTask),\n/* harmony export */   updateFinancialRecordFromTask: () => (/* binding */ updateFinancialRecordFromTask)\n/* harmony export */ });\n/* harmony import */ var _types_enums__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @/types/enums */ \"(rsc)/./types/enums.ts\");\n/* harmony import */ var _lib_client_api__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @/lib/client-api */ \"(rsc)/./lib/client-api.ts\");\n/* harmony import */ var _links_links_workflows__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @/links/links-workflows */ \"(rsc)/./links/links-workflows.ts\");\n/* harmony import */ var _links_link_registry__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! @/links/link-registry */ \"(rsc)/./links/link-registry.ts\");\n/* harmony import */ var _entities_logging__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./entities-logging */ \"(rsc)/./workflows/entities-logging.ts\");\n// workflows/financial-record-utils.ts\n// Financial record creation and management utilities\n\n\n\n\n\n/**\r\n * Create a financial record from a task (when task has cost or revenue)\r\n * This implements the emissary pattern: Task DNA → FinancialRecord entity\r\n */ async function createFinancialRecordFromTask(task) {\n    try {\n        console.log(`[createFinancialRecordFromTask] Starting financial record creation for task: ${task.name} (${task.id})`);\n        // Check if task has cost or revenue\n        if (!task.cost && !task.revenue) {\n            console.log(`[createFinancialRecordFromTask] Task ${task.name} has no cost or revenue, skipping financial record creation`);\n            return null;\n        }\n        // IDEMPOTENCY CHECK: Look for existing financial record created by this task\n        const allFinancials = await _lib_client_api__WEBPACK_IMPORTED_MODULE_1__.ClientAPI.getFinancialRecords();\n        const existingFinrec = allFinancials.find((fr)=>fr.sourceTaskId === task.id);\n        if (existingFinrec) {\n            console.log(`[createFinancialRecordFromTask] Financial record already exists for task ${task.id}, skipping creation`);\n            return existingFinrec;\n        }\n        const currentDate = new Date();\n        const newFinrec = {\n            id: `finrec-${task.id}-${Date.now()}`,\n            name: task.name,\n            description: `Financial record from task: ${task.name}`,\n            year: currentDate.getFullYear(),\n            month: currentDate.getMonth() + 1,\n            station: task.station,\n            type: \"company\",\n            siteId: task.siteId,\n            targetSiteId: task.targetSiteId,\n            sourceTaskId: task.id,\n            cost: task.cost || 0,\n            revenue: task.revenue || 0,\n            jungleCoins: 0,\n            isNotPaid: task.isNotPaid,\n            isNotCharged: task.isNotCharged,\n            rewards: task.rewards,\n            netCashflow: (task.revenue || 0) - (task.cost || 0),\n            jungleCoinsValue: 0,\n            isCollected: false,\n            createdAt: new Date(),\n            updatedAt: new Date(),\n            links: []\n        };\n        // Store the financial record\n        console.log(`[createFinancialRecordFromTask] Creating new financial record:`, newFinrec);\n        const createdFinrec = await _lib_client_api__WEBPACK_IMPORTED_MODULE_1__.ClientAPI.upsertFinancialRecord(newFinrec);\n        // Create TASK_FINREC link with metadata\n        const linkMetadata = {\n            cost: task.cost || 0,\n            revenue: task.revenue || 0,\n            isNotPaid: task.isNotPaid || false,\n            isNotCharged: task.isNotCharged || false,\n            rewards: task.rewards,\n            netCashflow: newFinrec.netCashflow,\n            createdFrom: \"task\"\n        };\n        const link = (0,_links_links_workflows__WEBPACK_IMPORTED_MODULE_2__.makeLink)(_types_enums__WEBPACK_IMPORTED_MODULE_0__.LinkType.TASK_FINREC, {\n            type: _types_enums__WEBPACK_IMPORTED_MODULE_0__.EntityType.TASK,\n            id: task.id\n        }, {\n            type: _types_enums__WEBPACK_IMPORTED_MODULE_0__.EntityType.FINANCIAL,\n            id: createdFinrec.id\n        }, linkMetadata);\n        await (0,_links_link_registry__WEBPACK_IMPORTED_MODULE_3__.createLink)(link);\n        console.log(`[createFinancialRecordFromTask] ✅ Financial record created and TASK_FINREC link established: ${createdFinrec.name}`);\n        return createdFinrec;\n    } catch (error) {\n        console.error(`[createFinancialRecordFromTask] ❌ Failed to create financial record from task ${task.id}:`, error);\n        throw error;\n    }\n}\n/**\r\n * Update an existing financial record when task properties change\r\n * This ensures financial records stay in sync with their source tasks\r\n */ async function updateFinancialRecordFromTask(task, previousTask) {\n    try {\n        console.log(`[updateFinancialRecordFromTask] Updating financial record for task: ${task.name} (${task.id})`);\n        // Find the existing financial record created by this task\n        const allFinancials = await _lib_client_api__WEBPACK_IMPORTED_MODULE_1__.ClientAPI.getFinancialRecords();\n        const existingFinrec = allFinancials.find((fr)=>fr.sourceTaskId === task.id);\n        if (!existingFinrec) {\n            console.log(`[updateFinancialRecordFromTask] No financial record found for task ${task.id}, creating new one`);\n            await createFinancialRecordFromTask(task);\n            return;\n        }\n        // Check if any financial properties changed\n        const financialPropsChanged = previousTask.cost !== task.cost || previousTask.revenue !== task.revenue || previousTask.isNotPaid !== task.isNotPaid || previousTask.isNotCharged !== task.isNotCharged || previousTask.name !== task.name || previousTask.station !== task.station || previousTask.siteId !== task.siteId || previousTask.targetSiteId !== task.targetSiteId;\n        if (!financialPropsChanged) {\n            console.log(`[updateFinancialRecordFromTask] No financial properties changed for task ${task.id}, skipping update`);\n            return;\n        }\n        // Update the financial record with new task data\n        const updatedFinrec = {\n            ...existingFinrec,\n            name: task.name,\n            description: `Financial record from task: ${task.name}`,\n            cost: task.cost || 0,\n            revenue: task.revenue || 0,\n            station: task.station,\n            siteId: task.siteId,\n            targetSiteId: task.targetSiteId,\n            isNotPaid: task.isNotPaid,\n            isNotCharged: task.isNotCharged,\n            rewards: task.rewards,\n            netCashflow: (task.revenue || 0) - (task.cost || 0),\n            updatedAt: new Date()\n        };\n        // Store the updated financial record\n        console.log(`[updateFinancialRecordFromTask] Updating financial record:`, updatedFinrec);\n        await _lib_client_api__WEBPACK_IMPORTED_MODULE_1__.ClientAPI.upsertFinancialRecord(updatedFinrec);\n        // Log the update\n        await (0,_entities_logging__WEBPACK_IMPORTED_MODULE_4__.appendEntityLog)(\"financial\", existingFinrec.id, \"UPDATED\", {\n            name: task.name,\n            updatedFrom: \"task\",\n            changes: {\n                cost: {\n                    from: previousTask.cost || 0,\n                    to: task.cost || 0\n                },\n                revenue: {\n                    from: previousTask.revenue || 0,\n                    to: task.revenue || 0\n                },\n                isNotPaid: {\n                    from: previousTask.isNotPaid || false,\n                    to: task.isNotPaid || false\n                },\n                isNotCharged: {\n                    from: previousTask.isNotCharged || false,\n                    to: task.isNotCharged || false\n                }\n            },\n            updatedAt: new Date().toISOString()\n        });\n        console.log(`[updateFinancialRecordFromTask] ✅ Financial record updated successfully for task: ${task.name}`);\n    } catch (error) {\n        console.error(`[updateFinancialRecordFromTask] ❌ Failed to update financial record for task ${task.id}:`, error);\n        throw error;\n    }\n}\n/**\r\n * Remove financial records created by a specific task\r\n * This is used when a task is deleted to clean up associated financial records\r\n */ async function removeFinancialRecordsCreatedByTask(taskId) {\n    try {\n        console.log(`[removeFinancialRecordsCreatedByTask] Removing financial records created by task: ${taskId}`);\n        // Find financial records created by this task\n        const allFinancials = await _lib_client_api__WEBPACK_IMPORTED_MODULE_1__.ClientAPI.getFinancialRecords();\n        const taskFinancials = allFinancials.filter((fr)=>fr.sourceTaskId === taskId);\n        if (taskFinancials.length === 0) {\n            console.log(`[removeFinancialRecordsCreatedByTask] No financial records found for task ${taskId}`);\n            return;\n        }\n        console.log(`[removeFinancialRecordsCreatedByTask] Found ${taskFinancials.length} financial record(s) to remove`);\n        // Remove each financial record\n        for (const financial of taskFinancials){\n            try {\n                await _lib_client_api__WEBPACK_IMPORTED_MODULE_1__.ClientAPI.deleteFinancialRecord(financial.id);\n                console.log(`[removeFinancialRecordsCreatedByTask] ✅ Removed financial record: ${financial.name}`);\n            } catch (error) {\n                console.error(`[removeFinancialRecordsCreatedByTask] ❌ Failed to remove financial record ${financial.id}:`, error);\n            }\n        }\n        console.log(`[removeFinancialRecordsCreatedByTask] ✅ Removed ${taskFinancials.length} financial record(s) for task ${taskId}`);\n    } catch (error) {\n        console.error(`[removeFinancialRecordsCreatedByTask] ❌ Failed to remove financial records for task ${taskId}:`, error);\n        throw error;\n    }\n}\n/**\r\n * Create a financial record from a sale (when sale has revenue)\r\n * This implements the emissary pattern: Sale DNA → FinancialRecord entity\r\n */ async function createFinancialRecordFromSale(sale) {\n    try {\n        console.log(`[createFinancialRecordFromSale] Creating financial record from sale: ${sale.counterpartyName}`);\n        // Check if sale has revenue\n        if (sale.totals.totalRevenue <= 0) {\n            console.log(`[createFinancialRecordFromSale] Sale ${sale.id} has no revenue, skipping financial record creation`);\n            return null;\n        }\n        // IDEMPOTENCY CHECK: Look for existing financial record created by this sale\n        const allFinancials = await _lib_client_api__WEBPACK_IMPORTED_MODULE_1__.ClientAPI.getFinancialRecords();\n        const existingFinrec = allFinancials.find((fr)=>fr.sourceSaleId === sale.id);\n        if (existingFinrec) {\n            console.log(`[createFinancialRecordFromSale] Financial record already exists for sale ${sale.id}, skipping creation`);\n            return existingFinrec;\n        }\n        const currentDate = new Date();\n        const newFinrec = {\n            id: `finrec-${sale.id}-${Date.now()}`,\n            name: `Sale: ${sale.counterpartyName}`,\n            description: `Financial record from sale: ${sale.counterpartyName}`,\n            year: currentDate.getFullYear(),\n            month: currentDate.getMonth() + 1,\n            station: \"Sales\",\n            type: \"company\",\n            siteId: sale.siteId,\n            targetSiteId: undefined,\n            sourceSaleId: sale.id,\n            cost: 0,\n            revenue: sale.totals.totalRevenue,\n            jungleCoins: 0,\n            isNotPaid: sale.isNotPaid || false,\n            isNotCharged: sale.isNotCharged || false,\n            rewards: {\n                points: {\n                    xp: 0,\n                    rp: 0,\n                    fp: 0,\n                    hp: 0\n                }\n            },\n            netCashflow: sale.totals.totalRevenue,\n            jungleCoinsValue: 0,\n            isCollected: false,\n            createdAt: new Date(),\n            updatedAt: new Date(),\n            links: []\n        };\n        // Store the financial record\n        console.log(`[createFinancialRecordFromSale] Creating financial record:`, newFinrec);\n        const createdFinrec = await _lib_client_api__WEBPACK_IMPORTED_MODULE_1__.ClientAPI.upsertFinancialRecord(newFinrec);\n        // Create SALE_FINREC link\n        const linkMetadata = {\n            revenue: sale.totals.totalRevenue,\n            isNotPaid: sale.isNotPaid || false,\n            isNotCharged: sale.isNotCharged || false,\n            netCashflow: newFinrec.netCashflow,\n            createdFrom: \"sale\"\n        };\n        const link = (0,_links_links_workflows__WEBPACK_IMPORTED_MODULE_2__.makeLink)(_types_enums__WEBPACK_IMPORTED_MODULE_0__.LinkType.SALE_FINREC, {\n            type: _types_enums__WEBPACK_IMPORTED_MODULE_0__.EntityType.SALE,\n            id: sale.id\n        }, {\n            type: _types_enums__WEBPACK_IMPORTED_MODULE_0__.EntityType.FINANCIAL,\n            id: createdFinrec.id\n        }, linkMetadata);\n        await (0,_links_link_registry__WEBPACK_IMPORTED_MODULE_3__.createLink)(link);\n        console.log(`[createFinancialRecordFromSale] ✅ Financial record created and SALE_FINREC link established: ${createdFinrec.name}`);\n        return createdFinrec;\n    } catch (error) {\n        console.error(`[createFinancialRecordFromSale] ❌ Failed to create financial record from sale ${sale.id}:`, error);\n        throw error;\n    }\n}\n/**\r\n * Enhanced financial record creation - pure business logic, no link creation\r\n */ async function processFinancialRecordCreationWithLinks(record) {\n    console.log(`[processFinancialRecordCreationWithLinks] Processing financial record creation: ${record.name} (${record.id})`);\n    return record;\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi93b3JrZmxvd3MvZmluYW5jaWFsLXJlY29yZC11dGlscy50cyIsIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7O0FBQUEsc0NBQXNDO0FBQ3RDLHFEQUFxRDtBQUdBO0FBQ1I7QUFDTTtBQUNBO0FBQ0U7QUFFckQ7OztDQUdDLEdBQ00sZUFBZU0sOEJBQThCQyxJQUFVO0lBQzVELElBQUk7UUFDRkMsUUFBUUMsR0FBRyxDQUFDLENBQUMsNkVBQTZFLEVBQUVGLEtBQUtHLElBQUksQ0FBQyxFQUFFLEVBQUVILEtBQUtJLEVBQUUsQ0FBQyxDQUFDLENBQUM7UUFFcEgsb0NBQW9DO1FBQ3BDLElBQUksQ0FBQ0osS0FBS0ssSUFBSSxJQUFJLENBQUNMLEtBQUtNLE9BQU8sRUFBRTtZQUMvQkwsUUFBUUMsR0FBRyxDQUFDLENBQUMscUNBQXFDLEVBQUVGLEtBQUtHLElBQUksQ0FBQywyREFBMkQsQ0FBQztZQUMxSCxPQUFPO1FBQ1Q7UUFFQSw2RUFBNkU7UUFDN0UsTUFBTUksZ0JBQWdCLE1BQU1aLHNEQUFTQSxDQUFDYSxtQkFBbUI7UUFDekQsTUFBTUMsaUJBQWlCRixjQUFjRyxJQUFJLENBQUNDLENBQUFBLEtBQU1BLEdBQUdDLFlBQVksS0FBS1osS0FBS0ksRUFBRTtRQUUzRSxJQUFJSyxnQkFBZ0I7WUFDbEJSLFFBQVFDLEdBQUcsQ0FBQyxDQUFDLHlFQUF5RSxFQUFFRixLQUFLSSxFQUFFLENBQUMsbUJBQW1CLENBQUM7WUFDcEgsT0FBT0s7UUFDVDtRQUVBLE1BQU1JLGNBQWMsSUFBSUM7UUFDeEIsTUFBTUMsWUFBNkI7WUFDakNYLElBQUksQ0FBQyxPQUFPLEVBQUVKLEtBQUtJLEVBQUUsQ0FBQyxDQUFDLEVBQUVVLEtBQUtFLEdBQUcsR0FBRyxDQUFDO1lBQ3JDYixNQUFNSCxLQUFLRyxJQUFJO1lBQ2ZjLGFBQWEsQ0FBQyw0QkFBNEIsRUFBRWpCLEtBQUtHLElBQUksQ0FBQyxDQUFDO1lBQ3ZEZSxNQUFNTCxZQUFZTSxXQUFXO1lBQzdCQyxPQUFP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NUQsMEJBQTBCO1FBQzFCLE1BQU11QixlQUFlO1lBQ25CaEMsU0FBU3dELEtBQUtFLE1BQU0sQ0FBQ0MsWUFBWTtZQUNqQ3RDLFdBQVdtQyxLQUFLbkMsU0FBUyxJQUFJO1lBQzdCQyxjQUFja0MsS0FBS2xDLFlBQVksSUFBSTtZQUNuQ0UsYUFBYWYsVUFBVWUsV0FBVztZQUNsQ1MsYUFBYTtRQUNmO1FBRUEsTUFBTUMsT0FBTzVDLGdFQUFRQSxDQUNuQkgsa0RBQVFBLENBQUNnRixXQUFXLEVBQ3BCO1lBQUVsRCxNQUFNN0Isb0RBQVVBLENBQUNnRixJQUFJO1lBQUV0RSxJQUFJMEQsS0FBSzFELEVBQUU7UUFBQyxHQUNyQztZQUFFbUIsTUFBTTdCLG9EQUFVQSxDQUFDaUQsU0FBUztZQUFFdkMsSUFBSWdDLGNBQWNoQyxFQUFFO1FBQUMsR0FDbkRrQztRQUdGLE1BQU16QyxnRUFBVUEsQ0FBQzJDO1FBRWpCdkMsUUFBUUMsR0FBRyxDQUFDLENBQUMsNkZBQTZGLEVBQUVrQyxjQUFjakMsSUFBSSxDQUFDLENBQUM7UUFFaEksT0FBT2lDO0lBRVQsRUFBRSxPQUFPUSxPQUFPO1FBQ2QzQyxRQUFRMkMsS0FBSyxDQUFDLENBQUMsOEVBQThFLEVBQUVrQixLQUFLMUQsRUFBRSxDQUFDLENBQUMsQ0FBQyxFQUFFd0M7UUFDM0csTUFBTUE7SUFDUjtBQUNGO0FBRUE7O0NBRUMsR0FDTSxlQUFlK0Isd0NBQXdDQyxNQUF1QjtJQUNuRjNFLFFBQVFDLEdBQUcsQ0FBQyxDQUFDLGdGQUFnRixFQUFFMEUsT0FBT3pFLElBQUksQ0FBQyxFQUFFLEVBQUV5RSxPQUFPeEUsRUFBRSxDQUFDLENBQUMsQ0FBQztJQUUzSCxPQUFPd0U7QUFDVCIsInNvdXJjZXMiOlsid2VicGFjazovL3RoZWdhbWUtYWRtaW4vLi93b3JrZmxvd3MvZmluYW5jaWFsLXJlY29yZC11dGlscy50cz9jMDUxIl0sInNvdXJjZXNDb250ZW50IjpbIi8vIHdvcmtmbG93cy9maW5hbmNpYWwtcmVjb3JkLXV0aWxzLnRzXHJcbi8vIEZpbmFuY2lhbCByZWNvcmQgY3JlYXRpb24gYW5kIG1hbmFnZW1lbnQgdXRpbGl0aWVzXHJcblxyXG5pbXBvcnQgdHlwZSB7IFRhc2ssIEZpbmFuY2lhbFJlY29yZCwgU2FsZSB9IGZyb20gJ0AvdHlwZXMvZW50aXRpZXMnO1xyXG5pbXBvcnQgeyBMaW5rVHlwZSwgRW50aXR5VHlwZSB9IGZyb20gJ0AvdHlwZXMvZW51bXMnO1xyXG5pbXBvcnQgeyBDbGllbnRBUEkgfSBmcm9tICdAL2xpYi9jbGllbnQtYXBpJztcclxuaW1wb3J0IHsgbWFrZUxpbmsgfSBmcm9tICdAL2xpbmtzL2xpbmtzLXdvcmtmbG93cyc7XHJcbmltcG9ydCB7IGNyZWF0ZUxpbmsgfSBmcm9tICdAL2xpbmtzL2xpbmstcmVnaXN0cnknO1xyXG5pbXBvcnQgeyBhcHBlbmRFbnRpdHlMb2cgfSBmcm9tICcuL2VudGl0aWVzLWxvZ2dpbmcnO1xyXG5cclxuLyoqXHJcbiAqIENyZWF0ZSBhIGZpbmFuY2lhbCByZWNvcmQgZnJvbSBhIHRhc2sgKHdoZW4gdGFzayBoYXMgY29zdCBvciByZXZlbnVlKVxyXG4gKiBUaGlzIGltcGxlbWVudHMgdGhlIGVtaXNzYXJ5IHBhdHRlcm46IFRhc2sgRE5BIOKGkiBGaW5hbmNpYWxSZWNvcmQgZW50aXR5XHJcbiAqL1xyXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gY3JlYXRlRmluYW5jaWFsUmVjb3JkRnJvbVRhc2sodGFzazogVGFzayk6IFByb21pc2U8RmluYW5jaWFsUmVjb3JkIHwgbnVsbD4ge1xyXG4gIHRyeSB7XHJcbiAgICBjb25zb2xlLmxvZyhgW2NyZWF0ZUZpbmFuY2lhbFJlY29yZEZyb21UYXNrXSBTdGFydGluZyBmaW5hbmNpYWwgcmVjb3JkIGNyZWF0aW9uIGZvciB0YXNrOiAke3Rhc2submFtZX0gKCR7dGFzay5pZH0pYCk7XHJcbiAgICBcclxuICAgIC8vIENoZWNrIGlmIHRhc2sgaGFzIGNvc3Qgb3IgcmV2ZW51ZVxyXG4gICAgaWYgKCF0YXNrLmNvc3QgJiYgIXRhc2sucmV2ZW51ZSkge1xyXG4gICAgICBjb25zb2xlLmxvZyhgW2NyZWF0ZUZpbmFuY2lhbFJlY29yZEZyb21UYXNrXSBUYXNrICR7dGFzay5uYW1lfSBoYXMgbm8gY29zdCBvciByZXZlbnVlLCBza2lwcGluZyBmaW5hbmNpYWwgcmVjb3JkIGNyZWF0aW9uYCk7XHJcbiAgICAgIHJldHVybiBudWxsO1xyXG4gICAgfVxyXG4gICAgXHJcbiAgICAvLyBJREVNUE9URU5DWSBDSEVDSzogTG9vayBmb3IgZXhpc3RpbmcgZmluYW5jaWFsIHJlY29yZCBjcmVhdGVkIGJ5IHRoaXMgdGFza1xyXG4gICAgY29uc3QgYWxsRmluYW5jaWFscyA9IGF3YWl0IENsaWVudEFQSS5nZXRGaW5hbmNpYWxSZWNvcmRzKCk7XHJcbiAgICBjb25zdCBleGlzdGluZ0ZpbnJlYyA9IGFsbEZpbmFuY2lhbHMuZmluZChmciA9PiBmci5zb3VyY2VUYXNrSWQgPT09IHRhc2suaWQpO1xyXG4gICAgXHJcbiAgICBpZiAoZXhpc3RpbmdGaW5yZWMpIHtcclxuICAgICAgY29uc29sZS5sb2coYFtjcmVhdGVGaW5hbmNpYWxSZWNvcmRGcm9tVGFza10gRmluYW5jaWFsIHJlY29yZCBhbHJlYWR5IGV4aXN0cyBmb3IgdGFzayAke3Rhc2suaWR9LCBza2lwcGluZyBjcmVhdGlvbmApO1xyXG4gICAgICByZXR1cm4gZXhpc3RpbmdGaW5yZWM7XHJcbiAgICB9XHJcbiAgICBcclxuICAgIGNvbnN0IGN1cnJlbnREYXRlID0gbmV3IERhdGUoKTtcclxuICAgIGNvbnN0IG5ld0ZpbnJlYzogRmluYW5jaWFsUmVjb3JkID0ge1xyXG4gICAgICBpZDogYGZpbnJlYy0ke3Rhc2suaWR9LSR7RGF0ZS5ub3coKX1gLFxyXG4gICAgICBuYW1lOiB0YXNrLm5hbWUsXHJcbiAgICAgIGRlc2NyaXB0aW9uOiBgRmluYW5jaWFsIHJlY29yZCBmcm9tIHRhc2s6ICR7dGFzay5uYW1lfWAsXHJcbiAgICAgIHllYXI6IGN1cnJlbnREYXRlLmdldEZ1bGxZZWFyKCksXHJcbiAgICAgIG1vbnRoOiBjdXJyZW50RGF0ZS5nZXRNb250aCgpICsgMSxcclxuICAgICAgc3RhdGlvbjogdGFzay5zdGF0aW9uLFxyXG4gICAgICB0eXBlOiAnY29tcGFueScsIC8vIFRhc2tzIGFyZSBidXNpbmVzcyBhY3Rpdml0aWVzXHJcbiAgICAgIHNpdGVJZDogdGFzay5zaXRlSWQsXHJcbiAgICAgIHRhcmdldFNpdGVJZDogdGFzay50YXJnZXRTaXRlSWQsXHJcbiAgICAgIHNvdXJjZVRhc2tJZDogdGFzay5pZCwgLy8gQU1CQVNTQURPUiBmaWVsZCAtIHBvaW50cyBiYWNrIHRvIFRhc2tcclxuICAgICAgY29zdDogdGFzay5jb3N0IHx8IDAsXHJcbiAgICAgIHJldmVudWU6IHRhc2sucmV2ZW51ZSB8fCAwLFxyXG4gICAgICBqdW5nbGVDb2luczogMCwgLy8gSiQgbm8gbG9uZ2VyIGF3YXJkZWQgYXMgdGFzayByZXdhcmRzXHJcbiAgICAgIGlzTm90UGFpZDogdGFzay5pc05vdFBhaWQsICAgICAgIC8vIENvcHkgcGF5bWVudCBzdGF0dXMgZnJvbSBUYXNrXHJcbiAgICAgIGlzTm90Q2hhcmdlZDogdGFzay5pc05vdENoYXJnZWQsIC8vIENvcHkgcGF5bWVudCBzdGF0dXMgZnJvbSBUYXNrXHJcbiAgICAgIHJld2FyZHM6IHRhc2sucmV3YXJkcyxcclxuICAgICAgbmV0Q2FzaGZsb3c6ICh0YXNrLnJldmVudWUgfHwgMCkgLSAodGFzay5jb3N0IHx8IDApLFxyXG4gICAgICBqdW5nbGVDb2luc1ZhbHVlOiAwLCAvLyBKJCBubyBsb25nZXIgYXdhcmRlZCBhcyB0YXNrIHJld2FyZHNcclxuICAgICAgaXNDb2xsZWN0ZWQ6IGZhbHNlLFxyXG4gICAgICBjcmVhdGVkQXQ6IG5ldyBEYXRlKCksXHJcbiAgICAgIHVwZGF0ZWRBdDogbmV3IERhdGUoKSxcclxuICAgICAgbGlua3M6IFtdXHJcbiAgICB9O1xyXG4gICAgXHJcbiAgICAvLyBTdG9yZSB0aGUgZmluYW5jaWFsIHJlY29yZFxyXG4gICAgY29uc29sZS5sb2coYFtjcmVhdGVGaW5hbmNpYWxSZWNvcmRGcm9tVGFza10gQ3JlYXRpbmcgbmV3IGZpbmFuY2lhbCByZWNvcmQ6YCwgbmV3RmlucmVjKTtcclxuICAgIGNvbnN0IGNyZWF0ZWRGaW5yZWMgPSBhd2FpdCBDbGllbnRBUEkudXBzZXJ0RmluYW5jaWFsUmVjb3JkKG5ld0ZpbnJlYyk7XHJcbiAgICBcclxuICAgIC8vIENyZWF0ZSBUQVNLX0ZJTlJFQyBsaW5rIHdpdGggbWV0YWRhdGFcclxuICAgIGNvbnN0IGxpbmtNZXRhZGF0YSA9IHtcclxuICAgICAgY29zdDogdGFzay5jb3N0IHx8IDAsXHJcbiAgICAgIHJldmVudWU6IHRhc2sucmV2ZW51ZSB8fCAwLFxyXG4gICAgICBpc05vdFBhaWQ6IHRhc2suaXNOb3RQYWlkIHx8IGZhbHNlLFxyXG4gICAgICBpc05vdENoYXJnZWQ6IHRhc2suaXNOb3RDaGFyZ2VkIHx8IGZhbHNlLFxyXG4gICAgICByZXdhcmRzOiB0YXNrLnJld2FyZHMsXHJcbiAgICAgIG5ldENhc2hmbG93OiBuZXdGaW5yZWMubmV0Q2FzaGZsb3csXHJcbiAgICAgIGNyZWF0ZWRGcm9tOiAndGFzaydcclxuICAgIH07XHJcbiAgICBcclxuICAgIGNvbnN0IGxpbmsgPSBtYWtlTGluayhcclxuICAgICAgTGlua1R5cGUuVEFTS19GSU5SRUMsXHJcbiAgICAgIHsgdHlwZTogRW50aXR5VHlwZS5UQVNLLCBpZDogdGFzay5pZCB9LFxyXG4gICAgICB7IHR5cGU6IEVudGl0eVR5cGUuRklOQU5DSUFMLCBpZDogY3JlYXRlZEZpbnJlYy5pZCB9LFxyXG4gICAgICBsaW5rTWV0YWRhdGFcclxuICAgICk7XHJcbiAgICBcclxuICAgIGF3YWl0IGNyZWF0ZUxpbmsobGluayk7XHJcbiAgICBcclxuICAgIGNvbnNvbGUubG9nKGBbY3JlYXRlRmluYW5jaWFsUmVjb3JkRnJvbVRhc2tdIOKchSBGaW5hbmNpYWwgcmVjb3JkIGNyZWF0ZWQgYW5kIFRBU0tfRklOUkVDIGxpbmsgZXN0YWJsaXNoZWQ6ICR7Y3JlYXRlZEZpbnJlYy5uYW1lfWApO1xyXG4gICAgXHJcbiAgICByZXR1cm4gY3JlYXRlZEZpbnJlYztcclxuICAgIFxyXG4gIH0gY2F0Y2ggKGVycm9yKSB7XHJcbiAgICBjb25zb2xlLmVycm9yKGBbY3JlYXRlRmluYW5jaWFsUmVjb3JkRnJvbVRhc2tdIOKdjCBGYWlsZWQgdG8gY3JlYXRlIGZpbmFuY2lhbCByZWNvcmQgZnJvbSB0YXNrICR7dGFzay5pZH06YCwgZXJyb3IpO1xyXG4gICAgdGhyb3cgZXJyb3I7XHJcbiAgfVxyXG59XHJcblxyXG4vKipcclxuICogVXBkYXRlIGFuIGV4aXN0aW5nIGZpbmFuY2lhbCByZWNvcmQgd2hlbiB0YXNrIHByb3BlcnRpZXMgY2hhbmdlXHJcbiAqIFRoaXMgZW5zdXJlcyBmaW5hbmNpYWwgcmVjb3JkcyBzdGF5IGluIHN5bmMgd2l0aCB0aGVpciBzb3VyY2UgdGFza3NcclxuICovXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiB1cGRhdGVGaW5hbmNpYWxSZWNvcmRGcm9tVGFzayh0YXNrOiBUYXNrLCBwcmV2aW91c1Rhc2s6IFRhc2spOiBQcm9taXNlPHZvaWQ+IHtcclxuICB0cnkge1xyXG4gICAgY29uc29sZS5sb2coYFt1cGRhdGVGaW5hbmNpYWxSZWNvcmRGcm9tVGFza10gVXBkYXRpbmcgZmluYW5jaWFsIHJlY29yZCBmb3IgdGFzazogJHt0YXNrLm5hbWV9ICgke3Rhc2suaWR9KWApO1xyXG4gICAgXHJcbiAgICAvLyBGaW5kIHRoZSBleGlzdGluZyBmaW5hbmNpYWwgcmVjb3JkIGNyZWF0ZWQgYnkgdGhpcyB0YXNrXHJcbiAgICBjb25zdCBhbGxGaW5hbmNpYWxzID0gYXdhaXQgQ2xpZW50QVBJLmdldEZpbmFuY2lhbFJlY29yZHMoKTtcclxuICAgIGNvbnN0IGV4aXN0aW5nRmlucmVjID0gYWxsRmluYW5jaWFscy5maW5kKGZyID0+IGZyLnNvdXJjZVRhc2tJZCA9PT0gdGFzay5pZCk7XHJcbiAgICBcclxuICAgIGlmICghZXhpc3RpbmdGaW5yZWMpIHtcclxuICAgICAgY29uc29sZS5sb2coYFt1cGRhdGVGaW5hbmNpYWxSZWNvcmRGcm9tVGFza10gTm8gZmluYW5jaWFsIHJlY29yZCBmb3VuZCBmb3IgdGFzayAke3Rhc2suaWR9LCBjcmVhdGluZyBuZXcgb25lYCk7XHJcbiAgICAgIGF3YWl0IGNyZWF0ZUZpbmFuY2lhbFJlY29yZEZyb21UYXNrKHRhc2spO1xyXG4gICAgICByZXR1cm47XHJcbiAgICB9XHJcbiAgICBcclxuICAgIC8vIENoZWNrIGlmIGFueSBmaW5hbmNpYWwgcHJvcGVydGllcyBjaGFuZ2VkXHJcbiAgICBjb25zdCBmaW5hbmNpYWxQcm9wc0NoYW5nZWQgPSBcclxuICAgICAgcHJldmlvdXNUYXNrLmNvc3QgIT09IHRhc2suY29zdCB8fFxyXG4gICAgICBwcmV2aW91c1Rhc2sucmV2ZW51ZSAhPT0gdGFzay5yZXZlbnVlIHx8XHJcbiAgICAgIHByZXZpb3VzVGFzay5pc05vdFBhaWQgIT09IHRhc2suaXNOb3RQYWlkIHx8XHJcbiAgICAgIHByZXZpb3VzVGFzay5pc05vdENoYXJnZWQgIT09IHRhc2suaXNOb3RDaGFyZ2VkIHx8XHJcbiAgICAgIHByZXZpb3VzVGFzay5uYW1lICE9PSB0YXNrLm5hbWUgfHxcclxuICAgICAgcHJldmlvdXNUYXNrLnN0YXRpb24gIT09IHRhc2suc3RhdGlvbiB8fFxyXG4gICAgICBwcmV2aW91c1Rhc2suc2l0ZUlkICE9PSB0YXNrLnNpdGVJZCB8fFxyXG4gICAgICBwcmV2aW91c1Rhc2sudGFyZ2V0U2l0ZUlkICE9PSB0YXNrLnRhcmdldFNpdGVJZDtcclxuICAgIFxyXG4gICAgaWYgKCFmaW5hbmNpYWxQcm9wc0NoYW5nZWQpIHtcclxuICAgICAgY29uc29sZS5sb2coYFt1cGRhdGVGaW5hbmNpYWxSZWNvcmRGcm9tVGFza10gTm8gZmluYW5jaWFsIHByb3BlcnRpZXMgY2hhbmdlZCBmb3IgdGFzayAke3Rhc2suaWR9LCBza2lwcGluZyB1cGRhdGVgKTtcclxuICAgICAgcmV0dXJuO1xyXG4gICAgfVxyXG4gICAgXHJcbiAgICAvLyBVcGRhdGUgdGhlIGZpbmFuY2lhbCByZWNvcmQgd2l0aCBuZXcgdGFzayBkYXRhXHJcbiAgICBjb25zdCB1cGRhdGVkRmlucmVjID0ge1xyXG4gICAgICAuLi5leGlzdGluZ0ZpbnJlYyxcclxuICAgICAgbmFtZTogdGFzay5uYW1lLFxyXG4gICAgICBkZXNjcmlwdGlvbjogYEZpbmFuY2lhbCByZWNvcmQgZnJvbSB0YXNrOiAke3Rhc2submFtZX1gLFxyXG4gICAgICBjb3N0OiB0YXNrLmNvc3QgfHwgMCxcclxuICAgICAgcmV2ZW51ZTogdGFzay5yZXZlbnVlIHx8IDAsXHJcbiAgICAgIHN0YXRpb246IHRhc2suc3RhdGlvbixcclxuICAgICAgc2l0ZUlkOiB0YXNrLnNpdGVJZCxcclxuICAgICAgdGFyZ2V0U2l0ZUlkOiB0YXNrLnRhcmdldFNpdGVJZCxcclxuICAgICAgaXNOb3RQYWlkOiB0YXNrLmlzTm90UGFpZCxcclxuICAgICAgaXNOb3RDaGFyZ2VkOiB0YXNrLmlzTm90Q2hhcmdlZCxcclxuICAgICAgcmV3YXJkczogdGFzay5yZXdhcmRzLFxyXG4gICAgICBuZXRDYXNoZmxvdzogKHRhc2sucmV2ZW51ZSB8fCAwKSAtICh0YXNrLmNvc3QgfHwgMCksXHJcbiAgICAgIHVwZGF0ZWRBdDogbmV3IERhdGUoKVxyXG4gICAgfTtcclxuICAgIFxyXG4gICAgLy8gU3RvcmUgdGhlIHVwZGF0ZWQgZmluYW5jaWFsIHJlY29yZFxyXG4gICAgY29uc29sZS5sb2coYFt1cGRhdGVGaW5hbmNpYWxSZWNvcmRGcm9tVGFza10gVXBkYXRpbmcgZmluYW5jaWFsIHJlY29yZDpgLCB1cGRhdGVkRmlucmVjKTtcclxuICAgIGF3YWl0IENsaWVudEFQSS51cHNlcnRGaW5hbmNpYWxSZWNvcmQodXBkYXRlZEZpbnJlYyk7XHJcbiAgICBcclxuICAgIC8vIExvZyB0aGUgdXBkYXRlXHJcbiAgICBhd2FpdCBhcHBlbmRFbnRpdHlMb2coJ2ZpbmFuY2lhbCcsIGV4aXN0aW5nRmlucmVjLmlkLCAnVVBEQVRFRCcsIHtcclxuICAgICAgbmFtZTogdGFzay5uYW1lLFxyXG4gICAgICB1cGRhdGVkRnJvbTogJ3Rhc2snLFxyXG4gICAgICBjaGFuZ2VzOiB7XHJcbiAgICAgICAgY29zdDogeyBmcm9tOiBwcmV2aW91c1Rhc2suY29zdCB8fCAwLCB0bzogdGFzay5jb3N0IHx8IDAgfSxcclxuICAgICAgICByZXZlbnVlOiB7IGZyb206IHByZXZpb3VzVGFzay5yZXZlbnVlIHx8IDAsIHRvOiB0YXNrLnJldmVudWUgfHwgMCB9LFxyXG4gICAgICAgIGlzTm90UGFpZDogeyBmcm9tOiBwcmV2aW91c1Rhc2suaXNOb3RQYWlkIHx8IGZhbHNlLCB0bzogdGFzay5pc05vdFBhaWQgfHwgZmFsc2UgfSxcclxuICAgICAgICBpc05vdENoYXJnZWQ6IHsgZnJvbTogcHJldmlvdXNUYXNrLmlzTm90Q2hhcmdlZCB8fCBmYWxzZSwgdG86IHRhc2suaXNOb3RDaGFyZ2VkIHx8IGZhbHNlIH1cclxuICAgICAgfSxcclxuICAgICAgdXBkYXRlZEF0OiBuZXcgRGF0ZSgpLnRvSVNPU3RyaW5nKClcclxuICAgIH0pO1xyXG4gICAgXHJcbiAgICBjb25zb2xlLmxvZyhgW3VwZGF0ZUZpbmFuY2lhbFJlY29yZEZyb21UYXNrXSDinIUgRmluYW5jaWFsIHJlY29yZCB1cGRhdGVkIHN1Y2Nlc3NmdWxseSBmb3IgdGFzazogJHt0YXNrLm5hbWV9YCk7XHJcbiAgICBcclxuICB9IGNhdGNoIChlcnJvcikge1xyXG4gICAgY29uc29sZS5lcnJvcihgW3VwZGF0ZUZpbmFuY2lhbFJlY29yZEZyb21UYXNrXSDinYwgRmFpbGVkIHRvIHVwZGF0ZSBmaW5hbmNpYWwgcmVjb3JkIGZvciB0YXNrICR7dGFzay5pZH06YCwgZXJyb3IpO1xyXG4gICAgdGhyb3cgZXJyb3I7XHJcbiAgfVxyXG59XHJcblxyXG4vKipcclxuICogUmVtb3ZlIGZpbmFuY2lhbCByZWNvcmRzIGNyZWF0ZWQgYnkgYSBzcGVjaWZpYyB0YXNrXHJcbiAqIFRoaXMgaXMgdXNlZCB3aGVuIGEgdGFzayBpcyBkZWxldGVkIHRvIGNsZWFuIHVwIGFzc29jaWF0ZWQgZmluYW5jaWFsIHJlY29yZHNcclxuICovXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiByZW1vdmVGaW5hbmNpYWxSZWNvcmRzQ3JlYXRlZEJ5VGFzayh0YXNrSWQ6IHN0cmluZyk6IFByb21pc2U8dm9pZD4ge1xyXG4gIHRyeSB7XHJcbiAgICBjb25zb2xlLmxvZyhgW3JlbW92ZUZpbmFuY2lhbFJlY29yZHNDcmVhdGVkQnlUYXNrXSBSZW1vdmluZyBmaW5hbmNpYWwgcmVjb3JkcyBjcmVhdGVkIGJ5IHRhc2s6ICR7dGFza0lkfWApO1xyXG4gICAgXHJcbiAgICAvLyBGaW5kIGZpbmFuY2lhbCByZWNvcmRzIGNyZWF0ZWQgYnkgdGhpcyB0YXNrXHJcbiAgICBjb25zdCBhbGxGaW5hbmNpYWxzID0gYXdhaXQgQ2xpZW50QVBJLmdldEZpbmFuY2lhbFJlY29yZHMoKTtcclxuICAgIGNvbnN0IHRhc2tGaW5hbmNpYWxzID0gYWxsRmluYW5jaWFscy5maWx0ZXIoZnIgPT4gZnIuc291cmNlVGFza0lkID09PSB0YXNrSWQpO1xyXG4gICAgXHJcbiAgICBpZiAodGFza0ZpbmFuY2lhbHMubGVuZ3RoID09PSAwKSB7XHJcbiAgICAgIGNvbnNvbGUubG9nKGBbcmVtb3ZlRmluYW5jaWFsUmVjb3Jkc0NyZWF0ZWRCeVRhc2tdIE5vIGZpbmFuY2lhbCByZWNvcmRzIGZvdW5kIGZvciB0YXNrICR7dGFza0lkfWApO1xyXG4gICAgICByZXR1cm47XHJcbiAgICB9XHJcbiAgICBcclxuICAgIGNvbnNvbGUubG9nKGBbcmVtb3ZlRmluYW5jaWFsUmVjb3Jkc0NyZWF0ZWRCeVRhc2tdIEZvdW5kICR7dGFza0ZpbmFuY2lhbHMubGVuZ3RofSBmaW5hbmNpYWwgcmVjb3JkKHMpIHRvIHJlbW92ZWApO1xyXG4gICAgXHJcbiAgICAvLyBSZW1vdmUgZWFjaCBmaW5hbmNpYWwgcmVjb3JkXHJcbiAgICBmb3IgKGNvbnN0IGZpbmFuY2lhbCBvZiB0YXNrRmluYW5jaWFscykge1xyXG4gICAgICB0cnkge1xyXG4gICAgICAgIGF3YWl0IENsaWVudEFQSS5kZWxldGVGaW5hbmNpYWxSZWNvcmQoZmluYW5jaWFsLmlkKTtcclxuICAgICAgICBjb25zb2xlLmxvZyhgW3JlbW92ZUZpbmFuY2lhbFJlY29yZHNDcmVhdGVkQnlUYXNrXSDinIUgUmVtb3ZlZCBmaW5hbmNpYWwgcmVjb3JkOiAke2ZpbmFuY2lhbC5uYW1lfWApO1xyXG4gICAgICB9IGNhdGNoIChlcnJvcikge1xyXG4gICAgICAgIGNvbnNvbGUuZXJyb3IoYFtyZW1vdmVGaW5hbmNpYWxSZWNvcmRzQ3JlYXRlZEJ5VGFza10g4p2MIEZhaWxlZCB0byByZW1vdmUgZmluYW5jaWFsIHJlY29yZCAke2ZpbmFuY2lhbC5pZH06YCwgZXJyb3IpO1xyXG4gICAgICB9XHJcbiAgICB9XHJcbiAgICBcclxuICAgIGNvbnNvbGUubG9nKGBbcmVtb3ZlRmluYW5jaWFsUmVjb3Jkc0NyZWF0ZWRCeVRhc2tdIOKchSBSZW1vdmVkICR7dGFza0ZpbmFuY2lhbHMubGVuZ3RofSBmaW5hbmNpYWwgcmVjb3JkKHMpIGZvciB0YXNrICR7dGFza0lkfWApO1xyXG4gICAgXHJcbiAgfSBjYXRjaCAoZXJyb3IpIHtcclxuICAgIGNvbnNvbGUuZXJyb3IoYFtyZW1vdmVGaW5hbmNpYWxSZWNvcmRzQ3JlYXRlZEJ5VGFza10g4p2MIEZhaWxlZCB0byByZW1vdmUgZmluYW5jaWFsIHJlY29yZHMgZm9yIHRhc2sgJHt0YXNrSWR9OmAsIGVycm9yKTtcclxuICAgIHRocm93IGVycm9yO1xyXG4gIH1cclxufVxyXG5cclxuLyoqXHJcbiAqIENyZWF0ZSBhIGZpbmFuY2lhbCByZWNvcmQgZnJvbSBhIHNhbGUgKHdoZW4gc2FsZSBoYXMgcmV2ZW51ZSlcclxuICogVGhpcyBpbXBsZW1lbnRzIHRoZSBlbWlzc2FyeSBwYXR0ZXJuOiBTYWxlIEROQSDihpIgRmluYW5jaWFsUmVjb3JkIGVudGl0eVxyXG4gKi9cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGNyZWF0ZUZpbmFuY2lhbFJlY29yZEZyb21TYWxlKHNhbGU6IFNhbGUpOiBQcm9taXNlPEZpbmFuY2lhbFJlY29yZCB8IG51bGw+IHtcclxuICB0cnkge1xyXG4gICAgY29uc29sZS5sb2coYFtjcmVhdGVGaW5hbmNpYWxSZWNvcmRGcm9tU2FsZV0gQ3JlYXRpbmcgZmluYW5jaWFsIHJlY29yZCBmcm9tIHNhbGU6ICR7c2FsZS5jb3VudGVycGFydHlOYW1lfWApO1xyXG4gICAgXHJcbiAgICAvLyBDaGVjayBpZiBzYWxlIGhhcyByZXZlbnVlXHJcbiAgICBpZiAoc2FsZS50b3RhbHMudG90YWxSZXZlbnVlIDw9IDApIHtcclxuICAgICAgY29uc29sZS5sb2coYFtjcmVhdGVGaW5hbmNpYWxSZWNvcmRGcm9tU2FsZV0gU2FsZSAke3NhbGUuaWR9IGhhcyBubyByZXZlbnVlLCBza2lwcGluZyBmaW5hbmNpYWwgcmVjb3JkIGNyZWF0aW9uYCk7XHJcbiAgICAgIHJldHVybiBudWxsO1xyXG4gICAgfVxyXG4gICAgXHJcbiAgICAvLyBJREVNUE9URU5DWSBDSEVDSzogTG9vayBmb3IgZXhpc3RpbmcgZmluYW5jaWFsIHJlY29yZCBjcmVhdGVkIGJ5IHRoaXMgc2FsZVxyXG4gICAgY29uc3QgYWxsRmluYW5jaWFscyA9IGF3YWl0IENsaWVudEFQSS5nZXRGaW5hbmNpYWxSZWNvcmRzKCk7XHJcbiAgICBjb25zdCBleGlzdGluZ0ZpbnJlYyA9IGFsbEZpbmFuY2lhbHMuZmluZChmciA9PiBmci5zb3VyY2VTYWxlSWQgPT09IHNhbGUuaWQpO1xyXG4gICAgXHJcbiAgICBpZiAoZXhpc3RpbmdGaW5yZWMpIHtcclxuICAgICAgY29uc29sZS5sb2coYFtjcmVhdGVGaW5hbmNpYWxSZWNvcmRGcm9tU2FsZV0gRmluYW5jaWFsIHJlY29yZCBhbHJlYWR5IGV4aXN0cyBmb3Igc2FsZSAke3NhbGUuaWR9LCBza2lwcGluZyBjcmVhdGlvbmApO1xyXG4gICAgICByZXR1cm4gZXhpc3RpbmdGaW5yZWM7XHJcbiAgICB9XHJcbiAgICBcclxuICAgIGNvbnN0IGN1cnJlbnREYXRlID0gbmV3IERhdGUoKTtcclxuICAgIGNvbnN0IG5ld0ZpbnJlYzogRmluYW5jaWFsUmVjb3JkID0ge1xyXG4gICAgICBpZDogYGZpbnJlYy0ke3NhbGUuaWR9LSR7RGF0ZS5ub3coKX1gLFxyXG4gICAgICBuYW1lOiBgU2FsZTogJHtzYWxlLmNvdW50ZXJwYXJ0eU5hbWV9YCxcclxuICAgICAgZGVzY3JpcHRpb246IGBGaW5hbmNpYWwgcmVjb3JkIGZyb20gc2FsZTogJHtzYWxlLmNvdW50ZXJwYXJ0eU5hbWV9YCxcclxuICAgICAgeWVhcjogY3VycmVudERhdGUuZ2V0RnVsbFllYXIoKSxcclxuICAgICAgbW9udGg6IGN1cnJlbnREYXRlLmdldE1vbnRoKCkgKyAxLFxyXG4gICAgICBzdGF0aW9uOiAnU2FsZXMnIGFzIGFueSwgLy8gU2FsZXMgYXJlIGJ1c2luZXNzIGFjdGl2aXRpZXNcclxuICAgICAgdHlwZTogJ2NvbXBhbnknLFxyXG4gICAgICBzaXRlSWQ6IHNhbGUuc2l0ZUlkLFxyXG4gICAgICB0YXJnZXRTaXRlSWQ6IHVuZGVmaW5lZCxcclxuICAgICAgc291cmNlU2FsZUlkOiBzYWxlLmlkLCAvLyBBTUJBU1NBRE9SIGZpZWxkIC0gcG9pbnRzIGJhY2sgdG8gU2FsZVxyXG4gICAgICBjb3N0OiAwLCAvLyBTYWxlcyB0eXBpY2FsbHkgZG9uJ3QgaGF2ZSBjb3N0c1xyXG4gICAgICByZXZlbnVlOiBzYWxlLnRvdGFscy50b3RhbFJldmVudWUsXHJcbiAgICAgIGp1bmdsZUNvaW5zOiAwLCAvLyBKJCBubyBsb25nZXIgYXdhcmRlZCBhcyBzYWxlIHJld2FyZHNcclxuICAgICAgaXNOb3RQYWlkOiBzYWxlLmlzTm90UGFpZCB8fCBmYWxzZSxcclxuICAgICAgaXNOb3RDaGFyZ2VkOiBzYWxlLmlzTm90Q2hhcmdlZCB8fCBmYWxzZSxcclxuICAgICAgcmV3YXJkczogeyBwb2ludHM6IHsgeHA6IDAsIHJwOiAwLCBmcDogMCwgaHA6IDAgfSB9LCAvLyBQb2ludHMgaGFuZGxlZCBzZXBhcmF0ZWx5XHJcbiAgICAgIG5ldENhc2hmbG93OiBzYWxlLnRvdGFscy50b3RhbFJldmVudWUsXHJcbiAgICAgIGp1bmdsZUNvaW5zVmFsdWU6IDAsXHJcbiAgICAgIGlzQ29sbGVjdGVkOiBmYWxzZSxcclxuICAgICAgY3JlYXRlZEF0OiBuZXcgRGF0ZSgpLFxyXG4gICAgICB1cGRhdGVkQXQ6IG5ldyBEYXRlKCksXHJcbiAgICAgIGxpbmtzOiBbXVxyXG4gICAgfTtcclxuICAgIFxyXG4gICAgLy8gU3RvcmUgdGhlIGZpbmFuY2lhbCByZWNvcmRcclxuICAgIGNvbnNvbGUubG9nKGBbY3JlYXRlRmluYW5jaWFsUmVjb3JkRnJvbVNhbGVdIENyZWF0aW5nIGZpbmFuY2lhbCByZWNvcmQ6YCwgbmV3RmlucmVjKTtcclxuICAgIGNvbnN0IGNyZWF0ZWRGaW5yZWMgPSBhd2FpdCBDbGllbnRBUEkudXBzZXJ0RmluYW5jaWFsUmVjb3JkKG5ld0ZpbnJlYyk7XHJcbiAgICBcclxuICAgIC8vIENyZWF0ZSBTQUxFX0ZJTlJFQyBsaW5rXHJcbiAgICBjb25zdCBsaW5rTWV0YWRhdGEgPSB7XHJcbiAgICAgIHJldmVudWU6IHNhbGUudG90YWxzLnRvdGFsUmV2ZW51ZSxcclxuICAgICAgaXNOb3RQYWlkOiBzYWxlLmlzTm90UGFpZCB8fCBmYWxzZSxcclxuICAgICAgaXNOb3RDaGFyZ2VkOiBzYWxlLmlzTm90Q2hhcmdlZCB8fCBmYWxzZSxcclxuICAgICAgbmV0Q2FzaGZsb3c6IG5ld0ZpbnJlYy5uZXRDYXNoZmxvdyxcclxuICAgICAgY3JlYXRlZEZyb206ICdzYWxlJ1xyXG4gICAgfTtcclxuICAgIFxyXG4gICAgY29uc3QgbGluayA9IG1ha2VMaW5rKFxyXG4gICAgICBMaW5rVHlwZS5TQUxFX0ZJTlJFQyxcclxuICAgICAgeyB0eXBlOiBFbnRpdHlUeXBlLlNBTEUsIGlkOiBzYWxlLmlkIH0sXHJcbiAgICAgIHsgdHlwZTogRW50aXR5VHlwZS5GSU5BTkNJQUwsIGlkOiBjcmVhdGVkRmlucmVjLmlkIH0sXHJcbiAgICAgIGxpbmtNZXRhZGF0YVxyXG4gICAgKTtcclxuICAgIFxyXG4gICAgYXdhaXQgY3JlYXRlTGluayhsaW5rKTtcclxuICAgIFxyXG4gICAgY29uc29sZS5sb2coYFtjcmVhdGVGaW5hbmNpYWxSZWNvcmRGcm9tU2FsZV0g4pyFIEZpbmFuY2lhbCByZWNvcmQgY3JlYXRlZCBhbmQgU0FMRV9GSU5SRUMgbGluayBlc3RhYmxpc2hlZDogJHtjcmVhdGVkRmlucmVjLm5hbWV9YCk7XHJcbiAgICBcclxuICAgIHJldHVybiBjcmVhdGVkRmlucmVjO1xyXG4gICAgXHJcbiAgfSBjYXRjaCAoZXJyb3IpIHtcclxuICAgIGNvbnNvbGUuZXJyb3IoYFtjcmVhdGVGaW5hbmNpYWxSZWNvcmRGcm9tU2FsZV0g4p2MIEZhaWxlZCB0byBjcmVhdGUgZmluYW5jaWFsIHJlY29yZCBmcm9tIHNhbGUgJHtzYWxlLmlkfTpgLCBlcnJvcik7XHJcbiAgICB0aHJvdyBlcnJvcjtcclxuICB9XHJcbn1cclxuXHJcbi8qKlxyXG4gKiBFbmhhbmNlZCBmaW5hbmNpYWwgcmVjb3JkIGNyZWF0aW9uIC0gcHVyZSBidXNpbmVzcyBsb2dpYywgbm8gbGluayBjcmVhdGlvblxyXG4gKi9cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIHByb2Nlc3NGaW5hbmNpYWxSZWNvcmRDcmVhdGlvbldpdGhMaW5rcyhyZWNvcmQ6IEZpbmFuY2lhbFJlY29yZCk6IFByb21pc2U8RmluYW5jaWFsUmVjb3JkPiB7XHJcbiAgY29uc29sZS5sb2coYFtwcm9jZXNzRmluYW5jaWFsUmVjb3JkQ3JlYXRpb25XaXRoTGlua3NdIFByb2Nlc3NpbmcgZmluYW5jaWFsIHJlY29yZCBjcmVhdGlvbjogJHtyZWNvcmQubmFtZX0gKCR7cmVjb3JkLmlkfSlgKTtcclxuICBcclxuICByZXR1cm4gcmVjb3JkO1xyXG59Il0sIm5hbWVzIjpbIkxpbmtUeXBlIiwiRW50aXR5VHlwZSIsIkNsaWVudEFQSSIsIm1ha2VMaW5rIiwiY3JlYXRlTGluayIsImFwcGVuZEVudGl0eUxvZyIsImNyZWF0ZUZpbmFuY2lhbFJlY29yZEZyb21UYXNrIiwidGFzayIsImNvbnNvbGUiLCJsb2ciLCJuYW1lIiwiaWQiLCJjb3N0IiwicmV2ZW51ZSIsImFsbEZpbmFuY2lhbHMiLCJnZXRGaW5hbmNpYWxSZWNvcmRzIiwiZXhpc3RpbmdGaW5yZWMiLCJmaW5kIiwiZnIiLCJzb3VyY2VUYXNrSWQiLCJjdXJyZW50RGF0ZSIsIkRhdGUiLCJuZXdGaW5yZWMiLCJub3ciLCJkZXNjcmlwdGlvbiIsInllYXIiLCJnZXRGdWxsWWVhciIsIm1vbnRoIiwiZ2V0TW9udGgiLCJzdGF0aW9uIiwidHlwZSIsInNpdGVJZCIsInRhcmdldFNpdGVJZCIsImp1bmdsZUNvaW5zIiwiaXNOb3RQYWlkIiwiaXNOb3RDaGFyZ2VkIiwicmV3YXJkcyIsIm5ldENhc2hmbG93IiwianVuZ2xlQ29pbnNWYWx1ZSIsImlzQ29sbGVjdGVkIiwiY3JlYXRlZEF0IiwidXBkYXRlZEF0IiwibGlua3MiLCJjcmVhdGVkRmlucmVjIiwidXBzZXJ0RmluYW5jaWFsUmVjb3JkIiwibGlua01ldGFkYXRhIiwiY3JlYXRlZEZyb20iLCJsaW5rIiwiVEFTS19GSU5SRUMiLCJUQVNLIiwiRklOQU5DSUFMIiwiZXJyb3IiLCJ1cGRhdGVGaW5hbmNpYWxSZWNvcmRGcm9tVGFzayIsInByZXZpb3VzVGFzayIsImZpbmFuY2lhbFByb3BzQ2hhbmdlZCIsInVwZGF0ZWRGaW5yZWMiLCJ1cGRhdGVkRnJvbSIsImNoYW5nZXMiLCJmcm9tIiwidG8iLCJ0b0lTT1N0cmluZyIsInJlbW92ZUZpbmFuY2lhbFJlY29yZHNDcmVhdGVkQnlUYXNrIiwidGFza0lkIiwidGFza0ZpbmFuY2lhbHMiLCJmaWx0ZXIiLCJsZW5ndGgiLCJmaW5hbmNpYWwiLCJkZWxldGVGaW5hbmNpYWxSZWNvcmQiLCJjcmVhdGVGaW5hbmNpYWxSZWNvcmRGcm9tU2FsZSIsInNhbGUiLCJjb3VudGVycGFydHlOYW1lIiwidG90YWxzIiwidG90YWxSZXZlbnVlIiwic291cmNlU2FsZUlkIiwidW5kZWZpbmVkIiwicG9pbnRzIiwieHAiLCJycCIsImZwIiwiaHAiLCJTQUxFX0ZJTlJFQyIsIlNBTEUiLCJwcm9jZXNzRmluYW5jaWFsUmVjb3JkQ3JlYXRpb25XaXRoTGlua3MiLCJyZWNvcmQiXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./workflows/financial-record-utils.ts\n");

/***/ }),

/***/ "(rsc)/./workflows/item-creation-utils.ts":
/*!******************************************!*\
  !*** ./workflows/item-creation-utils.ts ***!
  \******************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   createItemFromRecord: () => (/* binding */ createItemFromRecord),\n/* harmony export */   createItemFromTask: () => (/* binding */ createItemFromTask),\n/* harmony export */   getDefaultItemStatus: () => (/* binding */ getDefaultItemStatus),\n/* harmony export */   processItemCreationWithLinks: () => (/* binding */ processItemCreationWithLinks),\n/* harmony export */   removeItemsCreatedByRecord: () => (/* binding */ removeItemsCreatedByRecord),\n/* harmony export */   removeItemsCreatedByTask: () => (/* binding */ removeItemsCreatedByTask)\n/* harmony export */ });\n/* harmony import */ var _types_enums__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @/types/enums */ \"(rsc)/./types/enums.ts\");\n/* harmony import */ var _data_store_datastore__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @/data-store/datastore */ \"(rsc)/./data-store/datastore.ts\");\n/* harmony import */ var _data_store_repositories_item_repo__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @/data-store/repositories/item.repo */ \"(rsc)/./data-store/repositories/item.repo.ts\");\n// workflows/item-creation-utils.ts\n// Item Creation System - DNA/RNA Molecular Pattern Implementation\n// Creates items from Tasks and Financial Records using emissary fields\n\n\n\n/**\r\n * Determines the default item status based on item type and sale status\r\n * All newly created items start as CREATED, regardless of type\r\n * Their status will change based on business logic later\r\n */ function getDefaultItemStatus(itemType, isSold = false) {\n    if (isSold) {\n        return _types_enums__WEBPACK_IMPORTED_MODULE_0__.ItemStatus.SOLD;\n    }\n    // All newly created items start as CREATED, regardless of type\n    // Their status will change based on business logic later\n    return _types_enums__WEBPACK_IMPORTED_MODULE_0__.ItemStatus.CREATED;\n}\n/**\r\n * Creates an Item entity from a Task's emissary fields\r\n * IDEMPOTENT: Checks if item already exists before creating\r\n * Uses atomic operations to prevent race conditions\r\n */ async function createItemFromTask(task) {\n    try {\n        console.log(`[createItemFromTask] Starting item creation for task: ${task.name} (${task.id})`);\n        console.log(`[createItemFromTask] outputItemType: ${task.outputItemType}`);\n        console.log(`[createItemFromTask] outputQuantity: ${task.outputQuantity}`);\n        if (!task.outputItemType) {\n            console.error(\"Cannot create item: outputItemType is required\");\n            return null;\n        }\n        // IDEMPOTENCY CHECK: Look for existing item created by this task\n        console.log(`[createItemFromTask] Checking for existing items...`);\n        const allItems = await (0,_data_store_datastore__WEBPACK_IMPORTED_MODULE_1__.getAllItems)();\n        console.log(`[createItemFromTask] Found ${allItems.length} total items`);\n        const existingItems = allItems.filter((item)=>item.sourceTaskId === task.id && item.type === task.outputItemType);\n        console.log(`[createItemFromTask] Found ${existingItems.length} existing items for this task`);\n        if (existingItems.length > 0) {\n            console.log(`[createItemFromTask] Item already exists, skipping creation`);\n            return existingItems[0]; // Return existing item\n        }\n        const newItem = {\n            id: `item-${task.id}-${Date.now()}`,\n            name: task.outputItemName || `${task.outputItemType} from ${task.name}`,\n            description: `Created from task: ${task.name}`,\n            type: task.outputItemType,\n            collection: task.outputItemCollection || undefined,\n            status: getDefaultItemStatus(task.outputItemType || \"\", task.isSold || false),\n            station: task.station,\n            unitCost: task.outputUnitCost || 0,\n            additionalCost: 0,\n            price: task.outputItemPrice || 0,\n            value: 0,\n            quantitySold: 0,\n            sourceTaskId: task.id,\n            ownerCharacterId: task.customerCharacterId || null,\n            isCollected: false,\n            year: new Date().getFullYear(),\n            createdAt: new Date(),\n            updatedAt: new Date(),\n            links: [],\n            stock: [\n                {\n                    siteId: task.targetSiteId || task.siteId || \"home-storage\",\n                    quantity: task.outputQuantity || 1\n                }\n            ]\n        };\n        // Store the item in DataStore\n        console.log(`[createItemFromTask] Creating new item:`, newItem);\n        const createdItem = await (0,_data_store_datastore__WEBPACK_IMPORTED_MODULE_1__.upsertItem)(newItem);\n        console.log(`[createItemFromTask] ✅ Item created successfully`);\n        return createdItem;\n    } catch (error) {\n        console.error(\"Error creating item from task:\", error);\n        return null;\n    }\n}\n/**\r\n * Creates an Item entity from a Financial Record's emissary fields\r\n * IDEMPOTENT: Checks if item already exists before creating\r\n * Uses atomic operations to prevent race conditions\r\n */ async function createItemFromRecord(record) {\n    try {\n        console.log(`[createItemFromRecord] Starting item creation for record: ${record.name} (${record.id})`);\n        console.log(`[createItemFromRecord] outputItemType: ${record.outputItemType}`);\n        console.log(`[createItemFromRecord] outputQuantity: ${record.outputQuantity}`);\n        if (!record.outputItemType) {\n            console.error(\"Cannot create item: outputItemType is required\");\n            return null;\n        }\n        // IDEMPOTENCY CHECK: Look for existing item created by this record\n        console.log(`[createItemFromRecord] Checking for existing items...`);\n        const allItems = await (0,_data_store_datastore__WEBPACK_IMPORTED_MODULE_1__.getAllItems)();\n        console.log(`[createItemFromRecord] Found ${allItems.length} total items`);\n        const existingItems = allItems.filter((item)=>item.sourceRecordId === record.id && item.type === record.outputItemType);\n        console.log(`[createItemFromRecord] Found ${existingItems.length} existing items for this record`);\n        if (existingItems.length > 0) {\n            console.log(`[createItemFromRecord] Item already exists, skipping creation`);\n            return existingItems[0]; // Return existing item\n        }\n        const newItem = {\n            id: `item-${record.id}-${Date.now()}`,\n            name: record.outputItemName || `${record.outputItemType} from ${record.name}`,\n            description: `Created from record: ${record.name}`,\n            type: record.outputItemType,\n            collection: record.outputItemCollection || undefined,\n            status: getDefaultItemStatus(record.outputItemType || \"\", record.isSold || false),\n            station: record.station,\n            unitCost: record.outputUnitCost || 0,\n            additionalCost: 0,\n            price: record.outputItemPrice || 0,\n            value: 0,\n            quantitySold: 0,\n            sourceRecordId: record.id,\n            isCollected: false,\n            year: record.year,\n            createdAt: new Date(),\n            updatedAt: new Date(),\n            links: [],\n            stock: [\n                {\n                    siteId: record.siteId || \"home-storage\",\n                    quantity: record.outputQuantity || 1\n                }\n            ]\n        };\n        // Store the item in DataStore\n        console.log(`[createItemFromRecord] Creating new item:`, newItem);\n        const createdItem = await (0,_data_store_datastore__WEBPACK_IMPORTED_MODULE_1__.upsertItem)(newItem);\n        console.log(`[createItemFromRecord] ✅ Item created successfully`);\n        return createdItem;\n    } catch (error) {\n        console.error(\"Error creating item from record:\", error);\n        return null;\n    }\n}\n/**\r\n * Removes all items created by a specific task\r\n * Used when task is uncompleted or deleted\r\n */ async function removeItemsCreatedByTask(taskId) {\n    try {\n        console.log(`[removeItemsCreatedByTask] Removing items created by task: ${taskId}`);\n        const items = await (0,_data_store_datastore__WEBPACK_IMPORTED_MODULE_1__.getAllItems)();\n        const itemsToRemove = items.filter((item)=>item.sourceTaskId === taskId);\n        console.log(`[removeItemsCreatedByTask] Found ${itemsToRemove.length} items to remove`);\n        // Remove each item created by this task\n        for (const item of itemsToRemove){\n            try {\n                await (0,_data_store_repositories_item_repo__WEBPACK_IMPORTED_MODULE_2__.deleteItem)(item.id);\n                console.log(`[removeItemsCreatedByTask] ✅ Removed item: ${item.name} (${item.id})`);\n            } catch (error) {\n                console.error(`[removeItemsCreatedByTask] ❌ Failed to remove item ${item.id}:`, error);\n            }\n        }\n        // Dispatch event to update UI\n        if (false) {}\n        console.log(`[removeItemsCreatedByTask] ✅ Completed removal of ${itemsToRemove.length} items`);\n    } catch (error) {\n        console.error(\"Error removing items created by task:\", error);\n    }\n}\n/**\r\n * Removes all items created by a specific financial record\r\n * Used when financial record is deleted\r\n */ async function removeItemsCreatedByRecord(recordId) {\n    try {\n        console.log(`[removeItemsCreatedByRecord] Removing items created by record: ${recordId}`);\n        const items = await (0,_data_store_datastore__WEBPACK_IMPORTED_MODULE_1__.getAllItems)();\n        const itemsToRemove = items.filter((item)=>item.sourceRecordId === recordId);\n        console.log(`[removeItemsCreatedByRecord] Found ${itemsToRemove.length} items to remove`);\n        // Remove each item created by this record\n        for (const item of itemsToRemove){\n            try {\n                await (0,_data_store_repositories_item_repo__WEBPACK_IMPORTED_MODULE_2__.deleteItem)(item.id);\n                console.log(`[removeItemsCreatedByRecord] ✅ Removed item: ${item.name} (${item.id})`);\n            } catch (error) {\n                console.error(`[removeItemsCreatedByRecord] ❌ Failed to remove item ${item.id}:`, error);\n            }\n        }\n        // Dispatch event to update UI\n        if (false) {}\n        console.log(`[removeItemsCreatedByRecord] ✅ Completed removal of ${itemsToRemove.length} items`);\n    } catch (error) {\n        console.error(\"Error removing items created by record:\", error);\n    }\n}\n/**\r\n * Enhanced item creation - pure business logic, no link creation\r\n */ async function processItemCreationWithLinks(item) {\n    console.log(`[processItemCreationWithLinks] Processing item creation: ${item.name} (${item.id})`);\n    return item;\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi93b3JrZmxvd3MvaXRlbS1jcmVhdGlvbi11dGlscy50cyIsIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7QUFBQSxtQ0FBbUM7QUFDbkMsa0VBQWtFO0FBQ2xFLHVFQUF1RTtBQUdJO0FBQ1Y7QUFDQTtBQUtqRTs7OztDQUlDLEdBQ00sU0FBU0kscUJBQXFCQyxRQUFnQixFQUFFQyxTQUFrQixLQUFLO0lBQzVFLElBQUlBLFFBQVE7UUFDVixPQUFPTixvREFBVUEsQ0FBQ08sSUFBSTtJQUN4QjtJQUVBLCtEQUErRDtJQUMvRCx5REFBeUQ7SUFDekQsT0FBT1Asb0RBQVVBLENBQUNRLE9BQU87QUFDM0I7QUFFQTs7OztDQUlDLEdBQ00sZUFBZUMsbUJBQW1CQyxJQUFVO0lBQ2pELElBQUk7UUFDRkMsUUFBUUMsR0FBRyxDQUFDLENBQUMsc0RBQXNELEVBQUVGLEtBQUtHLElBQUksQ0FBQyxFQUFFLEVBQUVILEtBQUtJLEVBQUUsQ0FBQyxDQUFDLENBQUM7UUFDN0ZILFFBQVFDLEdBQUcsQ0FBQyxDQUFDLHFDQUFxQyxFQUFFRixLQUFLSyxjQUFjLENBQUMsQ0FBQztRQUN6RUosUUFBUUMsR0FBRyxDQUFDLENBQUMscUNBQXFDLEVBQUVGLEtBQUtNLGNBQWMsQ0FBQyxDQUFDO1FBRXpFLElBQUksQ0FBQ04sS0FBS0ssY0FBYyxFQUFFO1lBQ3hCSixRQUFRTSxLQUFLLENBQUM7WUFDZCxPQUFPO1FBQ1Q7UUFFQSxpRUFBaUU7UUFDakVOLFFBQVFDLEdBQUcsQ0FBQyxDQUFDLG1EQUFtRCxDQUFDO1FBQ2pFLE1BQU1NLFdBQVcsTUFBTWhCLGtFQUFXQTtRQUNsQ1MsUUFBUUMsR0FBRyxDQUFDLENBQUMsMkJBQTJCLEVBQUVNLFNBQVNDLE1BQU0sQ0FBQyxZQUFZLENBQUM7UUFFdkUsTUFBTUMsZ0JBQWdCRixTQUFTRyxNQUFNLENBQUNDLENBQUFBLE9BQ3BDQSxLQUFLQyxZQUFZLEtBQUtiLEtBQUtJLEVBQUUsSUFDN0JRLEtBQUtFLElBQUksS0FBS2QsS0FB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QUM7SUFFaEcsT0FBT1E7QUFDVCIsInNvdXJjZXMiOlsid2VicGFjazovL3RoZWdhbWUtYWRtaW4vLi93b3JrZmxvd3MvaXRlbS1jcmVhdGlvbi11dGlscy50cz9lMjVlIl0sInNvdXJjZXNDb250ZW50IjpbIi8vIHdvcmtmbG93cy9pdGVtLWNyZWF0aW9uLXV0aWxzLnRzXHJcbi8vIEl0ZW0gQ3JlYXRpb24gU3lzdGVtIC0gRE5BL1JOQSBNb2xlY3VsYXIgUGF0dGVybiBJbXBsZW1lbnRhdGlvblxyXG4vLyBDcmVhdGVzIGl0ZW1zIGZyb20gVGFza3MgYW5kIEZpbmFuY2lhbCBSZWNvcmRzIHVzaW5nIGVtaXNzYXJ5IGZpZWxkc1xyXG5cclxuaW1wb3J0IHR5cGUgeyBUYXNrLCBJdGVtLCBGaW5hbmNpYWxSZWNvcmQgfSBmcm9tICdAL3R5cGVzL2VudGl0aWVzJztcclxuaW1wb3J0IHsgSXRlbVN0YXR1cywgSXRlbVR5cGUsIExpbmtUeXBlLCBFbnRpdHlUeXBlIH0gZnJvbSAnQC90eXBlcy9lbnVtcyc7XHJcbmltcG9ydCB7IHVwc2VydEl0ZW0sIGdldEFsbEl0ZW1zIH0gZnJvbSAnQC9kYXRhLXN0b3JlL2RhdGFzdG9yZSc7XHJcbmltcG9ydCB7IGRlbGV0ZUl0ZW0gfSBmcm9tICdAL2RhdGEtc3RvcmUvcmVwb3NpdG9yaWVzL2l0ZW0ucmVwbyc7XHJcbmltcG9ydCB7IGhhc0VmZmVjdCwgbWFya0VmZmVjdCB9IGZyb20gJ0AvZGF0YS1zdG9yZS9lZmZlY3RzLXJlZ2lzdHJ5JztcclxuLy8gbGlua3MgYXJlIGNyZWF0ZWQgYnkgcHJvY2Vzc0xpbmtFbnRpdHkoKVxyXG5pbXBvcnQgeyB2NCBhcyB1dWlkIH0gZnJvbSAndXVpZCc7XHJcblxyXG4vKipcclxuICogRGV0ZXJtaW5lcyB0aGUgZGVmYXVsdCBpdGVtIHN0YXR1cyBiYXNlZCBvbiBpdGVtIHR5cGUgYW5kIHNhbGUgc3RhdHVzXHJcbiAqIEFsbCBuZXdseSBjcmVhdGVkIGl0ZW1zIHN0YXJ0IGFzIENSRUFURUQsIHJlZ2FyZGxlc3Mgb2YgdHlwZVxyXG4gKiBUaGVpciBzdGF0dXMgd2lsbCBjaGFuZ2UgYmFzZWQgb24gYnVzaW5lc3MgbG9naWMgbGF0ZXJcclxuICovXHJcbmV4cG9ydCBmdW5jdGlvbiBnZXREZWZhdWx0SXRlbVN0YXR1cyhpdGVtVHlwZTogc3RyaW5nLCBpc1NvbGQ6IGJvb2xlYW4gPSBmYWxzZSk6IEl0ZW1TdGF0dXMge1xyXG4gIGlmIChpc1NvbGQpIHtcclxuICAgIHJldHVybiBJdGVtU3RhdHVzLlNPTEQ7XHJcbiAgfVxyXG4gIFxyXG4gIC8vIEFsbCBuZXdseSBjcmVhdGVkIGl0ZW1zIHN0YXJ0IGFzIENSRUFURUQsIHJlZ2FyZGxlc3Mgb2YgdHlwZVxyXG4gIC8vIFRoZWlyIHN0YXR1cyB3aWxsIGNoYW5nZSBiYXNlZCBvbiBidXNpbmVzcyBsb2dpYyBsYXRlclxyXG4gIHJldHVybiBJdGVtU3RhdHVzLkNSRUFURUQ7XHJcbn1cclxuXHJcbi8qKlxyXG4gKiBDcmVhdGVzIGFuIEl0ZW0gZW50aXR5IGZyb20gYSBUYXNrJ3MgZW1pc3NhcnkgZmllbGRzXHJcbiAqIElERU1QT1RFTlQ6IENoZWNrcyBpZiBpdGVtIGFscmVhZHkgZXhpc3RzIGJlZm9yZSBjcmVhdGluZ1xyXG4gKiBVc2VzIGF0b21pYyBvcGVyYXRpb25zIHRvIHByZXZlbnQgcmFjZSBjb25kaXRpb25zXHJcbiAqL1xyXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gY3JlYXRlSXRlbUZyb21UYXNrKHRhc2s6IFRhc2spOiBQcm9taXNlPEl0ZW0gfCBudWxsPiB7XHJcbiAgdHJ5IHtcclxuICAgIGNvbnNvbGUubG9nKGBbY3JlYXRlSXRlbUZyb21UYXNrXSBTdGFydGluZyBpdGVtIGNyZWF0aW9uIGZvciB0YXNrOiAke3Rhc2submFtZX0gKCR7dGFzay5pZH0pYCk7XHJcbiAgICBjb25zb2xlLmxvZyhgW2NyZWF0ZUl0ZW1Gcm9tVGFza10gb3V0cHV0SXRlbVR5cGU6ICR7dGFzay5vdXRwdXRJdGVtVHlwZX1gKTtcclxuICAgIGNvbnNvbGUubG9nKGBbY3JlYXRlSXRlbUZyb21UYXNrXSBvdXRwdXRRdWFudGl0eTogJHt0YXNrLm91dHB1dFF1YW50aXR5fWApO1xyXG4gICAgXHJcbiAgICBpZiAoIXRhc2sub3V0cHV0SXRlbVR5cGUpIHtcclxuICAgICAgY29uc29sZS5lcnJvcignQ2Fubm90IGNyZWF0ZSBpdGVtOiBvdXRwdXRJdGVtVHlwZSBpcyByZXF1aXJlZCcpO1xyXG4gICAgICByZXR1cm4gbnVsbDtcclxuICAgIH1cclxuICAgIFxyXG4gICAgLy8gSURFTVBPVEVOQ1kgQ0hFQ0s6IExvb2sgZm9yIGV4aXN0aW5nIGl0ZW0gY3JlYXRlZCBieSB0aGlzIHRhc2tcclxuICAgIGNvbnNvbGUubG9nKGBbY3JlYXRlSXRlbUZyb21UYXNrXSBDaGVja2luZyBmb3IgZXhpc3RpbmcgaXRlbXMuLi5gKTtcclxuICAgIGNvbnN0IGFsbEl0ZW1zID0gYXdhaXQgZ2V0QWxsSXRlbXMoKTtcclxuICAgIGNvbnNvbGUubG9nKGBbY3JlYXRlSXRlbUZyb21UYXNrXSBGb3VuZCAke2FsbEl0ZW1zLmxlbmd0aH0gdG90YWwgaXRlbXNgKTtcclxuICAgIFxyXG4gICAgY29uc3QgZXhpc3RpbmdJdGVtcyA9IGFsbEl0ZW1zLmZpbHRlcihpdGVtID0+IFxyXG4gICAgICBpdGVtLnNvdXJjZVRhc2tJZCA9PT0gdGFzay5pZCAmJiBcclxuICAgICAgaXRlbS50eXBlID09PSB0YXNrLm91dHB1dEl0ZW1UeXBlXHJcbiAgICApO1xyXG4gICAgY29uc29sZS5sb2coYFtjcmVhdGVJdGVtRnJvbVRhc2tdIEZvdW5kICR7ZXhpc3RpbmdJdGVtcy5sZW5ndGh9IGV4aXN0aW5nIGl0ZW1zIGZvciB0aGlzIHRhc2tgKTtcclxuICAgIFxyXG4gICAgaWYgKGV4aXN0aW5nSXRlbXMubGVuZ3RoID4gMCkge1xyXG4gICAgICBjb25zb2xlLmxvZyhgW2NyZWF0ZUl0ZW1Gcm9tVGFza10gSXRlbSBhbHJlYWR5IGV4aXN0cywgc2tpcHBpbmcgY3JlYXRpb25gKTtcclxuICAgICAgcmV0dXJuIGV4aXN0aW5nSXRlbXNbMF07IC8vIFJldHVybiBleGlzdGluZyBpdGVtXHJcbiAgICB9XHJcbiAgICBcclxuICAgIGNvbnN0IG5ld0l0ZW06IEl0ZW0gPSB7XHJcbiAgICAgIGlkOiBgaXRlbS0ke3Rhc2suaWR9LSR7RGF0ZS5ub3coKX1gLCAvLyBNb3JlIHByZWRpY3RhYmxlIElEIGJhc2VkIG9uIHRhc2sgSURcclxuICAgICAgbmFtZTogdGFzay5vdXRwdXRJdGVtTmFtZSB8fCBgJHt0YXNrLm91dHB1dEl0ZW1UeXBlfSBmcm9tICR7dGFzay5uYW1lfWAsXHJcbiAgICAgIGRlc2NyaXB0aW9uOiBgQ3JlYXRlZCBmcm9tIHRhc2s6ICR7dGFzay5uYW1lfWAsXHJcbiAgICAgIHR5cGU6IHRhc2sub3V0cHV0SXRlbVR5cGUgYXMgSXRlbVR5cGUsXHJcbiAgICAgIGNvbGxlY3Rpb246IHRhc2sub3V0cHV0SXRlbUNvbGxlY3Rpb24gfHwgdW5kZWZpbmVkLFxyXG4gICAgICBzdGF0dXM6IGdldERlZmF1bHRJdGVtU3RhdHVzKHRhc2sub3V0cHV0SXRlbVR5cGUgfHwgJycsIHRhc2suaXNTb2xkIHx8IGZhbHNlKSxcclxuICAgICAgc3RhdGlvbjogdGFzay5zdGF0aW9uLFxyXG4gICAgICB1bml0Q29zdDogdGFzay5vdXRwdXRVbml0Q29zdCB8fCAwLFxyXG4gICAgICBhZGRpdGlvbmFsQ29zdDogMCxcclxuICAgICAgcHJpY2U6IHRhc2sub3V0cHV0SXRlbVByaWNlIHx8IDAsIC8vIFVzZSB0YXNrJ3Mgb3V0cHV0SXRlbVByaWNlIGluc3RlYWQgb2YgdW5pdENvc3RcclxuICAgICAgdmFsdWU6IDAsXHJcbiAgICAgIHF1YW50aXR5U29sZDogMCxcclxuICAgICAgc291cmNlVGFza0lkOiB0YXNrLmlkLCAvLyBMaW5rIGl0ZW0gYmFjayB0byB0aGUgdGFzayB0aGF0IGNyZWF0ZWQgaXRcclxuICAgICAgb3duZXJDaGFyYWN0ZXJJZDogdGFzay5jdXN0b21lckNoYXJhY3RlcklkIHx8IG51bGwsIC8vIEVtaXNzYXJ5OiBQYXNzIGN1c3RvbWVyIGFzIGl0ZW0gb3duZXJcclxuICAgICAgaXNDb2xsZWN0ZWQ6IGZhbHNlLFxyXG4gICAgICB5ZWFyOiBuZXcgRGF0ZSgpLmdldEZ1bGxZZWFyKCksIC8vIFNldCBjdXJyZW50IHllYXJcclxuICAgICAgY3JlYXRlZEF0OiBuZXcgRGF0ZSgpLFxyXG4gICAgICB1cGRhdGVkQXQ6IG5ldyBEYXRlKCksXHJcbiAgICAgIGxpbmtzOiBbXSwgIC8vIEluaXRpYWxpemUgbGlua3MgYXJyYXkgKFRoZSBSb3NldHRhIFN0b25lKVxyXG4gICAgICBzdG9jazogW1xyXG4gICAgICAgIHtcclxuICAgICAgICAgIHNpdGVJZDogdGFzay50YXJnZXRTaXRlSWQgfHwgdGFzay5zaXRlSWQgfHwgJ2hvbWUtc3RvcmFnZScsIC8vIERlZmF1bHQgdG8gaG9tZSBzdG9yYWdlXHJcbiAgICAgICAgICBxdWFudGl0eTogdGFzay5vdXRwdXRRdWFudGl0eSB8fCAxXHJcbiAgICAgICAgfVxyXG4gICAgICBdXHJcbiAgICB9O1xyXG4gICAgXHJcbiAgICAvLyBTdG9yZSB0aGUgaXRlbSBpbiBEYXRhU3RvcmVcclxuICAgIGNvbnNvbGUubG9nKGBbY3JlYXRlSXRlbUZyb21UYXNrXSBDcmVhdGluZyBuZXcgaXRlbTpgLCBuZXdJdGVtKTtcclxuICAgIGNvbnN0IGNyZWF0ZWRJdGVtID0gYXdhaXQgdXBzZXJ0SXRlbShuZXdJdGVtKTtcclxuICAgIGNvbnNvbGUubG9nKGBbY3JlYXRlSXRlbUZyb21UYXNrXSDinIUgSXRlbSBjcmVhdGVkIHN1Y2Nlc3NmdWxseWApO1xyXG4gICAgXHJcbiAgICByZXR1cm4gY3JlYXRlZEl0ZW07XHJcbiAgfSBjYXRjaCAoZXJyb3IpIHtcclxuICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGNyZWF0aW5nIGl0ZW0gZnJvbSB0YXNrOicsIGVycm9yKTtcclxuICAgIHJldHVybiBudWxsO1xyXG4gIH1cclxufVxyXG5cclxuLyoqXHJcbiAqIENyZWF0ZXMgYW4gSXRlbSBlbnRpdHkgZnJvbSBhIEZpbmFuY2lhbCBSZWNvcmQncyBlbWlzc2FyeSBmaWVsZHNcclxuICogSURFTVBPVEVOVDogQ2hlY2tzIGlmIGl0ZW0gYWxyZWFkeSBleGlzdHMgYmVmb3JlIGNyZWF0aW5nXHJcbiAqIFVzZXMgYXRvbWljIG9wZXJhdGlvbnMgdG8gcHJldmVudCByYWNlIGNvbmRpdGlvbnNcclxuICovXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBjcmVhdGVJdGVtRnJvbVJlY29yZChyZWNvcmQ6IEZpbmFuY2lhbFJlY29yZCk6IFByb21pc2U8SXRlbSB8IG51bGw+IHtcclxuICB0cnkge1xyXG4gICAgY29uc29sZS5sb2coYFtjcmVhdGVJdGVtRnJvbVJlY29yZF0gU3RhcnRpbmcgaXRlbSBjcmVhdGlvbiBmb3IgcmVjb3JkOiAke3JlY29yZC5uYW1lfSAoJHtyZWNvcmQuaWR9KWApO1xyXG4gICAgY29uc29sZS5sb2coYFtjcmVhdGVJdGVtRnJvbVJlY29yZF0gb3V0cHV0SXRlbVR5cGU6ICR7cmVjb3JkLm91dHB1dEl0ZW1UeXBlfWApO1xyXG4gICAgY29uc29sZS5sb2coYFtjcmVhdGVJdGVtRnJvbVJlY29yZF0gb3V0cHV0UXVhbnRpdHk6ICR7cmVjb3JkLm91dHB1dFF1YW50aXR5fWApO1xyXG4gICAgXHJcbiAgICBpZiAoIXJlY29yZC5vdXRwdXRJdGVtVHlwZSkge1xyXG4gICAgICBjb25zb2xlLmVycm9yKCdDYW5ub3QgY3JlYXRlIGl0ZW06IG91dHB1dEl0ZW1UeXBlIGlzIHJlcXVpcmVkJyk7XHJcbiAgICAgIHJldHVybiBudWxsO1xyXG4gICAgfVxyXG4gICAgXHJcbiAgICAvLyBJREVNUE9URU5DWSBDSEVDSzogTG9vayBmb3IgZXhpc3RpbmcgaXRlbSBjcmVhdGVkIGJ5IHRoaXMgcmVjb3JkXHJcbiAgICBjb25zb2xlLmxvZyhgW2NyZWF0ZUl0ZW1Gcm9tUmVjb3JkXSBDaGVja2luZyBmb3IgZXhpc3RpbmcgaXRlbXMuLi5gKTtcclxuICAgIGNvbnN0IGFsbEl0ZW1zID0gYXdhaXQgZ2V0QWxsSXRlbXMoKTtcclxuICAgIGNvbnNvbGUubG9nKGBbY3JlYXRlSXRlbUZyb21SZWNvcmRdIEZvdW5kICR7YWxsSXRlbXMubGVuZ3RofSB0b3RhbCBpdGVtc2ApO1xyXG4gICAgXHJcbiAgICBjb25zdCBleGlzdGluZ0l0ZW1zID0gYWxsSXRlbXMuZmlsdGVyKGl0ZW0gPT4gXHJcbiAgICAgIGl0ZW0uc291cmNlUmVjb3JkSWQgPT09IHJlY29yZC5pZCAmJiBcclxuICAgICAgaXRlbS50eXBlID09PSByZWNvcmQub3V0cHV0SXRlbVR5cGVcclxuICAgICk7XHJcbiAgICBjb25zb2xlLmxvZyhgW2NyZWF0ZUl0ZW1Gcm9tUmVjb3JkXSBGb3VuZCAke2V4aXN0aW5nSXRlbXMubGVuZ3RofSBleGlzdGluZyBpdGVtcyBmb3IgdGhpcyByZWNvcmRgKTtcclxuICAgIFxyXG4gICAgaWYgKGV4aXN0aW5nSXRlbXMubGVuZ3RoID4gMCkge1xyXG4gICAgICBjb25zb2xlLmxvZyhgW2NyZWF0ZUl0ZW1Gcm9tUmVjb3JkXSBJdGVtIGFscmVhZHkgZXhpc3RzLCBza2lwcGluZyBjcmVhdGlvbmApO1xyXG4gICAgICByZXR1cm4gZXhpc3RpbmdJdGVtc1swXTsgLy8gUmV0dXJuIGV4aXN0aW5nIGl0ZW1cclxuICAgIH1cclxuICAgIFxyXG4gICAgY29uc3QgbmV3SXRlbTogSXRlbSA9IHtcclxuICAgICAgaWQ6IGBpdGVtLSR7cmVjb3JkLmlkfS0ke0RhdGUubm93KCl9YCwgLy8gTW9yZSBwcmVkaWN0YWJsZSBJRCBiYXNlZCBvbiByZWNvcmQgSURcclxuICAgICAgbmFtZTogcmVjb3JkLm91dHB1dEl0ZW1OYW1lIHx8IGAke3JlY29yZC5vdXRwdXRJdGVtVHlwZX0gZnJvbSAke3JlY29yZC5uYW1lfWAsXHJcbiAgICAgIGRlc2NyaXB0aW9uOiBgQ3JlYXRlZCBmcm9tIHJlY29yZDogJHtyZWNvcmQubmFtZX1gLFxyXG4gICAgICB0eXBlOiByZWNvcmQub3V0cHV0SXRlbVR5cGUgYXMgSXRlbVR5cGUsXHJcbiAgICAgIGNvbGxlY3Rpb246IHJlY29yZC5vdXRwdXRJdGVtQ29sbGVjdGlvbiB8fCB1bmRlZmluZWQsXHJcbiAgICAgIHN0YXR1czogZ2V0RGVmYXVsdEl0ZW1TdGF0dXMocmVjb3JkLm91dHB1dEl0ZW1UeXBlIHx8ICcnLCByZWNvcmQuaXNTb2xkIHx8IGZhbHNlKSxcclxuICAgICAgc3RhdGlvbjogcmVjb3JkLnN0YXRpb24sXHJcbiAgICAgIHVuaXRDb3N0OiByZWNvcmQub3V0cHV0VW5pdENvc3QgfHwgMCxcclxuICAgICAgYWRkaXRpb25hbENvc3Q6IDAsXHJcbiAgICAgIHByaWNlOiByZWNvcmQub3V0cHV0SXRlbVByaWNlIHx8IDAsIC8vIFVzZSByZWNvcmQncyBvdXRwdXRJdGVtUHJpY2UgaW5zdGVhZCBvZiB1bml0Q29zdFxyXG4gICAgICB2YWx1ZTogMCxcclxuICAgICAgcXVhbnRpdHlTb2xkOiAwLFxyXG4gICAgICBzb3VyY2VSZWNvcmRJZDogcmVjb3JkLmlkLCAvLyBMaW5rIGl0ZW0gYmFjayB0byB0aGUgcmVjb3JkIHRoYXQgY3JlYXRlZCBpdFxyXG4gICAgICBpc0NvbGxlY3RlZDogZmFsc2UsXHJcbiAgICAgIHllYXI6IHJlY29yZC55ZWFyLCAvLyBVc2UgcmVjb3JkJ3MgeWVhclxyXG4gICAgICBjcmVhdGVkQXQ6IG5ldyBEYXRlKCksXHJcbiAgICAgIHVwZGF0ZWRBdDogbmV3IERhdGUoKSxcclxuICAgICAgbGlua3M6IFtdLCAgLy8gSW5pdGlhbGl6ZSBsaW5rcyBhcnJheSAoVGhlIFJvc2V0dGEgU3RvbmUpXHJcbiAgICAgIHN0b2NrOiBbXHJcbiAgICAgICAge1xyXG4gICAgICAgICAgc2l0ZUlkOiByZWNvcmQuc2l0ZUlkIHx8ICdob21lLXN0b3JhZ2UnLCAvLyBEZWZhdWx0IHRvIGhvbWUgc3RvcmFnZVxyXG4gICAgICAgICAgcXVhbnRpdHk6IHJlY29yZC5vdXRwdXRRdWFudGl0eSB8fCAxXHJcbiAgICAgICAgfVxyXG4gICAgICBdXHJcbiAgICB9O1xyXG4gICAgXHJcbiAgICAvLyBTdG9yZSB0aGUgaXRlbSBpbiBEYXRhU3RvcmVcclxuICAgIGNvbnNvbGUubG9nKGBbY3JlYXRlSXRlbUZyb21SZWNvcmRdIENyZWF0aW5nIG5ldyBpdGVtOmAsIG5ld0l0ZW0pO1xyXG4gICAgY29uc3QgY3JlYXRlZEl0ZW0gPSBhd2FpdCB1cHNlcnRJdGVtKG5ld0l0ZW0pO1xyXG4gICAgY29uc29sZS5sb2coYFtjcmVhdGVJdGVtRnJvbVJlY29yZF0g4pyFIEl0ZW0gY3JlYXRlZCBzdWNjZXNzZnVsbHlgKTtcclxuICAgIFxyXG4gICAgcmV0dXJuIGNyZWF0ZWRJdGVtO1xyXG4gIH0gY2F0Y2ggKGVycm9yKSB7XHJcbiAgICBjb25zb2xlLmVycm9yKCdFcnJvciBjcmVhdGluZyBpdGVtIGZyb20gcmVjb3JkOicsIGVycm9yKTtcclxuICAgIHJldHVybiBudWxsO1xyXG4gIH1cclxufVxyXG5cclxuLyoqXHJcbiAqIFJlbW92ZXMgYWxsIGl0ZW1zIGNyZWF0ZWQgYnkgYSBzcGVjaWZpYyB0YXNrXHJcbiAqIFVzZWQgd2hlbiB0YXNrIGlzIHVuY29tcGxldGVkIG9yIGRlbGV0ZWRcclxuICovXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiByZW1vdmVJdGVtc0NyZWF0ZWRCeVRhc2sodGFza0lkOiBzdHJpbmcpOiBQcm9taXNlPHZvaWQ+IHtcclxuICB0cnkge1xyXG4gICAgY29uc29sZS5sb2coYFtyZW1vdmVJdGVtc0NyZWF0ZWRCeVRhc2tdIFJlbW92aW5nIGl0ZW1zIGNyZWF0ZWQgYnkgdGFzazogJHt0YXNrSWR9YCk7XHJcbiAgICBcclxuICAgIGNvbnN0IGl0ZW1zID0gYXdhaXQgZ2V0QWxsSXRlbXMoKTtcclxuICAgIGNvbnN0IGl0ZW1zVG9SZW1vdmUgPSBpdGVtcy5maWx0ZXIoaXRlbSA9PiBpdGVtLnNvdXJjZVRhc2tJZCA9PT0gdGFza0lkKTtcclxuICAgIFxyXG4gICAgY29uc29sZS5sb2coYFtyZW1vdmVJdGVtc0NyZWF0ZWRCeVRhc2tdIEZvdW5kICR7aXRlbXNUb1JlbW92ZS5sZW5ndGh9IGl0ZW1zIHRvIHJlbW92ZWApO1xyXG4gICAgXHJcbiAgICAvLyBSZW1vdmUgZWFjaCBpdGVtIGNyZWF0ZWQgYnkgdGhpcyB0YXNrXHJcbiAgICBmb3IgKGNvbnN0IGl0ZW0gb2YgaXRlbXNUb1JlbW92ZSkge1xyXG4gICAgICB0cnkge1xyXG4gICAgICAgIGF3YWl0IGRlbGV0ZUl0ZW0oaXRlbS5pZCk7XHJcbiAgICAgICAgY29uc29sZS5sb2coYFtyZW1vdmVJdGVtc0NyZWF0ZWRCeVRhc2tdIOKchSBSZW1vdmVkIGl0ZW06ICR7aXRlbS5uYW1lfSAoJHtpdGVtLmlkfSlgKTtcclxuICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcclxuICAgICAgICBjb25zb2xlLmVycm9yKGBbcmVtb3ZlSXRlbXNDcmVhdGVkQnlUYXNrXSDinYwgRmFpbGVkIHRvIHJlbW92ZSBpdGVtICR7aXRlbS5pZH06YCwgZXJyb3IpO1xyXG4gICAgICB9XHJcbiAgICB9XHJcbiAgICBcclxuICAgIC8vIERpc3BhdGNoIGV2ZW50IHRvIHVwZGF0ZSBVSVxyXG4gICAgaWYgKHR5cGVvZiB3aW5kb3cgIT09ICd1bmRlZmluZWQnKSB7XHJcbiAgICAgIHdpbmRvdy5kaXNwYXRjaEV2ZW50KG5ldyBDdXN0b21FdmVudCgnaXRlbXNVcGRhdGVkJykpO1xyXG4gICAgfVxyXG4gICAgXHJcbiAgICBjb25zb2xlLmxvZyhgW3JlbW92ZUl0ZW1zQ3JlYXRlZEJ5VGFza10g4pyFIENvbXBsZXRlZCByZW1vdmFsIG9mICR7aXRlbXNUb1JlbW92ZS5sZW5ndGh9IGl0ZW1zYCk7XHJcbiAgfSBjYXRjaCAoZXJyb3IpIHtcclxuICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIHJlbW92aW5nIGl0ZW1zIGNyZWF0ZWQgYnkgdGFzazonLCBlcnJvcik7XHJcbiAgfVxyXG59XHJcblxyXG4vKipcclxuICogUmVtb3ZlcyBhbGwgaXRlbXMgY3JlYXRlZCBieSBhIHNwZWNpZmljIGZpbmFuY2lhbCByZWNvcmRcclxuICogVXNlZCB3aGVuIGZpbmFuY2lhbCByZWNvcmQgaXMgZGVsZXRlZFxyXG4gKi9cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIHJlbW92ZUl0ZW1zQ3JlYXRlZEJ5UmVjb3JkKHJlY29yZElkOiBzdHJpbmcpOiBQcm9taXNlPHZvaWQ+IHtcclxuICB0cnkge1xyXG4gICAgY29uc29sZS5sb2coYFtyZW1vdmVJdGVtc0NyZWF0ZWRCeVJlY29yZF0gUmVtb3ZpbmcgaXRlbXMgY3JlYXRlZCBieSByZWNvcmQ6ICR7cmVjb3JkSWR9YCk7XHJcbiAgICBcclxuICAgIGNvbnN0IGl0ZW1zID0gYXdhaXQgZ2V0QWxsSXRlbXMoKTtcclxuICAgIGNvbnN0IGl0ZW1zVG9SZW1vdmUgPSBpdGVtcy5maWx0ZXIoaXRlbSA9PiBpdGVtLnNvdXJjZVJlY29yZElkID09PSByZWNvcmRJZCk7XHJcbiAgICBcclxuICAgIGNvbnNvbGUubG9nKGBbcmVtb3ZlSXRlbXNDcmVhdGVkQnlSZWNvcmRdIEZvdW5kICR7aXRlbXNUb1JlbW92ZS5sZW5ndGh9IGl0ZW1zIHRvIHJlbW92ZWApO1xyXG4gICAgXHJcbiAgICAvLyBSZW1vdmUgZWFjaCBpdGVtIGNyZWF0ZWQgYnkgdGhpcyByZWNvcmRcclxuICAgIGZvciAoY29uc3QgaXRlbSBvZiBpdGVtc1RvUmVtb3ZlKSB7XHJcbiAgICAgIHRyeSB7XHJcbiAgICAgICAgYXdhaXQgZGVsZXRlSXRlbShpdGVtLmlkKTtcclxuICAgICAgICBjb25zb2xlLmxvZyhgW3JlbW92ZUl0ZW1zQ3JlYXRlZEJ5UmVjb3JkXSDinIUgUmVtb3ZlZCBpdGVtOiAke2l0ZW0ubmFtZX0gKCR7aXRlbS5pZH0pYCk7XHJcbiAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XHJcbiAgICAgICAgY29uc29sZS5lcnJvcihgW3JlbW92ZUl0ZW1zQ3JlYXRlZEJ5UmVjb3JkXSDinYwgRmFpbGVkIHRvIHJlbW92ZSBpdGVtICR7aXRlbS5pZH06YCwgZXJyb3IpO1xyXG4gICAgICB9XHJcbiAgICB9XHJcbiAgICBcclxuICAgIC8vIERpc3BhdGNoIGV2ZW50IHRvIHVwZGF0ZSBVSVxyXG4gICAgaWYgKHR5cGVvZiB3aW5kb3cgIT09ICd1bmRlZmluZWQnKSB7XHJcbiAgICAgIHdpbmRvdy5kaXNwYXRjaEV2ZW50KG5ldyBDdXN0b21FdmVudCgnaXRlbXNVcGRhdGVkJykpO1xyXG4gICAgfVxyXG4gICAgXHJcbiAgICBjb25zb2xlLmxvZyhgW3JlbW92ZUl0ZW1zQ3JlYXRlZEJ5UmVjb3JkXSDinIUgQ29tcGxldGVkIHJlbW92YWwgb2YgJHtpdGVtc1RvUmVtb3ZlLmxlbmd0aH0gaXRlbXNgKTtcclxuICB9IGNhdGNoIChlcnJvcikge1xyXG4gICAgY29uc29sZS5lcnJvcignRXJyb3IgcmVtb3ZpbmcgaXRlbXMgY3JlYXRlZCBieSByZWNvcmQ6JywgZXJyb3IpO1xyXG4gIH1cclxufVxyXG5cclxuLyoqXHJcbiAqIEVuaGFuY2VkIGl0ZW0gY3JlYXRpb24gLSBwdXJlIGJ1c2luZXNzIGxvZ2ljLCBubyBsaW5rIGNyZWF0aW9uXHJcbiAqL1xyXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gcHJvY2Vzc0l0ZW1DcmVhdGlvbldpdGhMaW5rcyhpdGVtOiBJdGVtKTogUHJvbWlzZTxJdGVtPiB7XHJcbiAgY29uc29sZS5sb2coYFtwcm9jZXNzSXRlbUNyZWF0aW9uV2l0aExpbmtzXSBQcm9jZXNzaW5nIGl0ZW0gY3JlYXRpb246ICR7aXRlbS5uYW1lfSAoJHtpdGVtLmlkfSlgKTtcclxuICBcclxuICByZXR1cm4gaXRlbTtcclxufVxyXG4iXSwibmFtZXMiOlsiSXRlbVN0YXR1cyIsInVwc2VydEl0ZW0iLCJnZXRBbGxJdGVtcyIsImRlbGV0ZUl0ZW0iLCJnZXREZWZhdWx0SXRlbVN0YXR1cyIsIml0ZW1UeXBlIiwiaXNTb2xkIiwiU09MRCIsIkNSRUFURUQiLCJjcmVhdGVJdGVtRnJvbVRhc2siLCJ0YXNrIiwiY29uc29sZSIsImxvZyIsIm5hbWUiLCJpZCIsIm91dHB1dEl0ZW1UeXBlIiwib3V0cHV0UXVhbnRpdHkiLCJlcnJvciIsImFsbEl0ZW1zIiwibGVuZ3RoIiwiZXhpc3RpbmdJdGVtcyIsImZpbHRlciIsIml0ZW0iLCJzb3VyY2VUYXNrSWQiLCJ0eXBlIiwibmV3SXRlbSIsIkRhdGUiLCJub3ciLCJvdXRwdXRJdGVtTmFtZSIsImRlc2NyaXB0aW9uIiwiY29sbGVjdGlvbiIsIm91dHB1dEl0ZW1Db2xsZWN0aW9uIiwidW5kZWZpbmVkIiwic3RhdHVzIiwic3RhdGlvbiIsInVuaXRDb3N0Iiwib3V0cHV0VW5pdENvc3QiLCJhZGRpdGlvbmFsQ29zdCIsInByaWNlIiwib3V0cHV0SXRlbVByaWNlIiwidmFsdWUiLCJxdWFudGl0eVNvbGQiLCJvd25lckNoYXJhY3RlcklkIiwiY3VzdG9tZXJDaGFyYWN0ZXJJZCIsImlzQ29sbGVjdGVkIiwieWVhciIsImdldEZ1bGxZZWFyIiwiY3JlYXRlZEF0IiwidXBkYXRlZEF0IiwibGlua3MiLCJzdG9jayIsInNpdGVJZCIsInRhcmdldFNpdGVJZCIsInF1YW50aXR5IiwiY3JlYXRlZEl0ZW0iLCJjcmVhdGVJdGVtRnJvbVJlY29yZCIsInJlY29yZCIsInNvdXJjZVJlY29yZElkIiwicmVtb3ZlSXRlbXNDcmVhdGVkQnlUYXNrIiwidGFza0lkIiwiaXRlbXMiLCJpdGVtc1RvUmVtb3ZlIiwid2luZG93IiwiZGlzcGF0Y2hFdmVudCIsIkN1c3RvbUV2ZW50IiwicmVtb3ZlSXRlbXNDcmVhdGVkQnlSZWNvcmQiLCJyZWNvcmRJZCIsInByb2Nlc3NJdGVtQ3JlYXRpb25XaXRoTGlua3MiXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./workflows/item-creation-utils.ts\n");

/***/ }),

/***/ "(rsc)/./workflows/points-rewards-utils.ts":
/*!*******************************************!*\
  !*** ./workflows/points-rewards-utils.ts ***!
  \*******************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   awardJungleCoinsToCharacter: () => (/* binding */ awardJungleCoinsToCharacter),\n/* harmony export */   awardPointsToPlayer: () => (/* binding */ awardPointsToPlayer),\n/* harmony export */   calculatePointsFromRevenue: () => (/* binding */ calculatePointsFromRevenue),\n/* harmony export */   getMainCharacterId: () => (/* binding */ getMainCharacterId),\n/* harmony export */   getMainPlayerId: () => (/* binding */ getMainPlayerId),\n/* harmony export */   removeJungleCoinsFromCharacter: () => (/* binding */ removeJungleCoinsFromCharacter),\n/* harmony export */   removePointsFromPlayer: () => (/* binding */ removePointsFromPlayer)\n/* harmony export */ });\n/* harmony import */ var _lib_client_api__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @/lib/client-api */ \"(rsc)/./lib/client-api.ts\");\n/* harmony import */ var _links_links_workflows__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @/links/links-workflows */ \"(rsc)/./links/links-workflows.ts\");\n/* harmony import */ var _links_link_registry__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @/links/link-registry */ \"(rsc)/./links/link-registry.ts\");\n/* harmony import */ var _types_enums__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! @/types/enums */ \"(rsc)/./types/enums.ts\");\n// thegame/workflows/points-rewards-utils.ts\n\n\n\n\n/**\r\n * Awards points to a player with idempotency and proper tracking\r\n * @param playerId - ID of the player to award points to\r\n * @param points - Points to award (XP, RP, FP, HP)\r\n * @param sourceId - ID of the entity that triggered the award\r\n * @param sourceType - Type of entity (task, financial, sale)\r\n */ async function awardPointsToPlayer(playerId, points, sourceId, sourceType) {\n    try {\n        console.log(`[awardPointsToPlayer] Awarding points to player ${playerId} from ${sourceType} ${sourceId}`);\n        // Get the player\n        const players = await _lib_client_api__WEBPACK_IMPORTED_MODULE_0__.ClientAPI.getPlayers();\n        const player = players.find((p)=>p.id === playerId);\n        if (!player) {\n            console.log(`[awardPointsToPlayer] Player ${playerId} not found, skipping`);\n            return;\n        }\n        // Check if any points to award\n        const hasPoints = (points.xp || 0) > 0 || (points.rp || 0) > 0 || (points.fp || 0) > 0 || (points.hp || 0) > 0;\n        if (!hasPoints) {\n            console.log(`[awardPointsToPlayer] No points to award, skipping`);\n            return;\n        }\n        // Update player points\n        const updatedPlayer = {\n            ...player,\n            points: {\n                xp: (player.points?.xp || 0) + (points.xp || 0),\n                rp: (player.points?.rp || 0) + (points.rp || 0),\n                fp: (player.points?.fp || 0) + (points.fp || 0),\n                hp: (player.points?.hp || 0) + (points.hp || 0)\n            },\n            totalPoints: {\n                xp: (player.totalPoints?.xp || 0) + (points.xp || 0),\n                rp: (player.totalPoints?.rp || 0) + (points.rp || 0),\n                fp: (player.totalPoints?.fp || 0) + (points.fp || 0),\n                hp: (player.totalPoints?.hp || 0) + (points.hp || 0)\n            },\n            updatedAt: new Date()\n        };\n        // Save updated player\n        await _lib_client_api__WEBPACK_IMPORTED_MODULE_0__.ClientAPI.upsertPlayer(updatedPlayer);\n        console.log(`[awardPointsToPlayer] ✅ Points awarded successfully:`, points);\n        // Create appropriate link based on source type - use forward links (SOURCE → PLAYER)\n        let linkType;\n        let sourceEntityType;\n        switch(sourceType){\n            case \"task\":\n                linkType = _types_enums__WEBPACK_IMPORTED_MODULE_3__.LinkType.TASK_PLAYER;\n                sourceEntityType = _types_enums__WEBPACK_IMPORTED_MODULE_3__.EntityType.TASK;\n                break;\n            case \"financial\":\n                linkType = _types_enums__WEBPACK_IMPORTED_MODULE_3__.LinkType.FINREC_PLAYER;\n                sourceEntityType = _types_enums__WEBPACK_IMPORTED_MODULE_3__.EntityType.FINANCIAL;\n                break;\n            case \"sale\":\n                linkType = _types_enums__WEBPACK_IMPORTED_MODULE_3__.LinkType.SALE_PLAYER;\n                sourceEntityType = _types_enums__WEBPACK_IMPORTED_MODULE_3__.EntityType.SALE;\n                break;\n            default:\n                console.warn(`[awardPointsToPlayer] Unknown source type: ${sourceType}`);\n                return;\n        }\n        // Create link with points metadata (forward link: SOURCE → PLAYER)\n        const link = (0,_links_links_workflows__WEBPACK_IMPORTED_MODULE_1__.makeLink)(linkType, {\n            type: sourceEntityType,\n            id: sourceId\n        }, {\n            type: _types_enums__WEBPACK_IMPORTED_MODULE_3__.EntityType.PLAYER,\n            id: playerId\n        }, {\n            points: points,\n            sourceType: sourceType,\n            awardedAt: new Date().toISOString()\n        });\n        await (0,_links_link_registry__WEBPACK_IMPORTED_MODULE_2__.createLink)(link);\n        console.log(`[awardPointsToPlayer] ✅ Link created: ${linkType}`);\n    } catch (error) {\n        console.error(`[awardPointsToPlayer] ❌ Failed to award points:`, error);\n        throw error;\n    }\n}\n/**\r\n * Removes points from a player (rollback function)\r\n * @param playerId - ID of the player to remove points from\r\n * @param points - Points to remove (XP, RP, FP, HP)\r\n */ async function removePointsFromPlayer(playerId, points) {\n    try {\n        console.log(`[removePointsFromPlayer] Removing points from player ${playerId}`);\n        // Get the player\n        const players = await _lib_client_api__WEBPACK_IMPORTED_MODULE_0__.ClientAPI.getPlayers();\n        const player = players.find((p)=>p.id === playerId);\n        if (!player) {\n            console.log(`[removePointsFromPlayer] Player ${playerId} not found, skipping`);\n            return;\n        }\n        // Check if any points to remove\n        const hasPoints = (points.xp || 0) > 0 || (points.rp || 0) > 0 || (points.fp || 0) > 0 || (points.hp || 0) > 0;\n        if (!hasPoints) {\n            console.log(`[removePointsFromPlayer] No points to remove, skipping`);\n            return;\n        }\n        // Update player points (ensure they don't go negative)\n        const updatedPlayer = {\n            ...player,\n            points: {\n                xp: Math.max(0, (player.points?.xp || 0) - (points.xp || 0)),\n                rp: Math.max(0, (player.points?.rp || 0) - (points.rp || 0)),\n                fp: Math.max(0, (player.points?.fp || 0) - (points.fp || 0)),\n                hp: Math.max(0, (player.points?.hp || 0) - (points.hp || 0))\n            },\n            // Note: totalPoints are NOT reduced (they track lifetime earnings)\n            updatedAt: new Date()\n        };\n        // Save updated player\n        await _lib_client_api__WEBPACK_IMPORTED_MODULE_0__.ClientAPI.upsertPlayer(updatedPlayer);\n        console.log(`[removePointsFromPlayer] ✅ Points removed successfully:`, points);\n    } catch (error) {\n        console.error(`[removePointsFromPlayer] ❌ Failed to remove points:`, error);\n        throw error;\n    }\n}\n/**\r\n * Awards jungle coins to a character\r\n * @param characterId - ID of the character to award jungle coins to\r\n * @param amount - Amount of jungle coins to award\r\n * @param sourceId - ID of the entity that triggered the award\r\n * @param sourceType - Type of entity (task, financial, sale)\r\n */ async function awardJungleCoinsToCharacter(characterId, amount, sourceId, sourceType) {\n    try {\n        console.log(`[awardJungleCoinsToCharacter] Awarding ${amount} J$ to character ${characterId} from ${sourceType} ${sourceId}`);\n        if (amount <= 0) {\n            console.log(`[awardJungleCoinsToCharacter] No jungle coins to award, skipping`);\n            return;\n        }\n        // Get the character\n        const characters = await _lib_client_api__WEBPACK_IMPORTED_MODULE_0__.ClientAPI.getCharacters();\n        const character = characters.find((c)=>c.id === characterId);\n        if (!character) {\n            console.log(`[awardJungleCoinsToCharacter] Character ${characterId} not found, skipping`);\n            return;\n        }\n        // Update character jungle coins\n        const updatedCharacter = {\n            ...character,\n            jungleCoins: (character.jungleCoins || 0) + amount,\n            updatedAt: new Date()\n        };\n        // Save updated character\n        await _lib_client_api__WEBPACK_IMPORTED_MODULE_0__.ClientAPI.upsertCharacter(updatedCharacter);\n        console.log(`[awardJungleCoinsToCharacter] ✅ Jungle coins awarded successfully: ${amount} J$`);\n        // NOTE: J$ (Jungle Coins) are CURRENCY that belongs to FINANCIALS\n        // They can be borrowed as AMBASSADOR by Player and Character, but don't belong to them\n        // No link creation needed here - J$ are handled by the Financial system\n        console.log(`[awardJungleCoinsToCharacter] ✅ Jungle coins awarded to character (J$ handled by Financial system)`);\n    } catch (error) {\n        console.error(`[awardJungleCoinsToCharacter] ❌ Failed to award jungle coins:`, error);\n        throw error;\n    }\n}\n/**\r\n * Removes jungle coins from a character (rollback function)\r\n * @param characterId - ID of the character to remove jungle coins from\r\n * @param amount - Amount of jungle coins to remove\r\n */ async function removeJungleCoinsFromCharacter(characterId, amount) {\n    try {\n        console.log(`[removeJungleCoinsFromCharacter] Removing ${amount} J$ from character ${characterId}`);\n        if (amount <= 0) {\n            console.log(`[removeJungleCoinsFromCharacter] No jungle coins to remove, skipping`);\n            return;\n        }\n        // Get the character\n        const characters = await _lib_client_api__WEBPACK_IMPORTED_MODULE_0__.ClientAPI.getCharacters();\n        const character = characters.find((c)=>c.id === characterId);\n        if (!character) {\n            console.log(`[removeJungleCoinsFromCharacter] Character ${characterId} not found, skipping`);\n            return;\n        }\n        // Update character jungle coins (ensure they don't go negative)\n        const updatedCharacter = {\n            ...character,\n            jungleCoins: Math.max(0, (character.jungleCoins || 0) - amount),\n            updatedAt: new Date()\n        };\n        // Save updated character\n        await _lib_client_api__WEBPACK_IMPORTED_MODULE_0__.ClientAPI.upsertCharacter(updatedCharacter);\n        console.log(`[removeJungleCoinsFromCharacter] ✅ Jungle coins removed successfully: ${amount} J$`);\n    } catch (error) {\n        console.error(`[removeJungleCoinsFromCharacter] ❌ Failed to remove jungle coins:`, error);\n        throw error;\n    }\n}\n/**\r\n * Calculates points from sale revenue (1 Point = $100)\r\n * @param revenue - Revenue amount in dollars\r\n * @returns Points to award (distributed across all types)\r\n */ function calculatePointsFromRevenue(revenue) {\n    const pointsAwarded = Math.floor(revenue / 100);\n    if (pointsAwarded <= 0) {\n        return {\n            xp: 0,\n            rp: 0,\n            fp: 0,\n            hp: 0\n        };\n    }\n    // Distribute points across all types equally\n    const pointsPerType = Math.floor(pointsAwarded / 4);\n    const remainder = pointsAwarded % 4;\n    return {\n        xp: pointsPerType + (remainder > 0 ? 1 : 0),\n        rp: pointsPerType + (remainder > 1 ? 1 : 0),\n        fp: pointsPerType + (remainder > 2 ? 1 : 0),\n        hp: pointsPerType\n    };\n}\n/**\r\n * Gets the main player ID (V0.1 constant)\r\n * TODO: V0.2 - Use character.playerId field\r\n */ function getMainPlayerId() {\n    return \"PLAYER_ONE_ID\"; // V0.1 constant\n}\n/**\r\n * Gets the main character ID (V0.1 constant)\r\n * TODO: V0.2 - Use proper character selection\r\n */ function getMainCharacterId() {\n    return \"CHARACTER_ONE_ID\"; // V0.1 constant\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi93b3JrZmxvd3MvcG9pbnRzLXJld2FyZHMtdXRpbHMudHMiLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7Ozs7QUFBQSw0Q0FBNEM7QUFFQztBQUNNO0FBQ0E7QUFDRTtBQUVyRDs7Ozs7O0NBTUMsR0FDTSxlQUFlSyxvQkFDcEJDLFFBQWdCLEVBQ2hCQyxNQUF5QixFQUN6QkMsUUFBZ0IsRUFDaEJDLFVBQWtCO0lBRWxCLElBQUk7UUFDRkMsUUFBUUMsR0FBRyxDQUFDLENBQUMsZ0RBQWdELEVBQUVMLFNBQVMsTUFBTSxFQUFFRyxXQUFXLENBQUMsRUFBRUQsU0FBUyxDQUFDO1FBRXhHLGlCQUFpQjtRQUNqQixNQUFNSSxVQUFVLE1BQU1aLHNEQUFTQSxDQUFDYSxVQUFVO1FBQzFDLE1BQU1DLFNBQVNGLFFBQVFHLElBQUksQ0FBQ0MsQ0FBQUEsSUFBS0EsRUFBRUMsRUFBRSxLQUFLWDtRQUMxQyxJQUFJLENBQUNRLFFBQVE7WUFDWEosUUFBUUMsR0FBRyxDQUFDLENBQUMsNkJBQTZCLEVBQUVMLFNBQVMsb0JBQW9CLENBQUM7WUFDMUU7UUFDRjtRQUVBLCtCQUErQjtRQUMvQixNQUFNWSxZQUFZLENBQUNYLE9BQU9ZLEVBQUUsSUFBSSxLQUFLLEtBQUssQ0FBQ1osT0FBT2EsRUFBRSxJQUFJLEtBQUssS0FDNUMsQ0FBQ2IsT0FBT2MsRUFBRSxJQUFJLEtBQUssS0FBSyxDQUFDZCxPQUFPZSxFQUFFLElBQUksS0FBSztRQUU1RCxJQUFJLENBQUNKLFdBQVc7WUFDZFIsUUFBUUMsR0FBRyxDQUFDLENBQUMsa0RBQWtELENBQUM7WUFDaEU7UUFDRjtRQUVBLHVCQUF1QjtRQUN2QixNQUFNWSxnQkFBd0I7WUFDNUIsR0FBR1QsTUFBTTtZQUNUUCxRQUFRO2dCQUNOWSxJQUFJLENBQUNMLE9BQU9QLE1BQU0sRUFBRVksTUFBTSxLQUFNWixDQUFBQSxPQUFPWSxFQUFFLElBQUk7Z0JBQzdDQyxJQUFJLENBQUNOLE9BQU9QLE1BQU0sRUFBRWEsTUFBTSxLQUFNYixDQUFBQSxPQUFPYSxFQUFFLElBQUk7Z0JBQzdDQyxJQUFJLENBQUNQLE9BQU9QLE1BQU0sRUFBRWMsTUFBTSxLQUFNZCxDQUFBQSxPQUFPYyxFQUFFLElBQUk7Z0JBQzdDQyxJQUFJLENBQUNSLE9BQU9QLE1BQU0sRUFBRWUsTUFBTSxLQUFNZixDQUFBQSxPQUFPZSxFQUFFLElBQUk7WUFDL0M7WUFDQUUsYUFBYTtnQkFDWEwsSUFBSSxDQUFDTCxPQUFPVSxXQUFXLEVBQUVMLE1BQU0sS0FBTVosQ0FBQUEsT0FBT1ksRUFBRSxJQUFJO2dCQUNsREMsSUFBSSxDQUFDTixPQUFPVSxXQUFXLEVBQUVKLE1BQU0sS0FBTWIsQ0FBQUEsT0FBT2EsRUFBRSxJQUFJO2dCQUNsREMsSUFBSSxDQUFDUCxPQUFPVSxXQUFXLEVBQUVILE1BQU0sS0FBTWQsQ0FBQUEsT0FBT2MsRUFBRSxJQUFJO2dCQUNsREMsSUFBSSxDQUFDUixPQUFPVSxXQUFXLEVBQUVGLE1BQU0sS0FBTWYsQ0FBQUEsT0FBT2UsRUFBRSxJQUFJO1lBQ3BEO1lBQ0FHLFdBQVcsSUFBSUM7UUFDakI7UUFFQSxzQkFBc0I7UUFDdEIsTUFBTTFCLHNEQUFTQSxDQUFDMkIsWUFBWSxDQUFDSjtRQUM3QmIsUUFBUUMsR0FBRyxDQUFDLENBQUMsb0RBQW9ELENBQUMsRUFBRUo7UUFFcEUscUZBQXFGO1FBQ3JGLElBQUlxQjtRQUNKLElBQUlDO1FBRUosT0FBUXBCO1lBQ04sS0FBSztnQkFDSG1CLFdBQVd6QixrREFBUUEsQ0FBQzJCLFdBQVc7Z0JBQy9CRCxtQkFBbUJ6QixvREFBVUEsQ0FBQzJCLElBQUk7Z0JBQ2xDO1lBQ0YsS0FBSztnQkFDSEgsV0FBV3pCLGtEQUFRQSxDQUFDNkIsYUFBYTtnQkFDakNILG1CQUFtQnpCLG9EQUFVQSxDQUFDNkIsU0FBUztnQkFDdkM7WUFDRixLQUFLO2dCQUNITCxXQUFXekIsa0RBQVFBLENBQUMrQixXQUFXO2dCQUMvQkwsbUJBQW1CekIsb0RBQVVBLENBQUMrQixJQUFJO2dCQUNsQztZQUNGO2dCQUNFekIsUUFBUTBCLElBQUksQ0FBQyxDQUFDLDJDQUEyQyxFQUFFM0IsV0FBVyxDQUFDO2dCQUN2RTtRQUNKO1FBRUEsbUVBQW1FO1FBQ25FLE1BQU00QixPQUFPcEMsZ0VBQVFBLENBQ25CMkIsVUFDQTtZQUFFVSxNQUFNVDtZQUFrQlosSUFBSVQ7UUFBUyxHQUN2QztZQUFFOEIsTUFBTWxDLG9EQUFVQSxDQUFDbUMsTUFBTTtZQUFFdEIsSUFBSVg7UUFBUyxHQUN4QztZQUNFQyxRQUFRQTtZQUNSRSxZQUFZQTtZQUNaK0IsV0FBVyxJQUFJZCxPQUFPZSxXQUFXO1FBQ25DO1FBR0YsTUFBTXZDLGdFQUFVQSxDQUFDbUM7UUFDakIzQixRQUFRQyxHQUFHLENBQUMsQ0FBQyxzQ0FBc0MsRUFBRWlCLFNBQVMsQ0FBQztJQUVqRSxFQUFFLE9BQU9jLE9BQU87UUFDZGhDLFFBQVFnQyxLQUFLLENBQUMsQ0FBQywrQ0FBK0MsQ0FBQyxFQUFFQTtRQUNqRSxNQUFNQTtJQUNSO0FBQ0Y7QUFFQTs7OztDQUlDLEdBQ00sZUFBZUMsdUJBQ3BCckMsUUFBZ0IsRUFDaEJDLE1BQXlCO0lBRXpCLElBQUk7UUFDRkcsUUFBUUMsR0FBRyxDQUFDLENBQUMscURBQXFELEVBQUVMLFNBQVMsQ0FBQztRQUU5RSxpQkFBaUI7UUFDakIsTUFBTU0sVUFBVSxNQUFNWixzREFBU0EsQ0FBQ2EsVUFBVTtRQUMxQyxNQUFNQyxTQUFTRixRQUFRRyxJQUFJLENBQUNDLENBQUFBLElBQUtBLEVBQUVDLEVBQUUsS0FBS1g7UUFDMUMsSUFBSSxDQUFDUSxRQUFRO1lBQ1hKLFFBQVFDLEdBQUcsQ0FBQyxDQUFDLGdDQUFnQyxFQUFFTCxTQUFTLG9CQUFvQixDQUFDO1lBQzdFO1FBQ0Y7UUFFQSxnQ0FBZ0M7UUFDaEMsTUFBTVksWUFBWSxDQUFDWCxPQUFPWSxFQUFFLElBQUksS0FBSyxLQUFLLENBQUNaLE9BQU9hLEVBQUUsSUFBSSxLQUFLLEtBQzVDLENBQUNiLE9BQU9jLEVBQUUsSUFBSSxLQUFLLEtBQUssQ0FBQ2QsT0FBT2UsRUFBRSxJQUFJLEtBQUs7UUFFNUQsSUFBSSxDQUFDSixXQUFXO1lBQ2RSLFFBQVFDLEdBQUcsQ0FBQyxDQUFDLHNEQUFzRCxDQUFDO1lBQ3BFO1FBQ0Y7UUFFQSx1REFBdUQ7UUFDdkQsTUFBTVksZ0JBQXdCO1lBQzVCLEdBQUdULE1BQU07WUFDVFAsUUFBUTtnQkFDTlksSUFBSXlCLEtBQUtDLEdBQUcsQ0FBQyxHQUFHLENBQUMvQixPQUFPUCxNQUFNLEVBQUVZLE1BQU0sS0FBTVosQ0FBQUEsT0FBT1ksRUFBRSxJQUFJO2dCQUN6REMsSUFBSXdCLEtBQUtDLEdBQUcsQ0FBQyxHQUFHLENBQUMvQixPQUFPUCxNQUFNLEVBQUVhLE1BQU0sS0FBTWIsQ0FBQUEsT0FBT2EsRUFBRSxJQUFJO2dCQUN6REMsSUFBSXVCLEtBQUtDLEdBQUcsQ0FBQyxHQUFHLENBQUMvQixPQUFPUCxNQUFNLEVBQUVjLE1BQU0sS0FBTWQsQ0FBQUEsT0FBT2MsRUFBRSxJQUFJO2dCQUN6REMsSUFBSXNCLEtBQUtDLEdBQUcsQ0FBQyxHQUFHLENBQUMvQixPQUFPUCxNQUFNLEVBQUVlLE1BQU0sS0FBTWYsQ0FBQUEsT0FBT2UsRUFBRSxJQUFJO1lBQzNEO1lBQ0EsbUVBQW1FO1lBQ25FRyxXQUFXLElBQUlDO1FBQ2pCO1FBRUEsc0JBQXNCO1FBQ3RCLE1BQU0xQixzREFBU0EsQ0FBQzJCLFlBQVksQ0FBQ0o7UUFDN0JiLFFBQVFDLEdBQUcsQ0FBQyxDQUFDLHVEQUF1RCxDQUFDLEVBQUVKO0lBRXpFLEVBQUUsT0FBT21DLE9BQU87UUFDZGhDLFFBQVFnQyxLQUFLLENBQUMsQ0FBQyxtREFBbUQsQ0FBQyxFQUFFQTtRQUNyRSxNQUFNQTtJQUNSO0FBQ0Y7QUFFQTs7Ozs7O0NBTUMsR0FDTSxlQUFlSSw0QkFDcEJDLFdBQW1CLEVBQ25CQyxNQUFjLEVBQ2R4QyxRQUFnQixFQUNoQkMsVUFBa0I7SUFFbEIsSUFBSTtRQUNGQyxRQUFRQyxHQUFHLENBQUMsQ0FBQyx1Q0FBdUMsRUFBRXFDLE9BQU8saUJBQWlCLEVBQUVELFlBQVksTUFBTSxFQUFFdEMsV0FBVyxDQUFDLEVBQUVELFNBQVMsQ0FBQztRQUU1SCxJQUFJd0MsVUFBVSxHQUFHO1lBQ2Z0QyxRQUFRQyxHQUFHLENBQUMsQ0FBQyxnRUFBZ0UsQ0FBQztZQUM5RTtRQUNGO1FBRUEsb0JBQW9CO1FBQ3BCLE1BQU1zQyxhQUFhLE1BQU1qRCxzREFBU0EsQ0FBQ2tELGFBQWE7UUFDaEQsTUFBTUMsWUFBWUYsV0FBV2xDLElBQUksQ0FBQ3FDLENBQUFBLElBQUtBLEVBQUVuQyxFQUFFLEtBQUs4QjtRQUNoRCxJQUFJLENBQUNJLFdBQVc7WUFDZHpDLFFBQVFDLEdBQUcsQ0FBQyxDQUFDLHdDQUF3QyxFQUFFb0MsWUFBWSxvQkFBb0IsQ0FBQztZQUN4RjtRQUNGO1FBRUEsZ0NBQWdDO1FBQ2hDLE1BQU1NLG1CQUE4QjtZQUNsQyxHQUFHRixTQUFTO1lBQ1pHLGFBQWEsQ0FBQ0gsVUFBVUcsV0FBVyxJQUFJLEtBQUtOO1lBQzVDdkIsV0FBVyxJQUFJQztRQUNqQjtRQUVBLHlCQUF5QjtRQUN6QixNQUFNMUIsc0RBQVNBLENBQUN1RCxlQUFlLENBQUNGO1FBQ2hDM0MsUUFBUUMsR0FBRyxDQUFDLENBQUMsbUVBQW1FLEVBQUVxQyxPQUFPLEdBQUcsQ0FBQztRQUU3RixrRUFBa0U7UUFDbEUsdUZBQXVGO1FBQ3ZGLHdFQUF3RTtRQUN4RXRDLFFBQVFDLEdBQUcsQ0FBQyxDQUFDLGtHQUFrRyxDQUFDO0lBRWxILEVBQUUsT0FBTytCLE9BQU87UUFDZGhDLFFBQVFnQyxLQUFLLENBQUMsQ0FBQyw2REFBNkQsQ0FBQyxFQUFFQTtRQUMvRSxNQUFNQTtJQUNSO0FBQ0Y7QUFFQTs7OztDQUlDLEdBQ00sZUFBZWMsK0JBQ3BCVCxXQUFtQixFQUNuQkMsTUFBYztJQUVkLElBQUk7UUFDRnRDLFFBQVFDLEdBQUcsQ0FBQyxDQUFDLDBDQUEwQyxFQUFFcUMsT0FBTyxtQkFBbUIsRUFBRUQsWUFBWSxDQUFDO1FBRWxHLElBQUlDLFVBQVUsR0FBRztZQUNmdEMsUUFBUUMsR0FBRyxDQUFDLENBQUMsb0VBQW9FLENBQUM7WUFDbEY7UUFDRjtRQUVBLG9CQUFvQjtRQUNwQixNQUFNc0MsYUFBYSxNQUFNakQsc0RBQVNBLENBQUNrRCxhQUFhO1FBQ2hELE1BQU1DLFlBQVlGLFdBQVdsQyxJQUFJLENBQUNxQyxDQUFBQSxJQUFLQSxFQUFFbkMsRUFBRSxLQUFLOEI7UUFDaEQsSUFBSSxDQUFDSSxXQUFXO1lBQ2R6QyxRQUFRQyxHQUFHLENBQUMsQ0FBQywyQ0FBMkMsRUFBRW9DLFlBQVksb0JBQW9CLENBQUM7WUFDM0Y7UUFDRjtRQUVBLGdFQUFnRTtRQUNoRSxNQUFNTSxtQkFBOEI7WUFDbEMsR0FBR0YsU0FBUztZQUNaRyxhQUFhVixLQUFLQyxHQUFHLENBQUMsR0FBRyxDQUFDTSxVQUFVRyxXQUFXLElBQUksS0FBS047WUFDeER2QixXQUFXLElBQUlDO1FBQ2pCO1FBRUEseUJBQXlCO1FBQ3pCLE1BQU0xQixzREFBU0EsQ0FBQ3VELGVBQWUsQ0FBQ0Y7UUFDaEMzQyxRQUFRQyxHQUFHLENBQUMsQ0FBQyxzRUFBc0UsRUFBRXFDLE9BQU8sR0FBRyxDQUFDO0lBRWxHLEVBQUUsT0FBT04sT0FBTztRQUNkaEMsUUFBUWdDLEtBQUssQ0FBQyxDQUFDLGlFQUFpRSxDQUFDLEVBQUVBO1FBQ25GLE1BQU1BO0lBQ1I7QUFDRjtBQUVBOzs7O0NBSUMsR0FDTSxTQUFTZSwyQkFBMkJDLE9BQWU7SUFDeEQsTUFBTUMsZ0JBQWdCZixLQUFLZ0IsS0FBSyxDQUFDRixVQUFVO0lBRTNDLElBQUlDLGlCQUFpQixHQUFHO1FBQ3RCLE9BQU87WUFBRXhDLElBQUk7WUFBR0MsSUFBSTtZQUFHQyxJQUFJO1lBQUdDLElBQUk7UUFBRTtJQUN0QztJQUVBLDZDQUE2QztJQUM3QyxNQUFNdUMsZ0JBQWdCakIsS0FBS2dCLEtBQUssQ0FBQ0QsZ0JBQWdCO0lBQ2pELE1BQU1HLFlBQVlILGdCQUFnQjtJQUVsQyxPQUFPO1FBQ0x4QyxJQUFJMEMsZ0JBQWlCQyxDQUFBQSxZQUFZLElBQUksSUFBSTtRQUN6QzFDLElBQUl5QyxnQkFBaUJDLENBQUFBLFlBQVksSUFBSSxJQUFJO1FBQ3pDekMsSUFBSXdDLGdCQUFpQkMsQ0FBQUEsWUFBWSxJQUFJLElBQUk7UUFDekN4QyxJQUFJdUM7SUFDTjtBQUNGO0FBRUE7OztDQUdDLEdBQ00sU0FBU0U7SUFDZCxPQUFPLGlCQUFpQixnQkFBZ0I7QUFDMUM7QUFFQTs7O0NBR0MsR0FDTSxTQUFTQztJQUNkLE9BQU8sb0JBQW9CLGdCQUFnQjtBQUM3QyIsInNvdXJjZXMiOlsid2VicGFjazovL3RoZWdhbWUtYWRtaW4vLi93b3JrZmxvd3MvcG9pbnRzLXJld2FyZHMtdXRpbHMudHM/MDQ1ZiJdLCJzb3VyY2VzQ29udGVudCI6WyIvLyB0aGVnYW1lL3dvcmtmbG93cy9wb2ludHMtcmV3YXJkcy11dGlscy50c1xyXG5pbXBvcnQgdHlwZSB7IFBsYXllciwgQ2hhcmFjdGVyLCBSZXdhcmRzIH0gZnJvbSAnQC90eXBlcy9lbnRpdGllcyc7XHJcbmltcG9ydCB7IENsaWVudEFQSSB9IGZyb20gJ0AvbGliL2NsaWVudC1hcGknO1xyXG5pbXBvcnQgeyBtYWtlTGluayB9IGZyb20gJ0AvbGlua3MvbGlua3Mtd29ya2Zsb3dzJztcclxuaW1wb3J0IHsgY3JlYXRlTGluayB9IGZyb20gJ0AvbGlua3MvbGluay1yZWdpc3RyeSc7XHJcbmltcG9ydCB7IExpbmtUeXBlLCBFbnRpdHlUeXBlIH0gZnJvbSAnQC90eXBlcy9lbnVtcyc7XHJcblxyXG4vKipcclxuICogQXdhcmRzIHBvaW50cyB0byBhIHBsYXllciB3aXRoIGlkZW1wb3RlbmN5IGFuZCBwcm9wZXIgdHJhY2tpbmdcclxuICogQHBhcmFtIHBsYXllcklkIC0gSUQgb2YgdGhlIHBsYXllciB0byBhd2FyZCBwb2ludHMgdG9cclxuICogQHBhcmFtIHBvaW50cyAtIFBvaW50cyB0byBhd2FyZCAoWFAsIFJQLCBGUCwgSFApXHJcbiAqIEBwYXJhbSBzb3VyY2VJZCAtIElEIG9mIHRoZSBlbnRpdHkgdGhhdCB0cmlnZ2VyZWQgdGhlIGF3YXJkXHJcbiAqIEBwYXJhbSBzb3VyY2VUeXBlIC0gVHlwZSBvZiBlbnRpdHkgKHRhc2ssIGZpbmFuY2lhbCwgc2FsZSlcclxuICovXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBhd2FyZFBvaW50c1RvUGxheWVyKFxyXG4gIHBsYXllcklkOiBzdHJpbmcsIFxyXG4gIHBvaW50czogUmV3YXJkc1sncG9pbnRzJ10sIFxyXG4gIHNvdXJjZUlkOiBzdHJpbmcsIFxyXG4gIHNvdXJjZVR5cGU6IHN0cmluZ1xyXG4pOiBQcm9taXNlPHZvaWQ+IHtcclxuICB0cnkge1xyXG4gICAgY29uc29sZS5sb2coYFthd2FyZFBvaW50c1RvUGxheWVyXSBBd2FyZGluZyBwb2ludHMgdG8gcGxheWVyICR7cGxheWVySWR9IGZyb20gJHtzb3VyY2VUeXBlfSAke3NvdXJjZUlkfWApO1xyXG4gICAgXHJcbiAgICAvLyBHZXQgdGhlIHBsYXllclxyXG4gICAgY29uc3QgcGxheWVycyA9IGF3YWl0IENsaWVudEFQSS5nZXRQbGF5ZXJzKCk7XHJcbiAgICBjb25zdCBwbGF5ZXIgPSBwbGF5ZXJzLmZpbmQocCA9PiBwLmlkID09PSBwbGF5ZXJJZCk7XHJcbiAgICBpZiAoIXBsYXllcikge1xyXG4gICAgICBjb25zb2xlLmxvZyhgW2F3YXJkUG9pbnRzVG9QbGF5ZXJdIFBsYXllciAke3BsYXllcklkfSBub3QgZm91bmQsIHNraXBwaW5nYCk7XHJcbiAgICAgIHJldHVybjtcclxuICAgIH1cclxuXHJcbiAgICAvLyBDaGVjayBpZiBhbnkgcG9pbnRzIHRvIGF3YXJkXHJcbiAgICBjb25zdCBoYXNQb2ludHMgPSAocG9pbnRzLnhwIHx8IDApID4gMCB8fCAocG9pbnRzLnJwIHx8IDApID4gMCB8fCBcclxuICAgICAgICAgICAgICAgICAgICAgKHBvaW50cy5mcCB8fCAwKSA+IDAgfHwgKHBvaW50cy5ocCB8fCAwKSA+IDA7XHJcbiAgICBcclxuICAgIGlmICghaGFzUG9pbnRzKSB7XHJcbiAgICAgIGNvbnNvbGUubG9nKGBbYXdhcmRQb2ludHNUb1BsYXllcl0gTm8gcG9pbnRzIHRvIGF3YXJkLCBza2lwcGluZ2ApO1xyXG4gICAgICByZXR1cm47XHJcbiAgICB9XHJcblxyXG4gICAgLy8gVXBkYXRlIHBsYXllciBwb2ludHNcclxuICAgIGNvbnN0IHVwZGF0ZWRQbGF5ZXI6IFBsYXllciA9IHtcclxuICAgICAgLi4ucGxheWVyLFxyXG4gICAgICBwb2ludHM6IHtcclxuICAgICAgICB4cDogKHBsYXllci5wb2ludHM/LnhwIHx8IDApICsgKHBvaW50cy54cCB8fCAwKSxcclxuICAgICAgICBycDogKHBsYXllci5wb2ludHM/LnJwIHx8IDApICsgKHBvaW50cy5ycCB8fCAwKSxcclxuICAgICAgICBmcDogKHBsYXllci5wb2ludHM/LmZwIHx8IDApICsgKHBvaW50cy5mcCB8fCAwKSxcclxuICAgICAgICBocDogKHBsYXllci5wb2ludHM/LmhwIHx8IDApICsgKHBvaW50cy5ocCB8fCAwKVxyXG4gICAgICB9LFxyXG4gICAgICB0b3RhbFBvaW50czoge1xyXG4gICAgICAgIHhwOiAocGxheWVyLnRvdGFsUG9pbnRzPy54cCB8fCAwKSArIChwb2ludHMueHAgfHwgMCksXHJcbiAgICAgICAgcnA6IChwbGF5ZXIudG90YWxQb2ludHM/LnJwIHx8IDApICsgKHBvaW50cy5ycCB8fCAwKSxcclxuICAgICAgICBmcDogKHBsYXllci50b3RhbFBvaW50cz8uZnAgfHwgMCkgKyAocG9pbnRzLmZwIHx8IDApLFxyXG4gICAgICAgIGhwOiAocGxheWVyLnRvdGFsUG9pbnRzPy5ocCB8fCAwKSArIChwb2ludHMuaHAgfHwgMClcclxuICAgICAgfSxcclxuICAgICAgdXBkYXRlZEF0OiBuZXcgRGF0ZSgpXHJcbiAgICB9O1xyXG5cclxuICAgIC8vIFNhdmUgdXBkYXRlZCBwbGF5ZXJcclxuICAgIGF3YWl0IENsaWVudEFQSS51cHNlcnRQbGF5ZXIodXBkYXRlZFBsYXllcik7XHJcbiAgICBjb25zb2xlLmxvZyhgW2F3YXJkUG9pbnRzVG9QbGF5ZXJdIOKchSBQb2ludHMgYXdhcmRlZCBzdWNjZXNzZnVsbHk6YCwgcG9pbnRzKTtcclxuXHJcbiAgICAvLyBDcmVhdGUgYXBwcm9wcmlhdGUgbGluayBiYXNlZCBvbiBzb3VyY2UgdHlwZSAtIHVzZSBmb3J3YXJkIGxpbmtzIChTT1VSQ0Ug4oaSIFBMQVlFUilcclxuICAgIGxldCBsaW5rVHlwZTogTGlua1R5cGU7XHJcbiAgICBsZXQgc291cmNlRW50aXR5VHlwZTogRW50aXR5VHlwZTtcclxuICAgIFxyXG4gICAgc3dpdGNoIChzb3VyY2VUeXBlKSB7XHJcbiAgICAgIGNhc2UgJ3Rhc2snOlxyXG4gICAgICAgIGxpbmtUeXBlID0gTGlua1R5cGUuVEFTS19QTEFZRVI7XHJcbiAgICAgICAgc291cmNlRW50aXR5VHlwZSA9IEVudGl0eVR5cGUuVEFTSztcclxuICAgICAgICBicmVhaztcclxuICAgICAgY2FzZSAnZmluYW5jaWFsJzpcclxuICAgICAgICBsaW5rVHlwZSA9IExpbmtUeXBlLkZJTlJFQ19QTEFZRVI7XHJcbiAgICAgICAgc291cmNlRW50aXR5VHlwZSA9IEVudGl0eVR5cGUuRklOQU5DSUFMO1xyXG4gICAgICAgIGJyZWFrO1xyXG4gICAgICBjYXNlICdzYWxlJzpcclxuICAgICAgICBsaW5rVHlwZSA9IExpbmtUeXBlLlNBTEVfUExBWUVSO1xyXG4gICAgICAgIHNvdXJjZUVudGl0eVR5cGUgPSBFbnRpdHlUeXBlLlNBTEU7XHJcbiAgICAgICAgYnJlYWs7XHJcbiAgICAgIGRlZmF1bHQ6XHJcbiAgICAgICAgY29uc29sZS53YXJuKGBbYXdhcmRQb2ludHNUb1BsYXllcl0gVW5rbm93biBzb3VyY2UgdHlwZTogJHtzb3VyY2VUeXBlfWApO1xyXG4gICAgICAgIHJldHVybjtcclxuICAgIH1cclxuXHJcbiAgICAvLyBDcmVhdGUgbGluayB3aXRoIHBvaW50cyBtZXRhZGF0YSAoZm9yd2FyZCBsaW5rOiBTT1VSQ0Ug4oaSIFBMQVlFUilcclxuICAgIGNvbnN0IGxpbmsgPSBtYWtlTGluayhcclxuICAgICAgbGlua1R5cGUsXHJcbiAgICAgIHsgdHlwZTogc291cmNlRW50aXR5VHlwZSwgaWQ6IHNvdXJjZUlkIH0sXHJcbiAgICAgIHsgdHlwZTogRW50aXR5VHlwZS5QTEFZRVIsIGlkOiBwbGF5ZXJJZCB9LFxyXG4gICAgICB7XHJcbiAgICAgICAgcG9pbnRzOiBwb2ludHMsXHJcbiAgICAgICAgc291cmNlVHlwZTogc291cmNlVHlwZSxcclxuICAgICAgICBhd2FyZGVkQXQ6IG5ldyBEYXRlKCkudG9JU09TdHJpbmcoKVxyXG4gICAgICB9XHJcbiAgICApO1xyXG5cclxuICAgIGF3YWl0IGNyZWF0ZUxpbmsobGluayk7XHJcbiAgICBjb25zb2xlLmxvZyhgW2F3YXJkUG9pbnRzVG9QbGF5ZXJdIOKchSBMaW5rIGNyZWF0ZWQ6ICR7bGlua1R5cGV9YCk7XHJcblxyXG4gIH0gY2F0Y2ggKGVycm9yKSB7XHJcbiAgICBjb25zb2xlLmVycm9yKGBbYXdhcmRQb2ludHNUb1BsYXllcl0g4p2MIEZhaWxlZCB0byBhd2FyZCBwb2ludHM6YCwgZXJyb3IpO1xyXG4gICAgdGhyb3cgZXJyb3I7XHJcbiAgfVxyXG59XHJcblxyXG4vKipcclxuICogUmVtb3ZlcyBwb2ludHMgZnJvbSBhIHBsYXllciAocm9sbGJhY2sgZnVuY3Rpb24pXHJcbiAqIEBwYXJhbSBwbGF5ZXJJZCAtIElEIG9mIHRoZSBwbGF5ZXIgdG8gcmVtb3ZlIHBvaW50cyBmcm9tXHJcbiAqIEBwYXJhbSBwb2ludHMgLSBQb2ludHMgdG8gcmVtb3ZlIChYUCwgUlAsIEZQLCBIUClcclxuICovXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiByZW1vdmVQb2ludHNGcm9tUGxheWVyKFxyXG4gIHBsYXllcklkOiBzdHJpbmcsIFxyXG4gIHBvaW50czogUmV3YXJkc1sncG9pbnRzJ11cclxuKTogUHJvbWlzZTx2b2lkPiB7XHJcbiAgdHJ5IHtcclxuICAgIGNvbnNvbGUubG9nKGBbcmVtb3ZlUG9pbnRzRnJvbVBsYXllcl0gUmVtb3ZpbmcgcG9pbnRzIGZyb20gcGxheWVyICR7cGxheWVySWR9YCk7XHJcbiAgICBcclxuICAgIC8vIEdldCB0aGUgcGxheWVyXHJcbiAgICBjb25zdCBwbGF5ZXJzID0gYXdhaXQgQ2xpZW50QVBJLmdldFBsYXllcnMoKTtcclxuICAgIGNvbnN0IHBsYXllciA9IHBsYXllcnMuZmluZChwID0+IHAuaWQgPT09IHBsYXllcklkKTtcclxuICAgIGlmICghcGxheWVyKSB7XHJcbiAgICAgIGNvbnNvbGUubG9nKGBbcmVtb3ZlUG9pbnRzRnJvbVBsYXllcl0gUGxheWVyICR7cGxheWVySWR9IG5vdCBmb3VuZCwgc2tpcHBpbmdgKTtcclxuICAgICAgcmV0dXJuO1xyXG4gICAgfVxyXG5cclxuICAgIC8vIENoZWNrIGlmIGFueSBwb2ludHMgdG8gcmVtb3ZlXHJcbiAgICBjb25zdCBoYXNQb2ludHMgPSAocG9pbnRzLnhwIHx8IDApID4gMCB8fCAocG9pbnRzLnJwIHx8IDApID4gMCB8fCBcclxuICAgICAgICAgICAgICAgICAgICAgKHBvaW50cy5mcCB8fCAwKSA+IDAgfHwgKHBvaW50cy5ocCB8fCAwKSA+IDA7XHJcbiAgICBcclxuICAgIGlmICghaGFzUG9pbnRzKSB7XHJcbiAgICAgIGNvbnNvbGUubG9nKGBbcmVtb3ZlUG9pbnRzRnJvbVBsYXllcl0gTm8gcG9pbnRzIHRvIHJlbW92ZSwgc2tpcHBpbmdgKTtcclxuICAgICAgcmV0dXJuO1xyXG4gICAgfVxyXG5cclxuICAgIC8vIFVwZGF0ZSBwbGF5ZXIgcG9pbnRzIChlbnN1cmUgdGhleSBkb24ndCBnbyBuZWdhdGl2ZSlcclxuICAgIGNvbnN0IHVwZGF0ZWRQbGF5ZXI6IFBsYXllciA9IHtcclxuICAgICAgLi4ucGxheWVyLFxyXG4gICAgICBwb2ludHM6IHtcclxuICAgICAgICB4cDogTWF0aC5tYXgoMCwgKHBsYXllci5wb2ludHM/LnhwIHx8IDApIC0gKHBvaW50cy54cCB8fCAwKSksXHJcbiAgICAgICAgcnA6IE1hdGgubWF4KDAsIChwbGF5ZXIucG9pbnRzPy5ycCB8fCAwKSAtIChwb2ludHMucnAgfHwgMCkpLFxyXG4gICAgICAgIGZwOiBNYXRoLm1heCgwLCAocGxheWVyLnBvaW50cz8uZnAgfHwgMCkgLSAocG9pbnRzLmZwIHx8IDApKSxcclxuICAgICAgICBocDogTWF0aC5tYXgoMCwgKHBsYXllci5wb2ludHM/LmhwIHx8IDApIC0gKHBvaW50cy5ocCB8fCAwKSlcclxuICAgICAgfSxcclxuICAgICAgLy8gTm90ZTogdG90YWxQb2ludHMgYXJlIE5PVCByZWR1Y2VkICh0aGV5IHRyYWNrIGxpZmV0aW1lIGVhcm5pbmdzKVxyXG4gICAgICB1cGRhdGVkQXQ6IG5ldyBEYXRlKClcclxuICAgIH07XHJcblxyXG4gICAgLy8gU2F2ZSB1cGRhdGVkIHBsYXllclxyXG4gICAgYXdhaXQgQ2xpZW50QVBJLnVwc2VydFBsYXllcih1cGRhdGVkUGxheWVyKTtcclxuICAgIGNvbnNvbGUubG9nKGBbcmVtb3ZlUG9pbnRzRnJvbVBsYXllcl0g4pyFIFBvaW50cyByZW1vdmVkIHN1Y2Nlc3NmdWxseTpgLCBwb2ludHMpO1xyXG5cclxuICB9IGNhdGNoIChlcnJvcikge1xyXG4gICAgY29uc29sZS5lcnJvcihgW3JlbW92ZVBvaW50c0Zyb21QbGF5ZXJdIOKdjCBGYWlsZWQgdG8gcmVtb3ZlIHBvaW50czpgLCBlcnJvcik7XHJcbiAgICB0aHJvdyBlcnJvcjtcclxuICB9XHJcbn1cclxuXHJcbi8qKlxyXG4gKiBBd2FyZHMganVuZ2xlIGNvaW5zIHRvIGEgY2hhcmFjdGVyXHJcbiAqIEBwYXJhbSBjaGFyYWN0ZXJJZCAtIElEIG9mIHRoZSBjaGFyYWN0ZXIgdG8gYXdhcmQganVuZ2xlIGNvaW5zIHRvXHJcbiAqIEBwYXJhbSBhbW91bnQgLSBBbW91bnQgb2YganVuZ2xlIGNvaW5zIHRvIGF3YXJkXHJcbiAqIEBwYXJhbSBzb3VyY2VJZCAtIElEIG9mIHRoZSBlbnRpdHkgdGhhdCB0cmlnZ2VyZWQgdGhlIGF3YXJkXHJcbiAqIEBwYXJhbSBzb3VyY2VUeXBlIC0gVHlwZSBvZiBlbnRpdHkgKHRhc2ssIGZpbmFuY2lhbCwgc2FsZSlcclxuICovXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBhd2FyZEp1bmdsZUNvaW5zVG9DaGFyYWN0ZXIoXHJcbiAgY2hhcmFjdGVySWQ6IHN0cmluZywgXHJcbiAgYW1vdW50OiBudW1iZXIsIFxyXG4gIHNvdXJjZUlkOiBzdHJpbmcsIFxyXG4gIHNvdXJjZVR5cGU6IHN0cmluZ1xyXG4pOiBQcm9taXNlPHZvaWQ+IHtcclxuICB0cnkge1xyXG4gICAgY29uc29sZS5sb2coYFthd2FyZEp1bmdsZUNvaW5zVG9DaGFyYWN0ZXJdIEF3YXJkaW5nICR7YW1vdW50fSBKJCB0byBjaGFyYWN0ZXIgJHtjaGFyYWN0ZXJJZH0gZnJvbSAke3NvdXJjZVR5cGV9ICR7c291cmNlSWR9YCk7XHJcbiAgICBcclxuICAgIGlmIChhbW91bnQgPD0gMCkge1xyXG4gICAgICBjb25zb2xlLmxvZyhgW2F3YXJkSnVuZ2xlQ29pbnNUb0NoYXJhY3Rlcl0gTm8ganVuZ2xlIGNvaW5zIHRvIGF3YXJkLCBza2lwcGluZ2ApO1xyXG4gICAgICByZXR1cm47XHJcbiAgICB9XHJcblxyXG4gICAgLy8gR2V0IHRoZSBjaGFyYWN0ZXJcclxuICAgIGNvbnN0IGNoYXJhY3RlcnMgPSBhd2FpdCBDbGllbnRBUEkuZ2V0Q2hhcmFjdGVycygpO1xyXG4gICAgY29uc3QgY2hhcmFjdGVyID0gY2hhcmFjdGVycy5maW5kKGMgPT4gYy5pZCA9PT0gY2hhcmFjdGVySWQpO1xyXG4gICAgaWYgKCFjaGFyYWN0ZXIpIHtcclxuICAgICAgY29uc29sZS5sb2coYFthd2FyZEp1bmdsZUNvaW5zVG9DaGFyYWN0ZXJdIENoYXJhY3RlciAke2NoYXJhY3RlcklkfSBub3QgZm91bmQsIHNraXBwaW5nYCk7XHJcbiAgICAgIHJldHVybjtcclxuICAgIH1cclxuXHJcbiAgICAvLyBVcGRhdGUgY2hhcmFjdGVyIGp1bmdsZSBjb2luc1xyXG4gICAgY29uc3QgdXBkYXRlZENoYXJhY3RlcjogQ2hhcmFjdGVyID0ge1xyXG4gICAgICAuLi5jaGFyYWN0ZXIsXHJcbiAgICAgIGp1bmdsZUNvaW5zOiAoY2hhcmFjdGVyLmp1bmdsZUNvaW5zIHx8IDApICsgYW1vdW50LFxyXG4gICAgICB1cGRhdGVkQXQ6IG5ldyBEYXRlKClcclxuICAgIH07XHJcblxyXG4gICAgLy8gU2F2ZSB1cGRhdGVkIGNoYXJhY3RlclxyXG4gICAgYXdhaXQgQ2xpZW50QVBJLnVwc2VydENoYXJhY3Rlcih1cGRhdGVkQ2hhcmFjdGVyKTtcclxuICAgIGNvbnNvbGUubG9nKGBbYXdhcmRKdW5nbGVDb2luc1RvQ2hhcmFjdGVyXSDinIUgSnVuZ2xlIGNvaW5zIGF3YXJkZWQgc3VjY2Vzc2Z1bGx5OiAke2Ftb3VudH0gSiRgKTtcclxuXHJcbiAgICAvLyBOT1RFOiBKJCAoSnVuZ2xlIENvaW5zKSBhcmUgQ1VSUkVOQ1kgdGhhdCBiZWxvbmdzIHRvIEZJTkFOQ0lBTFNcclxuICAgIC8vIFRoZXkgY2FuIGJlIGJvcnJvd2VkIGFzIEFNQkFTU0FET1IgYnkgUGxheWVyIGFuZCBDaGFyYWN0ZXIsIGJ1dCBkb24ndCBiZWxvbmcgdG8gdGhlbVxyXG4gICAgLy8gTm8gbGluayBjcmVhdGlvbiBuZWVkZWQgaGVyZSAtIEokIGFyZSBoYW5kbGVkIGJ5IHRoZSBGaW5hbmNpYWwgc3lzdGVtXHJcbiAgICBjb25zb2xlLmxvZyhgW2F3YXJkSnVuZ2xlQ29pbnNUb0NoYXJhY3Rlcl0g4pyFIEp1bmdsZSBjb2lucyBhd2FyZGVkIHRvIGNoYXJhY3RlciAoSiQgaGFuZGxlZCBieSBGaW5hbmNpYWwgc3lzdGVtKWApO1xyXG5cclxuICB9IGNhdGNoIChlcnJvcikge1xyXG4gICAgY29uc29sZS5lcnJvcihgW2F3YXJkSnVuZ2xlQ29pbnNUb0NoYXJhY3Rlcl0g4p2MIEZhaWxlZCB0byBhd2FyZCBqdW5nbGUgY29pbnM6YCwgZXJyb3IpO1xyXG4gICAgdGhyb3cgZXJyb3I7XHJcbiAgfVxyXG59XHJcblxyXG4vKipcclxuICogUmVtb3ZlcyBqdW5nbGUgY29pbnMgZnJvbSBhIGNoYXJhY3RlciAocm9sbGJhY2sgZnVuY3Rpb24pXHJcbiAqIEBwYXJhbSBjaGFyYWN0ZXJJZCAtIElEIG9mIHRoZSBjaGFyYWN0ZXIgdG8gcmVtb3ZlIGp1bmdsZSBjb2lucyBmcm9tXHJcbiAqIEBwYXJhbSBhbW91bnQgLSBBbW91bnQgb2YganVuZ2xlIGNvaW5zIHRvIHJlbW92ZVxyXG4gKi9cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIHJlbW92ZUp1bmdsZUNvaW5zRnJvbUNoYXJhY3RlcihcclxuICBjaGFyYWN0ZXJJZDogc3RyaW5nLCBcclxuICBhbW91bnQ6IG51bWJlclxyXG4pOiBQcm9taXNlPHZvaWQ+IHtcclxuICB0cnkge1xyXG4gICAgY29uc29sZS5sb2coYFtyZW1vdmVKdW5nbGVDb2luc0Zyb21DaGFyYWN0ZXJdIFJlbW92aW5nICR7YW1vdW50fSBKJCBmcm9tIGNoYXJhY3RlciAke2NoYXJhY3RlcklkfWApO1xyXG4gICAgXHJcbiAgICBpZiAoYW1vdW50IDw9IDApIHtcclxuICAgICAgY29uc29sZS5sb2coYFtyZW1vdmVKdW5nbGVDb2luc0Zyb21DaGFyYWN0ZXJdIE5vIGp1bmdsZSBjb2lucyB0byByZW1vdmUsIHNraXBwaW5nYCk7XHJcbiAgICAgIHJldHVybjtcclxuICAgIH1cclxuXHJcbiAgICAvLyBHZXQgdGhlIGNoYXJhY3RlclxyXG4gICAgY29uc3QgY2hhcmFjdGVycyA9IGF3YWl0IENsaWVudEFQSS5nZXRDaGFyYWN0ZXJzKCk7XHJcbiAgICBjb25zdCBjaGFyYWN0ZXIgPSBjaGFyYWN0ZXJzLmZpbmQoYyA9PiBjLmlkID09PSBjaGFyYWN0ZXJJZCk7XHJcbiAgICBpZiAoIWNoYXJhY3Rlcikge1xyXG4gICAgICBjb25zb2xlLmxvZyhgW3JlbW92ZUp1bmdsZUNvaW5zRnJvbUNoYXJhY3Rlcl0gQ2hhcmFjdGVyICR7Y2hhcmFjdGVySWR9IG5vdCBmb3VuZCwgc2tpcHBpbmdgKTtcclxuICAgICAgcmV0dXJuO1xyXG4gICAgfVxyXG5cclxuICAgIC8vIFVwZGF0ZSBjaGFyYWN0ZXIganVuZ2xlIGNvaW5zIChlbnN1cmUgdGhleSBkb24ndCBnbyBuZWdhdGl2ZSlcclxuICAgIGNvbnN0IHVwZGF0ZWRDaGFyYWN0ZXI6IENoYXJhY3RlciA9IHtcclxuICAgICAgLi4uY2hhcmFjdGVyLFxyXG4gICAgICBqdW5nbGVDb2luczogTWF0aC5tYXgoMCwgKGNoYXJhY3Rlci5qdW5nbGVDb2lucyB8fCAwKSAtIGFtb3VudCksXHJcbiAgICAgIHVwZGF0ZWRBdDogbmV3IERhdGUoKVxyXG4gICAgfTtcclxuXHJcbiAgICAvLyBTYXZlIHVwZGF0ZWQgY2hhcmFjdGVyXHJcbiAgICBhd2FpdCBDbGllbnRBUEkudXBzZXJ0Q2hhcmFjdGVyKHVwZGF0ZWRDaGFyYWN0ZXIpO1xyXG4gICAgY29uc29sZS5sb2coYFtyZW1vdmVKdW5nbGVDb2luc0Zyb21DaGFyYWN0ZXJdIOKchSBKdW5nbGUgY29pbnMgcmVtb3ZlZCBzdWNjZXNzZnVsbHk6ICR7YW1vdW50fSBKJGApO1xyXG5cclxuICB9IGNhdGNoIChlcnJvcikge1xyXG4gICAgY29uc29sZS5lcnJvcihgW3JlbW92ZUp1bmdsZUNvaW5zRnJvbUNoYXJhY3Rlcl0g4p2MIEZhaWxlZCB0byByZW1vdmUganVuZ2xlIGNvaW5zOmAsIGVycm9yKTtcclxuICAgIHRocm93IGVycm9yO1xyXG4gIH1cclxufVxyXG5cclxuLyoqXHJcbiAqIENhbGN1bGF0ZXMgcG9pbnRzIGZyb20gc2FsZSByZXZlbnVlICgxIFBvaW50ID0gJDEwMClcclxuICogQHBhcmFtIHJldmVudWUgLSBSZXZlbnVlIGFtb3VudCBpbiBkb2xsYXJzXHJcbiAqIEByZXR1cm5zIFBvaW50cyB0byBhd2FyZCAoZGlzdHJpYnV0ZWQgYWNyb3NzIGFsbCB0eXBlcylcclxuICovXHJcbmV4cG9ydCBmdW5jdGlvbiBjYWxjdWxhdGVQb2ludHNGcm9tUmV2ZW51ZShyZXZlbnVlOiBudW1iZXIpOiBSZXdhcmRzWydwb2ludHMnXSB7XHJcbiAgY29uc3QgcG9pbnRzQXdhcmRlZCA9IE1hdGguZmxvb3IocmV2ZW51ZSAvIDEwMCk7XHJcbiAgXHJcbiAgaWYgKHBvaW50c0F3YXJkZWQgPD0gMCkge1xyXG4gICAgcmV0dXJuIHsgeHA6IDAsIHJwOiAwLCBmcDogMCwgaHA6IDAgfTtcclxuICB9XHJcblxyXG4gIC8vIERpc3RyaWJ1dGUgcG9pbnRzIGFjcm9zcyBhbGwgdHlwZXMgZXF1YWxseVxyXG4gIGNvbnN0IHBvaW50c1BlclR5cGUgPSBNYXRoLmZsb29yKHBvaW50c0F3YXJkZWQgLyA0KTtcclxuICBjb25zdCByZW1haW5kZXIgPSBwb2ludHNBd2FyZGVkICUgNDtcclxuICBcclxuICByZXR1cm4ge1xyXG4gICAgeHA6IHBvaW50c1BlclR5cGUgKyAocmVtYWluZGVyID4gMCA/IDEgOiAwKSxcclxuICAgIHJwOiBwb2ludHNQZXJUeXBlICsgKHJlbWFpbmRlciA+IDEgPyAxIDogMCksXHJcbiAgICBmcDogcG9pbnRzUGVyVHlwZSArIChyZW1haW5kZXIgPiAyID8gMSA6IDApLFxyXG4gICAgaHA6IHBvaW50c1BlclR5cGVcclxuICB9O1xyXG59XHJcblxyXG4vKipcclxuICogR2V0cyB0aGUgbWFpbiBwbGF5ZXIgSUQgKFYwLjEgY29uc3RhbnQpXHJcbiAqIFRPRE86IFYwLjIgLSBVc2UgY2hhcmFjdGVyLnBsYXllcklkIGZpZWxkXHJcbiAqL1xyXG5leHBvcnQgZnVuY3Rpb24gZ2V0TWFpblBsYXllcklkKCk6IHN0cmluZyB7XHJcbiAgcmV0dXJuICdQTEFZRVJfT05FX0lEJzsgLy8gVjAuMSBjb25zdGFudFxyXG59XHJcblxyXG4vKipcclxuICogR2V0cyB0aGUgbWFpbiBjaGFyYWN0ZXIgSUQgKFYwLjEgY29uc3RhbnQpXHJcbiAqIFRPRE86IFYwLjIgLSBVc2UgcHJvcGVyIGNoYXJhY3RlciBzZWxlY3Rpb25cclxuICovXHJcbmV4cG9ydCBmdW5jdGlvbiBnZXRNYWluQ2hhcmFjdGVySWQoKTogc3RyaW5nIHtcclxuICByZXR1cm4gJ0NIQVJBQ1RFUl9PTkVfSUQnOyAvLyBWMC4xIGNvbnN0YW50XHJcbn1cclxuIl0sIm5hbWVzIjpbIkNsaWVudEFQSSIsIm1ha2VMaW5rIiwiY3JlYXRlTGluayIsIkxpbmtUeXBlIiwiRW50aXR5VHlwZSIsImF3YXJkUG9pbnRzVG9QbGF5ZXIiLCJwbGF5ZXJJZCIsInBvaW50cyIsInNvdXJjZUlkIiwic291cmNlVHlwZSIsImNvbnNvbGUiLCJsb2ciLCJwbGF5ZXJzIiwiZ2V0UGxheWVycyIsInBsYXllciIsImZpbmQiLCJwIiwiaWQiLCJoYXNQb2ludHMiLCJ4cCIsInJwIiwiZnAiLCJocCIsInVwZGF0ZWRQbGF5ZXIiLCJ0b3RhbFBvaW50cyIsInVwZGF0ZWRBdCIsIkRhdGUiLCJ1cHNlcnRQbGF5ZXIiLCJsaW5rVHlwZSIsInNvdXJjZUVudGl0eVR5cGUiLCJUQVNLX1BMQVlFUiIsIlRBU0siLCJGSU5SRUNfUExBWUVSIiwiRklOQU5DSUFMIiwiU0FMRV9QTEFZRVIiLCJTQUxFIiwid2FybiIsImxpbmsiLCJ0eXBlIiwiUExBWUVSIiwiYXdhcmRlZEF0IiwidG9JU09TdHJpbmciLCJlcnJvciIsInJlbW92ZVBvaW50c0Zyb21QbGF5ZXIiLCJNYXRoIiwibWF4IiwiYXdhcmRKdW5nbGVDb2luc1RvQ2hhcmFjdGVyIiwiY2hhcmFjdGVySWQiLCJhbW91bnQiLCJjaGFyYWN0ZXJzIiwiZ2V0Q2hhcmFjdGVycyIsImNoYXJhY3RlciIsImMiLCJ1cGRhdGVkQ2hhcmFjdGVyIiwianVuZ2xlQ29pbnMiLCJ1cHNlcnRDaGFyYWN0ZXIiLCJyZW1vdmVKdW5nbGVDb2luc0Zyb21DaGFyYWN0ZXIiLCJjYWxjdWxhdGVQb2ludHNGcm9tUmV2ZW51ZSIsInJldmVudWUiLCJwb2ludHNBd2FyZGVkIiwiZmxvb3IiLCJwb2ludHNQZXJUeXBlIiwicmVtYWluZGVyIiwiZ2V0TWFpblBsYXllcklkIiwiZ2V0TWFpbkNoYXJhY3RlcklkIl0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(rsc)/./workflows/points-rewards-utils.ts\n");

/***/ }),

/***/ "(rsc)/./workflows/sale-line-utils.ts":
/*!**************************************!*\
  !*** ./workflows/sale-line-utils.ts ***!
  \**************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   processBundleSaleLine: () => (/* binding */ processBundleSaleLine),\n/* harmony export */   processItemSaleLine: () => (/* binding */ processItemSaleLine),\n/* harmony export */   processSaleLines: () => (/* binding */ processSaleLines),\n/* harmony export */   processServiceLine: () => (/* binding */ processServiceLine)\n/* harmony export */ });\n/* harmony import */ var _types_enums__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @/types/enums */ \"(rsc)/./types/enums.ts\");\n/* harmony import */ var _lib_client_api__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @/lib/client-api */ \"(rsc)/./lib/client-api.ts\");\n/* harmony import */ var _links_links_workflows__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @/links/links-workflows */ \"(rsc)/./links/links-workflows.ts\");\n/* harmony import */ var _links_link_registry__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! @/links/link-registry */ \"(rsc)/./links/link-registry.ts\");\n/* harmony import */ var _data_store_effects_registry__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! @/data-store/effects-registry */ \"(rsc)/./data-store/effects-registry.ts\");\n/* harmony import */ var _entities_logging__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ./entities-logging */ \"(rsc)/./workflows/entities-logging.ts\");\n/* harmony import */ var _financial_record_utils__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ./financial-record-utils */ \"(rsc)/./workflows/financial-record-utils.ts\");\n// workflows/sale-line-utils.ts\n// Sale line processing utilities\n\n\n\n\n\n\n\n/**\r\n * Process all sale lines in a sale\r\n * Main dispatcher that processes each line based on its kind\r\n */ async function processSaleLines(sale) {\n    try {\n        console.log(`[processSaleLines] Processing ${sale.lines.length} lines for sale: ${sale.counterpartyName}`);\n        // Process each line based on its kind\n        for (const line of sale.lines){\n            console.log(`[processSaleLines] Processing line: ${line.kind}, lineId: ${line.lineId}`);\n            switch(line.kind){\n                case \"item\":\n                    await processItemSaleLine(line, sale);\n                    break;\n                case \"bundle\":\n                    await processBundleSaleLine(line, sale);\n                    break;\n                case \"service\":\n                    await processServiceLine(line, sale);\n                    break;\n                default:\n                    console.warn(`[processSaleLines] Unknown line kind: ${line.kind}`);\n            }\n        }\n        // Create financial record from sale if it has revenue\n        if (sale.totals.totalRevenue > 0) {\n            await (0,_financial_record_utils__WEBPACK_IMPORTED_MODULE_6__.createFinancialRecordFromSale)(sale);\n        }\n        console.log(`[processSaleLines] ✅ Processed all lines for sale: ${sale.counterpartyName}`);\n    } catch (error) {\n        console.error(`[processSaleLines] ❌ Failed to process sale lines for sale ${sale.id}:`, error);\n        throw error;\n    }\n}\n/**\r\n * Process item sale line - reduce item stock at specific site\r\n */ async function processItemSaleLine(line, sale) {\n    try {\n        console.log(`[processItemSaleLine] Processing item sale: ${line.itemId}, quantity: ${line.quantity}`);\n        // Idempotency check\n        const stockDecrementedKey = `sale:${sale.id}:stockDecremented:${line.lineId}`;\n        const hasBeenDecremented = await (0,_data_store_effects_registry__WEBPACK_IMPORTED_MODULE_4__.hasEffect)(stockDecrementedKey);\n        if (hasBeenDecremented) {\n            console.log(`[processItemSaleLine] Stock already decremented for line ${line.lineId}, skipping`);\n            return;\n        }\n        // Get the item\n        const items = await _lib_client_api__WEBPACK_IMPORTED_MODULE_1__.ClientAPI.getItems();\n        const item = items.find((i)=>i.id === line.itemId);\n        if (!item) {\n            console.error(`[processItemSaleLine] Item not found: ${line.itemId}`);\n            return;\n        }\n        // Check if we have enough stock at the sale site\n        // Calculate total available quantity from stock array\n        const totalAvailableQuantity = item.stock.reduce((sum, stockPoint)=>sum + stockPoint.quantity, 0);\n        if (item.quantitySold + line.quantity > totalAvailableQuantity) {\n            console.error(`[processItemSaleLine] Insufficient stock for item ${item.name}. Available: ${totalAvailableQuantity - item.quantitySold}, Required: ${line.quantity}`);\n            return;\n        }\n        // Update item stock\n        const updatedItem = {\n            ...item,\n            quantitySold: item.quantitySold + line.quantity,\n            updatedAt: new Date()\n        };\n        // Mark item as SOLD if all stock is sold\n        if (updatedItem.quantitySold >= totalAvailableQuantity) {\n            updatedItem.status = \"SOLD\";\n        }\n        // Save the updated item\n        await _lib_client_api__WEBPACK_IMPORTED_MODULE_1__.ClientAPI.upsertItem(updatedItem);\n        // Create SALE_ITEM link\n        const linkMetadata = {\n            quantity: line.quantity,\n            unitPrice: line.unitPrice,\n            total: line.quantity * line.unitPrice,\n            soldAt: sale.saleDate.toISOString(),\n            siteId: sale.siteId\n        };\n        const link = (0,_links_links_workflows__WEBPACK_IMPORTED_MODULE_2__.makeLink)(_types_enums__WEBPACK_IMPORTED_MODULE_0__.LinkType.SALE_ITEM, {\n            type: _types_enums__WEBPACK_IMPORTED_MODULE_0__.EntityType.SALE,\n            id: sale.id\n        }, {\n            type: _types_enums__WEBPACK_IMPORTED_MODULE_0__.EntityType.ITEM,\n            id: line.itemId\n        }, linkMetadata);\n        await (0,_links_link_registry__WEBPACK_IMPORTED_MODULE_3__.createLink)(link);\n        // Mark effect as complete\n        await (0,_data_store_effects_registry__WEBPACK_IMPORTED_MODULE_4__.markEffect)(`sale:${sale.id}:${stockDecrementedKey}`);\n        // Log the effect\n        await (0,_entities_logging__WEBPACK_IMPORTED_MODULE_5__.appendEntityLog)(\"item\", line.itemId, \"SOLD\", {\n            name: item.name,\n            quantity: line.quantity,\n            unitPrice: line.unitPrice,\n            total: line.quantity * line.unitPrice,\n            saleId: sale.id,\n            soldAt: sale.saleDate.toISOString()\n        });\n        console.log(`[processItemSaleLine] ✅ Processed item sale: ${item.name} x${line.quantity}`);\n    } catch (error) {\n        console.error(`[processItemSaleLine] ❌ Failed to process item sale line ${line.lineId}:`, error);\n        throw error;\n    }\n}\n/**\r\n * Process bundle sale line - reduce bundle stock\r\n * TODO: Implement bundle processing logic\r\n */ async function processBundleSaleLine(line, sale) {\n    try {\n        console.log(`[processBundleSaleLine] Processing bundle sale: ${line.itemType}, quantity: ${line.quantity}`);\n        // Idempotency check\n        const bundleProcessedKey = `sale:${sale.id}:bundleProcessed:${line.lineId}`;\n        const hasBeenProcessed = await (0,_data_store_effects_registry__WEBPACK_IMPORTED_MODULE_4__.hasEffect)(bundleProcessedKey);\n        if (hasBeenProcessed) {\n            console.log(`[processBundleSaleLine] Bundle already processed for line ${line.lineId}, skipping`);\n            return;\n        }\n        // TODO: Implement bundle processing logic\n        // This would involve:\n        // 1. Finding bundle items of the specified type\n        // 2. Reducing their stock\n        // 3. Creating SALE_ITEM links\n        // 4. Handling itemsPerBundle logic\n        console.log(`[processBundleSaleLine] Bundle processing not yet implemented for ${line.itemType}`);\n        // Mark effect as complete (even though not implemented)\n        await (0,_data_store_effects_registry__WEBPACK_IMPORTED_MODULE_4__.markEffect)(`sale:${sale.id}:${bundleProcessedKey}`);\n    } catch (error) {\n        console.error(`[processBundleSaleLine] ❌ Failed to process bundle sale line ${line.lineId}:`, error);\n        throw error;\n    }\n}\n/**\r\n * Process service sale line - create task from service\r\n */ async function processServiceLine(line, sale) {\n    try {\n        console.log(`[processServiceLine] Processing service sale: ${line.description}`);\n        // Idempotency check\n        const taskCreatedKey = `sale:${sale.id}:taskCreated:${line.lineId}`;\n        const hasBeenCreated = await (0,_data_store_effects_registry__WEBPACK_IMPORTED_MODULE_4__.hasEffect)(taskCreatedKey);\n        if (hasBeenCreated || !line.createTask) {\n            console.log(`[processServiceLine] Task already created or not requested for line ${line.lineId}, skipping`);\n            return;\n        }\n        // Create task from service line\n        const serviceTask = {\n            id: line.taskId || `task-${sale.id}-${line.lineId}`,\n            name: line.description || \"Service Task\",\n            description: `Service from sale: ${sale.counterpartyName}`,\n            type: line.taskType || \"TASK\",\n            status: \"Created\",\n            priority: \"Normal\",\n            station: line.station,\n            progress: 0,\n            order: Date.now(),\n            cost: line.taskCost || 0,\n            revenue: 0,\n            rewards: line.taskRewards ? {\n                points: line.taskRewards\n            } : {\n                points: {\n                    xp: 0,\n                    rp: 0,\n                    fp: 0,\n                    hp: 0\n                }\n            },\n            isCollected: false,\n            createdAt: new Date(),\n            updatedAt: new Date(),\n            links: [],\n            // Ambassador Fields - inherit from sale\n            siteId: sale.siteId,\n            targetSiteId: line.taskTargetSiteId || undefined,\n            sourceSaleId: sale.id,\n            // Additional fields from service line\n            parentId: line.taskParentId || undefined,\n            dueDate: line.taskDueDate || undefined,\n            // Emissary fields for item creation\n            outputItemType: line.outputItemType || undefined,\n            outputItemSubType: line.outputItemSubType || undefined,\n            outputQuantity: line.outputItemQuantity || undefined,\n            outputItemName: line.outputItemName || undefined,\n            outputUnitCost: line.outputUnitCost || undefined,\n            outputItemCollection: line.outputItemCollection || undefined,\n            outputItemPrice: line.outputItemPrice || undefined,\n            isNewItem: line.isNewOutputItem || false,\n            isSold: line.isSold || false,\n            outputItemStatus: \"Created\"\n        };\n        // Save the task\n        await _lib_client_api__WEBPACK_IMPORTED_MODULE_1__.ClientAPI.upsertTask(serviceTask);\n        // Create SALE_TASK link\n        const linkMetadata = {\n            serviceDescription: line.description,\n            revenue: line.revenue,\n            station: line.station,\n            taskType: line.taskType,\n            createdFrom: \"service_sale\"\n        };\n        const link = (0,_links_links_workflows__WEBPACK_IMPORTED_MODULE_2__.makeLink)(_types_enums__WEBPACK_IMPORTED_MODULE_0__.LinkType.SALE_TASK, {\n            type: _types_enums__WEBPACK_IMPORTED_MODULE_0__.EntityType.SALE,\n            id: sale.id\n        }, {\n            type: _types_enums__WEBPACK_IMPORTED_MODULE_0__.EntityType.TASK,\n            id: serviceTask.id\n        }, linkMetadata);\n        await (0,_links_link_registry__WEBPACK_IMPORTED_MODULE_3__.createLink)(link);\n        // Mark effect as complete\n        await (0,_data_store_effects_registry__WEBPACK_IMPORTED_MODULE_4__.markEffect)(`sale:${sale.id}:${taskCreatedKey}`);\n        // Log the task creation\n        await (0,_entities_logging__WEBPACK_IMPORTED_MODULE_5__.appendEntityLog)(\"task\", serviceTask.id, \"CREATED\", {\n            name: serviceTask.name,\n            createdFrom: \"service_sale\",\n            saleId: sale.id,\n            serviceDescription: line.description,\n            station: line.station\n        });\n        console.log(`[processServiceLine] ✅ Created task from service: ${serviceTask.name}`);\n    } catch (error) {\n        console.error(`[processServiceLine] ❌ Failed to process service sale line ${line.lineId}:`, error);\n        throw error;\n    }\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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RCxLQUFLOEQsT0FBTztZQUNyQk4sU0FBU3hELEtBQUt3RCxPQUFPO1lBQ3JCRixVQUFVdEQsS0FBS3NELFFBQVE7WUFDdkJ5QyxhQUFhO1FBQ2Y7UUFFQSxNQUFNeEQsT0FBT3BELGdFQUFRQSxDQUNuQkgsa0RBQVFBLENBQUNnSCxTQUFTLEVBQ2xCO1lBQUV2RCxNQUFNeEQsb0RBQVVBLENBQUN5RCxJQUFJO1lBQUVoQyxJQUFJaEIsS0FBS2dCLEVBQUU7UUFBQyxHQUNyQztZQUFFK0IsTUFBTXhELG9EQUFVQSxDQUFDZ0gsSUFBSTtZQUFFdkYsSUFBSTBDLFlBQVkxQyxFQUFFO1FBQUMsR0FDNUNzQjtRQUVGLE1BQU01QyxnRUFBVUEsQ0FBQ21EO1FBRWpCLDBCQUEwQjtRQUMxQixNQUFNakQsd0VBQVVBLENBQUMsQ0FBQyxLQUFLLEVBQUVJLEtBQUtnQixFQUFFLENBQUMsQ0FBQyxFQUFFdUMsZUFBZSxDQUFDO1FBRXBELHdCQUF3QjtRQUN4QixNQUFNMUQsa0VBQWVBLENBQUMsUUFBUTZELFlBQVkxQyxFQUFFLEVBQUUsV0FBVztZQUN2RGdCLE1BQU0wQixZQUFZMUIsSUFBSTtZQUN0QnFFLGFBQWE7WUFDYm5ELFFBQVFsRCxLQUFLZ0IsRUFBRTtZQUNmb0Ysb0JBQW9COUYsS0FBS2dELFdBQVc7WUFDcENRLFNBQVN4RCxLQUFLd0QsT0FBTztRQUN2QjtRQUVBN0QsUUFBUUMsR0FBRyxDQUFDLENBQUMsa0RBQWtELEVBQUV3RCxZQUFZMUIsSUFBSSxDQUFDLENBQUM7SUFFckYsRUFBRSxPQUFPakIsT0FBTztRQUNkZCxRQUFRYyxLQUFLLENBQUMsQ0FBQywyREFBMkQsRUFBRVQsS0FBS0UsTUFBTSxDQUFDLENBQUMsQ0FBQyxFQUFFTztRQUM1RixNQUFNQTtJQUNSO0FBQ0YiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly90aGVnYW1lLWFkbWluLy4vd29ya2Zsb3dzL3NhbGUtbGluZS11dGlscy50cz9jNTBiIl0sInNvdXJjZXNDb250ZW50IjpbIi8vIHdvcmtmbG93cy9zYWxlLWxpbmUtdXRpbHMudHNcclxuLy8gU2FsZSBsaW5lIHByb2Nlc3NpbmcgdXRpbGl0aWVzXHJcblxyXG5pbXBvcnQgdHlwZSB7IFNhbGUsIEl0ZW1TYWxlTGluZSwgQnVuZGxlU2FsZUxpbmUsIFNlcnZpY2VMaW5lLCBUYXNrIH0gZnJvbSAnQC90eXBlcy9lbnRpdGllcyc7XHJcbmltcG9ydCB7IExpbmtUeXBlLCBFbnRpdHlUeXBlIH0gZnJvbSAnQC90eXBlcy9lbnVtcyc7XHJcbmltcG9ydCB7IENsaWVudEFQSSB9IGZyb20gJ0AvbGliL2NsaWVudC1hcGknO1xyXG5pbXBvcnQgeyBtYWtlTGluayB9IGZyb20gJ0AvbGlua3MvbGlua3Mtd29ya2Zsb3dzJztcclxuaW1wb3J0IHsgY3JlYXRlTGluayB9IGZyb20gJ0AvbGlua3MvbGluay1yZWdpc3RyeSc7XHJcbmltcG9ydCB7IGhhc0VmZmVjdCwgbWFya0VmZmVjdCB9IGZyb20gJ0AvZGF0YS1zdG9yZS9lZmZlY3RzLXJlZ2lzdHJ5JztcclxuaW1wb3J0IHsgYXBwZW5kRW50aXR5TG9nIH0gZnJvbSAnLi9lbnRpdGllcy1sb2dnaW5nJztcclxuaW1wb3J0IHsgY3JlYXRlRmluYW5jaWFsUmVjb3JkRnJvbVNhbGUgfSBmcm9tICcuL2ZpbmFuY2lhbC1yZWNvcmQtdXRpbHMnO1xyXG5cclxuLyoqXHJcbiAqIFByb2Nlc3MgYWxsIHNhbGUgbGluZXMgaW4gYSBzYWxlXHJcbiAqIE1haW4gZGlzcGF0Y2hlciB0aGF0IHByb2Nlc3NlcyBlYWNoIGxpbmUgYmFzZWQgb24gaXRzIGtpbmRcclxuICovXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBwcm9jZXNzU2FsZUxpbmVzKHNhbGU6IFNhbGUpOiBQcm9taXNlPHZvaWQ+IHtcclxuICB0cnkge1xyXG4gICAgY29uc29sZS5sb2coYFtwcm9jZXNzU2FsZUxpbmVzXSBQcm9jZXNzaW5nICR7c2FsZS5saW5lcy5sZW5ndGh9IGxpbmVzIGZvciBzYWxlOiAke3NhbGUuY291bnRlcnBhcnR5TmFtZX1gKTtcclxuICAgIFxyXG4gICAgLy8gUHJvY2VzcyBlYWNoIGxpbmUgYmFzZWQgb24gaXRzIGtpbmRcclxuICAgIGZvciAoY29uc3QgbGluZSBvZiBzYWxlLmxpbmVzKSB7XHJcbiAgICAgIGNvbnNvbGUubG9nKGBbcHJvY2Vzc1NhbGVMaW5lc10gUHJvY2Vzc2luZyBsaW5lOiAke2xpbmUua2luZH0sIGxpbmVJZDogJHtsaW5lLmxpbmVJZH1gKTtcclxuICAgICAgXHJcbiAgICAgIHN3aXRjaCAobGluZS5raW5kKSB7XHJcbiAgICAgICAgY2FzZSAnaXRlbSc6XHJcbiAgICAgICAgICBhd2FpdCBwcm9jZXNzSXRlbVNhbGVMaW5lKGxpbmUgYXMgSXRlbVNhbGVMaW5lLCBzYWxlKTtcclxuICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgIGNhc2UgJ2J1bmRsZSc6XHJcbiAgICAgICAgICBhd2FpdCBwcm9jZXNzQnVuZGxlU2FsZUxpbmUobGluZSBhcyBCdW5kbGVTYWxlTGluZSwgc2FsZSk7XHJcbiAgICAgICAgICBicmVhaztcclxuICAgICAgICBjYXNlICdzZXJ2aWNlJzpcclxuICAgICAgICAgIGF3YWl0IHByb2Nlc3NTZXJ2aWNlTGluZShsaW5lIGFzIFNlcnZpY2VMaW5lLCBzYWxlKTtcclxuICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgIGRlZmF1bHQ6XHJcbiAgICAgICAgICBjb25zb2xlLndhcm4oYFtwcm9jZXNzU2FsZUxpbmVzXSBVbmtub3duIGxpbmUga2luZDogJHsobGluZSBhcyBhbnkpLmtpbmR9YCk7XHJcbiAgICAgIH1cclxuICAgIH1cclxuICAgIFxyXG4gICAgLy8gQ3JlYXRlIGZpbmFuY2lhbCByZWNvcmQgZnJvbSBzYWxlIGlmIGl0IGhhcyByZXZlbnVlXHJcbiAgICBpZiAoc2FsZS50b3RhbHMudG90YWxSZXZlbnVlID4gMCkge1xyXG4gICAgICBhd2FpdCBjcmVhdGVGaW5hbmNpYWxSZWNvcmRGcm9tU2FsZShzYWxlKTtcclxuICAgIH1cclxuICAgIFxyXG4gICAgY29uc29sZS5sb2coYFtwcm9jZXNzU2FsZUxpbmVzXSDinIUgUHJvY2Vzc2VkIGFsbCBsaW5lcyBmb3Igc2FsZTogJHtzYWxlLmNvdW50ZXJwYXJ0eU5hbWV9YCk7XHJcbiAgICBcclxuICB9IGNhdGNoIChlcnJvcikge1xyXG4gICAgY29uc29sZS5lcnJvcihgW3Byb2Nlc3NTYWxlTGluZXNdIOKdjCBGYWlsZWQgdG8gcHJvY2VzcyBzYWxlIGxpbmVzIGZvciBzYWxlICR7c2FsZS5pZH06YCwgZXJyb3IpO1xyXG4gICAgdGhyb3cgZXJyb3I7XHJcbiAgfVxyXG59XHJcblxyXG4vKipcclxuICogUHJvY2VzcyBpdGVtIHNhbGUgbGluZSAtIHJlZHVjZSBpdGVtIHN0b2NrIGF0IHNwZWNpZmljIHNpdGVcclxuICovXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBwcm9jZXNzSXRlbVNhbGVMaW5lKGxpbmU6IEl0ZW1TYWxlTGluZSwgc2FsZTogU2FsZSk6IFByb21pc2U8dm9pZD4ge1xyXG4gIHRyeSB7XHJcbiAgICBjb25zb2xlLmxvZyhgW3Byb2Nlc3NJdGVtU2FsZUxpbmVdIFByb2Nlc3NpbmcgaXRlbSBzYWxlOiAke2xpbmUuaXRlbUlkfSwgcXVhbnRpdHk6ICR7bGluZS5xdWFudGl0eX1gKTtcclxuICAgIFxyXG4gICAgLy8gSWRlbXBvdGVuY3kgY2hlY2tcclxuICAgIGNvbnN0IHN0b2NrRGVjcmVtZW50ZWRLZXkgPSBgc2FsZToke3NhbGUuaWR9OnN0b2NrRGVjcmVtZW50ZWQ6JHtsaW5lLmxpbmVJZH1gO1xyXG4gICAgY29uc3QgaGFzQmVlbkRlY3JlbWVudGVkID0gYXdhaXQgaGFzRWZmZWN0KHN0b2NrRGVjcmVtZW50ZWRLZXkpO1xyXG4gICAgXHJcbiAgICBpZiAoaGFzQmVlbkRlY3JlbWVudGVkKSB7XHJcbiAgICAgIGNvbnNvbGUubG9nKGBbcHJvY2Vzc0l0ZW1TYWxlTGluZV0gU3RvY2sgYWxyZWFkeSBkZWNyZW1lbnRlZCBmb3IgbGluZSAke2xpbmUubGluZUlkfSwgc2tpcHBpbmdgKTtcclxuICAgICAgcmV0dXJuO1xyXG4gICAgfVxyXG4gICAgXHJcbiAgICAvLyBHZXQgdGhlIGl0ZW1cclxuICAgIGNvbnN0IGl0ZW1zID0gYXdhaXQgQ2xpZW50QVBJLmdldEl0ZW1zKCk7XHJcbiAgICBjb25zdCBpdGVtID0gaXRlbXMuZmluZChpID0+IGkuaWQgPT09IGxpbmUuaXRlbUlkKTtcclxuICAgIFxyXG4gICAgaWYgKCFpdGVtKSB7XHJcbiAgICAgIGNvbnNvbGUuZXJyb3IoYFtwcm9jZXNzSXRlbVNhbGVMaW5lXSBJdGVtIG5vdCBmb3VuZDogJHtsaW5lLml0ZW1JZH1gKTtcclxuICAgICAgcmV0dXJuO1xyXG4gICAgfVxyXG4gICAgXHJcbiAgICAvLyBDaGVjayBpZiB3ZSBoYXZlIGVub3VnaCBzdG9jayBhdCB0aGUgc2FsZSBzaXRlXHJcbiAgICAvLyBDYWxjdWxhdGUgdG90YWwgYXZhaWxhYmxlIHF1YW50aXR5IGZyb20gc3RvY2sgYXJyYXlcclxuICAgIGNvbnN0IHRvdGFsQXZhaWxhYmxlUXVhbnRpdHkgPSBpdGVtLnN0b2NrLnJlZHVjZSgoc3VtLCBzdG9ja1BvaW50KSA9PiBzdW0gKyBzdG9ja1BvaW50LnF1YW50aXR5LCAwKTtcclxuICAgIGlmIChpdGVtLnF1YW50aXR5U29sZCArIGxpbmUucXVhbnRpdHkgPiB0b3RhbEF2YWlsYWJsZVF1YW50aXR5KSB7XHJcbiAgICAgIGNvbnNvbGUuZXJyb3IoYFtwcm9jZXNzSXRlbVNhbGVMaW5lXSBJbnN1ZmZpY2llbnQgc3RvY2sgZm9yIGl0ZW0gJHtpdGVtLm5hbWV9LiBBdmFpbGFibGU6ICR7dG90YWxBdmFpbGFibGVRdWFudGl0eSAtIGl0ZW0ucXVhbnRpdHlTb2xkfSwgUmVxdWlyZWQ6ICR7bGluZS5xdWFudGl0eX1gKTtcclxuICAgICAgcmV0dXJuO1xyXG4gICAgfVxyXG4gICAgXHJcbiAgICAvLyBVcGRhdGUgaXRlbSBzdG9ja1xyXG4gICAgY29uc3QgdXBkYXRlZEl0ZW0gPSB7XHJcbiAgICAgIC4uLml0ZW0sXHJcbiAgICAgIHF1YW50aXR5U29sZDogaXRlbS5xdWFudGl0eVNvbGQgKyBsaW5lLnF1YW50aXR5LFxyXG4gICAgICB1cGRhdGVkQXQ6IG5ldyBEYXRlKClcclxuICAgIH07XHJcbiAgICBcclxuICAgIC8vIE1hcmsgaXRlbSBhcyBTT0xEIGlmIGFsbCBzdG9jayBpcyBzb2xkXHJcbiAgICBpZiAodXBkYXRlZEl0ZW0ucXVhbnRpdHlTb2xkID49IHRvdGFsQXZhaWxhYmxlUXVhbnRpdHkpIHtcclxuICAgICAgdXBkYXRlZEl0ZW0uc3RhdHVzID0gJ1NPTEQnIGFzIGFueTtcclxuICAgIH1cclxuICAgIFxyXG4gICAgLy8gU2F2ZSB0aGUgdXBkYXRlZCBpdGVtXHJcbiAgICBhd2FpdCBDbGllbnRBUEkudXBzZXJ0SXRlbSh1cGRhdGVkSXRlbSk7XHJcbiAgICBcclxuICAgIC8vIENyZWF0ZSBTQUxFX0lURU0gbGlua1xyXG4gICAgY29uc3QgbGlua01ldGFkYXRhID0ge1xyXG4gICAgICBxdWFudGl0eTogbGluZS5xdWFudGl0eSxcclxuICAgICAgdW5pdFByaWNlOiBsaW5lLnVuaXRQcmljZSxcclxuICAgICAgdG90YWw6IGxpbmUucXVhbnRpdHkgKiBsaW5lLnVuaXRQcmljZSxcclxuICAgICAgc29sZEF0OiBzYWxlLnNhbGVEYXRlLnRvSVNPU3RyaW5nKCksXHJcbiAgICAgIHNpdGVJZDogc2FsZS5zaXRlSWRcclxuICAgIH07XHJcbiAgICBcclxuICAgIGNvbnN0IGxpbmsgPSBtYWtlTGluayhcclxuICAgICAgTGlua1R5cGUuU0FMRV9JVEVNLFxyXG4gICAgICB7IHR5cGU6IEVudGl0eVR5cGUuU0FMRSwgaWQ6IHNhbGUuaWQgfSxcclxuICAgICAgeyB0eXBlOiBFbnRpdHlUeXBlLklURU0sIGlkOiBsaW5lLml0ZW1JZCB9LFxyXG4gICAgICBsaW5rTWV0YWRhdGFcclxuICAgICk7XHJcbiAgICBhd2FpdCBjcmVhdGVMaW5rKGxpbmspO1xyXG4gICAgXHJcbiAgICAvLyBNYXJrIGVmZmVjdCBhcyBjb21wbGV0ZVxyXG4gICAgYXdhaXQgbWFya0VmZmVjdChgc2FsZToke3NhbGUuaWR9OiR7c3RvY2tEZWNyZW1lbnRlZEtleX1gKTtcclxuICAgIFxyXG4gICAgLy8gTG9nIHRoZSBlZmZlY3RcclxuICAgIGF3YWl0IGFwcGVuZEVudGl0eUxvZygnaXRlbScsIGxpbmUuaXRlbUlkLCAnU09MRCcsIHtcclxuICAgICAgbmFtZTogaXRlbS5uYW1lLFxyXG4gICAgICBxdWFudGl0eTogbGluZS5xdWFudGl0eSxcclxuICAgICAgdW5pdFByaWNlOiBsaW5lLnVuaXRQcmljZSxcclxuICAgICAgdG90YWw6IGxpbmUucXVhbnRpdHkgKiBsaW5lLnVuaXRQcmljZSxcclxuICAgICAgc2FsZUlkOiBzYWxlLmlkLFxyXG4gICAgICBzb2xkQXQ6IHNhbGUuc2FsZURhdGUudG9JU09TdHJpbmcoKVxyXG4gICAgfSk7XHJcbiAgICBcclxuICAgIGNvbnNvbGUubG9nKGBbcHJvY2Vzc0l0ZW1TYWxlTGluZV0g4pyFIFByb2Nlc3NlZCBpdGVtIHNhbGU6ICR7aXRlbS5uYW1lfSB4JHtsaW5lLnF1YW50aXR5fWApO1xyXG4gICAgXHJcbiAgfSBjYXRjaCAoZXJyb3IpIHtcclxuICAgIGNvbnNvbGUuZXJyb3IoYFtwcm9jZXNzSXRlbVNhbGVMaW5lXSDinYwgRmFpbGVkIHRvIHByb2Nlc3MgaXRlbSBzYWxlIGxpbmUgJHtsaW5lLmxpbmVJZH06YCwgZXJyb3IpO1xyXG4gICAgdGhyb3cgZXJyb3I7XHJcbiAgfVxyXG59XHJcblxyXG4vKipcclxuICogUHJvY2VzcyBidW5kbGUgc2FsZSBsaW5lIC0gcmVkdWNlIGJ1bmRsZSBzdG9ja1xyXG4gKiBUT0RPOiBJbXBsZW1lbnQgYnVuZGxlIHByb2Nlc3NpbmcgbG9naWNcclxuICovXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBwcm9jZXNzQnVuZGxlU2FsZUxpbmUobGluZTogQnVuZGxlU2FsZUxpbmUsIHNhbGU6IFNhbGUpOiBQcm9taXNlPHZvaWQ+IHtcclxuICB0cnkge1xyXG4gICAgY29uc29sZS5sb2coYFtwcm9jZXNzQnVuZGxlU2FsZUxpbmVdIFByb2Nlc3NpbmcgYnVuZGxlIHNhbGU6ICR7bGluZS5pdGVtVHlwZX0sIHF1YW50aXR5OiAke2xpbmUucXVhbnRpdHl9YCk7XHJcbiAgICBcclxuICAgIC8vIElkZW1wb3RlbmN5IGNoZWNrXHJcbiAgICBjb25zdCBidW5kbGVQcm9jZXNzZWRLZXkgPSBgc2FsZToke3NhbGUuaWR9OmJ1bmRsZVByb2Nlc3NlZDoke2xpbmUubGluZUlkfWA7XHJcbiAgICBjb25zdCBoYXNCZWVuUHJvY2Vzc2VkID0gYXdhaXQgaGFzRWZmZWN0KGJ1bmRsZVByb2Nlc3NlZEtleSk7XHJcbiAgICBcclxuICAgIGlmIChoYXNCZWVuUHJvY2Vzc2VkKSB7XHJcbiAgICAgIGNvbnNvbGUubG9nKGBbcHJvY2Vzc0J1bmRsZVNhbGVMaW5lXSBCdW5kbGUgYWxyZWFkeSBwcm9jZXNzZWQgZm9yIGxpbmUgJHtsaW5lLmxpbmVJZH0sIHNraXBwaW5nYCk7XHJcbiAgICAgIHJldHVybjtcclxuICAgIH1cclxuICAgIFxyXG4gICAgLy8gVE9ETzogSW1wbGVtZW50IGJ1bmRsZSBwcm9jZXNzaW5nIGxvZ2ljXHJcbiAgICAvLyBUaGlzIHdvdWxkIGludm9sdmU6XHJcbiAgICAvLyAxLiBGaW5kaW5nIGJ1bmRsZSBpdGVtcyBvZiB0aGUgc3BlY2lmaWVkIHR5cGVcclxuICAgIC8vIDIuIFJlZHVjaW5nIHRoZWlyIHN0b2NrXHJcbiAgICAvLyAzLiBDcmVhdGluZyBTQUxFX0lURU0gbGlua3NcclxuICAgIC8vIDQuIEhhbmRsaW5nIGl0ZW1zUGVyQnVuZGxlIGxvZ2ljXHJcbiAgICBcclxuICAgIGNvbnNvbGUubG9nKGBbcHJvY2Vzc0J1bmRsZVNhbGVMaW5lXSBCdW5kbGUgcHJvY2Vzc2luZyBub3QgeWV0IGltcGxlbWVudGVkIGZvciAke2xpbmUuaXRlbVR5cGV9YCk7XHJcbiAgICBcclxuICAgIC8vIE1hcmsgZWZmZWN0IGFzIGNvbXBsZXRlIChldmVuIHRob3VnaCBub3QgaW1wbGVtZW50ZWQpXHJcbiAgICBhd2FpdCBtYXJrRWZmZWN0KGBzYWxlOiR7c2FsZS5pZH06JHtidW5kbGVQcm9jZXNzZWRLZXl9YCk7XHJcbiAgICBcclxuICB9IGNhdGNoIChlcnJvcikge1xyXG4gICAgY29uc29sZS5lcnJvcihgW3Byb2Nlc3NCdW5kbGVTYWxlTGluZV0g4p2MIEZhaWxlZCB0byBwcm9jZXNzIGJ1bmRsZSBzYWxlIGxpbmUgJHtsaW5lLmxpbmVJZH06YCwgZXJyb3IpO1xyXG4gICAgdGhyb3cgZXJyb3I7XHJcbiAgfVxyXG59XHJcblxyXG4vKipcclxuICogUHJvY2VzcyBzZXJ2aWNlIHNhbGUgbGluZSAtIGNyZWF0ZSB0YXNrIGZyb20gc2VydmljZVxyXG4gKi9cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIHByb2Nlc3NTZXJ2aWNlTGluZShsaW5lOiBTZXJ2aWNlTGluZSwgc2FsZTogU2FsZSk6IFByb21pc2U8dm9pZD4ge1xyXG4gIHRyeSB7XHJcbiAgICBjb25zb2xlLmxvZyhgW3Byb2Nlc3NTZXJ2aWNlTGluZV0gUHJvY2Vzc2luZyBzZXJ2aWNlIHNhbGU6ICR7bGluZS5kZXNjcmlwdGlvbn1gKTtcclxuICAgIFxyXG4gICAgLy8gSWRlbXBvdGVuY3kgY2hlY2tcclxuICAgIGNvbnN0IHRhc2tDcmVhdGVkS2V5ID0gYHNhbGU6JHtzYWxlLmlkfTp0YXNrQ3JlYXRlZDoke2xpbmUubGluZUlkfWA7XHJcbiAgICBjb25zdCBoYXNCZWVuQ3JlYXRlZCA9IGF3YWl0IGhhc0VmZmVjdCh0YXNrQ3JlYXRlZEtleSk7XHJcbiAgICBcclxuICAgIGlmIChoYXNCZWVuQ3JlYXRlZCB8fCAhbGluZS5jcmVhdGVUYXNrKSB7XHJcbiAgICAgIGNvbnNvbGUubG9nKGBbcHJvY2Vzc1NlcnZpY2VMaW5lXSBUYXNrIGFscmVhZHkgY3JlYXRlZCBvciBub3QgcmVxdWVzdGVkIGZvciBsaW5lICR7bGluZS5saW5lSWR9LCBza2lwcGluZ2ApO1xyXG4gICAgICByZXR1cm47XHJcbiAgICB9XHJcbiAgICBcclxuICAgIC8vIENyZWF0ZSB0YXNrIGZyb20gc2VydmljZSBsaW5lXHJcbiAgICBjb25zdCBzZXJ2aWNlVGFzazogVGFzayA9IHtcclxuICAgICAgaWQ6IGxpbmUudGFza0lkIHx8IGB0YXNrLSR7c2FsZS5pZH0tJHtsaW5lLmxpbmVJZH1gLFxyXG4gICAgICBuYW1lOiBsaW5lLmRlc2NyaXB0aW9uIHx8ICdTZXJ2aWNlIFRhc2snLFxyXG4gICAgICBkZXNjcmlwdGlvbjogYFNlcnZpY2UgZnJvbSBzYWxlOiAke3NhbGUuY291bnRlcnBhcnR5TmFtZX1gLFxyXG4gICAgICB0eXBlOiBsaW5lLnRhc2tUeXBlIHx8ICdUQVNLJyBhcyBhbnksXHJcbiAgICAgIHN0YXR1czogJ0NyZWF0ZWQnIGFzIGFueSxcclxuICAgICAgcHJpb3JpdHk6ICdOb3JtYWwnIGFzIGFueSxcclxuICAgICAgc3RhdGlvbjogbGluZS5zdGF0aW9uLFxyXG4gICAgICBwcm9ncmVzczogMCxcclxuICAgICAgb3JkZXI6IERhdGUubm93KCksXHJcbiAgICAgIGNvc3Q6IGxpbmUudGFza0Nvc3QgfHwgMCxcclxuICAgICAgcmV2ZW51ZTogMCwgLy8gVGFza3MgZnJvbSBzYWxlcyBkb24ndCBnZXQgcmV2ZW51ZSAtIGl0IHN0YXlzIGluIHRoZSBzYWxlXHJcbiAgICAgIHJld2FyZHM6IGxpbmUudGFza1Jld2FyZHMgPyB7IHBvaW50czogbGluZS50YXNrUmV3YXJkcyB9IDogeyBwb2ludHM6IHsgeHA6IDAsIHJwOiAwLCBmcDogMCwgaHA6IDAgfSB9LFxyXG4gICAgICBpc0NvbGxlY3RlZDogZmFsc2UsXHJcbiAgICAgIGNyZWF0ZWRBdDogbmV3IERhdGUoKSxcclxuICAgICAgdXBkYXRlZEF0OiBuZXcgRGF0ZSgpLFxyXG4gICAgICBsaW5rczogW10sXHJcbiAgICAgIC8vIEFtYmFzc2Fkb3IgRmllbGRzIC0gaW5oZXJpdCBmcm9tIHNhbGVcclxuICAgICAgc2l0ZUlkOiBzYWxlLnNpdGVJZCxcclxuICAgICAgdGFyZ2V0U2l0ZUlkOiBsaW5lLnRhc2tUYXJnZXRTaXRlSWQgfHwgdW5kZWZpbmVkLFxyXG4gICAgICBzb3VyY2VTYWxlSWQ6IHNhbGUuaWQsIC8vIExpbmsgdGFzayBiYWNrIHRvIHNhbGVcclxuICAgICAgLy8gQWRkaXRpb25hbCBmaWVsZHMgZnJvbSBzZXJ2aWNlIGxpbmVcclxuICAgICAgcGFyZW50SWQ6IGxpbmUudGFza1BhcmVudElkIHx8IHVuZGVmaW5lZCxcclxuICAgICAgZHVlRGF0ZTogbGluZS50YXNrRHVlRGF0ZSB8fCB1bmRlZmluZWQsXHJcbiAgICAgIC8vIEVtaXNzYXJ5IGZpZWxkcyBmb3IgaXRlbSBjcmVhdGlvblxyXG4gICAgICBvdXRwdXRJdGVtVHlwZTogbGluZS5vdXRwdXRJdGVtVHlwZSB8fCB1bmRlZmluZWQsXHJcbiAgICAgIG91dHB1dEl0ZW1TdWJUeXBlOiBsaW5lLm91dHB1dEl0ZW1TdWJUeXBlIHx8IHVuZGVmaW5lZCxcclxuICAgICAgb3V0cHV0UXVhbnRpdHk6IGxpbmUub3V0cHV0SXRlbVF1YW50aXR5IHx8IHVuZGVmaW5lZCxcclxuICAgICAgb3V0cHV0SXRlbU5hbWU6IGxpbmUub3V0cHV0SXRlbU5hbWUgfHwgdW5kZWZpbmVkLFxyXG4gICAgICBvdXRwdXRVbml0Q29zdDogbGluZS5vdXRwdXRVbml0Q29zdCB8fCB1bmRlZmluZWQsXHJcbiAgICAgIG91dHB1dEl0ZW1Db2xsZWN0aW9uOiBsaW5lLm91dHB1dEl0ZW1Db2xsZWN0aW9uIHx8IHVuZGVmaW5lZCxcclxuICAgICAgb3V0cHV0SXRlbVByaWNlOiBsaW5lLm91dHB1dEl0ZW1QcmljZSB8fCB1bmRlZmluZWQsXHJcbiAgICAgIGlzTmV3SXRlbTogbGluZS5pc05ld091dHB1dEl0ZW0gfHwgZmFsc2UsXHJcbiAgICAgIGlzU29sZDogbGluZS5pc1NvbGQgfHwgZmFsc2UsXHJcbiAgICAgIG91dHB1dEl0ZW1TdGF0dXM6ICdDcmVhdGVkJyBhcyBhbnlcclxuICAgIH07XHJcbiAgICBcclxuICAgIC8vIFNhdmUgdGhlIHRhc2tcclxuICAgIGF3YWl0IENsaWVudEFQSS51cHNlcnRUYXNrKHNlcnZpY2VUYXNrKTtcclxuICAgIFxyXG4gICAgLy8gQ3JlYXRlIFNBTEVfVEFTSyBsaW5rXHJcbiAgICBjb25zdCBsaW5rTWV0YWRhdGEgPSB7XHJcbiAgICAgIHNlcnZpY2VEZXNjcmlwdGlvbjogbGluZS5kZXNjcmlwdGlvbixcclxuICAgICAgcmV2ZW51ZTogbGluZS5yZXZlbnVlLFxyXG4gICAgICBzdGF0aW9uOiBsaW5lLnN0YXRpb24sXHJcbiAgICAgIHRhc2tUeXBlOiBsaW5lLnRhc2tUeXBlLFxyXG4gICAgICBjcmVhdGVkRnJvbTogJ3NlcnZpY2Vfc2FsZSdcclxuICAgIH07XHJcbiAgICBcclxuICAgIGNvbnN0IGxpbmsgPSBtYWtlTGluayhcclxuICAgICAgTGlua1R5cGUuU0FMRV9UQVNLLFxyXG4gICAgICB7IHR5cGU6IEVudGl0eVR5cGUuU0FMRSwgaWQ6IHNhbGUuaWQgfSxcclxuICAgICAgeyB0eXBlOiBFbnRpdHlUeXBlLlRBU0ssIGlkOiBzZXJ2aWNlVGFzay5pZCB9LFxyXG4gICAgICBsaW5rTWV0YWRhdGFcclxuICAgICk7XHJcbiAgICBhd2FpdCBjcmVhdGVMaW5rKGxpbmspO1xyXG4gICAgXHJcbiAgICAvLyBNYXJrIGVmZmVjdCBhcyBjb21wbGV0ZVxyXG4gICAgYXdhaXQgbWFya0VmZmVjdChgc2FsZToke3NhbGUuaWR9OiR7dGFza0NyZWF0ZWRLZXl9YCk7XHJcbiAgICBcclxuICAgIC8vIExvZyB0aGUgdGFzayBjcmVhdGlvblxyXG4gICAgYXdhaXQgYXBwZW5kRW50aXR5TG9nKCd0YXNrJywgc2VydmljZVRhc2suaWQsICdDUkVBVEVEJywge1xyXG4gICAgICBuYW1lOiBzZXJ2aWNlVGFzay5uYW1lLFxyXG4gICAgICBjcmVhdGVkRnJvbTogJ3NlcnZpY2Vfc2FsZScsXHJcbiAgICAgIHNhbGVJZDogc2FsZS5pZCxcclxuICAgICAgc2VydmljZURlc2NyaXB0aW9uOiBsaW5lLmRlc2NyaXB0aW9uLFxyXG4gICAgICBzdGF0aW9uOiBsaW5lLnN0YXRpb25cclxuICAgIH0pO1xyXG4gICAgXHJcbiAgICBjb25zb2xlLmxvZyhgW3Byb2Nlc3NTZXJ2aWNlTGluZV0g4pyFIENyZWF0ZWQgdGFzayBmcm9tIHNlcnZpY2U6ICR7c2VydmljZVRhc2submFtZX1gKTtcclxuICAgIFxyXG4gIH0gY2F0Y2ggKGVycm9yKSB7XHJcbiAgICBjb25zb2xlLmVycm9yKGBbcHJvY2Vzc1NlcnZpY2VMaW5lXSDinYwgRmFpbGVkIHRvIHByb2Nlc3Mgc2VydmljZSBzYWxlIGxpbmUgJHtsaW5lLmxpbmVJZH06YCwgZXJyb3IpO1xyXG4gICAgdGhyb3cgZXJyb3I7XHJcbiAgfVxyXG59XHJcblxyXG4iXSwibmFtZXMiOlsiTGlua1R5cGUiLCJFbnRpdHlUeXBlIiwiQ2xpZW50QVBJIiwibWFrZUxpbmsiLCJjcmVhdGVMaW5rIiwiaGFzRWZmZWN0IiwibWFya0VmZmVjdCIsImFwcGVuZEVudGl0eUxvZyIsImNyZWF0ZUZpbmFuY2lhbFJlY29yZEZyb21TYWxlIiwicHJvY2Vzc1NhbGVMaW5lcyIsInNhbGUiLCJjb25zb2xlIiwibG9nIiwibGluZXMiLCJsZW5ndGgiLCJjb3VudGVycGFydHlOYW1lIiwibGluZSIsImtpbmQiLCJsaW5lSWQiLCJwcm9jZXNzSXRlbVNhbGVMaW5lIiwicHJvY2Vzc0J1bmRsZVNhbGVMaW5lIiwicHJvY2Vzc1NlcnZpY2VMaW5lIiwid2FybiIsInRvdGFscyIsInRvdGFsUmV2ZW51ZSIsImVycm9yIiwiaWQiLCJpdGVtSWQiLCJxdWFudGl0eSIsInN0b2NrRGVjcmVtZW50ZWRLZXkiLCJoYXNCZWVuRGVjcmVtZW50ZWQiLCJpdGVtcyIsImdldEl0ZW1zIiwiaXRlbSIsImZpbmQiLCJpIiwidG90YWxBdmFpbGFibGVRdWFudGl0eSIsInN0b2NrIiwicmVkdWNlIiwic3VtIiwic3RvY2tQb2ludCIsInF1YW50aXR5U29sZCIsIm5hbWUiLCJ1cGRhdGVkSXRlbSIsInVwZGF0ZWRBdCIsIkRhdGUiLCJzdGF0dXMiLCJ1cHNlcnRJdGVtIiwibGlua01ldGFkYXRhIiwidW5pdFByaWNlIiwidG90YWwiLCJzb2xkQXQiLCJzYWxlRGF0ZSIsInRvSVNPU3RyaW5nIiwic2l0ZUlkIiwibGluayIsIlNBTEVfSVRFTSIsInR5cGUiLCJTQUxFIiwiSVRFTSIsInNhbGVJZCIsIml0ZW1UeXBlIiwiYnVuZGxlUHJvY2Vzc2VkS2V5IiwiaGFzQmVlblByb2Nlc3NlZCIsImRlc2NyaXB0aW9uIiwidGFza0NyZWF0ZWRLZXkiLCJoYXNCZWVuQ3JlYXRlZCIsImNyZWF0ZVRhc2siLCJzZXJ2aWNlVGFzayIsInRhc2tJZCIsInRhc2tUeXBlIiwicHJpb3JpdHkiLCJzdGF0aW9uIiwicHJvZ3Jlc3MiLCJvcmRlciIsIm5vdyIsImNvc3QiLCJ0YXNrQ29zdCIsInJldmVudWUiLCJyZXdhcmRzIiwidGFza1Jld2FyZHMiLCJwb2ludHMiLCJ4cCIsInJwIiwiZnAiLCJocCIsImlzQ29sbGVjdGVkIiwiY3JlYXRlZEF0IiwibGlua3MiLCJ0YXJnZXRTaXRlSWQiLCJ0YXNrVGFyZ2V0U2l0ZUlkIiwidW5kZWZpbmVkIiwic291cmNlU2FsZUlkIiwicGFyZW50SWQiLCJ0YXNrUGFyZW50SWQiLCJkdWVEYXRlIiwidGFza0R1ZURhdGUiLCJvdXRwdXRJdGVtVHlwZSIsIm91dHB1dEl0ZW1TdWJUeXBlIiwib3V0cHV0UXVhbnRpdHkiLCJvdXRwdXRJdGVtUXVhbnRpdHkiLCJvdXRwdXRJdGVtTmFtZSIsIm91dHB1dFVuaXRDb3N0Iiwib3V0cHV0SXRlbUNvbGxlY3Rpb24iLCJvdXRwdXRJdGVtUHJpY2UiLCJpc05ld0l0ZW0iLCJpc05ld091dHB1dEl0ZW0iLCJpc1NvbGQiLCJvdXRwdXRJdGVtU3RhdHVzIiwidXBzZXJ0VGFzayIsInNlcnZpY2VEZXNjcmlwdGlvbiIsImNyZWF0ZWRGcm9tIiwiU0FMRV9UQVNLIiwiVEFTSyJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./workflows/sale-line-utils.ts\n");

/***/ }),

/***/ "(rsc)/./workflows/update-propagation-utils.ts":
/*!***********************************************!*\
  !*** ./workflows/update-propagation-utils.ts ***!
  \***********************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   hasFinancialPropsChanged: () => (/* binding */ hasFinancialPropsChanged),\n/* harmony export */   hasJungleCoinsChanged: () => (/* binding */ hasJungleCoinsChanged),\n/* harmony export */   hasLinesChanged: () => (/* binding */ hasLinesChanged),\n/* harmony export */   hasOutputPropsChanged: () => (/* binding */ hasOutputPropsChanged),\n/* harmony export */   hasRevenueChanged: () => (/* binding */ hasRevenueChanged),\n/* harmony export */   hasRewardsChanged: () => (/* binding */ hasRewardsChanged),\n/* harmony export */   updateCharacterJungleCoinsFromRecord: () => (/* binding */ updateCharacterJungleCoinsFromRecord),\n/* harmony export */   updateFinancialRecordsFromSale: () => (/* binding */ updateFinancialRecordsFromSale),\n/* harmony export */   updateFinancialRecordsFromTask: () => (/* binding */ updateFinancialRecordsFromTask),\n/* harmony export */   updateItemsCreatedByRecord: () => (/* binding */ updateItemsCreatedByRecord),\n/* harmony export */   updateItemsCreatedByTask: () => (/* binding */ updateItemsCreatedByTask),\n/* harmony export */   updateItemsFromSale: () => (/* binding */ updateItemsFromSale),\n/* harmony export */   updatePlayerPointsFromSource: () => (/* binding */ updatePlayerPointsFromSource),\n/* harmony export */   updateTasksFromFinancialRecord: () => (/* binding */ updateTasksFromFinancialRecord)\n/* harmony export */ });\n/* harmony import */ var _lib_client_api__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @/lib/client-api */ \"(rsc)/./lib/client-api.ts\");\n/* harmony import */ var _data_store_effects_registry__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @/data-store/effects-registry */ \"(rsc)/./data-store/effects-registry.ts\");\n// workflows/update-propagation-utils.ts\n// Comprehensive update propagation across ALL entity relationships\n\n\n// ============================================================================\n// TASK → FINANCIAL RECORD PROPAGATION\n// ============================================================================\nasync function updateFinancialRecordsFromTask(task, previousTask) {\n    try {\n        console.log(`[updateFinancialRecordsFromTask] Updating financial records for task: ${task.name}`);\n        // Find financial records created from this task\n        const allFinancials = await _lib_client_api__WEBPACK_IMPORTED_MODULE_0__.ClientAPI.getFinancialRecords();\n        const relatedRecords = allFinancials.filter((record)=>record.sourceTaskId === task.id);\n        for (const record of relatedRecords){\n            const updateKey = `updateFinancialFromTask:${task.id}:${record.id}:${task.updatedAt?.getTime()}`;\n            if (await (0,_data_store_effects_registry__WEBPACK_IMPORTED_MODULE_1__.hasEffect)(updateKey)) {\n                console.log(`[updateFinancialRecordsFromTask] ⏭️ Already updated record: ${record.id}`);\n                continue;\n            }\n            // Check if financial properties changed\n            const financialPropsChanged = task.cost !== previousTask.cost || task.revenue !== previousTask.revenue || task.isNotPaid !== previousTask.isNotPaid || task.isNotCharged !== previousTask.isNotCharged || task.name !== previousTask.name || task.station !== previousTask.station;\n            if (financialPropsChanged) {\n                const updatedRecord = {\n                    ...record,\n                    cost: task.cost,\n                    revenue: task.revenue,\n                    isNotPaid: task.isNotPaid,\n                    isNotCharged: task.isNotCharged,\n                    name: task.name,\n                    station: task.station,\n                    updatedAt: new Date()\n                };\n                await _lib_client_api__WEBPACK_IMPORTED_MODULE_0__.ClientAPI.upsertFinancialRecord(updatedRecord);\n                await (0,_data_store_effects_registry__WEBPACK_IMPORTED_MODULE_1__.markEffect)(updateKey);\n                console.log(`[updateFinancialRecordsFromTask] ✅ Updated financial record: ${record.id}`);\n            }\n        }\n    } catch (error) {\n        console.error(`[updateFinancialRecordsFromTask] Error updating financial records:`, error);\n    }\n}\n// ============================================================================\n// FINANCIAL RECORD → TASK PROPAGATION\n// ============================================================================\nasync function updateTasksFromFinancialRecord(record, previousRecord) {\n    try {\n        console.log(`[updateTasksFromFinancialRecord] Updating tasks for financial record: ${record.name}`);\n        // Find tasks that created this financial record\n        const allTasks = await _lib_client_api__WEBPACK_IMPORTED_MODULE_0__.ClientAPI.getTasks();\n        const relatedTasks = allTasks.filter((task)=>task.id === record.sourceTaskId);\n        for (const task of relatedTasks){\n            const updateKey = `updateTaskFromFinancial:${record.id}:${task.id}:${record.updatedAt?.getTime()}`;\n            if (await (0,_data_store_effects_registry__WEBPACK_IMPORTED_MODULE_1__.hasEffect)(updateKey)) {\n                console.log(`[updateTasksFromFinancialRecord] ⏭️ Already updated task: ${task.id}`);\n                continue;\n            }\n            // Check if financial properties changed\n            const financialPropsChanged = record.cost !== previousRecord.cost || record.revenue !== previousRecord.revenue || record.isNotPaid !== previousRecord.isNotPaid || record.isNotCharged !== previousRecord.isNotCharged || record.name !== previousRecord.name || record.station !== previousRecord.station;\n            if (financialPropsChanged) {\n                const updatedTask = {\n                    ...task,\n                    cost: record.cost,\n                    revenue: record.revenue,\n                    isNotPaid: record.isNotPaid,\n                    isNotCharged: record.isNotCharged,\n                    name: record.name,\n                    station: record.station,\n                    updatedAt: new Date()\n                };\n                await _lib_client_api__WEBPACK_IMPORTED_MODULE_0__.ClientAPI.upsertTask(updatedTask);\n                await (0,_data_store_effects_registry__WEBPACK_IMPORTED_MODULE_1__.markEffect)(updateKey);\n                console.log(`[updateTasksFromFinancialRecord] ✅ Updated task: ${task.id}`);\n            }\n        }\n    } catch (error) {\n        console.error(`[updateTasksFromFinancialRecord] Error updating tasks:`, error);\n    }\n}\n// ============================================================================\n// TASK → ITEM PROPAGATION (Enhanced)\n// ============================================================================\nasync function updateItemsCreatedByTask(task, previousTask) {\n    try {\n        console.log(`[updateItemsCreatedByTask] Updating items for task: ${task.name}`);\n        // Find items created from this task\n        const allItems = await _lib_client_api__WEBPACK_IMPORTED_MODULE_0__.ClientAPI.getItems();\n        const relatedItems = allItems.filter((item)=>item.sourceTaskId === task.id);\n        for (const item of relatedItems){\n            const updateKey = `updateItemFromTask:${task.id}:${item.id}:${task.updatedAt?.getTime()}`;\n            if (await (0,_data_store_effects_registry__WEBPACK_IMPORTED_MODULE_1__.hasEffect)(updateKey)) {\n                console.log(`[updateItemsCreatedByTask] ⏭️ Already updated item: ${item.id}`);\n                continue;\n            }\n            // Check if output properties changed\n            const outputPropsChanged = task.outputQuantity !== previousTask.outputQuantity || task.outputItemName !== previousTask.outputItemName || task.outputUnitCost !== previousTask.outputUnitCost || task.outputItemPrice !== previousTask.outputItemPrice || task.station !== previousTask.station;\n            if (outputPropsChanged) {\n                const updatedItem = {\n                    ...item,\n                    name: task.outputItemName || item.name,\n                    unitCost: task.outputUnitCost || item.unitCost,\n                    price: task.outputItemPrice || item.price,\n                    station: task.station || item.station,\n                    updatedAt: new Date()\n                };\n                // Update stock quantity if it changed\n                if (task.outputQuantity !== previousTask.outputQuantity) {\n                    const quantityDiff = (task.outputQuantity || 0) - (previousTask.outputQuantity || 0);\n                    if (quantityDiff !== 0) {\n                        // Update the first stock point (or create one if none exists)\n                        if (updatedItem.stock && updatedItem.stock.length > 0) {\n                            updatedItem.stock[0].quantity += quantityDiff;\n                        } else {\n                            updatedItem.stock = [\n                                {\n                                    siteId: task.siteId || \"default\",\n                                    quantity: quantityDiff\n                                }\n                            ];\n                        }\n                    }\n                }\n                await _lib_client_api__WEBPACK_IMPORTED_MODULE_0__.ClientAPI.upsertItem(updatedItem);\n                await (0,_data_store_effects_registry__WEBPACK_IMPORTED_MODULE_1__.markEffect)(updateKey);\n                console.log(`[updateItemsCreatedByTask] ✅ Updated item: ${item.id}`);\n            }\n        }\n    } catch (error) {\n        console.error(`[updateItemsCreatedByTask] Error updating items:`, error);\n    }\n}\n// ============================================================================\n// FINANCIAL RECORD → ITEM PROPAGATION (Enhanced)\n// ============================================================================\nasync function updateItemsCreatedByRecord(record, previousRecord) {\n    try {\n        console.log(`[updateItemsCreatedByRecord] Updating items for financial record: ${record.name}`);\n        // Find items created from this financial record\n        const allItems = await _lib_client_api__WEBPACK_IMPORTED_MODULE_0__.ClientAPI.getItems();\n        const relatedItems = allItems.filter((item)=>item.sourceRecordId === record.id);\n        for (const item of relatedItems){\n            const updateKey = `updateItemFromRecord:${record.id}:${item.id}:${record.updatedAt?.getTime()}`;\n            if (await (0,_data_store_effects_registry__WEBPACK_IMPORTED_MODULE_1__.hasEffect)(updateKey)) {\n                console.log(`[updateItemsCreatedByRecord] ⏭️ Already updated item: ${item.id}`);\n                continue;\n            }\n            // Check if output properties changed\n            const outputPropsChanged = record.outputQuantity !== previousRecord.outputQuantity || record.outputItemName !== previousRecord.outputItemName || record.outputUnitCost !== previousRecord.outputUnitCost || record.outputItemPrice !== previousRecord.outputItemPrice || record.station !== previousRecord.station;\n            if (outputPropsChanged) {\n                const updatedItem = {\n                    ...item,\n                    name: record.outputItemName || item.name,\n                    unitCost: record.outputUnitCost || item.unitCost,\n                    price: record.outputItemPrice || item.price,\n                    station: record.station || item.station,\n                    updatedAt: new Date()\n                };\n                // Update stock quantity if it changed\n                if (record.outputQuantity !== previousRecord.outputQuantity) {\n                    const quantityDiff = (record.outputQuantity || 0) - (previousRecord.outputQuantity || 0);\n                    if (quantityDiff !== 0) {\n                        // Update the first stock point (or create one if none exists)\n                        if (updatedItem.stock && updatedItem.stock.length > 0) {\n                            updatedItem.stock[0].quantity += quantityDiff;\n                        } else {\n                            updatedItem.stock = [\n                                {\n                                    siteId: record.siteId || \"default\",\n                                    quantity: quantityDiff\n                                }\n                            ];\n                        }\n                    }\n                }\n                await _lib_client_api__WEBPACK_IMPORTED_MODULE_0__.ClientAPI.upsertItem(updatedItem);\n                await (0,_data_store_effects_registry__WEBPACK_IMPORTED_MODULE_1__.markEffect)(updateKey);\n                console.log(`[updateItemsCreatedByRecord] ✅ Updated item: ${item.id}`);\n            }\n        }\n    } catch (error) {\n        console.error(`[updateItemsCreatedByRecord] Error updating items:`, error);\n    }\n}\n// ============================================================================\n// SALE → FINANCIAL RECORD PROPAGATION\n// ============================================================================\nasync function updateFinancialRecordsFromSale(sale, previousSale) {\n    try {\n        console.log(`[updateFinancialRecordsFromSale] Updating financial records for sale: ${sale.name}`);\n        // Find financial records created from this sale\n        const allFinancials = await _lib_client_api__WEBPACK_IMPORTED_MODULE_0__.ClientAPI.getFinancialRecords();\n        const relatedRecords = allFinancials.filter((record)=>record.sourceSaleId === sale.id);\n        for (const record of relatedRecords){\n            const updateKey = `updateFinancialFromSale:${sale.id}:${record.id}:${sale.updatedAt?.getTime()}`;\n            if (await (0,_data_store_effects_registry__WEBPACK_IMPORTED_MODULE_1__.hasEffect)(updateKey)) {\n                console.log(`[updateFinancialRecordsFromSale] ⏭️ Already updated record: ${record.id}`);\n                continue;\n            }\n            // Check if revenue properties changed\n            const revenuePropsChanged = sale.totals?.totalRevenue !== previousSale.totals?.totalRevenue || sale.isNotPaid !== previousSale.isNotPaid || sale.status !== previousSale.status;\n            if (revenuePropsChanged) {\n                const updatedRecord = {\n                    ...record,\n                    revenue: sale.totals?.totalRevenue || 0,\n                    isNotPaid: sale.isNotPaid,\n                    isNotCharged: sale.status !== \"CHARGED\",\n                    updatedAt: new Date()\n                };\n                await _lib_client_api__WEBPACK_IMPORTED_MODULE_0__.ClientAPI.upsertFinancialRecord(updatedRecord);\n                await (0,_data_store_effects_registry__WEBPACK_IMPORTED_MODULE_1__.markEffect)(updateKey);\n                console.log(`[updateFinancialRecordsFromSale] ✅ Updated financial record: ${record.id}`);\n            }\n        }\n    } catch (error) {\n        console.error(`[updateFinancialRecordsFromSale] Error updating financial records:`, error);\n    }\n}\n// ============================================================================\n// SALE → ITEM PROPAGATION (Stock Updates)\n// ============================================================================\nasync function updateItemsFromSale(sale, previousSale) {\n    try {\n        console.log(`[updateItemsFromSale] Updating items for sale: ${sale.name}`);\n        // Check if sale lines changed\n        const linesChanged = sale.lines?.length !== previousSale.lines?.length || JSON.stringify(sale.lines) !== JSON.stringify(previousSale.lines);\n        if (!linesChanged) {\n            console.log(`[updateItemsFromSale] No line changes detected`);\n            return;\n        }\n        // Process each sale line\n        for (const line of sale.lines || []){\n            if (line.kind === \"item\" && \"itemId\" in line && line.itemId) {\n                const updateKey = `updateItemFromSale:${sale.id}:${line.itemId}:${sale.updatedAt?.getTime()}`;\n                if (await (0,_data_store_effects_registry__WEBPACK_IMPORTED_MODULE_1__.hasEffect)(updateKey)) {\n                    console.log(`[updateItemsFromSale] ⏭️ Already updated item: ${line.itemId}`);\n                    continue;\n                }\n                // Get the item\n                const item = await _lib_client_api__WEBPACK_IMPORTED_MODULE_0__.ClientAPI.getItemById(line.itemId);\n                if (!item) {\n                    console.warn(`[updateItemsFromSale] Item not found: ${line.itemId}`);\n                    continue;\n                }\n                // Update quantity sold\n                const updatedItem = {\n                    ...item,\n                    quantitySold: (item.quantitySold || 0) + (line.quantity || 0),\n                    updatedAt: new Date()\n                };\n                await _lib_client_api__WEBPACK_IMPORTED_MODULE_0__.ClientAPI.upsertItem(updatedItem);\n                await (0,_data_store_effects_registry__WEBPACK_IMPORTED_MODULE_1__.markEffect)(updateKey);\n                console.log(`[updateItemsFromSale] ✅ Updated item: ${line.itemId}`);\n            }\n        }\n    } catch (error) {\n        console.error(`[updateItemsFromSale] Error updating items:`, error);\n    }\n}\n// ============================================================================\n// TASK/FINANCIAL/SALE → PLAYER PROPAGATION (Points Delta)\n// ============================================================================\nasync function updatePlayerPointsFromSource(sourceType, newSource, oldSource) {\n    try {\n        console.log(`[updatePlayerPointsFromSource] Updating player points from ${sourceType}: ${newSource.name}`);\n        // Calculate points delta\n        let pointsDelta = {\n            xp: 0,\n            rp: 0,\n            fp: 0,\n            hp: 0\n        };\n        if (sourceType === \"task\" || sourceType === \"financial\") {\n            const newPoints = newSource.rewards?.points || {\n                xp: 0,\n                rp: 0,\n                fp: 0,\n                hp: 0\n            };\n            const oldPoints = oldSource.rewards?.points || {\n                xp: 0,\n                rp: 0,\n                fp: 0,\n                hp: 0\n            };\n            pointsDelta = {\n                xp: (newPoints.xp || 0) - (oldPoints.xp || 0),\n                rp: (newPoints.rp || 0) - (oldPoints.rp || 0),\n                fp: (newPoints.fp || 0) - (oldPoints.fp || 0),\n                hp: (newPoints.hp || 0) - (oldPoints.hp || 0)\n            };\n        } else if (sourceType === \"sale\") {\n            // Calculate points from revenue (simplified)\n            const newRevenue = newSource.totals?.totalRevenue || 0;\n            const oldRevenue = oldSource.totals?.totalRevenue || 0;\n            const revenueDelta = newRevenue - oldRevenue;\n            // Convert revenue to points (simplified calculation)\n            pointsDelta = {\n                xp: Math.floor(revenueDelta * 0.1),\n                rp: Math.floor(revenueDelta * 0.05),\n                fp: Math.floor(revenueDelta * 0.03),\n                hp: Math.floor(revenueDelta * 0.02)\n            };\n        }\n        // Skip if no points change\n        if (pointsDelta.xp === 0 && pointsDelta.rp === 0 && pointsDelta.fp === 0 && pointsDelta.hp === 0) {\n            console.log(`[updatePlayerPointsFromSource] No points change detected`);\n            return;\n        }\n        // Find the player (assuming single player for now)\n        const players = await _lib_client_api__WEBPACK_IMPORTED_MODULE_0__.ClientAPI.getPlayers();\n        const player = players[0]; // Simplified - in real system, find by source relationship\n        if (!player) {\n            console.warn(`[updatePlayerPointsFromSource] No player found`);\n            return;\n        }\n        const updateKey = `updatePlayerPoints:${sourceType}:${newSource.id}:${player.id}:${newSource.updatedAt?.getTime()}`;\n        if (await (0,_data_store_effects_registry__WEBPACK_IMPORTED_MODULE_1__.hasEffect)(updateKey)) {\n            console.log(`[updatePlayerPointsFromSource] ⏭️ Already updated player: ${player.id}`);\n            return;\n        }\n        // Update player points\n        const updatedPlayer = {\n            ...player,\n            points: {\n                xp: (player.points?.xp || 0) + pointsDelta.xp,\n                rp: (player.points?.rp || 0) + pointsDelta.rp,\n                fp: (player.points?.fp || 0) + pointsDelta.fp,\n                hp: (player.points?.hp || 0) + pointsDelta.hp\n            },\n            updatedAt: new Date()\n        };\n        await _lib_client_api__WEBPACK_IMPORTED_MODULE_0__.ClientAPI.upsertPlayer(updatedPlayer);\n        await (0,_data_store_effects_registry__WEBPACK_IMPORTED_MODULE_1__.markEffect)(updateKey);\n        console.log(`[updatePlayerPointsFromSource] ✅ Updated player points: ${player.id}`);\n    } catch (error) {\n        console.error(`[updatePlayerPointsFromSource] Error updating player points:`, error);\n    }\n}\n// ============================================================================\n// FINANCIAL → CHARACTER PROPAGATION (Jungle Coins Delta)\n// ============================================================================\nasync function updateCharacterJungleCoinsFromRecord(record, previousRecord) {\n    try {\n        console.log(`[updateCharacterJungleCoinsFromRecord] Updating character jungle coins for record: ${record.name}`);\n        // Calculate jungle coins delta\n        const newJungleCoins = record.jungleCoins || 0;\n        const oldJungleCoins = previousRecord.jungleCoins || 0;\n        const jungleCoinsDelta = newJungleCoins - oldJungleCoins;\n        if (jungleCoinsDelta === 0) {\n            console.log(`[updateCharacterJungleCoinsFromRecord] No jungle coins change detected`);\n            return;\n        }\n        // Find characters related to this financial record\n        const allCharacters = await _lib_client_api__WEBPACK_IMPORTED_MODULE_0__.ClientAPI.getCharacters();\n        const relatedCharacters = allCharacters.filter((char)=>char.id === record.customerCharacterId);\n        for (const character of relatedCharacters){\n            const updateKey = `updateCharacterJungleCoins:${record.id}:${character.id}:${record.updatedAt?.getTime()}`;\n            if (await (0,_data_store_effects_registry__WEBPACK_IMPORTED_MODULE_1__.hasEffect)(updateKey)) {\n                console.log(`[updateCharacterJungleCoinsFromRecord] ⏭️ Already updated character: ${character.id}`);\n                continue;\n            }\n            // Update character jungle coins\n            const updatedCharacter = {\n                ...character,\n                jungleCoins: (character.jungleCoins || 0) + jungleCoinsDelta,\n                updatedAt: new Date()\n            };\n            await _lib_client_api__WEBPACK_IMPORTED_MODULE_0__.ClientAPI.upsertCharacter(updatedCharacter);\n            await (0,_data_store_effects_registry__WEBPACK_IMPORTED_MODULE_1__.markEffect)(updateKey);\n            console.log(`[updateCharacterJungleCoinsFromRecord] ✅ Updated character jungle coins: ${character.id}`);\n        }\n    } catch (error) {\n        console.error(`[updateCharacterJungleCoinsFromRecord] Error updating character jungle coins:`, error);\n    }\n}\n// ============================================================================\n// PROPERTY CHANGE DETECTION HELPERS\n// ============================================================================\nfunction hasFinancialPropsChanged(newEntity, oldEntity) {\n    return newEntity.cost !== oldEntity.cost || newEntity.revenue !== oldEntity.revenue || newEntity.isNotPaid !== oldEntity.isNotPaid || newEntity.isNotCharged !== oldEntity.isNotCharged || newEntity.name !== oldEntity.name || newEntity.station !== oldEntity.station;\n}\nfunction hasOutputPropsChanged(newEntity, oldEntity) {\n    return newEntity.outputQuantity !== oldEntity.outputQuantity || newEntity.outputItemName !== oldEntity.outputItemName || newEntity.outputUnitCost !== oldEntity.outputUnitCost || newEntity.outputItemPrice !== oldEntity.outputItemPrice || newEntity.station !== oldEntity.station;\n}\nfunction hasRewardsChanged(newEntity, oldEntity) {\n    const newRewards = newEntity.rewards?.points || {\n        xp: 0,\n        rp: 0,\n        fp: 0,\n        hp: 0\n    };\n    const oldRewards = oldEntity.rewards?.points || {\n        xp: 0,\n        rp: 0,\n        fp: 0,\n        hp: 0\n    };\n    return newRewards.xp !== oldRewards.xp || newRewards.rp !== oldRewards.rp || newRewards.fp !== oldRewards.fp || newRewards.hp !== oldRewards.hp;\n}\nfunction hasJungleCoinsChanged(newEntity, oldEntity) {\n    return (newEntity.jungleCoins || 0) !== (oldEntity.jungleCoins || 0);\n}\nfunction hasRevenueChanged(newEntity, oldEntity) {\n    return (newEntity.totals?.totalRevenue || 0) !== (oldEntity.totals?.totalRevenue || 0);\n}\nfunction hasLinesChanged(newEntity, oldEntity) {\n    return JSON.stringify(newEntity.lines) !== JSON.stringify(oldEntity.lines);\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi93b3JrZmxvd3MvdXBkYXRlLXByb3BhZ2F0aW9uLXV0aWxzLnRzIiwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7QUFBQSx3Q0FBd0M7QUFDeEMsbUVBQW1FO0FBR3RCO0FBQ3lCO0FBRXRFLCtFQUErRTtBQUMvRSxzQ0FBc0M7QUFDdEMsK0VBQStFO0FBRXhFLGVBQWVHLCtCQUNwQkMsSUFBVSxFQUNWQyxZQUFrQjtJQUVsQixJQUFJO1FBQ0ZDLFFBQVFDLEdBQUcsQ0FBQyxDQUFDLHNFQUFzRSxFQUFFSCxLQUFLSSxJQUFJLENBQUMsQ0FBQztRQUVoRyxnREFBZ0Q7UUFDaEQsTUFBTUMsZ0JBQWdCLE1BQU1ULHNEQUFTQSxDQUFDVSxtQkFBbUI7UUFDekQsTUFBTUMsaUJBQWlCRixjQUFjRyxNQUFNLENBQUNDLENBQUFBLFNBQVVBLE9BQU9DLFlBQVksS0FBS1YsS0FBS1csRUFBRTtRQUVyRixLQUFLLE1BQU1GLFVBQVVGLGVBQWdCO1lBQ25DLE1BQU1LLFlBQVksQ0FBQyx3QkFBd0IsRUFBRVosS0FBS1csRUFBRSxDQUFDLENBQUMsRUFBRUYsT0FBT0UsRUFBRSxDQUFDLENBQUMsRUFBRVgsS0FBS2EsU0FBUyxFQUFFQyxVQUFVLENBQUM7WUFFaEcsSUFBSSxNQUFNakIsdUVBQVNBLENBQUNlLFlBQVk7Z0JBQzlCVixRQUFRQyxHQUFHLENBQUMsQ0FBQyw0REFBNEQsRUFBRU0sT0FBT0UsRUFBRSxDQUFDLENBQUM7Z0JBQ3RGO1lBQ0Y7WUFFQSx3Q0FBd0M7WUFDeEMsTUFBTUksd0JBQ0pmLEtBQUtnQixJQUFJLEtBQUtmLGFBQWFlLElBQUksSUFDL0JoQixLQUFLaUIsT0FBTyxLQUFLaEIsYUFBYWdCLE9BQU8sSUFDckNqQixLQUFLa0IsU0FBUyxLQUFLakIsYUFBYWlCLFNBQVMsSUFDekNsQixLQUFLbUIsWUFBWSxLQUFLbEIsYUFBYWtCLFlBQVksSUFDL0NuQixLQUFLSSxJQUFJLEtBQUtILGFBQWFHLElBQUksSUFDL0JKLEtBQUtv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QUFFQyxTQUFjO0lBQzlELE9BQU8sQ0FBQ0QsVUFBVW5ELE1BQU0sRUFBRUMsZ0JBQWdCLE9BQVFtRCxDQUFBQSxVQUFVcEQsTUFBTSxFQUFFQyxnQkFBZ0I7QUFDdEY7QUFFTyxTQUFTMEQsZ0JBQWdCUixTQUFjLEVBQUVDLFNBQWM7SUFDNUQsT0FBTzlDLEtBQUtDLFNBQVMsQ0FBQzRDLFVBQVU5QyxLQUFLLE1BQU1DLEtBQUtDLFNBQVMsQ0FBQzZDLFVBQVUvQyxLQUFLO0FBQzNFIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vdGhlZ2FtZS1hZG1pbi8uL3dvcmtmbG93cy91cGRhdGUtcHJvcGFnYXRpb24tdXRpbHMudHM/ZDI4NCJdLCJzb3VyY2VzQ29udGVudCI6WyIvLyB3b3JrZmxvd3MvdXBkYXRlLXByb3BhZ2F0aW9uLXV0aWxzLnRzXHJcbi8vIENvbXByZWhlbnNpdmUgdXBkYXRlIHByb3BhZ2F0aW9uIGFjcm9zcyBBTEwgZW50aXR5IHJlbGF0aW9uc2hpcHNcclxuXHJcbmltcG9ydCB0eXBlIHsgVGFzaywgSXRlbSwgU2FsZSwgRmluYW5jaWFsUmVjb3JkLCBDaGFyYWN0ZXIsIFBsYXllciB9IGZyb20gJ0AvdHlwZXMvZW50aXRpZXMnO1xyXG5pbXBvcnQgeyBDbGllbnRBUEkgfSBmcm9tICdAL2xpYi9jbGllbnQtYXBpJztcclxuaW1wb3J0IHsgaGFzRWZmZWN0LCBtYXJrRWZmZWN0IH0gZnJvbSAnQC9kYXRhLXN0b3JlL2VmZmVjdHMtcmVnaXN0cnknO1xyXG5cclxuLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxyXG4vLyBUQVNLIOKGkiBGSU5BTkNJQUwgUkVDT1JEIFBST1BBR0FUSU9OXHJcbi8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cclxuXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiB1cGRhdGVGaW5hbmNpYWxSZWNvcmRzRnJvbVRhc2soXHJcbiAgdGFzazogVGFzaywgXHJcbiAgcHJldmlvdXNUYXNrOiBUYXNrXHJcbik6IFByb21pc2U8dm9pZD4ge1xyXG4gIHRyeSB7XHJcbiAgICBjb25zb2xlLmxvZyhgW3VwZGF0ZUZpbmFuY2lhbFJlY29yZHNGcm9tVGFza10gVXBkYXRpbmcgZmluYW5jaWFsIHJlY29yZHMgZm9yIHRhc2s6ICR7dGFzay5uYW1lfWApO1xyXG4gICAgXHJcbiAgICAvLyBGaW5kIGZpbmFuY2lhbCByZWNvcmRzIGNyZWF0ZWQgZnJvbSB0aGlzIHRhc2tcclxuICAgIGNvbnN0IGFsbEZpbmFuY2lhbHMgPSBhd2FpdCBDbGllbnRBUEkuZ2V0RmluYW5jaWFsUmVjb3JkcygpO1xyXG4gICAgY29uc3QgcmVsYXRlZFJlY29yZHMgPSBhbGxGaW5hbmNpYWxzLmZpbHRlcihyZWNvcmQgPT4gcmVjb3JkLnNvdXJjZVRhc2tJZCA9PT0gdGFzay5pZCk7XHJcbiAgICBcclxuICAgIGZvciAoY29uc3QgcmVjb3JkIG9mIHJlbGF0ZWRSZWNvcmRzKSB7XHJcbiAgICAgIGNvbnN0IHVwZGF0ZUtleSA9IGB1cGRhdGVGaW5hbmNpYWxGcm9tVGFzazoke3Rhc2suaWR9OiR7cmVjb3JkLmlkfToke3Rhc2sudXBkYXRlZEF0Py5nZXRUaW1lKCl9YDtcclxuICAgICAgXHJcbiAgICAgIGlmIChhd2FpdCBoYXNFZmZlY3QodXBkYXRlS2V5KSkge1xyXG4gICAgICAgIGNvbnNvbGUubG9nKGBbdXBkYXRlRmluYW5jaWFsUmVjb3Jkc0Zyb21UYXNrXSDij63vuI8gQWxyZWFkeSB1cGRhdGVkIHJlY29yZDogJHtyZWNvcmQuaWR9YCk7XHJcbiAgICAgICAgY29udGludWU7XHJcbiAgICAgIH1cclxuICAgICAgXHJcbiAgICAgIC8vIENoZWNrIGlmIGZpbmFuY2lhbCBwcm9wZXJ0aWVzIGNoYW5nZWRcclxuICAgICAgY29uc3QgZmluYW5jaWFsUHJvcHNDaGFuZ2VkID0gXHJcbiAgICAgICAgdGFzay5jb3N0ICE9PSBwcmV2aW91c1Rhc2suY29zdCB8fFxyXG4gICAgICAgIHRhc2sucmV2ZW51ZSAhPT0gcHJldmlvdXNUYXNrLnJldmVudWUgfHxcclxuICAgICAgICB0YXNrLmlzTm90UGFpZCAhPT0gcHJldmlvdXNUYXNrLmlzTm90UGFpZCB8fFxyXG4gICAgICAgIHRhc2suaXNOb3RDaGFyZ2VkICE9PSBwcmV2aW91c1Rhc2suaXNOb3RDaGFyZ2VkIHx8XHJcbiAgICAgICAgdGFzay5uYW1lICE9PSBwcmV2aW91c1Rhc2submFtZSB8fFxyXG4gICAgICAgIHRhc2suc3RhdGlvbiAhPT0gcHJldmlvdXNUYXNrLnN0YXRpb247XHJcbiAgICAgIFxyXG4gICAgICBpZiAoZmluYW5jaWFsUHJvcHNDaGFuZ2VkKSB7XHJcbiAgICAgICAgY29uc3QgdXBkYXRlZFJlY29yZCA9IHtcclxuICAgICAgICAgIC4uLnJlY29yZCxcclxuICAgICAgICAgIGNvc3Q6IHRhc2suY29zdCxcclxuICAgICAgICAgIHJldmVudWU6IHRhc2sucmV2ZW51ZSxcclxuICAgICAgICAgIGlzTm90UGFpZDogdGFzay5pc05vdFBhaWQsXHJcbiAgICAgICAgICBpc05vdENoYXJnZWQ6IHRhc2suaXNOb3RDaGFyZ2VkLFxyXG4gICAgICAgICAgbmFtZTogdGFzay5uYW1lLFxyXG4gICAgICAgICAgc3RhdGlvbjogdGFzay5zdGF0aW9uLFxyXG4gICAgICAgICAgdXBkYXRlZEF0OiBuZXcgRGF0ZSgpXHJcbiAgICAgICAgfTtcclxuICAgICAgICBcclxuICAgICAgICBhd2FpdCBDbGllbnRBUEkudXBzZXJ0RmluYW5jaWFsUmVjb3JkKHVwZGF0ZWRSZWNvcmQpO1xyXG4gICAgICAgIGF3YWl0IG1hcmtFZmZlY3QodXBkYXRlS2V5KTtcclxuICAgICAgICBcclxuICAgICAgICBjb25zb2xlLmxvZyhgW3VwZGF0ZUZpbmFuY2lhbFJlY29yZHNGcm9tVGFza10g4pyFIFVwZGF0ZWQgZmluYW5jaWFsIHJlY29yZDogJHtyZWNvcmQuaWR9YCk7XHJcbiAgICAgIH1cclxuICAgIH1cclxuICB9IGNhdGNoIChlcnJvcikge1xyXG4gICAgY29uc29sZS5lcnJvcihgW3VwZGF0ZUZpbmFuY2lhbFJlY29yZHNGcm9tVGFza10gRXJyb3IgdXBkYXRpbmcgZmluYW5jaWFsIHJlY29yZHM6YCwgZXJyb3IpO1xyXG4gIH1cclxufVxyXG5cclxuLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxyXG4vLyBGSU5BTkNJQUwgUkVDT1JEIOKGkiBUQVNLIFBST1BBR0FUSU9OXHJcbi8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cclxuXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiB1cGRhdGVUYXNrc0Zyb21GaW5hbmNpYWxSZWNvcmQoXHJcbiAgcmVjb3JkOiBGaW5hbmNpYWxSZWNvcmQsXHJcbiAgcHJldmlvdXNSZWNvcmQ6IEZpbmFuY2lhbFJlY29yZFxyXG4pOiBQcm9taXNlPHZvaWQ+IHtcclxuICB0cnkge1xyXG4gICAgY29uc29sZS5sb2coYFt1cGRhdGVUYXNrc0Zyb21GaW5hbmNpYWxSZWNvcmRdIFVwZGF0aW5nIHRhc2tzIGZvciBmaW5hbmNpYWwgcmVjb3JkOiAke3JlY29yZC5uYW1lfWApO1xyXG4gICAgXHJcbiAgICAvLyBGaW5kIHRhc2tzIHRoYXQgY3JlYXRlZCB0aGlzIGZpbmFuY2lhbCByZWNvcmRcclxuICAgIGNvbnN0IGFsbFRhc2tzID0gYXdhaXQgQ2xpZW50QVBJLmdldFRhc2tzKCk7XHJcbiAgICBjb25zdCByZWxhdGVkVGFza3MgPSBhbGxUYXNrcy5maWx0ZXIodGFzayA9PiB0YXNrLmlkID09PSByZWNvcmQuc291cmNlVGFza0lkKTtcclxuICAgIFxyXG4gICAgZm9yIChjb25zdCB0YXNrIG9mIHJlbGF0ZWRUYXNrcykge1xyXG4gICAgICBjb25zdCB1cGRhdGVLZXkgPSBgdXBkYXRlVGFza0Zyb21GaW5hbmNpYWw6JHtyZWNvcmQuaWR9OiR7dGFzay5pZH06JHtyZWNvcmQudXBkYXRlZEF0Py5nZXRUaW1lKCl9YDtcclxuICAgICAgXHJcbiAgICAgIGlmIChhd2FpdCBoYXNFZmZlY3QodXBkYXRlS2V5KSkge1xyXG4gICAgICAgIGNvbnNvbGUubG9nKGBbdXBkYXRlVGFza3NGcm9tRmluYW5jaWFsUmVjb3JkXSDij63vuI8gQWxyZWFkeSB1cGRhdGVkIHRhc2s6ICR7dGFzay5pZH1gKTtcclxuICAgICAgICBjb250aW51ZTtcclxuICAgICAgfVxyXG4gICAgICBcclxuICAgICAgLy8gQ2hlY2sgaWYgZmluYW5jaWFsIHByb3BlcnRpZXMgY2hhbmdlZFxyXG4gICAgICBjb25zdCBmaW5hbmNpYWxQcm9wc0NoYW5nZWQgPSBcclxuICAgICAgICByZWNvcmQuY29zdCAhPT0gcHJldmlvdXNSZWNvcmQuY29zdCB8fFxyXG4gICAgICAgIHJlY29yZC5yZXZlbnVlICE9PSBwcmV2aW91c1JlY29yZC5yZXZlbnVlIHx8XHJcbiAgICAgICAgcmVjb3JkLmlzTm90UGFpZCAhPT0gcHJldmlvdXNSZWNvcmQuaXNOb3RQYWlkIHx8XHJcbiAgICAgICAgcmVjb3JkLmlzTm90Q2hhcmdlZCAhPT0gcHJldmlvdXNSZWNvcmQuaXNOb3RDaGFyZ2VkIHx8XHJcbiAgICAgICAgcmVjb3JkLm5hbWUgIT09IHByZXZpb3VzUmVjb3JkLm5hbWUgfHxcclxuICAgICAgICByZWNvcmQuc3RhdGlvbiAhPT0gcHJldmlvdXNSZWNvcmQuc3RhdGlvbjtcclxuICAgICAgXHJcbiAgICAgIGlmIChmaW5hbmNpYWxQcm9wc0NoYW5nZWQpIHtcclxuICAgICAgICBjb25zdCB1cGRhdGVkVGFzayA9IHtcclxuICAgICAgICAgIC4uLnRhc2ssXHJcbiAgICAgICAgICBjb3N0OiByZWNvcmQuY29zdCxcclxuICAgICAgICAgIHJldmVudWU6IHJlY29yZC5yZXZlbnVlLFxyXG4gICAgICAgICAgaXNOb3RQYWlkOiByZWNvcmQuaXNOb3RQYWlkLFxyXG4gICAgICAgICAgaXNOb3RDaGFyZ2VkOiByZWNvcmQuaXNOb3RDaGFyZ2VkLFxyXG4gICAgICAgICAgbmFtZTogcmVjb3JkLm5hbWUsXHJcbiAgICAgICAgICBzdGF0aW9uOiByZWNvcmQuc3RhdGlvbixcclxuICAgICAgICAgIHVwZGF0ZWRBdDogbmV3IERhdGUoKVxyXG4gICAgICAgIH07XHJcbiAgICAgICAgXHJcbiAgICAgICAgYXdhaXQgQ2xpZW50QVBJLnVwc2VydFRhc2sodXBkYXRlZFRhc2spO1xyXG4gICAgICAgIGF3YWl0IG1hcmtFZmZlY3QodXBkYXRlS2V5KTtcclxuICAgICAgICBcclxuICAgICAgICBjb25zb2xlLmxvZyhgW3VwZGF0ZVRhc2tzRnJvbUZpbmFuY2lhbFJlY29yZF0g4pyFIFVwZGF0ZWQgdGFzazogJHt0YXNrLmlkfWApO1xyXG4gICAgICB9XHJcbiAgICB9XHJcbiAgfSBjYXRjaCAoZXJyb3IpIHtcclxuICAgIGNvbnNvbGUuZXJyb3IoYFt1cGRhdGVUYXNrc0Zyb21GaW5hbmNpYWxSZWNvcmRdIEVycm9yIHVwZGF0aW5nIHRhc2tzOmAsIGVycm9yKTtcclxuICB9XHJcbn1cclxuXHJcbi8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cclxuLy8gVEFTSyDihpIgSVRFTSBQUk9QQUdBVElPTiAoRW5oYW5jZWQpXHJcbi8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cclxuXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiB1cGRhdGVJdGVtc0NyZWF0ZWRCeVRhc2soXHJcbiAgdGFzazogVGFzayxcclxuICBwcmV2aW91c1Rhc2s6IFRhc2tcclxuKTogUHJvbWlzZTx2b2lkPiB7XHJcbiAgdHJ5IHtcclxuICAgIGNvbnNvbGUubG9nKGBbdXBkYXRlSXRlbXNDcmVhdGVkQnlUYXNrXSBVcGRhdGluZyBpdGVtcyBmb3IgdGFzazogJHt0YXNrLm5hbWV9YCk7XHJcbiAgICBcclxuICAgIC8vIEZpbmQgaXRlbXMgY3JlYXRlZCBmcm9tIHRoaXMgdGFza1xyXG4gICAgY29uc3QgYWxsSXRlbXMgPSBhd2FpdCBDbGllbnRBUEkuZ2V0SXRlbXMoKTtcclxuICAgIGNvbnN0IHJlbGF0ZWRJdGVtcyA9IGFsbEl0ZW1zLmZpbHRlcihpdGVtID0+IGl0ZW0uc291cmNlVGFza0lkID09PSB0YXNrLmlkKTtcclxuICAgIFxyXG4gICAgZm9yIChjb25zdCBpdGVtIG9mIHJlbGF0ZWRJdGVtcykge1xyXG4gICAgICBjb25zdCB1cGRhdGVLZXkgPSBgdXBkYXRlSXRlbUZyb21UYXNrOiR7dGFzay5pZH06JHtpdGVtLmlkfToke3Rhc2sudXBkYXRlZEF0Py5nZXRUaW1lKCl9YDtcclxuICAgICAgXHJcbiAgICAgIGlmIChhd2FpdCBoYXNFZmZlY3QodXBkYXRlS2V5KSkge1xyXG4gICAgICAgIGNvbnNvbGUubG9nKGBbdXBkYXRlSXRlbXNDcmVhdGVkQnlUYXNrXSDij63vuI8gQWxyZWFkeSB1cGRhdGVkIGl0ZW06ICR7aXRlbS5pZH1gKTtcclxuICAgICAgICBjb250aW51ZTtcclxuICAgICAgfVxyXG4gICAgICBcclxuICAgICAgLy8gQ2hlY2sgaWYgb3V0cHV0IHByb3BlcnRpZXMgY2hhbmdlZFxyXG4gICAgICBjb25zdCBvdXRwdXRQcm9wc0NoYW5nZWQgPSBcclxuICAgICAgICB0YXNrLm91dHB1dFF1YW50aXR5ICE9PSBwcmV2aW91c1Rhc2sub3V0cHV0UXVhbnRpdHkgfHxcclxuICAgICAgICB0YXNrLm91dHB1dEl0ZW1OYW1lICE9PSBwcmV2aW91c1Rhc2sub3V0cHV0SXRlbU5hbWUgfHxcclxuICAgICAgICB0YXNrLm91dHB1dFVuaXRDb3N0ICE9PSBwcmV2aW91c1Rhc2sub3V0cHV0VW5pdENvc3QgfHxcclxuICAgICAgICB0YXNrLm91dHB1dEl0ZW1QcmljZSAhPT0gcHJldmlvdXNUYXNrLm91dHB1dEl0ZW1QcmljZSB8fFxyXG4gICAgICAgIHRhc2suc3RhdGlvbiAhPT0gcHJldmlvdXNUYXNrLnN0YXRpb247XHJcbiAgICAgIFxyXG4gICAgICBpZiAob3V0cHV0UHJvcHNDaGFuZ2VkKSB7XHJcbiAgICAgICAgY29uc3QgdXBkYXRlZEl0ZW0gPSB7XHJcbiAgICAgICAgICAuLi5pdGVtLFxyXG4gICAgICAgICAgbmFtZTogdGFzay5vdXRwdXRJdGVtTmFtZSB8fCBpdGVtLm5hbWUsXHJcbiAgICAgICAgICB1bml0Q29zdDogdGFzay5vdXRwdXRVbml0Q29zdCB8fCBpdGVtLnVuaXRDb3N0LFxyXG4gICAgICAgICAgcHJpY2U6IHRhc2sub3V0cHV0SXRlbVByaWNlIHx8IGl0ZW0ucHJpY2UsXHJcbiAgICAgICAgICBzdGF0aW9uOiB0YXNrLnN0YXRpb24gfHwgaXRlbS5zdGF0aW9uLFxyXG4gICAgICAgICAgdXBkYXRlZEF0OiBuZXcgRGF0ZSgpXHJcbiAgICAgICAgfTtcclxuICAgICAgICBcclxuICAgICAgICAvLyBVcGRhdGUgc3RvY2sgcXVhbnRpdHkgaWYgaXQgY2hhbmdlZFxyXG4gICAgICAgIGlmICh0YXNrLm91dHB1dFF1YW50aXR5ICE9PSBwcmV2aW91c1Rhc2sub3V0cHV0UXVhbnRpdHkpIHtcclxuICAgICAgICAgIGNvbnN0IHF1YW50aXR5RGlmZiA9ICh0YXNrLm91dHB1dFF1YW50aXR5IHx8IDApIC0gKHByZXZpb3VzVGFzay5vdXRwdXRRdWFudGl0eSB8fCAwKTtcclxuICAgICAgICAgIGlmIChxdWFudGl0eURpZmYgIT09IDApIHtcclxuICAgICAgICAgICAgLy8gVXBkYXRlIHRoZSBmaXJzdCBzdG9jayBwb2ludCAob3IgY3JlYXRlIG9uZSBpZiBub25lIGV4aXN0cylcclxuICAgICAgICAgICAgaWYgKHVwZGF0ZWRJdGVtLnN0b2NrICYmIHVwZGF0ZWRJdGVtLnN0b2NrLmxlbmd0aCA+IDApIHtcclxuICAgICAgICAgICAgICB1cGRhdGVkSXRlbS5zdG9ja1swXS5xdWFudGl0eSArPSBxdWFudGl0eURpZmY7XHJcbiAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIHVwZGF0ZWRJdGVtLnN0b2NrID0gW3tcclxuICAgICAgICAgICAgICBzaXRlSWQ6IHRhc2suc2l0ZUlkIHx8ICdkZWZhdWx0JyxcclxuICAgICAgICAgICAgICBxdWFudGl0eTogcXVhbnRpdHlEaWZmXHJcbiAgICAgICAgICAgIH1dO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIFxyXG4gICAgICAgIGF3YWl0IENsaWVudEFQSS51cHNlcnRJdGVtKHVwZGF0ZWRJdGVtKTtcclxuICAgICAgICBhd2FpdCBtYXJrRWZmZWN0KHVwZGF0ZUtleSk7XHJcbiAgICAgICAgXHJcbiAgICAgICAgY29uc29sZS5sb2coYFt1cGRhdGVJdGVtc0NyZWF0ZWRCeVRhc2tdIOKchSBVcGRhdGVkIGl0ZW06ICR7aXRlbS5pZH1gKTtcclxuICAgICAgfVxyXG4gICAgfVxyXG4gIH0gY2F0Y2ggKGVycm9yKSB7XHJcbiAgICBjb25zb2xlLmVycm9yKGBbdXBkYXRlSXRlbXNDcmVhdGVkQnlUYXNrXSBFcnJvciB1cGRhdGluZyBpdGVtczpgLCBlcnJvcik7XHJcbiAgfVxyXG59XHJcblxyXG4vLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XHJcbi8vIEZJTkFOQ0lBTCBSRUNPUkQg4oaSIElURU0gUFJPUEFHQVRJT04gKEVuaGFuY2VkKVxyXG4vLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XHJcblxyXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gdXBkYXRlSXRlbXNDcmVhdGVkQnlSZWNvcmQoXHJcbiAgcmVjb3JkOiBGaW5hbmNpYWxSZWNvcmQsXHJcbiAgcHJldmlvdXNSZWNvcmQ6IEZpbmFuY2lhbFJlY29yZFxyXG4pOiBQcm9taXNlPHZvaWQ+IHtcclxuICB0cnkge1xyXG4gICAgY29uc29sZS5sb2coYFt1cGRhdGVJdGVtc0NyZWF0ZWRCeVJlY29yZF0gVXBkYXRpbmcgaXRlbXMgZm9yIGZpbmFuY2lhbCByZWNvcmQ6ICR7cmVjb3JkLm5hbWV9YCk7XHJcbiAgICBcclxuICAgIC8vIEZpbmQgaXRlbXMgY3JlYXRlZCBmcm9tIHRoaXMgZmluYW5jaWFsIHJlY29yZFxyXG4gICAgY29uc3QgYWxsSXRlbXMgPSBhd2FpdCBDbGllbnRBUEkuZ2V0SXRlbXMoKTtcclxuICAgIGNvbnN0IHJlbGF0ZWRJdGVtcyA9IGFsbEl0ZW1zLmZpbHRlcihpdGVtID0+IGl0ZW0uc291cmNlUmVjb3JkSWQgPT09IHJlY29yZC5pZCk7XHJcbiAgICBcclxuICAgIGZvciAoY29uc3QgaXRlbSBvZiByZWxhdGVkSXRlbXMpIHtcclxuICAgICAgY29uc3QgdXBkYXRlS2V5ID0gYHVwZGF0ZUl0ZW1Gcm9tUmVjb3JkOiR7cmVjb3JkLmlkfToke2l0ZW0uaWR9OiR7cmVjb3JkLnVwZGF0ZWRBdD8uZ2V0VGltZSgpfWA7XHJcbiAgICAgIFxyXG4gICAgICBpZiAoYXdhaXQgaGFzRWZmZWN0KHVwZGF0ZUtleSkpIHtcclxuICAgICAgICBjb25zb2xlLmxvZyhgW3VwZGF0ZUl0ZW1zQ3JlYXRlZEJ5UmVjb3JkXSDij63vuI8gQWxyZWFkeSB1cGRhdGVkIGl0ZW06ICR7aXRlbS5pZH1gKTtcclxuICAgICAgICBjb250aW51ZTtcclxuICAgICAgfVxyXG4gICAgICBcclxuICAgICAgLy8gQ2hlY2sgaWYgb3V0cHV0IHByb3BlcnRpZXMgY2hhbmdlZFxyXG4gICAgICBjb25zdCBvdXRwdXRQcm9wc0NoYW5nZWQgPSBcclxuICAgICAgICByZWNvcmQub3V0cHV0UXVhbnRpdHkgIT09IHByZXZpb3VzUmVjb3JkLm91dHB1dFF1YW50aXR5IHx8XHJcbiAgICAgICAgcmVjb3JkLm91dHB1dEl0ZW1OYW1lICE9PSBwcmV2aW91c1JlY29yZC5vdXRwdXRJdGVtTmFtZSB8fFxyXG4gICAgICAgIHJlY29yZC5vdXRwdXRVbml0Q29zdCAhPT0gcHJldmlvdXNSZWNvcmQub3V0cHV0VW5pdENvc3QgfHxcclxuICAgICAgICByZWNvcmQub3V0cHV0SXRlbVByaWNlICE9PSBwcmV2aW91c1JlY29yZC5vdXRwdXRJdGVtUHJpY2UgfHxcclxuICAgICAgICByZWNvcmQuc3RhdGlvbiAhPT0gcHJldmlvdXNSZWNvcmQuc3RhdGlvbjtcclxuICAgICAgXHJcbiAgICAgIGlmIChvdXRwdXRQcm9wc0NoYW5nZWQpIHtcclxuICAgICAgICBjb25zdCB1cGRhdGVkSXRlbSA9IHtcclxuICAgICAgICAgIC4uLml0ZW0sXHJcbiAgICAgICAgICBuYW1lOiByZWNvcmQub3V0cHV0SXRlbU5hbWUgfHwgaXRlbS5uYW1lLFxyXG4gICAgICAgICAgdW5pdENvc3Q6IHJlY29yZC5vdXRwdXRVbml0Q29zdCB8fCBpdGVtLnVuaXRDb3N0LFxyXG4gICAgICAgICAgcHJpY2U6IHJlY29yZC5vdXRwdXRJdGVtUHJpY2UgfHwgaXRlbS5wcmljZSxcclxuICAgICAgICAgIHN0YXRpb246IHJlY29yZC5zdGF0aW9uIHx8IGl0ZW0uc3RhdGlvbixcclxuICAgICAgICAgIHVwZGF0ZWRBdDogbmV3IERhdGUoKVxyXG4gICAgICAgIH07XHJcbiAgICAgICAgXHJcbiAgICAgICAgLy8gVXBkYXRlIHN0b2NrIHF1YW50aXR5IGlmIGl0IGNoYW5nZWRcclxuICAgICAgICBpZiAocmVjb3JkLm91dHB1dFF1YW50aXR5ICE9PSBwcmV2aW91c1JlY29yZC5vdXRwdXRRdWFudGl0eSkge1xyXG4gICAgICAgICAgY29uc3QgcXVhbnRpdHlEaWZmID0gKHJlY29yZC5vdXRwdXRRdWFudGl0eSB8fCAwKSAtIChwcmV2aW91c1JlY29yZC5vdXRwdXRRdWFudGl0eSB8fCAwKTtcclxuICAgICAgICAgIGlmIChxdWFudGl0eURpZmYgIT09IDApIHtcclxuICAgICAgICAgICAgLy8gVXBkYXRlIHRoZSBmaXJzdCBzdG9jayBwb2ludCAob3IgY3JlYXRlIG9uZSBpZiBub25lIGV4aXN0cylcclxuICAgICAgICAgICAgaWYgKHVwZGF0ZWRJdGVtLnN0b2NrICYmIHVwZGF0ZWRJdGVtLnN0b2NrLmxlbmd0aCA+IDApIHtcclxuICAgICAgICAgICAgICB1cGRhdGVkSXRlbS5zdG9ja1swXS5xdWFudGl0eSArPSBxdWFudGl0eURpZmY7XHJcbiAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgdXBkYXRlZEl0ZW0uc3RvY2sgPSBbe1xyXG4gICAgICAgICAgICAgICAgc2l0ZUlkOiByZWNvcmQuc2l0ZUlkIHx8ICdkZWZhdWx0JyxcclxuICAgICAgICAgICAgICAgIHF1YW50aXR5OiBxdWFudGl0eURpZmZcclxuICAgICAgICAgICAgICB9XTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICBcclxuICAgICAgICBhd2FpdCBDbGllbnRBUEkudXBzZXJ0SXRlbSh1cGRhdGVkSXRlbSk7XHJcbiAgICAgICAgYXdhaXQgbWFya0VmZmVjdCh1cGRhdGVLZXkpO1xyXG4gICAgICAgIFxyXG4gICAgICAgIGNvbnNvbGUubG9nKGBbdXBkYXRlSXRlbXNDcmVhdGVkQnlSZWNvcmRdIOKchSBVcGRhdGVkIGl0ZW06ICR7aXRlbS5pZH1gKTtcclxuICAgICAgfVxyXG4gICAgfVxyXG4gIH0gY2F0Y2ggKGVycm9yKSB7XHJcbiAgICBjb25zb2xlLmVycm9yKGBbdXBkYXRlSXRlbXNDcmVhdGVkQnlSZWNvcmRdIEVycm9yIHVwZGF0aW5nIGl0ZW1zOmAsIGVycm9yKTtcclxuICB9XHJcbn1cclxuXHJcbi8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cclxuLy8gU0FMRSDihpIgRklOQU5DSUFMIFJFQ09SRCBQUk9QQUdBVElPTlxyXG4vLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XHJcblxyXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gdXBkYXRlRmluYW5jaWFsUmVjb3Jkc0Zyb21TYWxlKFxyXG4gIHNhbGU6IFNhbGUsXHJcbiAgcHJldmlvdXNTYWxlOiBTYWxlXHJcbik6IFByb21pc2U8dm9pZD4ge1xyXG4gIHRyeSB7XHJcbiAgICBjb25zb2xlLmxvZyhgW3VwZGF0ZUZpbmFuY2lhbFJlY29yZHNGcm9tU2FsZV0gVXBkYXRpbmcgZmluYW5jaWFsIHJlY29yZHMgZm9yIHNhbGU6ICR7c2FsZS5uYW1lfWApO1xyXG4gICAgXHJcbiAgICAvLyBGaW5kIGZpbmFuY2lhbCByZWNvcmRzIGNyZWF0ZWQgZnJvbSB0aGlzIHNhbGVcclxuICAgIGNvbnN0IGFsbEZpbmFuY2lhbHMgPSBhd2FpdCBDbGllbnRBUEkuZ2V0RmluYW5jaWFsUmVjb3JkcygpO1xyXG4gICAgY29uc3QgcmVsYXRlZFJlY29yZHMgPSBhbGxGaW5hbmNpYWxzLmZpbHRlcihyZWNvcmQgPT4gcmVjb3JkLnNvdXJjZVNhbGVJZCA9PT0gc2FsZS5pZCk7XHJcbiAgICBcclxuICAgIGZvciAoY29uc3QgcmVjb3JkIG9mIHJlbGF0ZWRSZWNvcmRzKSB7XHJcbiAgICAgIGNvbnN0IHVwZGF0ZUtleSA9IGB1cGRhdGVGaW5hbmNpYWxGcm9tU2FsZToke3NhbGUuaWR9OiR7cmVjb3JkLmlkfToke3NhbGUudXBkYXRlZEF0Py5nZXRUaW1lKCl9YDtcclxuICAgICAgXHJcbiAgICAgIGlmIChhd2FpdCBoYXNFZmZlY3QodXBkYXRlS2V5KSkge1xyXG4gICAgICAgIGNvbnNvbGUubG9nKGBbdXBkYXRlRmluYW5jaWFsUmVjb3Jkc0Zyb21TYWxlXSDij63vuI8gQWxyZWFkeSB1cGRhdGVkIHJlY29yZDogJHtyZWNvcmQuaWR9YCk7XHJcbiAgICAgICAgY29udGludWU7XHJcbiAgICAgIH1cclxuICAgICAgXHJcbiAgICAgIC8vIENoZWNrIGlmIHJldmVudWUgcHJvcGVydGllcyBjaGFuZ2VkXHJcbiAgICAgIGNvbnN0IHJldmVudWVQcm9wc0NoYW5nZWQgPSBcclxuICAgICAgICBzYWxlLnRvdGFscz8udG90YWxSZXZlbnVlICE9PSBwcmV2aW91c1NhbGUudG90YWxzPy50b3RhbFJldmVudWUgfHxcclxuICAgICAgICBzYWxlLmlzTm90UGFpZCAhPT0gcHJldmlvdXNTYWxlLmlzTm90UGFpZCB8fFxyXG4gICAgICAgIHNhbGUuc3RhdHVzICE9PSBwcmV2aW91c1NhbGUuc3RhdHVzO1xyXG4gICAgICBcclxuICAgICAgaWYgKHJldmVudWVQcm9wc0NoYW5nZWQpIHtcclxuICAgICAgICBjb25zdCB1cGRhdGVkUmVjb3JkID0ge1xyXG4gICAgICAgICAgLi4ucmVjb3JkLFxyXG4gICAgICAgICAgcmV2ZW51ZTogc2FsZS50b3RhbHM/LnRvdGFsUmV2ZW51ZSB8fCAwLFxyXG4gICAgICAgICAgaXNOb3RQYWlkOiBzYWxlLmlzTm90UGFpZCxcclxuICAgICAgICAgIGlzTm90Q2hhcmdlZDogc2FsZS5zdGF0dXMgIT09ICdDSEFSR0VEJyxcclxuICAgICAgICAgIHVwZGF0ZWRBdDogbmV3IERhdGUoKVxyXG4gICAgICAgIH07XHJcbiAgICAgICAgXHJcbiAgICAgICAgYXdhaXQgQ2xpZW50QVBJLnVwc2VydEZpbmFuY2lhbFJlY29yZCh1cGRhdGVkUmVjb3JkKTtcclxuICAgICAgICBhd2FpdCBtYXJrRWZmZWN0KHVwZGF0ZUtleSk7XHJcbiAgICAgICAgXHJcbiAgICAgICAgY29uc29sZS5sb2coYFt1cGRhdGVGaW5hbmNpYWxSZWNvcmRzRnJvbVNhbGVdIOKchSBVcGRhdGVkIGZpbmFuY2lhbCByZWNvcmQ6ICR7cmVjb3JkLmlkfWApO1xyXG4gICAgICB9XHJcbiAgICB9XHJcbiAgfSBjYXRjaCAoZXJyb3IpIHtcclxuICAgIGNvbnNvbGUuZXJyb3IoYFt1cGRhdGVGaW5hbmNpYWxSZWNvcmRzRnJvbVNhbGVdIEVycm9yIHVwZGF0aW5nIGZpbmFuY2lhbCByZWNvcmRzOmAsIGVycm9yKTtcclxuICB9XHJcbn1cclxuXHJcbi8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cclxuLy8gU0FMRSDihpIgSVRFTSBQUk9QQUdBVElPTiAoU3RvY2sgVXBkYXRlcylcclxuLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIHVwZGF0ZUl0ZW1zRnJvbVNhbGUoXHJcbiAgc2FsZTogU2FsZSxcclxuICBwcmV2aW91c1NhbGU6IFNhbGVcclxuKTogUHJvbWlzZTx2b2lkPiB7XHJcbiAgdHJ5IHtcclxuICAgIGNvbnNvbGUubG9nKGBbdXBkYXRlSXRlbXNGcm9tU2FsZV0gVXBkYXRpbmcgaXRlbXMgZm9yIHNhbGU6ICR7c2FsZS5uYW1lfWApO1xyXG4gICAgXHJcbiAgICAvLyBDaGVjayBpZiBzYWxlIGxpbmVzIGNoYW5nZWRcclxuICAgIGNvbnN0IGxpbmVzQ2hhbmdlZCA9IFxyXG4gICAgICBzYWxlLmxpbmVzPy5sZW5ndGggIT09IHByZXZpb3VzU2FsZS5saW5lcz8ubGVuZ3RoIHx8XHJcbiAgICAgIEpTT04uc3RyaW5naWZ5KHNhbGUubGluZXMpICE9PSBKU09OLnN0cmluZ2lmeShwcmV2aW91c1NhbGUubGluZXMpO1xyXG4gICAgXHJcbiAgICBpZiAoIWxpbmVzQ2hhbmdlZCkge1xyXG4gICAgICBjb25zb2xlLmxvZyhgW3VwZGF0ZUl0ZW1zRnJvbVNhbGVdIE5vIGxpbmUgY2hhbmdlcyBkZXRlY3RlZGApO1xyXG4gICAgICByZXR1cm47XHJcbiAgICB9XHJcbiAgICBcclxuICAgIC8vIFByb2Nlc3MgZWFjaCBzYWxlIGxpbmVcclxuICAgIGZvciAoY29uc3QgbGluZSBvZiBzYWxlLmxpbmVzIHx8IFtdKSB7XHJcbiAgICAgIGlmIChsaW5lLmtpbmQgPT09ICdpdGVtJyAmJiAnaXRlbUlkJyBpbiBsaW5lICYmIGxpbmUuaXRlbUlkKSB7XHJcbiAgICAgICAgY29uc3QgdXBkYXRlS2V5ID0gYHVwZGF0ZUl0ZW1Gcm9tU2FsZToke3NhbGUuaWR9OiR7bGluZS5pdGVtSWR9OiR7c2FsZS51cGRhdGVkQXQ/LmdldFRpbWUoKX1gO1xyXG4gICAgICAgIFxyXG4gICAgICAgIGlmIChhd2FpdCBoYXNFZmZlY3QodXBkYXRlS2V5KSkge1xyXG4gICAgICAgICAgY29uc29sZS5sb2coYFt1cGRhdGVJdGVtc0Zyb21TYWxlXSDij63vuI8gQWxyZWFkeSB1cGRhdGVkIGl0ZW06ICR7bGluZS5pdGVtSWR9YCk7XHJcbiAgICAgICAgICBjb250aW51ZTtcclxuICAgICAgICB9XHJcbiAgICAgICAgXHJcbiAgICAgICAgLy8gR2V0IHRoZSBpdGVtXHJcbiAgICAgICAgY29uc3QgaXRlbSA9IGF3YWl0IENsaWVudEFQSS5nZXRJdGVtQnlJZChsaW5lLml0ZW1JZCk7XHJcbiAgICAgICAgaWYgKCFpdGVtKSB7XHJcbiAgICAgICAgICBjb25zb2xlLndhcm4oYFt1cGRhdGVJdGVtc0Zyb21TYWxlXSBJdGVtIG5vdCBmb3VuZDogJHtsaW5lLml0ZW1JZH1gKTtcclxuICAgICAgICAgIGNvbnRpbnVlO1xyXG4gICAgICAgIH1cclxuICAgICAgICBcclxuICAgICAgICAvLyBVcGRhdGUgcXVhbnRpdHkgc29sZFxyXG4gICAgICAgIGNvbnN0IHVwZGF0ZWRJdGVtID0ge1xyXG4gICAgICAgICAgLi4uaXRlbSxcclxuICAgICAgICAgIHF1YW50aXR5U29sZDogKGl0ZW0ucXVhbnRpdHlTb2xkIHx8IDApICsgKGxpbmUucXVhbnRpdHkgfHwgMCksXHJcbiAgICAgICAgICB1cGRhdGVkQXQ6IG5ldyBEYXRlKClcclxuICAgICAgICB9O1xyXG4gICAgICAgIFxyXG4gICAgICAgIGF3YWl0IENsaWVudEFQSS51cHNlcnRJdGVtKHVwZGF0ZWRJdGVtKTtcclxuICAgICAgICBhd2FpdCBtYXJrRWZmZWN0KHVwZGF0ZUtleSk7XHJcbiAgICAgICAgXHJcbiAgICAgICAgY29uc29sZS5sb2coYFt1cGRhdGVJdGVtc0Zyb21TYWxlXSDinIUgVXBkYXRlZCBpdGVtOiAke2xpbmUuaXRlbUlkfWApO1xyXG4gICAgICB9XHJcbiAgICB9XHJcbiAgfSBjYXRjaCAoZXJyb3IpIHtcclxuICAgIGNvbnNvbGUuZXJyb3IoYFt1cGRhdGVJdGVtc0Zyb21TYWxlXSBFcnJvciB1cGRhdGluZyBpdGVtczpgLCBlcnJvcik7XHJcbiAgfVxyXG59XHJcblxyXG4vLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XHJcbi8vIFRBU0svRklOQU5DSUFML1NBTEUg4oaSIFBMQVlFUiBQUk9QQUdBVElPTiAoUG9pbnRzIERlbHRhKVxyXG4vLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XHJcblxyXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gdXBkYXRlUGxheWVyUG9pbnRzRnJvbVNvdXJjZShcclxuICBzb3VyY2VUeXBlOiAndGFzaycgfCAnZmluYW5jaWFsJyB8ICdzYWxlJyxcclxuICBuZXdTb3VyY2U6IGFueSxcclxuICBvbGRTb3VyY2U6IGFueVxyXG4pOiBQcm9taXNlPHZvaWQ+IHtcclxuICB0cnkge1xyXG4gICAgY29uc29sZS5sb2coYFt1cGRhdGVQbGF5ZXJQb2ludHNGcm9tU291cmNlXSBVcGRhdGluZyBwbGF5ZXIgcG9pbnRzIGZyb20gJHtzb3VyY2VUeXBlfTogJHtuZXdTb3VyY2UubmFtZX1gKTtcclxuICAgIFxyXG4gICAgLy8gQ2FsY3VsYXRlIHBvaW50cyBkZWx0YVxyXG4gICAgbGV0IHBvaW50c0RlbHRhID0geyB4cDogMCwgcnA6IDAsIGZwOiAwLCBocDogMCB9O1xyXG4gICAgXHJcbiAgICBpZiAoc291cmNlVHlwZSA9PT0gJ3Rhc2snIHx8IHNvdXJjZVR5cGUgPT09ICdmaW5hbmNpYWwnKSB7XHJcbiAgICAgIGNvbnN0IG5ld1BvaW50cyA9IG5ld1NvdXJjZS5yZXdhcmRzPy5wb2ludHMgfHwgeyB4cDogMCwgcnA6IDAsIGZwOiAwLCBocDogMCB9O1xyXG4gICAgICBjb25zdCBvbGRQb2ludHMgPSBvbGRTb3VyY2UucmV3YXJkcz8ucG9pbnRzIHx8IHsgeHA6IDAsIHJwOiAwLCBmcDogMCwgaHA6IDAgfTtcclxuICAgICAgXHJcbiAgICAgIHBvaW50c0RlbHRhID0ge1xyXG4gICAgICAgIHhwOiAobmV3UG9pbnRzLnhwIHx8IDApIC0gKG9sZFBvaW50cy54cCB8fCAwKSxcclxuICAgICAgICBycDogKG5ld1BvaW50cy5ycCB8fCAwKSAtIChvbGRQb2ludHMucnAgfHwgMCksXHJcbiAgICAgICAgZnA6IChuZXdQb2ludHMuZnAgfHwgMCkgLSAob2xkUG9pbnRzLmZwIHx8IDApLFxyXG4gICAgICAgIGhwOiAobmV3UG9pbnRzLmhwIHx8IDApIC0gKG9sZFBvaW50cy5ocCB8fCAwKVxyXG4gICAgICB9O1xyXG4gICAgfSBlbHNlIGlmIChzb3VyY2VUeXBlID09PSAnc2FsZScpIHtcclxuICAgICAgLy8gQ2FsY3VsYXRlIHBvaW50cyBmcm9tIHJldmVudWUgKHNpbXBsaWZpZWQpXHJcbiAgICAgIGNvbnN0IG5ld1JldmVudWUgPSBuZXdTb3VyY2UudG90YWxzPy50b3RhbFJldmVudWUgfHwgMDtcclxuICAgICAgY29uc3Qgb2xkUmV2ZW51ZSA9IG9sZFNvdXJjZS50b3RhbHM/LnRvdGFsUmV2ZW51ZSB8fCAwO1xyXG4gICAgICBjb25zdCByZXZlbnVlRGVsdGEgPSBuZXdSZXZlbnVlIC0gb2xkUmV2ZW51ZTtcclxuICAgICAgXHJcbiAgICAgIC8vIENvbnZlcnQgcmV2ZW51ZSB0byBwb2ludHMgKHNpbXBsaWZpZWQgY2FsY3VsYXRpb24pXHJcbiAgICAgIHBvaW50c0RlbHRhID0ge1xyXG4gICAgICAgIHhwOiBNYXRoLmZsb29yKHJldmVudWVEZWx0YSAqIDAuMSksXHJcbiAgICAgICAgcnA6IE1hdGguZmxvb3IocmV2ZW51ZURlbHRhICogMC4wNSksXHJcbiAgICAgICAgZnA6IE1hdGguZmxvb3IocmV2ZW51ZURlbHRhICogMC4wMyksXHJcbiAgICAgICAgaHA6IE1hdGguZmxvb3IocmV2ZW51ZURlbHRhICogMC4wMilcclxuICAgICAgfTtcclxuICAgIH1cclxuICAgIFxyXG4gICAgLy8gU2tpcCBpZiBubyBwb2ludHMgY2hhbmdlXHJcbiAgICBpZiAocG9pbnRzRGVsdGEueHAgPT09IDAgJiYgcG9pbnRzRGVsdGEucnAgPT09IDAgJiYgcG9pbnRzRGVsdGEuZnAgPT09IDAgJiYgcG9pbnRzRGVsdGEuaHAgPT09IDApIHtcclxuICAgICAgY29uc29sZS5sb2coYFt1cGRhdGVQbGF5ZXJQb2ludHNGcm9tU291cmNlXSBObyBwb2ludHMgY2hhbmdlIGRldGVjdGVkYCk7XHJcbiAgICAgIHJldHVybjtcclxuICAgIH1cclxuICAgIFxyXG4gICAgLy8gRmluZCB0aGUgcGxheWVyIChhc3N1bWluZyBzaW5nbGUgcGxheWVyIGZvciBub3cpXHJcbiAgICBjb25zdCBwbGF5ZXJzID0gYXdhaXQgQ2xpZW50QVBJLmdldFBsYXllcnMoKTtcclxuICAgIGNvbnN0IHBsYXllciA9IHBsYXllcnNbMF07IC8vIFNpbXBsaWZpZWQgLSBpbiByZWFsIHN5c3RlbSwgZmluZCBieSBzb3VyY2UgcmVsYXRpb25zaGlwXHJcbiAgICBcclxuICAgIGlmICghcGxheWVyKSB7XHJcbiAgICAgIGNvbnNvbGUud2FybihgW3VwZGF0ZVBsYXllclBvaW50c0Zyb21Tb3VyY2VdIE5vIHBsYXllciBmb3VuZGApO1xyXG4gICAgICByZXR1cm47XHJcbiAgICB9XHJcbiAgICBcclxuICAgIGNvbnN0IHVwZGF0ZUtleSA9IGB1cGRhdGVQbGF5ZXJQb2ludHM6JHtzb3VyY2VUeXBlfToke25ld1NvdXJjZS5pZH06JHtwbGF5ZXIuaWR9OiR7bmV3U291cmNlLnVwZGF0ZWRBdD8uZ2V0VGltZSgpfWA7XHJcbiAgICBcclxuICAgIGlmIChhd2FpdCBoYXNFZmZlY3QodXBkYXRlS2V5KSkge1xyXG4gICAgICBjb25zb2xlLmxvZyhgW3VwZGF0ZVBsYXllclBvaW50c0Zyb21Tb3VyY2VdIOKPre+4jyBBbHJlYWR5IHVwZGF0ZWQgcGxheWVyOiAke3BsYXllci5pZH1gKTtcclxuICAgICAgcmV0dXJuO1xyXG4gICAgfVxyXG4gICAgXHJcbiAgICAvLyBVcGRhdGUgcGxheWVyIHBvaW50c1xyXG4gICAgY29uc3QgdXBkYXRlZFBsYXllciA9IHtcclxuICAgICAgLi4ucGxheWVyLFxyXG4gICAgICBwb2ludHM6IHtcclxuICAgICAgICB4cDogKHBsYXllci5wb2ludHM/LnhwIHx8IDApICsgcG9pbnRzRGVsdGEueHAsXHJcbiAgICAgICAgcnA6IChwbGF5ZXIucG9pbnRzPy5ycCB8fCAwKSArIHBvaW50c0RlbHRhLnJwLFxyXG4gICAgICAgIGZwOiAocGxheWVyLnBvaW50cz8uZnAgfHwgMCkgKyBwb2ludHNEZWx0YS5mcCxcclxuICAgICAgICBocDogKHBsYXllci5wb2ludHM/LmhwIHx8IDApICsgcG9pbnRzRGVsdGEuaHBcclxuICAgICAgfSxcclxuICAgICAgdXBkYXRlZEF0OiBuZXcgRGF0ZSgpXHJcbiAgICB9O1xyXG4gICAgXHJcbiAgICBhd2FpdCBDbGllbnRBUEkudXBzZXJ0UGxheWVyKHVwZGF0ZWRQbGF5ZXIpO1xyXG4gICAgYXdhaXQgbWFya0VmZmVjdCh1cGRhdGVLZXkpO1xyXG4gICAgXHJcbiAgICBjb25zb2xlLmxvZyhgW3VwZGF0ZVBsYXllclBvaW50c0Zyb21Tb3VyY2VdIOKchSBVcGRhdGVkIHBsYXllciBwb2ludHM6ICR7cGxheWVyLmlkfWApO1xyXG4gIH0gY2F0Y2ggKGVycm9yKSB7XHJcbiAgICBjb25zb2xlLmVycm9yKGBbdXBkYXRlUGxheWVyUG9pbnRzRnJvbVNvdXJjZV0gRXJyb3IgdXBkYXRpbmcgcGxheWVyIHBvaW50czpgLCBlcnJvcik7XHJcbiAgfVxyXG59XHJcblxyXG4vLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XHJcbi8vIEZJTkFOQ0lBTCDihpIgQ0hBUkFDVEVSIFBST1BBR0FUSU9OIChKdW5nbGUgQ29pbnMgRGVsdGEpXHJcbi8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cclxuXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiB1cGRhdGVDaGFyYWN0ZXJKdW5nbGVDb2luc0Zyb21SZWNvcmQoXHJcbiAgcmVjb3JkOiBGaW5hbmNpYWxSZWNvcmQsXHJcbiAgcHJldmlvdXNSZWNvcmQ6IEZpbmFuY2lhbFJlY29yZFxyXG4pOiBQcm9taXNlPHZvaWQ+IHtcclxuICB0cnkge1xyXG4gICAgY29uc29sZS5sb2coYFt1cGRhdGVDaGFyYWN0ZXJKdW5nbGVDb2luc0Zyb21SZWNvcmRdIFVwZGF0aW5nIGNoYXJhY3RlciBqdW5nbGUgY29pbnMgZm9yIHJlY29yZDogJHtyZWNvcmQubmFtZX1gKTtcclxuICAgIFxyXG4gICAgLy8gQ2FsY3VsYXRlIGp1bmdsZSBjb2lucyBkZWx0YVxyXG4gICAgY29uc3QgbmV3SnVuZ2xlQ29pbnMgPSByZWNvcmQuanVuZ2xlQ29pbnMgfHwgMDtcclxuICAgIGNvbnN0IG9sZEp1bmdsZUNvaW5zID0gcHJldmlvdXNSZWNvcmQuanVuZ2xlQ29pbnMgfHwgMDtcclxuICAgIGNvbnN0IGp1bmdsZUNvaW5zRGVsdGEgPSBuZXdKdW5nbGVDb2lucyAtIG9sZEp1bmdsZUNvaW5zO1xyXG4gICAgXHJcbiAgICBpZiAoanVuZ2xlQ29pbnNEZWx0YSA9PT0gMCkge1xyXG4gICAgICBjb25zb2xlLmxvZyhgW3VwZGF0ZUNoYXJhY3Rlckp1bmdsZUNvaW5zRnJvbVJlY29yZF0gTm8ganVuZ2xlIGNvaW5zIGNoYW5nZSBkZXRlY3RlZGApO1xyXG4gICAgICByZXR1cm47XHJcbiAgICB9XHJcbiAgICBcclxuICAgIC8vIEZpbmQgY2hhcmFjdGVycyByZWxhdGVkIHRvIHRoaXMgZmluYW5jaWFsIHJlY29yZFxyXG4gICAgY29uc3QgYWxsQ2hhcmFjdGVycyA9IGF3YWl0IENsaWVudEFQSS5nZXRDaGFyYWN0ZXJzKCk7XHJcbiAgICBjb25zdCByZWxhdGVkQ2hhcmFjdGVycyA9IGFsbENoYXJhY3RlcnMuZmlsdGVyKGNoYXIgPT4gXHJcbiAgICAgIGNoYXIuaWQgPT09IHJlY29yZC5jdXN0b21lckNoYXJhY3RlcklkXHJcbiAgICApO1xyXG4gICAgXHJcbiAgICBmb3IgKGNvbnN0IGNoYXJhY3RlciBvZiByZWxhdGVkQ2hhcmFjdGVycykge1xyXG4gICAgICBjb25zdCB1cGRhdGVLZXkgPSBgdXBkYXRlQ2hhcmFjdGVySnVuZ2xlQ29pbnM6JHtyZWNvcmQuaWR9OiR7Y2hhcmFjdGVyLmlkfToke3JlY29yZC51cGRhdGVkQXQ/LmdldFRpbWUoKX1gO1xyXG4gICAgICBcclxuICAgICAgaWYgKGF3YWl0IGhhc0VmZmVjdCh1cGRhdGVLZXkpKSB7XHJcbiAgICAgICAgY29uc29sZS5sb2coYFt1cGRhdGVDaGFyYWN0ZXJKdW5nbGVDb2luc0Zyb21SZWNvcmRdIOKPre+4jyBBbHJlYWR5IHVwZGF0ZWQgY2hhcmFjdGVyOiAke2NoYXJhY3Rlci5pZH1gKTtcclxuICAgICAgICBjb250aW51ZTtcclxuICAgICAgfVxyXG4gICAgICBcclxuICAgICAgLy8gVXBkYXRlIGNoYXJhY3RlciBqdW5nbGUgY29pbnNcclxuICAgICAgY29uc3QgdXBkYXRlZENoYXJhY3RlciA9IHtcclxuICAgICAgICAuLi5jaGFyYWN0ZXIsXHJcbiAgICAgICAganVuZ2xlQ29pbnM6IChjaGFyYWN0ZXIuanVuZ2xlQ29pbnMgfHwgMCkgKyBqdW5nbGVDb2luc0RlbHRhLFxyXG4gICAgICAgIHVwZGF0ZWRBdDogbmV3IERhdGUoKVxyXG4gICAgICB9O1xyXG4gICAgICBcclxuICAgICAgYXdhaXQgQ2xpZW50QVBJLnVwc2VydENoYXJhY3Rlcih1cGRhdGVkQ2hhcmFjdGVyKTtcclxuICAgICAgYXdhaXQgbWFya0VmZmVjdCh1cGRhdGVLZXkpO1xyXG4gICAgICBcclxuICAgICAgY29uc29sZS5sb2coYFt1cGRhdGVDaGFyYWN0ZXJKdW5nbGVDb2luc0Zyb21SZWNvcmRdIOKchSBVcGRhdGVkIGNoYXJhY3RlciBqdW5nbGUgY29pbnM6ICR7Y2hhcmFjdGVyLmlkfWApO1xyXG4gICAgfVxyXG4gIH0gY2F0Y2ggKGVycm9yKSB7XHJcbiAgICBjb25zb2xlLmVycm9yKGBbdXBkYXRlQ2hhcmFjdGVySnVuZ2xlQ29pbnNGcm9tUmVjb3JkXSBFcnJvciB1cGRhdGluZyBjaGFyYWN0ZXIganVuZ2xlIGNvaW5zOmAsIGVycm9yKTtcclxuICB9XHJcbn1cclxuXHJcbi8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cclxuLy8gUFJPUEVSVFkgQ0hBTkdFIERFVEVDVElPTiBIRUxQRVJTXHJcbi8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBoYXNGaW5hbmNpYWxQcm9wc0NoYW5nZWQobmV3RW50aXR5OiBhbnksIG9sZEVudGl0eTogYW55KTogYm9vbGVhbiB7XHJcbiAgcmV0dXJuIChcclxuICAgIG5ld0VudGl0eS5jb3N0ICE9PSBvbGRFbnRpdHkuY29zdCB8fFxyXG4gICAgbmV3RW50aXR5LnJldmVudWUgIT09IG9sZEVudGl0eS5yZXZlbnVlIHx8XHJcbiAgICBuZXdFbnRpdHkuaXNOb3RQYWlkICE9PSBvbGRFbnRpdHkuaXNOb3RQYWlkIHx8XHJcbiAgICBuZXdFbnRpdHkuaXNOb3RDaGFyZ2VkICE9PSBvbGRFbnRpdHkuaXNOb3RDaGFyZ2VkIHx8XHJcbiAgICBuZXdFbnRpdHkubmFtZSAhPT0gb2xkRW50aXR5Lm5hbWUgfHxcclxuICAgIG5ld0VudGl0eS5zdGF0aW9uICE9PSBvbGRFbnRpdHkuc3RhdGlvblxyXG4gICk7XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBoYXNPdXRwdXRQcm9wc0NoYW5nZWQobmV3RW50aXR5OiBhbnksIG9sZEVudGl0eTogYW55KTogYm9vbGVhbiB7XHJcbiAgcmV0dXJuIChcclxuICAgIG5ld0VudGl0eS5vdXRwdXRRdWFudGl0eSAhPT0gb2xkRW50aXR5Lm91dHB1dFF1YW50aXR5IHx8XHJcbiAgICBuZXdFbnRpdHkub3V0cHV0SXRlbU5hbWUgIT09IG9sZEVudGl0eS5vdXRwdXRJdGVtTmFtZSB8fFxyXG4gICAgbmV3RW50aXR5Lm91dHB1dFVuaXRDb3N0ICE9PSBvbGRFbnRpdHkub3V0cHV0VW5pdENvc3QgfHxcclxuICAgIG5ld0VudGl0eS5vdXRwdXRJdGVtUHJpY2UgIT09IG9sZEVudGl0eS5vdXRwdXRJdGVtUHJpY2UgfHxcclxuICAgIG5ld0VudGl0eS5zdGF0aW9uICE9PSBvbGRFbnRpdHkuc3RhdGlvblxyXG4gICk7XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBoYXNSZXdhcmRzQ2hhbmdlZChuZXdFbnRpdHk6IGFueSwgb2xkRW50aXR5OiBhbnkpOiBib29sZWFuIHtcclxuICBjb25zdCBuZXdSZXdhcmRzID0gbmV3RW50aXR5LnJld2FyZHM/LnBvaW50cyB8fCB7IHhwOiAwLCBycDogMCwgZnA6IDAsIGhwOiAwIH07XHJcbiAgY29uc3Qgb2xkUmV3YXJkcyA9IG9sZEVudGl0eS5yZXdhcmRzPy5wb2ludHMgfHwgeyB4cDogMCwgcnA6IDAsIGZwOiAwLCBocDogMCB9O1xyXG4gIFxyXG4gIHJldHVybiAoXHJcbiAgICBuZXdSZXdhcmRzLnhwICE9PSBvbGRSZXdhcmRzLnhwIHx8XHJcbiAgICBuZXdSZXdhcmRzLnJwICE9PSBvbGRSZXdhcmRzLnJwIHx8XHJcbiAgICBuZXdSZXdhcmRzLmZwICE9PSBvbGRSZXdhcmRzLmZwIHx8XHJcbiAgICBuZXdSZXdhcmRzLmhwICE9PSBvbGRSZXdhcmRzLmhwXHJcbiAgKTtcclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIGhhc0p1bmdsZUNvaW5zQ2hhbmdlZChuZXdFbnRpdHk6IGFueSwgb2xkRW50aXR5OiBhbnkpOiBib29sZWFuIHtcclxuICByZXR1cm4gKG5ld0VudGl0eS5qdW5nbGVDb2lucyB8fCAwKSAhPT0gKG9sZEVudGl0eS5qdW5nbGVDb2lucyB8fCAwKTtcclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIGhhc1JldmVudWVDaGFuZ2VkKG5ld0VudGl0eTogYW55LCBvbGRFbnRpdHk6IGFueSk6IGJvb2xlYW4ge1xyXG4gIHJldHVybiAobmV3RW50aXR5LnRvdGFscz8udG90YWxSZXZlbnVlIHx8IDApICE9PSAob2xkRW50aXR5LnRvdGFscz8udG90YWxSZXZlbnVlIHx8IDApO1xyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gaGFzTGluZXNDaGFuZ2VkKG5ld0VudGl0eTogYW55LCBvbGRFbnRpdHk6IGFueSk6IGJvb2xlYW4ge1xyXG4gIHJldHVybiBKU09OLnN0cmluZ2lmeShuZXdFbnRpdHkubGluZXMpICE9PSBKU09OLnN0cmluZ2lmeShvbGRFbnRpdHkubGluZXMpO1xyXG59XHJcbiJdLCJuYW1lcyI6WyJDbGllbnRBUEkiLCJoYXNFZmZlY3QiLCJtYXJrRWZmZWN0IiwidXBkYXRlRmluYW5jaWFsUmVjb3Jkc0Zyb21UYXNrIiwidGFzayIsInByZXZpb3VzVGFzayIsImNvbnNvbGUiLCJsb2ciLCJuYW1lIiwiYWxsRmluYW5jaWFscyIsImdldEZpbmFuY2lhbFJlY29yZHMiLCJyZWxhdGVkUmVjb3JkcyIsImZpbHRlciIsInJlY29yZCIsInNvdXJjZVRhc2tJZCIsImlkIiwidXBkYXRlS2V5IiwidXBkYXRlZEF0IiwiZ2V0VGltZSIsImZpbmFuY2lhbFByb3BzQ2hhbmdlZCIsImNvc3QiLCJyZXZlbnVlIiwiaXNOb3RQYWlkIiwiaXNOb3RDaGFyZ2VkIiwic3RhdGlvbiIsInVwZGF0ZWRSZWNvcmQiLCJEYXRlIiwidXBzZXJ0RmluYW5jaWFsUmVjb3JkIiwiZXJyb3IiLCJ1cGRhdGVUYXNrc0Zyb21GaW5hbmNpYWxSZWNvcmQiLCJwcmV2aW91c1JlY29yZCIsImFsbFRhc2tzIiwiZ2V0VGFza3MiLCJyZWxhdGVkVGFza3MiLCJ1cGRhdGVkVGFzayIsInVwc2VydFRhc2siLCJ1cGRhdGVJdGVtc0NyZWF0ZWRCeVRhc2siLCJhbGxJdGVtcyIsImdldEl0ZW1zIiwicmVsYXRlZEl0ZW1zIiwiaXRlbSIsIm91dHB1dFByb3BzQ2hhbmdlZCIsIm91dHB1dFF1YW50aXR5Iiwib3V0cHV0SXRlbU5hbWUiLCJvdXRwdXRVbml0Q29zdCIsIm91dHB1dEl0ZW1QcmljZSIsInVwZGF0ZWRJdGVtIiwidW5pdENvc3QiLCJwcmljZSIsInF1YW50aXR5RGlmZiIsInN0b2NrIiwibGVuZ3RoIiwicXVhbnRpdHkiLCJzaXRlSWQiLCJ1cHNlcnRJdGVtIiwidXBkYXRlSXRlbXNDcmVhdGVkQnlSZWNvcmQiLCJzb3VyY2VSZWNvcmRJZCIsInVwZGF0ZUZpbmFuY2lhbFJlY29yZHNGcm9tU2FsZSIsInNhbGUiLCJwcmV2aW91c1NhbGUiLCJzb3VyY2VTYWxlSWQiLCJyZXZlbnVlUHJvcHNDaGFuZ2VkIiwidG90YWxzIiwidG90YWxSZXZlbnVlIiwic3RhdHVzIiwidXBkYXRlSXRlbXNGcm9tU2FsZSIsImxpbmVzQ2hhbmdlZCIsImxpbmVzIiwiSlNPTiIsInN0cmluZ2lmeSIsImxpbmUiLCJraW5kIiwiaXRlbUlkIiwiZ2V0SXRlbUJ5SWQiLCJ3YXJuIiwicXVhbnRpdHlTb2xkIiwidXBkYXRlUGxheWVyUG9pbnRzRnJvbVNvdXJjZSIsInNvdXJjZVR5cGUiLCJuZXdTb3VyY2UiLCJvbGRTb3VyY2UiLCJwb2ludHNEZWx0YSIsInhwIiwicnAiLCJmcCIsImhwIiwibmV3UG9pbnRzIiwicmV3YXJkcyIsInBvaW50cyIsIm9sZFBvaW50cyIsIm5ld1JldmVudWUiLCJvbGRSZXZlbnVlIiwicmV2ZW51ZURlbHRhIiwiTWF0aCIsImZsb29yIiwicGxheWVycyIsImdldFBsYXllcnMiLCJwbGF5ZXIiLCJ1cGRhdGVkUGxheWVyIiwidXBzZXJ0UGxheWVyIiwidXBkYXRlQ2hhcmFjdGVySnVuZ2xlQ29pbnNGcm9tUmVjb3JkIiwibmV3SnVuZ2xlQ29pbnMiLCJqdW5nbGVDb2lucyIsIm9sZEp1bmdsZUNvaW5zIiwianVuZ2xlQ29pbnNEZWx0YSIsImFsbENoYXJhY3RlcnMiLCJnZXRDaGFyYWN0ZXJzIiwicmVsYXRlZENoYXJhY3RlcnMiLCJjaGFyIiwiY3VzdG9tZXJDaGFyYWN0ZXJJZCIsImNoYXJhY3RlciIsInVwZGF0ZWRDaGFyYWN0ZXIiLCJ1cHNlcnRDaGFyYWN0ZXIiLCJoYXNGaW5hbmNpYWxQcm9wc0NoYW5nZWQiLCJuZXdFbnRpdHkiLCJvbGRFbnRpdHkiLCJoYXNPdXRwdXRQcm9wc0NoYW5nZWQiLCJoYXNSZXdhcmRzQ2hhbmdlZCIsIm5ld1Jld2FyZHMiLCJvbGRSZXdhcmRzIiwiaGFzSnVuZ2xlQ29pbnNDaGFuZ2VkIiwiaGFzUmV2ZW51ZUNoYW5nZWQiLCJoYXNMaW5lc0NoYW5nZWQiXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./workflows/update-propagation-utils.ts\n");

/***/ })

};
;

// load runtime
var __webpack_require__ = require("../../../webpack-runtime.js");
__webpack_require__.C(exports);
var __webpack_exec__ = (moduleId) => (__webpack_require__(__webpack_require__.s = moduleId))
var __webpack_exports__ = __webpack_require__.X(0, ["vendor-chunks/next","vendor-chunks/@upstash","vendor-chunks/@vercel","vendor-chunks/uncrypto","vendor-chunks/uuid","vendor-chunks/jose"], () => (__webpack_exec__("(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fsales%2Froute&page=%2Fapi%2Fsales%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fsales%2Froute.ts&appDir=C%3A%5CUsers%5CUsuario%5CAKILES%5CGAME%20WEB%20APP%5CSPLIT%5Cthegame%5Capp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=C%3A%5CUsers%5CUsuario%5CAKILES%5CGAME%20WEB%20APP%5CSPLIT%5Cthegame&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!")));
module.exports = __webpack_exports__;

})();