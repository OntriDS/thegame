/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
(self["webpackChunk_N_E"] = self["webpackChunk_N_E"] || []).push([["_app-pages-browser_data-store_datastore_ts"],{

/***/ "(app-pages-browser)/./node_modules/next/dist/build/polyfills/process.js":
/*!***********************************************************!*\
  !*** ./node_modules/next/dist/build/polyfills/process.js ***!
  \***********************************************************/
/***/ (function(module, __unused_webpack_exports, __webpack_require__) {

"use strict";
eval(__webpack_require__.ts("\nvar _global_process, _global_process1;\nmodule.exports = ((_global_process = __webpack_require__.g.process) == null ? void 0 : _global_process.env) && typeof ((_global_process1 = __webpack_require__.g.process) == null ? void 0 : _global_process1.env) === \"object\" ? __webpack_require__.g.process : __webpack_require__(/*! next/dist/compiled/process */ \"(app-pages-browser)/./node_modules/next/dist/compiled/process/browser.js\");\n\n//# sourceMappingURL=process.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFwcC1wYWdlcy1icm93c2VyKS8uL25vZGVfbW9kdWxlcy9uZXh0L2Rpc3QvYnVpbGQvcG9seWZpbGxzL3Byb2Nlc3MuanMiLCJtYXBwaW5ncyI6IkFBQWE7QUFDYjtBQUNBLHFDQUFxQyxxQkFBTSxpRkFBaUYscUJBQU0sa0VBQWtFLHFCQUFNLFdBQVcsbUJBQU8sQ0FBQyw0R0FBNEI7O0FBRXpQIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vX05fRS8uL25vZGVfbW9kdWxlcy9uZXh0L2Rpc3QvYnVpbGQvcG9seWZpbGxzL3Byb2Nlc3MuanM/ZWEzNiJdLCJzb3VyY2VzQ29udGVudCI6WyJcInVzZSBzdHJpY3RcIjtcbnZhciBfZ2xvYmFsX3Byb2Nlc3MsIF9nbG9iYWxfcHJvY2VzczE7XG5tb2R1bGUuZXhwb3J0cyA9ICgoX2dsb2JhbF9wcm9jZXNzID0gZ2xvYmFsLnByb2Nlc3MpID09IG51bGwgPyB2b2lkIDAgOiBfZ2xvYmFsX3Byb2Nlc3MuZW52KSAmJiB0eXBlb2YgKChfZ2xvYmFsX3Byb2Nlc3MxID0gZ2xvYmFsLnByb2Nlc3MpID09IG51bGwgPyB2b2lkIDAgOiBfZ2xvYmFsX3Byb2Nlc3MxLmVudikgPT09IFwib2JqZWN0XCIgPyBnbG9iYWwucHJvY2VzcyA6IHJlcXVpcmUoXCJuZXh0L2Rpc3QvY29tcGlsZWQvcHJvY2Vzc1wiKTtcblxuLy8jIHNvdXJjZU1hcHBpbmdVUkw9cHJvY2Vzcy5qcy5tYXAiXSwibmFtZXMiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(app-pages-browser)/./node_modules/next/dist/build/polyfills/process.js\n"));

/***/ }),

/***/ "(app-pages-browser)/./node_modules/next/dist/compiled/buffer/index.js":
/*!*********************************************************!*\
  !*** ./node_modules/next/dist/compiled/buffer/index.js ***!
  \*********************************************************/
/***/ (function(module, __unused_webpack_exports, __webpack_require__) {

eval(__webpack_require__.ts("var __dirname = \"/\";\n(function(){var e={675:function(e,r){\"use strict\";r.byteLength=byteLength;r.toByteArray=toByteArray;r.fromByteArray=fromByteArray;var t=[];var f=[];var n=typeof Uint8Array!==\"undefined\"?Uint8Array:Array;var i=\"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/\";for(var o=0,u=i.length;o<u;++o){t[o]=i[o];f[i.charCodeAt(o)]=o}f[\"-\".charCodeAt(0)]=62;f[\"_\".charCodeAt(0)]=63;function getLens(e){var r=e.length;if(r%4>0){throw new Error(\"Invalid string. Length must be a multiple of 4\")}var t=e.indexOf(\"=\");if(t===-1)t=r;var f=t===r?0:4-t%4;return[t,f]}function byteLength(e){var r=getLens(e);var t=r[0];var f=r[1];return(t+f)*3/4-f}function _byteLength(e,r,t){return(r+t)*3/4-t}function toByteArray(e){var r;var t=getLens(e);var i=t[0];var o=t[1];var u=new n(_byteLength(e,i,o));var a=0;var s=o>0?i-4:i;var h;for(h=0;h<s;h+=4){r=f[e.charCodeAt(h)]<<18|f[e.charCodeAt(h+1)]<<12|f[e.charCodeAt(h+2)]<<6|f[e.charCodeAt(h+3)];u[a++]=r>>16&255;u[a++]=r>>8&255;u[a++]=r&255}if(o===2){r=f[e.charCodeAt(h)]<<2|f[e.charCodeAt(h+1)]>>4;u[a++]=r&255}if(o===1){r=f[e.charCodeAt(h)]<<10|f[e.charCodeAt(h+1)]<<4|f[e.charCodeAt(h+2)]>>2;u[a++]=r>>8&255;u[a++]=r&255}return u}function tripletToBase64(e){return t[e>>18&63]+t[e>>12&63]+t[e>>6&63]+t[e&63]}function encodeChunk(e,r,t){var f;var n=[];for(var i=r;i<t;i+=3){f=(e[i]<<16&16711680)+(e[i+1]<<8&65280)+(e[i+2]&255);n.push(tripletToBase64(f))}return n.join(\"\")}function fromByteArray(e){var r;var f=e.length;var n=f%3;var i=[];var o=16383;for(var u=0,a=f-n;u<a;u+=o){i.push(encodeChunk(e,u,u+o>a?a:u+o))}if(n===1){r=e[f-1];i.push(t[r>>2]+t[r<<4&63]+\"==\")}else if(n===2){r=(e[f-2]<<8)+e[f-1];i.push(t[r>>10]+t[r>>4&63]+t[r<<2&63]+\"=\")}return i.join(\"\")}},72:function(e,r,t){\"use strict\";\n/*!\n * The buffer module from node.js, for the browser.\n *\n * @author   Feross Aboukhadijeh <https://feross.org>\n * @license  MIT\n */var f=t(675);var n=t(783);var i=typeof Symbol===\"function\"&&typeof Symbol.for===\"function\"?Symbol.for(\"nodejs.util.inspect.custom\"):null;r.Buffer=Buffer;r.SlowBuffer=SlowBuffer;r.INSPECT_MAX_BYTES=50;var o=2147483647;r.kMaxLength=o;Buffer.TYPED_ARRAY_SUPPORT=typedArraySupport();if(!Buffer.TYPED_ARRAY_SUPPORT&&typeof console!==\"undefined\"&&typeof console.error===\"function\"){console.error(\"This browser lacks typed array (Uint8Array) support which is required by \"+\"`buffer` v5.x. Use `buffer` v4.x if you require old browser support.\")}function typedArraySupport(){try{var e=new Uint8Array(1);var r={foo:function(){return 42}};Object.setPrototypeOf(r,Uint8Array.prototype);Object.setPrototypeOf(e,r);return e.foo()===42}catch(e){return false}}Object.defineProperty(Buffer.prototype,\"parent\",{enumerable:true,get:function(){if(!Buffer.isBuffer(this))return undefined;return this.buffer}});Object.defineProperty(Buffer.prototype,\"offset\",{enumerable:true,get:function(){if(!Buffer.isBuffer(this))return undefined;return this.byteOffset}});function createBuffer(e){if(e>o){throw new RangeError('The value \"'+e+'\" is invalid for option \"size\"')}var r=new Uint8Array(e);Object.setPrototypeOf(r,Buffer.prototype);return r}function Buffer(e,r,t){if(typeof e===\"number\"){if(typeof r===\"string\"){throw new TypeError('The \"string\" argument must be of type string. Received type number')}return allocUnsafe(e)}return from(e,r,t)}Buffer.poolSize=8192;function from(e,r,t){if(typeof e===\"string\"){return fromString(e,r)}if(ArrayBuffer.isView(e)){return fromArrayLike(e)}if(e==null){throw new TypeError(\"The first argument must be one of type string, Buffer, ArrayBuffer, Array, \"+\"or Array-like Object. Received type \"+typeof e)}if(isInstance(e,ArrayBuffer)||e&&isInstance(e.buffer,ArrayBuffer)){return fromArrayBuffer(e,r,t)}if(typeof SharedArrayBuffer!==\"undefined\"&&(isInstance(e,SharedArrayBuffer)||e&&isInstance(e.buffer,SharedArrayBuffer))){return fromArrayBuffer(e,r,t)}if(typeof e===\"number\"){throw new TypeError('The \"value\" argument must not be of type number. Received type number')}var f=e.valueOf&&e.valueOf();if(f!=null&&f!==e){return Buffer.from(f,r,t)}var n=fromObject(e);if(n)return n;if(typeof Symbol!==\"undefined\"&&Symbol.toPrimitive!=null&&typeof e[Symbol.toPrimitive]===\"function\"){return Buffer.from(e[Symbol.toPrimitive](\"string\"),r,t)}throw new TypeError(\"The first argument must be one of type string, Buffer, ArrayBuffer, Array, \"+\"or Array-like Object. Received type \"+typeof e)}Buffer.from=function(e,r,t){return from(e,r,t)};Object.setPrototypeOf(Buffer.prototype,Uint8Array.prototype);Object.setPrototypeOf(Buffer,Uint8Array);function assertSize(e){if(typeof e!==\"number\"){throw new TypeError('\"size\" argument must be of type number')}else if(e<0){throw new RangeError('The value \"'+e+'\" is invalid for option \"size\"')}}function alloc(e,r,t){assertSize(e);if(e<=0){return createBuffer(e)}if(r!==undefined){return typeof t===\"string\"?createBuffer(e).fill(r,t):createBuffer(e).fill(r)}return createBuffer(e)}Buffer.alloc=function(e,r,t){return alloc(e,r,t)};function allocUnsafe(e){assertSize(e);return createBuffer(e<0?0:checked(e)|0)}Buffer.allocUnsafe=function(e){return allocUnsafe(e)};Buffer.allocUnsafeSlow=function(e){return allocUnsafe(e)};function fromString(e,r){if(typeof r!==\"string\"||r===\"\"){r=\"utf8\"}if(!Buffer.isEncoding(r)){throw new TypeError(\"Unknown encoding: \"+r)}var t=byteLength(e,r)|0;var f=createBuffer(t);var n=f.write(e,r);if(n!==t){f=f.slice(0,n)}return f}function fromArrayLike(e){var r=e.length<0?0:checked(e.length)|0;var t=createBuffer(r);for(var f=0;f<r;f+=1){t[f]=e[f]&255}return t}function fromArrayBuffer(e,r,t){if(r<0||e.byteLength<r){throw new RangeError('\"offset\" is outside of buffer bounds')}if(e.byteLength<r+(t||0)){throw new RangeError('\"length\" is outside of buffer bounds')}var f;if(r===undefined&&t===undefined){f=new Uint8Array(e)}else if(t===undefined){f=new Uint8Array(e,r)}else{f=new Uint8Array(e,r,t)}Object.setPrototypeOf(f,Buffer.prototype);return f}function fromObject(e){if(Buffer.isBuffer(e)){var r=checked(e.length)|0;var t=createBuffer(r);if(t.length===0){return t}e.copy(t,0,0,r);return t}if(e.length!==undefined){if(typeof e.length!==\"number\"||numberIsNaN(e.length)){return createBuffer(0)}return fromArrayLike(e)}if(e.type===\"Buffer\"&&Array.isArray(e.data)){return fromArrayLike(e.data)}}function checked(e){if(e>=o){throw new RangeError(\"Attempt to allocate Buffer larger than maximum \"+\"size: 0x\"+o.toString(16)+\" bytes\")}return e|0}function SlowBuffer(e){if(+e!=e){e=0}return Buffer.alloc(+e)}Buffer.isBuffer=function isBuffer(e){return e!=null&&e._isBuffer===true&&e!==Buffer.prototype};Buffer.compare=function compare(e,r){if(isInstance(e,Uint8Array))e=Buffer.from(e,e.offset,e.byteLength);if(isInstance(r,Uint8Array))r=Buffer.from(r,r.offset,r.byteLength);if(!Buffer.isBuffer(e)||!Buffer.isBuffer(r)){throw new TypeError('The \"buf1\", \"buf2\" arguments must be one of type Buffer or Uint8Array')}if(e===r)return 0;var t=e.length;var f=r.length;for(var n=0,i=Math.min(t,f);n<i;++n){if(e[n]!==r[n]){t=e[n];f=r[n];break}}if(t<f)return-1;if(f<t)return 1;return 0};Buffer.isEncoding=function isEncoding(e){switch(String(e).toLowerCase()){case\"hex\":case\"utf8\":case\"utf-8\":case\"ascii\":case\"latin1\":case\"binary\":case\"base64\":case\"ucs2\":case\"ucs-2\":case\"utf16le\":case\"utf-16le\":return true;default:return false}};Buffer.concat=function concat(e,r){if(!Array.isArray(e)){throw new TypeError('\"list\" argument must be an Array of Buffers')}if(e.length===0){return Buffer.alloc(0)}var t;if(r===undefined){r=0;for(t=0;t<e.length;++t){r+=e[t].length}}var f=Buffer.allocUnsafe(r);var n=0;for(t=0;t<e.length;++t){var i=e[t];if(isInstance(i,Uint8Array)){i=Buffer.from(i)}if(!Buffer.isBuffer(i)){throw new TypeError('\"list\" argument must be an Array of Buffers')}i.copy(f,n);n+=i.length}return f};function byteLength(e,r){if(Buffer.isBuffer(e)){return e.length}if(ArrayBuffer.isView(e)||isInstance(e,ArrayBuffer)){return e.byteLength}if(typeof e!==\"string\"){throw new TypeError('The \"string\" argument must be one of type string, Buffer, or ArrayBuffer. '+\"Received type \"+typeof e)}var t=e.length;var f=arguments.length>2&&arguments[2]===true;if(!f&&t===0)return 0;var n=false;for(;;){switch(r){case\"ascii\":case\"latin1\":case\"binary\":return t;case\"utf8\":case\"utf-8\":return utf8ToBytes(e).length;case\"ucs2\":case\"ucs-2\":case\"utf16le\":case\"utf-16le\":return t*2;case\"hex\":return t>>>1;case\"base64\":return base64ToBytes(e).length;default:if(n){return f?-1:utf8ToBytes(e).length}r=(\"\"+r).toLowerCase();n=true}}}Buffer.byteLength=byteLength;function slowToString(e,r,t){var f=false;if(r===undefined||r<0){r=0}if(r>this.length){return\"\"}if(t===undefined||t>this.length){t=this.length}if(t<=0){return\"\"}t>>>=0;r>>>=0;if(t<=r){return\"\"}if(!e)e=\"utf8\";while(true){switch(e){case\"hex\":return hexSlice(this,r,t);case\"utf8\":case\"utf-8\":return utf8Slice(this,r,t);case\"ascii\":return asciiSlice(this,r,t);case\"latin1\":case\"binary\":return latin1Slice(this,r,t);case\"base64\":return base64Slice(this,r,t);case\"ucs2\":case\"ucs-2\":case\"utf16le\":case\"utf-16le\":return utf16leSlice(this,r,t);default:if(f)throw new TypeError(\"Unknown encoding: \"+e);e=(e+\"\").toLowerCase();f=true}}}Buffer.prototype._isBuffer=true;function swap(e,r,t){var f=e[r];e[r]=e[t];e[t]=f}Buffer.prototype.swap16=function swap16(){var e=this.length;if(e%2!==0){throw new RangeError(\"Buffer size must be a multiple of 16-bits\")}for(var r=0;r<e;r+=2){swap(this,r,r+1)}return this};Buffer.prototype.swap32=function swap32(){var e=this.length;if(e%4!==0){throw new RangeError(\"Buffer size must be a multiple of 32-bits\")}for(var r=0;r<e;r+=4){swap(this,r,r+3);swap(this,r+1,r+2)}return this};Buffer.prototype.swap64=function swap64(){var e=this.length;if(e%8!==0){throw new RangeError(\"Buffer size must be a multiple of 64-bits\")}for(var r=0;r<e;r+=8){swap(this,r,r+7);swap(this,r+1,r+6);swap(this,r+2,r+5);swap(this,r+3,r+4)}return this};Buffer.prototype.toString=function toString(){var e=this.length;if(e===0)return\"\";if(arguments.length===0)return utf8Slice(this,0,e);return slowToString.apply(this,arguments)};Buffer.prototype.toLocaleString=Buffer.prototype.toString;Buffer.prototype.equals=function equals(e){if(!Buffer.isBuffer(e))throw new TypeError(\"Argument must be a Buffer\");if(this===e)return true;return Buffer.compare(this,e)===0};Buffer.prototype.inspect=function inspect(){var e=\"\";var t=r.INSPECT_MAX_BYTES;e=this.toString(\"hex\",0,t).replace(/(.{2})/g,\"$1 \").trim();if(this.length>t)e+=\" ... \";return\"<Buffer \"+e+\">\"};if(i){Buffer.prototype[i]=Buffer.prototype.inspect}Buffer.prototype.compare=function compare(e,r,t,f,n){if(isInstance(e,Uint8Array)){e=Buffer.from(e,e.offset,e.byteLength)}if(!Buffer.isBuffer(e)){throw new TypeError('The \"target\" argument must be one of type Buffer or Uint8Array. '+\"Received type \"+typeof e)}if(r===undefined){r=0}if(t===undefined){t=e?e.length:0}if(f===undefined){f=0}if(n===undefined){n=this.length}if(r<0||t>e.length||f<0||n>this.length){throw new RangeError(\"out of range index\")}if(f>=n&&r>=t){return 0}if(f>=n){return-1}if(r>=t){return 1}r>>>=0;t>>>=0;f>>>=0;n>>>=0;if(this===e)return 0;var i=n-f;var o=t-r;var u=Math.min(i,o);var a=this.slice(f,n);var s=e.slice(r,t);for(var h=0;h<u;++h){if(a[h]!==s[h]){i=a[h];o=s[h];break}}if(i<o)return-1;if(o<i)return 1;return 0};function bidirectionalIndexOf(e,r,t,f,n){if(e.length===0)return-1;if(typeof t===\"string\"){f=t;t=0}else if(t>2147483647){t=2147483647}else if(t<-2147483648){t=-2147483648}t=+t;if(numberIsNaN(t)){t=n?0:e.length-1}if(t<0)t=e.length+t;if(t>=e.length){if(n)return-1;else t=e.length-1}else if(t<0){if(n)t=0;else return-1}if(typeof r===\"string\"){r=Buffer.from(r,f)}if(Buffer.isBuffer(r)){if(r.length===0){return-1}return arrayIndexOf(e,r,t,f,n)}else if(typeof r===\"number\"){r=r&255;if(typeof Uint8Array.prototype.indexOf===\"function\"){if(n){return Uint8Array.prototype.indexOf.call(e,r,t)}else{return Uint8Array.prototype.lastIndexOf.call(e,r,t)}}return arrayIndexOf(e,[r],t,f,n)}throw new TypeError(\"val must be string, number or Buffer\")}function arrayIndexOf(e,r,t,f,n){var i=1;var o=e.length;var u=r.length;if(f!==undefined){f=String(f).toLowerCase();if(f===\"ucs2\"||f===\"ucs-2\"||f===\"utf16le\"||f===\"utf-16le\"){if(e.length<2||r.length<2){return-1}i=2;o/=2;u/=2;t/=2}}function read(e,r){if(i===1){return e[r]}else{return e.readUInt16BE(r*i)}}var a;if(n){var s=-1;for(a=t;a<o;a++){if(read(e,a)===read(r,s===-1?0:a-s)){if(s===-1)s=a;if(a-s+1===u)return s*i}else{if(s!==-1)a-=a-s;s=-1}}}else{if(t+u>o)t=o-u;for(a=t;a>=0;a--){var h=true;for(var c=0;c<u;c++){if(read(e,a+c)!==read(r,c)){h=false;break}}if(h)return a}}return-1}Buffer.prototype.includes=function includes(e,r,t){return this.indexOf(e,r,t)!==-1};Buffer.prototype.indexOf=function indexOf(e,r,t){return bidirectionalIndexOf(this,e,r,t,true)};Buffer.prototype.lastIndexOf=function lastIndexOf(e,r,t){return bidirectionalIndexOf(this,e,r,t,false)};function hexWrite(e,r,t,f){t=Number(t)||0;var n=e.length-t;if(!f){f=n}else{f=Number(f);if(f>n){f=n}}var i=r.length;if(f>i/2){f=i/2}for(var o=0;o<f;++o){var u=parseInt(r.substr(o*2,2),16);if(numberIsNaN(u))return o;e[t+o]=u}return o}function utf8Write(e,r,t,f){return blitBuffer(utf8ToBytes(r,e.length-t),e,t,f)}function asciiWrite(e,r,t,f){return blitBuffer(asciiToBytes(r),e,t,f)}function latin1Write(e,r,t,f){return asciiWrite(e,r,t,f)}function base64Write(e,r,t,f){return blitBuffer(base64ToBytes(r),e,t,f)}function ucs2Write(e,r,t,f){return blitBuffer(utf16leToBytes(r,e.length-t),e,t,f)}Buffer.prototype.write=function write(e,r,t,f){if(r===undefined){f=\"utf8\";t=this.length;r=0}else if(t===undefined&&typeof r===\"string\"){f=r;t=this.length;r=0}else if(isFinite(r)){r=r>>>0;if(isFinite(t)){t=t>>>0;if(f===undefined)f=\"utf8\"}else{f=t;t=undefined}}else{throw new Error(\"Buffer.write(string, encoding, offset[, length]) is no longer supported\")}var n=this.length-r;if(t===undefined||t>n)t=n;if(e.length>0&&(t<0||r<0)||r>this.length){throw new RangeError(\"Attempt to write outside buffer bounds\")}if(!f)f=\"utf8\";var i=false;for(;;){switch(f){case\"hex\":return hexWrite(this,e,r,t);case\"utf8\":case\"utf-8\":return utf8Write(this,e,r,t);case\"ascii\":return asciiWrite(this,e,r,t);case\"latin1\":case\"binary\":return latin1Write(this,e,r,t);case\"base64\":return base64Write(this,e,r,t);case\"ucs2\":case\"ucs-2\":case\"utf16le\":case\"utf-16le\":return ucs2Write(this,e,r,t);default:if(i)throw new TypeError(\"Unknown encoding: \"+f);f=(\"\"+f).toLowerCase();i=true}}};Buffer.prototype.toJSON=function toJSON(){return{type:\"Buffer\",data:Array.prototype.slice.call(this._arr||this,0)}};function base64Slice(e,r,t){if(r===0&&t===e.length){return f.fromByteArray(e)}else{return f.fromByteArray(e.slice(r,t))}}function utf8Slice(e,r,t){t=Math.min(e.length,t);var f=[];var n=r;while(n<t){var i=e[n];var o=null;var u=i>239?4:i>223?3:i>191?2:1;if(n+u<=t){var a,s,h,c;switch(u){case 1:if(i<128){o=i}break;case 2:a=e[n+1];if((a&192)===128){c=(i&31)<<6|a&63;if(c>127){o=c}}break;case 3:a=e[n+1];s=e[n+2];if((a&192)===128&&(s&192)===128){c=(i&15)<<12|(a&63)<<6|s&63;if(c>2047&&(c<55296||c>57343)){o=c}}break;case 4:a=e[n+1];s=e[n+2];h=e[n+3];if((a&192)===128&&(s&192)===128&&(h&192)===128){c=(i&15)<<18|(a&63)<<12|(s&63)<<6|h&63;if(c>65535&&c<1114112){o=c}}}}if(o===null){o=65533;u=1}else if(o>65535){o-=65536;f.push(o>>>10&1023|55296);o=56320|o&1023}f.push(o);n+=u}return decodeCodePointsArray(f)}var u=4096;function decodeCodePointsArray(e){var r=e.length;if(r<=u){return String.fromCharCode.apply(String,e)}var t=\"\";var f=0;while(f<r){t+=String.fromCharCode.apply(String,e.slice(f,f+=u))}return t}function asciiSlice(e,r,t){var f=\"\";t=Math.min(e.length,t);for(var n=r;n<t;++n){f+=String.fromCharCode(e[n]&127)}return f}function latin1Slice(e,r,t){var f=\"\";t=Math.min(e.length,t);for(var n=r;n<t;++n){f+=String.fromCharCode(e[n])}return f}function hexSlice(e,r,t){var f=e.length;if(!r||r<0)r=0;if(!t||t<0||t>f)t=f;var n=\"\";for(var i=r;i<t;++i){n+=s[e[i]]}return n}function utf16leSlice(e,r,t){var f=e.slice(r,t);var n=\"\";for(var i=0;i<f.length;i+=2){n+=String.fromCharCode(f[i]+f[i+1]*256)}return n}Buffer.prototype.slice=function slice(e,r){var t=this.length;e=~~e;r=r===undefined?t:~~r;if(e<0){e+=t;if(e<0)e=0}else if(e>t){e=t}if(r<0){r+=t;if(r<0)r=0}else if(r>t){r=t}if(r<e)r=e;var f=this.subarray(e,r);Object.setPrototypeOf(f,Buffer.prototype);return f};function checkOffset(e,r,t){if(e%1!==0||e<0)throw new RangeError(\"offset is not uint\");if(e+r>t)throw new RangeError(\"Trying to access beyond buffer length\")}Buffer.prototype.readUIntLE=function readUIntLE(e,r,t){e=e>>>0;r=r>>>0;if(!t)checkOffset(e,r,this.length);var f=this[e];var n=1;var i=0;while(++i<r&&(n*=256)){f+=this[e+i]*n}return f};Buffer.prototype.readUIntBE=function readUIntBE(e,r,t){e=e>>>0;r=r>>>0;if(!t){checkOffset(e,r,this.length)}var f=this[e+--r];var n=1;while(r>0&&(n*=256)){f+=this[e+--r]*n}return f};Buffer.prototype.readUInt8=function readUInt8(e,r){e=e>>>0;if(!r)checkOffset(e,1,this.length);return this[e]};Buffer.prototype.readUInt16LE=function readUInt16LE(e,r){e=e>>>0;if(!r)checkOffset(e,2,this.length);return this[e]|this[e+1]<<8};Buffer.prototype.readUInt16BE=function readUInt16BE(e,r){e=e>>>0;if(!r)checkOffset(e,2,this.length);return this[e]<<8|this[e+1]};Buffer.prototype.readUInt32LE=function readUInt32LE(e,r){e=e>>>0;if(!r)checkOffset(e,4,this.length);return(this[e]|this[e+1]<<8|this[e+2]<<16)+this[e+3]*16777216};Buffer.prototype.readUInt32BE=function readUInt32BE(e,r){e=e>>>0;if(!r)checkOffset(e,4,this.length);return this[e]*16777216+(this[e+1]<<16|this[e+2]<<8|this[e+3])};Buffer.prototype.readIntLE=function readIntLE(e,r,t){e=e>>>0;r=r>>>0;if(!t)checkOffset(e,r,this.length);var f=this[e];var n=1;var i=0;while(++i<r&&(n*=256)){f+=this[e+i]*n}n*=128;if(f>=n)f-=Math.pow(2,8*r);return f};Buffer.prototype.readIntBE=function readIntBE(e,r,t){e=e>>>0;r=r>>>0;if(!t)checkOffset(e,r,this.length);var f=r;var n=1;var i=this[e+--f];while(f>0&&(n*=256)){i+=this[e+--f]*n}n*=128;if(i>=n)i-=Math.pow(2,8*r);return i};Buffer.prototype.readInt8=function readInt8(e,r){e=e>>>0;if(!r)checkOffset(e,1,this.length);if(!(this[e]&128))return this[e];return(255-this[e]+1)*-1};Buffer.prototype.readInt16LE=function readInt16LE(e,r){e=e>>>0;if(!r)checkOffset(e,2,this.length);var t=this[e]|this[e+1]<<8;return t&32768?t|4294901760:t};Buffer.prototype.readInt16BE=function readInt16BE(e,r){e=e>>>0;if(!r)checkOffset(e,2,this.length);var t=this[e+1]|this[e]<<8;return t&32768?t|4294901760:t};Buffer.prototype.readInt32LE=function readInt32LE(e,r){e=e>>>0;if(!r)checkOffset(e,4,this.length);return this[e]|this[e+1]<<8|this[e+2]<<16|this[e+3]<<24};Buffer.prototype.readInt32BE=function readInt32BE(e,r){e=e>>>0;if(!r)checkOffset(e,4,this.length);return this[e]<<24|this[e+1]<<16|this[e+2]<<8|this[e+3]};Buffer.prototype.readFloatLE=function readFloatLE(e,r){e=e>>>0;if(!r)checkOffset(e,4,this.length);return n.read(this,e,true,23,4)};Buffer.prototype.readFloatBE=function readFloatBE(e,r){e=e>>>0;if(!r)checkOffset(e,4,this.length);return n.read(this,e,false,23,4)};Buffer.prototype.readDoubleLE=function readDoubleLE(e,r){e=e>>>0;if(!r)checkOffset(e,8,this.length);return n.read(this,e,true,52,8)};Buffer.prototype.readDoubleBE=function readDoubleBE(e,r){e=e>>>0;if(!r)checkOffset(e,8,this.length);return n.read(this,e,false,52,8)};function checkInt(e,r,t,f,n,i){if(!Buffer.isBuffer(e))throw new TypeError('\"buffer\" argument must be a Buffer instance');if(r>n||r<i)throw new RangeError('\"value\" argument is out of bounds');if(t+f>e.length)throw new RangeError(\"Index out of range\")}Buffer.prototype.writeUIntLE=function writeUIntLE(e,r,t,f){e=+e;r=r>>>0;t=t>>>0;if(!f){var n=Math.pow(2,8*t)-1;checkInt(this,e,r,t,n,0)}var i=1;var o=0;this[r]=e&255;while(++o<t&&(i*=256)){this[r+o]=e/i&255}return r+t};Buffer.prototype.writeUIntBE=function writeUIntBE(e,r,t,f){e=+e;r=r>>>0;t=t>>>0;if(!f){var n=Math.pow(2,8*t)-1;checkInt(this,e,r,t,n,0)}var i=t-1;var o=1;this[r+i]=e&255;while(--i>=0&&(o*=256)){this[r+i]=e/o&255}return r+t};Buffer.prototype.writeUInt8=function writeUInt8(e,r,t){e=+e;r=r>>>0;if(!t)checkInt(this,e,r,1,255,0);this[r]=e&255;return r+1};Buffer.prototype.writeUInt16LE=function writeUInt16LE(e,r,t){e=+e;r=r>>>0;if(!t)checkInt(this,e,r,2,65535,0);this[r]=e&255;this[r+1]=e>>>8;return r+2};Buffer.prototype.writeUInt16BE=function writeUInt16BE(e,r,t){e=+e;r=r>>>0;if(!t)checkInt(this,e,r,2,65535,0);this[r]=e>>>8;this[r+1]=e&255;return r+2};Buffer.prototype.writeUInt32LE=function writeUInt32LE(e,r,t){e=+e;r=r>>>0;if(!t)checkInt(this,e,r,4,4294967295,0);this[r+3]=e>>>24;this[r+2]=e>>>16;this[r+1]=e>>>8;this[r]=e&255;return r+4};Buffer.prototype.writeUInt32BE=function writeUInt32BE(e,r,t){e=+e;r=r>>>0;if(!t)checkInt(this,e,r,4,4294967295,0);this[r]=e>>>24;this[r+1]=e>>>16;this[r+2]=e>>>8;this[r+3]=e&255;return r+4};Buffer.prototype.writeIntLE=function writeIntLE(e,r,t,f){e=+e;r=r>>>0;if(!f){var n=Math.pow(2,8*t-1);checkInt(this,e,r,t,n-1,-n)}var i=0;var o=1;var u=0;this[r]=e&255;while(++i<t&&(o*=256)){if(e<0&&u===0&&this[r+i-1]!==0){u=1}this[r+i]=(e/o>>0)-u&255}return r+t};Buffer.prototype.writeIntBE=function writeIntBE(e,r,t,f){e=+e;r=r>>>0;if(!f){var n=Math.pow(2,8*t-1);checkInt(this,e,r,t,n-1,-n)}var i=t-1;var o=1;var u=0;this[r+i]=e&255;while(--i>=0&&(o*=256)){if(e<0&&u===0&&this[r+i+1]!==0){u=1}this[r+i]=(e/o>>0)-u&255}return r+t};Buffer.prototype.writeInt8=function writeInt8(e,r,t){e=+e;r=r>>>0;if(!t)checkInt(this,e,r,1,127,-128);if(e<0)e=255+e+1;this[r]=e&255;return r+1};Buffer.prototype.writeInt16LE=function writeInt16LE(e,r,t){e=+e;r=r>>>0;if(!t)checkInt(this,e,r,2,32767,-32768);this[r]=e&255;this[r+1]=e>>>8;return r+2};Buffer.prototype.writeInt16BE=function writeInt16BE(e,r,t){e=+e;r=r>>>0;if(!t)checkInt(this,e,r,2,32767,-32768);this[r]=e>>>8;this[r+1]=e&255;return r+2};Buffer.prototype.writeInt32LE=function writeInt32LE(e,r,t){e=+e;r=r>>>0;if(!t)checkInt(this,e,r,4,2147483647,-2147483648);this[r]=e&255;this[r+1]=e>>>8;this[r+2]=e>>>16;this[r+3]=e>>>24;return r+4};Buffer.prototype.writeInt32BE=function writeInt32BE(e,r,t){e=+e;r=r>>>0;if(!t)checkInt(this,e,r,4,2147483647,-2147483648);if(e<0)e=4294967295+e+1;this[r]=e>>>24;this[r+1]=e>>>16;this[r+2]=e>>>8;this[r+3]=e&255;return r+4};function checkIEEE754(e,r,t,f,n,i){if(t+f>e.length)throw new RangeError(\"Index out of range\");if(t<0)throw new RangeError(\"Index out of range\")}function writeFloat(e,r,t,f,i){r=+r;t=t>>>0;if(!i){checkIEEE754(e,r,t,4,34028234663852886e22,-34028234663852886e22)}n.write(e,r,t,f,23,4);return t+4}Buffer.prototype.writeFloatLE=function writeFloatLE(e,r,t){return writeFloat(this,e,r,true,t)};Buffer.prototype.writeFloatBE=function writeFloatBE(e,r,t){return writeFloat(this,e,r,false,t)};function writeDouble(e,r,t,f,i){r=+r;t=t>>>0;if(!i){checkIEEE754(e,r,t,8,17976931348623157e292,-17976931348623157e292)}n.write(e,r,t,f,52,8);return t+8}Buffer.prototype.writeDoubleLE=function writeDoubleLE(e,r,t){return writeDouble(this,e,r,true,t)};Buffer.prototype.writeDoubleBE=function writeDoubleBE(e,r,t){return writeDouble(this,e,r,false,t)};Buffer.prototype.copy=function copy(e,r,t,f){if(!Buffer.isBuffer(e))throw new TypeError(\"argument should be a Buffer\");if(!t)t=0;if(!f&&f!==0)f=this.length;if(r>=e.length)r=e.length;if(!r)r=0;if(f>0&&f<t)f=t;if(f===t)return 0;if(e.length===0||this.length===0)return 0;if(r<0){throw new RangeError(\"targetStart out of bounds\")}if(t<0||t>=this.length)throw new RangeError(\"Index out of range\");if(f<0)throw new RangeError(\"sourceEnd out of bounds\");if(f>this.length)f=this.length;if(e.length-r<f-t){f=e.length-r+t}var n=f-t;if(this===e&&typeof Uint8Array.prototype.copyWithin===\"function\"){this.copyWithin(r,t,f)}else if(this===e&&t<r&&r<f){for(var i=n-1;i>=0;--i){e[i+r]=this[i+t]}}else{Uint8Array.prototype.set.call(e,this.subarray(t,f),r)}return n};Buffer.prototype.fill=function fill(e,r,t,f){if(typeof e===\"string\"){if(typeof r===\"string\"){f=r;r=0;t=this.length}else if(typeof t===\"string\"){f=t;t=this.length}if(f!==undefined&&typeof f!==\"string\"){throw new TypeError(\"encoding must be a string\")}if(typeof f===\"string\"&&!Buffer.isEncoding(f)){throw new TypeError(\"Unknown encoding: \"+f)}if(e.length===1){var n=e.charCodeAt(0);if(f===\"utf8\"&&n<128||f===\"latin1\"){e=n}}}else if(typeof e===\"number\"){e=e&255}else if(typeof e===\"boolean\"){e=Number(e)}if(r<0||this.length<r||this.length<t){throw new RangeError(\"Out of range index\")}if(t<=r){return this}r=r>>>0;t=t===undefined?this.length:t>>>0;if(!e)e=0;var i;if(typeof e===\"number\"){for(i=r;i<t;++i){this[i]=e}}else{var o=Buffer.isBuffer(e)?e:Buffer.from(e,f);var u=o.length;if(u===0){throw new TypeError('The value \"'+e+'\" is invalid for argument \"value\"')}for(i=0;i<t-r;++i){this[i+r]=o[i%u]}}return this};var a=/[^+/0-9A-Za-z-_]/g;function base64clean(e){e=e.split(\"=\")[0];e=e.trim().replace(a,\"\");if(e.length<2)return\"\";while(e.length%4!==0){e=e+\"=\"}return e}function utf8ToBytes(e,r){r=r||Infinity;var t;var f=e.length;var n=null;var i=[];for(var o=0;o<f;++o){t=e.charCodeAt(o);if(t>55295&&t<57344){if(!n){if(t>56319){if((r-=3)>-1)i.push(239,191,189);continue}else if(o+1===f){if((r-=3)>-1)i.push(239,191,189);continue}n=t;continue}if(t<56320){if((r-=3)>-1)i.push(239,191,189);n=t;continue}t=(n-55296<<10|t-56320)+65536}else if(n){if((r-=3)>-1)i.push(239,191,189)}n=null;if(t<128){if((r-=1)<0)break;i.push(t)}else if(t<2048){if((r-=2)<0)break;i.push(t>>6|192,t&63|128)}else if(t<65536){if((r-=3)<0)break;i.push(t>>12|224,t>>6&63|128,t&63|128)}else if(t<1114112){if((r-=4)<0)break;i.push(t>>18|240,t>>12&63|128,t>>6&63|128,t&63|128)}else{throw new Error(\"Invalid code point\")}}return i}function asciiToBytes(e){var r=[];for(var t=0;t<e.length;++t){r.push(e.charCodeAt(t)&255)}return r}function utf16leToBytes(e,r){var t,f,n;var i=[];for(var o=0;o<e.length;++o){if((r-=2)<0)break;t=e.charCodeAt(o);f=t>>8;n=t%256;i.push(n);i.push(f)}return i}function base64ToBytes(e){return f.toByteArray(base64clean(e))}function blitBuffer(e,r,t,f){for(var n=0;n<f;++n){if(n+t>=r.length||n>=e.length)break;r[n+t]=e[n]}return n}function isInstance(e,r){return e instanceof r||e!=null&&e.constructor!=null&&e.constructor.name!=null&&e.constructor.name===r.name}function numberIsNaN(e){return e!==e}var s=function(){var e=\"0123456789abcdef\";var r=new Array(256);for(var t=0;t<16;++t){var f=t*16;for(var n=0;n<16;++n){r[f+n]=e[t]+e[n]}}return r}()},783:function(e,r){\n/*! ieee754. BSD-3-Clause License. Feross Aboukhadijeh <https://feross.org/opensource> */\nr.read=function(e,r,t,f,n){var i,o;var u=n*8-f-1;var a=(1<<u)-1;var s=a>>1;var h=-7;var c=t?n-1:0;var l=t?-1:1;var p=e[r+c];c+=l;i=p&(1<<-h)-1;p>>=-h;h+=u;for(;h>0;i=i*256+e[r+c],c+=l,h-=8){}o=i&(1<<-h)-1;i>>=-h;h+=f;for(;h>0;o=o*256+e[r+c],c+=l,h-=8){}if(i===0){i=1-s}else if(i===a){return o?NaN:(p?-1:1)*Infinity}else{o=o+Math.pow(2,f);i=i-s}return(p?-1:1)*o*Math.pow(2,i-f)};r.write=function(e,r,t,f,n,i){var o,u,a;var s=i*8-n-1;var h=(1<<s)-1;var c=h>>1;var l=n===23?Math.pow(2,-24)-Math.pow(2,-77):0;var p=f?0:i-1;var y=f?1:-1;var g=r<0||r===0&&1/r<0?1:0;r=Math.abs(r);if(isNaN(r)||r===Infinity){u=isNaN(r)?1:0;o=h}else{o=Math.floor(Math.log(r)/Math.LN2);if(r*(a=Math.pow(2,-o))<1){o--;a*=2}if(o+c>=1){r+=l/a}else{r+=l*Math.pow(2,1-c)}if(r*a>=2){o++;a/=2}if(o+c>=h){u=0;o=h}else if(o+c>=1){u=(r*a-1)*Math.pow(2,n);o=o+c}else{u=r*Math.pow(2,c-1)*Math.pow(2,n);o=0}}for(;n>=8;e[t+p]=u&255,p+=y,u/=256,n-=8){}o=o<<n|u;s+=n;for(;s>0;e[t+p]=o&255,p+=y,o/=256,s-=8){}e[t+p-y]|=g*128}}};var r={};function __nccwpck_require__(t){var f=r[t];if(f!==undefined){return f.exports}var n=r[t]={exports:{}};var i=true;try{e[t](n,n.exports,__nccwpck_require__);i=false}finally{if(i)delete r[t]}return n.exports}if(typeof __nccwpck_require__!==\"undefined\")__nccwpck_require__.ab=__dirname+\"/\";var t=__nccwpck_require__(72);module.exports=t})();//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFwcC1wYWdlcy1icm93c2VyKS8uL25vZGVfbW9kdWxlcy9uZXh0L2Rpc3QvY29tcGlsZWQvYnVmZmVyL2luZGV4LmpzIiwibWFwcGluZ3MiOiI7QUFBQSxZQUFZLE9BQU8sa0JBQWtCLGFBQWEsd0JBQXdCLDBCQUEwQiw4QkFBOEIsU0FBUyxTQUFTLHVEQUF1RCx5RUFBeUUsdUJBQXVCLElBQUksS0FBSyxVQUFVLHFCQUFxQix3QkFBd0Isd0JBQXdCLG9CQUFvQixlQUFlLFVBQVUsa0VBQWtFLHFCQUFxQixjQUFjLG9CQUFvQixZQUFZLHVCQUF1QixpQkFBaUIsV0FBVyxXQUFXLGtCQUFrQiw0QkFBNEIsa0JBQWtCLHdCQUF3QixNQUFNLGlCQUFpQixXQUFXLFdBQVcsZ0NBQWdDLFFBQVEsZ0JBQWdCLE1BQU0sUUFBUSxJQUFJLE1BQU0sK0ZBQStGLGlCQUFpQixnQkFBZ0IsYUFBYSxVQUFVLGdEQUFnRCxhQUFhLFVBQVUseUVBQXlFLGdCQUFnQixhQUFhLFNBQVMsNEJBQTRCLGtEQUFrRCw0QkFBNEIsTUFBTSxTQUFTLFlBQVksSUFBSSxNQUFNLHFEQUFxRCwyQkFBMkIsa0JBQWtCLDBCQUEwQixNQUFNLGVBQWUsVUFBVSxTQUFTLFlBQVksa0JBQWtCLElBQUksTUFBTSxxQ0FBcUMsVUFBVSxTQUFTLGdDQUFnQyxlQUFlLHFCQUFxQiwyQ0FBMkMsbUJBQW1CLG9CQUFvQjtBQUM5ckQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGdCQUFnQixhQUFhLCtHQUErRyxnQkFBZ0Isd0JBQXdCLHVCQUF1QixpQkFBaUIsZUFBZSwrQ0FBK0MsaUdBQWlHLGtLQUFrSyw2QkFBNkIsSUFBSSx3QkFBd0IsT0FBTyxlQUFlLFlBQVksOENBQThDLDJCQUEyQixvQkFBb0IsU0FBUyxjQUFjLGlEQUFpRCwrQkFBK0IsMkNBQTJDLG9CQUFvQixFQUFFLGlEQUFpRCwrQkFBK0IsMkNBQTJDLHdCQUF3QixFQUFFLHlCQUF5QixRQUFRLHVFQUF1RSx3QkFBd0IsMENBQTBDLFNBQVMs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Q0FBK0MsY0FBYyxhQUFhLDRCQUE0QixjQUFjLDJCQUEyQixlQUFlLElBQUksS0FBSyxtQ0FBbUMsMkJBQTJCLElBQUksS0FBSyxXQUFXLE9BQU8sS0FBSyxxQkFBcUIsV0FBVyxJQUFJLEtBQUssV0FBVyxJQUFJLElBQUksZ0JBQWdCLHdCQUF3QixNQUFNLEtBQUssa0NBQWtDLEtBQUssS0FBSyxLQUFLLGdDQUFnQyxTQUFTLEtBQUssS0FBSyxJQUFJLGdDQUFnQyxtQkFBbUIsU0FBUyxnQ0FBZ0MsV0FBVyxrQkFBa0IsaUJBQWlCLFlBQVksWUFBWSxXQUFXLElBQUksc0NBQXNDLFFBQVEsUUFBUSxpQkFBaUIsaUJBQWlCLG1FQUFtRSxTQUFTLEtBQUssOEJBQThCLGlCQUFpQiIsInNvdXJjZXMiOlsid2VicGFjazovL19OX0UvLi9ub2RlX21vZHVsZXMvbmV4dC9kaXN0L2NvbXBpbGVkL2J1ZmZlci9pbmRleC5qcz9jYTNhIl0sInNvdXJjZXNDb250ZW50IjpbIihmdW5jdGlvbigpe3ZhciBlPXs2NzU6ZnVuY3Rpb24oZSxyKXtcInVzZSBzdHJpY3RcIjtyLmJ5dGVMZW5ndGg9Ynl0ZUxlbmd0aDtyLnRvQnl0ZUFycmF5PXRvQnl0ZUFycmF5O3IuZnJvbUJ5dGVBcnJheT1mcm9tQnl0ZUFycmF5O3ZhciB0PVtdO3ZhciBmPVtdO3ZhciBuPXR5cGVvZiBVaW50OEFycmF5IT09XCJ1bmRlZmluZWRcIj9VaW50OEFycmF5OkFycmF5O3ZhciBpPVwiQUJDREVGR0hJSktMTU5PUFFSU1RVVldYWVphYmNkZWZnaGlqa2xtbm9wcXJzdHV2d3h5ejAxMjM0NTY3ODkrL1wiO2Zvcih2YXIgbz0wLHU9aS5sZW5ndGg7bzx1Oysrbyl7dFtvXT1pW29dO2ZbaS5jaGFyQ29kZUF0KG8pXT1vfWZbXCItXCIuY2hhckNvZGVBdCgwKV09NjI7ZltcIl9cIi5jaGFyQ29kZUF0KDApXT02MztmdW5jdGlvbiBnZXRMZW5zKGUpe3ZhciByPWUubGVuZ3RoO2lmKHIlND4wKXt0aHJvdyBuZXcgRXJyb3IoXCJJbnZhbGlkIHN0cmluZy4gTGVuZ3RoIG11c3QgYmUgYSBtdWx0aXBsZSBvZiA0XCIpfXZhciB0PWUuaW5kZXhPZihcIj1cIik7aWYodD09PS0xKXQ9cjt2YXIgZj10PT09cj8wOjQtdCU0O3JldHVyblt0LGZdfWZ1bmN0aW9uIGJ5dGVMZW5ndGgoZSl7dmFyIHI9Z2V0TGVucyhlKTt2YXIgdD1yWzBdO3ZhciBmPXJbMV07cmV0dXJuKHQrZikqMy80LWZ9ZnVuY3Rpb24gX2J5dGVMZW5ndGgoZSxyLHQpe3JldHVybihyK3QpKjMvNC10fWZ1bmN0aW9uIHRvQnl0ZUFycmF5KGUpe3ZhciByO3ZhciB0PWdldExlbnMoZSk7dmFyIGk9dFswXTt2YXIgbz10WzFdO3ZhciB1PW5ldyBuKF9ieXRlTGVuZ3RoKGUsaSxvKSk7dmFyIGE9MDt2YXIgcz1vPjA/aS00Omk7dmFyIGg7Zm9yKGg9MDtoPHM7aCs9NCl7cj1mW2UuY2hhckNvZGVBdChoKV08PDE4fGZbZS5jaGFyQ29kZUF0KGgrMSldPDwxMnxmW2UuY2hhckNvZGVBdChoKzIpXTw8NnxmW2UuY2hhckNvZGVBdChoKzMpXTt1W2ErK109cj4+MTYmMjU1O3VbYSsrXT1yPj44JjI1NTt1W2ErK109ciYyNTV9aWYobz09PTIpe3I9ZltlLmNoYXJDb2RlQXQoaCldPDwyfGZbZS5jaGFyQ29kZUF0KGgrMSldPj40O3VbYSsrXT1yJjI1NX1pZihvPT09MSl7cj1mW2UuY2hhckNvZGVBdChoKV08PDEwfGZbZS5jaGFyQ29kZUF0KGgrMSldPDw0fGZbZS5jaGFyQ29kZUF0KGgrMildPj4yO3VbYSsrXT1yPj44JjI1NTt1W2ErK109ciYyNTV9cmV0dXJuIHV9ZnVuY3Rpb24gdHJpcGxldFRvQmFzZTY0KGUpe3JldHVybiB0W2U+PjE4JjYzXSt0W2U+PjEyJjYzXSt0W2U+PjYmNjNdK3RbZSY2M119ZnVuY3Rpb24gZW5jb2RlQ2h1bmsoZSxyLHQpe3ZhciBmO3ZhciBuPVtdO2Zvcih2YXIgaT1yO2k8dDtpKz0zKXtmPShlW2ldPDwxNiYxNjcxMTY4MCkrKGVbaSsxXTw8OCY2NTI4MCkrKGVbaSsyXSYyNTUpO24ucHVzaCh0cmlwbGV0VG9CYXNlNjQoZikpfXJldHVybiBuLmpvaW4oXCJcIil9ZnVuY3Rpb24gZnJvbUJ5dGVBcnJheShlKXt2YXIgcjt2YXIgZj1lLmxlbmd0aDt2YXIgbj1mJTM7dmFyIGk9W107dmFyIG89MTYzODM7Zm9yKHZhciB1PTAsYT1mLW47dTxhO3UrPW8pe2kucHVzaChlbmNvZGVDaHVuayhlLHUsdStvPmE/YTp1K28pKX1pZihuPT09MSl7cj1lW2YtMV07aS5wdXNoKHRbcj4+Ml0rdFtyPDw0JjYzXStcIj09XCIpfWVsc2UgaWYobj09PTIpe3I9KGVbZi0yXTw8OCkrZVtmLTFdO2kucHVzaCh0W3I+PjEwXSt0W3I+PjQmNjNdK3Rbcjw8MiY2M10rXCI9XCIpfXJldHVybiBpLmpvaW4oXCJcIil9fSw3MjpmdW5jdGlvbihlLHIsdCl7XCJ1c2Ugc3RyaWN0XCI7XG4vKiFcbiAqIFRoZSBidWZmZXIgbW9kdWxlIGZyb20gbm9kZS5qcywgZm9yIHRoZSBicm93c2VyLlxuICpcbiAqIEBhdXRob3IgICBGZXJvc3MgQWJvdWtoYWRpamVoIDxodHRwczovL2Zlcm9zcy5vcmc+XG4gKiBAbGljZW5zZSAgTUlUXG4gKi92YXIgZj10KDY3NSk7dmFyIG49dCg3ODMpO3ZhciBpPXR5cGVvZiBTeW1ib2w9PT1cImZ1bmN0aW9uXCImJnR5cGVvZiBTeW1ib2wuZm9yPT09XCJmdW5jdGlvblwiP1N5bWJvbC5mb3IoXCJub2RlanMudXRpbC5pbnNwZWN0LmN1c3RvbVwiKTpudWxsO3IuQnVmZmVyPUJ1ZmZlcjtyLlNsb3dCdWZmZXI9U2xvd0J1ZmZlcjtyLklOU1BFQ1RfTUFYX0JZVEVTPTUwO3ZhciBvPTIxNDc0ODM2NDc7ci5rTWF4TGVuZ3RoPW87QnVmZmVyLlRZUEVEX0FSUkFZX1NVUFBPUlQ9dHlwZWRBcnJheVN1cHBvcnQoKTtpZighQnVmZmVyLlRZUEVEX0FSUkFZX1NVUFBPUlQmJnR5cGVvZiBjb25zb2xlIT09XCJ1bmRlZmluZWRcIiYmdHlwZW9mIGNvbnNvbGUuZXJyb3I9PT1cImZ1bmN0aW9uXCIpe2NvbnNvbGUuZXJyb3IoXCJUaGlzIGJyb3dzZXIgbGFja3MgdHlwZWQgYXJyYXkgKFVpbnQ4QXJyYXkpIHN1cHBvcnQgd2hpY2ggaXMgcmVxdWlyZWQgYnkgXCIrXCJgYnVmZmVyYCB2NS54LiBVc2UgYGJ1ZmZlcmAgdjQueCBpZiB5b3UgcmVxdWlyZSBvbGQgYnJvd3NlciBzdXBwb3J0LlwiKX1mdW5jdGlvbiB0eXBlZEFycmF5U3VwcG9ydCgpe3RyeXt2YXIgZT1uZXcgVWludDhBcnJheSgxKTt2YXIgcj17Zm9vOmZ1bmN0aW9uKCl7cmV0dXJuIDQyfX07T2JqZWN0LnNldFByb3RvdHlwZU9mKHIsVWludDhBcnJheS5wcm90b3R5cGUpO09iamVjdC5zZXRQcm90b3R5cGVPZihlLHIpO3JldHVybiBlLmZvbygpPT09NDJ9Y2F0Y2goZSl7cmV0dXJuIGZhbHNlfX1PYmplY3QuZGVmaW5lUHJvcGVydHkoQnVmZmVyLnByb3RvdHlwZSxcInBhcmVudFwiLHtlbnVtZXJhYmxlOnRydWUsZ2V0OmZ1bmN0aW9uKCl7aWYoIUJ1ZmZlci5pc0J1ZmZlcih0aGlzKSlyZXR1cm4gdW5kZWZpbmVkO3JldHVybiB0aGlzLmJ1ZmZlcn19KTtPYmplY3QuZGVmaW5lUHJvcGVydHkoQnVmZmVyLnByb3RvdHlwZSxcIm9mZnNldFwiLHtlbnVtZXJhYmxlOnRydWUsZ2V0OmZ1bmN0aW9uKCl7aWYoIUJ1ZmZlci5pc0J1ZmZlcih0aGlzKSlyZXR1cm4gdW5kZWZpbmVkO3JldHVybiB0aGlzLmJ5dGVPZmZzZXR9fSk7ZnVuY3Rpb24gY3JlYXRlQnVmZmVyKGUpe2lmKGU+byl7dGhyb3cgbmV3IFJhbmdlRXJyb3IoJ1RoZSB2YWx1ZSBcIicrZSsnXCIgaXMgaW52YWxpZCBmb3Igb3B0aW9uIFwic2l6ZVwiJyl9dmFyIHI9bmV3IFVpbnQ4QXJyYXkoZSk7T2JqZWN0LnNldFByb3RvdHlwZU9mKHIsQnVmZmVyLnByb3RvdHlwZSk7cmV0dXJuIHJ9ZnVuY3Rpb24gQnVmZmVyKGUscix0KXtpZih0eXBlb2YgZT09PVwibnVtYmVyXCIpe2lmKHR5cGVvZiByPT09XCJzdHJpbmdcIil7dGhyb3cgbmV3IFR5cGVFcnJvcignVGhlIFwic3RyaW5nXCIgYXJndW1lbnQgbXVzdCBiZSBvZiB0eXBlIHN0cmluZy4gUmVjZWl2ZWQgdHlwZSBudW1iZXInKX1yZXR1cm4gYWxsb2NVbnNhZmUoZSl9cmV0dXJuIGZyb20oZSxyLHQpfUJ1ZmZlci5wb29sU2l6ZT04MTkyO2Z1bmN0aW9uIGZyb20oZSxyLHQpe2lmKHR5cGVvZiBlPT09XCJzdHJpbmdcIil7cmV0dXJuIGZyb21TdHJpbmcoZSxyKX1pZihBcnJheUJ1ZmZlci5pc1ZpZXcoZSkpe3JldHVybiBmcm9tQXJyYXlMaWtlKGUpfWlmKGU9PW51bGwpe3Rocm93IG5ldyBUeXBlRXJyb3IoXCJUaGUgZmlyc3QgYXJndW1lbnQgbXVzdCBiZSBvbmUgb2YgdHlwZSBzdHJpbmcsIEJ1ZmZlciwgQXJyYXlCdWZmZXIsIEFycmF5LCBcIitcIm9yIEFycmF5LWxpa2UgT2JqZWN0LiBSZWNlaXZlZCB0eXBlIFwiK3R5cGVvZiBlKX1pZihpc0luc3RhbmNlKGUsQXJyYXlCdWZmZXIpfHxlJiZpc0luc3RhbmNlKGUuYnVmZmVyLEFycmF5QnVmZmVyKSl7cmV0dXJuIGZyb21BcnJheUJ1ZmZlcihlLHIsdCl9aWYodHlwZW9mIFNoYXJlZEFycmF5QnVmZmVyIT09XCJ1bmRlZmluZWRcIiYmKGlzSW5zdGFuY2UoZSxTaGFyZWRBcnJheUJ1ZmZlcil8fGUmJmlzSW5zdGFuY2UoZS5idWZmZXIsU2hhcmVkQXJyYXlCdWZmZXIpKSl7cmV0dXJuIGZyb21BcnJheUJ1ZmZlcihlLHIsdCl9aWYodHlwZW9mIGU9PT1cIm51bWJlclwiKXt0aHJvdyBuZXcgVHlwZUVycm9yKCdUaGUgXCJ2YWx1ZVwiIGFyZ3VtZW50IG11c3Qgbm90IGJlIG9mIHR5cGUgbnVtYmVyLiBSZWNlaXZlZCB0eXBlIG51bWJlcicpfXZhciBmPWUudmFsdWVPZiYmZS52YWx1ZU9mKCk7aWYoZiE9bnVsbCYmZiE9PWUpe3JldHVybiBCdWZmZXIuZnJvbShmLHIsdCl9dmFyIG49ZnJvbU9iamVjdChlKTtpZihuKXJldHVybiBuO2lmKHR5cGVvZiBTeW1ib2whPT1cInVuZGVmaW5lZFwiJiZTeW1ib2wudG9QcmltaXRpdmUhPW51bGwmJnR5cGVvZiBlW1N5bWJvbC50b1ByaW1pdGl2ZV09PT1cImZ1bmN0aW9uXCIpe3JldHVybiBCdWZmZXIuZnJvbShlW1N5bWJvbC50b1ByaW1pdGl2ZV0oXCJzdHJpbmdcIikscix0KX10aHJvdyBuZXcgVHlwZUVycm9yKFwiVGhlIGZpcnN0IGFyZ3VtZW50IG11c3QgYmUgb25lIG9mIHR5cGUgc3RyaW5nLCBCdWZmZXIsIEFycmF5QnVmZmVyLCBBcnJheSwgXCIrXCJvciBBcnJheS1saWtlIE9iamVjdC4gUmVjZWl2ZWQgdHlwZSBcIit0eXBlb2YgZSl9QnVmZmVyLmZyb209ZnVuY3Rpb24oZSxyLHQpe3JldHVybiBmcm9tKGUscix0KX07T2JqZWN0LnNldFByb3RvdHlwZU9mKEJ1ZmZlci5wcm90b3R5cGUsVWludDhBcnJheS5wcm90b3R5cGUpO09iamVjdC5zZXRQcm90b3R5cGVPZihCdWZmZXIsVWludDhBcnJheSk7ZnVuY3Rpb24gYXNzZXJ0U2l6ZShlKXtpZih0eXBlb2YgZSE9PVwibnVtYmVyXCIpe3Rocm93IG5ldyBUeXBlRXJyb3IoJ1wic2l6ZVwiIGFyZ3VtZW50IG11c3QgYmUgb2YgdHlwZSBudW1iZXInKX1lbHNlIGlmKGU8MCl7dGhyb3cgbmV3IFJhbmdlRXJyb3IoJ1RoZSB2YWx1ZSBcIicrZSsnXCIgaXMgaW52YWxpZCBmb3Igb3B0aW9uIFwic2l6ZVwiJyl9fWZ1bmN0aW9uIGFsbG9jKGUscix0KXthc3NlcnRTaXplKGUpO2lmKGU8PTApe3JldHVybiBjcmVhdGVCdWZmZXIoZSl9aWYociE9PXVuZGVmaW5lZCl7cmV0dXJuIHR5cGVvZiB0PT09XCJzdHJpbmdcIj9jcmVhdGVCdWZmZXIoZSkuZmlsbChyLHQpOmNyZWF0ZUJ1ZmZlcihlKS5maWxsKHIpfXJldHVybiBjcmVhdGVCdWZmZXIoZSl9QnVmZmVyLmFsbG9jPWZ1bmN0aW9uKGUscix0KXtyZXR1cm4gYWxsb2MoZSxyLHQpfTtmdW5jdGlvbiBhbGxvY1Vuc2FmZShlKXthc3NlcnRTaXplKGUpO3JldHVybiBjcmVhdGVCdWZmZXIoZTwwPzA6Y2hlY2tlZChlKXwwKX1CdWZmZXIuYWxsb2NVbnNhZmU9ZnVuY3Rpb24oZSl7cmV0dXJuIGFsbG9jVW5zYWZlKGUpfTtCdWZmZXIuYWxsb2NVbnNhZmVTbG93PWZ1bmN0aW9uKGUpe3JldHVybiBhbGxvY1Vuc2FmZShlKX07ZnVuY3Rpb24gZnJvbVN0cmluZyhlLHIpe2lmKHR5cGVvZiByIT09XCJzdHJpbmdcInx8cj09PVwiXCIpe3I9XCJ1dGY4XCJ9aWYoIUJ1ZmZlci5pc0VuY29kaW5nKHIpKXt0aHJvdyBuZXcgVHlwZUVycm9yKFwiVW5rbm93biBlbmNvZGluZzogXCIrcil9dmFyIHQ9Ynl0ZUxlbmd0aChlLHIpfDA7dmFyIGY9Y3JlYXRlQnVmZmVyKHQpO3ZhciBuPWYud3JpdGUoZSxyKTtpZihuIT09dCl7Zj1mLnNsaWNlKDAsbil9cmV0dXJuIGZ9ZnVuY3Rpb24gZnJvbUFycmF5TGlrZShlKXt2YXIgcj1lLmxlbmd0aDwwPzA6Y2hlY2tlZChlLmxlbmd0aCl8MDt2YXIgdD1jcmVhdGVCdWZmZXIocik7Zm9yKHZhciBmPTA7ZjxyO2YrPTEpe3RbZl09ZVtmXSYyNTV9cmV0dXJuIHR9ZnVuY3Rpb24gZnJvbUFycmF5QnVmZmVyKGUscix0KXtpZihyPDB8fGUuYnl0ZUxlbmd0aDxyKXt0aHJvdyBuZXcgUmFuZ2VFcnJvcignXCJvZmZzZXRcIiBpcyBvdXRzaWRlIG9mIGJ1ZmZlciBib3VuZHMnKX1pZihlLmJ5dGVMZW5ndGg8cisodHx8MCkpe3Rocm93IG5ldyBSYW5nZUVycm9yKCdcImxlbmd0aFwiIGlzIG91dHNpZGUgb2YgYnVmZmVyIGJvdW5kcycpfXZhciBmO2lmKHI9PT11bmRlZmluZWQmJnQ9PT11bmRlZmluZWQpe2Y9bmV3IFVpbnQ4QXJyYXkoZSl9ZWxzZSBpZih0PT09dW5kZWZpbmVkKXtmPW5ldyBVaW50OEFycmF5KGUscil9ZWxzZXtmPW5ldyBVaW50OEFycmF5KGUscix0KX1PYmplY3Quc2V0UHJvdG90eXBlT2YoZixCdWZmZXIucHJvdG90eXBlKTtyZXR1cm4gZn1mdW5jdGlvbiBmcm9tT2JqZWN0KGUpe2lmKEJ1ZmZlci5pc0J1ZmZlcihlKSl7dmFyIHI9Y2hlY2tlZChlLmxlbmd0aCl8MDt2YXIgdD1jcmVhdGVCdWZmZXIocik7aWYodC5sZW5ndGg9PT0wKXtyZXR1cm4gdH1lLmNvcHkodCwwLDAscik7cmV0dXJuIHR9aWYoZS5sZW5ndGghPT11bmRlZmluZWQpe2lmKHR5cGVvZiBlLmxlbmd0aCE9PVwibnVtYmVyXCJ8fG51bWJlcklzTmFOKGUubGVuZ3RoKSl7cmV0dXJuIGNyZWF0ZUJ1ZmZlcigwKX1yZXR1cm4gZnJvbUFycmF5TGlrZShlKX1pZihlLnR5cGU9PT1cIkJ1ZmZlclwiJiZBcnJheS5pc0FycmF5KGUuZGF0YSkpe3JldHVybiBmcm9tQXJyYXlMaWtlKGUuZGF0YSl9fWZ1bmN0aW9uIGNoZWNrZWQoZSl7aWYoZT49byl7dGhyb3cgbmV3IFJhbmdlRXJyb3IoXCJBdHRlbXB0IHRvIGFsbG9jYXRlIEJ1ZmZlciBsYXJnZXIgdGhhbiBtYXhpbXVtIFwiK1wic2l6ZTogMHhcIitvLnRvU3RyaW5nKDE2KStcIiBieXRlc1wiKX1yZXR1cm4gZXwwfWZ1bmN0aW9uIFNsb3dCdWZmZXIoZSl7aWYoK2UhPWUpe2U9MH1yZXR1cm4gQnVmZmVyLmFsbG9jKCtlKX1CdWZmZXIuaXNCdWZmZXI9ZnVuY3Rpb24gaXNCdWZmZXIoZSl7cmV0dXJuIGUhPW51bGwmJmUuX2lzQnVmZmVyPT09dHJ1ZSYmZSE9PUJ1ZmZlci5wcm90b3R5cGV9O0J1ZmZlci5jb21wYXJlPWZ1bmN0aW9uIGNvbXBhcmUoZSxyKXtpZihpc0luc3RhbmNlKGUsVWludDhBcnJheSkpZT1CdWZmZXIuZnJvbShlLGUub2Zmc2V0LGUuYnl0ZUxlbmd0aCk7aWYoaXNJbnN0YW5jZShyLFVpbnQ4QXJyYXkpKXI9QnVmZmVyLmZyb20ocixyLm9mZnNldCxyLmJ5dGVMZW5ndGgpO2lmKCFCdWZmZXIuaXNCdWZmZXIoZSl8fCFCdWZmZXIuaXNCdWZmZXIocikpe3Rocm93IG5ldyBUeXBlRXJyb3IoJ1RoZSBcImJ1ZjFcIiwgXCJidWYyXCIgYXJndW1lbnRzIG11c3QgYmUgb25lIG9mIHR5cGUgQnVmZmVyIG9yIFVpbnQ4QXJyYXknKX1pZihlPT09cilyZXR1cm4gMDt2YXIgdD1lLmxlbmd0aDt2YXIgZj1yLmxlbmd0aDtmb3IodmFyIG49MCxpPU1hdGgubWluKHQsZik7bjxpOysrbil7aWYoZVtuXSE9PXJbbl0pe3Q9ZVtuXTtmPXJbbl07YnJlYWt9fWlmKHQ8ZilyZXR1cm4tMTtpZihmPHQpcmV0dXJuIDE7cmV0dXJuIDB9O0J1ZmZlci5pc0VuY29kaW5nPWZ1bmN0aW9uIGlzRW5jb2RpbmcoZSl7c3dpdGNoKFN0cmluZyhlKS50b0xvd2VyQ2FzZSgpKXtjYXNlXCJoZXhcIjpjYXNlXCJ1dGY4XCI6Y2FzZVwidXRmLThcIjpjYXNlXCJhc2NpaVwiOmNhc2VcImxhdGluMVwiOmNhc2VcImJpbmFyeVwiOmNhc2VcImJhc2U2NFwiOmNhc2VcInVjczJcIjpjYXNlXCJ1Y3MtMlwiOmNhc2VcInV0ZjE2bGVcIjpjYXNlXCJ1dGYtMTZsZVwiOnJldHVybiB0cnVlO2RlZmF1bHQ6cmV0dXJuIGZhbHNlfX07QnVmZmVyLmNvbmNhdD1mdW5jdGlvbiBjb25jYXQoZSxyKXtpZighQXJyYXkuaXNBcnJheShlKSl7dGhyb3cgbmV3IFR5cGVFcnJvcignXCJsaXN0XCIgYXJndW1lbnQgbXVzdCBiZSBhbiBBcnJheSBvZiBCdWZmZXJzJyl9aWYoZS5sZW5ndGg9PT0wKXtyZXR1cm4gQnVmZmVyLmFsbG9jKDApfXZhciB0O2lmKHI9PT11bmRlZmluZWQpe3I9MDtmb3IodD0wO3Q8ZS5sZW5ndGg7Kyt0KXtyKz1lW3RdLmxlbmd0aH19dmFyIGY9QnVmZmVyLmFsbG9jVW5zYWZlKHIpO3ZhciBuPTA7Zm9yKHQ9MDt0PGUubGVuZ3RoOysrdCl7dmFyIGk9ZVt0XTtpZihpc0luc3RhbmNlKGksVWludDhBcnJheSkpe2k9QnVmZmVyLmZyb20oaSl9aWYoIUJ1ZmZlci5pc0J1ZmZlcihpKSl7dGhyb3cgbmV3IFR5cGVFcnJvcignXCJsaXN0XCIgYXJndW1lbnQgbXVzdCBiZSBhbiBBcnJheSBvZiBCdWZmZXJzJyl9aS5jb3B5KGYsbik7bis9aS5sZW5ndGh9cmV0dXJuIGZ9O2Z1bmN0aW9uIGJ5dGVMZW5ndGgoZSxyKXtpZihCdWZmZXIuaXNCdWZmZXIoZSkpe3JldHVybiBlLmxlbmd0aH1pZihBcnJheUJ1ZmZlci5pc1ZpZXcoZSl8fGlzSW5zdGFuY2UoZSxBcnJheUJ1ZmZlcikpe3JldHVybiBlLmJ5dGVMZW5ndGh9aWYodHlwZW9mIGUhPT1cInN0cmluZ1wiKXt0aHJvdyBuZXcgVHlwZUVycm9yKCdUaGUgXCJzdHJpbmdcIiBhcmd1bWVudCBtdXN0IGJlIG9uZSBvZiB0eXBlIHN0cmluZywgQnVmZmVyLCBvciBBcnJheUJ1ZmZlci4gJytcIlJlY2VpdmVkIHR5cGUgXCIrdHlwZW9mIGUpfXZhciB0PWUubGVuZ3RoO3ZhciBmPWFyZ3VtZW50cy5sZW5ndGg+MiYmYXJndW1lbnRzWzJdPT09dHJ1ZTtpZighZiYmdD09PTApcmV0dXJuIDA7dmFyIG49ZmFsc2U7Zm9yKDs7KXtzd2l0Y2gocil7Y2FzZVwiYXNjaWlcIjpjYXNlXCJsYXRpbjFcIjpjYXNlXCJiaW5hcnlcIjpyZXR1cm4gdDtjYXNlXCJ1dGY4XCI6Y2FzZVwidXRmLThcIjpyZXR1cm4gdXRmOFRvQnl0ZXMoZSkubGVuZ3RoO2Nhc2VcInVjczJcIjpjYXNlXCJ1Y3MtMlwiOmNhc2VcInV0ZjE2bGVcIjpjYXNlXCJ1dGYtMTZsZVwiOnJldHVybiB0KjI7Y2FzZVwiaGV4XCI6cmV0dXJuIHQ+Pj4xO2Nhc2VcImJhc2U2NFwiOnJldHVybiBiYXNlNjRUb0J5dGVzKGUpLmxlbmd0aDtkZWZhdWx0OmlmKG4pe3JldHVybiBmPy0xOnV0ZjhUb0J5dGVzKGUpLmxlbmd0aH1yPShcIlwiK3IpLnRvTG93ZXJDYXNlKCk7bj10cnVlfX19QnVmZmVyLmJ5dGVMZW5ndGg9Ynl0ZUxlbmd0aDtmdW5jdGlvbiBzbG93VG9TdHJpbmcoZSxyLHQpe3ZhciBmPWZhbHNlO2lmKHI9PT11bmRlZmluZWR8fHI8MCl7cj0wfWlmKHI+dGhpcy5sZW5ndGgpe3JldHVyblwiXCJ9aWYodD09PXVuZGVmaW5lZHx8dD50aGlzLmxlbmd0aCl7dD10aGlzLmxlbmd0aH1pZih0PD0wKXtyZXR1cm5cIlwifXQ+Pj49MDtyPj4+PTA7aWYodDw9cil7cmV0dXJuXCJcIn1pZighZSllPVwidXRmOFwiO3doaWxlKHRydWUpe3N3aXRjaChlKXtjYXNlXCJoZXhcIjpyZXR1cm4gaGV4U2xpY2UodGhpcyxyLHQpO2Nhc2VcInV0ZjhcIjpjYXNlXCJ1dGYtOFwiOnJldHVybiB1dGY4U2xpY2UodGhpcyxyLHQpO2Nhc2VcImFzY2lpXCI6cmV0dXJuIGFzY2lpU2xpY2UodGhpcyxyLHQpO2Nhc2VcImxhdGluMVwiOmNhc2VcImJpbmFyeVwiOnJldHVybiBsYXRpbjFTbGljZSh0aGlzLHIsdCk7Y2FzZVwiYmFzZTY0XCI6cmV0dXJuIGJhc2U2NFNsaWNlKHRoaXMscix0KTtjYXNlXCJ1Y3MyXCI6Y2FzZVwidWNzLTJcIjpjYXNlXCJ1dGYxNmxlXCI6Y2FzZVwidXRmLTE2bGVcIjpyZXR1cm4gdXRmMTZsZVNsaWNlKHRoaXMscix0KTtkZWZhdWx0OmlmKGYpdGhyb3cgbmV3IFR5cGVFcnJvcihcIlVua25vd24gZW5jb2Rpbmc6IFwiK2UpO2U9KGUrXCJcIikudG9Mb3dlckNhc2UoKTtmPXRydWV9fX1CdWZmZXIucHJvdG90eXBlLl9pc0J1ZmZlcj10cnVlO2Z1bmN0aW9uIHN3YXAoZSxyLHQpe3ZhciBmPWVbcl07ZVtyXT1lW3RdO2VbdF09Zn1CdWZmZXIucHJvdG90eXBlLnN3YXAxNj1mdW5jdGlvbiBzd2FwMTYoKXt2YXIgZT10aGlzLmxlbmd0aDtpZihlJTIhPT0wKXt0aHJvdyBuZXcgUmFuZ2VFcnJvcihcIkJ1ZmZlciBzaXplIG11c3QgYmUgYSBtdWx0aXBsZSBvZiAxNi1iaXRzXCIpfWZvcih2YXIgcj0wO3I8ZTtyKz0yKXtzd2FwKHRoaXMscixyKzEpfXJldHVybiB0aGlzfTtCdWZmZXIucHJvdG90eXBlLnN3YXAzMj1mdW5jdGlvbiBzd2FwMzIoKXt2YXIgZT10aGlzLmxlbmd0aDtpZihlJTQhPT0wKXt0aHJvdyBuZXcgUmFuZ2VFcnJvcihcIkJ1ZmZlciBzaXplIG11c3QgYmUgYSBtdWx0aXBsZSBvZiAzMi1iaXRzXCIpfWZvcih2YXIgcj0wO3I8ZTtyKz00KXtzd2FwKHRoaXMscixyKzMpO3N3YXAodGhpcyxyKzEscisyKX1yZXR1cm4gdGhpc307QnVmZmVyLnByb3RvdHlwZS5zd2FwNjQ9ZnVuY3Rpb24gc3dhcDY0KCl7dmFyIGU9dGhpcy5sZW5ndGg7aWYoZSU4IT09MCl7dGhyb3cgbmV3IFJhbmdlRXJyb3IoXCJCdWZmZXIgc2l6ZSBtdXN0IGJlIGEgbXVsdGlwbGUgb2YgNjQtYml0c1wiKX1mb3IodmFyIHI9MDtyPGU7cis9OCl7c3dhcCh0aGlzLHIscis3KTtzd2FwKHRoaXMscisxLHIrNik7c3dhcCh0aGlzLHIrMixyKzUpO3N3YXAodGhpcyxyKzMscis0KX1yZXR1cm4gdGhpc307QnVmZmVyLnByb3RvdHlwZS50b1N0cmluZz1mdW5jdGlvbiB0b1N0cmluZygpe3ZhciBlPXRoaXMubGVuZ3RoO2lmKGU9PT0wKXJldHVyblwiXCI7aWYoYXJndW1lbnRzLmxlbmd0aD09PTApcmV0dXJuIHV0ZjhTbGljZSh0aGlzLDAsZSk7cmV0dXJuIHNsb3dUb1N0cmluZy5hcHBseSh0aGlzLGFyZ3VtZW50cyl9O0J1ZmZlci5wcm90b3R5cGUudG9Mb2NhbGVTdHJpbmc9QnVmZmVyLnByb3RvdHlwZS50b1N0cmluZztCdWZmZXIucHJvdG90eXBlLmVxdWFscz1mdW5jdGlvbiBlcXVhbHMoZSl7aWYoIUJ1ZmZlci5pc0J1ZmZlcihlKSl0aHJvdyBuZXcgVHlwZUVycm9yKFwiQXJndW1lbnQgbXVzdCBiZSBhIEJ1ZmZlclwiKTtpZih0aGlzPT09ZSlyZXR1cm4gdHJ1ZTtyZXR1cm4gQnVmZmVyLmNvbXBhcmUodGhpcyxlKT09PTB9O0J1ZmZlci5wcm90b3R5cGUuaW5zcGVjdD1mdW5jdGlvbiBpbnNwZWN0KCl7dmFyIGU9XCJcIjt2YXIgdD1yLklOU1BFQ1RfTUFYX0JZVEVTO2U9dGhpcy50b1N0cmluZyhcImhleFwiLDAsdCkucmVwbGFjZSgvKC57Mn0pL2csXCIkMSBcIikudHJpbSgpO2lmKHRoaXMubGVuZ3RoPnQpZSs9XCIgLi4uIFwiO3JldHVyblwiPEJ1ZmZlciBcIitlK1wiPlwifTtpZihpKXtCdWZmZXIucHJvdG90eXBlW2ldPUJ1ZmZlci5wcm90b3R5cGUuaW5zcGVjdH1CdWZmZXIucHJvdG90eXBlLmNvbXBhcmU9ZnVuY3Rpb24gY29tcGFyZShlLHIsdCxmLG4pe2lmKGlzSW5zdGFuY2UoZSxVaW50OEFycmF5KSl7ZT1CdWZmZXIuZnJvbShlLGUub2Zmc2V0LGUuYnl0ZUxlbmd0aCl9aWYoIUJ1ZmZlci5pc0J1ZmZlcihlKSl7dGhyb3cgbmV3IFR5cGVFcnJvcignVGhlIFwidGFyZ2V0XCIgYXJndW1lbnQgbXVzdCBiZSBvbmUgb2YgdHlwZSBCdWZmZXIgb3IgVWludDhBcnJheS4gJytcIlJlY2VpdmVkIHR5cGUgXCIrdHlwZW9mIGUpfWlmKHI9PT11bmRlZmluZWQpe3I9MH1pZih0PT09dW5kZWZpbmVkKXt0PWU/ZS5sZW5ndGg6MH1pZihmPT09dW5kZWZpbmVkKXtmPTB9aWYobj09PXVuZGVmaW5lZCl7bj10aGlzLmxlbmd0aH1pZihyPDB8fHQ+ZS5sZW5ndGh8fGY8MHx8bj50aGlzLmxlbmd0aCl7dGhyb3cgbmV3IFJhbmdlRXJyb3IoXCJvdXQgb2YgcmFuZ2UgaW5kZXhcIil9aWYoZj49biYmcj49dCl7cmV0dXJuIDB9aWYoZj49bil7cmV0dXJuLTF9aWYocj49dCl7cmV0dXJuIDF9cj4+Pj0wO3Q+Pj49MDtmPj4+PTA7bj4+Pj0wO2lmKHRoaXM9PT1lKXJldHVybiAwO3ZhciBpPW4tZjt2YXIgbz10LXI7dmFyIHU9TWF0aC5taW4oaSxvKTt2YXIgYT10aGlzLnNsaWNlKGYsbik7dmFyIHM9ZS5zbGljZShyLHQpO2Zvcih2YXIgaD0wO2g8dTsrK2gpe2lmKGFbaF0hPT1zW2hdKXtpPWFbaF07bz1zW2hdO2JyZWFrfX1pZihpPG8pcmV0dXJuLTE7aWYobzxpKXJldHVybiAxO3JldHVybiAwfTtmdW5jdGlvbiBiaWRpcmVjdGlvbmFsSW5kZXhPZihlLHIsdCxmLG4pe2lmKGUubGVuZ3RoPT09MClyZXR1cm4tMTtpZih0eXBlb2YgdD09PVwic3RyaW5nXCIpe2Y9dDt0PTB9ZWxzZSBpZih0PjIxNDc0ODM2NDcpe3Q9MjE0NzQ4MzY0N31lbHNlIGlmKHQ8LTIxNDc0ODM2NDgpe3Q9LTIxNDc0ODM2NDh9dD0rdDtpZihudW1iZXJJc05hTih0KSl7dD1uPzA6ZS5sZW5ndGgtMX1pZih0PDApdD1lLmxlbmd0aCt0O2lmKHQ+PWUubGVuZ3RoKXtpZihuKXJldHVybi0xO2Vsc2UgdD1lLmxlbmd0aC0xfWVsc2UgaWYodDwwKXtpZihuKXQ9MDtlbHNlIHJldHVybi0xfWlmKHR5cGVvZiByPT09XCJzdHJpbmdcIil7cj1CdWZmZXIuZnJvbShyLGYpfWlmKEJ1ZmZlci5pc0J1ZmZlcihyKSl7aWYoci5sZW5ndGg9PT0wKXtyZXR1cm4tMX1yZXR1cm4gYXJyYXlJbmRleE9mKGUscix0LGYsbil9ZWxzZSBpZih0eXBlb2Ygcj09PVwibnVtYmVyXCIpe3I9ciYyNTU7aWYodHlwZW9mIFVpbnQ4QXJyYXkucHJvdG90eXBlLmluZGV4T2Y9PT1cImZ1bmN0aW9uXCIpe2lmKG4pe3JldHVybiBVaW50OEFycmF5LnByb3RvdHlwZS5pbmRleE9mLmNhbGwoZSxyLHQpfWVsc2V7cmV0dXJuIFVpbnQ4QXJyYXkucHJvdG90eXBlLmxhc3RJbmRleE9mLmNhbGwoZSxyLHQpfX1yZXR1cm4gYXJyYXlJbmRleE9mKGUsW3JdLHQsZixuKX10aHJvdyBuZXcgVHlwZUVycm9yKFwidmFsIG11c3QgYmUgc3RyaW5nLCBudW1iZXIgb3IgQnVmZmVyXCIpfWZ1bmN0aW9uIGFycmF5SW5kZXhPZihlLHIsdCxmLG4pe3ZhciBpPTE7dmFyIG89ZS5sZW5ndGg7dmFyIHU9ci5sZW5ndGg7aWYoZiE9PXVuZGVmaW5lZCl7Zj1TdHJpbmcoZikudG9Mb3dlckNhc2UoKTtpZihmPT09XCJ1Y3MyXCJ8fGY9PT1cInVjcy0yXCJ8fGY9PT1cInV0ZjE2bGVcInx8Zj09PVwidXRmLTE2bGVcIil7aWYoZS5sZW5ndGg8Mnx8ci5sZW5ndGg8Mil7cmV0dXJuLTF9aT0yO28vPTI7dS89Mjt0Lz0yfX1mdW5jdGlvbiByZWFkKGUscil7aWYoaT09PTEpe3JldHVybiBlW3JdfWVsc2V7cmV0dXJuIGUucmVhZFVJbnQxNkJFKHIqaSl9fXZhciBhO2lmKG4pe3ZhciBzPS0xO2ZvcihhPXQ7YTxvO2ErKyl7aWYocmVhZChlLGEpPT09cmVhZChyLHM9PT0tMT8wOmEtcykpe2lmKHM9PT0tMSlzPWE7aWYoYS1zKzE9PT11KXJldHVybiBzKml9ZWxzZXtpZihzIT09LTEpYS09YS1zO3M9LTF9fX1lbHNle2lmKHQrdT5vKXQ9by11O2ZvcihhPXQ7YT49MDthLS0pe3ZhciBoPXRydWU7Zm9yKHZhciBjPTA7Yzx1O2MrKyl7aWYocmVhZChlLGErYykhPT1yZWFkKHIsYykpe2g9ZmFsc2U7YnJlYWt9fWlmKGgpcmV0dXJuIGF9fXJldHVybi0xfUJ1ZmZlci5wcm90b3R5cGUuaW5jbHVkZXM9ZnVuY3Rpb24gaW5jbHVkZXMoZSxyLHQpe3JldHVybiB0aGlzLmluZGV4T2YoZSxyLHQpIT09LTF9O0J1ZmZlci5wcm90b3R5cGUuaW5kZXhPZj1mdW5jdGlvbiBpbmRleE9mKGUscix0KXtyZXR1cm4gYmlkaXJlY3Rpb25hbEluZGV4T2YodGhpcyxlLHIsdCx0cnVlKX07QnVmZmVyLnByb3RvdHlwZS5sYXN0SW5kZXhPZj1mdW5jdGlvbiBsYXN0SW5kZXhPZihlLHIsdCl7cmV0dXJuIGJpZGlyZWN0aW9uYWxJbmRleE9mKHRoaXMsZSxyLHQsZmFsc2UpfTtmdW5jdGlvbiBoZXhXcml0ZShlLHIsdCxmKXt0PU51bWJlcih0KXx8MDt2YXIgbj1lLmxlbmd0aC10O2lmKCFmKXtmPW59ZWxzZXtmPU51bWJlcihmKTtpZihmPm4pe2Y9bn19dmFyIGk9ci5sZW5ndGg7aWYoZj5pLzIpe2Y9aS8yfWZvcih2YXIgbz0wO288ZjsrK28pe3ZhciB1PXBhcnNlSW50KHIuc3Vic3RyKG8qMiwyKSwxNik7aWYobnVtYmVySXNOYU4odSkpcmV0dXJuIG87ZVt0K29dPXV9cmV0dXJuIG99ZnVuY3Rpb24gdXRmOFdyaXRlKGUscix0LGYpe3JldHVybiBibGl0QnVmZmVyKHV0ZjhUb0J5dGVzKHIsZS5sZW5ndGgtdCksZSx0LGYpfWZ1bmN0aW9uIGFzY2lpV3JpdGUoZSxyLHQsZil7cmV0dXJuIGJsaXRCdWZmZXIoYXNjaWlUb0J5dGVzKHIpLGUsdCxmKX1mdW5jdGlvbiBsYXRpbjFXcml0ZShlLHIsdCxmKXtyZXR1cm4gYXNjaWlXcml0ZShlLHIsdCxmKX1mdW5jdGlvbiBiYXNlNjRXcml0ZShlLHIsdCxmKXtyZXR1cm4gYmxpdEJ1ZmZlcihiYXNlNjRUb0J5dGVzKHIpLGUsdCxmKX1mdW5jdGlvbiB1Y3MyV3JpdGUoZSxyLHQsZil7cmV0dXJuIGJsaXRCdWZmZXIodXRmMTZsZVRvQnl0ZXMocixlLmxlbmd0aC10KSxlLHQsZil9QnVmZmVyLnByb3RvdHlwZS53cml0ZT1mdW5jdGlvbiB3cml0ZShlLHIsdCxmKXtpZihyPT09dW5kZWZpbmVkKXtmPVwidXRmOFwiO3Q9dGhpcy5sZW5ndGg7cj0wfWVsc2UgaWYodD09PXVuZGVmaW5lZCYmdHlwZW9mIHI9PT1cInN0cmluZ1wiKXtmPXI7dD10aGlzLmxlbmd0aDtyPTB9ZWxzZSBpZihpc0Zpbml0ZShyKSl7cj1yPj4+MDtpZihpc0Zpbml0ZSh0KSl7dD10Pj4+MDtpZihmPT09dW5kZWZpbmVkKWY9XCJ1dGY4XCJ9ZWxzZXtmPXQ7dD11bmRlZmluZWR9fWVsc2V7dGhyb3cgbmV3IEVycm9yKFwiQnVmZmVyLndyaXRlKHN0cmluZywgZW5jb2RpbmcsIG9mZnNldFssIGxlbmd0aF0pIGlzIG5vIGxvbmdlciBzdXBwb3J0ZWRcIil9dmFyIG49dGhpcy5sZW5ndGgtcjtpZih0PT09dW5kZWZpbmVkfHx0Pm4pdD1uO2lmKGUubGVuZ3RoPjAmJih0PDB8fHI8MCl8fHI+dGhpcy5sZW5ndGgpe3Rocm93IG5ldyBSYW5nZUVycm9yKFwiQXR0ZW1wdCB0byB3cml0ZSBvdXRzaWRlIGJ1ZmZlciBib3VuZHNcIil9aWYoIWYpZj1cInV0ZjhcIjt2YXIgaT1mYWxzZTtmb3IoOzspe3N3aXRjaChmKXtjYXNlXCJoZXhcIjpyZXR1cm4gaGV4V3JpdGUodGhpcyxlLHIsdCk7Y2FzZVwidXRmOFwiOmNhc2VcInV0Zi04XCI6cmV0dXJuIHV0ZjhXcml0ZSh0aGlzLGUscix0KTtjYXNlXCJhc2NpaVwiOnJldHVybiBhc2NpaVdyaXRlKHRoaXMsZSxyLHQpO2Nhc2VcImxhdGluMVwiOmNhc2VcImJpbmFyeVwiOnJldHVybiBsYXRpbjFXcml0ZSh0aGlzLGUscix0KTtjYXNlXCJiYXNlNjRcIjpyZXR1cm4gYmFzZTY0V3JpdGUodGhpcyxlLHIsdCk7Y2FzZVwidWNzMlwiOmNhc2VcInVjcy0yXCI6Y2FzZVwidXRmMTZsZVwiOmNhc2VcInV0Zi0xNmxlXCI6cmV0dXJuIHVjczJXcml0ZSh0aGlzLGUscix0KTtkZWZhdWx0OmlmKGkpdGhyb3cgbmV3IFR5cGVFcnJvcihcIlVua25vd24gZW5jb2Rpbmc6IFwiK2YpO2Y9KFwiXCIrZikudG9Mb3dlckNhc2UoKTtpPXRydWV9fX07QnVmZmVyLnByb3RvdHlwZS50b0pTT049ZnVuY3Rpb24gdG9KU09OKCl7cmV0dXJue3R5cGU6XCJCdWZmZXJcIixkYXRhOkFycmF5LnByb3RvdHlwZS5zbGljZS5jYWxsKHRoaXMuX2Fycnx8dGhpcywwKX19O2Z1bmN0aW9uIGJhc2U2NFNsaWNlKGUscix0KXtpZihyPT09MCYmdD09PWUubGVuZ3RoKXtyZXR1cm4gZi5mcm9tQnl0ZUFycmF5KGUpfWVsc2V7cmV0dXJuIGYuZnJvbUJ5dGVBcnJheShlLnNsaWNlKHIsdCkpfX1mdW5jdGlvbiB1dGY4U2xpY2UoZSxyLHQpe3Q9TWF0aC5taW4oZS5sZW5ndGgsdCk7dmFyIGY9W107dmFyIG49cjt3aGlsZShuPHQpe3ZhciBpPWVbbl07dmFyIG89bnVsbDt2YXIgdT1pPjIzOT80Omk+MjIzPzM6aT4xOTE/MjoxO2lmKG4rdTw9dCl7dmFyIGEscyxoLGM7c3dpdGNoKHUpe2Nhc2UgMTppZihpPDEyOCl7bz1pfWJyZWFrO2Nhc2UgMjphPWVbbisxXTtpZigoYSYxOTIpPT09MTI4KXtjPShpJjMxKTw8NnxhJjYzO2lmKGM+MTI3KXtvPWN9fWJyZWFrO2Nhc2UgMzphPWVbbisxXTtzPWVbbisyXTtpZigoYSYxOTIpPT09MTI4JiYocyYxOTIpPT09MTI4KXtjPShpJjE1KTw8MTJ8KGEmNjMpPDw2fHMmNjM7aWYoYz4yMDQ3JiYoYzw1NTI5Nnx8Yz41NzM0Mykpe289Y319YnJlYWs7Y2FzZSA0OmE9ZVtuKzFdO3M9ZVtuKzJdO2g9ZVtuKzNdO2lmKChhJjE5Mik9PT0xMjgmJihzJjE5Mik9PT0xMjgmJihoJjE5Mik9PT0xMjgpe2M9KGkmMTUpPDwxOHwoYSY2Myk8PDEyfChzJjYzKTw8NnxoJjYzO2lmKGM+NjU1MzUmJmM8MTExNDExMil7bz1jfX19fWlmKG89PT1udWxsKXtvPTY1NTMzO3U9MX1lbHNlIGlmKG8+NjU1MzUpe28tPTY1NTM2O2YucHVzaChvPj4+MTAmMTAyM3w1NTI5Nik7bz01NjMyMHxvJjEwMjN9Zi5wdXNoKG8pO24rPXV9cmV0dXJuIGRlY29kZUNvZGVQb2ludHNBcnJheShmKX12YXIgdT00MDk2O2Z1bmN0aW9uIGRlY29kZUNvZGVQb2ludHNBcnJheShlKXt2YXIgcj1lLmxlbmd0aDtpZihyPD11KXtyZXR1cm4gU3RyaW5nLmZyb21DaGFyQ29kZS5hcHBseShTdHJpbmcsZSl9dmFyIHQ9XCJcIjt2YXIgZj0wO3doaWxlKGY8cil7dCs9U3RyaW5nLmZyb21DaGFyQ29kZS5hcHBseShTdHJpbmcsZS5zbGljZShmLGYrPXUpKX1yZXR1cm4gdH1mdW5jdGlvbiBhc2NpaVNsaWNlKGUscix0KXt2YXIgZj1cIlwiO3Q9TWF0aC5taW4oZS5sZW5ndGgsdCk7Zm9yKHZhciBuPXI7bjx0Oysrbil7Zis9U3RyaW5nLmZyb21DaGFyQ29kZShlW25dJjEyNyl9cmV0dXJuIGZ9ZnVuY3Rpb24gbGF0aW4xU2xpY2UoZSxyLHQpe3ZhciBmPVwiXCI7dD1NYXRoLm1pbihlLmxlbmd0aCx0KTtmb3IodmFyIG49cjtuPHQ7KytuKXtmKz1TdHJpbmcuZnJvbUNoYXJDb2RlKGVbbl0pfXJldHVybiBmfWZ1bmN0aW9uIGhleFNsaWNlKGUscix0KXt2YXIgZj1lLmxlbmd0aDtpZighcnx8cjwwKXI9MDtpZighdHx8dDwwfHx0PmYpdD1mO3ZhciBuPVwiXCI7Zm9yKHZhciBpPXI7aTx0OysraSl7bis9c1tlW2ldXX1yZXR1cm4gbn1mdW5jdGlvbiB1dGYxNmxlU2xpY2UoZSxyLHQpe3ZhciBmPWUuc2xpY2Uocix0KTt2YXIgbj1cIlwiO2Zvcih2YXIgaT0wO2k8Zi5sZW5ndGg7aSs9Mil7bis9U3RyaW5nLmZyb21DaGFyQ29kZShmW2ldK2ZbaSsxXSoyNTYpfXJldHVybiBufUJ1ZmZlci5wcm90b3R5cGUuc2xpY2U9ZnVuY3Rpb24gc2xpY2UoZSxyKXt2YXIgdD10aGlzLmxlbmd0aDtlPX5+ZTtyPXI9PT11bmRlZmluZWQ/dDp+fnI7aWYoZTwwKXtlKz10O2lmKGU8MCllPTB9ZWxzZSBpZihlPnQpe2U9dH1pZihyPDApe3IrPXQ7aWYocjwwKXI9MH1lbHNlIGlmKHI+dCl7cj10fWlmKHI8ZSlyPWU7dmFyIGY9dGhpcy5zdWJhcnJheShlLHIpO09iamVjdC5zZXRQcm90b3R5cGVPZihmLEJ1ZmZlci5wcm90b3R5cGUpO3JldHVybiBmfTtmdW5jdGlvbiBjaGVja09mZnNldChlLHIsdCl7aWYoZSUxIT09MHx8ZTwwKXRocm93IG5ldyBSYW5nZUVycm9yKFwib2Zmc2V0IGlzIG5vdCB1aW50XCIpO2lmKGUrcj50KXRocm93IG5ldyBSYW5nZUVycm9yKFwiVHJ5aW5nIHRvIGFjY2VzcyBiZXlvbmQgYnVmZmVyIGxlbmd0aFwiKX1CdWZmZXIucHJvdG90eXBlLnJlYWRVSW50TEU9ZnVuY3Rpb24gcmVhZFVJbnRMRShlLHIsdCl7ZT1lPj4+MDtyPXI+Pj4wO2lmKCF0KWNoZWNrT2Zmc2V0KGUscix0aGlzLmxlbmd0aCk7dmFyIGY9dGhpc1tlXTt2YXIgbj0xO3ZhciBpPTA7d2hpbGUoKytpPHImJihuKj0yNTYpKXtmKz10aGlzW2UraV0qbn1yZXR1cm4gZn07QnVmZmVyLnByb3RvdHlwZS5yZWFkVUludEJFPWZ1bmN0aW9uIHJlYWRVSW50QkUoZSxyLHQpe2U9ZT4+PjA7cj1yPj4+MDtpZighdCl7Y2hlY2tPZmZzZXQoZSxyLHRoaXMubGVuZ3RoKX12YXIgZj10aGlzW2UrLS1yXTt2YXIgbj0xO3doaWxlKHI+MCYmKG4qPTI1Nikpe2YrPXRoaXNbZSstLXJdKm59cmV0dXJuIGZ9O0J1ZmZlci5wcm90b3R5cGUucmVhZFVJbnQ4PWZ1bmN0aW9uIHJlYWRVSW50OChlLHIpe2U9ZT4+PjA7aWYoIXIpY2hlY2tPZmZzZXQoZSwxLHRoaXMubGVuZ3RoKTtyZXR1cm4gdGhpc1tlXX07QnVmZmVyLnByb3RvdHlwZS5yZWFkVUludDE2TEU9ZnVuY3Rpb24gcmVhZFVJbnQxNkxFKGUscil7ZT1lPj4+MDtpZighciljaGVja09mZnNldChlLDIsdGhpcy5sZW5ndGgpO3JldHVybiB0aGlzW2VdfHRoaXNbZSsxXTw8OH07QnVmZmVyLnByb3RvdHlwZS5yZWFkVUludDE2QkU9ZnVuY3Rpb24gcmVhZFVJbnQxNkJFKGUscil7ZT1lPj4+MDtpZighciljaGVja09mZnNldChlLDIsdGhpcy5sZW5ndGgpO3JldHVybiB0aGlzW2VdPDw4fHRoaXNbZSsxXX07QnVmZmVyLnByb3RvdHlwZS5yZWFkVUludDMyTEU9ZnVuY3Rpb24gcmVhZFVJbnQzMkxFKGUscil7ZT1lPj4+MDtpZighciljaGVja09mZnNldChlLDQsdGhpcy5sZW5ndGgpO3JldHVybih0aGlzW2VdfHRoaXNbZSsxXTw8OHx0aGlzW2UrMl08PDE2KSt0aGlzW2UrM10qMTY3NzcyMTZ9O0J1ZmZlci5wcm90b3R5cGUucmVhZFVJbnQzMkJFPWZ1bmN0aW9uIHJlYWRVSW50MzJCRShlLHIpe2U9ZT4+PjA7aWYoIXIpY2hlY2tPZmZzZXQoZSw0LHRoaXMubGVuZ3RoKTtyZXR1cm4gdGhpc1tlXSoxNjc3NzIxNisodGhpc1tlKzFdPDwxNnx0aGlzW2UrMl08PDh8dGhpc1tlKzNdKX07QnVmZmVyLnByb3RvdHlwZS5yZWFkSW50TEU9ZnVuY3Rpb24gcmVhZEludExFKGUscix0KXtlPWU+Pj4wO3I9cj4+PjA7aWYoIXQpY2hlY2tPZmZzZXQoZSxyLHRoaXMubGVuZ3RoKTt2YXIgZj10aGlzW2VdO3ZhciBuPTE7dmFyIGk9MDt3aGlsZSgrK2k8ciYmKG4qPTI1Nikpe2YrPXRoaXNbZStpXSpufW4qPTEyODtpZihmPj1uKWYtPU1hdGgucG93KDIsOCpyKTtyZXR1cm4gZn07QnVmZmVyLnByb3RvdHlwZS5yZWFkSW50QkU9ZnVuY3Rpb24gcmVhZEludEJFKGUscix0KXtlPWU+Pj4wO3I9cj4+PjA7aWYoIXQpY2hlY2tPZmZzZXQoZSxyLHRoaXMubGVuZ3RoKTt2YXIgZj1yO3ZhciBuPTE7dmFyIGk9dGhpc1tlKy0tZl07d2hpbGUoZj4wJiYobio9MjU2KSl7aSs9dGhpc1tlKy0tZl0qbn1uKj0xMjg7aWYoaT49bilpLT1NYXRoLnBvdygyLDgqcik7cmV0dXJuIGl9O0J1ZmZlci5wcm90b3R5cGUucmVhZEludDg9ZnVuY3Rpb24gcmVhZEludDgoZSxyKXtlPWU+Pj4wO2lmKCFyKWNoZWNrT2Zmc2V0KGUsMSx0aGlzLmxlbmd0aCk7aWYoISh0aGlzW2VdJjEyOCkpcmV0dXJuIHRoaXNbZV07cmV0dXJuKDI1NS10aGlzW2VdKzEpKi0xfTtCdWZmZXIucHJvdG90eXBlLnJlYWRJbnQxNkxFPWZ1bmN0aW9uIHJlYWRJbnQxNkxFKGUscil7ZT1lPj4+MDtpZighciljaGVja09mZnNldChlLDIsdGhpcy5sZW5ndGgpO3ZhciB0PXRoaXNbZV18dGhpc1tlKzFdPDw4O3JldHVybiB0JjMyNzY4P3R8NDI5NDkwMTc2MDp0fTtCdWZmZXIucHJvdG90eXBlLnJlYWRJbnQxNkJFPWZ1bmN0aW9uIHJlYWRJbnQxNkJFKGUscil7ZT1lPj4+MDtpZighciljaGVja09mZnNldChlLDIsdGhpcy5sZW5ndGgpO3ZhciB0PXRoaXNbZSsxXXx0aGlzW2VdPDw4O3JldHVybiB0JjMyNzY4P3R8NDI5NDkwMTc2MDp0fTtCdWZmZXIucHJvdG90eXBlLnJlYWRJbnQzMkxFPWZ1bmN0aW9uIHJlYWRJbnQzMkxFKGUscil7ZT1lPj4+MDtpZighciljaGVja09mZnNldChlLDQsdGhpcy5sZW5ndGgpO3JldHVybiB0aGlzW2VdfHRoaXNbZSsxXTw8OHx0aGlzW2UrMl08PDE2fHRoaXNbZSszXTw8MjR9O0J1ZmZlci5wcm90b3R5cGUucmVhZEludDMyQkU9ZnVuY3Rpb24gcmVhZEludDMyQkUoZSxyKXtlPWU+Pj4wO2lmKCFyKWNoZWNrT2Zmc2V0KGUsNCx0aGlzLmxlbmd0aCk7cmV0dXJuIHRoaXNbZV08PDI0fHRoaXNbZSsxXTw8MTZ8dGhpc1tlKzJdPDw4fHRoaXNbZSszXX07QnVmZmVyLnByb3RvdHlwZS5yZWFkRmxvYXRMRT1mdW5jdGlvbiByZWFkRmxvYXRMRShlLHIpe2U9ZT4+PjA7aWYoIXIpY2hlY2tPZmZzZXQoZSw0LHRoaXMubGVuZ3RoKTtyZXR1cm4gbi5yZWFkKHRoaXMsZSx0cnVlLDIzLDQpfTtCdWZmZXIucHJvdG90eXBlLnJlYWRGbG9hdEJFPWZ1bmN0aW9uIHJlYWRGbG9hdEJFKGUscil7ZT1lPj4+MDtpZighciljaGVja09mZnNldChlLDQsdGhpcy5sZW5ndGgpO3JldHVybiBuLnJlYWQodGhpcyxlLGZhbHNlLDIzLDQpfTtCdWZmZXIucHJvdG90eXBlLnJlYWREb3VibGVMRT1mdW5jdGlvbiByZWFkRG91YmxlTEUoZSxyKXtlPWU+Pj4wO2lmKCFyKWNoZWNrT2Zmc2V0KGUsOCx0aGlzLmxlbmd0aCk7cmV0dXJuIG4ucmVhZCh0aGlzLGUsdHJ1ZSw1Miw4KX07QnVmZmVyLnByb3RvdHlwZS5yZWFkRG91YmxlQkU9ZnVuY3Rpb24gcmVhZERvdWJsZUJFKGUscil7ZT1lPj4+MDtpZighciljaGVja09mZnNldChlLDgsdGhpcy5sZW5ndGgpO3JldHVybiBuLnJlYWQodGhpcyxlLGZhbHNlLDUyLDgpfTtmdW5jdGlvbiBjaGVja0ludChlLHIsdCxmLG4saSl7aWYoIUJ1ZmZlci5pc0J1ZmZlcihlKSl0aHJvdyBuZXcgVHlwZUVycm9yKCdcImJ1ZmZlclwiIGFyZ3VtZW50IG11c3QgYmUgYSBCdWZmZXIgaW5zdGFuY2UnKTtpZihyPm58fHI8aSl0aHJvdyBuZXcgUmFuZ2VFcnJvcignXCJ2YWx1ZVwiIGFyZ3VtZW50IGlzIG91dCBvZiBib3VuZHMnKTtpZih0K2Y+ZS5sZW5ndGgpdGhyb3cgbmV3IFJhbmdlRXJyb3IoXCJJbmRleCBvdXQgb2YgcmFuZ2VcIil9QnVmZmVyLnByb3RvdHlwZS53cml0ZVVJbnRMRT1mdW5jdGlvbiB3cml0ZVVJbnRMRShlLHIsdCxmKXtlPStlO3I9cj4+PjA7dD10Pj4+MDtpZighZil7dmFyIG49TWF0aC5wb3coMiw4KnQpLTE7Y2hlY2tJbnQodGhpcyxlLHIsdCxuLDApfXZhciBpPTE7dmFyIG89MDt0aGlzW3JdPWUmMjU1O3doaWxlKCsrbzx0JiYoaSo9MjU2KSl7dGhpc1tyK29dPWUvaSYyNTV9cmV0dXJuIHIrdH07QnVmZmVyLnByb3RvdHlwZS53cml0ZVVJbnRCRT1mdW5jdGlvbiB3cml0ZVVJbnRCRShlLHIsdCxmKXtlPStlO3I9cj4+PjA7dD10Pj4+MDtpZighZil7dmFyIG49TWF0aC5wb3coMiw4KnQpLTE7Y2hlY2tJbnQodGhpcyxlLHIsdCxuLDApfXZhciBpPXQtMTt2YXIgbz0xO3RoaXNbcitpXT1lJjI1NTt3aGlsZSgtLWk+PTAmJihvKj0yNTYpKXt0aGlzW3IraV09ZS9vJjI1NX1yZXR1cm4gcit0fTtCdWZmZXIucHJvdG90eXBlLndyaXRlVUludDg9ZnVuY3Rpb24gd3JpdGVVSW50OChlLHIsdCl7ZT0rZTtyPXI+Pj4wO2lmKCF0KWNoZWNrSW50KHRoaXMsZSxyLDEsMjU1LDApO3RoaXNbcl09ZSYyNTU7cmV0dXJuIHIrMX07QnVmZmVyLnByb3RvdHlwZS53cml0ZVVJbnQxNkxFPWZ1bmN0aW9uIHdyaXRlVUludDE2TEUoZSxyLHQpe2U9K2U7cj1yPj4+MDtpZighdCljaGVja0ludCh0aGlzLGUsciwyLDY1NTM1LDApO3RoaXNbcl09ZSYyNTU7dGhpc1tyKzFdPWU+Pj44O3JldHVybiByKzJ9O0J1ZmZlci5wcm90b3R5cGUud3JpdGVVSW50MTZCRT1mdW5jdGlvbiB3cml0ZVVJbnQxNkJFKGUscix0KXtlPStlO3I9cj4+PjA7aWYoIXQpY2hlY2tJbnQodGhpcyxlLHIsMiw2NTUzNSwwKTt0aGlzW3JdPWU+Pj44O3RoaXNbcisxXT1lJjI1NTtyZXR1cm4gcisyfTtCdWZmZXIucHJvdG90eXBlLndyaXRlVUludDMyTEU9ZnVuY3Rpb24gd3JpdGVVSW50MzJMRShlLHIsdCl7ZT0rZTtyPXI+Pj4wO2lmKCF0KWNoZWNrSW50KHRoaXMsZSxyLDQsNDI5NDk2NzI5NSwwKTt0aGlzW3IrM109ZT4+PjI0O3RoaXNbcisyXT1lPj4+MTY7dGhpc1tyKzFdPWU+Pj44O3RoaXNbcl09ZSYyNTU7cmV0dXJuIHIrNH07QnVmZmVyLnByb3RvdHlwZS53cml0ZVVJbnQzMkJFPWZ1bmN0aW9uIHdyaXRlVUludDMyQkUoZSxyLHQpe2U9K2U7cj1yPj4+MDtpZighdCljaGVja0ludCh0aGlzLGUsciw0LDQyOTQ5NjcyOTUsMCk7dGhpc1tyXT1lPj4+MjQ7dGhpc1tyKzFdPWU+Pj4xNjt0aGlzW3IrMl09ZT4+Pjg7dGhpc1tyKzNdPWUmMjU1O3JldHVybiByKzR9O0J1ZmZlci5wcm90b3R5cGUud3JpdGVJbnRMRT1mdW5jdGlvbiB3cml0ZUludExFKGUscix0LGYpe2U9K2U7cj1yPj4+MDtpZighZil7dmFyIG49TWF0aC5wb3coMiw4KnQtMSk7Y2hlY2tJbnQodGhpcyxlLHIsdCxuLTEsLW4pfXZhciBpPTA7dmFyIG89MTt2YXIgdT0wO3RoaXNbcl09ZSYyNTU7d2hpbGUoKytpPHQmJihvKj0yNTYpKXtpZihlPDAmJnU9PT0wJiZ0aGlzW3IraS0xXSE9PTApe3U9MX10aGlzW3IraV09KGUvbz4+MCktdSYyNTV9cmV0dXJuIHIrdH07QnVmZmVyLnByb3RvdHlwZS53cml0ZUludEJFPWZ1bmN0aW9uIHdyaXRlSW50QkUoZSxyLHQsZil7ZT0rZTtyPXI+Pj4wO2lmKCFmKXt2YXIgbj1NYXRoLnBvdygyLDgqdC0xKTtjaGVja0ludCh0aGlzLGUscix0LG4tMSwtbil9dmFyIGk9dC0xO3ZhciBvPTE7dmFyIHU9MDt0aGlzW3IraV09ZSYyNTU7d2hpbGUoLS1pPj0wJiYobyo9MjU2KSl7aWYoZTwwJiZ1PT09MCYmdGhpc1tyK2krMV0hPT0wKXt1PTF9dGhpc1tyK2ldPShlL28+PjApLXUmMjU1fXJldHVybiByK3R9O0J1ZmZlci5wcm90b3R5cGUud3JpdGVJbnQ4PWZ1bmN0aW9uIHdyaXRlSW50OChlLHIsdCl7ZT0rZTtyPXI+Pj4wO2lmKCF0KWNoZWNrSW50KHRoaXMsZSxyLDEsMTI3LC0xMjgpO2lmKGU8MCllPTI1NStlKzE7dGhpc1tyXT1lJjI1NTtyZXR1cm4gcisxfTtCdWZmZXIucHJvdG90eXBlLndyaXRlSW50MTZMRT1mdW5jdGlvbiB3cml0ZUludDE2TEUoZSxyLHQpe2U9K2U7cj1yPj4+MDtpZighdCljaGVja0ludCh0aGlzLGUsciwyLDMyNzY3LC0zMjc2OCk7dGhpc1tyXT1lJjI1NTt0aGlzW3IrMV09ZT4+Pjg7cmV0dXJuIHIrMn07QnVmZmVyLnByb3RvdHlwZS53cml0ZUludDE2QkU9ZnVuY3Rpb24gd3JpdGVJbnQxNkJFKGUscix0KXtlPStlO3I9cj4+PjA7aWYoIXQpY2hlY2tJbnQodGhpcyxlLHIsMiwzMjc2NywtMzI3NjgpO3RoaXNbcl09ZT4+Pjg7dGhpc1tyKzFdPWUmMjU1O3JldHVybiByKzJ9O0J1ZmZlci5wcm90b3R5cGUud3JpdGVJbnQzMkxFPWZ1bmN0aW9uIHdyaXRlSW50MzJMRShlLHIsdCl7ZT0rZTtyPXI+Pj4wO2lmKCF0KWNoZWNrSW50KHRoaXMsZSxyLDQsMjE0NzQ4MzY0NywtMjE0NzQ4MzY0OCk7dGhpc1tyXT1lJjI1NTt0aGlzW3IrMV09ZT4+Pjg7dGhpc1tyKzJdPWU+Pj4xNjt0aGlzW3IrM109ZT4+PjI0O3JldHVybiByKzR9O0J1ZmZlci5wcm90b3R5cGUud3JpdGVJbnQzMkJFPWZ1bmN0aW9uIHdyaXRlSW50MzJCRShlLHIsdCl7ZT0rZTtyPXI+Pj4wO2lmKCF0KWNoZWNrSW50KHRoaXMsZSxyLDQsMjE0NzQ4MzY0NywtMjE0NzQ4MzY0OCk7aWYoZTwwKWU9NDI5NDk2NzI5NStlKzE7dGhpc1tyXT1lPj4+MjQ7dGhpc1tyKzFdPWU+Pj4xNjt0aGlzW3IrMl09ZT4+Pjg7dGhpc1tyKzNdPWUmMjU1O3JldHVybiByKzR9O2Z1bmN0aW9uIGNoZWNrSUVFRTc1NChlLHIsdCxmLG4saSl7aWYodCtmPmUubGVuZ3RoKXRocm93IG5ldyBSYW5nZUVycm9yKFwiSW5kZXggb3V0IG9mIHJhbmdlXCIpO2lmKHQ8MCl0aHJvdyBuZXcgUmFuZ2VFcnJvcihcIkluZGV4IG91dCBvZiByYW5nZVwiKX1mdW5jdGlvbiB3cml0ZUZsb2F0KGUscix0LGYsaSl7cj0rcjt0PXQ+Pj4wO2lmKCFpKXtjaGVja0lFRUU3NTQoZSxyLHQsNCwzNDAyODIzNDY2Mzg1Mjg4NmUyMiwtMzQwMjgyMzQ2NjM4NTI4ODZlMjIpfW4ud3JpdGUoZSxyLHQsZiwyMyw0KTtyZXR1cm4gdCs0fUJ1ZmZlci5wcm90b3R5cGUud3JpdGVGbG9hdExFPWZ1bmN0aW9uIHdyaXRlRmxvYXRMRShlLHIsdCl7cmV0dXJuIHdyaXRlRmxvYXQodGhpcyxlLHIsdHJ1ZSx0KX07QnVmZmVyLnByb3RvdHlwZS53cml0ZUZsb2F0QkU9ZnVuY3Rpb24gd3JpdGVGbG9hdEJFKGUscix0KXtyZXR1cm4gd3JpdGVGbG9hdCh0aGlzLGUscixmYWxzZSx0KX07ZnVuY3Rpb24gd3JpdGVEb3VibGUoZSxyLHQsZixpKXtyPStyO3Q9dD4+PjA7aWYoIWkpe2NoZWNrSUVFRTc1NChlLHIsdCw4LDE3OTc2OTMxMzQ4NjIzMTU3ZTI5MiwtMTc5NzY5MzEzNDg2MjMxNTdlMjkyKX1uLndyaXRlKGUscix0LGYsNTIsOCk7cmV0dXJuIHQrOH1CdWZmZXIucHJvdG90eXBlLndyaXRlRG91YmxlTEU9ZnVuY3Rpb24gd3JpdGVEb3VibGVMRShlLHIsdCl7cmV0dXJuIHdyaXRlRG91YmxlKHRoaXMsZSxyLHRydWUsdCl9O0J1ZmZlci5wcm90b3R5cGUud3JpdGVEb3VibGVCRT1mdW5jdGlvbiB3cml0ZURvdWJsZUJFKGUscix0KXtyZXR1cm4gd3JpdGVEb3VibGUodGhpcyxlLHIsZmFsc2UsdCl9O0J1ZmZlci5wcm90b3R5cGUuY29weT1mdW5jdGlvbiBjb3B5KGUscix0LGYpe2lmKCFCdWZmZXIuaXNCdWZmZXIoZSkpdGhyb3cgbmV3IFR5cGVFcnJvcihcImFyZ3VtZW50IHNob3VsZCBiZSBhIEJ1ZmZlclwiKTtpZighdCl0PTA7aWYoIWYmJmYhPT0wKWY9dGhpcy5sZW5ndGg7aWYocj49ZS5sZW5ndGgpcj1lLmxlbmd0aDtpZighcilyPTA7aWYoZj4wJiZmPHQpZj10O2lmKGY9PT10KXJldHVybiAwO2lmKGUubGVuZ3RoPT09MHx8dGhpcy5sZW5ndGg9PT0wKXJldHVybiAwO2lmKHI8MCl7dGhyb3cgbmV3IFJhbmdlRXJyb3IoXCJ0YXJnZXRTdGFydCBvdXQgb2YgYm91bmRzXCIpfWlmKHQ8MHx8dD49dGhpcy5sZW5ndGgpdGhyb3cgbmV3IFJhbmdlRXJyb3IoXCJJbmRleCBvdXQgb2YgcmFuZ2VcIik7aWYoZjwwKXRocm93IG5ldyBSYW5nZUVycm9yKFwic291cmNlRW5kIG91dCBvZiBib3VuZHNcIik7aWYoZj50aGlzLmxlbmd0aClmPXRoaXMubGVuZ3RoO2lmKGUubGVuZ3RoLXI8Zi10KXtmPWUubGVuZ3RoLXIrdH12YXIgbj1mLXQ7aWYodGhpcz09PWUmJnR5cGVvZiBVaW50OEFycmF5LnByb3RvdHlwZS5jb3B5V2l0aGluPT09XCJmdW5jdGlvblwiKXt0aGlzLmNvcHlXaXRoaW4ocix0LGYpfWVsc2UgaWYodGhpcz09PWUmJnQ8ciYmcjxmKXtmb3IodmFyIGk9bi0xO2k+PTA7LS1pKXtlW2krcl09dGhpc1tpK3RdfX1lbHNle1VpbnQ4QXJyYXkucHJvdG90eXBlLnNldC5jYWxsKGUsdGhpcy5zdWJhcnJheSh0LGYpLHIpfXJldHVybiBufTtCdWZmZXIucHJvdG90eXBlLmZpbGw9ZnVuY3Rpb24gZmlsbChlLHIsdCxmKXtpZih0eXBlb2YgZT09PVwic3RyaW5nXCIpe2lmKHR5cGVvZiByPT09XCJzdHJpbmdcIil7Zj1yO3I9MDt0PXRoaXMubGVuZ3RofWVsc2UgaWYodHlwZW9mIHQ9PT1cInN0cmluZ1wiKXtmPXQ7dD10aGlzLmxlbmd0aH1pZihmIT09dW5kZWZpbmVkJiZ0eXBlb2YgZiE9PVwic3RyaW5nXCIpe3Rocm93IG5ldyBUeXBlRXJyb3IoXCJlbmNvZGluZyBtdXN0IGJlIGEgc3RyaW5nXCIpfWlmKHR5cGVvZiBmPT09XCJzdHJpbmdcIiYmIUJ1ZmZlci5pc0VuY29kaW5nKGYpKXt0aHJvdyBuZXcgVHlwZUVycm9yKFwiVW5rbm93biBlbmNvZGluZzogXCIrZil9aWYoZS5sZW5ndGg9PT0xKXt2YXIgbj1lLmNoYXJDb2RlQXQoMCk7aWYoZj09PVwidXRmOFwiJiZuPDEyOHx8Zj09PVwibGF0aW4xXCIpe2U9bn19fWVsc2UgaWYodHlwZW9mIGU9PT1cIm51bWJlclwiKXtlPWUmMjU1fWVsc2UgaWYodHlwZW9mIGU9PT1cImJvb2xlYW5cIil7ZT1OdW1iZXIoZSl9aWYocjwwfHx0aGlzLmxlbmd0aDxyfHx0aGlzLmxlbmd0aDx0KXt0aHJvdyBuZXcgUmFuZ2VFcnJvcihcIk91dCBvZiByYW5nZSBpbmRleFwiKX1pZih0PD1yKXtyZXR1cm4gdGhpc31yPXI+Pj4wO3Q9dD09PXVuZGVmaW5lZD90aGlzLmxlbmd0aDp0Pj4+MDtpZighZSllPTA7dmFyIGk7aWYodHlwZW9mIGU9PT1cIm51bWJlclwiKXtmb3IoaT1yO2k8dDsrK2kpe3RoaXNbaV09ZX19ZWxzZXt2YXIgbz1CdWZmZXIuaXNCdWZmZXIoZSk/ZTpCdWZmZXIuZnJvbShlLGYpO3ZhciB1PW8ubGVuZ3RoO2lmKHU9PT0wKXt0aHJvdyBuZXcgVHlwZUVycm9yKCdUaGUgdmFsdWUgXCInK2UrJ1wiIGlzIGludmFsaWQgZm9yIGFyZ3VtZW50IFwidmFsdWVcIicpfWZvcihpPTA7aTx0LXI7KytpKXt0aGlzW2krcl09b1tpJXVdfX1yZXR1cm4gdGhpc307dmFyIGE9L1teKy8wLTlBLVphLXotX10vZztmdW5jdGlvbiBiYXNlNjRjbGVhbihlKXtlPWUuc3BsaXQoXCI9XCIpWzBdO2U9ZS50cmltKCkucmVwbGFjZShhLFwiXCIpO2lmKGUubGVuZ3RoPDIpcmV0dXJuXCJcIjt3aGlsZShlLmxlbmd0aCU0IT09MCl7ZT1lK1wiPVwifXJldHVybiBlfWZ1bmN0aW9uIHV0ZjhUb0J5dGVzKGUscil7cj1yfHxJbmZpbml0eTt2YXIgdDt2YXIgZj1lLmxlbmd0aDt2YXIgbj1udWxsO3ZhciBpPVtdO2Zvcih2YXIgbz0wO288ZjsrK28pe3Q9ZS5jaGFyQ29kZUF0KG8pO2lmKHQ+NTUyOTUmJnQ8NTczNDQpe2lmKCFuKXtpZih0PjU2MzE5KXtpZigoci09Myk+LTEpaS5wdXNoKDIzOSwxOTEsMTg5KTtjb250aW51ZX1lbHNlIGlmKG8rMT09PWYpe2lmKChyLT0zKT4tMSlpLnB1c2goMjM5LDE5MSwxODkpO2NvbnRpbnVlfW49dDtjb250aW51ZX1pZih0PDU2MzIwKXtpZigoci09Myk+LTEpaS5wdXNoKDIzOSwxOTEsMTg5KTtuPXQ7Y29udGludWV9dD0obi01NTI5Njw8MTB8dC01NjMyMCkrNjU1MzZ9ZWxzZSBpZihuKXtpZigoci09Myk+LTEpaS5wdXNoKDIzOSwxOTEsMTg5KX1uPW51bGw7aWYodDwxMjgpe2lmKChyLT0xKTwwKWJyZWFrO2kucHVzaCh0KX1lbHNlIGlmKHQ8MjA0OCl7aWYoKHItPTIpPDApYnJlYWs7aS5wdXNoKHQ+PjZ8MTkyLHQmNjN8MTI4KX1lbHNlIGlmKHQ8NjU1MzYpe2lmKChyLT0zKTwwKWJyZWFrO2kucHVzaCh0Pj4xMnwyMjQsdD4+NiY2M3wxMjgsdCY2M3wxMjgpfWVsc2UgaWYodDwxMTE0MTEyKXtpZigoci09NCk8MClicmVhaztpLnB1c2godD4+MTh8MjQwLHQ+PjEyJjYzfDEyOCx0Pj42JjYzfDEyOCx0JjYzfDEyOCl9ZWxzZXt0aHJvdyBuZXcgRXJyb3IoXCJJbnZhbGlkIGNvZGUgcG9pbnRcIil9fXJldHVybiBpfWZ1bmN0aW9uIGFzY2lpVG9CeXRlcyhlKXt2YXIgcj1bXTtmb3IodmFyIHQ9MDt0PGUubGVuZ3RoOysrdCl7ci5wdXNoKGUuY2hhckNvZGVBdCh0KSYyNTUpfXJldHVybiByfWZ1bmN0aW9uIHV0ZjE2bGVUb0J5dGVzKGUscil7dmFyIHQsZixuO3ZhciBpPVtdO2Zvcih2YXIgbz0wO288ZS5sZW5ndGg7KytvKXtpZigoci09Mik8MClicmVhazt0PWUuY2hhckNvZGVBdChvKTtmPXQ+Pjg7bj10JTI1NjtpLnB1c2gobik7aS5wdXNoKGYpfXJldHVybiBpfWZ1bmN0aW9uIGJhc2U2NFRvQnl0ZXMoZSl7cmV0dXJuIGYudG9CeXRlQXJyYXkoYmFzZTY0Y2xlYW4oZSkpfWZ1bmN0aW9uIGJsaXRCdWZmZXIoZSxyLHQsZil7Zm9yKHZhciBuPTA7bjxmOysrbil7aWYobit0Pj1yLmxlbmd0aHx8bj49ZS5sZW5ndGgpYnJlYWs7cltuK3RdPWVbbl19cmV0dXJuIG59ZnVuY3Rpb24gaXNJbnN0YW5jZShlLHIpe3JldHVybiBlIGluc3RhbmNlb2Ygcnx8ZSE9bnVsbCYmZS5jb25zdHJ1Y3RvciE9bnVsbCYmZS5jb25zdHJ1Y3Rvci5uYW1lIT1udWxsJiZlLmNvbnN0cnVjdG9yLm5hbWU9PT1yLm5hbWV9ZnVuY3Rpb24gbnVtYmVySXNOYU4oZSl7cmV0dXJuIGUhPT1lfXZhciBzPWZ1bmN0aW9uKCl7dmFyIGU9XCIwMTIzNDU2Nzg5YWJjZGVmXCI7dmFyIHI9bmV3IEFycmF5KDI1Nik7Zm9yKHZhciB0PTA7dDwxNjsrK3Qpe3ZhciBmPXQqMTY7Zm9yKHZhciBuPTA7bjwxNjsrK24pe3JbZituXT1lW3RdK2Vbbl19fXJldHVybiByfSgpfSw3ODM6ZnVuY3Rpb24oZSxyKXtcbi8qISBpZWVlNzU0LiBCU0QtMy1DbGF1c2UgTGljZW5zZS4gRmVyb3NzIEFib3VraGFkaWplaCA8aHR0cHM6Ly9mZXJvc3Mub3JnL29wZW5zb3VyY2U+ICovXG5yLnJlYWQ9ZnVuY3Rpb24oZSxyLHQsZixuKXt2YXIgaSxvO3ZhciB1PW4qOC1mLTE7dmFyIGE9KDE8PHUpLTE7dmFyIHM9YT4+MTt2YXIgaD0tNzt2YXIgYz10P24tMTowO3ZhciBsPXQ/LTE6MTt2YXIgcD1lW3IrY107Yys9bDtpPXAmKDE8PC1oKS0xO3A+Pj0taDtoKz11O2Zvcig7aD4wO2k9aSoyNTYrZVtyK2NdLGMrPWwsaC09OCl7fW89aSYoMTw8LWgpLTE7aT4+PS1oO2grPWY7Zm9yKDtoPjA7bz1vKjI1NitlW3IrY10sYys9bCxoLT04KXt9aWYoaT09PTApe2k9MS1zfWVsc2UgaWYoaT09PWEpe3JldHVybiBvP05hTjoocD8tMToxKSpJbmZpbml0eX1lbHNle289bytNYXRoLnBvdygyLGYpO2k9aS1zfXJldHVybihwPy0xOjEpKm8qTWF0aC5wb3coMixpLWYpfTtyLndyaXRlPWZ1bmN0aW9uKGUscix0LGYsbixpKXt2YXIgbyx1LGE7dmFyIHM9aSo4LW4tMTt2YXIgaD0oMTw8cyktMTt2YXIgYz1oPj4xO3ZhciBsPW49PT0yMz9NYXRoLnBvdygyLC0yNCktTWF0aC5wb3coMiwtNzcpOjA7dmFyIHA9Zj8wOmktMTt2YXIgeT1mPzE6LTE7dmFyIGc9cjwwfHxyPT09MCYmMS9yPDA/MTowO3I9TWF0aC5hYnMocik7aWYoaXNOYU4ocil8fHI9PT1JbmZpbml0eSl7dT1pc05hTihyKT8xOjA7bz1ofWVsc2V7bz1NYXRoLmZsb29yKE1hdGgubG9nKHIpL01hdGguTE4yKTtpZihyKihhPU1hdGgucG93KDIsLW8pKTwxKXtvLS07YSo9Mn1pZihvK2M+PTEpe3IrPWwvYX1lbHNle3IrPWwqTWF0aC5wb3coMiwxLWMpfWlmKHIqYT49Mil7bysrO2EvPTJ9aWYobytjPj1oKXt1PTA7bz1ofWVsc2UgaWYobytjPj0xKXt1PShyKmEtMSkqTWF0aC5wb3coMixuKTtvPW8rY31lbHNle3U9cipNYXRoLnBvdygyLGMtMSkqTWF0aC5wb3coMixuKTtvPTB9fWZvcig7bj49ODtlW3QrcF09dSYyNTUscCs9eSx1Lz0yNTYsbi09OCl7fW89bzw8bnx1O3MrPW47Zm9yKDtzPjA7ZVt0K3BdPW8mMjU1LHArPXksby89MjU2LHMtPTgpe31lW3QrcC15XXw9ZyoxMjh9fX07dmFyIHI9e307ZnVuY3Rpb24gX19uY2N3cGNrX3JlcXVpcmVfXyh0KXt2YXIgZj1yW3RdO2lmKGYhPT11bmRlZmluZWQpe3JldHVybiBmLmV4cG9ydHN9dmFyIG49clt0XT17ZXhwb3J0czp7fX07dmFyIGk9dHJ1ZTt0cnl7ZVt0XShuLG4uZXhwb3J0cyxfX25jY3dwY2tfcmVxdWlyZV9fKTtpPWZhbHNlfWZpbmFsbHl7aWYoaSlkZWxldGUgclt0XX1yZXR1cm4gbi5leHBvcnRzfWlmKHR5cGVvZiBfX25jY3dwY2tfcmVxdWlyZV9fIT09XCJ1bmRlZmluZWRcIilfX25jY3dwY2tfcmVxdWlyZV9fLmFiPV9fZGlybmFtZStcIi9cIjt2YXIgdD1fX25jY3dwY2tfcmVxdWlyZV9fKDcyKTttb2R1bGUuZXhwb3J0cz10fSkoKTsiXSwibmFtZXMiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(app-pages-browser)/./node_modules/next/dist/compiled/buffer/index.js\n"));

/***/ }),

/***/ "(app-pages-browser)/./node_modules/next/dist/compiled/process/browser.js":
/*!************************************************************!*\
  !*** ./node_modules/next/dist/compiled/process/browser.js ***!
  \************************************************************/
/***/ (function(module, __unused_webpack_exports, __webpack_require__) {

eval(__webpack_require__.ts("var __dirname = \"/\";\n(function(){var e={229:function(e){var t=e.exports={};var r;var n;function defaultSetTimout(){throw new Error(\"setTimeout has not been defined\")}function defaultClearTimeout(){throw new Error(\"clearTimeout has not been defined\")}(function(){try{if(typeof setTimeout===\"function\"){r=setTimeout}else{r=defaultSetTimout}}catch(e){r=defaultSetTimout}try{if(typeof clearTimeout===\"function\"){n=clearTimeout}else{n=defaultClearTimeout}}catch(e){n=defaultClearTimeout}})();function runTimeout(e){if(r===setTimeout){return setTimeout(e,0)}if((r===defaultSetTimout||!r)&&setTimeout){r=setTimeout;return setTimeout(e,0)}try{return r(e,0)}catch(t){try{return r.call(null,e,0)}catch(t){return r.call(this,e,0)}}}function runClearTimeout(e){if(n===clearTimeout){return clearTimeout(e)}if((n===defaultClearTimeout||!n)&&clearTimeout){n=clearTimeout;return clearTimeout(e)}try{return n(e)}catch(t){try{return n.call(null,e)}catch(t){return n.call(this,e)}}}var i=[];var o=false;var u;var a=-1;function cleanUpNextTick(){if(!o||!u){return}o=false;if(u.length){i=u.concat(i)}else{a=-1}if(i.length){drainQueue()}}function drainQueue(){if(o){return}var e=runTimeout(cleanUpNextTick);o=true;var t=i.length;while(t){u=i;i=[];while(++a<t){if(u){u[a].run()}}a=-1;t=i.length}u=null;o=false;runClearTimeout(e)}t.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1){for(var r=1;r<arguments.length;r++){t[r-1]=arguments[r]}}i.push(new Item(e,t));if(i.length===1&&!o){runTimeout(drainQueue)}};function Item(e,t){this.fun=e;this.array=t}Item.prototype.run=function(){this.fun.apply(null,this.array)};t.title=\"browser\";t.browser=true;t.env={};t.argv=[];t.version=\"\";t.versions={};function noop(){}t.on=noop;t.addListener=noop;t.once=noop;t.off=noop;t.removeListener=noop;t.removeAllListeners=noop;t.emit=noop;t.prependListener=noop;t.prependOnceListener=noop;t.listeners=function(e){return[]};t.binding=function(e){throw new Error(\"process.binding is not supported\")};t.cwd=function(){return\"/\"};t.chdir=function(e){throw new Error(\"process.chdir is not supported\")};t.umask=function(){return 0}}};var t={};function __nccwpck_require__(r){var n=t[r];if(n!==undefined){return n.exports}var i=t[r]={exports:{}};var o=true;try{e[r](i,i.exports,__nccwpck_require__);o=false}finally{if(o)delete t[r]}return i.exports}if(typeof __nccwpck_require__!==\"undefined\")__nccwpck_require__.ab=__dirname+\"/\";var r=__nccwpck_require__(229);module.exports=r})();//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFwcC1wYWdlcy1icm93c2VyKS8uL25vZGVfbW9kdWxlcy9uZXh0L2Rpc3QvY29tcGlsZWQvcHJvY2Vzcy9icm93c2VyLmpzIiwibWFwcGluZ3MiOiI7QUFBQSxZQUFZLE9BQU8sZ0JBQWdCLG1CQUFtQixNQUFNLE1BQU0sNEJBQTRCLG1EQUFtRCwrQkFBK0IscURBQXFELFlBQVksSUFBSSxtQ0FBbUMsYUFBYSxLQUFLLG9CQUFvQixTQUFTLG1CQUFtQixJQUFJLHFDQUFxQyxlQUFlLEtBQUssdUJBQXVCLFNBQVMsdUJBQXVCLElBQUksdUJBQXVCLG1CQUFtQix1QkFBdUIsMkNBQTJDLGFBQWEsdUJBQXVCLElBQUksY0FBYyxTQUFTLElBQUksd0JBQXdCLFNBQVMsMEJBQTBCLDRCQUE0QixxQkFBcUIsdUJBQXVCLGdEQUFnRCxlQUFlLHVCQUF1QixJQUFJLFlBQVksU0FBUyxJQUFJLHNCQUFzQixTQUFTLHdCQUF3QixTQUFTLFlBQVksTUFBTSxTQUFTLDJCQUEyQixXQUFXLE9BQU8sUUFBUSxhQUFhLGNBQWMsS0FBSyxLQUFLLGFBQWEsY0FBYyxzQkFBc0IsTUFBTSxPQUFPLGtDQUFrQyxPQUFPLGVBQWUsU0FBUyxJQUFJLEtBQUssYUFBYSxNQUFNLFlBQVksS0FBSyxXQUFXLE9BQU8sUUFBUSxtQkFBbUIsdUJBQXVCLG9DQUFvQyx1QkFBdUIsWUFBWSxtQkFBbUIsS0FBSyxxQkFBcUIsc0JBQXNCLHFCQUFxQix5QkFBeUIsbUJBQW1CLFdBQVcsYUFBYSw4QkFBOEIsaUNBQWlDLGtCQUFrQixlQUFlLFNBQVMsVUFBVSxhQUFhLGNBQWMsaUJBQWlCLFVBQVUsbUJBQW1CLFlBQVksV0FBVyxzQkFBc0IsMEJBQTBCLFlBQVksdUJBQXVCLDJCQUEyQix3QkFBd0IsVUFBVSxzQkFBc0IscURBQXFELGlCQUFpQixXQUFXLG9CQUFvQixtREFBbUQsbUJBQW1CLFlBQVksU0FBUyxnQ0FBZ0MsV0FBVyxrQkFBa0IsaUJBQWlCLFlBQVksWUFBWSxXQUFXLElBQUksc0NBQXNDLFFBQVEsUUFBUSxpQkFBaUIsaUJBQWlCLG1FQUFtRSxTQUFTLEtBQUssK0JBQStCLGlCQUFpQiIsInNvdXJjZXMiOlsid2VicGFjazovL19OX0UvLi9ub2RlX21vZHVsZXMvbmV4dC9kaXN0L2NvbXBpbGVkL3Byb2Nlc3MvYnJvd3Nlci5qcz9hMmQ2Il0sInNvdXJjZXNDb250ZW50IjpbIihmdW5jdGlvbigpe3ZhciBlPXsyMjk6ZnVuY3Rpb24oZSl7dmFyIHQ9ZS5leHBvcnRzPXt9O3ZhciByO3ZhciBuO2Z1bmN0aW9uIGRlZmF1bHRTZXRUaW1vdXQoKXt0aHJvdyBuZXcgRXJyb3IoXCJzZXRUaW1lb3V0IGhhcyBub3QgYmVlbiBkZWZpbmVkXCIpfWZ1bmN0aW9uIGRlZmF1bHRDbGVhclRpbWVvdXQoKXt0aHJvdyBuZXcgRXJyb3IoXCJjbGVhclRpbWVvdXQgaGFzIG5vdCBiZWVuIGRlZmluZWRcIil9KGZ1bmN0aW9uKCl7dHJ5e2lmKHR5cGVvZiBzZXRUaW1lb3V0PT09XCJmdW5jdGlvblwiKXtyPXNldFRpbWVvdXR9ZWxzZXtyPWRlZmF1bHRTZXRUaW1vdXR9fWNhdGNoKGUpe3I9ZGVmYXVsdFNldFRpbW91dH10cnl7aWYodHlwZW9mIGNsZWFyVGltZW91dD09PVwiZnVuY3Rpb25cIil7bj1jbGVhclRpbWVvdXR9ZWxzZXtuPWRlZmF1bHRDbGVhclRpbWVvdXR9fWNhdGNoKGUpe249ZGVmYXVsdENsZWFyVGltZW91dH19KSgpO2Z1bmN0aW9uIHJ1blRpbWVvdXQoZSl7aWYocj09PXNldFRpbWVvdXQpe3JldHVybiBzZXRUaW1lb3V0KGUsMCl9aWYoKHI9PT1kZWZhdWx0U2V0VGltb3V0fHwhcikmJnNldFRpbWVvdXQpe3I9c2V0VGltZW91dDtyZXR1cm4gc2V0VGltZW91dChlLDApfXRyeXtyZXR1cm4gcihlLDApfWNhdGNoKHQpe3RyeXtyZXR1cm4gci5jYWxsKG51bGwsZSwwKX1jYXRjaCh0KXtyZXR1cm4gci5jYWxsKHRoaXMsZSwwKX19fWZ1bmN0aW9uIHJ1bkNsZWFyVGltZW91dChlKXtpZihuPT09Y2xlYXJUaW1lb3V0KXtyZXR1cm4gY2xlYXJUaW1lb3V0KGUpfWlmKChuPT09ZGVmYXVsdENsZWFyVGltZW91dHx8IW4pJiZjbGVhclRpbWVvdXQpe249Y2xlYXJUaW1lb3V0O3JldHVybiBjbGVhclRpbWVvdXQoZSl9dHJ5e3JldHVybiBuKGUpfWNhdGNoKHQpe3RyeXtyZXR1cm4gbi5jYWxsKG51bGwsZSl9Y2F0Y2godCl7cmV0dXJuIG4uY2FsbCh0aGlzLGUpfX19dmFyIGk9W107dmFyIG89ZmFsc2U7dmFyIHU7dmFyIGE9LTE7ZnVuY3Rpb24gY2xlYW5VcE5leHRUaWNrKCl7aWYoIW98fCF1KXtyZXR1cm59bz1mYWxzZTtpZih1Lmxlbmd0aCl7aT11LmNvbmNhdChpKX1lbHNle2E9LTF9aWYoaS5sZW5ndGgpe2RyYWluUXVldWUoKX19ZnVuY3Rpb24gZHJhaW5RdWV1ZSgpe2lmKG8pe3JldHVybn12YXIgZT1ydW5UaW1lb3V0KGNsZWFuVXBOZXh0VGljayk7bz10cnVlO3ZhciB0PWkubGVuZ3RoO3doaWxlKHQpe3U9aTtpPVtdO3doaWxlKCsrYTx0KXtpZih1KXt1W2FdLnJ1bigpfX1hPS0xO3Q9aS5sZW5ndGh9dT1udWxsO289ZmFsc2U7cnVuQ2xlYXJUaW1lb3V0KGUpfXQubmV4dFRpY2s9ZnVuY3Rpb24oZSl7dmFyIHQ9bmV3IEFycmF5KGFyZ3VtZW50cy5sZW5ndGgtMSk7aWYoYXJndW1lbnRzLmxlbmd0aD4xKXtmb3IodmFyIHI9MTtyPGFyZ3VtZW50cy5sZW5ndGg7cisrKXt0W3ItMV09YXJndW1lbnRzW3JdfX1pLnB1c2gobmV3IEl0ZW0oZSx0KSk7aWYoaS5sZW5ndGg9PT0xJiYhbyl7cnVuVGltZW91dChkcmFpblF1ZXVlKX19O2Z1bmN0aW9uIEl0ZW0oZSx0KXt0aGlzLmZ1bj1lO3RoaXMuYXJyYXk9dH1JdGVtLnByb3RvdHlwZS5ydW49ZnVuY3Rpb24oKXt0aGlzLmZ1bi5hcHBseShudWxsLHRoaXMuYXJyYXkpfTt0LnRpdGxlPVwiYnJvd3NlclwiO3QuYnJvd3Nlcj10cnVlO3QuZW52PXt9O3QuYXJndj1bXTt0LnZlcnNpb249XCJcIjt0LnZlcnNpb25zPXt9O2Z1bmN0aW9uIG5vb3AoKXt9dC5vbj1ub29wO3QuYWRkTGlzdGVuZXI9bm9vcDt0Lm9uY2U9bm9vcDt0Lm9mZj1ub29wO3QucmVtb3ZlTGlzdGVuZXI9bm9vcDt0LnJlbW92ZUFsbExpc3RlbmVycz1ub29wO3QuZW1pdD1ub29wO3QucHJlcGVuZExpc3RlbmVyPW5vb3A7dC5wcmVwZW5kT25jZUxpc3RlbmVyPW5vb3A7dC5saXN0ZW5lcnM9ZnVuY3Rpb24oZSl7cmV0dXJuW119O3QuYmluZGluZz1mdW5jdGlvbihlKXt0aHJvdyBuZXcgRXJyb3IoXCJwcm9jZXNzLmJpbmRpbmcgaXMgbm90IHN1cHBvcnRlZFwiKX07dC5jd2Q9ZnVuY3Rpb24oKXtyZXR1cm5cIi9cIn07dC5jaGRpcj1mdW5jdGlvbihlKXt0aHJvdyBuZXcgRXJyb3IoXCJwcm9jZXNzLmNoZGlyIGlzIG5vdCBzdXBwb3J0ZWRcIil9O3QudW1hc2s9ZnVuY3Rpb24oKXtyZXR1cm4gMH19fTt2YXIgdD17fTtmdW5jdGlvbiBfX25jY3dwY2tfcmVxdWlyZV9fKHIpe3ZhciBuPXRbcl07aWYobiE9PXVuZGVmaW5lZCl7cmV0dXJuIG4uZXhwb3J0c312YXIgaT10W3JdPXtleHBvcnRzOnt9fTt2YXIgbz10cnVlO3RyeXtlW3JdKGksaS5leHBvcnRzLF9fbmNjd3Bja19yZXF1aXJlX18pO289ZmFsc2V9ZmluYWxseXtpZihvKWRlbGV0ZSB0W3JdfXJldHVybiBpLmV4cG9ydHN9aWYodHlwZW9mIF9fbmNjd3Bja19yZXF1aXJlX18hPT1cInVuZGVmaW5lZFwiKV9fbmNjd3Bja19yZXF1aXJlX18uYWI9X19kaXJuYW1lK1wiL1wiO3ZhciByPV9fbmNjd3Bja19yZXF1aXJlX18oMjI5KTttb2R1bGUuZXhwb3J0cz1yfSkoKTsiXSwibmFtZXMiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(app-pages-browser)/./node_modules/next/dist/compiled/process/browser.js\n"));

/***/ }),

/***/ "(app-pages-browser)/./data-store/datastore.ts":
/*!*********************************!*\
  !*** ./data-store/datastore.ts ***!
  \*********************************/
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval(__webpack_require__.ts("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   getAllCharacters: function() { return /* binding */ getAllCharacters; },\n/* harmony export */   getAllFinancials: function() { return /* binding */ getAllFinancials; },\n/* harmony export */   getAllItems: function() { return /* binding */ getAllItems; },\n/* harmony export */   getAllPlayers: function() { return /* binding */ getAllPlayers; },\n/* harmony export */   getAllSales: function() { return /* binding */ getAllSales; },\n/* harmony export */   getAllSettlements: function() { return /* binding */ getAllSettlements; },\n/* harmony export */   getAllSites: function() { return /* binding */ getAllSites; },\n/* harmony export */   getAllTasks: function() { return /* binding */ getAllTasks; },\n/* harmony export */   getCharacterById: function() { return /* binding */ getCharacterById; },\n/* harmony export */   getCompanyAssets: function() { return /* binding */ getCompanyAssets; },\n/* harmony export */   getConversionRates: function() { return /* binding */ getConversionRates; },\n/* harmony export */   getFinancialById: function() { return /* binding */ getFinancialById; },\n/* harmony export */   getItemById: function() { return /* binding */ getItemById; },\n/* harmony export */   getPersonalAssets: function() { return /* binding */ getPersonalAssets; },\n/* harmony export */   getPlayerById: function() { return /* binding */ getPlayerById; },\n/* harmony export */   getPointsConversionRates: function() { return /* binding */ getPointsConversionRates; },\n/* harmony export */   getSaleById: function() { return /* binding */ getSaleById; },\n/* harmony export */   getSettlementById: function() { return /* binding */ getSettlementById; },\n/* harmony export */   getSiteById: function() { return /* binding */ getSiteById; },\n/* harmony export */   getSitesByRadius: function() { return /* binding */ getSitesByRadius; },\n/* harmony export */   getSitesBySettlement: function() { return /* binding */ getSitesBySettlement; },\n/* harmony export */   getTaskById: function() { return /* binding */ getTaskById; },\n/* harmony export */   removeCharacter: function() { return /* binding */ removeCharacter; },\n/* harmony export */   removeFinancial: function() { return /* binding */ removeFinancial; },\n/* harmony export */   removeItem: function() { return /* binding */ removeItem; },\n/* harmony export */   removePlayer: function() { return /* binding */ removePlayer; },\n/* harmony export */   removeSale: function() { return /* binding */ removeSale; },\n/* harmony export */   removeSettlement: function() { return /* binding */ removeSettlement; },\n/* harmony export */   removeSite: function() { return /* binding */ removeSite; },\n/* harmony export */   removeTask: function() { return /* binding */ removeTask; },\n/* harmony export */   saveCompanyAssets: function() { return /* binding */ saveCompanyAssets; },\n/* harmony export */   saveConversionRates: function() { return /* binding */ saveConversionRates; },\n/* harmony export */   savePersonalAssets: function() { return /* binding */ savePersonalAssets; },\n/* harmony export */   savePointsConversionRates: function() { return /* binding */ savePointsConversionRates; },\n/* harmony export */   upsertCharacter: function() { return /* binding */ upsertCharacter; },\n/* harmony export */   upsertFinancial: function() { return /* binding */ upsertFinancial; },\n/* harmony export */   upsertItem: function() { return /* binding */ upsertItem; },\n/* harmony export */   upsertPlayer: function() { return /* binding */ upsertPlayer; },\n/* harmony export */   upsertSale: function() { return /* binding */ upsertSale; },\n/* harmony export */   upsertSettlement: function() { return /* binding */ upsertSettlement; },\n/* harmony export */   upsertSite: function() { return /* binding */ upsertSite; },\n/* harmony export */   upsertTask: function() { return /* binding */ upsertTask; }\n/* harmony export */ });\n/* harmony import */ var _types_enums__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @/types/enums */ \"(app-pages-browser)/./types/enums.ts\");\n/* harmony import */ var _repositories_task_repo__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./repositories/task.repo */ \"(app-pages-browser)/./data-store/repositories/task.repo.ts\");\n/* harmony import */ var _repositories_item_repo__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./repositories/item.repo */ \"(app-pages-browser)/./data-store/repositories/item.repo.ts\");\n/* harmony import */ var _repositories_financial_repo__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./repositories/financial.repo */ \"(app-pages-browser)/./data-store/repositories/financial.repo.ts\");\n/* harmony import */ var _repositories_sale_repo__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./repositories/sale.repo */ \"(app-pages-browser)/./data-store/repositories/sale.repo.ts\");\n/* harmony import */ var _repositories_character_repo__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ./repositories/character.repo */ \"(app-pages-browser)/./data-store/repositories/character.repo.ts\");\n/* harmony import */ var _repositories_player_repo__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ./repositories/player.repo */ \"(app-pages-browser)/./data-store/repositories/player.repo.ts\");\n/* harmony import */ var _repositories_site_repo__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ./repositories/site.repo */ \"(app-pages-browser)/./data-store/repositories/site.repo.ts\");\n/* harmony import */ var _kv__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ./kv */ \"(app-pages-browser)/./data-store/kv.ts\");\n/* harmony import */ var _workflows_entities_workflows_task_workflow__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! @/workflows/entities-workflows/task.workflow */ \"(app-pages-browser)/./workflows/entities-workflows/task.workflow.ts\");\n/* harmony import */ var _workflows_entities_workflows_item_workflow__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! @/workflows/entities-workflows/item.workflow */ \"(app-pages-browser)/./workflows/entities-workflows/item.workflow.ts\");\n/* harmony import */ var _workflows_entities_workflows_financial_workflow__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! @/workflows/entities-workflows/financial.workflow */ \"(app-pages-browser)/./workflows/entities-workflows/financial.workflow.ts\");\n/* harmony import */ var _workflows_entities_workflows_sale_workflow__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(/*! @/workflows/entities-workflows/sale.workflow */ \"(app-pages-browser)/./workflows/entities-workflows/sale.workflow.ts\");\n/* harmony import */ var _workflows_entities_workflows_character_workflow__WEBPACK_IMPORTED_MODULE_13__ = __webpack_require__(/*! @/workflows/entities-workflows/character.workflow */ \"(app-pages-browser)/./workflows/entities-workflows/character.workflow.ts\");\n/* harmony import */ var _workflows_entities_workflows_player_workflow__WEBPACK_IMPORTED_MODULE_14__ = __webpack_require__(/*! @/workflows/entities-workflows/player.workflow */ \"(app-pages-browser)/./workflows/entities-workflows/player.workflow.ts\");\n/* harmony import */ var _workflows_entities_workflows_site_workflow__WEBPACK_IMPORTED_MODULE_15__ = __webpack_require__(/*! @/workflows/entities-workflows/site.workflow */ \"(app-pages-browser)/./workflows/entities-workflows/site.workflow.ts\");\n/* harmony import */ var _links_links_workflows__WEBPACK_IMPORTED_MODULE_16__ = __webpack_require__(/*! @/links/links-workflows */ \"(app-pages-browser)/./links/links-workflows.ts\");\n// data-store/datastore.ts\n// Orchestration layer: repositories  workflows  links  logging\n\n\n\n\n\n\n\n\n\n// Import workflow functions individually to avoid TypeScript issues\n\n\n\n\n\n\n\n\n// TASKS\nasync function upsertTask(task) {\n    const previous = await (0,_repositories_task_repo__WEBPACK_IMPORTED_MODULE_1__.getTaskById)(task.id);\n    const saved = await (0,_repositories_task_repo__WEBPACK_IMPORTED_MODULE_1__.upsertTask)(task);\n    await (0,_workflows_entities_workflows_task_workflow__WEBPACK_IMPORTED_MODULE_9__.onTaskUpsert)(saved, previous || undefined);\n    await (0,_links_links_workflows__WEBPACK_IMPORTED_MODULE_16__.processLinkEntity)(saved, _types_enums__WEBPACK_IMPORTED_MODULE_0__.EntityType.TASK);\n    return saved;\n}\nasync function getAllTasks() {\n    return await (0,_repositories_task_repo__WEBPACK_IMPORTED_MODULE_1__.getAllTasks)();\n}\nasync function getTaskById(id) {\n    return await (0,_repositories_task_repo__WEBPACK_IMPORTED_MODULE_1__.getTaskById)(id);\n}\nasync function removeTask(id) {\n    const existing = await (0,_repositories_task_repo__WEBPACK_IMPORTED_MODULE_1__.getTaskById)(id);\n    await (0,_repositories_task_repo__WEBPACK_IMPORTED_MODULE_1__.deleteTask)(id);\n    if (existing) {\n        // Call task deletion workflow for cleanup\n        const { removeTaskLogEntriesOnDelete } = await Promise.resolve(/*! import() */).then(__webpack_require__.bind(__webpack_require__, /*! @/workflows/entities-workflows/task.workflow */ \"(app-pages-browser)/./workflows/entities-workflows/task.workflow.ts\"));\n        await removeTaskLogEntriesOnDelete(id);\n    }\n}\n// ITEMS\nasync function upsertItem(item) {\n    const previous = await (0,_repositories_item_repo__WEBPACK_IMPORTED_MODULE_2__.getItemById)(item.id);\n    const saved = await (0,_repositories_item_repo__WEBPACK_IMPORTED_MODULE_2__.upsertItem)(item);\n    await (0,_workflows_entities_workflows_item_workflow__WEBPACK_IMPORTED_MODULE_10__.onItemUpsert)(saved, previous || undefined);\n    await (0,_links_links_workflows__WEBPACK_IMPORTED_MODULE_16__.processLinkEntity)(saved, _types_enums__WEBPACK_IMPORTED_MODULE_0__.EntityType.ITEM);\n    return saved;\n}\nasync function getAllItems() {\n    return await (0,_repositories_item_repo__WEBPACK_IMPORTED_MODULE_2__.getAllItems)();\n}\nasync function getItemById(id) {\n    return await (0,_repositories_item_repo__WEBPACK_IMPORTED_MODULE_2__.getItemById)(id);\n}\nasync function removeItem(id) {\n    const existing = await (0,_repositories_item_repo__WEBPACK_IMPORTED_MODULE_2__.getItemById)(id);\n    await (0,_repositories_item_repo__WEBPACK_IMPORTED_MODULE_2__.deleteItem)(id);\n    if (existing) {\n        // Call item deletion workflow for cleanup\n        const { removeItemEffectsOnDelete } = await Promise.resolve(/*! import() */).then(__webpack_require__.bind(__webpack_require__, /*! @/workflows/entities-workflows/item.workflow */ \"(app-pages-browser)/./workflows/entities-workflows/item.workflow.ts\"));\n        await removeItemEffectsOnDelete(id);\n    }\n}\n// FINANCIALS\nasync function upsertFinancial(financial) {\n    const previous = await (0,_repositories_financial_repo__WEBPACK_IMPORTED_MODULE_3__.getFinancialById)(financial.id);\n    const saved = await (0,_repositories_financial_repo__WEBPACK_IMPORTED_MODULE_3__.upsertFinancial)(financial);\n    await (0,_workflows_entities_workflows_financial_workflow__WEBPACK_IMPORTED_MODULE_11__.onFinancialUpsert)(saved, previous || undefined);\n    await (0,_links_links_workflows__WEBPACK_IMPORTED_MODULE_16__.processLinkEntity)(saved, _types_enums__WEBPACK_IMPORTED_MODULE_0__.EntityType.FINANCIAL);\n    return saved;\n}\nasync function getAllFinancials() {\n    return await (0,_repositories_financial_repo__WEBPACK_IMPORTED_MODULE_3__.getAllFinancials)();\n}\nasync function getFinancialById(id) {\n    return await (0,_repositories_financial_repo__WEBPACK_IMPORTED_MODULE_3__.getFinancialById)(id);\n}\nasync function removeFinancial(id) {\n    const existing = await (0,_repositories_financial_repo__WEBPACK_IMPORTED_MODULE_3__.getFinancialById)(id);\n    await (0,_repositories_financial_repo__WEBPACK_IMPORTED_MODULE_3__.deleteFinancial)(id);\n    if (existing) {\n        // Call financial deletion workflow for cleanup\n        const { removeRecordEffectsOnDelete } = await Promise.resolve(/*! import() */).then(__webpack_require__.bind(__webpack_require__, /*! @/workflows/entities-workflows/financial.workflow */ \"(app-pages-browser)/./workflows/entities-workflows/financial.workflow.ts\"));\n        await removeRecordEffectsOnDelete(id);\n    }\n}\n// SALES\nasync function upsertSale(sale) {\n    const previous = await (0,_repositories_sale_repo__WEBPACK_IMPORTED_MODULE_4__.getSaleById)(sale.id);\n    const saved = await (0,_repositories_sale_repo__WEBPACK_IMPORTED_MODULE_4__.upsertSale)(sale);\n    await (0,_workflows_entities_workflows_sale_workflow__WEBPACK_IMPORTED_MODULE_12__.onSaleUpsert)(saved, previous || undefined);\n    await (0,_links_links_workflows__WEBPACK_IMPORTED_MODULE_16__.processLinkEntity)(saved, _types_enums__WEBPACK_IMPORTED_MODULE_0__.EntityType.SALE);\n    return saved;\n}\nasync function getAllSales() {\n    return await (0,_repositories_sale_repo__WEBPACK_IMPORTED_MODULE_4__.getAllSales)();\n}\nasync function getSaleById(id) {\n    return await (0,_repositories_sale_repo__WEBPACK_IMPORTED_MODULE_4__.getSaleById)(id);\n}\nasync function removeSale(id) {\n    const existing = await (0,_repositories_sale_repo__WEBPACK_IMPORTED_MODULE_4__.getSaleById)(id);\n    await (0,_repositories_sale_repo__WEBPACK_IMPORTED_MODULE_4__.deleteSale)(id);\n    if (existing) {\n        // Call sale deletion workflow for cleanup\n        const { removeSaleEffectsOnDelete } = await Promise.resolve(/*! import() */).then(__webpack_require__.bind(__webpack_require__, /*! @/workflows/entities-workflows/sale.workflow */ \"(app-pages-browser)/./workflows/entities-workflows/sale.workflow.ts\"));\n        await removeSaleEffectsOnDelete(id);\n    }\n}\n// CHARACTERS\nasync function upsertCharacter(character) {\n    const previous = await (0,_repositories_character_repo__WEBPACK_IMPORTED_MODULE_5__.getCharacterById)(character.id);\n    const saved = await (0,_repositories_character_repo__WEBPACK_IMPORTED_MODULE_5__.upsertCharacter)(character);\n    await (0,_workflows_entities_workflows_character_workflow__WEBPACK_IMPORTED_MODULE_13__.onCharacterUpsert)(saved, previous || undefined);\n    await (0,_links_links_workflows__WEBPACK_IMPORTED_MODULE_16__.processLinkEntity)(saved, _types_enums__WEBPACK_IMPORTED_MODULE_0__.EntityType.CHARACTER);\n    return saved;\n}\nasync function getAllCharacters() {\n    return await (0,_repositories_character_repo__WEBPACK_IMPORTED_MODULE_5__.getAllCharacters)();\n}\nasync function getCharacterById(id) {\n    return await (0,_repositories_character_repo__WEBPACK_IMPORTED_MODULE_5__.getCharacterById)(id);\n}\nasync function removeCharacter(id) {\n    const existing = await (0,_repositories_character_repo__WEBPACK_IMPORTED_MODULE_5__.getCharacterById)(id);\n    await (0,_repositories_character_repo__WEBPACK_IMPORTED_MODULE_5__.deleteCharacter)(id);\n    if (existing) {\n        // Call character deletion workflow for cleanup\n        const { removeCharacterEffectsOnDelete } = await Promise.resolve(/*! import() */).then(__webpack_require__.bind(__webpack_require__, /*! @/workflows/entities-workflows/character.workflow */ \"(app-pages-browser)/./workflows/entities-workflows/character.workflow.ts\"));\n        await removeCharacterEffectsOnDelete(id);\n    }\n}\n// PLAYERS\nasync function upsertPlayer(player) {\n    const previous = await (0,_repositories_player_repo__WEBPACK_IMPORTED_MODULE_6__.getPlayerById)(player.id);\n    const saved = await (0,_repositories_player_repo__WEBPACK_IMPORTED_MODULE_6__.upsertPlayer)(player);\n    await (0,_workflows_entities_workflows_player_workflow__WEBPACK_IMPORTED_MODULE_14__.onPlayerUpsert)(saved, previous || undefined);\n    await (0,_links_links_workflows__WEBPACK_IMPORTED_MODULE_16__.processLinkEntity)(saved, _types_enums__WEBPACK_IMPORTED_MODULE_0__.EntityType.PLAYER);\n    return saved;\n}\nasync function getAllPlayers() {\n    return await (0,_repositories_player_repo__WEBPACK_IMPORTED_MODULE_6__.getAllPlayers)();\n}\nasync function getPlayerById(id) {\n    return await (0,_repositories_player_repo__WEBPACK_IMPORTED_MODULE_6__.getPlayerById)(id);\n}\nasync function removePlayer(id) {\n    const existing = await (0,_repositories_player_repo__WEBPACK_IMPORTED_MODULE_6__.getPlayerById)(id);\n    await (0,_repositories_player_repo__WEBPACK_IMPORTED_MODULE_6__.deletePlayer)(id);\n    if (existing) {\n        // Call player deletion workflow for cleanup\n        const { removePlayerEffectsOnDelete } = await Promise.resolve(/*! import() */).then(__webpack_require__.bind(__webpack_require__, /*! @/workflows/entities-workflows/player.workflow */ \"(app-pages-browser)/./workflows/entities-workflows/player.workflow.ts\"));\n        await removePlayerEffectsOnDelete(id);\n    }\n}\n// SITES\nasync function upsertSite(site) {\n    const previous = await (0,_repositories_site_repo__WEBPACK_IMPORTED_MODULE_7__.getSiteById)(site.id);\n    const saved = await (0,_repositories_site_repo__WEBPACK_IMPORTED_MODULE_7__.upsertSite)(site);\n    await (0,_workflows_entities_workflows_site_workflow__WEBPACK_IMPORTED_MODULE_15__.onSiteUpsert)(saved, previous || undefined);\n    await (0,_links_links_workflows__WEBPACK_IMPORTED_MODULE_16__.processLinkEntity)(saved, _types_enums__WEBPACK_IMPORTED_MODULE_0__.EntityType.SITE);\n    return saved;\n}\nasync function getAllSites() {\n    return await (0,_repositories_site_repo__WEBPACK_IMPORTED_MODULE_7__.getAllSites)();\n}\nasync function getSiteById(id) {\n    return await (0,_repositories_site_repo__WEBPACK_IMPORTED_MODULE_7__.getSiteById)(id);\n}\nasync function removeSite(id) {\n    const existing = await (0,_repositories_site_repo__WEBPACK_IMPORTED_MODULE_7__.getSiteById)(id);\n    await (0,_repositories_site_repo__WEBPACK_IMPORTED_MODULE_7__.deleteSite)(id);\n    if (existing) {\n        // Call site deletion workflow for cleanup\n        const { removeSiteEffectsOnDelete } = await Promise.resolve(/*! import() */).then(__webpack_require__.bind(__webpack_require__, /*! @/workflows/entities-workflows/site.workflow */ \"(app-pages-browser)/./workflows/entities-workflows/site.workflow.ts\"));\n        await removeSiteEffectsOnDelete(id);\n    }\n}\n// ============================================================================\n// SETTLEMENT METHODS (Reference data for Sites)\n// ============================================================================\nasync function getAllSettlements() {\n    return await (0,_repositories_site_repo__WEBPACK_IMPORTED_MODULE_7__.getAllSettlements)();\n}\nasync function getSettlementById(id) {\n    return await (0,_repositories_site_repo__WEBPACK_IMPORTED_MODULE_7__.getSettlementById)(id);\n}\nasync function upsertSettlement(settlement) {\n    return await (0,_repositories_site_repo__WEBPACK_IMPORTED_MODULE_7__.upsertSettlement)(settlement);\n}\nasync function removeSettlement(id) {\n    await (0,_repositories_site_repo__WEBPACK_IMPORTED_MODULE_7__.removeSettlement)(id);\n}\n// ============================================================================\n// SITE QUERY METHODS\n// ============================================================================\nasync function getSitesBySettlement(settlementId) {\n    return await (0,_repositories_site_repo__WEBPACK_IMPORTED_MODULE_7__.getSitesBySettlement)(settlementId);\n}\nasync function getSitesByRadius(centerLat, centerLng, radiusMeters) {\n    return await (0,_repositories_site_repo__WEBPACK_IMPORTED_MODULE_7__.getSitesByRadius)(centerLat, centerLng, radiusMeters);\n}\n// POINTS CONVERSION RATES\nasync function getPointsConversionRates() {\n    const rates = await (0,_kv__WEBPACK_IMPORTED_MODULE_8__.kvGet)(\"data:points-conversion-rates\");\n    return rates || {\n        hpToJ$: 10,\n        fpToJ$: 15,\n        rpToJ$: 12,\n        xpToJ$: 3,\n        j$ToUSD: 10\n    };\n}\nasync function savePointsConversionRates(rates) {\n    await (0,_kv__WEBPACK_IMPORTED_MODULE_8__.kvSet)(\"data:points-conversion-rates\", rates);\n}\n// COMPANY ASSETS\nasync function getCompanyAssets() {\n    const assets = await (0,_kv__WEBPACK_IMPORTED_MODULE_8__.kvGet)(\"data:company-assets\");\n    return assets || {\n        cash: 0,\n        bank: 0,\n        bitcoin: 0,\n        toCharge: 0,\n        toPay: 0,\n        companyJ$: 0,\n        materials: {\n            value: 0,\n            cost: 0\n        },\n        equipment: {\n            value: 0,\n            cost: 0\n        },\n        artworks: {\n            value: 0,\n            cost: 0\n        },\n        prints: {\n            value: 0,\n            cost: 0\n        },\n        stickers: {\n            value: 0,\n            cost: 0\n        },\n        merch: {\n            value: 0,\n            cost: 0\n        }\n    };\n}\nasync function saveCompanyAssets(assets) {\n    await (0,_kv__WEBPACK_IMPORTED_MODULE_8__.kvSet)(\"data:company-assets\", assets);\n}\n// PERSONAL ASSETS\nasync function getPersonalAssets() {\n    const assets = await (0,_kv__WEBPACK_IMPORTED_MODULE_8__.kvGet)(\"data:personal-assets\");\n    return assets || {\n        cash: 0,\n        bank: 0,\n        bitcoin: 0,\n        crypto: 0,\n        toCharge: 0,\n        toPay: 0,\n        personalJ$: 0,\n        vehicle: 0,\n        properties: 0,\n        nfts: 0,\n        other: 0\n    };\n}\nasync function savePersonalAssets(assets) {\n    await (0,_kv__WEBPACK_IMPORTED_MODULE_8__.kvSet)(\"data:personal-assets\", assets);\n}\n// CONVERSION RATES\nasync function getConversionRates() {\n    const rates = await (0,_kv__WEBPACK_IMPORTED_MODULE_8__.kvGet)(\"data:conversion-rates\");\n    return rates || {\n        hpToJ$: 10,\n        fpToJ$: 15,\n        rpToJ$: 12,\n        xpToJ$: 3,\n        j$ToUSD: 10,\n        colonesToUsd: 500,\n        bitcoinToUsd: 50000,\n        jungleCoinsToUsd: 0.1\n    };\n}\nasync function saveConversionRates(rates) {\n    await (0,_kv__WEBPACK_IMPORTED_MODULE_8__.kvSet)(\"data:conversion-rates\", rates);\n}\n\n\n;\n    // Wrapped in an IIFE to avoid polluting the global scope\n    ;\n    (function () {\n        var _a, _b;\n        // Legacy CSS implementations will `eval` browser code in a Node.js context\n        // to extract CSS. For backwards compatibility, we need to check we're in a\n        // browser context before continuing.\n        if (typeof self !== 'undefined' &&\n            // AMP / No-JS mode does not inject these helpers:\n            '$RefreshHelpers$' in self) {\n            // @ts-ignore __webpack_module__ is global\n            var currentExports = module.exports;\n            // @ts-ignore __webpack_module__ is global\n            var prevSignature = (_b = (_a = module.hot.data) === null || _a === void 0 ? void 0 : _a.prevSignature) !== null && _b !== void 0 ? _b : null;\n            // This cannot happen in MainTemplate because the exports mismatch between\n            // templating and execution.\n            self.$RefreshHelpers$.registerExportsForReactRefresh(currentExports, module.id);\n            // A module can be accepted automatically based on its exports, e.g. when\n            // it is a Refresh Boundary.\n            if (self.$RefreshHelpers$.isReactRefreshBoundary(currentExports)) {\n                // Save the previous exports signature on update so we can compare the boundary\n                // signatures. We avoid saving exports themselves since it causes memory leaks (https://github.com/vercel/next.js/pull/53797)\n                module.hot.dispose(function (data) {\n                    data.prevSignature =\n                        self.$RefreshHelpers$.getRefreshBoundarySignature(currentExports);\n                });\n                // Unconditionally accept an update to this module, we'll check if it's\n                // still a Refresh Boundary later.\n                // @ts-ignore importMeta is replaced in the loader\n                module.hot.accept();\n                // This field is set when the previous version of this module was a\n                // Refresh Boundary, letting us know we need to check for invalidation or\n                // enqueue an update.\n                if (prevSignature !== null) {\n                    // A boundary can become ineligible if its exports are incompatible\n                    // with the previous exports.\n                    //\n                    // For example, if you add/remove/change exports, we'll want to\n                    // re-execute the importing modules, and force those components to\n                    // re-render. Similarly, if you convert a class component to a\n                    // function, we want to invalidate the boundary.\n                    if (self.$RefreshHelpers$.shouldInvalidateReactRefreshBoundary(prevSignature, self.$RefreshHelpers$.getRefreshBoundarySignature(currentExports))) {\n                        module.hot.invalidate();\n                    }\n                    else {\n                        self.$RefreshHelpers$.scheduleUpdate();\n                    }\n                }\n            }\n            else {\n                // Since we just executed the code for the module, it's possible that the\n                // new exports made it ineligible for being a boundary.\n                // We only care about the case when we were _previously_ a boundary,\n                // because we already accepted this update (accidental side effect).\n                var isNoLongerABoundary = prevSignature !== null;\n                if (isNoLongerABoundary) {\n                    module.hot.invalidate();\n                }\n            }\n        }\n    })();\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFwcC1wYWdlcy1icm93c2VyKS8uL2RhdGEtc3RvcmUvZGF0YXN0b3JlLnRzIiwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7O0FBQUEsMEJBQTBCO0FBQzFCLGtFQUFrRTtBQUd2QjtBQU1UO0FBTUE7QUFNSztBQU1MO0FBTUs7QUFNSDtBQVlGO0FBQ0U7QUFDcEMsb0VBQW9FO0FBQ1E7QUFDQTtBQUNVO0FBQ1Y7QUFDVTtBQUNOO0FBQ0o7QUFDaEI7QUFHNUQsUUFBUTtBQUNELGVBQWVDLFdBQVc4RSxJQUFVO0lBQ3pDLE1BQU1DLFdBQVcsTUFBTTFFLG9FQUFlQSxDQUFDeUUsS0FBS0UsRUFBRTtJQUM5QyxNQUFNQyxRQUFRLE1BQU1oRixtRUFBY0EsQ0FBQzZFO0lBQ25DLE1BQU1SLHlGQUFZQSxDQUFDVyxPQUFPRixZQUFZRztJQUN0QyxNQUFNTCwwRUFBaUJBLENBQUNJLE9BQU9sRixvREFBVUEsQ0FBQ29GLElBQUk7SUFDOUMsT0FBT0Y7QUFDVDtBQUVPLGVBQWUvRTtJQUNwQixPQUFPLE1BQU1DLG9FQUFlQTtBQUM5QjtBQUVPLGVBQWVDLFlBQVk0RSxFQUFVO0lBQzFDLE9BQU8sTUFBTTNFLG9FQUFlQSxDQUFDMkU7QUFDL0I7QUFFTyxlQUFlSSxXQUFXSixFQUFVO0lBQ3pDLE1BQU1LLFdBQVcsTUFBTWhGLG9FQUFlQSxDQUFDMkU7SUFDdkMsTUFBTXpFLG1FQUFjQSxDQUFDeUU7SUFDckIsSUFBSUssVUFBVTtRQUNaLDBDQUEwQztRQUMxQyxNQUFNLEVBQUVDLDRCQUE0QixFQUFFLEdBQUcsTUFBTSwrTUFBTztRQUN0RCxNQUFNQSw2QkFBNkJOO0lBQ3JDO0FBQ0Y7QUFFQSxRQUFRO0FBQ0QsZUFBZXhFLFdBQVcrRSxJQUFVO0lBQ3pDLE1BQU1SLFdBQVcsTUFBTWxFLG9FQUFlQSxDQUFDMEUsS0FBS1AsRUFBRTtJQUM5QyxNQUFNQyxRQUFRLE1BQU14RSxtRUFB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QUFFQSxtQkFBbUI7QUFDWixlQUFld0I7SUFDcEIsTUFBTWhDLFFBQVEsTUFBTWpELDBDQUFLQSxDQUFDO0lBQzFCLE9BQU9pRCxTQUFTO1FBQ2RDLFFBQVE7UUFDUkMsUUFBUTtRQUNSQyxRQUFRO1FBQ1JDLFFBQVE7UUFDUkMsU0FBUztRQUNUNEIsY0FBYztRQUNkQyxjQUFjO1FBQ2RDLGtCQUFrQjtJQUNwQjtBQUNGO0FBRU8sZUFBZUMsb0JBQW9CcEMsS0FBVTtJQUNsRCxNQUFNaEQsMENBQUtBLENBQUMseUJBQXlCZ0Q7QUFDdkMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9fTl9FLy4vZGF0YS1zdG9yZS9kYXRhc3RvcmUudHM/OGQyZiJdLCJzb3VyY2VzQ29udGVudCI6WyIvLyBkYXRhLXN0b3JlL2RhdGFzdG9yZS50c1xyXG4vLyBPcmNoZXN0cmF0aW9uIGxheWVyOiByZXBvc2l0b3JpZXMg4oaSIHdvcmtmbG93cyDihpIgbGlua3Mg4oaSIGxvZ2dpbmdcclxuXHJcbmltcG9ydCB0eXBlIHsgVGFzaywgSXRlbSwgRmluYW5jaWFsUmVjb3JkLCBTYWxlLCBDaGFyYWN0ZXIsIFBsYXllciwgU2l0ZSwgU2V0dGxlbWVudCB9IGZyb20gJ0AvdHlwZXMvZW50aXRpZXMnO1xyXG5pbXBvcnQgeyBFbnRpdHlUeXBlIH0gZnJvbSAnQC90eXBlcy9lbnVtcyc7XHJcbmltcG9ydCB7IFxyXG4gIHVwc2VydFRhc2sgYXMgcmVwb1Vwc2VydFRhc2ssXHJcbiAgZ2V0QWxsVGFza3MgYXMgcmVwb0dldEFsbFRhc2tzLFxyXG4gIGdldFRhc2tCeUlkIGFzIHJlcG9HZXRUYXNrQnlJZCxcclxuICBkZWxldGVUYXNrIGFzIHJlcG9EZWxldGVUYXNrXHJcbn0gZnJvbSAnLi9yZXBvc2l0b3JpZXMvdGFzay5yZXBvJztcclxuaW1wb3J0IHsgXHJcbiAgdXBzZXJ0SXRlbSBhcyByZXBvVXBzZXJ0SXRlbSxcclxuICBnZXRBbGxJdGVtcyBhcyByZXBvR2V0QWxsSXRlbXMsXHJcbiAgZ2V0SXRlbUJ5SWQgYXMgcmVwb0dldEl0ZW1CeUlkLFxyXG4gIGRlbGV0ZUl0ZW0gYXMgcmVwb0RlbGV0ZUl0ZW1cclxufSBmcm9tICcuL3JlcG9zaXRvcmllcy9pdGVtLnJlcG8nO1xyXG5pbXBvcnQgeyBcclxuICB1cHNlcnRGaW5hbmNpYWwgYXMgcmVwb1Vwc2VydEZpbmFuY2lhbCxcclxuICBnZXRBbGxGaW5hbmNpYWxzIGFzIHJlcG9HZXRBbGxGaW5hbmNpYWxzLFxyXG4gIGdldEZpbmFuY2lhbEJ5SWQgYXMgcmVwb0dldEZpbmFuY2lhbEJ5SWQsXHJcbiAgZGVsZXRlRmluYW5jaWFsIGFzIHJlcG9EZWxldGVGaW5hbmNpYWxcclxufSBmcm9tICcuL3JlcG9zaXRvcmllcy9maW5hbmNpYWwucmVwbyc7XHJcbmltcG9ydCB7IFxyXG4gIHVwc2VydFNhbGUgYXMgcmVwb1Vwc2VydFNhbGUsXHJcbiAgZ2V0QWxsU2FsZXMgYXMgcmVwb0dldEFsbFNhbGVzLFxyXG4gIGdldFNhbGVCeUlkIGFzIHJlcG9HZXRTYWxlQnlJZCxcclxuICBkZWxldGVTYWxlIGFzIHJlcG9EZWxldGVTYWxlXHJcbn0gZnJvbSAnLi9yZXBvc2l0b3JpZXMvc2FsZS5yZXBvJztcclxuaW1wb3J0IHsgXHJcbiAgdXBzZXJ0Q2hhcmFjdGVyIGFzIHJlcG9VcHNlcnRDaGFyYWN0ZXIsXHJcbiAgZ2V0QWxsQ2hhcmFjdGVycyBhcyByZXBvR2V0QWxsQ2hhcmFjdGVycyxcclxuICBnZXRDaGFyYWN0ZXJCeUlkIGFzIHJlcG9HZXRDaGFyYWN0ZXJCeUlkLFxyXG4gIGRlbGV0ZUNoYXJhY3RlciBhcyByZXBvRGVsZXRlQ2hhcmFjdGVyXHJcbn0gZnJvbSAnLi9yZXBvc2l0b3JpZXMvY2hhcmFjdGVyLnJlcG8nO1xyXG5pbXBvcnQgeyBcclxuICB1cHNlcnRQbGF5ZXIgYXMgcmVwb1Vwc2VydFBsYXllcixcclxuICBnZXRBbGxQbGF5ZXJzIGFzIHJlcG9HZXRBbGxQbGF5ZXJzLFxyXG4gIGdldFBsYXllckJ5SWQgYXMgcmVwb0dldFBsYXllckJ5SWQsXHJcbiAgZGVsZXRlUGxheWVyIGFzIHJlcG9EZWxldGVQbGF5ZXJcclxufSBmcm9tICcuL3JlcG9zaXRvcmllcy9wbGF5ZXIucmVwbyc7XHJcbmltcG9ydCB7IFxyXG4gIHVwc2VydFNpdGUgYXMgcmVwb1Vwc2VydFNpdGUsXHJcbiAgZ2V0QWxsU2l0ZXMgYXMgcmVwb0dldEFsbFNpdGVzLFxyXG4gIGdldFNpdGVCeUlkIGFzIHJlcG9HZXRTaXRlQnlJZCxcclxuICBkZWxldGVTaXRlIGFzIHJlcG9EZWxldGVTaXRlLFxyXG4gIGdldEFsbFNldHRsZW1lbnRzIGFzIHJlcG9HZXRBbGxTZXR0bGVtZW50cyxcclxuICBnZXRTZXR0bGVtZW50QnlJZCBhcyByZXBvR2V0U2V0dGxlbWVudEJ5SWQsXHJcbiAgdXBzZXJ0U2V0dGxlbWVudCBhcyByZXBvVXBzZXJ0U2V0dGxlbWVudCxcclxuICByZW1vdmVTZXR0bGVtZW50IGFzIHJlcG9SZW1vdmVTZXR0bGVtZW50LFxyXG4gIGdldFNpdGVzQnlTZXR0bGVtZW50IGFzIHJlcG9HZXRTaXRlc0J5U2V0dGxlbWVudCxcclxuICBnZXRTaXRlc0J5UmFkaXVzIGFzIHJlcG9HZXRTaXRlc0J5UmFkaXVzXHJcbn0gZnJvbSAnLi9yZXBvc2l0b3JpZXMvc2l0ZS5yZXBvJztcclxuaW1wb3J0IHsga3ZHZXQsIGt2U2V0IH0gZnJvbSAnLi9rdic7XHJcbi8vIEltcG9ydCB3b3JrZmxvdyBmdW5jdGlvbnMgaW5kaXZpZHVhbGx5IHRvIGF2b2lkIFR5cGVTY3JpcHQgaXNzdWVzXHJcbmltcG9ydCB7IG9uVGFza1Vwc2VydCB9IGZyb20gJ0Avd29ya2Zsb3dzL2VudGl0aWVzLXdvcmtmbG93cy90YXNrLndvcmtmbG93JztcclxuaW1wb3J0IHsgb25JdGVtVXBzZXJ0IH0gZnJvbSAnQC93b3JrZmxvd3MvZW50aXRpZXMtd29ya2Zsb3dzL2l0ZW0ud29ya2Zsb3cnO1xyXG5pbXBvcnQgeyBvbkZpbmFuY2lhbFVwc2VydCB9IGZyb20gJ0Avd29ya2Zsb3dzL2VudGl0aWVzLXdvcmtmbG93cy9maW5hbmNpYWwud29ya2Zsb3cnO1xyXG5pbXBvcnQgeyBvblNhbGVVcHNlcnQgfSBmcm9tICdAL3dvcmtmbG93cy9lbnRpdGllcy13b3JrZmxvd3Mvc2FsZS53b3JrZmxvdyc7XHJcbmltcG9ydCB7IG9uQ2hhcmFjdGVyVXBzZXJ0IH0gZnJvbSAnQC93b3JrZmxvd3MvZW50aXRpZXMtd29ya2Zsb3dzL2NoYXJhY3Rlci53b3JrZmxvdyc7XHJcbmltcG9ydCB7IG9uUGxheWVyVXBzZXJ0IH0gZnJvbSAnQC93b3JrZmxvd3MvZW50aXRpZXMtd29ya2Zsb3dzL3BsYXllci53b3JrZmxvdyc7XHJcbmltcG9ydCB7IG9uU2l0ZVVwc2VydCB9IGZyb20gJ0Avd29ya2Zsb3dzL2VudGl0aWVzLXdvcmtmbG93cy9zaXRlLndvcmtmbG93JztcclxuaW1wb3J0IHsgcHJvY2Vzc0xpbmtFbnRpdHkgfSBmcm9tICdAL2xpbmtzL2xpbmtzLXdvcmtmbG93cyc7XHJcbmltcG9ydCB7IGFwcGVuZEVudGl0eUxvZyB9IGZyb20gJ0Avd29ya2Zsb3dzL2VudGl0aWVzLWxvZ2dpbmcnO1xyXG5cclxuLy8gVEFTS1NcclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIHVwc2VydFRhc2sodGFzazogVGFzayk6IFByb21pc2U8VGFzaz4ge1xyXG4gIGNvbnN0IHByZXZpb3VzID0gYXdhaXQgcmVwb0dldFRhc2tCeUlkKHRhc2suaWQpO1xyXG4gIGNvbnN0IHNhdmVkID0gYXdhaXQgcmVwb1Vwc2VydFRhc2sodGFzayk7XHJcbiAgYXdhaXQgb25UYXNrVXBzZXJ0KHNhdmVkLCBwcmV2aW91cyB8fCB1bmRlZmluZWQpO1xyXG4gIGF3YWl0IHByb2Nlc3NMaW5rRW50aXR5KHNhdmVkLCBFbnRpdHlUeXBlLlRBU0spO1xyXG4gIHJldHVybiBzYXZlZDtcclxufVxyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGdldEFsbFRhc2tzKCk6IFByb21pc2U8VGFza1tdPiB7XHJcbiAgcmV0dXJuIGF3YWl0IHJlcG9HZXRBbGxUYXNrcygpO1xyXG59XHJcblxyXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gZ2V0VGFza0J5SWQoaWQ6IHN0cmluZyk6IFByb21pc2U8VGFzayB8IG51bGw+IHtcclxuICByZXR1cm4gYXdhaXQgcmVwb0dldFRhc2tCeUlkKGlkKTtcclxufVxyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIHJlbW92ZVRhc2soaWQ6IHN0cmluZyk6IFByb21pc2U8dm9pZD4ge1xyXG4gIGNvbnN0IGV4aXN0aW5nID0gYXdhaXQgcmVwb0dldFRhc2tCeUlkKGlkKTtcclxuICBhd2FpdCByZXBvRGVsZXRlVGFzayhpZCk7XHJcbiAgaWYgKGV4aXN0aW5nKSB7XHJcbiAgICAvLyBDYWxsIHRhc2sgZGVsZXRpb24gd29ya2Zsb3cgZm9yIGNsZWFudXBcclxuICAgIGNvbnN0IHsgcmVtb3ZlVGFza0xvZ0VudHJpZXNPbkRlbGV0ZSB9ID0gYXdhaXQgaW1wb3J0KCdAL3dvcmtmbG93cy9lbnRpdGllcy13b3JrZmxvd3MvdGFzay53b3JrZmxvdycpO1xyXG4gICAgYXdhaXQgcmVtb3ZlVGFza0xvZ0VudHJpZXNPbkRlbGV0ZShpZCk7XHJcbiAgfVxyXG59XHJcblxyXG4vLyBJVEVNU1xyXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gdXBzZXJ0SXRlbShpdGVtOiBJdGVtKTogUHJvbWlzZTxJdGVtPiB7XHJcbiAgY29uc3QgcHJldmlvdXMgPSBhd2FpdCByZXBvR2V0SXRlbUJ5SWQoaXRlbS5pZCk7XHJcbiAgY29uc3Qgc2F2ZWQgPSBhd2FpdCByZXBvVXBzZXJ0SXRlbShpdGVtKTtcclxuICBhd2FpdCBvbkl0ZW1VcHNlcnQoc2F2ZWQsIHByZXZpb3VzIHx8IHVuZGVmaW5lZCk7XHJcbiAgYXdhaXQgcHJvY2Vzc0xpbmtFbnRpdHkoc2F2ZWQsIEVudGl0eVR5cGUuSVRFTSk7XHJcbiAgcmV0dXJuIHNhdmVkO1xyXG59XHJcblxyXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gZ2V0QWxsSXRlbXMoKTogUHJvbWlzZTxJdGVtW10+IHtcclxuICByZXR1cm4gYXdhaXQgcmVwb0dldEFsbEl0ZW1zKCk7XHJcbn1cclxuXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBnZXRJdGVtQnlJZChpZDogc3RyaW5nKTogUHJvbWlzZTxJdGVtIHwgbnVsbD4ge1xyXG4gIHJldHVybiBhd2FpdCByZXBvR2V0SXRlbUJ5SWQoaWQpO1xyXG59XHJcblxyXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gcmVtb3ZlSXRlbShpZDogc3RyaW5nKTogUHJvbWlzZTx2b2lkPiB7XHJcbiAgY29uc3QgZXhpc3RpbmcgPSBhd2FpdCByZXBvR2V0SXRlbUJ5SWQoaWQpO1xyXG4gIGF3YWl0IHJlcG9EZWxldGVJdGVtKGlkKTtcclxuICBpZiAoZXhpc3RpbmcpIHtcclxuICAgIC8vIENhbGwgaXRlbSBkZWxldGlvbiB3b3JrZmxvdyBmb3IgY2xlYW51cFxyXG4gICAgY29uc3QgeyByZW1vdmVJdGVtRWZmZWN0c09uRGVsZXRlIH0gPSBhd2FpdCBpbXBvcnQoJ0Avd29ya2Zsb3dzL2VudGl0aWVzLXdvcmtmbG93cy9pdGVtLndvcmtmbG93Jyk7XHJcbiAgICBhd2FpdCByZW1vdmVJdGVtRWZmZWN0c09uRGVsZXRlKGlkKTtcclxuICB9XHJcbn1cclxuXHJcbi8vIEZJTkFOQ0lBTFNcclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIHVwc2VydEZpbmFuY2lhbChmaW5hbmNpYWw6IEZpbmFuY2lhbFJlY29yZCk6IFByb21pc2U8RmluYW5jaWFsUmVjb3JkPiB7XHJcbiAgY29uc3QgcHJldmlvdXMgPSBhd2FpdCByZXBvR2V0RmluYW5jaWFsQnlJZChmaW5hbmNpYWwuaWQpO1xyXG4gIGNvbnN0IHNhdmVkID0gYXdhaXQgcmVwb1Vwc2VydEZpbmFuY2lhbChmaW5hbmNpYWwpO1xyXG4gIGF3YWl0IG9uRmluYW5jaWFsVXBzZXJ0KHNhdmVkLCBwcmV2aW91cyB8fCB1bmRlZmluZWQpO1xyXG4gIGF3YWl0IHByb2Nlc3NMaW5rRW50aXR5KHNhdmVkLCBFbnRpdHlUeXBlLkZJTkFOQ0lBTCk7XHJcbiAgcmV0dXJuIHNhdmVkO1xyXG59XHJcblxyXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gZ2V0QWxsRmluYW5jaWFscygpOiBQcm9taXNlPEZpbmFuY2lhbFJlY29yZFtdPiB7XHJcbiAgcmV0dXJuIGF3YWl0IHJlcG9HZXRBbGxGaW5hbmNpYWxzKCk7XHJcbn1cclxuXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBnZXRGaW5hbmNpYWxCeUlkKGlkOiBzdHJpbmcpOiBQcm9taXNlPEZpbmFuY2lhbFJlY29yZCB8IG51bGw+IHtcclxuICByZXR1cm4gYXdhaXQgcmVwb0dldEZpbmFuY2lhbEJ5SWQoaWQpO1xyXG59XHJcblxyXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gcmVtb3ZlRmluYW5jaWFsKGlkOiBzdHJpbmcpOiBQcm9taXNlPHZvaWQ+IHtcclxuICBjb25zdCBleGlzdGluZyA9IGF3YWl0IHJlcG9HZXRGaW5hbmNpYWxCeUlkKGlkKTtcclxuICBhd2FpdCByZXBvRGVsZXRlRmluYW5jaWFsKGlkKTtcclxuICBpZiAoZXhpc3RpbmcpIHtcclxuICAgIC8vIENhbGwgZmluYW5jaWFsIGRlbGV0aW9uIHdvcmtmbG93IGZvciBjbGVhbnVwXHJcbiAgICBjb25zdCB7IHJlbW92ZVJlY29yZEVmZmVjdHNPbkRlbGV0ZSB9ID0gYXdhaXQgaW1wb3J0KCdAL3dvcmtmbG93cy9lbnRpdGllcy13b3JrZmxvd3MvZmluYW5jaWFsLndvcmtmbG93Jyk7XHJcbiAgICBhd2FpdCByZW1vdmVSZWNvcmRFZmZlY3RzT25EZWxldGUoaWQpO1xyXG4gIH1cclxufVxyXG5cclxuLy8gU0FMRVNcclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIHVwc2VydFNhbGUoc2FsZTogU2FsZSk6IFByb21pc2U8U2FsZT4ge1xyXG4gIGNvbnN0IHByZXZpb3VzID0gYXdhaXQgcmVwb0dldFNhbGVCeUlkKHNhbGUuaWQpO1xyXG4gIGNvbnN0IHNhdmVkID0gYXdhaXQgcmVwb1Vwc2VydFNhbGUoc2FsZSk7XHJcbiAgYXdhaXQgb25TYWxlVXBzZXJ0KHNhdmVkLCBwcmV2aW91cyB8fCB1bmRlZmluZWQpO1xyXG4gIGF3YWl0IHByb2Nlc3NMaW5rRW50aXR5KHNhdmVkLCBFbnRpdHlUeXBlLlNBTEUpO1xyXG4gIHJldHVybiBzYXZlZDtcclxufVxyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGdldEFsbFNhbGVzKCk6IFByb21pc2U8U2FsZVtdPiB7XHJcbiAgcmV0dXJuIGF3YWl0IHJlcG9HZXRBbGxTYWxlcygpO1xyXG59XHJcblxyXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gZ2V0U2FsZUJ5SWQoaWQ6IHN0cmluZyk6IFByb21pc2U8U2FsZSB8IG51bGw+IHtcclxuICByZXR1cm4gYXdhaXQgcmVwb0dldFNhbGVCeUlkKGlkKTtcclxufVxyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIHJlbW92ZVNhbGUoaWQ6IHN0cmluZyk6IFByb21pc2U8dm9pZD4ge1xyXG4gIGNvbnN0IGV4aXN0aW5nID0gYXdhaXQgcmVwb0dldFNhbGVCeUlkKGlkKTtcclxuICBhd2FpdCByZXBvRGVsZXRlU2FsZShpZCk7XHJcbiAgaWYgKGV4aXN0aW5nKSB7XHJcbiAgICAvLyBDYWxsIHNhbGUgZGVsZXRpb24gd29ya2Zsb3cgZm9yIGNsZWFudXBcclxuICAgIGNvbnN0IHsgcmVtb3ZlU2FsZUVmZmVjdHNPbkRlbGV0ZSB9ID0gYXdhaXQgaW1wb3J0KCdAL3dvcmtmbG93cy9lbnRpdGllcy13b3JrZmxvd3Mvc2FsZS53b3JrZmxvdycpO1xyXG4gICAgYXdhaXQgcmVtb3ZlU2FsZUVmZmVjdHNPbkRlbGV0ZShpZCk7XHJcbiAgfVxyXG59XHJcblxyXG4vLyBDSEFSQUNURVJTXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiB1cHNlcnRDaGFyYWN0ZXIoY2hhcmFjdGVyOiBDaGFyYWN0ZXIpOiBQcm9taXNlPENoYXJhY3Rlcj4ge1xyXG4gIGNvbnN0IHByZXZpb3VzID0gYXdhaXQgcmVwb0dldENoYXJhY3RlckJ5SWQoY2hhcmFjdGVyLmlkKTtcclxuICBjb25zdCBzYXZlZCA9IGF3YWl0IHJlcG9VcHNlcnRDaGFyYWN0ZXIoY2hhcmFjdGVyKTtcclxuICBhd2FpdCBvbkNoYXJhY3RlclVwc2VydChzYXZlZCwgcHJldmlvdXMgfHwgdW5kZWZpbmVkKTtcclxuICBhd2FpdCBwcm9jZXNzTGlua0VudGl0eShzYXZlZCwgRW50aXR5VHlwZS5DSEFSQUNURVIpO1xyXG4gIHJldHVybiBzYXZlZDtcclxufVxyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGdldEFsbENoYXJhY3RlcnMoKTogUHJvbWlzZTxDaGFyYWN0ZXJbXT4ge1xyXG4gIHJldHVybiBhd2FpdCByZXBvR2V0QWxsQ2hhcmFjdGVycygpO1xyXG59XHJcblxyXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gZ2V0Q2hhcmFjdGVyQnlJZChpZDogc3RyaW5nKTogUHJvbWlzZTxDaGFyYWN0ZXIgfCBudWxsPiB7XHJcbiAgcmV0dXJuIGF3YWl0IHJlcG9HZXRDaGFyYWN0ZXJCeUlkKGlkKTtcclxufVxyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIHJlbW92ZUNoYXJhY3RlcihpZDogc3RyaW5nKTogUHJvbWlzZTx2b2lkPiB7XHJcbiAgY29uc3QgZXhpc3RpbmcgPSBhd2FpdCByZXBvR2V0Q2hhcmFjdGVyQnlJZChpZCk7XHJcbiAgYXdhaXQgcmVwb0RlbGV0ZUNoYXJhY3RlcihpZCk7XHJcbiAgaWYgKGV4aXN0aW5nKSB7XHJcbiAgICAvLyBDYWxsIGNoYXJhY3RlciBkZWxldGlvbiB3b3JrZmxvdyBmb3IgY2xlYW51cFxyXG4gICAgY29uc3QgeyByZW1vdmVDaGFyYWN0ZXJFZmZlY3RzT25EZWxldGUgfSA9IGF3YWl0IGltcG9ydCgnQC93b3JrZmxvd3MvZW50aXRpZXMtd29ya2Zsb3dzL2NoYXJhY3Rlci53b3JrZmxvdycpO1xyXG4gICAgYXdhaXQgcmVtb3ZlQ2hhcmFjdGVyRWZmZWN0c09uRGVsZXRlKGlkKTtcclxuICB9XHJcbn1cclxuXHJcbi8vIFBMQVlFUlNcclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIHVwc2VydFBsYXllcihwbGF5ZXI6IFBsYXllcik6IFByb21pc2U8UGxheWVyPiB7XHJcbiAgY29uc3QgcHJldmlvdXMgPSBhd2FpdCByZXBvR2V0UGxheWVyQnlJZChwbGF5ZXIuaWQpO1xyXG4gIGNvbnN0IHNhdmVkID0gYXdhaXQgcmVwb1Vwc2VydFBsYXllcihwbGF5ZXIpO1xyXG4gIGF3YWl0IG9uUGxheWVyVXBzZXJ0KHNhdmVkLCBwcmV2aW91cyB8fCB1bmRlZmluZWQpO1xyXG4gIGF3YWl0IHByb2Nlc3NMaW5rRW50aXR5KHNhdmVkLCBFbnRpdHlUeXBlLlBMQVlFUik7XHJcbiAgcmV0dXJuIHNhdmVkO1xyXG59XHJcblxyXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gZ2V0QWxsUGxheWVycygpOiBQcm9taXNlPFBsYXllcltdPiB7XHJcbiAgcmV0dXJuIGF3YWl0IHJlcG9HZXRBbGxQbGF5ZXJzKCk7XHJcbn1cclxuXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBnZXRQbGF5ZXJCeUlkKGlkOiBzdHJpbmcpOiBQcm9taXNlPFBsYXllciB8IG51bGw+IHtcclxuICByZXR1cm4gYXdhaXQgcmVwb0dldFBsYXllckJ5SWQoaWQpO1xyXG59XHJcblxyXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gcmVtb3ZlUGxheWVyKGlkOiBzdHJpbmcpOiBQcm9taXNlPHZvaWQ+IHtcclxuICBjb25zdCBleGlzdGluZyA9IGF3YWl0IHJlcG9HZXRQbGF5ZXJCeUlkKGlkKTtcclxuICBhd2FpdCByZXBvRGVsZXRlUGxheWVyKGlkKTtcclxuICBpZiAoZXhpc3RpbmcpIHtcclxuICAgIC8vIENhbGwgcGxheWVyIGRlbGV0aW9uIHdvcmtmbG93IGZvciBjbGVhbnVwXHJcbiAgICBjb25zdCB7IHJlbW92ZVBsYXllckVmZmVjdHNPbkRlbGV0ZSB9ID0gYXdhaXQgaW1wb3J0KCdAL3dvcmtmbG93cy9lbnRpdGllcy13b3JrZmxvd3MvcGxheWVyLndvcmtmbG93Jyk7XHJcbiAgICBhd2FpdCByZW1vdmVQbGF5ZXJFZmZlY3RzT25EZWxldGUoaWQpO1xyXG4gIH1cclxufVxyXG5cclxuLy8gU0lURVNcclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIHVwc2VydFNpdGUoc2l0ZTogU2l0ZSk6IFByb21pc2U8U2l0ZT4ge1xyXG4gIGNvbnN0IHByZXZpb3VzID0gYXdhaXQgcmVwb0dldFNpdGVCeUlkKHNpdGUuaWQpO1xyXG4gIGNvbnN0IHNhdmVkID0gYXdhaXQgcmVwb1Vwc2VydFNpdGUoc2l0ZSk7XHJcbiAgYXdhaXQgb25TaXRlVXBzZXJ0KHNhdmVkLCBwcmV2aW91cyB8fCB1bmRlZmluZWQpO1xyXG4gIGF3YWl0IHByb2Nlc3NMaW5rRW50aXR5KHNhdmVkLCBFbnRpdHlUeXBlLlNJVEUpO1xyXG4gIHJldHVybiBzYXZlZDtcclxufVxyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGdldEFsbFNpdGVzKCk6IFByb21pc2U8U2l0ZVtdPiB7XHJcbiAgcmV0dXJuIGF3YWl0IHJlcG9HZXRBbGxTaXRlcygpO1xyXG59XHJcblxyXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gZ2V0U2l0ZUJ5SWQoaWQ6IHN0cmluZyk6IFByb21pc2U8U2l0ZSB8IG51bGw+IHtcclxuICByZXR1cm4gYXdhaXQgcmVwb0dldFNpdGVCeUlkKGlkKTtcclxufVxyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIHJlbW92ZVNpdGUoaWQ6IHN0cmluZyk6IFByb21pc2U8dm9pZD4ge1xyXG4gIGNvbnN0IGV4aXN0aW5nID0gYXdhaXQgcmVwb0dldFNpdGVCeUlkKGlkKTtcclxuICBhd2FpdCByZXBvRGVsZXRlU2l0ZShpZCk7XHJcbiAgaWYgKGV4aXN0aW5nKSB7XHJcbiAgICAvLyBDYWxsIHNpdGUgZGVsZXRpb24gd29ya2Zsb3cgZm9yIGNsZWFudXBcclxuICAgIGNvbnN0IHsgcmVtb3ZlU2l0ZUVmZmVjdHNPbkRlbGV0ZSB9ID0gYXdhaXQgaW1wb3J0KCdAL3dvcmtmbG93cy9lbnRpdGllcy13b3JrZmxvd3Mvc2l0ZS53b3JrZmxvdycpO1xyXG4gICAgYXdhaXQgcmVtb3ZlU2l0ZUVmZmVjdHNPbkRlbGV0ZShpZCk7XHJcbiAgfVxyXG59XHJcblxyXG4vLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XHJcbi8vIFNFVFRMRU1FTlQgTUVUSE9EUyAoUmVmZXJlbmNlIGRhdGEgZm9yIFNpdGVzKVxyXG4vLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XHJcblxyXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gZ2V0QWxsU2V0dGxlbWVudHMoKTogUHJvbWlzZTxTZXR0bGVtZW50W10+IHtcclxuICByZXR1cm4gYXdhaXQgcmVwb0dldEFsbFNldHRsZW1lbnRzKCk7XHJcbn1cclxuXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBnZXRTZXR0bGVtZW50QnlJZChpZDogc3RyaW5nKTogUHJvbWlzZTxTZXR0bGVtZW50IHwgbnVsbD4ge1xyXG4gIHJldHVybiBhd2FpdCByZXBvR2V0U2V0dGxlbWVudEJ5SWQoaWQpO1xyXG59XHJcblxyXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gdXBzZXJ0U2V0dGxlbWVudChzZXR0bGVtZW50OiBTZXR0bGVtZW50KTogUHJvbWlzZTxTZXR0bGVtZW50PiB7XHJcbiAgcmV0dXJuIGF3YWl0IHJlcG9VcHNlcnRTZXR0bGVtZW50KHNldHRsZW1lbnQpO1xyXG59XHJcblxyXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gcmVtb3ZlU2V0dGxlbWVudChpZDogc3RyaW5nKTogUHJvbWlzZTx2b2lkPiB7XHJcbiAgYXdhaXQgcmVwb1JlbW92ZVNldHRsZW1lbnQoaWQpO1xyXG59XHJcblxyXG4vLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XHJcbi8vIFNJVEUgUVVFUlkgTUVUSE9EU1xyXG4vLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XHJcblxyXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gZ2V0U2l0ZXNCeVNldHRsZW1lbnQoc2V0dGxlbWVudElkOiBzdHJpbmcpOiBQcm9taXNlPFNpdGVbXT4ge1xyXG4gIHJldHVybiBhd2FpdCByZXBvR2V0U2l0ZXNCeVNldHRsZW1lbnQoc2V0dGxlbWVudElkKTtcclxufVxyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGdldFNpdGVzQnlSYWRpdXMoXHJcbiAgY2VudGVyTGF0OiBudW1iZXIsXHJcbiAgY2VudGVyTG5nOiBudW1iZXIsXHJcbiAgcmFkaXVzTWV0ZXJzOiBudW1iZXJcclxuKTogUHJvbWlzZTxTaXRlW10+IHtcclxuICByZXR1cm4gYXdhaXQgcmVwb0dldFNpdGVzQnlSYWRpdXMoY2VudGVyTGF0LCBjZW50ZXJMbmcsIHJhZGl1c01ldGVycyk7XHJcbn1cclxuXHJcbi8vIFBPSU5UUyBDT05WRVJTSU9OIFJBVEVTXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBnZXRQb2ludHNDb252ZXJzaW9uUmF0ZXMoKTogUHJvbWlzZTxhbnk+IHtcclxuICBjb25zdCByYXRlcyA9IGF3YWl0IGt2R2V0KCdkYXRhOnBvaW50cy1jb252ZXJzaW9uLXJhdGVzJyk7XHJcbiAgcmV0dXJuIHJhdGVzIHx8IHtcclxuICAgIGhwVG9KJDogMTAsXHJcbiAgICBmcFRvSiQ6IDE1LFxyXG4gICAgcnBUb0okOiAxMixcclxuICAgIHhwVG9KJDogMyxcclxuICAgIGokVG9VU0Q6IDEwXHJcbiAgfTtcclxufVxyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIHNhdmVQb2ludHNDb252ZXJzaW9uUmF0ZXMocmF0ZXM6IGFueSk6IFByb21pc2U8dm9pZD4ge1xyXG4gIGF3YWl0IGt2U2V0KCdkYXRhOnBvaW50cy1jb252ZXJzaW9uLXJhdGVzJywgcmF0ZXMpO1xyXG59XHJcblxyXG4vLyBDT01QQU5ZIEFTU0VUU1xyXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gZ2V0Q29tcGFueUFzc2V0cygpOiBQcm9taXNlPGFueT4ge1xyXG4gIGNvbnN0IGFzc2V0cyA9IGF3YWl0IGt2R2V0KCdkYXRhOmNvbXBhbnktYXNzZXRzJyk7XHJcbiAgcmV0dXJuIGFzc2V0cyB8fCB7XHJcbiAgICBjYXNoOiAwLFxyXG4gICAgYmFuazogMCxcclxuICAgIGJpdGNvaW46IDAsXHJcbiAgICB0b0NoYXJnZTogMCxcclxuICAgIHRvUGF5OiAwLFxyXG4gICAgY29tcGFueUokOiAwLFxyXG4gICAgbWF0ZXJpYWxzOiB7IHZhbHVlOiAwLCBjb3N0OiAwIH0sXHJcbiAgICBlcXVpcG1lbnQ6IHsgdmFsdWU6IDAsIGNvc3Q6IDAgfSxcclxuICAgIGFydHdvcmtzOiB7IHZhbHVlOiAwLCBjb3N0OiAwIH0sXHJcbiAgICBwcmludHM6IHsgdmFsdWU6IDAsIGNvc3Q6IDAgfSxcclxuICAgIHN0aWNrZXJzOiB7IHZhbHVlOiAwLCBjb3N0OiAwIH0sXHJcbiAgICBtZXJjaDogeyB2YWx1ZTogMCwgY29zdDogMCB9XHJcbiAgfTtcclxufVxyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIHNhdmVDb21wYW55QXNzZXRzKGFzc2V0czogYW55KTogUHJvbWlzZTx2b2lkPiB7XHJcbiAgYXdhaXQga3ZTZXQoJ2RhdGE6Y29tcGFueS1hc3NldHMnLCBhc3NldHMpO1xyXG59XHJcblxyXG4vLyBQRVJTT05BTCBBU1NFVFNcclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGdldFBlcnNvbmFsQXNzZXRzKCk6IFByb21pc2U8YW55PiB7XHJcbiAgY29uc3QgYXNzZXRzID0gYXdhaXQga3ZHZXQoJ2RhdGE6cGVyc29uYWwtYXNzZXRzJyk7XHJcbiAgcmV0dXJuIGFzc2V0cyB8fCB7XHJcbiAgICBjYXNoOiAwLFxyXG4gICAgYmFuazogMCxcclxuICAgIGJpdGNvaW46IDAsXHJcbiAgICBjcnlwdG86IDAsXHJcbiAgICB0b0NoYXJnZTogMCxcclxuICAgIHRvUGF5OiAwLFxyXG4gICAgcGVyc29uYWxKJDogMCxcclxuICAgIHZlaGljbGU6IDAsXHJcbiAgICBwcm9wZXJ0aWVzOiAwLFxyXG4gICAgbmZ0czogMCxcclxuICAgIG90aGVyOiAwXHJcbiAgfTtcclxufVxyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIHNhdmVQZXJzb25hbEFzc2V0cyhhc3NldHM6IGFueSk6IFByb21pc2U8dm9pZD4ge1xyXG4gIGF3YWl0IGt2U2V0KCdkYXRhOnBlcnNvbmFsLWFzc2V0cycsIGFzc2V0cyk7XHJcbn1cclxuXHJcbi8vIENPTlZFUlNJT04gUkFURVNcclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGdldENvbnZlcnNpb25SYXRlcygpOiBQcm9taXNlPGFueT4ge1xyXG4gIGNvbnN0IHJhdGVzID0gYXdhaXQga3ZHZXQoJ2RhdGE6Y29udmVyc2lvbi1yYXRlcycpO1xyXG4gIHJldHVybiByYXRlcyB8fCB7XHJcbiAgICBocFRvSiQ6IDEwLFxyXG4gICAgZnBUb0okOiAxNSxcclxuICAgIHJwVG9KJDogMTIsXHJcbiAgICB4cFRvSiQ6IDMsXHJcbiAgICBqJFRvVVNEOiAxMCxcclxuICAgIGNvbG9uZXNUb1VzZDogNTAwLFxyXG4gICAgYml0Y29pblRvVXNkOiA1MDAwMCxcclxuICAgIGp1bmdsZUNvaW5zVG9Vc2Q6IDAuMVxyXG4gIH07XHJcbn1cclxuXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBzYXZlQ29udmVyc2lvblJhdGVzKHJhdGVzOiBhbnkpOiBQcm9taXNlPHZvaWQ+IHtcclxuICBhd2FpdCBrdlNldCgnZGF0YTpjb252ZXJzaW9uLXJhdGVzJywgcmF0ZXMpO1xyXG59Il0sIm5hbWVzIjpbIkVudGl0eVR5cGUiLCJ1cHNlcnRUYXNrIiwicmVwb1Vwc2VydFRhc2siLCJnZXRBbGxUYXNrcyIsInJlcG9HZXRBbGxUYXNrcyIsImdldFRhc2tCeUlkIiwicmVwb0dldFRhc2tCeUlkIiwiZGVsZXRlVGFzayIsInJlcG9EZWxldGVUYXNrIiwidXBzZXJ0SXRlbSIsInJlcG9VcHNlcnRJdGVtIiwiZ2V0QWxsSXRlbXMiLCJyZXBvR2V0QWxsSXRlbXMiLCJnZXRJdGVtQnlJZCIsInJlcG9HZXRJdGVtQnlJZCIsImRlbGV0ZUl0ZW0iLCJyZXBvRGVsZXRlSXRlbSIsInVwc2VydEZpbmFuY2lhbCIsInJlcG9VcHNlcnRGaW5hbmNpYWwiLCJnZXRBbGxGaW5hbmNpYWxzIiwicmVwb0dldEFsbEZpbmFuY2lhbHMiLCJnZXRGaW5hbmNpYWxCeUlkIiwicmVwb0dldEZpbmFuY2lhbEJ5SWQiLCJkZWxldGVGaW5hbmNpYWwiLCJyZXBvRGVsZXRlRmluYW5jaWFsIiwidXBzZXJ0U2FsZSIsInJlcG9VcHNlcnRTYWxlIiwiZ2V0QWxsU2FsZXMiLCJyZXBvR2V0QWxsU2FsZXMiLCJnZXRTYWxlQnlJZCIsInJlcG9HZXRTYWxlQnlJZCIsImRlbGV0ZVNhbGUiLCJyZXBvRGVsZXRlU2FsZSIsInVwc2VydENoYXJhY3RlciIsInJlcG9VcHNlcnRDaGFyYWN0ZXIiLCJnZXRBbGxDaGFyYWN0ZXJzIiwicmVwb0dldEFsbENoYXJhY3RlcnMiLCJnZXRDaGFyYWN0ZXJCeUlkIiwicmVwb0dldENoYXJhY3RlckJ5SWQiLCJkZWxldGVDaGFyYWN0ZXIiLCJyZXBvRGVsZXRlQ2hhcmFjdGVyIiwidXBzZXJ0UGxheWVyIiwicmVwb1Vwc2VydFBsYXllciIsImdldEFsbFBsYXllcnMiLCJyZXBvR2V0QWxsUGxheWVycyIsImdldFBsYXllckJ5SWQiLCJyZXBvR2V0UGxheWVyQnlJZCIsImRlbGV0ZVBsYXllciIsInJlcG9EZWxldGVQbGF5ZXIiLCJ1cHNlcnRTaXRlIiwicmVwb1Vwc2VydFNpdGUiLCJnZXRBbGxTaXRlcyIsInJlcG9HZXRBbGxTaXRlcyIsImdldFNpdGVCeUlkIiwicmVwb0dldFNpdGVCeUlkIiwiZGVsZXRlU2l0ZSIsInJlcG9EZWxldGVTaXRlIiwiZ2V0QWxsU2V0dGxlbWVudHMiLCJyZXBvR2V0QWxsU2V0dGxlbWVudHMiLCJnZXRTZXR0bGVtZW50QnlJZCIsInJlcG9HZXRTZXR0bGVtZW50QnlJZCIsInVwc2VydFNldHRsZW1lbnQiLCJyZXBvVXBzZXJ0U2V0dGxlbWVudCIsInJlbW92ZVNldHRsZW1lbnQiLCJyZXBvUmVtb3ZlU2V0dGxlbWVudCIsImdldFNpdGVzQnlTZXR0bGVtZW50IiwicmVwb0dldFNpdGVzQnlTZXR0bGVtZW50IiwiZ2V0U2l0ZXNCeVJhZGl1cyIsInJlcG9HZXRTaXRlc0J5UmFkaXVzIiwia3ZHZXQiLCJrdlNldCIsIm9uVGFza1Vwc2VydCIsIm9uSXRlbVVwc2VydCIsIm9uRmluYW5jaWFsVXBzZXJ0Iiwib25TYWxlVXBzZXJ0Iiwib25DaGFyYWN0ZXJVcHNlcnQiLCJvblBsYXllclVwc2VydCIsIm9uU2l0ZVVwc2VydCIsInByb2Nlc3NMaW5rRW50aXR5IiwidGFzayIsInByZXZpb3VzIiwiaWQiLCJzYXZlZCIsInVuZGVmaW5lZCIsIlRBU0siLCJyZW1vdmVUYXNrIiwiZXhpc3RpbmciLCJyZW1vdmVUYXNrTG9nRW50cmllc09uRGVsZXRlIiwiaXRlbSIsIklURU0iLCJyZW1vdmVJdGVtIiwicmVtb3ZlSXRlbUVmZmVjdHNPbkRlbGV0ZSIsImZpbmFuY2lhbCIsIkZJTkFOQ0lBTCIsInJlbW92ZUZpbmFuY2lhbCIsInJlbW92ZVJlY29yZEVmZmVjdHNPbkRlbGV0ZSIsInNhbGUiLCJTQUxFIiwicmVtb3ZlU2FsZSIsInJlbW92ZVNhbGVFZmZlY3RzT25EZWxldGUiLCJjaGFyYWN0ZXIiLCJDSEFSQUNURVIiLCJyZW1vdmVDaGFyYWN0ZXIiLCJyZW1vdmVDaGFyYWN0ZXJFZmZlY3RzT25EZWxldGUiLCJwbGF5ZXIiLCJQTEFZRVIiLCJyZW1vdmVQbGF5ZXIiLCJyZW1vdmVQbGF5ZXJFZmZlY3RzT25EZWxldGUiLCJzaXRlIiwiU0lURSIsInJlbW92ZVNpdGUiLCJyZW1vdmVTaXRlRWZmZWN0c09uRGVsZXRlIiwic2V0dGxlbWVudCIsInNldHRsZW1lbnRJZCIsImNlbnRlckxhdCIsImNlbnRlckxuZyIsInJhZGl1c01ldGVycyIsImdldFBvaW50c0NvbnZlcnNpb25SYXRlcyIsInJhdGVzIiwiaHBUb0okIiwiZnBUb0okIiwicnBUb0okIiwieHBUb0okIiwiaiRUb1VTRCIsInNhdmVQb2ludHNDb252ZXJzaW9uUmF0ZXMiLCJnZXRDb21wYW55QXNzZXRzIiwiYXNzZXRzIiwiY2FzaCIsImJhbmsiLCJiaXRjb2luIiwidG9DaGFyZ2UiLCJ0b1BheSIsImNvbXBhbnlKJCIsIm1hdGVyaWFscyIsInZhbHVlIiwiY29zdCIsImVxdWlwbWVudCIsImFydHdvcmtzIiwicHJpbnRzIiwic3RpY2tlcnMiLCJtZXJjaCIsInNhdmVDb21wYW55QXNzZXRzIiwiZ2V0UGVyc29uYWxBc3NldHMiLCJjcnlwdG8iLCJwZXJzb25hbEokIiwidmVoaWNsZSIsInByb3BlcnRpZXMiLCJuZnRzIiwib3RoZXIiLCJzYXZlUGVyc29uYWxBc3NldHMiLCJnZXRDb252ZXJzaW9uUmF0ZXMiLCJjb2xvbmVzVG9Vc2QiLCJiaXRjb2luVG9Vc2QiLCJqdW5nbGVDb2luc1RvVXNkIiwic2F2ZUNvbnZlcnNpb25SYXRlcyJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(app-pages-browser)/./data-store/datastore.ts\n"));

/***/ }),

/***/ "(app-pages-browser)/./data-store/effects-registry.ts":
/*!****************************************!*\
  !*** ./data-store/effects-registry.ts ***!
  \****************************************/
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval(__webpack_require__.ts("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   clearEffect: function() { return /* binding */ clearEffect; },\n/* harmony export */   clearEffectsByPrefix: function() { return /* binding */ clearEffectsByPrefix; },\n/* harmony export */   clearProcessingStack: function() { return /* binding */ clearProcessingStack; },\n/* harmony export */   endProcessing: function() { return /* binding */ endProcessing; },\n/* harmony export */   getProcessingStatus: function() { return /* binding */ getProcessingStatus; },\n/* harmony export */   hasEffect: function() { return /* binding */ hasEffect; },\n/* harmony export */   isProcessing: function() { return /* binding */ isProcessing; },\n/* harmony export */   markEffect: function() { return /* binding */ markEffect; },\n/* harmony export */   startProcessing: function() { return /* binding */ startProcessing; }\n/* harmony export */ });\n/* harmony import */ var _kv__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./kv */ \"(app-pages-browser)/./data-store/kv.ts\");\n/* harmony import */ var _keys__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./keys */ \"(app-pages-browser)/./data-store/keys.ts\");\n// data-store/effects-registry.ts\n// Idempotency registry stored in KV. Avoids global flags and server HTTP loops.\n\n\nasync function hasEffect(effectKey) {\n    const key = (0,_keys__WEBPACK_IMPORTED_MODULE_1__.buildEffectKey)(effectKey);\n    const val = await (0,_kv__WEBPACK_IMPORTED_MODULE_0__.kvGet)(key);\n    return val === true;\n}\nasync function markEffect(effectKey, ttl) {\n    const key = (0,_keys__WEBPACK_IMPORTED_MODULE_1__.buildEffectKey)(effectKey);\n    await (0,_kv__WEBPACK_IMPORTED_MODULE_0__.kvSet)(key, true);\n}\nasync function clearEffect(effectKey) {\n    const key = (0,_keys__WEBPACK_IMPORTED_MODULE_1__.buildEffectKey)(effectKey);\n    await (0,_kv__WEBPACK_IMPORTED_MODULE_0__.kvSet)(key, false);\n}\nasync function clearEffectsByPrefix(entityType, entityId, prefix) {\n    // For now, we'll implement a simple version that clears all effects for an entity\n    // In a full implementation, this would scan and clear effects with the given prefix\n    console.log(\"[clearEffectsByPrefix] Clearing effects for \".concat(entityType, \":\").concat(entityId, \" with prefix: \").concat(prefix));\n// TODO: Implement proper prefix-based clearing when needed\n}\n// ============================================================================\n// LIGHTWEIGHT CIRCUIT BREAKER: Circular reference detection and depth limits\n// ============================================================================\n// Processing stack tracking for circular reference detection\nconst processingStack = new Set();\nconst MAX_DEPTH = 5;\n/**\r\n * Check if an entity is currently being processed\r\n */ function isProcessing(entityType, entityId) {\n    return processingStack.has(\"\".concat(entityType, \":\").concat(entityId));\n}\n/**\r\n * Start processing an entity - throws error if circular reference detected\r\n */ function startProcessing(entityType, entityId) {\n    const key = \"\".concat(entityType, \":\").concat(entityId);\n    if (processingStack.has(key)) {\n        throw new Error(\"Circular reference detected: \".concat(key));\n    }\n    if (processingStack.size >= MAX_DEPTH) {\n        throw new Error(\"Max processing depth exceeded: \".concat(MAX_DEPTH));\n    }\n    processingStack.add(key);\n    console.log(\"[CircuitBreaker] Started processing: \".concat(key, \" (depth: \").concat(processingStack.size, \")\"));\n}\n/**\r\n * End processing an entity\r\n */ function endProcessing(entityType, entityId) {\n    const key = \"\".concat(entityType, \":\").concat(entityId);\n    processingStack.delete(key);\n    console.log(\"[CircuitBreaker] Ended processing: \".concat(key, \" (depth: \").concat(processingStack.size, \")\"));\n}\n/**\r\n * Get current processing status for debugging\r\n */ function getProcessingStatus() {\n    return {\n        stack: Array.from(processingStack),\n        depth: processingStack.size,\n        maxDepth: MAX_DEPTH\n    };\n}\n/**\r\n * Clear all processing state (emergency reset)\r\n */ function clearProcessingStack() {\n    processingStack.clear();\n    console.log(\"[CircuitBreaker] Cleared processing stack\");\n}\n\n\n;\n    // Wrapped in an IIFE to avoid polluting the global scope\n    ;\n    (function () {\n        var _a, _b;\n        // Legacy CSS implementations will `eval` browser code in a Node.js context\n        // to extract CSS. For backwards compatibility, we need to check we're in a\n        // browser context before continuing.\n        if (typeof self !== 'undefined' &&\n            // AMP / No-JS mode does not inject these helpers:\n            '$RefreshHelpers$' in self) {\n            // @ts-ignore __webpack_module__ is global\n            var currentExports = module.exports;\n            // @ts-ignore __webpack_module__ is global\n            var prevSignature = (_b = (_a = module.hot.data) === null || _a === void 0 ? void 0 : _a.prevSignature) !== null && _b !== void 0 ? _b : null;\n            // This cannot happen in MainTemplate because the exports mismatch between\n            // templating and execution.\n            self.$RefreshHelpers$.registerExportsForReactRefresh(currentExports, module.id);\n            // A module can be accepted automatically based on its exports, e.g. when\n            // it is a Refresh Boundary.\n            if (self.$RefreshHelpers$.isReactRefreshBoundary(currentExports)) {\n                // Save the previous exports signature on update so we can compare the boundary\n                // signatures. We avoid saving exports themselves since it causes memory leaks (https://github.com/vercel/next.js/pull/53797)\n                module.hot.dispose(function (data) {\n                    data.prevSignature =\n                        self.$RefreshHelpers$.getRefreshBoundarySignature(currentExports);\n                });\n                // Unconditionally accept an update to this module, we'll check if it's\n                // still a Refresh Boundary later.\n                // @ts-ignore importMeta is replaced in the loader\n                module.hot.accept();\n                // This field is set when the previous version of this module was a\n                // Refresh Boundary, letting us know we need to check for invalidation or\n                // enqueue an update.\n                if (prevSignature !== null) {\n                    // A boundary can become ineligible if its exports are incompatible\n                    // with the previous exports.\n                    //\n                    // For example, if you add/remove/change exports, we'll want to\n                    // re-execute the importing modules, and force those components to\n                    // re-render. Similarly, if you convert a class component to a\n                    // function, we want to invalidate the boundary.\n                    if (self.$RefreshHelpers$.shouldInvalidateReactRefreshBoundary(prevSignature, self.$RefreshHelpers$.getRefreshBoundarySignature(currentExports))) {\n                        module.hot.invalidate();\n                    }\n                    else {\n                        self.$RefreshHelpers$.scheduleUpdate();\n                    }\n                }\n            }\n            else {\n                // Since we just executed the code for the module, it's possible that the\n                // new exports made it ineligible for being a boundary.\n                // We only care about the case when we were _previously_ a boundary,\n                // because we already accepted this update (accidental side effect).\n                var isNoLongerABoundary = prevSignature !== null;\n                if (isNoLongerABoundary) {\n                    module.hot.invalidate();\n                }\n            }\n        }\n    })();\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFwcC1wYWdlcy1icm93c2VyKS8uL2RhdGEtc3RvcmUvZWZmZWN0cy1yZWdpc3RyeS50cyIsIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7OztBQUFBLGlDQUFpQztBQUNqQyxnRkFBZ0Y7QUFFNUM7QUFDSTtBQUVqQyxlQUFlRyxVQUFVQyxTQUFpQjtJQUMvQyxNQUFNQyxNQUFNSCxxREFBY0EsQ0FBQ0U7SUFDM0IsTUFBTUUsTUFBTSxNQUFNTiwwQ0FBS0EsQ0FBVUs7SUFDakMsT0FBT0MsUUFBUTtBQUNqQjtBQUVPLGVBQWVDLFdBQVdILFNBQWlCLEVBQUVJLEdBQVk7SUFDOUQsTUFBTUgsTUFBTUgscURBQWNBLENBQUNFO0lBQzNCLE1BQU1ILDBDQUFLQSxDQUFDSSxLQUFLO0FBQ25CO0FBRU8sZUFBZUksWUFBWUwsU0FBaUI7SUFDakQsTUFBTUMsTUFBTUgscURBQWNBLENBQUNFO0lBQzNCLE1BQU1ILDBDQUFLQSxDQUFDSSxLQUFLO0FBQ25CO0FBRU8sZUFBZUsscUJBQXFCQyxVQUFrQixFQUFFQyxRQUFnQixFQUFFQyxNQUFjO0lBQzdGLGtGQUFrRjtJQUNsRixvRkFBb0Y7SUFDcEZDLFFBQVFDLEdBQUcsQ0FBQywrQ0FBNkRILE9BQWRELFlBQVcsS0FBNEJFLE9BQXpCRCxVQUFTLGtCQUF1QixPQUFQQztBQUNsRywyREFBMkQ7QUFDN0Q7QUFFQSwrRUFBK0U7QUFDL0UsNkVBQTZFO0FBQzdFLCtFQUErRTtBQUUvRSw2REFBNkQ7QUFDN0QsTUFBTUcsa0JBQWtCLElBQUlDO0FBQzVCLE1BQU1DLFlBQVk7QUFFbEI7O0NBRUMsR0FDTSxTQUFTQyxhQUFhUixVQUFrQixFQUFFQyxRQUFnQjtJQUMvRCxPQUFPSSxnQkFBZ0JJLEdBQUcsQ0FBQyxHQUFpQlIsT0FBZEQsWUFBVyxLQUFZLE9BQVRDO0FBQzlDO0FBRUE7O0NBRUMsR0FDTSxTQUFTUyxnQkFBZ0JWLFVBQWtCLEVBQUVDLFFBQWdCO0lBQ2xFLE1BQU1QLE1BQU0sR0FBaUJPLE9BQWRELFlBQVcsS0FBWSxPQUFUQztJQUU3QixJQUFJSSxnQkFBZ0JJLEdBQUcsQ0FBQ2YsTUFBTTtRQUM1QixNQUFNLElBQUlpQixNQUFNLGdDQUFvQyxPQUFKakI7SUFDbEQ7SUFFQSxJQUFJVyxnQkFBZ0JPLElBQUksSUFBSUwsV0FBVztRQUNyQyxNQUFNLElBQUlJLE1BQU0sa0NBQTRDLE9BQVZKO0lBQ3BEO0lBRUFGLGdCQUFnQlEsR0FBRyxDQUFDbkI7SUFDcEJTLFFBQVFDLEdBQUcsQ0FBQyx3Q0FBdURDLE9BQWZYLEtBQUksYUFBZ0MsT0FBckJXLGdCQUFnQk8sSUFBSSxFQUFDO0FBQzFGO0FBRUE7O0NBRUMsR0FDTSxTQUFTRSxjQUFjZCxVQUFrQixFQUFFQyxRQUFnQjtJQUNoRSxNQUFNUCxNQUFNLEdBQWlCTyxPQUFkRCxZQUFXLEtBQVksT0FBVEM7SUFDN0JJLGdCQUFnQlUsTUFBTSxDQUFDckI7SUFDdkJTLFFBQVFDLEdBQUcsQ0FBQyxzQ0FBcURDLE9BQWZYLEtBQUksYUFBZ0MsT0FBckJXLGdCQUFnQk8sSUFBSSxFQUFDO0FBQ3hGO0FBRUE7O0NBRUMsR0FDTSxTQUFTSTtJQUtkLE9BQU87UUFDTEMsT0FBT0MsTUFBTUMsSUFBSSxDQUFDZDtRQUNsQmUsT0FBT2YsZ0JBQWdCTyxJQUFJO1FBQzNCUyxVQUFVZDtJQUNaO0FBQ0Y7QUFFQTs7Q0FFQyxHQUNNLFNBQVNlO0lBQ2RqQixnQkFBZ0JrQixLQUFLO0lBQ3JCcEIsUUFBUUMsR0FBRyxDQUFFO0FBQ2YiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9fTl9FLy4vZGF0YS1zdG9yZS9lZmZlY3RzLXJlZ2lzdHJ5LnRzPzk0OWIiXSwic291cmNlc0NvbnRlbnQiOlsiLy8gZGF0YS1zdG9yZS9lZmZlY3RzLXJlZ2lzdHJ5LnRzXHJcbi8vIElkZW1wb3RlbmN5IHJlZ2lzdHJ5IHN0b3JlZCBpbiBLVi4gQXZvaWRzIGdsb2JhbCBmbGFncyBhbmQgc2VydmVyIEhUVFAgbG9vcHMuXHJcblxyXG5pbXBvcnQgeyBrdkdldCwga3ZTZXQgfSBmcm9tICcuL2t2JztcclxuaW1wb3J0IHsgYnVpbGRFZmZlY3RLZXkgfSBmcm9tICcuL2tleXMnO1xyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGhhc0VmZmVjdChlZmZlY3RLZXk6IHN0cmluZyk6IFByb21pc2U8Ym9vbGVhbj4ge1xyXG4gIGNvbnN0IGtleSA9IGJ1aWxkRWZmZWN0S2V5KGVmZmVjdEtleSk7XHJcbiAgY29uc3QgdmFsID0gYXdhaXQga3ZHZXQ8Ym9vbGVhbj4oa2V5KTtcclxuICByZXR1cm4gdmFsID09PSB0cnVlO1xyXG59XHJcblxyXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gbWFya0VmZmVjdChlZmZlY3RLZXk6IHN0cmluZywgdHRsPzogbnVtYmVyKTogUHJvbWlzZTx2b2lkPiB7XHJcbiAgY29uc3Qga2V5ID0gYnVpbGRFZmZlY3RLZXkoZWZmZWN0S2V5KTtcclxuICBhd2FpdCBrdlNldChrZXksIHRydWUpO1xyXG59XHJcblxyXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gY2xlYXJFZmZlY3QoZWZmZWN0S2V5OiBzdHJpbmcpOiBQcm9taXNlPHZvaWQ+IHtcclxuICBjb25zdCBrZXkgPSBidWlsZEVmZmVjdEtleShlZmZlY3RLZXkpO1xyXG4gIGF3YWl0IGt2U2V0KGtleSwgZmFsc2UpO1xyXG59XHJcblxyXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gY2xlYXJFZmZlY3RzQnlQcmVmaXgoZW50aXR5VHlwZTogc3RyaW5nLCBlbnRpdHlJZDogc3RyaW5nLCBwcmVmaXg6IHN0cmluZyk6IFByb21pc2U8dm9pZD4ge1xyXG4gIC8vIEZvciBub3csIHdlJ2xsIGltcGxlbWVudCBhIHNpbXBsZSB2ZXJzaW9uIHRoYXQgY2xlYXJzIGFsbCBlZmZlY3RzIGZvciBhbiBlbnRpdHlcclxuICAvLyBJbiBhIGZ1bGwgaW1wbGVtZW50YXRpb24sIHRoaXMgd291bGQgc2NhbiBhbmQgY2xlYXIgZWZmZWN0cyB3aXRoIHRoZSBnaXZlbiBwcmVmaXhcclxuICBjb25zb2xlLmxvZyhgW2NsZWFyRWZmZWN0c0J5UHJlZml4XSBDbGVhcmluZyBlZmZlY3RzIGZvciAke2VudGl0eVR5cGV9OiR7ZW50aXR5SWR9IHdpdGggcHJlZml4OiAke3ByZWZpeH1gKTtcclxuICAvLyBUT0RPOiBJbXBsZW1lbnQgcHJvcGVyIHByZWZpeC1iYXNlZCBjbGVhcmluZyB3aGVuIG5lZWRlZFxyXG59XHJcblxyXG4vLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XHJcbi8vIExJR0hUV0VJR0hUIENJUkNVSVQgQlJFQUtFUjogQ2lyY3VsYXIgcmVmZXJlbmNlIGRldGVjdGlvbiBhbmQgZGVwdGggbGltaXRzXHJcbi8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cclxuXHJcbi8vIFByb2Nlc3Npbmcgc3RhY2sgdHJhY2tpbmcgZm9yIGNpcmN1bGFyIHJlZmVyZW5jZSBkZXRlY3Rpb25cclxuY29uc3QgcHJvY2Vzc2luZ1N0YWNrID0gbmV3IFNldDxzdHJpbmc+KCk7XHJcbmNvbnN0IE1BWF9ERVBUSCA9IDU7XHJcblxyXG4vKipcclxuICogQ2hlY2sgaWYgYW4gZW50aXR5IGlzIGN1cnJlbnRseSBiZWluZyBwcm9jZXNzZWRcclxuICovXHJcbmV4cG9ydCBmdW5jdGlvbiBpc1Byb2Nlc3NpbmcoZW50aXR5VHlwZTogc3RyaW5nLCBlbnRpdHlJZDogc3RyaW5nKTogYm9vbGVhbiB7XHJcbiAgcmV0dXJuIHByb2Nlc3NpbmdTdGFjay5oYXMoYCR7ZW50aXR5VHlwZX06JHtlbnRpdHlJZH1gKTtcclxufVxyXG5cclxuLyoqXHJcbiAqIFN0YXJ0IHByb2Nlc3NpbmcgYW4gZW50aXR5IC0gdGhyb3dzIGVycm9yIGlmIGNpcmN1bGFyIHJlZmVyZW5jZSBkZXRlY3RlZFxyXG4gKi9cclxuZXhwb3J0IGZ1bmN0aW9uIHN0YXJ0UHJvY2Vzc2luZyhlbnRpdHlUeXBlOiBzdHJpbmcsIGVudGl0eUlkOiBzdHJpbmcpOiB2b2lkIHtcclxuICBjb25zdCBrZXkgPSBgJHtlbnRpdHlUeXBlfToke2VudGl0eUlkfWA7XHJcbiAgXHJcbiAgaWYgKHByb2Nlc3NpbmdTdGFjay5oYXMoa2V5KSkge1xyXG4gICAgdGhyb3cgbmV3IEVycm9yKGBDaXJjdWxhciByZWZlcmVuY2UgZGV0ZWN0ZWQ6ICR7a2V5fWApO1xyXG4gIH1cclxuICBcclxuICBpZiAocHJvY2Vzc2luZ1N0YWNrLnNpemUgPj0gTUFYX0RFUFRIKSB7XHJcbiAgICB0aHJvdyBuZXcgRXJyb3IoYE1heCBwcm9jZXNzaW5nIGRlcHRoIGV4Y2VlZGVkOiAke01BWF9ERVBUSH1gKTtcclxuICB9XHJcbiAgXHJcbiAgcHJvY2Vzc2luZ1N0YWNrLmFkZChrZXkpO1xyXG4gIGNvbnNvbGUubG9nKGBbQ2lyY3VpdEJyZWFrZXJdIFN0YXJ0ZWQgcHJvY2Vzc2luZzogJHtrZXl9IChkZXB0aDogJHtwcm9jZXNzaW5nU3RhY2suc2l6ZX0pYCk7XHJcbn1cclxuXHJcbi8qKlxyXG4gKiBFbmQgcHJvY2Vzc2luZyBhbiBlbnRpdHlcclxuICovXHJcbmV4cG9ydCBmdW5jdGlvbiBlbmRQcm9jZXNzaW5nKGVudGl0eVR5cGU6IHN0cmluZywgZW50aXR5SWQ6IHN0cmluZyk6IHZvaWQge1xyXG4gIGNvbnN0IGtleSA9IGAke2VudGl0eVR5cGV9OiR7ZW50aXR5SWR9YDtcclxuICBwcm9jZXNzaW5nU3RhY2suZGVsZXRlKGtleSk7XHJcbiAgY29uc29sZS5sb2coYFtDaXJjdWl0QnJlYWtlcl0gRW5kZWQgcHJvY2Vzc2luZzogJHtrZXl9IChkZXB0aDogJHtwcm9jZXNzaW5nU3RhY2suc2l6ZX0pYCk7XHJcbn1cclxuXHJcbi8qKlxyXG4gKiBHZXQgY3VycmVudCBwcm9jZXNzaW5nIHN0YXR1cyBmb3IgZGVidWdnaW5nXHJcbiAqL1xyXG5leHBvcnQgZnVuY3Rpb24gZ2V0UHJvY2Vzc2luZ1N0YXR1cygpOiB7XHJcbiAgc3RhY2s6IHN0cmluZ1tdO1xyXG4gIGRlcHRoOiBudW1iZXI7XHJcbiAgbWF4RGVwdGg6IG51bWJlcjtcclxufSB7XHJcbiAgcmV0dXJuIHtcclxuICAgIHN0YWNrOiBBcnJheS5mcm9tKHByb2Nlc3NpbmdTdGFjayksXHJcbiAgICBkZXB0aDogcHJvY2Vzc2luZ1N0YWNrLnNpemUsXHJcbiAgICBtYXhEZXB0aDogTUFYX0RFUFRIXHJcbiAgfTtcclxufVxyXG5cclxuLyoqXHJcbiAqIENsZWFyIGFsbCBwcm9jZXNzaW5nIHN0YXRlIChlbWVyZ2VuY3kgcmVzZXQpXHJcbiAqL1xyXG5leHBvcnQgZnVuY3Rpb24gY2xlYXJQcm9jZXNzaW5nU3RhY2soKTogdm9pZCB7XHJcbiAgcHJvY2Vzc2luZ1N0YWNrLmNsZWFyKCk7XHJcbiAgY29uc29sZS5sb2coYFtDaXJjdWl0QnJlYWtlcl0gQ2xlYXJlZCBwcm9jZXNzaW5nIHN0YWNrYCk7XHJcbn1cclxuXHJcblxyXG4iXSwibmFtZXMiOlsia3ZHZXQiLCJrdlNldCIsImJ1aWxkRWZmZWN0S2V5IiwiaGFzRWZmZWN0IiwiZWZmZWN0S2V5Iiwia2V5IiwidmFsIiwibWFya0VmZmVjdCIsInR0bCIsImNsZWFyRWZmZWN0IiwiY2xlYXJFZmZlY3RzQnlQcmVmaXgiLCJlbnRpdHlUeXBlIiwiZW50aXR5SWQiLCJwcmVmaXgiLCJjb25zb2xlIiwibG9nIiwicHJvY2Vzc2luZ1N0YWNrIiwiU2V0IiwiTUFYX0RFUFRIIiwiaXNQcm9jZXNzaW5nIiwiaGFzIiwic3RhcnRQcm9jZXNzaW5nIiwiRXJyb3IiLCJzaXplIiwiYWRkIiwiZW5kUHJvY2Vzc2luZyIsImRlbGV0ZSIsImdldFByb2Nlc3NpbmdTdGF0dXMiLCJzdGFjayIsIkFycmF5IiwiZnJvbSIsImRlcHRoIiwibWF4RGVwdGgiLCJjbGVhclByb2Nlc3NpbmdTdGFjayIsImNsZWFyIl0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(app-pages-browser)/./data-store/effects-registry.ts\n"));

/***/ }),

/***/ "(app-pages-browser)/./data-store/keys.ts":
/*!****************************!*\
  !*** ./data-store/keys.ts ***!
  \****************************/
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval(__webpack_require__.ts("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   buildDataKey: function() { return /* binding */ buildDataKey; },\n/* harmony export */   buildEffectKey: function() { return /* binding */ buildEffectKey; },\n/* harmony export */   buildIndexKey: function() { return /* binding */ buildIndexKey; },\n/* harmony export */   buildLinkKey: function() { return /* binding */ buildLinkKey; },\n/* harmony export */   buildLinksIndexKey: function() { return /* binding */ buildLinksIndexKey; },\n/* harmony export */   buildLogKey: function() { return /* binding */ buildLogKey; }\n/* harmony export */ });\n// data-store/keys.ts\n// Centralized KV key builders. Keep shapes consistent across repositories.\n// Production-only system - no environment namespacing needed\nfunction buildDataKey(entity, id) {\n    return \"data:\".concat(entity, \":\").concat(id);\n}\nfunction buildIndexKey(entity) {\n    return \"index:\".concat(entity); // set of ids\n}\nfunction buildLinksIndexKey(entityType, id) {\n    return \"index:links:by-entity:\".concat(entityType, \":\").concat(id); // set of link ids\n}\nfunction buildLinkKey(id) {\n    return \"links:link:\".concat(id);\n}\nfunction buildEffectKey(effectKey) {\n    return \"effects:\".concat(effectKey);\n}\nfunction buildLogKey(entity, yyyymm) {\n    return yyyymm ? \"logs:\".concat(entity, \":\").concat(yyyymm) : \"logs:\".concat(entity);\n}\n\n\n;\n    // Wrapped in an IIFE to avoid polluting the global scope\n    ;\n    (function () {\n        var _a, _b;\n        // Legacy CSS implementations will `eval` browser code in a Node.js context\n        // to extract CSS. For backwards compatibility, we need to check we're in a\n        // browser context before continuing.\n        if (typeof self !== 'undefined' &&\n            // AMP / No-JS mode does not inject these helpers:\n            '$RefreshHelpers$' in self) {\n            // @ts-ignore __webpack_module__ is global\n            var currentExports = module.exports;\n            // @ts-ignore __webpack_module__ is global\n            var prevSignature = (_b = (_a = module.hot.data) === null || _a === void 0 ? void 0 : _a.prevSignature) !== null && _b !== void 0 ? _b : null;\n            // This cannot happen in MainTemplate because the exports mismatch between\n            // templating and execution.\n            self.$RefreshHelpers$.registerExportsForReactRefresh(currentExports, module.id);\n            // A module can be accepted automatically based on its exports, e.g. when\n            // it is a Refresh Boundary.\n            if (self.$RefreshHelpers$.isReactRefreshBoundary(currentExports)) {\n                // Save the previous exports signature on update so we can compare the boundary\n                // signatures. We avoid saving exports themselves since it causes memory leaks (https://github.com/vercel/next.js/pull/53797)\n                module.hot.dispose(function (data) {\n                    data.prevSignature =\n                        self.$RefreshHelpers$.getRefreshBoundarySignature(currentExports);\n                });\n                // Unconditionally accept an update to this module, we'll check if it's\n                // still a Refresh Boundary later.\n                // @ts-ignore importMeta is replaced in the loader\n                module.hot.accept();\n                // This field is set when the previous version of this module was a\n                // Refresh Boundary, letting us know we need to check for invalidation or\n                // enqueue an update.\n                if (prevSignature !== null) {\n                    // A boundary can become ineligible if its exports are incompatible\n                    // with the previous exports.\n                    //\n                    // For example, if you add/remove/change exports, we'll want to\n                    // re-execute the importing modules, and force those components to\n                    // re-render. Similarly, if you convert a class component to a\n                    // function, we want to invalidate the boundary.\n                    if (self.$RefreshHelpers$.shouldInvalidateReactRefreshBoundary(prevSignature, self.$RefreshHelpers$.getRefreshBoundarySignature(currentExports))) {\n                        module.hot.invalidate();\n                    }\n                    else {\n                        self.$RefreshHelpers$.scheduleUpdate();\n                    }\n                }\n            }\n            else {\n                // Since we just executed the code for the module, it's possible that the\n                // new exports made it ineligible for being a boundary.\n                // We only care about the case when we were _previously_ a boundary,\n                // because we already accepted this update (accidental side effect).\n                var isNoLongerABoundary = prevSignature !== null;\n                if (isNoLongerABoundary) {\n                    module.hot.invalidate();\n                }\n            }\n        }\n    })();\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFwcC1wYWdlcy1icm93c2VyKS8uL2RhdGEtc3RvcmUva2V5cy50cyIsIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7QUFBQSxxQkFBcUI7QUFDckIsMkVBQTJFO0FBQzNFLDZEQUE2RDtBQUV0RCxTQUFTQSxhQUFhQyxNQUFjLEVBQUVDLEVBQVU7SUFDckQsT0FBTyxRQUFrQkEsT0FBVkQsUUFBTyxLQUFNLE9BQUhDO0FBQzNCO0FBRU8sU0FBU0MsY0FBY0YsTUFBYztJQUMxQyxPQUFPLFNBQWdCLE9BQVBBLFNBQVUsYUFBYTtBQUN6QztBQUVPLFNBQVNHLG1CQUFtQkMsVUFBa0IsRUFBRUgsRUFBVTtJQUMvRCxPQUFPLHlCQUF1Q0EsT0FBZEcsWUFBVyxLQUFNLE9BQUhILEtBQU0sa0JBQWtCO0FBQ3hFO0FBRU8sU0FBU0ksYUFBYUosRUFBVTtJQUNyQyxPQUFPLGNBQWlCLE9BQUhBO0FBQ3ZCO0FBRU8sU0FBU0ssZUFBZUMsU0FBaUI7SUFDOUMsT0FBTyxXQUFxQixPQUFWQTtBQUNwQjtBQUVPLFNBQVNDLFlBQVlSLE1BQWMsRUFBRVMsTUFBZTtJQUN6RCxPQUFPQSxTQUNILFFBQWtCQSxPQUFWVCxRQUFPLEtBQVUsT0FBUFMsVUFDbEIsUUFBZSxPQUFQVDtBQUNkIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vX05fRS8uL2RhdGEtc3RvcmUva2V5cy50cz83MGUyIl0sInNvdXJjZXNDb250ZW50IjpbIi8vIGRhdGEtc3RvcmUva2V5cy50c1xyXG4vLyBDZW50cmFsaXplZCBLViBrZXkgYnVpbGRlcnMuIEtlZXAgc2hhcGVzIGNvbnNpc3RlbnQgYWNyb3NzIHJlcG9zaXRvcmllcy5cclxuLy8gUHJvZHVjdGlvbi1vbmx5IHN5c3RlbSAtIG5vIGVudmlyb25tZW50IG5hbWVzcGFjaW5nIG5lZWRlZFxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIGJ1aWxkRGF0YUtleShlbnRpdHk6IHN0cmluZywgaWQ6IHN0cmluZyk6IHN0cmluZyB7XHJcbiAgcmV0dXJuIGBkYXRhOiR7ZW50aXR5fToke2lkfWA7XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBidWlsZEluZGV4S2V5KGVudGl0eTogc3RyaW5nKTogc3RyaW5nIHtcclxuICByZXR1cm4gYGluZGV4OiR7ZW50aXR5fWA7IC8vIHNldCBvZiBpZHNcclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIGJ1aWxkTGlua3NJbmRleEtleShlbnRpdHlUeXBlOiBzdHJpbmcsIGlkOiBzdHJpbmcpOiBzdHJpbmcge1xyXG4gIHJldHVybiBgaW5kZXg6bGlua3M6YnktZW50aXR5OiR7ZW50aXR5VHlwZX06JHtpZH1gOyAvLyBzZXQgb2YgbGluayBpZHNcclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIGJ1aWxkTGlua0tleShpZDogc3RyaW5nKTogc3RyaW5nIHtcclxuICByZXR1cm4gYGxpbmtzOmxpbms6JHtpZH1gO1xyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gYnVpbGRFZmZlY3RLZXkoZWZmZWN0S2V5OiBzdHJpbmcpOiBzdHJpbmcge1xyXG4gIHJldHVybiBgZWZmZWN0czoke2VmZmVjdEtleX1gO1xyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gYnVpbGRMb2dLZXkoZW50aXR5OiBzdHJpbmcsIHl5eXltbT86IHN0cmluZyk6IHN0cmluZyB7XHJcbiAgcmV0dXJuIHl5eXltbVxyXG4gICAgPyBgbG9nczoke2VudGl0eX06JHt5eXl5bW19YFxyXG4gICAgOiBgbG9nczoke2VudGl0eX1gO1xyXG59XHJcblxyXG5cclxuIl0sIm5hbWVzIjpbImJ1aWxkRGF0YUtleSIsImVudGl0eSIsImlkIiwiYnVpbGRJbmRleEtleSIsImJ1aWxkTGlua3NJbmRleEtleSIsImVudGl0eVR5cGUiLCJidWlsZExpbmtLZXkiLCJidWlsZEVmZmVjdEtleSIsImVmZmVjdEtleSIsImJ1aWxkTG9nS2V5IiwieXl5eW1tIl0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(app-pages-browser)/./data-store/keys.ts\n"));

/***/ }),

/***/ "(app-pages-browser)/./data-store/kv.ts":
/*!**************************!*\
  !*** ./data-store/kv.ts ***!
  \**************************/
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval(__webpack_require__.ts("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   kvDel: function() { return /* binding */ kvDel; },\n/* harmony export */   kvGet: function() { return /* binding */ kvGet; },\n/* harmony export */   kvMGet: function() { return /* binding */ kvMGet; },\n/* harmony export */   kvSAdd: function() { return /* binding */ kvSAdd; },\n/* harmony export */   kvSMembers: function() { return /* binding */ kvSMembers; },\n/* harmony export */   kvSRem: function() { return /* binding */ kvSRem; },\n/* harmony export */   kvScan: function() { return /* binding */ kvScan; },\n/* harmony export */   kvSet: function() { return /* binding */ kvSet; }\n/* harmony export */ });\n/* harmony import */ var _vercel_kv__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @vercel/kv */ \"(app-pages-browser)/./node_modules/@vercel/kv/dist/index.js\");\n// data-store/kv.ts\n// Thin server-only wrappers around @vercel/kv. No HTTP calls to own routes.\n\nasync function kvGet(key) {\n    var _ref;\n    return (_ref = await _vercel_kv__WEBPACK_IMPORTED_MODULE_0__.kv.get(key)) !== null && _ref !== void 0 ? _ref : null;\n}\nasync function kvSet(key, value) {\n    await _vercel_kv__WEBPACK_IMPORTED_MODULE_0__.kv.set(key, value);\n}\nasync function kvDel(key) {\n    await _vercel_kv__WEBPACK_IMPORTED_MODULE_0__.kv.del(key);\n}\nasync function kvMGet(keys) {\n    const res = await _vercel_kv__WEBPACK_IMPORTED_MODULE_0__.kv.mget(keys);\n    return res.map((v)=>v !== null && v !== void 0 ? v : null);\n}\nasync function kvScan(prefix) {\n    let limit = arguments.length > 1 && arguments[1] !== void 0 ? arguments[1] : 100;\n    const keys = [];\n    const iter = _vercel_kv__WEBPACK_IMPORTED_MODULE_0__.kv.scanIterator({\n        match: \"\".concat(prefix, \"*\"),\n        count: limit\n    });\n    for await (const key of iter){\n        keys.push(key);\n    }\n    return keys;\n}\nasync function kvSAdd(key) {\n    for(var _len = arguments.length, members = new Array(_len > 1 ? _len - 1 : 0), _key = 1; _key < _len; _key++){\n        members[_key - 1] = arguments[_key];\n    }\n    if (members.length) await _vercel_kv__WEBPACK_IMPORTED_MODULE_0__.kv.sadd(key, ...members);\n}\nasync function kvSRem(key) {\n    for(var _len = arguments.length, members = new Array(_len > 1 ? _len - 1 : 0), _key = 1; _key < _len; _key++){\n        members[_key - 1] = arguments[_key];\n    }\n    if (members.length) await _vercel_kv__WEBPACK_IMPORTED_MODULE_0__.kv.srem(key, ...members);\n}\nasync function kvSMembers(key) {\n    const members = await _vercel_kv__WEBPACK_IMPORTED_MODULE_0__.kv.smembers(key);\n    return members !== null && members !== void 0 ? members : [];\n}\n\n\n;\n    // Wrapped in an IIFE to avoid polluting the global scope\n    ;\n    (function () {\n        var _a, _b;\n        // Legacy CSS implementations will `eval` browser code in a Node.js context\n        // to extract CSS. For backwards compatibility, we need to check we're in a\n        // browser context before continuing.\n        if (typeof self !== 'undefined' &&\n            // AMP / No-JS mode does not inject these helpers:\n            '$RefreshHelpers$' in self) {\n            // @ts-ignore __webpack_module__ is global\n            var currentExports = module.exports;\n            // @ts-ignore __webpack_module__ is global\n            var prevSignature = (_b = (_a = module.hot.data) === null || _a === void 0 ? void 0 : _a.prevSignature) !== null && _b !== void 0 ? _b : null;\n            // This cannot happen in MainTemplate because the exports mismatch between\n            // templating and execution.\n            self.$RefreshHelpers$.registerExportsForReactRefresh(currentExports, module.id);\n            // A module can be accepted automatically based on its exports, e.g. when\n            // it is a Refresh Boundary.\n            if (self.$RefreshHelpers$.isReactRefreshBoundary(currentExports)) {\n                // Save the previous exports signature on update so we can compare the boundary\n                // signatures. We avoid saving exports themselves since it causes memory leaks (https://github.com/vercel/next.js/pull/53797)\n                module.hot.dispose(function (data) {\n                    data.prevSignature =\n                        self.$RefreshHelpers$.getRefreshBoundarySignature(currentExports);\n                });\n                // Unconditionally accept an update to this module, we'll check if it's\n                // still a Refresh Boundary later.\n                // @ts-ignore importMeta is replaced in the loader\n                module.hot.accept();\n                // This field is set when the previous version of this module was a\n                // Refresh Boundary, letting us know we need to check for invalidation or\n                // enqueue an update.\n                if (prevSignature !== null) {\n                    // A boundary can become ineligible if its exports are incompatible\n                    // with the previous exports.\n                    //\n                    // For example, if you add/remove/change exports, we'll want to\n                    // re-execute the importing modules, and force those components to\n                    // re-render. Similarly, if you convert a class component to a\n                    // function, we want to invalidate the boundary.\n                    if (self.$RefreshHelpers$.shouldInvalidateReactRefreshBoundary(prevSignature, self.$RefreshHelpers$.getRefreshBoundarySignature(currentExports))) {\n                        module.hot.invalidate();\n                    }\n                    else {\n                        self.$RefreshHelpers$.scheduleUpdate();\n                    }\n                }\n            }\n            else {\n                // Since we just executed the code for the module, it's possible that the\n                // new exports made it ineligible for being a boundary.\n                // We only care about the case when we were _previously_ a boundary,\n                // because we already accepted this update (accidental side effect).\n                var isNoLongerABoundary = prevSignature !== null;\n                if (isNoLongerABoundary) {\n                    module.hot.invalidate();\n                }\n            }\n        }\n    })();\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFwcC1wYWdlcy1icm93c2VyKS8uL2RhdGEtc3RvcmUva3YudHMiLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7O0FBQUEsbUJBQW1CO0FBQ25CLDRFQUE0RTtBQUU1QztBQUV6QixlQUFlQyxNQUFTQyxHQUFXO1FBQ2hDO0lBQVIsT0FBTyxDQUFDLGFBQU1GLDBDQUFFQSxDQUFDRyxHQUFHLENBQUlELGtCQUFoQix5QkFBeUI7QUFDbkM7QUFFTyxlQUFlRSxNQUFTRixHQUFXLEVBQUVHLEtBQVE7SUFDbEQsTUFBTUwsMENBQUVBLENBQUNNLEdBQUcsQ0FBQ0osS0FBS0c7QUFDcEI7QUFFTyxlQUFlRSxNQUFNTCxHQUFXO0lBQ3JDLE1BQU1GLDBDQUFFQSxDQUFDUSxHQUFHLENBQUNOO0FBQ2Y7QUFFTyxlQUFlTyxPQUFVQyxJQUFjO0lBQzVDLE1BQU1DLE1BQU0sTUFBTVgsMENBQUVBLENBQUNZLElBQUksQ0FBQ0Y7SUFDMUIsT0FBTyxJQUFlRyxHQUFHLENBQUNDLENBQUFBLElBQU1BLGNBQUFBLGVBQUFBLElBQUs7QUFDdkM7QUFFTyxlQUFlQyxPQUFPQyxNQUFjO1FBQUVDLFFBQUFBLGlFQUFRO0lBQ25ELE1BQU1QLE9BQWlCLEVBQUU7SUFDekIsTUFBTVEsT0FBT2xCLDBDQUFFQSxDQUFDbUIsWUFBWSxDQUFDO1FBQUVDLE9BQU8sR0FBVSxPQUFQSixRQUFPO1FBQUlLLE9BQU9KO0lBQU07SUFDakUsV0FBVyxNQUFNZixPQUFPZ0IsS0FBTTtRQUM1QlIsS0FBS1ksSUFBSSxDQUFDcEI7SUFDWjtJQUNBLE9BQU9RO0FBQ1Q7QUFFTyxlQUFlYSxPQUFPckIsR0FBVztJQUFFO1FBQUdzQixRQUFILDJCQUFvQjs7SUFDNUQsSUFBSUEsUUFBUUMsTUFBTSxFQUFFLE1BQU16QiwwQ0FBRUEsQ0FBQzBCLElBQUksQ0FBQ3hCLFFBQVNzQjtBQUM3QztBQUVPLGVBQWVHLE9BQU96QixHQUFXO0lBQUU7UUFBR3NCLFFBQUgsMkJBQW9COztJQUM1RCxJQUFJQSxRQUFRQyxNQUFNLEVBQUUsTUFBTXpCLDBDQUFFQSxDQUFDNEIsSUFBSSxDQUFDMUIsUUFBU3NCO0FBQzdDO0FBRU8sZUFBZUssV0FBVzNCLEdBQVc7SUFDMUMsTUFBTXNCLFVBQVUsTUFBTXhCLDBDQUFFQSxDQUFDOEIsUUFBUSxDQUFDNUI7SUFDbEMsT0FBT3NCLG9CQUFBQSxxQkFBQUEsVUFBVyxFQUFFO0FBQ3RCIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vX05fRS8uL2RhdGEtc3RvcmUva3YudHM/NzU0NSJdLCJzb3VyY2VzQ29udGVudCI6WyIvLyBkYXRhLXN0b3JlL2t2LnRzXHJcbi8vIFRoaW4gc2VydmVyLW9ubHkgd3JhcHBlcnMgYXJvdW5kIEB2ZXJjZWwva3YuIE5vIEhUVFAgY2FsbHMgdG8gb3duIHJvdXRlcy5cclxuXHJcbmltcG9ydCB7IGt2IH0gZnJvbSAnQHZlcmNlbC9rdic7XHJcblxyXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24ga3ZHZXQ8VD4oa2V5OiBzdHJpbmcpOiBQcm9taXNlPFQgfCBudWxsPiB7XHJcbiAgcmV0dXJuIChhd2FpdCBrdi5nZXQ8VD4oa2V5KSkgPz8gbnVsbDtcclxufVxyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGt2U2V0PFQ+KGtleTogc3RyaW5nLCB2YWx1ZTogVCk6IFByb21pc2U8dm9pZD4ge1xyXG4gIGF3YWl0IGt2LnNldChrZXksIHZhbHVlIGFzIGFueSk7XHJcbn1cclxuXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBrdkRlbChrZXk6IHN0cmluZyk6IFByb21pc2U8dm9pZD4ge1xyXG4gIGF3YWl0IGt2LmRlbChrZXkpO1xyXG59XHJcblxyXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24ga3ZNR2V0PFQ+KGtleXM6IHN0cmluZ1tdKTogUHJvbWlzZTwoVCB8IG51bGwpW10+IHtcclxuICBjb25zdCByZXMgPSBhd2FpdCBrdi5tZ2V0KGtleXMpO1xyXG4gIHJldHVybiAocmVzIGFzIGFueVtdKS5tYXAodiA9PiAodiA/PyBudWxsKSk7XHJcbn1cclxuXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBrdlNjYW4ocHJlZml4OiBzdHJpbmcsIGxpbWl0ID0gMTAwKTogUHJvbWlzZTxzdHJpbmdbXT4ge1xyXG4gIGNvbnN0IGtleXM6IHN0cmluZ1tdID0gW107XHJcbiAgY29uc3QgaXRlciA9IGt2LnNjYW5JdGVyYXRvcih7IG1hdGNoOiBgJHtwcmVmaXh9KmAsIGNvdW50OiBsaW1pdCB9KTtcclxuICBmb3IgYXdhaXQgKGNvbnN0IGtleSBvZiBpdGVyKSB7XHJcbiAgICBrZXlzLnB1c2goa2V5IGFzIHN0cmluZyk7XHJcbiAgfVxyXG4gIHJldHVybiBrZXlzO1xyXG59XHJcblxyXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24ga3ZTQWRkKGtleTogc3RyaW5nLCAuLi5tZW1iZXJzOiBzdHJpbmdbXSk6IFByb21pc2U8dm9pZD4ge1xyXG4gIGlmIChtZW1iZXJzLmxlbmd0aCkgYXdhaXQga3Yuc2FkZChrZXksIC4uLihtZW1iZXJzIGFzIFtzdHJpbmcsIC4uLnN0cmluZ1tdXSkpO1xyXG59XHJcblxyXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24ga3ZTUmVtKGtleTogc3RyaW5nLCAuLi5tZW1iZXJzOiBzdHJpbmdbXSk6IFByb21pc2U8dm9pZD4ge1xyXG4gIGlmIChtZW1iZXJzLmxlbmd0aCkgYXdhaXQga3Yuc3JlbShrZXksIC4uLihtZW1iZXJzIGFzIFtzdHJpbmcsIC4uLnN0cmluZ1tdXSkpO1xyXG59XHJcblxyXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24ga3ZTTWVtYmVycyhrZXk6IHN0cmluZyk6IFByb21pc2U8c3RyaW5nW10+IHtcclxuICBjb25zdCBtZW1iZXJzID0gYXdhaXQga3Yuc21lbWJlcnMoa2V5KTtcclxuICByZXR1cm4gbWVtYmVycyA/PyBbXTtcclxufVxyXG5cclxuXHJcbiJdLCJuYW1lcyI6WyJrdiIsImt2R2V0Iiwia2V5IiwiZ2V0Iiwia3ZTZXQiLCJ2YWx1ZSIsInNldCIsImt2RGVsIiwiZGVsIiwia3ZNR2V0Iiwia2V5cyIsInJlcyIsIm1nZXQiLCJtYXAiLCJ2Iiwia3ZTY2FuIiwicHJlZml4IiwibGltaXQiLCJpdGVyIiwic2Nhbkl0ZXJhdG9yIiwibWF0Y2giLCJjb3VudCIsInB1c2giLCJrdlNBZGQiLCJtZW1iZXJzIiwibGVuZ3RoIiwic2FkZCIsImt2U1JlbSIsInNyZW0iLCJrdlNNZW1iZXJzIiwic21lbWJlcnMiXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(app-pages-browser)/./data-store/kv.ts\n"));

/***/ }),

/***/ "(app-pages-browser)/./data-store/repositories/character.repo.ts":
/*!***************************************************!*\
  !*** ./data-store/repositories/character.repo.ts ***!
  \***************************************************/
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval(__webpack_require__.ts("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   deleteCharacter: function() { return /* binding */ deleteCharacter; },\n/* harmony export */   getAllCharacters: function() { return /* binding */ getAllCharacters; },\n/* harmony export */   getCharacterById: function() { return /* binding */ getCharacterById; },\n/* harmony export */   upsertCharacter: function() { return /* binding */ upsertCharacter; }\n/* harmony export */ });\n/* harmony import */ var _kv__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../kv */ \"(app-pages-browser)/./data-store/kv.ts\");\n/* harmony import */ var _keys__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../keys */ \"(app-pages-browser)/./data-store/keys.ts\");\n// data-store/repositories/character.repo.ts\n\n\nconst ENTITY = \"characters\";\nasync function getAllCharacters() {\n    const indexKey = (0,_keys__WEBPACK_IMPORTED_MODULE_1__.buildIndexKey)(ENTITY);\n    const ids = await (0,_kv__WEBPACK_IMPORTED_MODULE_0__.kvSMembers)(indexKey);\n    if (ids.length === 0) return [];\n    const characters = [];\n    for (const id of ids){\n        const key = (0,_keys__WEBPACK_IMPORTED_MODULE_1__.buildDataKey)(ENTITY, id);\n        const character = await (0,_kv__WEBPACK_IMPORTED_MODULE_0__.kvGet)(key);\n        if (character) characters.push(character);\n    }\n    return characters;\n}\nasync function getCharacterById(id) {\n    const key = (0,_keys__WEBPACK_IMPORTED_MODULE_1__.buildDataKey)(ENTITY, id);\n    return await (0,_kv__WEBPACK_IMPORTED_MODULE_0__.kvGet)(key);\n}\nasync function upsertCharacter(character) {\n    const key = (0,_keys__WEBPACK_IMPORTED_MODULE_1__.buildDataKey)(ENTITY, character.id);\n    const indexKey = (0,_keys__WEBPACK_IMPORTED_MODULE_1__.buildIndexKey)(ENTITY);\n    await (0,_kv__WEBPACK_IMPORTED_MODULE_0__.kvSet)(key, character);\n    await (0,_kv__WEBPACK_IMPORTED_MODULE_0__.kvSAdd)(indexKey, character.id);\n    return character;\n}\nasync function deleteCharacter(id) {\n    const key = (0,_keys__WEBPACK_IMPORTED_MODULE_1__.buildDataKey)(ENTITY, id);\n    const indexKey = (0,_keys__WEBPACK_IMPORTED_MODULE_1__.buildIndexKey)(ENTITY);\n    await (0,_kv__WEBPACK_IMPORTED_MODULE_0__.kvDel)(key);\n    await (0,_kv__WEBPACK_IMPORTED_MODULE_0__.kvSRem)(indexKey, id);\n}\n\n\n;\n    // Wrapped in an IIFE to avoid polluting the global scope\n    ;\n    (function () {\n        var _a, _b;\n        // Legacy CSS implementations will `eval` browser code in a Node.js context\n        // to extract CSS. For backwards compatibility, we need to check we're in a\n        // browser context before continuing.\n        if (typeof self !== 'undefined' &&\n            // AMP / No-JS mode does not inject these helpers:\n            '$RefreshHelpers$' in self) {\n            // @ts-ignore __webpack_module__ is global\n            var currentExports = module.exports;\n            // @ts-ignore __webpack_module__ is global\n            var prevSignature = (_b = (_a = module.hot.data) === null || _a === void 0 ? void 0 : _a.prevSignature) !== null && _b !== void 0 ? _b : null;\n            // This cannot happen in MainTemplate because the exports mismatch between\n            // templating and execution.\n            self.$RefreshHelpers$.registerExportsForReactRefresh(currentExports, module.id);\n            // A module can be accepted automatically based on its exports, e.g. when\n            // it is a Refresh Boundary.\n            if (self.$RefreshHelpers$.isReactRefreshBoundary(currentExports)) {\n                // Save the previous exports signature on update so we can compare the boundary\n                // signatures. We avoid saving exports themselves since it causes memory leaks (https://github.com/vercel/next.js/pull/53797)\n                module.hot.dispose(function (data) {\n                    data.prevSignature =\n                        self.$RefreshHelpers$.getRefreshBoundarySignature(currentExports);\n                });\n                // Unconditionally accept an update to this module, we'll check if it's\n                // still a Refresh Boundary later.\n                // @ts-ignore importMeta is replaced in the loader\n                module.hot.accept();\n                // This field is set when the previous version of this module was a\n                // Refresh Boundary, letting us know we need to check for invalidation or\n                // enqueue an update.\n                if (prevSignature !== null) {\n                    // A boundary can become ineligible if its exports are incompatible\n                    // with the previous exports.\n                    //\n                    // For example, if you add/remove/change exports, we'll want to\n                    // re-execute the importing modules, and force those components to\n                    // re-render. Similarly, if you convert a class component to a\n                    // function, we want to invalidate the boundary.\n                    if (self.$RefreshHelpers$.shouldInvalidateReactRefreshBoundary(prevSignature, self.$RefreshHelpers$.getRefreshBoundarySignature(currentExports))) {\n                        module.hot.invalidate();\n                    }\n                    else {\n                        self.$RefreshHelpers$.scheduleUpdate();\n                    }\n                }\n            }\n            else {\n                // Since we just executed the code for the module, it's possible that the\n                // new exports made it ineligible for being a boundary.\n                // We only care about the case when we were _previously_ a boundary,\n                // because we already accepted this update (accidental side effect).\n                var isNoLongerABoundary = prevSignature !== null;\n                if (isNoLongerABoundary) {\n                    module.hot.invalidate();\n                }\n            }\n        }\n    })();\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFwcC1wYWdlcy1icm93c2VyKS8uL2RhdGEtc3RvcmUvcmVwb3NpdG9yaWVzL2NoYXJhY3Rlci5yZXBvLnRzIiwibWFwcGluZ3MiOiI7Ozs7Ozs7OztBQUFBLDRDQUE0QztBQUM0QjtBQUNsQjtBQUd0RCxNQUFNUSxTQUFTO0FBRVIsZUFBZUM7SUFDcEIsTUFBTUMsV0FBV0gsb0RBQWFBLENBQUNDO0lBQy9CLE1BQU1HLE1BQU0sTUFBTU4sK0NBQVVBLENBQUNLO0lBQzdCLElBQUlDLElBQUlDLE1BQU0sS0FBSyxHQUFHLE9BQU8sRUFBRTtJQUUvQixNQUFNQyxhQUEwQixFQUFFO0lBQ2xDLEtBQUssTUFBTUMsTUFBTUgsSUFBSztRQUNwQixNQUFNSSxNQUFNVCxtREFBWUEsQ0FBQ0UsUUFBUU07UUFDakMsTUFBTUUsWUFBWSxNQUFNaEIsMENBQUtBLENBQVllO1FBQ3pDLElBQUlDLFdBQVdILFdBQVdJLElBQUksQ0FBQ0Q7SUFDakM7SUFFQSxPQUFPSDtBQUNUO0FBRU8sZUFBZUssaUJBQWlCSixFQUFVO0lBQy9DLE1BQU1DLE1BQU1ULG1EQUFZQSxDQUFDRSxRQUFRTTtJQUNqQyxPQUFPLE1BQU1kLDBDQUFLQSxDQUFZZTtBQUNoQztBQUVPLGVBQWVJLGdCQUFnQkgsU0FBb0I7SUFDeEQsTUFBTUQsTUFBTVQsbURBQVlBLENBQUNFLFFBQVFRLFVBQVVGLEVBQUU7SUFDN0MsTUFBTUosV0FBV0gsb0RBQWFBLENBQUNDO0lBRS9CLE1BQU1QLDBDQUFLQSxDQUFDYyxLQUFLQztJQUNqQixNQUFNYiwyQ0FBTUEsQ0FBQ08sVUFBVU0sVUFBVUYsRUFBRTtJQUVuQyxPQUFPRTtBQUNUO0FBRU8sZUFBZUksZ0JBQWdCTixFQUFVO0lBQzlDLE1BQU1DLE1BQU1ULG1EQUFZQSxDQUFDRSxRQUFRTTtJQUNqQyxNQUFNSixXQUFXSCxvREFBYUEsQ0FBQ0M7SUFFL0IsTUFBTU4sMENBQUtBLENBQUNhO0lBQ1osTUFBTVgsMkNBQU1BLENBQUNNLFVBQVVJO0FBQ3pCIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vX05fRS8uL2RhdGEtc3RvcmUvcmVwb3NpdG9yaWVzL2NoYXJhY3Rlci5yZXBvLnRzP2VhNTQiXSwic291cmNlc0NvbnRlbnQiOlsiLy8gZGF0YS1zdG9yZS9yZXBvc2l0b3JpZXMvY2hhcmFjdGVyLnJlcG8udHNcclxuaW1wb3J0IHsga3ZHZXQsIGt2U2V0LCBrdkRlbCwga3ZTQWRkLCBrdlNSZW0sIGt2U01lbWJlcnMgfSBmcm9tICcuLi9rdic7XHJcbmltcG9ydCB7IGJ1aWxkRGF0YUtleSwgYnVpbGRJbmRleEtleSB9IGZyb20gJy4uL2tleXMnO1xyXG5pbXBvcnQgdHlwZSB7IENoYXJhY3RlciB9IGZyb20gJ0AvdHlwZXMvZW50aXRpZXMnO1xyXG5cclxuY29uc3QgRU5USVRZID0gJ2NoYXJhY3RlcnMnO1xyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGdldEFsbENoYXJhY3RlcnMoKTogUHJvbWlzZTxDaGFyYWN0ZXJbXT4ge1xyXG4gIGNvbnN0IGluZGV4S2V5ID0gYnVpbGRJbmRleEtleShFTlRJVFkpO1xyXG4gIGNvbnN0IGlkcyA9IGF3YWl0IGt2U01lbWJlcnMoaW5kZXhLZXkpO1xyXG4gIGlmIChpZHMubGVuZ3RoID09PSAwKSByZXR1cm4gW107XHJcbiAgXHJcbiAgY29uc3QgY2hhcmFjdGVyczogQ2hhcmFjdGVyW10gPSBbXTtcclxuICBmb3IgKGNvbnN0IGlkIG9mIGlkcykge1xyXG4gICAgY29uc3Qga2V5ID0gYnVpbGREYXRhS2V5KEVOVElUWSwgaWQpO1xyXG4gICAgY29uc3QgY2hhcmFjdGVyID0gYXdhaXQga3ZHZXQ8Q2hhcmFjdGVyPihrZXkpO1xyXG4gICAgaWYgKGNoYXJhY3RlcikgY2hhcmFjdGVycy5wdXNoKGNoYXJhY3Rlcik7XHJcbiAgfVxyXG4gIFxyXG4gIHJldHVybiBjaGFyYWN0ZXJzO1xyXG59XHJcblxyXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gZ2V0Q2hhcmFjdGVyQnlJZChpZDogc3RyaW5nKTogUHJvbWlzZTxDaGFyYWN0ZXIgfCBudWxsPiB7XHJcbiAgY29uc3Qga2V5ID0gYnVpbGREYXRhS2V5KEVOVElUWSwgaWQpO1xyXG4gIHJldHVybiBhd2FpdCBrdkdldDxDaGFyYWN0ZXI+KGtleSk7XHJcbn1cclxuXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiB1cHNlcnRDaGFyYWN0ZXIoY2hhcmFjdGVyOiBDaGFyYWN0ZXIpOiBQcm9taXNlPENoYXJhY3Rlcj4ge1xyXG4gIGNvbnN0IGtleSA9IGJ1aWxkRGF0YUtleShFTlRJVFksIGNoYXJhY3Rlci5pZCk7XHJcbiAgY29uc3QgaW5kZXhLZXkgPSBidWlsZEluZGV4S2V5KEVOVElUWSk7XHJcbiAgXHJcbiAgYXdhaXQga3ZTZXQoa2V5LCBjaGFyYWN0ZXIpO1xyXG4gIGF3YWl0IGt2U0FkZChpbmRleEtleSwgY2hhcmFjdGVyLmlkKTtcclxuICBcclxuICByZXR1cm4gY2hhcmFjdGVyO1xyXG59XHJcblxyXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gZGVsZXRlQ2hhcmFjdGVyKGlkOiBzdHJpbmcpOiBQcm9taXNlPHZvaWQ+IHtcclxuICBjb25zdCBrZXkgPSBidWlsZERhdGFLZXkoRU5USVRZLCBpZCk7XHJcbiAgY29uc3QgaW5kZXhLZXkgPSBidWlsZEluZGV4S2V5KEVOVElUWSk7XHJcbiAgXHJcbiAgYXdhaXQga3ZEZWwoa2V5KTtcclxuICBhd2FpdCBrdlNSZW0oaW5kZXhLZXksIGlkKTtcclxufVxyXG4iXSwibmFtZXMiOlsia3ZHZXQiLCJrdlNldCIsImt2RGVsIiwia3ZTQWRkIiwia3ZTUmVtIiwia3ZTTWVtYmVycyIsImJ1aWxkRGF0YUtleSIsImJ1aWxkSW5kZXhLZXkiLCJFTlRJVFkiLCJnZXRBbGxDaGFyYWN0ZXJzIiwiaW5kZXhLZXkiLCJpZHMiLCJsZW5ndGgiLCJjaGFyYWN0ZXJzIiwiaWQiLCJrZXkiLCJjaGFyYWN0ZXIiLCJwdXNoIiwiZ2V0Q2hhcmFjdGVyQnlJZCIsInVwc2VydENoYXJhY3RlciIsImRlbGV0ZUNoYXJhY3RlciJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(app-pages-browser)/./data-store/repositories/character.repo.ts\n"));

/***/ }),

/***/ "(app-pages-browser)/./data-store/repositories/financial.repo.ts":
/*!***************************************************!*\
  !*** ./data-store/repositories/financial.repo.ts ***!
  \***************************************************/
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval(__webpack_require__.ts("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   deleteFinancial: function() { return /* binding */ deleteFinancial; },\n/* harmony export */   getAllFinancials: function() { return /* binding */ getAllFinancials; },\n/* harmony export */   getFinancialById: function() { return /* binding */ getFinancialById; },\n/* harmony export */   upsertFinancial: function() { return /* binding */ upsertFinancial; }\n/* harmony export */ });\n/* harmony import */ var _kv__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../kv */ \"(app-pages-browser)/./data-store/kv.ts\");\n/* harmony import */ var _keys__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../keys */ \"(app-pages-browser)/./data-store/keys.ts\");\n// data-store/repositories/financial.repo.ts\n\n\nconst ENTITY = \"financials\";\nasync function getAllFinancials() {\n    const indexKey = (0,_keys__WEBPACK_IMPORTED_MODULE_1__.buildIndexKey)(ENTITY);\n    const ids = await (0,_kv__WEBPACK_IMPORTED_MODULE_0__.kvSMembers)(indexKey);\n    if (ids.length === 0) return [];\n    const financials = [];\n    for (const id of ids){\n        const key = (0,_keys__WEBPACK_IMPORTED_MODULE_1__.buildDataKey)(ENTITY, id);\n        const financial = await (0,_kv__WEBPACK_IMPORTED_MODULE_0__.kvGet)(key);\n        if (financial) financials.push(financial);\n    }\n    return financials;\n}\nasync function getFinancialById(id) {\n    const key = (0,_keys__WEBPACK_IMPORTED_MODULE_1__.buildDataKey)(ENTITY, id);\n    return await (0,_kv__WEBPACK_IMPORTED_MODULE_0__.kvGet)(key);\n}\nasync function upsertFinancial(financial) {\n    const key = (0,_keys__WEBPACK_IMPORTED_MODULE_1__.buildDataKey)(ENTITY, financial.id);\n    const indexKey = (0,_keys__WEBPACK_IMPORTED_MODULE_1__.buildIndexKey)(ENTITY);\n    await (0,_kv__WEBPACK_IMPORTED_MODULE_0__.kvSet)(key, financial);\n    await (0,_kv__WEBPACK_IMPORTED_MODULE_0__.kvSAdd)(indexKey, financial.id);\n    return financial;\n}\nasync function deleteFinancial(id) {\n    const key = (0,_keys__WEBPACK_IMPORTED_MODULE_1__.buildDataKey)(ENTITY, id);\n    const indexKey = (0,_keys__WEBPACK_IMPORTED_MODULE_1__.buildIndexKey)(ENTITY);\n    await (0,_kv__WEBPACK_IMPORTED_MODULE_0__.kvDel)(key);\n    await (0,_kv__WEBPACK_IMPORTED_MODULE_0__.kvSRem)(indexKey, id);\n}\n\n\n;\n    // Wrapped in an IIFE to avoid polluting the global scope\n    ;\n    (function () {\n        var _a, _b;\n        // Legacy CSS implementations will `eval` browser code in a Node.js context\n        // to extract CSS. For backwards compatibility, we need to check we're in a\n        // browser context before continuing.\n        if (typeof self !== 'undefined' &&\n            // AMP / No-JS mode does not inject these helpers:\n            '$RefreshHelpers$' in self) {\n            // @ts-ignore __webpack_module__ is global\n            var currentExports = module.exports;\n            // @ts-ignore __webpack_module__ is global\n            var prevSignature = (_b = (_a = module.hot.data) === null || _a === void 0 ? void 0 : _a.prevSignature) !== null && _b !== void 0 ? _b : null;\n            // This cannot happen in MainTemplate because the exports mismatch between\n            // templating and execution.\n            self.$RefreshHelpers$.registerExportsForReactRefresh(currentExports, module.id);\n            // A module can be accepted automatically based on its exports, e.g. when\n            // it is a Refresh Boundary.\n            if (self.$RefreshHelpers$.isReactRefreshBoundary(currentExports)) {\n                // Save the previous exports signature on update so we can compare the boundary\n                // signatures. We avoid saving exports themselves since it causes memory leaks (https://github.com/vercel/next.js/pull/53797)\n                module.hot.dispose(function (data) {\n                    data.prevSignature =\n                        self.$RefreshHelpers$.getRefreshBoundarySignature(currentExports);\n                });\n                // Unconditionally accept an update to this module, we'll check if it's\n                // still a Refresh Boundary later.\n                // @ts-ignore importMeta is replaced in the loader\n                module.hot.accept();\n                // This field is set when the previous version of this module was a\n                // Refresh Boundary, letting us know we need to check for invalidation or\n                // enqueue an update.\n                if (prevSignature !== null) {\n                    // A boundary can become ineligible if its exports are incompatible\n                    // with the previous exports.\n                    //\n                    // For example, if you add/remove/change exports, we'll want to\n                    // re-execute the importing modules, and force those components to\n                    // re-render. Similarly, if you convert a class component to a\n                    // function, we want to invalidate the boundary.\n                    if (self.$RefreshHelpers$.shouldInvalidateReactRefreshBoundary(prevSignature, self.$RefreshHelpers$.getRefreshBoundarySignature(currentExports))) {\n                        module.hot.invalidate();\n                    }\n                    else {\n                        self.$RefreshHelpers$.scheduleUpdate();\n                    }\n                }\n            }\n            else {\n                // Since we just executed the code for the module, it's possible that the\n                // new exports made it ineligible for being a boundary.\n                // We only care about the case when we were _previously_ a boundary,\n                // because we already accepted this update (accidental side effect).\n                var isNoLongerABoundary = prevSignature !== null;\n                if (isNoLongerABoundary) {\n                    module.hot.invalidate();\n                }\n            }\n        }\n    })();\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFwcC1wYWdlcy1icm93c2VyKS8uL2RhdGEtc3RvcmUvcmVwb3NpdG9yaWVzL2ZpbmFuY2lhbC5yZXBvLnRzIiwibWFwcGluZ3MiOiI7Ozs7Ozs7OztBQUFBLDRDQUE0QztBQUM0QjtBQUNsQjtBQUd0RCxNQUFNUSxTQUFTO0FBRVIsZUFBZUM7SUFDcEIsTUFBTUMsV0FBV0gsb0RBQWFBLENBQUNDO0lBQy9CLE1BQU1HLE1BQU0sTUFBTU4sK0NBQVVBLENBQUNLO0lBQzdCLElBQUlDLElBQUlDLE1BQU0sS0FBSyxHQUFHLE9BQU8sRUFBRTtJQUUvQixNQUFNQyxhQUFnQyxFQUFFO0lBQ3hDLEtBQUssTUFBTUMsTUFBTUgsSUFBSztRQUNwQixNQUFNSSxNQUFNVCxtREFBWUEsQ0FBQ0UsUUFBUU07UUFDakMsTUFBTUUsWUFBWSxNQUFNaEIsMENBQUtBLENBQWtCZTtRQUMvQyxJQUFJQyxXQUFXSCxXQUFXSSxJQUFJLENBQUNEO0lBQ2pDO0lBRUEsT0FBT0g7QUFDVDtBQUVPLGVBQWVLLGlCQUFpQkosRUFBVTtJQUMvQyxNQUFNQyxNQUFNVCxtREFBWUEsQ0FBQ0UsUUFBUU07SUFDakMsT0FBTyxNQUFNZCwwQ0FBS0EsQ0FBa0JlO0FBQ3RDO0FBRU8sZUFBZUksZ0JBQWdCSCxTQUEwQjtJQUM5RCxNQUFNRCxNQUFNVCxtREFBWUEsQ0FBQ0UsUUFBUVEsVUFBVUYsRUFBRTtJQUM3QyxNQUFNSixXQUFXSCxvREFBYUEsQ0FBQ0M7SUFFL0IsTUFBTVAsMENBQUtBLENBQUNjLEtBQUtDO0lBQ2pCLE1BQU1iLDJDQUFNQSxDQUFDTyxVQUFVTSxVQUFVRixFQUFFO0lBRW5DLE9BQU9FO0FBQ1Q7QUFFTyxlQUFlSSxnQkFBZ0JOLEVBQVU7SUFDOUMsTUFBTUMsTUFBTVQsbURBQVlBLENBQUNFLFFBQVFNO0lBQ2pDLE1BQU1KLFdBQVdILG9EQUFhQSxDQUFDQztJQUUvQixNQUFNTiwwQ0FBS0EsQ0FBQ2E7SUFDWixNQUFNWCwyQ0FBTUEsQ0FBQ00sVUFBVUk7QUFDekIiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9fTl9FLy4vZGF0YS1zdG9yZS9yZXBvc2l0b3JpZXMvZmluYW5jaWFsLnJlcG8udHM/ZGUwYSJdLCJzb3VyY2VzQ29udGVudCI6WyIvLyBkYXRhLXN0b3JlL3JlcG9zaXRvcmllcy9maW5hbmNpYWwucmVwby50c1xyXG5pbXBvcnQgeyBrdkdldCwga3ZTZXQsIGt2RGVsLCBrdlNBZGQsIGt2U1JlbSwga3ZTTWVtYmVycyB9IGZyb20gJy4uL2t2JztcclxuaW1wb3J0IHsgYnVpbGREYXRhS2V5LCBidWlsZEluZGV4S2V5IH0gZnJvbSAnLi4va2V5cyc7XHJcbmltcG9ydCB0eXBlIHsgRmluYW5jaWFsUmVjb3JkIH0gZnJvbSAnQC90eXBlcy9lbnRpdGllcyc7XHJcblxyXG5jb25zdCBFTlRJVFkgPSAnZmluYW5jaWFscyc7XHJcblxyXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gZ2V0QWxsRmluYW5jaWFscygpOiBQcm9taXNlPEZpbmFuY2lhbFJlY29yZFtdPiB7XHJcbiAgY29uc3QgaW5kZXhLZXkgPSBidWlsZEluZGV4S2V5KEVOVElUWSk7XHJcbiAgY29uc3QgaWRzID0gYXdhaXQga3ZTTWVtYmVycyhpbmRleEtleSk7XHJcbiAgaWYgKGlkcy5sZW5ndGggPT09IDApIHJldHVybiBbXTtcclxuICBcclxuICBjb25zdCBmaW5hbmNpYWxzOiBGaW5hbmNpYWxSZWNvcmRbXSA9IFtdO1xyXG4gIGZvciAoY29uc3QgaWQgb2YgaWRzKSB7XHJcbiAgICBjb25zdCBrZXkgPSBidWlsZERhdGFLZXkoRU5USVRZLCBpZCk7XHJcbiAgICBjb25zdCBmaW5hbmNpYWwgPSBhd2FpdCBrdkdldDxGaW5hbmNpYWxSZWNvcmQ+KGtleSk7XHJcbiAgICBpZiAoZmluYW5jaWFsKSBmaW5hbmNpYWxzLnB1c2goZmluYW5jaWFsKTtcclxuICB9XHJcbiAgXHJcbiAgcmV0dXJuIGZpbmFuY2lhbHM7XHJcbn1cclxuXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBnZXRGaW5hbmNpYWxCeUlkKGlkOiBzdHJpbmcpOiBQcm9taXNlPEZpbmFuY2lhbFJlY29yZCB8IG51bGw+IHtcclxuICBjb25zdCBrZXkgPSBidWlsZERhdGFLZXkoRU5USVRZLCBpZCk7XHJcbiAgcmV0dXJuIGF3YWl0IGt2R2V0PEZpbmFuY2lhbFJlY29yZD4oa2V5KTtcclxufVxyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIHVwc2VydEZpbmFuY2lhbChmaW5hbmNpYWw6IEZpbmFuY2lhbFJlY29yZCk6IFByb21pc2U8RmluYW5jaWFsUmVjb3JkPiB7XHJcbiAgY29uc3Qga2V5ID0gYnVpbGREYXRhS2V5KEVOVElUWSwgZmluYW5jaWFsLmlkKTtcclxuICBjb25zdCBpbmRleEtleSA9IGJ1aWxkSW5kZXhLZXkoRU5USVRZKTtcclxuICBcclxuICBhd2FpdCBrdlNldChrZXksIGZpbmFuY2lhbCk7XHJcbiAgYXdhaXQga3ZTQWRkKGluZGV4S2V5LCBmaW5hbmNpYWwuaWQpO1xyXG4gIFxyXG4gIHJldHVybiBmaW5hbmNpYWw7XHJcbn1cclxuXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBkZWxldGVGaW5hbmNpYWwoaWQ6IHN0cmluZyk6IFByb21pc2U8dm9pZD4ge1xyXG4gIGNvbnN0IGtleSA9IGJ1aWxkRGF0YUtleShFTlRJVFksIGlkKTtcclxuICBjb25zdCBpbmRleEtleSA9IGJ1aWxkSW5kZXhLZXkoRU5USVRZKTtcclxuICBcclxuICBhd2FpdCBrdkRlbChrZXkpO1xyXG4gIGF3YWl0IGt2U1JlbShpbmRleEtleSwgaWQpO1xyXG59XHJcbiJdLCJuYW1lcyI6WyJrdkdldCIsImt2U2V0Iiwia3ZEZWwiLCJrdlNBZGQiLCJrdlNSZW0iLCJrdlNNZW1iZXJzIiwiYnVpbGREYXRhS2V5IiwiYnVpbGRJbmRleEtleSIsIkVOVElUWSIsImdldEFsbEZpbmFuY2lhbHMiLCJpbmRleEtleSIsImlkcyIsImxlbmd0aCIsImZpbmFuY2lhbHMiLCJpZCIsImtleSIsImZpbmFuY2lhbCIsInB1c2giLCJnZXRGaW5hbmNpYWxCeUlkIiwidXBzZXJ0RmluYW5jaWFsIiwiZGVsZXRlRmluYW5jaWFsIl0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(app-pages-browser)/./data-store/repositories/financial.repo.ts\n"));

/***/ }),

/***/ "(app-pages-browser)/./data-store/repositories/item.repo.ts":
/*!**********************************************!*\
  !*** ./data-store/repositories/item.repo.ts ***!
  \**********************************************/
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval(__webpack_require__.ts("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   deleteItem: function() { return /* binding */ deleteItem; },\n/* harmony export */   getAllItems: function() { return /* binding */ getAllItems; },\n/* harmony export */   getItemById: function() { return /* binding */ getItemById; },\n/* harmony export */   upsertItem: function() { return /* binding */ upsertItem; }\n/* harmony export */ });\n/* harmony import */ var _kv__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../kv */ \"(app-pages-browser)/./data-store/kv.ts\");\n/* harmony import */ var _keys__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../keys */ \"(app-pages-browser)/./data-store/keys.ts\");\n// data-store/repositories/item.repo.ts\n\n\nconst ENTITY = \"items\";\nasync function getAllItems() {\n    const indexKey = (0,_keys__WEBPACK_IMPORTED_MODULE_1__.buildIndexKey)(ENTITY);\n    const ids = await (0,_kv__WEBPACK_IMPORTED_MODULE_0__.kvSMembers)(indexKey);\n    if (ids.length === 0) return [];\n    const items = [];\n    for (const id of ids){\n        const key = (0,_keys__WEBPACK_IMPORTED_MODULE_1__.buildDataKey)(ENTITY, id);\n        const item = await (0,_kv__WEBPACK_IMPORTED_MODULE_0__.kvGet)(key);\n        if (item) items.push(item);\n    }\n    return items;\n}\nasync function getItemById(id) {\n    const key = (0,_keys__WEBPACK_IMPORTED_MODULE_1__.buildDataKey)(ENTITY, id);\n    return await (0,_kv__WEBPACK_IMPORTED_MODULE_0__.kvGet)(key);\n}\nasync function upsertItem(item) {\n    const key = (0,_keys__WEBPACK_IMPORTED_MODULE_1__.buildDataKey)(ENTITY, item.id);\n    const indexKey = (0,_keys__WEBPACK_IMPORTED_MODULE_1__.buildIndexKey)(ENTITY);\n    await (0,_kv__WEBPACK_IMPORTED_MODULE_0__.kvSet)(key, item);\n    await (0,_kv__WEBPACK_IMPORTED_MODULE_0__.kvSAdd)(indexKey, item.id);\n    return item;\n}\nasync function deleteItem(id) {\n    const key = (0,_keys__WEBPACK_IMPORTED_MODULE_1__.buildDataKey)(ENTITY, id);\n    const indexKey = (0,_keys__WEBPACK_IMPORTED_MODULE_1__.buildIndexKey)(ENTITY);\n    await (0,_kv__WEBPACK_IMPORTED_MODULE_0__.kvDel)(key);\n    await (0,_kv__WEBPACK_IMPORTED_MODULE_0__.kvSRem)(indexKey, id);\n}\n\n\n;\n    // Wrapped in an IIFE to avoid polluting the global scope\n    ;\n    (function () {\n        var _a, _b;\n        // Legacy CSS implementations will `eval` browser code in a Node.js context\n        // to extract CSS. For backwards compatibility, we need to check we're in a\n        // browser context before continuing.\n        if (typeof self !== 'undefined' &&\n            // AMP / No-JS mode does not inject these helpers:\n            '$RefreshHelpers$' in self) {\n            // @ts-ignore __webpack_module__ is global\n            var currentExports = module.exports;\n            // @ts-ignore __webpack_module__ is global\n            var prevSignature = (_b = (_a = module.hot.data) === null || _a === void 0 ? void 0 : _a.prevSignature) !== null && _b !== void 0 ? _b : null;\n            // This cannot happen in MainTemplate because the exports mismatch between\n            // templating and execution.\n            self.$RefreshHelpers$.registerExportsForReactRefresh(currentExports, module.id);\n            // A module can be accepted automatically based on its exports, e.g. when\n            // it is a Refresh Boundary.\n            if (self.$RefreshHelpers$.isReactRefreshBoundary(currentExports)) {\n                // Save the previous exports signature on update so we can compare the boundary\n                // signatures. We avoid saving exports themselves since it causes memory leaks (https://github.com/vercel/next.js/pull/53797)\n                module.hot.dispose(function (data) {\n                    data.prevSignature =\n                        self.$RefreshHelpers$.getRefreshBoundarySignature(currentExports);\n                });\n                // Unconditionally accept an update to this module, we'll check if it's\n                // still a Refresh Boundary later.\n                // @ts-ignore importMeta is replaced in the loader\n                module.hot.accept();\n                // This field is set when the previous version of this module was a\n                // Refresh Boundary, letting us know we need to check for invalidation or\n                // enqueue an update.\n                if (prevSignature !== null) {\n                    // A boundary can become ineligible if its exports are incompatible\n                    // with the previous exports.\n                    //\n                    // For example, if you add/remove/change exports, we'll want to\n                    // re-execute the importing modules, and force those components to\n                    // re-render. Similarly, if you convert a class component to a\n                    // function, we want to invalidate the boundary.\n                    if (self.$RefreshHelpers$.shouldInvalidateReactRefreshBoundary(prevSignature, self.$RefreshHelpers$.getRefreshBoundarySignature(currentExports))) {\n                        module.hot.invalidate();\n                    }\n                    else {\n                        self.$RefreshHelpers$.scheduleUpdate();\n                    }\n                }\n            }\n            else {\n                // Since we just executed the code for the module, it's possible that the\n                // new exports made it ineligible for being a boundary.\n                // We only care about the case when we were _previously_ a boundary,\n                // because we already accepted this update (accidental side effect).\n                var isNoLongerABoundary = prevSignature !== null;\n                if (isNoLongerABoundary) {\n                    module.hot.invalidate();\n                }\n            }\n        }\n    })();\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFwcC1wYWdlcy1icm93c2VyKS8uL2RhdGEtc3RvcmUvcmVwb3NpdG9yaWVzL2l0ZW0ucmVwby50cyIsIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7QUFBQSx1Q0FBdUM7QUFDaUM7QUFDbEI7QUFHdEQsTUFBTVEsU0FBUztBQUVSLGVBQWVDO0lBQ3BCLE1BQU1DLFdBQVdILG9EQUFhQSxDQUFDQztJQUMvQixNQUFNRyxNQUFNLE1BQU1OLCtDQUFVQSxDQUFDSztJQUM3QixJQUFJQyxJQUFJQyxNQUFNLEtBQUssR0FBRyxPQUFPLEVBQUU7SUFFL0IsTUFBTUMsUUFBZ0IsRUFBRTtJQUN4QixLQUFLLE1BQU1DLE1BQU1ILElBQUs7UUFDcEIsTUFBTUksTUFBTVQsbURBQVlBLENBQUNFLFFBQVFNO1FBQ2pDLE1BQU1FLE9BQU8sTUFBTWhCLDBDQUFLQSxDQUFPZTtRQUMvQixJQUFJQyxNQUFNSCxNQUFNSSxJQUFJLENBQUNEO0lBQ3ZCO0lBRUEsT0FBT0g7QUFDVDtBQUVPLGVBQWVLLFlBQVlKLEVBQVU7SUFDMUMsTUFBTUMsTUFBTVQsbURBQVlBLENBQUNFLFFBQVFNO0lBQ2pDLE9BQU8sTUFBTWQsMENBQUtBLENBQU9lO0FBQzNCO0FBRU8sZUFBZUksV0FBV0gsSUFBVTtJQUN6QyxNQUFNRCxNQUFNVCxtREFBWUEsQ0FBQ0UsUUFBUVEsS0FBS0YsRUFBRTtJQUN4QyxNQUFNSixXQUFXSCxvREFBYUEsQ0FBQ0M7SUFFL0IsTUFBTVAsMENBQUtBLENBQUNjLEtBQUtDO0lBQ2pCLE1BQU1iLDJDQUFNQSxDQUFDTyxVQUFVTSxLQUFLRixFQUFFO0lBRTlCLE9BQU9FO0FBQ1Q7QUFFTyxlQUFlSSxXQUFXTixFQUFVO0lBQ3pDLE1BQU1DLE1BQU1ULG1EQUFZQSxDQUFDRSxRQUFRTTtJQUNqQyxNQUFNSixXQUFXSCxvREFBYUEsQ0FBQ0M7SUFFL0IsTUFBTU4sMENBQUtBLENBQUNhO0lBQ1osTUFBTVgsMkNBQU1BLENBQUNNLFVBQVVJO0FBQ3pCIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vX05fRS8uL2RhdGEtc3RvcmUvcmVwb3NpdG9yaWVzL2l0ZW0ucmVwby50cz9jNjQ4Il0sInNvdXJjZXNDb250ZW50IjpbIi8vIGRhdGEtc3RvcmUvcmVwb3NpdG9yaWVzL2l0ZW0ucmVwby50c1xyXG5pbXBvcnQgeyBrdkdldCwga3ZTZXQsIGt2RGVsLCBrdlNBZGQsIGt2U1JlbSwga3ZTTWVtYmVycyB9IGZyb20gJy4uL2t2JztcclxuaW1wb3J0IHsgYnVpbGREYXRhS2V5LCBidWlsZEluZGV4S2V5IH0gZnJvbSAnLi4va2V5cyc7XHJcbmltcG9ydCB0eXBlIHsgSXRlbSB9IGZyb20gJ0AvdHlwZXMvZW50aXRpZXMnO1xyXG5cclxuY29uc3QgRU5USVRZID0gJ2l0ZW1zJztcclxuXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBnZXRBbGxJdGVtcygpOiBQcm9taXNlPEl0ZW1bXT4ge1xyXG4gIGNvbnN0IGluZGV4S2V5ID0gYnVpbGRJbmRleEtleShFTlRJVFkpO1xyXG4gIGNvbnN0IGlkcyA9IGF3YWl0IGt2U01lbWJlcnMoaW5kZXhLZXkpO1xyXG4gIGlmIChpZHMubGVuZ3RoID09PSAwKSByZXR1cm4gW107XHJcbiAgXHJcbiAgY29uc3QgaXRlbXM6IEl0ZW1bXSA9IFtdO1xyXG4gIGZvciAoY29uc3QgaWQgb2YgaWRzKSB7XHJcbiAgICBjb25zdCBrZXkgPSBidWlsZERhdGFLZXkoRU5USVRZLCBpZCk7XHJcbiAgICBjb25zdCBpdGVtID0gYXdhaXQga3ZHZXQ8SXRlbT4oa2V5KTtcclxuICAgIGlmIChpdGVtKSBpdGVtcy5wdXNoKGl0ZW0pO1xyXG4gIH1cclxuICBcclxuICByZXR1cm4gaXRlbXM7XHJcbn1cclxuXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBnZXRJdGVtQnlJZChpZDogc3RyaW5nKTogUHJvbWlzZTxJdGVtIHwgbnVsbD4ge1xyXG4gIGNvbnN0IGtleSA9IGJ1aWxkRGF0YUtleShFTlRJVFksIGlkKTtcclxuICByZXR1cm4gYXdhaXQga3ZHZXQ8SXRlbT4oa2V5KTtcclxufVxyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIHVwc2VydEl0ZW0oaXRlbTogSXRlbSk6IFByb21pc2U8SXRlbT4ge1xyXG4gIGNvbnN0IGtleSA9IGJ1aWxkRGF0YUtleShFTlRJVFksIGl0ZW0uaWQpO1xyXG4gIGNvbnN0IGluZGV4S2V5ID0gYnVpbGRJbmRleEtleShFTlRJVFkpO1xyXG4gIFxyXG4gIGF3YWl0IGt2U2V0KGtleSwgaXRlbSk7XHJcbiAgYXdhaXQga3ZTQWRkKGluZGV4S2V5LCBpdGVtLmlkKTtcclxuICBcclxuICByZXR1cm4gaXRlbTtcclxufVxyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGRlbGV0ZUl0ZW0oaWQ6IHN0cmluZyk6IFByb21pc2U8dm9pZD4ge1xyXG4gIGNvbnN0IGtleSA9IGJ1aWxkRGF0YUtleShFTlRJVFksIGlkKTtcclxuICBjb25zdCBpbmRleEtleSA9IGJ1aWxkSW5kZXhLZXkoRU5USVRZKTtcclxuICBcclxuICBhd2FpdCBrdkRlbChrZXkpO1xyXG4gIGF3YWl0IGt2U1JlbShpbmRleEtleSwgaWQpO1xyXG59XHJcbiJdLCJuYW1lcyI6WyJrdkdldCIsImt2U2V0Iiwia3ZEZWwiLCJrdlNBZGQiLCJrdlNSZW0iLCJrdlNNZW1iZXJzIiwiYnVpbGREYXRhS2V5IiwiYnVpbGRJbmRleEtleSIsIkVOVElUWSIsImdldEFsbEl0ZW1zIiwiaW5kZXhLZXkiLCJpZHMiLCJsZW5ndGgiLCJpdGVtcyIsImlkIiwia2V5IiwiaXRlbSIsInB1c2giLCJnZXRJdGVtQnlJZCIsInVwc2VydEl0ZW0iLCJkZWxldGVJdGVtIl0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(app-pages-browser)/./data-store/repositories/item.repo.ts\n"));

/***/ }),

/***/ "(app-pages-browser)/./data-store/repositories/player.repo.ts":
/*!************************************************!*\
  !*** ./data-store/repositories/player.repo.ts ***!
  \************************************************/
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval(__webpack_require__.ts("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   deletePlayer: function() { return /* binding */ deletePlayer; },\n/* harmony export */   getAllPlayers: function() { return /* binding */ getAllPlayers; },\n/* harmony export */   getPlayerById: function() { return /* binding */ getPlayerById; },\n/* harmony export */   upsertPlayer: function() { return /* binding */ upsertPlayer; }\n/* harmony export */ });\n/* harmony import */ var _kv__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../kv */ \"(app-pages-browser)/./data-store/kv.ts\");\n/* harmony import */ var _keys__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../keys */ \"(app-pages-browser)/./data-store/keys.ts\");\n// data-store/repositories/player.repo.ts\n\n\nconst ENTITY = \"players\";\nasync function getAllPlayers() {\n    const indexKey = (0,_keys__WEBPACK_IMPORTED_MODULE_1__.buildIndexKey)(ENTITY);\n    const ids = await (0,_kv__WEBPACK_IMPORTED_MODULE_0__.kvSMembers)(indexKey);\n    if (ids.length === 0) return [];\n    const players = [];\n    for (const id of ids){\n        const key = (0,_keys__WEBPACK_IMPORTED_MODULE_1__.buildDataKey)(ENTITY, id);\n        const player = await (0,_kv__WEBPACK_IMPORTED_MODULE_0__.kvGet)(key);\n        if (player) players.push(player);\n    }\n    return players;\n}\nasync function getPlayerById(id) {\n    const key = (0,_keys__WEBPACK_IMPORTED_MODULE_1__.buildDataKey)(ENTITY, id);\n    return await (0,_kv__WEBPACK_IMPORTED_MODULE_0__.kvGet)(key);\n}\nasync function upsertPlayer(player) {\n    const key = (0,_keys__WEBPACK_IMPORTED_MODULE_1__.buildDataKey)(ENTITY, player.id);\n    const indexKey = (0,_keys__WEBPACK_IMPORTED_MODULE_1__.buildIndexKey)(ENTITY);\n    await (0,_kv__WEBPACK_IMPORTED_MODULE_0__.kvSet)(key, player);\n    await (0,_kv__WEBPACK_IMPORTED_MODULE_0__.kvSAdd)(indexKey, player.id);\n    return player;\n}\nasync function deletePlayer(id) {\n    const key = (0,_keys__WEBPACK_IMPORTED_MODULE_1__.buildDataKey)(ENTITY, id);\n    const indexKey = (0,_keys__WEBPACK_IMPORTED_MODULE_1__.buildIndexKey)(ENTITY);\n    await (0,_kv__WEBPACK_IMPORTED_MODULE_0__.kvDel)(key);\n    await (0,_kv__WEBPACK_IMPORTED_MODULE_0__.kvSRem)(indexKey, id);\n}\n\n\n;\n    // Wrapped in an IIFE to avoid polluting the global scope\n    ;\n    (function () {\n        var _a, _b;\n        // Legacy CSS implementations will `eval` browser code in a Node.js context\n        // to extract CSS. For backwards compatibility, we need to check we're in a\n        // browser context before continuing.\n        if (typeof self !== 'undefined' &&\n            // AMP / No-JS mode does not inject these helpers:\n            '$RefreshHelpers$' in self) {\n            // @ts-ignore __webpack_module__ is global\n            var currentExports = module.exports;\n            // @ts-ignore __webpack_module__ is global\n            var prevSignature = (_b = (_a = module.hot.data) === null || _a === void 0 ? void 0 : _a.prevSignature) !== null && _b !== void 0 ? _b : null;\n            // This cannot happen in MainTemplate because the exports mismatch between\n            // templating and execution.\n            self.$RefreshHelpers$.registerExportsForReactRefresh(currentExports, module.id);\n            // A module can be accepted automatically based on its exports, e.g. when\n            // it is a Refresh Boundary.\n            if (self.$RefreshHelpers$.isReactRefreshBoundary(currentExports)) {\n                // Save the previous exports signature on update so we can compare the boundary\n                // signatures. We avoid saving exports themselves since it causes memory leaks (https://github.com/vercel/next.js/pull/53797)\n                module.hot.dispose(function (data) {\n                    data.prevSignature =\n                        self.$RefreshHelpers$.getRefreshBoundarySignature(currentExports);\n                });\n                // Unconditionally accept an update to this module, we'll check if it's\n                // still a Refresh Boundary later.\n                // @ts-ignore importMeta is replaced in the loader\n                module.hot.accept();\n                // This field is set when the previous version of this module was a\n                // Refresh Boundary, letting us know we need to check for invalidation or\n                // enqueue an update.\n                if (prevSignature !== null) {\n                    // A boundary can become ineligible if its exports are incompatible\n                    // with the previous exports.\n                    //\n                    // For example, if you add/remove/change exports, we'll want to\n                    // re-execute the importing modules, and force those components to\n                    // re-render. Similarly, if you convert a class component to a\n                    // function, we want to invalidate the boundary.\n                    if (self.$RefreshHelpers$.shouldInvalidateReactRefreshBoundary(prevSignature, self.$RefreshHelpers$.getRefreshBoundarySignature(currentExports))) {\n                        module.hot.invalidate();\n                    }\n                    else {\n                        self.$RefreshHelpers$.scheduleUpdate();\n                    }\n                }\n            }\n            else {\n                // Since we just executed the code for the module, it's possible that the\n                // new exports made it ineligible for being a boundary.\n                // We only care about the case when we were _previously_ a boundary,\n                // because we already accepted this update (accidental side effect).\n                var isNoLongerABoundary = prevSignature !== null;\n                if (isNoLongerABoundary) {\n                    module.hot.invalidate();\n                }\n            }\n        }\n    })();\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFwcC1wYWdlcy1icm93c2VyKS8uL2RhdGEtc3RvcmUvcmVwb3NpdG9yaWVzL3BsYXllci5yZXBvLnRzIiwibWFwcGluZ3MiOiI7Ozs7Ozs7OztBQUFBLHlDQUF5QztBQUMrQjtBQUNsQjtBQUd0RCxNQUFNUSxTQUFTO0FBRVIsZUFBZUM7SUFDcEIsTUFBTUMsV0FBV0gsb0RBQWFBLENBQUNDO0lBQy9CLE1BQU1HLE1BQU0sTUFBTU4sK0NBQVVBLENBQUNLO0lBQzdCLElBQUlDLElBQUlDLE1BQU0sS0FBSyxHQUFHLE9BQU8sRUFBRTtJQUUvQixNQUFNQyxVQUFvQixFQUFFO0lBQzVCLEtBQUssTUFBTUMsTUFBTUgsSUFBSztRQUNwQixNQUFNSSxNQUFNVCxtREFBWUEsQ0FBQ0UsUUFBUU07UUFDakMsTUFBTUUsU0FBUyxNQUFNaEIsMENBQUtBLENBQVNlO1FBQ25DLElBQUlDLFFBQVFILFFBQVFJLElBQUksQ0FBQ0Q7SUFDM0I7SUFFQSxPQUFPSDtBQUNUO0FBRU8sZUFBZUssY0FBY0osRUFBVTtJQUM1QyxNQUFNQyxNQUFNVCxtREFBWUEsQ0FBQ0UsUUFBUU07SUFDakMsT0FBTyxNQUFNZCwwQ0FBS0EsQ0FBU2U7QUFDN0I7QUFFTyxlQUFlSSxhQUFhSCxNQUFjO0lBQy9DLE1BQU1ELE1BQU1ULG1EQUFZQSxDQUFDRSxRQUFRUSxPQUFPRixFQUFFO0lBQzFDLE1BQU1KLFdBQVdILG9EQUFhQSxDQUFDQztJQUUvQixNQUFNUCwwQ0FBS0EsQ0FBQ2MsS0FBS0M7SUFDakIsTUFBTWIsMkNBQU1BLENBQUNPLFVBQVVNLE9BQU9GLEVBQUU7SUFFaEMsT0FBT0U7QUFDVDtBQUVPLGVBQWVJLGFBQWFOLEVBQVU7SUFDM0MsTUFBTUMsTUFBTVQsbURBQVlBLENBQUNFLFFBQVFNO0lBQ2pDLE1BQU1KLFdBQVdILG9EQUFhQSxDQUFDQztJQUUvQixNQUFNTiwwQ0FBS0EsQ0FBQ2E7SUFDWixNQUFNWCwyQ0FBTUEsQ0FBQ00sVUFBVUk7QUFDekIiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9fTl9FLy4vZGF0YS1zdG9yZS9yZXBvc2l0b3JpZXMvcGxheWVyLnJlcG8udHM/MGE4OSJdLCJzb3VyY2VzQ29udGVudCI6WyIvLyBkYXRhLXN0b3JlL3JlcG9zaXRvcmllcy9wbGF5ZXIucmVwby50c1xyXG5pbXBvcnQgeyBrdkdldCwga3ZTZXQsIGt2RGVsLCBrdlNBZGQsIGt2U1JlbSwga3ZTTWVtYmVycyB9IGZyb20gJy4uL2t2JztcclxuaW1wb3J0IHsgYnVpbGREYXRhS2V5LCBidWlsZEluZGV4S2V5IH0gZnJvbSAnLi4va2V5cyc7XHJcbmltcG9ydCB0eXBlIHsgUGxheWVyIH0gZnJvbSAnQC90eXBlcy9lbnRpdGllcyc7XHJcblxyXG5jb25zdCBFTlRJVFkgPSAncGxheWVycyc7XHJcblxyXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gZ2V0QWxsUGxheWVycygpOiBQcm9taXNlPFBsYXllcltdPiB7XHJcbiAgY29uc3QgaW5kZXhLZXkgPSBidWlsZEluZGV4S2V5KEVOVElUWSk7XHJcbiAgY29uc3QgaWRzID0gYXdhaXQga3ZTTWVtYmVycyhpbmRleEtleSk7XHJcbiAgaWYgKGlkcy5sZW5ndGggPT09IDApIHJldHVybiBbXTtcclxuICBcclxuICBjb25zdCBwbGF5ZXJzOiBQbGF5ZXJbXSA9IFtdO1xyXG4gIGZvciAoY29uc3QgaWQgb2YgaWRzKSB7XHJcbiAgICBjb25zdCBrZXkgPSBidWlsZERhdGFLZXkoRU5USVRZLCBpZCk7XHJcbiAgICBjb25zdCBwbGF5ZXIgPSBhd2FpdCBrdkdldDxQbGF5ZXI+KGtleSk7XHJcbiAgICBpZiAocGxheWVyKSBwbGF5ZXJzLnB1c2gocGxheWVyKTtcclxuICB9XHJcbiAgXHJcbiAgcmV0dXJuIHBsYXllcnM7XHJcbn1cclxuXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBnZXRQbGF5ZXJCeUlkKGlkOiBzdHJpbmcpOiBQcm9taXNlPFBsYXllciB8IG51bGw+IHtcclxuICBjb25zdCBrZXkgPSBidWlsZERhdGFLZXkoRU5USVRZLCBpZCk7XHJcbiAgcmV0dXJuIGF3YWl0IGt2R2V0PFBsYXllcj4oa2V5KTtcclxufVxyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIHVwc2VydFBsYXllcihwbGF5ZXI6IFBsYXllcik6IFByb21pc2U8UGxheWVyPiB7XHJcbiAgY29uc3Qga2V5ID0gYnVpbGREYXRhS2V5KEVOVElUWSwgcGxheWVyLmlkKTtcclxuICBjb25zdCBpbmRleEtleSA9IGJ1aWxkSW5kZXhLZXkoRU5USVRZKTtcclxuICBcclxuICBhd2FpdCBrdlNldChrZXksIHBsYXllcik7XHJcbiAgYXdhaXQga3ZTQWRkKGluZGV4S2V5LCBwbGF5ZXIuaWQpO1xyXG4gIFxyXG4gIHJldHVybiBwbGF5ZXI7XHJcbn1cclxuXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBkZWxldGVQbGF5ZXIoaWQ6IHN0cmluZyk6IFByb21pc2U8dm9pZD4ge1xyXG4gIGNvbnN0IGtleSA9IGJ1aWxkRGF0YUtleShFTlRJVFksIGlkKTtcclxuICBjb25zdCBpbmRleEtleSA9IGJ1aWxkSW5kZXhLZXkoRU5USVRZKTtcclxuICBcclxuICBhd2FpdCBrdkRlbChrZXkpO1xyXG4gIGF3YWl0IGt2U1JlbShpbmRleEtleSwgaWQpO1xyXG59XHJcbiJdLCJuYW1lcyI6WyJrdkdldCIsImt2U2V0Iiwia3ZEZWwiLCJrdlNBZGQiLCJrdlNSZW0iLCJrdlNNZW1iZXJzIiwiYnVpbGREYXRhS2V5IiwiYnVpbGRJbmRleEtleSIsIkVOVElUWSIsImdldEFsbFBsYXllcnMiLCJpbmRleEtleSIsImlkcyIsImxlbmd0aCIsInBsYXllcnMiLCJpZCIsImtleSIsInBsYXllciIsInB1c2giLCJnZXRQbGF5ZXJCeUlkIiwidXBzZXJ0UGxheWVyIiwiZGVsZXRlUGxheWVyIl0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(app-pages-browser)/./data-store/repositories/player.repo.ts\n"));

/***/ }),

/***/ "(app-pages-browser)/./data-store/repositories/sale.repo.ts":
/*!**********************************************!*\
  !*** ./data-store/repositories/sale.repo.ts ***!
  \**********************************************/
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval(__webpack_require__.ts("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   deleteSale: function() { return /* binding */ deleteSale; },\n/* harmony export */   getAllSales: function() { return /* binding */ getAllSales; },\n/* harmony export */   getSaleById: function() { return /* binding */ getSaleById; },\n/* harmony export */   upsertSale: function() { return /* binding */ upsertSale; }\n/* harmony export */ });\n/* harmony import */ var _kv__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../kv */ \"(app-pages-browser)/./data-store/kv.ts\");\n/* harmony import */ var _keys__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../keys */ \"(app-pages-browser)/./data-store/keys.ts\");\n// data-store/repositories/sale.repo.ts\n\n\nconst ENTITY = \"sales\";\nasync function getAllSales() {\n    const indexKey = (0,_keys__WEBPACK_IMPORTED_MODULE_1__.buildIndexKey)(ENTITY);\n    const ids = await (0,_kv__WEBPACK_IMPORTED_MODULE_0__.kvSMembers)(indexKey);\n    if (ids.length === 0) return [];\n    const sales = [];\n    for (const id of ids){\n        const key = (0,_keys__WEBPACK_IMPORTED_MODULE_1__.buildDataKey)(ENTITY, id);\n        const sale = await (0,_kv__WEBPACK_IMPORTED_MODULE_0__.kvGet)(key);\n        if (sale) sales.push(sale);\n    }\n    return sales;\n}\nasync function getSaleById(id) {\n    const key = (0,_keys__WEBPACK_IMPORTED_MODULE_1__.buildDataKey)(ENTITY, id);\n    return await (0,_kv__WEBPACK_IMPORTED_MODULE_0__.kvGet)(key);\n}\nasync function upsertSale(sale) {\n    const key = (0,_keys__WEBPACK_IMPORTED_MODULE_1__.buildDataKey)(ENTITY, sale.id);\n    const indexKey = (0,_keys__WEBPACK_IMPORTED_MODULE_1__.buildIndexKey)(ENTITY);\n    await (0,_kv__WEBPACK_IMPORTED_MODULE_0__.kvSet)(key, sale);\n    await (0,_kv__WEBPACK_IMPORTED_MODULE_0__.kvSAdd)(indexKey, sale.id);\n    return sale;\n}\nasync function deleteSale(id) {\n    const key = (0,_keys__WEBPACK_IMPORTED_MODULE_1__.buildDataKey)(ENTITY, id);\n    const indexKey = (0,_keys__WEBPACK_IMPORTED_MODULE_1__.buildIndexKey)(ENTITY);\n    await (0,_kv__WEBPACK_IMPORTED_MODULE_0__.kvDel)(key);\n    await (0,_kv__WEBPACK_IMPORTED_MODULE_0__.kvSRem)(indexKey, id);\n}\n\n\n;\n    // Wrapped in an IIFE to avoid polluting the global scope\n    ;\n    (function () {\n        var _a, _b;\n        // Legacy CSS implementations will `eval` browser code in a Node.js context\n        // to extract CSS. For backwards compatibility, we need to check we're in a\n        // browser context before continuing.\n        if (typeof self !== 'undefined' &&\n            // AMP / No-JS mode does not inject these helpers:\n            '$RefreshHelpers$' in self) {\n            // @ts-ignore __webpack_module__ is global\n            var currentExports = module.exports;\n            // @ts-ignore __webpack_module__ is global\n            var prevSignature = (_b = (_a = module.hot.data) === null || _a === void 0 ? void 0 : _a.prevSignature) !== null && _b !== void 0 ? _b : null;\n            // This cannot happen in MainTemplate because the exports mismatch between\n            // templating and execution.\n            self.$RefreshHelpers$.registerExportsForReactRefresh(currentExports, module.id);\n            // A module can be accepted automatically based on its exports, e.g. when\n            // it is a Refresh Boundary.\n            if (self.$RefreshHelpers$.isReactRefreshBoundary(currentExports)) {\n                // Save the previous exports signature on update so we can compare the boundary\n                // signatures. We avoid saving exports themselves since it causes memory leaks (https://github.com/vercel/next.js/pull/53797)\n                module.hot.dispose(function (data) {\n                    data.prevSignature =\n                        self.$RefreshHelpers$.getRefreshBoundarySignature(currentExports);\n                });\n                // Unconditionally accept an update to this module, we'll check if it's\n                // still a Refresh Boundary later.\n                // @ts-ignore importMeta is replaced in the loader\n                module.hot.accept();\n                // This field is set when the previous version of this module was a\n                // Refresh Boundary, letting us know we need to check for invalidation or\n                // enqueue an update.\n                if (prevSignature !== null) {\n                    // A boundary can become ineligible if its exports are incompatible\n                    // with the previous exports.\n                    //\n                    // For example, if you add/remove/change exports, we'll want to\n                    // re-execute the importing modules, and force those components to\n                    // re-render. Similarly, if you convert a class component to a\n                    // function, we want to invalidate the boundary.\n                    if (self.$RefreshHelpers$.shouldInvalidateReactRefreshBoundary(prevSignature, self.$RefreshHelpers$.getRefreshBoundarySignature(currentExports))) {\n                        module.hot.invalidate();\n                    }\n                    else {\n                        self.$RefreshHelpers$.scheduleUpdate();\n                    }\n                }\n            }\n            else {\n                // Since we just executed the code for the module, it's possible that the\n                // new exports made it ineligible for being a boundary.\n                // We only care about the case when we were _previously_ a boundary,\n                // because we already accepted this update (accidental side effect).\n                var isNoLongerABoundary = prevSignature !== null;\n                if (isNoLongerABoundary) {\n                    module.hot.invalidate();\n                }\n            }\n        }\n    })();\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFwcC1wYWdlcy1icm93c2VyKS8uL2RhdGEtc3RvcmUvcmVwb3NpdG9yaWVzL3NhbGUucmVwby50cyIsIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7QUFBQSx1Q0FBdUM7QUFDaUM7QUFDbEI7QUFHdEQsTUFBTVEsU0FBUztBQUVSLGVBQWVDO0lBQ3BCLE1BQU1DLFdBQVdILG9EQUFhQSxDQUFDQztJQUMvQixNQUFNRyxNQUFNLE1BQU1OLCtDQUFVQSxDQUFDSztJQUM3QixJQUFJQyxJQUFJQyxNQUFNLEtBQUssR0FBRyxPQUFPLEVBQUU7SUFFL0IsTUFBTUMsUUFBZ0IsRUFBRTtJQUN4QixLQUFLLE1BQU1DLE1BQU1ILElBQUs7UUFDcEIsTUFBTUksTUFBTVQsbURBQVlBLENBQUNFLFFBQVFNO1FBQ2pDLE1BQU1FLE9BQU8sTUFBTWhCLDBDQUFLQSxDQUFPZTtRQUMvQixJQUFJQyxNQUFNSCxNQUFNSSxJQUFJLENBQUNEO0lBQ3ZCO0lBRUEsT0FBT0g7QUFDVDtBQUVPLGVBQWVLLFlBQVlKLEVBQVU7SUFDMUMsTUFBTUMsTUFBTVQsbURBQVlBLENBQUNFLFFBQVFNO0lBQ2pDLE9BQU8sTUFBTWQsMENBQUtBLENBQU9lO0FBQzNCO0FBRU8sZUFBZUksV0FBV0gsSUFBVTtJQUN6QyxNQUFNRCxNQUFNVCxtREFBWUEsQ0FBQ0UsUUFBUVEsS0FBS0YsRUFBRTtJQUN4QyxNQUFNSixXQUFXSCxvREFBYUEsQ0FBQ0M7SUFFL0IsTUFBTVAsMENBQUtBLENBQUNjLEtBQUtDO0lBQ2pCLE1BQU1iLDJDQUFNQSxDQUFDTyxVQUFVTSxLQUFLRixFQUFFO0lBRTlCLE9BQU9FO0FBQ1Q7QUFFTyxlQUFlSSxXQUFXTixFQUFVO0lBQ3pDLE1BQU1DLE1BQU1ULG1EQUFZQSxDQUFDRSxRQUFRTTtJQUNqQyxNQUFNSixXQUFXSCxvREFBYUEsQ0FBQ0M7SUFFL0IsTUFBTU4sMENBQUtBLENBQUNhO0lBQ1osTUFBTVgsMkNBQU1BLENBQUNNLFVBQVVJO0FBQ3pCIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vX05fRS8uL2RhdGEtc3RvcmUvcmVwb3NpdG9yaWVzL3NhbGUucmVwby50cz80OTNhIl0sInNvdXJjZXNDb250ZW50IjpbIi8vIGRhdGEtc3RvcmUvcmVwb3NpdG9yaWVzL3NhbGUucmVwby50c1xyXG5pbXBvcnQgeyBrdkdldCwga3ZTZXQsIGt2RGVsLCBrdlNBZGQsIGt2U1JlbSwga3ZTTWVtYmVycyB9IGZyb20gJy4uL2t2JztcclxuaW1wb3J0IHsgYnVpbGREYXRhS2V5LCBidWlsZEluZGV4S2V5IH0gZnJvbSAnLi4va2V5cyc7XHJcbmltcG9ydCB0eXBlIHsgU2FsZSB9IGZyb20gJ0AvdHlwZXMvZW50aXRpZXMnO1xyXG5cclxuY29uc3QgRU5USVRZID0gJ3NhbGVzJztcclxuXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBnZXRBbGxTYWxlcygpOiBQcm9taXNlPFNhbGVbXT4ge1xyXG4gIGNvbnN0IGluZGV4S2V5ID0gYnVpbGRJbmRleEtleShFTlRJVFkpO1xyXG4gIGNvbnN0IGlkcyA9IGF3YWl0IGt2U01lbWJlcnMoaW5kZXhLZXkpO1xyXG4gIGlmIChpZHMubGVuZ3RoID09PSAwKSByZXR1cm4gW107XHJcbiAgXHJcbiAgY29uc3Qgc2FsZXM6IFNhbGVbXSA9IFtdO1xyXG4gIGZvciAoY29uc3QgaWQgb2YgaWRzKSB7XHJcbiAgICBjb25zdCBrZXkgPSBidWlsZERhdGFLZXkoRU5USVRZLCBpZCk7XHJcbiAgICBjb25zdCBzYWxlID0gYXdhaXQga3ZHZXQ8U2FsZT4oa2V5KTtcclxuICAgIGlmIChzYWxlKSBzYWxlcy5wdXNoKHNhbGUpO1xyXG4gIH1cclxuICBcclxuICByZXR1cm4gc2FsZXM7XHJcbn1cclxuXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBnZXRTYWxlQnlJZChpZDogc3RyaW5nKTogUHJvbWlzZTxTYWxlIHwgbnVsbD4ge1xyXG4gIGNvbnN0IGtleSA9IGJ1aWxkRGF0YUtleShFTlRJVFksIGlkKTtcclxuICByZXR1cm4gYXdhaXQga3ZHZXQ8U2FsZT4oa2V5KTtcclxufVxyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIHVwc2VydFNhbGUoc2FsZTogU2FsZSk6IFByb21pc2U8U2FsZT4ge1xyXG4gIGNvbnN0IGtleSA9IGJ1aWxkRGF0YUtleShFTlRJVFksIHNhbGUuaWQpO1xyXG4gIGNvbnN0IGluZGV4S2V5ID0gYnVpbGRJbmRleEtleShFTlRJVFkpO1xyXG4gIFxyXG4gIGF3YWl0IGt2U2V0KGtleSwgc2FsZSk7XHJcbiAgYXdhaXQga3ZTQWRkKGluZGV4S2V5LCBzYWxlLmlkKTtcclxuICBcclxuICByZXR1cm4gc2FsZTtcclxufVxyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGRlbGV0ZVNhbGUoaWQ6IHN0cmluZyk6IFByb21pc2U8dm9pZD4ge1xyXG4gIGNvbnN0IGtleSA9IGJ1aWxkRGF0YUtleShFTlRJVFksIGlkKTtcclxuICBjb25zdCBpbmRleEtleSA9IGJ1aWxkSW5kZXhLZXkoRU5USVRZKTtcclxuICBcclxuICBhd2FpdCBrdkRlbChrZXkpO1xyXG4gIGF3YWl0IGt2U1JlbShpbmRleEtleSwgaWQpO1xyXG59XHJcbiJdLCJuYW1lcyI6WyJrdkdldCIsImt2U2V0Iiwia3ZEZWwiLCJrdlNBZGQiLCJrdlNSZW0iLCJrdlNNZW1iZXJzIiwiYnVpbGREYXRhS2V5IiwiYnVpbGRJbmRleEtleSIsIkVOVElUWSIsImdldEFsbFNhbGVzIiwiaW5kZXhLZXkiLCJpZHMiLCJsZW5ndGgiLCJzYWxlcyIsImlkIiwia2V5Iiwic2FsZSIsInB1c2giLCJnZXRTYWxlQnlJZCIsInVwc2VydFNhbGUiLCJkZWxldGVTYWxlIl0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(app-pages-browser)/./data-store/repositories/sale.repo.ts\n"));

/***/ }),

/***/ "(app-pages-browser)/./data-store/repositories/site.repo.ts":
/*!**********************************************!*\
  !*** ./data-store/repositories/site.repo.ts ***!
  \**********************************************/
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval(__webpack_require__.ts("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   deleteSite: function() { return /* binding */ deleteSite; },\n/* harmony export */   getAllSettlements: function() { return /* binding */ getAllSettlements; },\n/* harmony export */   getAllSites: function() { return /* binding */ getAllSites; },\n/* harmony export */   getSettlementById: function() { return /* binding */ getSettlementById; },\n/* harmony export */   getSiteById: function() { return /* binding */ getSiteById; },\n/* harmony export */   getSitesByRadius: function() { return /* binding */ getSitesByRadius; },\n/* harmony export */   getSitesBySettlement: function() { return /* binding */ getSitesBySettlement; },\n/* harmony export */   removeSettlement: function() { return /* binding */ removeSettlement; },\n/* harmony export */   upsertSettlement: function() { return /* binding */ upsertSettlement; },\n/* harmony export */   upsertSite: function() { return /* binding */ upsertSite; }\n/* harmony export */ });\n/* harmony import */ var _kv__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../kv */ \"(app-pages-browser)/./data-store/kv.ts\");\n/* harmony import */ var _keys__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../keys */ \"(app-pages-browser)/./data-store/keys.ts\");\n// data-store/repositories/site.repo.ts\n\n\nconst ENTITY = \"sites\";\nconst SETTLEMENTS_ENTITY = \"settlements\";\nasync function getAllSites() {\n    const indexKey = (0,_keys__WEBPACK_IMPORTED_MODULE_1__.buildIndexKey)(ENTITY);\n    const ids = await (0,_kv__WEBPACK_IMPORTED_MODULE_0__.kvSMembers)(indexKey);\n    if (ids.length === 0) return [];\n    const keys = ids.map((id)=>(0,_keys__WEBPACK_IMPORTED_MODULE_1__.buildDataKey)(ENTITY, id));\n    const sites = await (0,_kv__WEBPACK_IMPORTED_MODULE_0__.kvMGet)(keys);\n    return sites.filter((site)=>site !== null);\n}\nasync function getSiteById(id) {\n    const key = (0,_keys__WEBPACK_IMPORTED_MODULE_1__.buildDataKey)(ENTITY, id);\n    return await (0,_kv__WEBPACK_IMPORTED_MODULE_0__.kvGet)(key);\n}\nasync function upsertSite(site) {\n    const key = (0,_keys__WEBPACK_IMPORTED_MODULE_1__.buildDataKey)(ENTITY, site.id);\n    const indexKey = (0,_keys__WEBPACK_IMPORTED_MODULE_1__.buildIndexKey)(ENTITY);\n    await (0,_kv__WEBPACK_IMPORTED_MODULE_0__.kvSet)(key, site);\n    await (0,_kv__WEBPACK_IMPORTED_MODULE_0__.kvSAdd)(indexKey, site.id);\n    return site;\n}\nasync function deleteSite(id) {\n    const key = (0,_keys__WEBPACK_IMPORTED_MODULE_1__.buildDataKey)(ENTITY, id);\n    const indexKey = (0,_keys__WEBPACK_IMPORTED_MODULE_1__.buildIndexKey)(ENTITY);\n    await (0,_kv__WEBPACK_IMPORTED_MODULE_0__.kvDel)(key);\n    await (0,_kv__WEBPACK_IMPORTED_MODULE_0__.kvSRem)(indexKey, id);\n}\n// ============================================================================\n// SETTLEMENT METHODS (Reference data for Sites)\n// ============================================================================\nasync function getAllSettlements() {\n    const indexKey = (0,_keys__WEBPACK_IMPORTED_MODULE_1__.buildIndexKey)(SETTLEMENTS_ENTITY);\n    const ids = await (0,_kv__WEBPACK_IMPORTED_MODULE_0__.kvSMembers)(indexKey);\n    if (ids.length === 0) return [];\n    const keys = ids.map((id)=>(0,_keys__WEBPACK_IMPORTED_MODULE_1__.buildDataKey)(SETTLEMENTS_ENTITY, id));\n    const settlements = await (0,_kv__WEBPACK_IMPORTED_MODULE_0__.kvMGet)(keys);\n    return settlements.filter((settlement)=>settlement !== null);\n}\nasync function getSettlementById(id) {\n    const key = (0,_keys__WEBPACK_IMPORTED_MODULE_1__.buildDataKey)(SETTLEMENTS_ENTITY, id);\n    return await (0,_kv__WEBPACK_IMPORTED_MODULE_0__.kvGet)(key);\n}\nasync function upsertSettlement(settlement) {\n    const key = (0,_keys__WEBPACK_IMPORTED_MODULE_1__.buildDataKey)(SETTLEMENTS_ENTITY, settlement.id);\n    const indexKey = (0,_keys__WEBPACK_IMPORTED_MODULE_1__.buildIndexKey)(SETTLEMENTS_ENTITY);\n    await (0,_kv__WEBPACK_IMPORTED_MODULE_0__.kvSet)(key, settlement);\n    await (0,_kv__WEBPACK_IMPORTED_MODULE_0__.kvSAdd)(indexKey, settlement.id);\n    return settlement;\n}\nasync function removeSettlement(id) {\n    const key = (0,_keys__WEBPACK_IMPORTED_MODULE_1__.buildDataKey)(SETTLEMENTS_ENTITY, id);\n    const indexKey = (0,_keys__WEBPACK_IMPORTED_MODULE_1__.buildIndexKey)(SETTLEMENTS_ENTITY);\n    await (0,_kv__WEBPACK_IMPORTED_MODULE_0__.kvDel)(key);\n    await (0,_kv__WEBPACK_IMPORTED_MODULE_0__.kvSRem)(indexKey, id);\n}\n// ============================================================================\n// SITE QUERY METHODS\n// ============================================================================\nasync function getSitesBySettlement(settlementId) {\n    const allSites = await getAllSites();\n    return allSites.filter((site)=>{\n        if (site.metadata.type !== \"PHYSICAL\") return false;\n        const physicalMeta = site.metadata;\n        return physicalMeta.settlementId === settlementId;\n    });\n}\nasync function getSitesByRadius(centerLat, centerLng, radiusMeters) {\n    const allSites = await getAllSites();\n    const settlementsMap = new Map();\n    // Load all settlements with coordinates\n    const settlements = await getAllSettlements();\n    settlements.forEach((s)=>{\n        if (s.coordinates) settlementsMap.set(s.id, s);\n    });\n    return allSites.filter((site)=>{\n        if (site.metadata.type !== \"PHYSICAL\") return false;\n        const physicalMeta = site.metadata;\n        const settlement = settlementsMap.get(physicalMeta.settlementId);\n        if (!(settlement === null || settlement === void 0 ? void 0 : settlement.coordinates)) return false;\n        // Haversine formula for distance calculation\n        const R = 6371000; // Earth radius in meters\n        const 1 = centerLat * Math.PI / 180;\n        const 2 = settlement.coordinates.lat * Math.PI / 180;\n        const  = (settlement.coordinates.lat - centerLat) * Math.PI / 180;\n        const  = (settlement.coordinates.lng - centerLng) * Math.PI / 180;\n        const a = Math.sin( / 2) * Math.sin( / 2) + Math.cos(1) * Math.cos(2) * Math.sin( / 2) * Math.sin( / 2);\n        const c = 2 * Math.atan2(Math.sqrt(a), Math.sqrt(1 - a));\n        const distance = R * c;\n        return distance <= radiusMeters;\n    });\n}\n\n\n;\n    // Wrapped in an IIFE to avoid polluting the global scope\n    ;\n    (function () {\n        var _a, _b;\n        // Legacy CSS implementations will `eval` browser code in a Node.js context\n        // to extract CSS. For backwards compatibility, we need to check we're in a\n        // browser context before continuing.\n        if (typeof self !== 'undefined' &&\n            // AMP / No-JS mode does not inject these helpers:\n            '$RefreshHelpers$' in self) {\n            // @ts-ignore __webpack_module__ is global\n            var currentExports = module.exports;\n            // @ts-ignore __webpack_module__ is global\n            var prevSignature = (_b = (_a = module.hot.data) === null || _a === void 0 ? void 0 : _a.prevSignature) !== null && _b !== void 0 ? _b : null;\n            // This cannot happen in MainTemplate because the exports mismatch between\n            // templating and execution.\n            self.$RefreshHelpers$.registerExportsForReactRefresh(currentExports, module.id);\n            // A module can be accepted automatically based on its exports, e.g. when\n            // it is a Refresh Boundary.\n            if (self.$RefreshHelpers$.isReactRefreshBoundary(currentExports)) {\n                // Save the previous exports signature on update so we can compare the boundary\n                // signatures. We avoid saving exports themselves since it causes memory leaks (https://github.com/vercel/next.js/pull/53797)\n                module.hot.dispose(function (data) {\n                    data.prevSignature =\n                        self.$RefreshHelpers$.getRefreshBoundarySignature(currentExports);\n                });\n                // Unconditionally accept an update to this module, we'll check if it's\n                // still a Refresh Boundary later.\n                // @ts-ignore importMeta is replaced in the loader\n                module.hot.accept();\n                // This field is set when the previous version of this module was a\n                // Refresh Boundary, letting us know we need to check for invalidation or\n                // enqueue an update.\n                if (prevSignature !== null) {\n                    // A boundary can become ineligible if its exports are incompatible\n                    // with the previous exports.\n                    //\n                    // For example, if you add/remove/change exports, we'll want to\n                    // re-execute the importing modules, and force those components to\n                    // re-render. Similarly, if you convert a class component to a\n                    // function, we want to invalidate the boundary.\n                    if (self.$RefreshHelpers$.shouldInvalidateReactRefreshBoundary(prevSignature, self.$RefreshHelpers$.getRefreshBoundarySignature(currentExports))) {\n                        module.hot.invalidate();\n                    }\n                    else {\n                        self.$RefreshHelpers$.scheduleUpdate();\n                    }\n                }\n            }\n            else {\n                // Since we just executed the code for the module, it's possible that the\n                // new exports made it ineligible for being a boundary.\n                // We only care about the case when we were _previously_ a boundary,\n                // because we already accepted this update (accidental side effect).\n                var isNoLongerABoundary = prevSignature !== null;\n                if (isNoLongerABoundary) {\n                    module.hot.invalidate();\n                }\n            }\n        }\n    })();\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFwcC1wYWdlcy1icm93c2VyKS8uL2RhdGEtc3RvcmUvcmVwb3NpdG9yaWVzL3NpdGUucmVwby50cyIsIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7Ozs7QUFBQSx1Q0FBdUM7QUFDeUM7QUFDMUI7QUFHdEQsTUFBTVMsU0FBUztBQUNmLE1BQU1DLHFCQUFxQjtBQUVwQixlQUFlQztJQUNwQixNQUFNQyxXQUFXSixvREFBYUEsQ0FBQ0M7SUFDL0IsTUFBTUksTUFBTSxNQUFNUCwrQ0FBVUEsQ0FBQ007SUFDN0IsSUFBSUMsSUFBSUMsTUFBTSxLQUFLLEdBQUcsT0FBTyxFQUFFO0lBRS9CLE1BQU1DLE9BQU9GLElBQUlHLEdBQUcsQ0FBQ0MsQ0FBQUEsS0FBTVYsbURBQVlBLENBQUNFLFFBQVFRO0lBQ2hELE1BQU1DLFFBQVEsTUFBTWpCLDJDQUFNQSxDQUFPYztJQUNqQyxPQUFPRyxNQUFNQyxNQUFNLENBQUMsQ0FBQ0MsT0FBdUJBLFNBQVM7QUFDdkQ7QUFFTyxlQUFlQyxZQUFZSixFQUFVO0lBQzFDLE1BQU1LLE1BQU1mLG1EQUFZQSxDQUFDRSxRQUFRUTtJQUNqQyxPQUFPLE1BQU1qQiwwQ0FBS0EsQ0FBT3NCO0FBQzNCO0FBRU8sZUFBZUMsV0FBV0gsSUFBVTtJQUN6QyxNQUFNRSxNQUFNZixtREFBWUEsQ0FBQ0UsUUFBUVcsS0FBS0gsRUFBRTtJQUN4QyxNQUFNTCxXQUFXSixvREFBYUEsQ0FBQ0M7SUFFL0IsTUFBTVAsMENBQUtBLENBQUNvQixLQUFLRjtJQUNqQixNQUFNaEIsMkNBQU1BLENBQUNRLFVBQVVRLEtBQUtILEVBQUU7SUFFOUIsT0FBT0c7QUFDVDtBQUVPLGVBQWVJLFdBQVdQLEVBQVU7SUFDekMsTUFBTUssTUFBTWYsbURBQVlBLENBQUNFLFFBQVFRO0lBQ2pDLE1BQU1MLFdBQVdKLG9EQUFhQSxDQUFDQztJQUUvQixNQUFNTiwwQ0FBS0EsQ0FBQ21CO0lBQ1osTUFBTWpCLDJDQUFNQSxDQUFDTyxVQUFVSztBQUN6QjtBQUVBLCtFQUErRTtBQUMvRSxnREFBZ0Q7QUFDaEQsK0VBQStFO0FBRXhFLGVBQWVRO0lBQ3BCLE1BQU1iLFdBQVdKLG9EQUFhQSxDQUFDRTtJQUMvQixNQUFNRyxNQUFNLE1BQU1QLCtDQUFVQSxDQUFDTTtJQUM3QixJQUFJQyxJQUFJQyxNQUFNLEtBQUssR0FBRyxPQUFPLEVBQUU7SUFFL0IsTUFBTUMsT0FBT0YsSUFBSUcsR0FBRyxDQUFDQyxDQUFBQSxLQUFNVixtREFBWUEsQ0FBQ0csb0JBQW9CTztJQUM1RCxNQUFNUyxjQUFjLE1BQU16QiwyQ0FBTUEsQ0FBYWM7SUFDN0MsT0FBT1csWUFBWVAsTUFBTSxDQUFDLENBQUNRLGFBQXlDQSxlQUFlO0FBQ3JGO0FBRU8sZUFBZUMsa0JBQWtCWCxFQUFVO0lBQ2hELE1BQU1LLE1BQU1mLG1EQUFZQSxDQUFDRyxvQkFBb0JPO0lBQzdDLE9BQU8sTUFBTWpCLDBDQUFLQSxDQUFhc0I7QUFDakM7QUFFTyxlQUFlTyxpQkFBaUJGLFVBQXNCO0lBQzNELE1BQU1MLE1BQU1mLG1EQUFZQSxDQUFDRyxvQkFBb0JpQixXQUFXVixFQUFFO0lBQzFELE1BQU1MLFdBQVdKLG9EQUFhQSxDQUFDRTtJQUUvQixNQUFNUiwwQ0FBS0EsQ0FBQ29CLEtBQUtLO0lBQ2pCLE1BQU12QiwyQ0FBTUEsQ0FBQ1EsVUFBVWUsV0FBV1YsRUFBRTtJQUVwQyxPQUFPVTtBQUNUO0FBRU8sZUFBZUcsaUJBQWlCYixFQUFVO0lBQy9DLE1BQU1LLE1BQU1mLG1EQUFZQSxDQUFDRyxvQkFBb0JPO0lBQzdDLE1BQU1MLFdBQVdKLG9EQUFhQSxDQUFDRTtJQUUvQixNQUFNUCwwQ0FBS0EsQ0FBQ21CO0lBQ1osTUFBTWpCLDJDQUFNQSxDQUFDTyxVQUFVSztBQUN6QjtBQUVBLCtFQUErRTtBQUMvRSxxQkFBcUI7QUFDckIsK0VBQStFO0FBRXhFLGVBQWVjLHFCQUFxQkMsWUFBb0I7SUFDN0QsTUFBTUMsV0FBVyxNQUFNdEI7SUFDdkIsT0FBT3NCLFNBQVNkLE1BQU0sQ0FBQ0MsQ0FBQUE7UUFDckIsSUFBSUEsS0FBS2MsUUFBUSxDQUFDQyxJQUFJLEtBQUssWUFBWSxPQUFPO1FBQzlDLE1BQU1DLGVBQWVoQixLQUFLYyxRQUFRO1FBQ2xDLE9BQU9FLGFBQWFKLFlBQVksS0FBS0E7SUFDdkM7QUFDRjtBQUVPLGVBQWVLLGlCQUNwQkMsU0FBaUIsRUFDakJDLFNBQWlCLEVBQ2pCQyxZQUFvQjtJQUVwQixNQUFNUCxXQUFXLE1BQU10QjtJQUN2QixNQUFNOEIsaUJBQWlCLElBQUlDO0lBRTNCLHdDQUF3QztJQUN4QyxNQUFNaEIsY0FBYyxNQUFNRDtJQUMxQkMsWUFBWWlCLE9BQU8sQ0FBQ0MsQ0FBQUE7UUFDbEIsSUFBSUEsRUFBRUMsV0FBVyxFQUFFSixlQUFlSyxHQUFHLENBQUNGLEVBQUUzQixFQUFFLEVBQUUyQjtJQUM5QztJQUVBLE9BQU9YLFNBQVNkLE1BQU0sQ0FBQ0MsQ0FBQUE7UUFDckIsSUFBSUEsS0FBS2MsUUFBUSxDQUFDQyxJQUFJLEtBQUssWUFBWSxPQUFPO1FBQzlDLE1BQU1DLGVBQWVoQixLQUFLYyxRQUFRO1FBQ2xDLE1BQU1QLGFBQWFjLGVBQWVNLEdBQUcsQ0FBQ1gsYUFBYUosWUFBWTtRQUUvRCxJQUFJLEVBQUNMLHVCQUFBQSxpQ0FBQUEsV0FBWWtCLFdBQVcsR0FBRSxPQUFPO1FBRXJDLDZDQUE2QztRQUM3QyxNQUFNRyxJQUFJLFNBQVMseUJBQXlCO1FBQzVDLE1BQU1DLEtBQUtYLFlBQVlZLEtBQUtDLEVBQUUsR0FBRztRQUNqQyxNQUFNQyxLQUFLekIsV0FBV2tCLFdBQVcsQ0FBQ1EsR0FBRyxHQUFHSCxLQUFLQyxFQUFFLEdBQUc7UUFDbEQsTUFBTUcsS0FBSyxDQUFDM0IsV0FBV2tCLFdBQVcsQ0FBQ1EsR0FBRyxHQUFHZixTQUFRLElBQUtZLEtBQUtDLEVBQUUsR0FBRztRQUNoRSxNQUFNSSxLQUFLLENBQUM1QixXQUFXa0IsV0FBVyxDQUFDVyxHQUFHLEdBQUdqQixTQUFRLElBQUtXLEtBQUtDLEVBQUUsR0FBRztRQUVoRSxNQUFNTSxJQUFJUCxLQUFLUSxHQUFHLENBQUNKLEtBQUcsS0FBS0osS0FBS1EsR0FBRyxDQUFDSixLQUFHLEtBQzdCSixLQUFLUyxHQUFHLENBQUNWLE1BQU1DLEtBQUtTLEdBQUcsQ0FBQ1AsTUFDeEJGLEtBQUtRLEdBQUcsQ0FBQ0gsS0FBRyxLQUFLTCxLQUFLUSxHQUFHLENBQUNILEtBQUc7UUFDdkMsTUFBTUssSUFBSSxJQUFJVixLQUFLVyxLQUFLLENBQUNYLEtBQUtZLElBQUksQ0FBQ0wsSUFBSVAsS0FBS1ksSUFBSSxDQUFDLElBQUVMO1FBQ25ELE1BQU1NLFdBQVdmLElBQUlZO1FBRXJCLE9BQU9HLFlBQVl2QjtJQUNyQjtBQUNGIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vX05fRS8uL2RhdGEtc3RvcmUvcmVwb3NpdG9yaWVzL3NpdGUucmVwby50cz8xZTE0Il0sInNvdXJjZXNDb250ZW50IjpbIi8vIGRhdGEtc3RvcmUvcmVwb3NpdG9yaWVzL3NpdGUucmVwby50c1xyXG5pbXBvcnQgeyBrdkdldCwga3ZNR2V0LCBrdlNldCwga3ZEZWwsIGt2U0FkZCwga3ZTUmVtLCBrdlNNZW1iZXJzIH0gZnJvbSAnLi4va3YnO1xyXG5pbXBvcnQgeyBidWlsZERhdGFLZXksIGJ1aWxkSW5kZXhLZXkgfSBmcm9tICcuLi9rZXlzJztcclxuaW1wb3J0IHR5cGUgeyBTaXRlLCBTZXR0bGVtZW50LCBQaHlzaWNhbFNpdGVNZXRhZGF0YSB9IGZyb20gJ0AvdHlwZXMvZW50aXRpZXMnO1xyXG5cclxuY29uc3QgRU5USVRZID0gJ3NpdGVzJztcclxuY29uc3QgU0VUVExFTUVOVFNfRU5USVRZID0gJ3NldHRsZW1lbnRzJztcclxuXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBnZXRBbGxTaXRlcygpOiBQcm9taXNlPFNpdGVbXT4ge1xyXG4gIGNvbnN0IGluZGV4S2V5ID0gYnVpbGRJbmRleEtleShFTlRJVFkpO1xyXG4gIGNvbnN0IGlkcyA9IGF3YWl0IGt2U01lbWJlcnMoaW5kZXhLZXkpO1xyXG4gIGlmIChpZHMubGVuZ3RoID09PSAwKSByZXR1cm4gW107XHJcbiAgXHJcbiAgY29uc3Qga2V5cyA9IGlkcy5tYXAoaWQgPT4gYnVpbGREYXRhS2V5KEVOVElUWSwgaWQpKTtcclxuICBjb25zdCBzaXRlcyA9IGF3YWl0IGt2TUdldDxTaXRlPihrZXlzKTtcclxuICByZXR1cm4gc2l0ZXMuZmlsdGVyKChzaXRlKTogc2l0ZSBpcyBTaXRlID0+IHNpdGUgIT09IG51bGwpO1xyXG59XHJcblxyXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gZ2V0U2l0ZUJ5SWQoaWQ6IHN0cmluZyk6IFByb21pc2U8U2l0ZSB8IG51bGw+IHtcclxuICBjb25zdCBrZXkgPSBidWlsZERhdGFLZXkoRU5USVRZLCBpZCk7XHJcbiAgcmV0dXJuIGF3YWl0IGt2R2V0PFNpdGU+KGtleSk7XHJcbn1cclxuXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiB1cHNlcnRTaXRlKHNpdGU6IFNpdGUpOiBQcm9taXNlPFNpdGU+IHtcclxuICBjb25zdCBrZXkgPSBidWlsZERhdGFLZXkoRU5USVRZLCBzaXRlLmlkKTtcclxuICBjb25zdCBpbmRleEtleSA9IGJ1aWxkSW5kZXhLZXkoRU5USVRZKTtcclxuICBcclxuICBhd2FpdCBrdlNldChrZXksIHNpdGUpO1xyXG4gIGF3YWl0IGt2U0FkZChpbmRleEtleSwgc2l0ZS5pZCk7XHJcbiAgXHJcbiAgcmV0dXJuIHNpdGU7XHJcbn1cclxuXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBkZWxldGVTaXRlKGlkOiBzdHJpbmcpOiBQcm9taXNlPHZvaWQ+IHtcclxuICBjb25zdCBrZXkgPSBidWlsZERhdGFLZXkoRU5USVRZLCBpZCk7XHJcbiAgY29uc3QgaW5kZXhLZXkgPSBidWlsZEluZGV4S2V5KEVOVElUWSk7XHJcbiAgXHJcbiAgYXdhaXQga3ZEZWwoa2V5KTtcclxuICBhd2FpdCBrdlNSZW0oaW5kZXhLZXksIGlkKTtcclxufVxyXG5cclxuLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxyXG4vLyBTRVRUTEVNRU5UIE1FVEhPRFMgKFJlZmVyZW5jZSBkYXRhIGZvciBTaXRlcylcclxuLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGdldEFsbFNldHRsZW1lbnRzKCk6IFByb21pc2U8U2V0dGxlbWVudFtdPiB7XHJcbiAgY29uc3QgaW5kZXhLZXkgPSBidWlsZEluZGV4S2V5KFNFVFRMRU1FTlRTX0VOVElUWSk7XHJcbiAgY29uc3QgaWRzID0gYXdhaXQga3ZTTWVtYmVycyhpbmRleEtleSk7XHJcbiAgaWYgKGlkcy5sZW5ndGggPT09IDApIHJldHVybiBbXTtcclxuICBcclxuICBjb25zdCBrZXlzID0gaWRzLm1hcChpZCA9PiBidWlsZERhdGFLZXkoU0VUVExFTUVOVFNfRU5USVRZLCBpZCkpO1xyXG4gIGNvbnN0IHNldHRsZW1lbnRzID0gYXdhaXQga3ZNR2V0PFNldHRsZW1lbnQ+KGtleXMpO1xyXG4gIHJldHVybiBzZXR0bGVtZW50cy5maWx0ZXIoKHNldHRsZW1lbnQpOiBzZXR0bGVtZW50IGlzIFNldHRsZW1lbnQgPT4gc2V0dGxlbWVudCAhPT0gbnVsbCk7XHJcbn1cclxuXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBnZXRTZXR0bGVtZW50QnlJZChpZDogc3RyaW5nKTogUHJvbWlzZTxTZXR0bGVtZW50IHwgbnVsbD4ge1xyXG4gIGNvbnN0IGtleSA9IGJ1aWxkRGF0YUtleShTRVRUTEVNRU5UU19FTlRJVFksIGlkKTtcclxuICByZXR1cm4gYXdhaXQga3ZHZXQ8U2V0dGxlbWVudD4oa2V5KTtcclxufVxyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIHVwc2VydFNldHRsZW1lbnQoc2V0dGxlbWVudDogU2V0dGxlbWVudCk6IFByb21pc2U8U2V0dGxlbWVudD4ge1xyXG4gIGNvbnN0IGtleSA9IGJ1aWxkRGF0YUtleShTRVRUTEVNRU5UU19FTlRJVFksIHNldHRsZW1lbnQuaWQpO1xyXG4gIGNvbnN0IGluZGV4S2V5ID0gYnVpbGRJbmRleEtleShTRVRUTEVNRU5UU19FTlRJVFkpO1xyXG4gIFxyXG4gIGF3YWl0IGt2U2V0KGtleSwgc2V0dGxlbWVudCk7XHJcbiAgYXdhaXQga3ZTQWRkKGluZGV4S2V5LCBzZXR0bGVtZW50LmlkKTtcclxuICBcclxuICByZXR1cm4gc2V0dGxlbWVudDtcclxufVxyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIHJlbW92ZVNldHRsZW1lbnQoaWQ6IHN0cmluZyk6IFByb21pc2U8dm9pZD4ge1xyXG4gIGNvbnN0IGtleSA9IGJ1aWxkRGF0YUtleShTRVRUTEVNRU5UU19FTlRJVFksIGlkKTtcclxuICBjb25zdCBpbmRleEtleSA9IGJ1aWxkSW5kZXhLZXkoU0VUVExFTUVOVFNfRU5USVRZKTtcclxuICBcclxuICBhd2FpdCBrdkRlbChrZXkpO1xyXG4gIGF3YWl0IGt2U1JlbShpbmRleEtleSwgaWQpO1xyXG59XHJcblxyXG4vLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XHJcbi8vIFNJVEUgUVVFUlkgTUVUSE9EU1xyXG4vLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XHJcblxyXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gZ2V0U2l0ZXNCeVNldHRsZW1lbnQoc2V0dGxlbWVudElkOiBzdHJpbmcpOiBQcm9taXNlPFNpdGVbXT4ge1xyXG4gIGNvbnN0IGFsbFNpdGVzID0gYXdhaXQgZ2V0QWxsU2l0ZXMoKTtcclxuICByZXR1cm4gYWxsU2l0ZXMuZmlsdGVyKHNpdGUgPT4ge1xyXG4gICAgaWYgKHNpdGUubWV0YWRhdGEudHlwZSAhPT0gJ1BIWVNJQ0FMJykgcmV0dXJuIGZhbHNlO1xyXG4gICAgY29uc3QgcGh5c2ljYWxNZXRhID0gc2l0ZS5tZXRhZGF0YSBhcyBQaHlzaWNhbFNpdGVNZXRhZGF0YTtcclxuICAgIHJldHVybiBwaHlzaWNhbE1ldGEuc2V0dGxlbWVudElkID09PSBzZXR0bGVtZW50SWQ7XHJcbiAgfSk7XHJcbn1cclxuXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBnZXRTaXRlc0J5UmFkaXVzKFxyXG4gIGNlbnRlckxhdDogbnVtYmVyLFxyXG4gIGNlbnRlckxuZzogbnVtYmVyLFxyXG4gIHJhZGl1c01ldGVyczogbnVtYmVyXHJcbik6IFByb21pc2U8U2l0ZVtdPiB7XHJcbiAgY29uc3QgYWxsU2l0ZXMgPSBhd2FpdCBnZXRBbGxTaXRlcygpO1xyXG4gIGNvbnN0IHNldHRsZW1lbnRzTWFwID0gbmV3IE1hcDxzdHJpbmcsIFNldHRsZW1lbnQ+KCk7XHJcbiAgXHJcbiAgLy8gTG9hZCBhbGwgc2V0dGxlbWVudHMgd2l0aCBjb29yZGluYXRlc1xyXG4gIGNvbnN0IHNldHRsZW1lbnRzID0gYXdhaXQgZ2V0QWxsU2V0dGxlbWVudHMoKTtcclxuICBzZXR0bGVtZW50cy5mb3JFYWNoKHMgPT4ge1xyXG4gICAgaWYgKHMuY29vcmRpbmF0ZXMpIHNldHRsZW1lbnRzTWFwLnNldChzLmlkLCBzKTtcclxuICB9KTtcclxuICBcclxuICByZXR1cm4gYWxsU2l0ZXMuZmlsdGVyKHNpdGUgPT4ge1xyXG4gICAgaWYgKHNpdGUubWV0YWRhdGEudHlwZSAhPT0gJ1BIWVNJQ0FMJykgcmV0dXJuIGZhbHNlO1xyXG4gICAgY29uc3QgcGh5c2ljYWxNZXRhID0gc2l0ZS5tZXRhZGF0YSBhcyBQaHlzaWNhbFNpdGVNZXRhZGF0YTtcclxuICAgIGNvbnN0IHNldHRsZW1lbnQgPSBzZXR0bGVtZW50c01hcC5nZXQocGh5c2ljYWxNZXRhLnNldHRsZW1lbnRJZCk7XHJcbiAgICBcclxuICAgIGlmICghc2V0dGxlbWVudD8uY29vcmRpbmF0ZXMpIHJldHVybiBmYWxzZTtcclxuICAgIFxyXG4gICAgLy8gSGF2ZXJzaW5lIGZvcm11bGEgZm9yIGRpc3RhbmNlIGNhbGN1bGF0aW9uXHJcbiAgICBjb25zdCBSID0gNjM3MTAwMDsgLy8gRWFydGggcmFkaXVzIGluIG1ldGVyc1xyXG4gICAgY29uc3Qgz4YxID0gY2VudGVyTGF0ICogTWF0aC5QSSAvIDE4MDtcclxuICAgIGNvbnN0IM+GMiA9IHNldHRsZW1lbnQuY29vcmRpbmF0ZXMubGF0ICogTWF0aC5QSSAvIDE4MDtcclxuICAgIGNvbnN0IM6Uz4YgPSAoc2V0dGxlbWVudC5jb29yZGluYXRlcy5sYXQgLSBjZW50ZXJMYXQpICogTWF0aC5QSSAvIDE4MDtcclxuICAgIGNvbnN0IM6UzrsgPSAoc2V0dGxlbWVudC5jb29yZGluYXRlcy5sbmcgLSBjZW50ZXJMbmcpICogTWF0aC5QSSAvIDE4MDtcclxuICAgIFxyXG4gICAgY29uc3QgYSA9IE1hdGguc2luKM6Uz4YvMikgKiBNYXRoLnNpbijOlM+GLzIpICtcclxuICAgICAgICAgICAgICBNYXRoLmNvcyjPhjEpICogTWF0aC5jb3Moz4YyKSAqXHJcbiAgICAgICAgICAgICAgTWF0aC5zaW4ozpTOuy8yKSAqIE1hdGguc2luKM6UzrsvMik7XHJcbiAgICBjb25zdCBjID0gMiAqIE1hdGguYXRhbjIoTWF0aC5zcXJ0KGEpLCBNYXRoLnNxcnQoMS1hKSk7XHJcbiAgICBjb25zdCBkaXN0YW5jZSA9IFIgKiBjO1xyXG4gICAgXHJcbiAgICByZXR1cm4gZGlzdGFuY2UgPD0gcmFkaXVzTWV0ZXJzO1xyXG4gIH0pO1xyXG59XHJcbiJdLCJuYW1lcyI6WyJrdkdldCIsImt2TUdldCIsImt2U2V0Iiwia3ZEZWwiLCJrdlNBZGQiLCJrdlNSZW0iLCJrdlNNZW1iZXJzIiwiYnVpbGREYXRhS2V5IiwiYnVpbGRJbmRleEtleSIsIkVOVElUWSIsIlNFVFRMRU1FTlRTX0VOVElUWSIsImdldEFsbFNpdGVzIiwiaW5kZXhLZXkiLCJpZHMiLCJsZW5ndGgiLCJrZXlzIiwibWFwIiwiaWQiLCJzaXRlcyIsImZpbHRlciIsInNpdGUiLCJnZXRTaXRlQnlJZCIsImtleSIsInVwc2VydFNpdGUiLCJkZWxldGVTaXRlIiwiZ2V0QWxsU2V0dGxlbWVudHMiLCJzZXR0bGVtZW50cyIsInNldHRsZW1lbnQiLCJnZXRTZXR0bGVtZW50QnlJZCIsInVwc2VydFNldHRsZW1lbnQiLCJyZW1vdmVTZXR0bGVtZW50IiwiZ2V0U2l0ZXNCeVNldHRsZW1lbnQiLCJzZXR0bGVtZW50SWQiLCJhbGxTaXRlcyIsIm1ldGFkYXRhIiwidHlwZSIsInBoeXNpY2FsTWV0YSIsImdldFNpdGVzQnlSYWRpdXMiLCJjZW50ZXJMYXQiLCJjZW50ZXJMbmciLCJyYWRpdXNNZXRlcnMiLCJzZXR0bGVtZW50c01hcCIsIk1hcCIsImZvckVhY2giLCJzIiwiY29vcmRpbmF0ZXMiLCJzZXQiLCJnZXQiLCJSIiwiz4YxIiwiTWF0aCIsIlBJIiwiz4YyIiwibGF0IiwizpTPhiIsIs6UzrsiLCJsbmciLCJhIiwic2luIiwiY29zIiwiYyIsImF0YW4yIiwic3FydCIsImRpc3RhbmNlIl0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(app-pages-browser)/./data-store/repositories/site.repo.ts\n"));

/***/ }),

/***/ "(app-pages-browser)/./data-store/repositories/task.repo.ts":
/*!**********************************************!*\
  !*** ./data-store/repositories/task.repo.ts ***!
  \**********************************************/
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval(__webpack_require__.ts("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   deleteTask: function() { return /* binding */ deleteTask; },\n/* harmony export */   getAllTasks: function() { return /* binding */ getAllTasks; },\n/* harmony export */   getTaskById: function() { return /* binding */ getTaskById; },\n/* harmony export */   upsertTask: function() { return /* binding */ upsertTask; }\n/* harmony export */ });\n/* harmony import */ var _data_store_kv__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @/data-store/kv */ \"(app-pages-browser)/./data-store/kv.ts\");\n/* harmony import */ var _data_store_keys__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @/data-store/keys */ \"(app-pages-browser)/./data-store/keys.ts\");\n// data-store/repositories/task.repo.ts\n\n\nconst ENTITY = \"task\";\nasync function getTaskById(id) {\n    return await (0,_data_store_kv__WEBPACK_IMPORTED_MODULE_0__.kvGet)((0,_data_store_keys__WEBPACK_IMPORTED_MODULE_1__.buildDataKey)(ENTITY, id));\n}\nasync function getAllTasks() {\n    const ids = await (0,_data_store_kv__WEBPACK_IMPORTED_MODULE_0__.kvSMembers)((0,_data_store_keys__WEBPACK_IMPORTED_MODULE_1__.buildIndexKey)(ENTITY));\n    const rows = await Promise.all(ids.map((id)=>(0,_data_store_kv__WEBPACK_IMPORTED_MODULE_0__.kvGet)((0,_data_store_keys__WEBPACK_IMPORTED_MODULE_1__.buildDataKey)(ENTITY, id))));\n    return rows.filter(Boolean);\n}\nasync function upsertTask(task) {\n    await (0,_data_store_kv__WEBPACK_IMPORTED_MODULE_0__.kvSet)((0,_data_store_keys__WEBPACK_IMPORTED_MODULE_1__.buildDataKey)(ENTITY, task.id), task);\n    await (0,_data_store_kv__WEBPACK_IMPORTED_MODULE_0__.kvSAdd)((0,_data_store_keys__WEBPACK_IMPORTED_MODULE_1__.buildIndexKey)(ENTITY), task.id);\n    return task;\n}\nasync function deleteTask(id) {\n    await (0,_data_store_kv__WEBPACK_IMPORTED_MODULE_0__.kvDel)((0,_data_store_keys__WEBPACK_IMPORTED_MODULE_1__.buildDataKey)(ENTITY, id));\n}\n\n\n;\n    // Wrapped in an IIFE to avoid polluting the global scope\n    ;\n    (function () {\n        var _a, _b;\n        // Legacy CSS implementations will `eval` browser code in a Node.js context\n        // to extract CSS. For backwards compatibility, we need to check we're in a\n        // browser context before continuing.\n        if (typeof self !== 'undefined' &&\n            // AMP / No-JS mode does not inject these helpers:\n            '$RefreshHelpers$' in self) {\n            // @ts-ignore __webpack_module__ is global\n            var currentExports = module.exports;\n            // @ts-ignore __webpack_module__ is global\n            var prevSignature = (_b = (_a = module.hot.data) === null || _a === void 0 ? void 0 : _a.prevSignature) !== null && _b !== void 0 ? _b : null;\n            // This cannot happen in MainTemplate because the exports mismatch between\n            // templating and execution.\n            self.$RefreshHelpers$.registerExportsForReactRefresh(currentExports, module.id);\n            // A module can be accepted automatically based on its exports, e.g. when\n            // it is a Refresh Boundary.\n            if (self.$RefreshHelpers$.isReactRefreshBoundary(currentExports)) {\n                // Save the previous exports signature on update so we can compare the boundary\n                // signatures. We avoid saving exports themselves since it causes memory leaks (https://github.com/vercel/next.js/pull/53797)\n                module.hot.dispose(function (data) {\n                    data.prevSignature =\n                        self.$RefreshHelpers$.getRefreshBoundarySignature(currentExports);\n                });\n                // Unconditionally accept an update to this module, we'll check if it's\n                // still a Refresh Boundary later.\n                // @ts-ignore importMeta is replaced in the loader\n                module.hot.accept();\n                // This field is set when the previous version of this module was a\n                // Refresh Boundary, letting us know we need to check for invalidation or\n                // enqueue an update.\n                if (prevSignature !== null) {\n                    // A boundary can become ineligible if its exports are incompatible\n                    // with the previous exports.\n                    //\n                    // For example, if you add/remove/change exports, we'll want to\n                    // re-execute the importing modules, and force those components to\n                    // re-render. Similarly, if you convert a class component to a\n                    // function, we want to invalidate the boundary.\n                    if (self.$RefreshHelpers$.shouldInvalidateReactRefreshBoundary(prevSignature, self.$RefreshHelpers$.getRefreshBoundarySignature(currentExports))) {\n                        module.hot.invalidate();\n                    }\n                    else {\n                        self.$RefreshHelpers$.scheduleUpdate();\n                    }\n                }\n            }\n            else {\n                // Since we just executed the code for the module, it's possible that the\n                // new exports made it ineligible for being a boundary.\n                // We only care about the case when we were _previously_ a boundary,\n                // because we already accepted this update (accidental side effect).\n                var isNoLongerABoundary = prevSignature !== null;\n                if (isNoLongerABoundary) {\n                    module.hot.invalidate();\n                }\n            }\n        }\n    })();\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFwcC1wYWdlcy1icm93c2VyKS8uL2RhdGEtc3RvcmUvcmVwb3NpdG9yaWVzL3Rhc2sucmVwby50cyIsIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7QUFBQSx1Q0FBdUM7QUFFbUM7QUFDVjtBQUVoRSxNQUFNTyxTQUFTO0FBRVIsZUFBZUMsWUFBWUMsRUFBVTtJQUMxQyxPQUFPLE1BQU1ULHFEQUFLQSxDQUFPSyw4REFBWUEsQ0FBQ0UsUUFBUUU7QUFDaEQ7QUFFTyxlQUFlQztJQUNwQixNQUFNQyxNQUFNLE1BQU1SLDBEQUFVQSxDQUFDRywrREFBYUEsQ0FBQ0M7SUFDM0MsTUFBTUssT0FBTyxNQUFNQyxRQUFRQyxHQUFHLENBQUNILElBQUlJLEdBQUcsQ0FBQ04sQ0FBQUEsS0FBTVQscURBQUtBLENBQU9LLDhEQUFZQSxDQUFDRSxRQUFRRTtJQUM5RSxPQUFPRyxLQUFLSSxNQUFNLENBQUNDO0FBQ3JCO0FBRU8sZUFBZUMsV0FBV0MsSUFBVTtJQUN6QyxNQUFNbEIscURBQUtBLENBQUNJLDhEQUFZQSxDQUFDRSxRQUFRWSxLQUFLVixFQUFFLEdBQUdVO0lBQzNDLE1BQU1mLHNEQUFNQSxDQUFDRSwrREFBYUEsQ0FBQ0MsU0FBU1ksS0FBS1YsRUFBRTtJQUMzQyxPQUFPVTtBQUNUO0FBRU8sZUFBZUMsV0FBV1gsRUFBVTtJQUN6QyxNQUFNUCxxREFBS0EsQ0FBQ0csOERBQVlBLENBQUNFLFFBQVFFO0FBQ25DIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vX05fRS8uL2RhdGEtc3RvcmUvcmVwb3NpdG9yaWVzL3Rhc2sucmVwby50cz82MmZlIl0sInNvdXJjZXNDb250ZW50IjpbIi8vIGRhdGEtc3RvcmUvcmVwb3NpdG9yaWVzL3Rhc2sucmVwby50c1xyXG5pbXBvcnQgdHlwZSB7IFRhc2sgfSBmcm9tICdAL3R5cGVzL2VudGl0aWVzJztcclxuaW1wb3J0IHsga3ZHZXQsIGt2U2V0LCBrdkRlbCwga3ZTTWVtYmVycywga3ZTQWRkIH0gZnJvbSAnQC9kYXRhLXN0b3JlL2t2JztcclxuaW1wb3J0IHsgYnVpbGREYXRhS2V5LCBidWlsZEluZGV4S2V5IH0gZnJvbSAnQC9kYXRhLXN0b3JlL2tleXMnO1xyXG5cclxuY29uc3QgRU5USVRZID0gJ3Rhc2snO1xyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGdldFRhc2tCeUlkKGlkOiBzdHJpbmcpOiBQcm9taXNlPFRhc2sgfCBudWxsPiB7XHJcbiAgcmV0dXJuIGF3YWl0IGt2R2V0PFRhc2s+KGJ1aWxkRGF0YUtleShFTlRJVFksIGlkKSk7XHJcbn1cclxuXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBnZXRBbGxUYXNrcygpOiBQcm9taXNlPFRhc2tbXT4ge1xyXG4gIGNvbnN0IGlkcyA9IGF3YWl0IGt2U01lbWJlcnMoYnVpbGRJbmRleEtleShFTlRJVFkpKTtcclxuICBjb25zdCByb3dzID0gYXdhaXQgUHJvbWlzZS5hbGwoaWRzLm1hcChpZCA9PiBrdkdldDxUYXNrPihidWlsZERhdGFLZXkoRU5USVRZLCBpZCkpKSk7XHJcbiAgcmV0dXJuIHJvd3MuZmlsdGVyKEJvb2xlYW4pIGFzIFRhc2tbXTtcclxufVxyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIHVwc2VydFRhc2sodGFzazogVGFzayk6IFByb21pc2U8VGFzaz4ge1xyXG4gIGF3YWl0IGt2U2V0KGJ1aWxkRGF0YUtleShFTlRJVFksIHRhc2suaWQpLCB0YXNrKTtcclxuICBhd2FpdCBrdlNBZGQoYnVpbGRJbmRleEtleShFTlRJVFkpLCB0YXNrLmlkKTtcclxuICByZXR1cm4gdGFzaztcclxufVxyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGRlbGV0ZVRhc2soaWQ6IHN0cmluZyk6IFByb21pc2U8dm9pZD4ge1xyXG4gIGF3YWl0IGt2RGVsKGJ1aWxkRGF0YUtleShFTlRJVFksIGlkKSk7XHJcbn1cclxuXHJcblxyXG4iXSwibmFtZXMiOlsia3ZHZXQiLCJrdlNldCIsImt2RGVsIiwia3ZTTWVtYmVycyIsImt2U0FkZCIsImJ1aWxkRGF0YUtleSIsImJ1aWxkSW5kZXhLZXkiLCJFTlRJVFkiLCJnZXRUYXNrQnlJZCIsImlkIiwiZ2V0QWxsVGFza3MiLCJpZHMiLCJyb3dzIiwiUHJvbWlzZSIsImFsbCIsIm1hcCIsImZpbHRlciIsIkJvb2xlYW4iLCJ1cHNlcnRUYXNrIiwidGFzayIsImRlbGV0ZVRhc2siXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(app-pages-browser)/./data-store/repositories/task.repo.ts\n"));

/***/ }),

/***/ "(app-pages-browser)/./links/link-registry.ts":
/*!********************************!*\
  !*** ./links/link-registry.ts ***!
  \********************************/
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval(__webpack_require__.ts("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   createLink: function() { return /* binding */ createLink; },\n/* harmony export */   getAllLinks: function() { return /* binding */ getAllLinks; },\n/* harmony export */   getLinksFor: function() { return /* binding */ getLinksFor; },\n/* harmony export */   removeLink: function() { return /* binding */ removeLink; }\n/* harmony export */ });\n/* harmony import */ var _data_store_kv__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @/data-store/kv */ \"(app-pages-browser)/./data-store/kv.ts\");\n/* harmony import */ var _data_store_keys__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @/data-store/keys */ \"(app-pages-browser)/./data-store/keys.ts\");\n/* harmony import */ var _link_validation__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./link-validation */ \"(app-pages-browser)/./links/link-validation.ts\");\n// links/link-registry.ts\n// The Rosetta Stone storage and query layer (KV only)\n\n\n\nasync function createLink(link) {\n    // NEW: Validate before creating\n    const validation = await (0,_link_validation__WEBPACK_IMPORTED_MODULE_2__.validateLink)(link.linkType, link.source, link.target, link.metadata);\n    if (!validation.isValid) {\n        console.warn(\"[createLink] Validation failed: \".concat(validation.reason));\n        if (validation.warnings) {\n            console.warn(\"[createLink] Validation warnings:\", validation.warnings);\n        }\n        return; // Skip creating invalid links\n    }\n    // Log warnings if any\n    if (validation.warnings && validation.warnings.length > 0) {\n        console.warn(\"[createLink] Validation warnings for \".concat(link.linkType, \":\"), validation.warnings);\n    }\n    await (0,_data_store_kv__WEBPACK_IMPORTED_MODULE_0__.kvSet)((0,_data_store_keys__WEBPACK_IMPORTED_MODULE_1__.buildLinkKey)(link.id), link);\n    // index by source and target for bidirectional queries\n    await (0,_data_store_kv__WEBPACK_IMPORTED_MODULE_0__.kvSAdd)((0,_data_store_keys__WEBPACK_IMPORTED_MODULE_1__.buildLinksIndexKey)(link.source.type, link.source.id), link.id);\n    await (0,_data_store_kv__WEBPACK_IMPORTED_MODULE_0__.kvSAdd)((0,_data_store_keys__WEBPACK_IMPORTED_MODULE_1__.buildLinksIndexKey)(link.target.type, link.target.id), link.id);\n}\nasync function getLinksFor(entity) {\n    const ids = await (0,_data_store_kv__WEBPACK_IMPORTED_MODULE_0__.kvSMembers)((0,_data_store_keys__WEBPACK_IMPORTED_MODULE_1__.buildLinksIndexKey)(entity.type, entity.id));\n    if (!ids.length) return [];\n    const keys = ids.map(_data_store_keys__WEBPACK_IMPORTED_MODULE_1__.buildLinkKey);\n    const rows = await Promise.all(keys.map((k)=>(0,_data_store_kv__WEBPACK_IMPORTED_MODULE_0__.kvGet)(k)));\n    return rows.filter(Boolean);\n}\nasync function removeLink(linkId) {\n    const key = (0,_data_store_keys__WEBPACK_IMPORTED_MODULE_1__.buildLinkKey)(linkId);\n    const existing = await (0,_data_store_kv__WEBPACK_IMPORTED_MODULE_0__.kvGet)(key);\n    if (existing) {\n        // Remove from both source and target indexes\n        await (0,_data_store_kv__WEBPACK_IMPORTED_MODULE_0__.kvSRem)((0,_data_store_keys__WEBPACK_IMPORTED_MODULE_1__.buildLinksIndexKey)(existing.source.type, existing.source.id), linkId);\n        await (0,_data_store_kv__WEBPACK_IMPORTED_MODULE_0__.kvSRem)((0,_data_store_keys__WEBPACK_IMPORTED_MODULE_1__.buildLinksIndexKey)(existing.target.type, existing.target.id), linkId);\n    }\n    await (0,_data_store_kv__WEBPACK_IMPORTED_MODULE_0__.kvDel)(key);\n}\nasync function getAllLinks() {\n    const keys = await (0,_data_store_kv__WEBPACK_IMPORTED_MODULE_0__.kvScan)(\"links:link:\");\n    if (!keys.length) return [];\n    const links = await Promise.all(keys.map((k)=>(0,_data_store_kv__WEBPACK_IMPORTED_MODULE_0__.kvGet)(k)));\n    return links.filter(Boolean);\n}\n\n\n;\n    // Wrapped in an IIFE to avoid polluting the global scope\n    ;\n    (function () {\n        var _a, _b;\n        // Legacy CSS implementations will `eval` browser code in a Node.js context\n        // to extract CSS. For backwards compatibility, we need to check we're in a\n        // browser context before continuing.\n        if (typeof self !== 'undefined' &&\n            // AMP / No-JS mode does not inject these helpers:\n            '$RefreshHelpers$' in self) {\n            // @ts-ignore __webpack_module__ is global\n            var currentExports = module.exports;\n            // @ts-ignore __webpack_module__ is global\n            var prevSignature = (_b = (_a = module.hot.data) === null || _a === void 0 ? void 0 : _a.prevSignature) !== null && _b !== void 0 ? _b : null;\n            // This cannot happen in MainTemplate because the exports mismatch between\n            // templating and execution.\n            self.$RefreshHelpers$.registerExportsForReactRefresh(currentExports, module.id);\n            // A module can be accepted automatically based on its exports, e.g. when\n            // it is a Refresh Boundary.\n            if (self.$RefreshHelpers$.isReactRefreshBoundary(currentExports)) {\n                // Save the previous exports signature on update so we can compare the boundary\n                // signatures. We avoid saving exports themselves since it causes memory leaks (https://github.com/vercel/next.js/pull/53797)\n                module.hot.dispose(function (data) {\n                    data.prevSignature =\n                        self.$RefreshHelpers$.getRefreshBoundarySignature(currentExports);\n                });\n                // Unconditionally accept an update to this module, we'll check if it's\n                // still a Refresh Boundary later.\n                // @ts-ignore importMeta is replaced in the loader\n                module.hot.accept();\n                // This field is set when the previous version of this module was a\n                // Refresh Boundary, letting us know we need to check for invalidation or\n                // enqueue an update.\n                if (prevSignature !== null) {\n                    // A boundary can become ineligible if its exports are incompatible\n                    // with the previous exports.\n                    //\n                    // For example, if you add/remove/change exports, we'll want to\n                    // re-execute the importing modules, and force those components to\n                    // re-render. Similarly, if you convert a class component to a\n                    // function, we want to invalidate the boundary.\n                    if (self.$RefreshHelpers$.shouldInvalidateReactRefreshBoundary(prevSignature, self.$RefreshHelpers$.getRefreshBoundarySignature(currentExports))) {\n                        module.hot.invalidate();\n                    }\n                    else {\n                        self.$RefreshHelpers$.scheduleUpdate();\n                    }\n                }\n            }\n            else {\n                // Since we just executed the code for the module, it's possible that the\n                // new exports made it ineligible for being a boundary.\n                // We only care about the case when we were _previously_ a boundary,\n                // because we already accepted this update (accidental side effect).\n                var isNoLongerABoundary = prevSignature !== null;\n                if (isNoLongerABoundary) {\n                    module.hot.invalidate();\n                }\n            }\n        }\n    })();\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFwcC1wYWdlcy1icm93c2VyKS8uL2xpbmtzL2xpbmstcmVnaXN0cnkudHMiLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7OztBQUFBLHlCQUF5QjtBQUN6QixzREFBc0Q7QUFJb0M7QUFDckI7QUFDcEI7QUFFMUMsZUFBZVUsV0FBV0MsSUFBVTtJQUN6QyxnQ0FBZ0M7SUFDaEMsTUFBTUMsYUFBYSxNQUFNSCw4REFBWUEsQ0FBQ0UsS0FBS0UsUUFBUSxFQUFFRixLQUFLRyxNQUFNLEVBQUVILEtBQUtJLE1BQU0sRUFBRUosS0FBS0ssUUFBUTtJQUM1RixJQUFJLENBQUNKLFdBQVdLLE9BQU8sRUFBRTtRQUN2QkMsUUFBUUMsSUFBSSxDQUFDLG1DQUFxRCxPQUFsQlAsV0FBV1EsTUFBTTtRQUNqRSxJQUFJUixXQUFXUyxRQUFRLEVBQUU7WUFDdkJILFFBQVFDLElBQUksQ0FBRSxxQ0FBb0NQLFdBQVdTLFFBQVE7UUFDdkU7UUFDQSxRQUFRLDhCQUE4QjtJQUN4QztJQUVBLHNCQUFzQjtJQUN0QixJQUFJVCxXQUFXUyxRQUFRLElBQUlULFdBQVdTLFFBQVEsQ0FBQ0MsTUFBTSxHQUFHLEdBQUc7UUFDekRKLFFBQVFDLElBQUksQ0FBQyx3Q0FBc0QsT0FBZFIsS0FBS0UsUUFBUSxFQUFDLE1BQUlELFdBQVdTLFFBQVE7SUFDNUY7SUFFQSxNQUFNcEIscURBQUtBLENBQUNNLDhEQUFZQSxDQUFDSSxLQUFLWSxFQUFFLEdBQUdaO0lBQ25DLHVEQUF1RDtJQUN2RCxNQUFNUixzREFBTUEsQ0FBQ0ssb0VBQWtCQSxDQUFDRyxLQUFLRyxNQUFNLENBQUNVLElBQUksRUFBRWIsS0FBS0csTUFBTSxDQUFDUyxFQUFFLEdBQUdaLEtBQUtZLEVBQUU7SUFDMUUsTUFBTXBCLHNEQUFNQSxDQUFDSyxvRUFBa0JBLENBQUNHLEtBQUtJLE1BQU0sQ0FBQ1MsSUFBSSxFQUFFYixLQUFLSSxNQUFNLENBQUNRLEVBQUUsR0FBR1osS0FBS1ksRUFBRTtBQUM1RTtBQUVPLGVBQWVFLFlBQVlDLE1BQXdDO0lBQ3hFLE1BQU1DLE1BQU0sTUFBTXRCLDBEQUFVQSxDQUFDRyxvRUFBa0JBLENBQUNrQixPQUFPRixJQUFJLEVBQUVFLE9BQU9ILEVBQUU7SUFDdEUsSUFBSSxDQUFDSSxJQUFJTCxNQUFNLEVBQUUsT0FBTyxFQUFFO0lBQzFCLE1BQU1NLE9BQU9ELElBQUlFLEdBQUcsQ0FBQ3RCLDBEQUFZQTtJQUNqQyxNQUFNdUIsT0FBTyxNQUFNQyxRQUFRQyxHQUFHLENBQUNKLEtBQUtDLEdBQUcsQ0FBQ0ksQ0FBQUEsSUFBS2pDLHFEQUFLQSxDQUFPaUM7SUFDekQsT0FBT0gsS0FBS0ksTUFBTSxDQUFDQztBQUNyQjtBQUVPLGVBQWVDLFdBQVdDLE1BQWM7SUFDN0MsTUFBTUMsTUFBTS9CLDhEQUFZQSxDQUFDOEI7SUFDekIsTUFBTUUsV0FBVyxNQUFNdkMscURBQUtBLENBQU9zQztJQUNuQyxJQUFJQyxVQUFVO1FBQ1osNkNBQTZDO1FBQzdDLE1BQU1uQyxzREFBTUEsQ0FBQ0ksb0VBQWtCQSxDQUFDK0IsU0FBU3pCLE1BQU0sQ0FBQ1UsSUFBSSxFQUFFZSxTQUFTekIsTUFBTSxDQUFDUyxFQUFFLEdBQUdjO1FBQzNFLE1BQU1qQyxzREFBTUEsQ0FBQ0ksb0VBQWtCQSxDQUFDK0IsU0FBU3hCLE1BQU0sQ0FBQ1MsSUFBSSxFQUFFZSxTQUFTeEIsTUFBTSxDQUFDUSxFQUFFLEdBQUdjO0lBQzdFO0lBQ0EsTUFBTW5DLHFEQUFLQSxDQUFDb0M7QUFDZDtBQUVPLGVBQWVFO0lBQ3BCLE1BQU1aLE9BQU8sTUFBTXRCLHNEQUFNQSxDQUFDO0lBQzFCLElBQUksQ0FBQ3NCLEtBQUtOLE1BQU0sRUFBRSxPQUFPLEVBQUU7SUFDM0IsTUFBTW1CLFFBQVEsTUFBTVYsUUFBUUMsR0FBRyxDQUFDSixLQUFLQyxHQUFHLENBQUMsQ0FBQ0ksSUFBY2pDLHFEQUFLQSxDQUFPaUM7SUFDcEUsT0FBT1EsTUFBTVAsTUFBTSxDQUFDQztBQUN0QiIsInNvdXJjZXMiOlsid2VicGFjazovL19OX0UvLi9saW5rcy9saW5rLXJlZ2lzdHJ5LnRzP2VhMDciXSwic291cmNlc0NvbnRlbnQiOlsiLy8gbGlua3MvbGluay1yZWdpc3RyeS50c1xyXG4vLyBUaGUgUm9zZXR0YSBTdG9uZSBzdG9yYWdlIGFuZCBxdWVyeSBsYXllciAoS1Ygb25seSlcclxuXHJcbmltcG9ydCB7IExpbmtUeXBlLCBFbnRpdHlUeXBlIH0gZnJvbSAnQC90eXBlcy9lbnVtcyc7XHJcbmltcG9ydCB0eXBlIHsgTGluayB9IGZyb20gJ0AvdHlwZXMvZW50aXRpZXMnO1xyXG5pbXBvcnQgeyBrdkdldCwga3ZTZXQsIGt2RGVsLCBrdlNBZGQsIGt2U1JlbSwga3ZTTWVtYmVycywga3ZTY2FuIH0gZnJvbSAnQC9kYXRhLXN0b3JlL2t2JztcclxuaW1wb3J0IHsgYnVpbGRMaW5rS2V5LCBidWlsZExpbmtzSW5kZXhLZXkgfSBmcm9tICdAL2RhdGEtc3RvcmUva2V5cyc7XHJcbmltcG9ydCB7IHZhbGlkYXRlTGluayB9IGZyb20gJy4vbGluay12YWxpZGF0aW9uJztcclxuXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBjcmVhdGVMaW5rKGxpbms6IExpbmspOiBQcm9taXNlPHZvaWQ+IHtcclxuICAvLyBORVc6IFZhbGlkYXRlIGJlZm9yZSBjcmVhdGluZ1xyXG4gIGNvbnN0IHZhbGlkYXRpb24gPSBhd2FpdCB2YWxpZGF0ZUxpbmsobGluay5saW5rVHlwZSwgbGluay5zb3VyY2UsIGxpbmsudGFyZ2V0LCBsaW5rLm1ldGFkYXRhKTtcclxuICBpZiAoIXZhbGlkYXRpb24uaXNWYWxpZCkge1xyXG4gICAgY29uc29sZS53YXJuKGBbY3JlYXRlTGlua10gVmFsaWRhdGlvbiBmYWlsZWQ6ICR7dmFsaWRhdGlvbi5yZWFzb259YCk7XHJcbiAgICBpZiAodmFsaWRhdGlvbi53YXJuaW5ncykge1xyXG4gICAgICBjb25zb2xlLndhcm4oYFtjcmVhdGVMaW5rXSBWYWxpZGF0aW9uIHdhcm5pbmdzOmAsIHZhbGlkYXRpb24ud2FybmluZ3MpO1xyXG4gICAgfVxyXG4gICAgcmV0dXJuOyAvLyBTa2lwIGNyZWF0aW5nIGludmFsaWQgbGlua3NcclxuICB9XHJcbiAgXHJcbiAgLy8gTG9nIHdhcm5pbmdzIGlmIGFueVxyXG4gIGlmICh2YWxpZGF0aW9uLndhcm5pbmdzICYmIHZhbGlkYXRpb24ud2FybmluZ3MubGVuZ3RoID4gMCkge1xyXG4gICAgY29uc29sZS53YXJuKGBbY3JlYXRlTGlua10gVmFsaWRhdGlvbiB3YXJuaW5ncyBmb3IgJHtsaW5rLmxpbmtUeXBlfTpgLCB2YWxpZGF0aW9uLndhcm5pbmdzKTtcclxuICB9XHJcbiAgXHJcbiAgYXdhaXQga3ZTZXQoYnVpbGRMaW5rS2V5KGxpbmsuaWQpLCBsaW5rKTtcclxuICAvLyBpbmRleCBieSBzb3VyY2UgYW5kIHRhcmdldCBmb3IgYmlkaXJlY3Rpb25hbCBxdWVyaWVzXHJcbiAgYXdhaXQga3ZTQWRkKGJ1aWxkTGlua3NJbmRleEtleShsaW5rLnNvdXJjZS50eXBlLCBsaW5rLnNvdXJjZS5pZCksIGxpbmsuaWQpO1xyXG4gIGF3YWl0IGt2U0FkZChidWlsZExpbmtzSW5kZXhLZXkobGluay50YXJnZXQudHlwZSwgbGluay50YXJnZXQuaWQpLCBsaW5rLmlkKTtcclxufVxyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGdldExpbmtzRm9yKGVudGl0eTogeyB0eXBlOiBFbnRpdHlUeXBlOyBpZDogc3RyaW5nIH0pOiBQcm9taXNlPExpbmtbXT4ge1xyXG4gIGNvbnN0IGlkcyA9IGF3YWl0IGt2U01lbWJlcnMoYnVpbGRMaW5rc0luZGV4S2V5KGVudGl0eS50eXBlLCBlbnRpdHkuaWQpKTtcclxuICBpZiAoIWlkcy5sZW5ndGgpIHJldHVybiBbXTtcclxuICBjb25zdCBrZXlzID0gaWRzLm1hcChidWlsZExpbmtLZXkpO1xyXG4gIGNvbnN0IHJvd3MgPSBhd2FpdCBQcm9taXNlLmFsbChrZXlzLm1hcChrID0+IGt2R2V0PExpbms+KGspKSk7XHJcbiAgcmV0dXJuIHJvd3MuZmlsdGVyKEJvb2xlYW4pIGFzIExpbmtbXTtcclxufVxyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIHJlbW92ZUxpbmsobGlua0lkOiBzdHJpbmcpOiBQcm9taXNlPHZvaWQ+IHtcclxuICBjb25zdCBrZXkgPSBidWlsZExpbmtLZXkobGlua0lkKTtcclxuICBjb25zdCBleGlzdGluZyA9IGF3YWl0IGt2R2V0PExpbms+KGtleSk7XHJcbiAgaWYgKGV4aXN0aW5nKSB7XHJcbiAgICAvLyBSZW1vdmUgZnJvbSBib3RoIHNvdXJjZSBhbmQgdGFyZ2V0IGluZGV4ZXNcclxuICAgIGF3YWl0IGt2U1JlbShidWlsZExpbmtzSW5kZXhLZXkoZXhpc3Rpbmcuc291cmNlLnR5cGUsIGV4aXN0aW5nLnNvdXJjZS5pZCksIGxpbmtJZCk7XHJcbiAgICBhd2FpdCBrdlNSZW0oYnVpbGRMaW5rc0luZGV4S2V5KGV4aXN0aW5nLnRhcmdldC50eXBlLCBleGlzdGluZy50YXJnZXQuaWQpLCBsaW5rSWQpO1xyXG4gIH1cclxuICBhd2FpdCBrdkRlbChrZXkpO1xyXG59XHJcblxyXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gZ2V0QWxsTGlua3MoKTogUHJvbWlzZTxMaW5rW10+IHtcclxuICBjb25zdCBrZXlzID0gYXdhaXQga3ZTY2FuKCdsaW5rczpsaW5rOicpO1xyXG4gIGlmICgha2V5cy5sZW5ndGgpIHJldHVybiBbXTtcclxuICBjb25zdCBsaW5rcyA9IGF3YWl0IFByb21pc2UuYWxsKGtleXMubWFwKChrOiBzdHJpbmcpID0+IGt2R2V0PExpbms+KGspKSk7XHJcbiAgcmV0dXJuIGxpbmtzLmZpbHRlcihCb29sZWFuKSBhcyBMaW5rW107XHJcbn1cclxuXHJcblxyXG4iXSwibmFtZXMiOlsia3ZHZXQiLCJrdlNldCIsImt2RGVsIiwia3ZTQWRkIiwia3ZTUmVtIiwia3ZTTWVtYmVycyIsImt2U2NhbiIsImJ1aWxkTGlua0tleSIsImJ1aWxkTGlua3NJbmRleEtleSIsInZhbGlkYXRlTGluayIsImNyZWF0ZUxpbmsiLCJsaW5rIiwidmFsaWRhdGlvbiIsImxpbmtUeXBlIiwic291cmNlIiwidGFyZ2V0IiwibWV0YWRhdGEiLCJpc1ZhbGlkIiwiY29uc29sZSIsIndhcm4iLCJyZWFzb24iLCJ3YXJuaW5ncyIsImxlbmd0aCIsImlkIiwidHlwZSIsImdldExpbmtzRm9yIiwiZW50aXR5IiwiaWRzIiwia2V5cyIsIm1hcCIsInJvd3MiLCJQcm9taXNlIiwiYWxsIiwiayIsImZpbHRlciIsIkJvb2xlYW4iLCJyZW1vdmVMaW5rIiwibGlua0lkIiwia2V5IiwiZXhpc3RpbmciLCJnZXRBbGxMaW5rcyIsImxpbmtzIl0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(app-pages-browser)/./links/link-registry.ts\n"));

/***/ }),

/***/ "(app-pages-browser)/./links/link-validation.ts":
/*!**********************************!*\
  !*** ./links/link-validation.ts ***!
  \**********************************/
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval(__webpack_require__.ts("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   validateBusinessRules: function() { return /* binding */ validateBusinessRules; },\n/* harmony export */   validateEntityExists: function() { return /* binding */ validateEntityExists; },\n/* harmony export */   validateLink: function() { return /* binding */ validateLink; },\n/* harmony export */   validateLinkTypeCompatibility: function() { return /* binding */ validateLinkTypeCompatibility; }\n/* harmony export */ });\n/* harmony import */ var _types_enums__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @/types/enums */ \"(app-pages-browser)/./types/enums.ts\");\n/* harmony import */ var _data_store_datastore__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @/data-store/datastore */ \"(app-pages-browser)/./data-store/datastore.ts\");\n// links/link-validation.ts\n// Link Validation System for The Rosetta Stone\n// Migrated from lib/game-mechanics/workflow-integration.ts\n\n\n/**\r\n * Main link validation orchestrator\r\n * Validates link type compatibility, entity existence, and business rules\r\n */ async function validateLink(linkType, source, target, metadata) {\n    const warnings = [];\n    try {\n        // 1. Basic validation\n        if (!linkType || !(source === null || source === void 0 ? void 0 : source.type) || !(source === null || source === void 0 ? void 0 : source.id) || !(target === null || target === void 0 ? void 0 : target.type) || !(target === null || target === void 0 ? void 0 : target.id)) {\n            return {\n                isValid: false,\n                reason: \"Missing required fields: linkType, source.type, source.id, target.type, target.id\"\n            };\n        }\n        // 2. Self-reference validation\n        if (source.type === target.type && source.id === target.id) {\n            return {\n                isValid: false,\n                reason: \"Self-referencing links are not allowed\"\n            };\n        }\n        // 3. Link type compatibility validation\n        const compatibilityResult = validateLinkTypeCompatibility(linkType, source.type, target.type);\n        if (!compatibilityResult.isValid) {\n            return {\n                isValid: false,\n                reason: \"Incompatible link type: \".concat(linkType, \" cannot connect \").concat(source.type, \" to \").concat(target.type, \". \").concat(compatibilityResult.reason)\n            };\n        }\n        // 4. Entity existence validation\n        const sourceExists = await validateEntityExists(source.type, source.id);\n        if (!sourceExists) {\n            return {\n                isValid: false,\n                reason: \"Source entity does not exist: \".concat(source.type, \":\").concat(source.id)\n            };\n        }\n        const targetExists = await validateEntityExists(target.type, target.id);\n        if (!targetExists) {\n            return {\n                isValid: false,\n                reason: \"Target entity does not exist: \".concat(target.type, \":\").concat(target.id)\n            };\n        }\n        // 5. Business rules validation\n        const businessRulesResult = await validateBusinessRules(linkType, source, target, metadata);\n        if (!businessRulesResult.isValid) {\n            return {\n                isValid: false,\n                reason: businessRulesResult.reason\n            };\n        }\n        // Add any warnings from business rules\n        if (businessRulesResult.warnings) {\n            warnings.push(...businessRulesResult.warnings);\n        }\n        return {\n            isValid: true,\n            warnings: warnings.length > 0 ? warnings : undefined\n        };\n    } catch (error) {\n        return {\n            isValid: false,\n            reason: \"Validation error: \".concat(error instanceof Error ? error.message : \"Unknown error\")\n        };\n    }\n}\n/**\r\n * Validate link type compatibility with source and target entity types\r\n * Complete mapping of all 39 link types\r\n */ function validateLinkTypeCompatibility(linkType, sourceType, targetType) {\n    // Define valid link type combinations for all 39 link types\n    const validCombinations = {\n        // TASK relationships (6)\n        \"TASK_ITEM\": {\n            source: [\n                _types_enums__WEBPACK_IMPORTED_MODULE_0__.EntityType.TASK\n            ],\n            target: [\n                _types_enums__WEBPACK_IMPORTED_MODULE_0__.EntityType.ITEM\n            ]\n        },\n        \"TASK_FINREC\": {\n            source: [\n                _types_enums__WEBPACK_IMPORTED_MODULE_0__.EntityType.TASK\n            ],\n            target: [\n                _types_enums__WEBPACK_IMPORTED_MODULE_0__.EntityType.FINANCIAL\n            ]\n        },\n        \"TASK_SALE\": {\n            source: [\n                _types_enums__WEBPACK_IMPORTED_MODULE_0__.EntityType.TASK\n            ],\n            target: [\n                _types_enums__WEBPACK_IMPORTED_MODULE_0__.EntityType.SALE\n            ]\n        },\n        \"TASK_PLAYER\": {\n            source: [\n                _types_enums__WEBPACK_IMPORTED_MODULE_0__.EntityType.TASK\n            ],\n            target: [\n                _types_enums__WEBPACK_IMPORTED_MODULE_0__.EntityType.PLAYER\n            ]\n        },\n        \"TASK_CHARACTER\": {\n            source: [\n                _types_enums__WEBPACK_IMPORTED_MODULE_0__.EntityType.TASK\n            ],\n            target: [\n                _types_enums__WEBPACK_IMPORTED_MODULE_0__.EntityType.CHARACTER\n            ]\n        },\n        \"TASK_SITE\": {\n            source: [\n                _types_enums__WEBPACK_IMPORTED_MODULE_0__.EntityType.TASK\n            ],\n            target: [\n                _types_enums__WEBPACK_IMPORTED_MODULE_0__.EntityType.SITE\n            ]\n        },\n        // ITEM relationships (6)\n        \"ITEM_TASK\": {\n            source: [\n                _types_enums__WEBPACK_IMPORTED_MODULE_0__.EntityType.ITEM\n            ],\n            target: [\n                _types_enums__WEBPACK_IMPORTED_MODULE_0__.EntityType.TASK\n            ]\n        },\n        \"ITEM_SALE\": {\n            source: [\n                _types_enums__WEBPACK_IMPORTED_MODULE_0__.EntityType.ITEM\n            ],\n            target: [\n                _types_enums__WEBPACK_IMPORTED_MODULE_0__.EntityType.SALE\n            ]\n        },\n        \"ITEM_FINREC\": {\n            source: [\n                _types_enums__WEBPACK_IMPORTED_MODULE_0__.EntityType.ITEM\n            ],\n            target: [\n                _types_enums__WEBPACK_IMPORTED_MODULE_0__.EntityType.FINANCIAL\n            ]\n        },\n        \"ITEM_PLAYER\": {\n            source: [\n                _types_enums__WEBPACK_IMPORTED_MODULE_0__.EntityType.ITEM\n            ],\n            target: [\n                _types_enums__WEBPACK_IMPORTED_MODULE_0__.EntityType.PLAYER\n            ]\n        },\n        \"ITEM_CHARACTER\": {\n            source: [\n                _types_enums__WEBPACK_IMPORTED_MODULE_0__.EntityType.ITEM\n            ],\n            target: [\n                _types_enums__WEBPACK_IMPORTED_MODULE_0__.EntityType.CHARACTER\n            ]\n        },\n        \"ITEM_SITE\": {\n            source: [\n                _types_enums__WEBPACK_IMPORTED_MODULE_0__.EntityType.ITEM\n            ],\n            target: [\n                _types_enums__WEBPACK_IMPORTED_MODULE_0__.EntityType.SITE\n            ]\n        },\n        // SALE relationships (6)\n        \"SALE_TASK\": {\n            source: [\n                _types_enums__WEBPACK_IMPORTED_MODULE_0__.EntityType.SALE\n            ],\n            target: [\n                _types_enums__WEBPACK_IMPORTED_MODULE_0__.EntityType.TASK\n            ]\n        },\n        \"SALE_ITEM\": {\n            source: [\n                _types_enums__WEBPACK_IMPORTED_MODULE_0__.EntityType.SALE\n            ],\n            target: [\n                _types_enums__WEBPACK_IMPORTED_MODULE_0__.EntityType.ITEM\n            ]\n        },\n        \"SALE_FINREC\": {\n            source: [\n                _types_enums__WEBPACK_IMPORTED_MODULE_0__.EntityType.SALE\n            ],\n            target: [\n                _types_enums__WEBPACK_IMPORTED_MODULE_0__.EntityType.FINANCIAL\n            ]\n        },\n        \"SALE_PLAYER\": {\n            source: [\n                _types_enums__WEBPACK_IMPORTED_MODULE_0__.EntityType.SALE\n            ],\n            target: [\n                _types_enums__WEBPACK_IMPORTED_MODULE_0__.EntityType.PLAYER\n            ]\n        },\n        \"SALE_CHARACTER\": {\n            source: [\n                _types_enums__WEBPACK_IMPORTED_MODULE_0__.EntityType.SALE\n            ],\n            target: [\n                _types_enums__WEBPACK_IMPORTED_MODULE_0__.EntityType.CHARACTER\n            ]\n        },\n        \"SALE_SITE\": {\n            source: [\n                _types_enums__WEBPACK_IMPORTED_MODULE_0__.EntityType.SALE\n            ],\n            target: [\n                _types_enums__WEBPACK_IMPORTED_MODULE_0__.EntityType.SITE\n            ]\n        },\n        // FINANCIAL RECORD relationships (6)\n        \"FINREC_TASK\": {\n            source: [\n                _types_enums__WEBPACK_IMPORTED_MODULE_0__.EntityType.FINANCIAL\n            ],\n            target: [\n                _types_enums__WEBPACK_IMPORTED_MODULE_0__.EntityType.TASK\n            ]\n        },\n        \"FINREC_ITEM\": {\n            source: [\n                _types_enums__WEBPACK_IMPORTED_MODULE_0__.EntityType.FINANCIAL\n            ],\n            target: [\n                _types_enums__WEBPACK_IMPORTED_MODULE_0__.EntityType.ITEM\n            ]\n        },\n        \"FINREC_SALE\": {\n            source: [\n                _types_enums__WEBPACK_IMPORTED_MODULE_0__.EntityType.FINANCIAL\n            ],\n            target: [\n                _types_enums__WEBPACK_IMPORTED_MODULE_0__.EntityType.SALE\n            ]\n        },\n        \"FINREC_PLAYER\": {\n            source: [\n                _types_enums__WEBPACK_IMPORTED_MODULE_0__.EntityType.FINANCIAL\n            ],\n            target: [\n                _types_enums__WEBPACK_IMPORTED_MODULE_0__.EntityType.PLAYER\n            ]\n        },\n        \"FINREC_CHARACTER\": {\n            source: [\n                _types_enums__WEBPACK_IMPORTED_MODULE_0__.EntityType.FINANCIAL\n            ],\n            target: [\n                _types_enums__WEBPACK_IMPORTED_MODULE_0__.EntityType.CHARACTER\n            ]\n        },\n        \"FINREC_SITE\": {\n            source: [\n                _types_enums__WEBPACK_IMPORTED_MODULE_0__.EntityType.FINANCIAL\n            ],\n            target: [\n                _types_enums__WEBPACK_IMPORTED_MODULE_0__.EntityType.SITE\n            ]\n        },\n        // CHARACTER relationships (6)\n        \"CHARACTER_TASK\": {\n            source: [\n                _types_enums__WEBPACK_IMPORTED_MODULE_0__.EntityType.CHARACTER\n            ],\n            target: [\n                _types_enums__WEBPACK_IMPORTED_MODULE_0__.EntityType.TASK\n            ]\n        },\n        \"CHARACTER_ITEM\": {\n            source: [\n                _types_enums__WEBPACK_IMPORTED_MODULE_0__.EntityType.CHARACTER\n            ],\n            target: [\n                _types_enums__WEBPACK_IMPORTED_MODULE_0__.EntityType.ITEM\n            ]\n        },\n        \"CHARACTER_SALE\": {\n            source: [\n                _types_enums__WEBPACK_IMPORTED_MODULE_0__.EntityType.CHARACTER\n            ],\n            target: [\n                _types_enums__WEBPACK_IMPORTED_MODULE_0__.EntityType.SALE\n            ]\n        },\n        \"CHARACTER_FINREC\": {\n            source: [\n                _types_enums__WEBPACK_IMPORTED_MODULE_0__.EntityType.CHARACTER\n            ],\n            target: [\n                _types_enums__WEBPACK_IMPORTED_MODULE_0__.EntityType.FINANCIAL\n            ]\n        },\n        \"CHARACTER_SITE\": {\n            source: [\n                _types_enums__WEBPACK_IMPORTED_MODULE_0__.EntityType.CHARACTER\n            ],\n            target: [\n                _types_enums__WEBPACK_IMPORTED_MODULE_0__.EntityType.SITE\n            ]\n        },\n        \"CHARACTER_PLAYER\": {\n            source: [\n                _types_enums__WEBPACK_IMPORTED_MODULE_0__.EntityType.CHARACTER\n            ],\n            target: [\n                _types_enums__WEBPACK_IMPORTED_MODULE_0__.EntityType.PLAYER\n            ]\n        },\n        // SITE relationships (6)\n        \"SITE_TASK\": {\n            source: [\n                _types_enums__WEBPACK_IMPORTED_MODULE_0__.EntityType.SITE\n            ],\n            target: [\n                _types_enums__WEBPACK_IMPORTED_MODULE_0__.EntityType.TASK\n            ]\n        },\n        \"SITE_CHARACTER\": {\n            source: [\n                _types_enums__WEBPACK_IMPORTED_MODULE_0__.EntityType.SITE\n            ],\n            target: [\n                _types_enums__WEBPACK_IMPORTED_MODULE_0__.EntityType.CHARACTER\n            ]\n        },\n        \"SITE_FINREC\": {\n            source: [\n                _types_enums__WEBPACK_IMPORTED_MODULE_0__.EntityType.SITE\n            ],\n            target: [\n                _types_enums__WEBPACK_IMPORTED_MODULE_0__.EntityType.FINANCIAL\n            ]\n        },\n        \"SITE_ITEM\": {\n            source: [\n                _types_enums__WEBPACK_IMPORTED_MODULE_0__.EntityType.SITE\n            ],\n            target: [\n                _types_enums__WEBPACK_IMPORTED_MODULE_0__.EntityType.ITEM\n            ]\n        },\n        \"SITE_SALE\": {\n            source: [\n                _types_enums__WEBPACK_IMPORTED_MODULE_0__.EntityType.SITE\n            ],\n            target: [\n                _types_enums__WEBPACK_IMPORTED_MODULE_0__.EntityType.SALE\n            ]\n        },\n        \"SITE_SITE\": {\n            source: [\n                _types_enums__WEBPACK_IMPORTED_MODULE_0__.EntityType.SITE\n            ],\n            target: [\n                _types_enums__WEBPACK_IMPORTED_MODULE_0__.EntityType.SITE\n            ]\n        },\n        // PLAYER relationships (5)\n        \"PLAYER_TASK\": {\n            source: [\n                _types_enums__WEBPACK_IMPORTED_MODULE_0__.EntityType.PLAYER\n            ],\n            target: [\n                _types_enums__WEBPACK_IMPORTED_MODULE_0__.EntityType.TASK\n            ]\n        },\n        \"PLAYER_SALE\": {\n            source: [\n                _types_enums__WEBPACK_IMPORTED_MODULE_0__.EntityType.PLAYER\n            ],\n            target: [\n                _types_enums__WEBPACK_IMPORTED_MODULE_0__.EntityType.SALE\n            ]\n        },\n        \"PLAYER_FINREC\": {\n            source: [\n                _types_enums__WEBPACK_IMPORTED_MODULE_0__.EntityType.PLAYER\n            ],\n            target: [\n                _types_enums__WEBPACK_IMPORTED_MODULE_0__.EntityType.FINANCIAL\n            ]\n        },\n        \"PLAYER_ITEM\": {\n            source: [\n                _types_enums__WEBPACK_IMPORTED_MODULE_0__.EntityType.PLAYER\n            ],\n            target: [\n                _types_enums__WEBPACK_IMPORTED_MODULE_0__.EntityType.ITEM\n            ]\n        },\n        \"PLAYER_CHARACTER\": {\n            source: [\n                _types_enums__WEBPACK_IMPORTED_MODULE_0__.EntityType.PLAYER\n            ],\n            target: [\n                _types_enums__WEBPACK_IMPORTED_MODULE_0__.EntityType.CHARACTER\n            ]\n        },\n        // ACCOUNT relationships (4)\n        \"ACCOUNT_PLAYER\": {\n            source: [\n                _types_enums__WEBPACK_IMPORTED_MODULE_0__.EntityType.ACCOUNT\n            ],\n            target: [\n                _types_enums__WEBPACK_IMPORTED_MODULE_0__.EntityType.PLAYER\n            ]\n        },\n        \"ACCOUNT_CHARACTER\": {\n            source: [\n                _types_enums__WEBPACK_IMPORTED_MODULE_0__.EntityType.ACCOUNT\n            ],\n            target: [\n                _types_enums__WEBPACK_IMPORTED_MODULE_0__.EntityType.CHARACTER\n            ]\n        },\n        \"PLAYER_ACCOUNT\": {\n            source: [\n                _types_enums__WEBPACK_IMPORTED_MODULE_0__.EntityType.PLAYER\n            ],\n            target: [\n                _types_enums__WEBPACK_IMPORTED_MODULE_0__.EntityType.ACCOUNT\n            ]\n        },\n        \"CHARACTER_ACCOUNT\": {\n            source: [\n                _types_enums__WEBPACK_IMPORTED_MODULE_0__.EntityType.CHARACTER\n            ],\n            target: [\n                _types_enums__WEBPACK_IMPORTED_MODULE_0__.EntityType.ACCOUNT\n            ]\n        }\n    };\n    const combination = validCombinations[linkType];\n    if (!combination) {\n        return {\n            isValid: false,\n            reason: \"Unknown link type: \".concat(linkType)\n        };\n    }\n    if (!combination.source.includes(sourceType)) {\n        return {\n            isValid: false,\n            reason: \"Invalid source type for \".concat(linkType, \": \").concat(sourceType, \". Valid sources: \").concat(combination.source.join(\", \"))\n        };\n    }\n    if (!combination.target.includes(targetType)) {\n        return {\n            isValid: false,\n            reason: \"Invalid target type for \".concat(linkType, \": \").concat(targetType, \". Valid targets: \").concat(combination.target.join(\", \"))\n        };\n    }\n    return {\n        isValid: true\n    };\n}\n/**\r\n * Validate that entity exists in the system\r\n */ async function validateEntityExists(entityType, entityId) {\n    try {\n        switch(entityType){\n            case _types_enums__WEBPACK_IMPORTED_MODULE_0__.EntityType.TASK:\n                const tasks = await (0,_data_store_datastore__WEBPACK_IMPORTED_MODULE_1__.getAllTasks)();\n                const task = tasks.find((t)=>t.id === entityId);\n                return !!task;\n            case _types_enums__WEBPACK_IMPORTED_MODULE_0__.EntityType.ITEM:\n                const items = await (0,_data_store_datastore__WEBPACK_IMPORTED_MODULE_1__.getAllItems)();\n                const item = items.find((i)=>i.id === entityId);\n                return !!item;\n            case _types_enums__WEBPACK_IMPORTED_MODULE_0__.EntityType.FINANCIAL:\n                const financialRecords = await (0,_data_store_datastore__WEBPACK_IMPORTED_MODULE_1__.getAllFinancials)();\n                const financial = financialRecords.find((f)=>f.id === entityId);\n                return !!financial;\n            case _types_enums__WEBPACK_IMPORTED_MODULE_0__.EntityType.SALE:\n                const sales = await (0,_data_store_datastore__WEBPACK_IMPORTED_MODULE_1__.getAllSales)();\n                const sale = sales.find((s)=>s.id === entityId);\n                return !!sale;\n            case _types_enums__WEBPACK_IMPORTED_MODULE_0__.EntityType.CHARACTER:\n                const characters = await (0,_data_store_datastore__WEBPACK_IMPORTED_MODULE_1__.getAllCharacters)();\n                const character = characters.find((c)=>c.id === entityId);\n                return !!character;\n            case _types_enums__WEBPACK_IMPORTED_MODULE_0__.EntityType.PLAYER:\n                const players = await (0,_data_store_datastore__WEBPACK_IMPORTED_MODULE_1__.getAllPlayers)();\n                const player = players.find((p)=>p.id === entityId);\n                return !!player;\n            case _types_enums__WEBPACK_IMPORTED_MODULE_0__.EntityType.SITE:\n                const sites = await (0,_data_store_datastore__WEBPACK_IMPORTED_MODULE_1__.getAllSites)();\n                const site = sites.find((s)=>s.id === entityId);\n                return !!site;\n            case _types_enums__WEBPACK_IMPORTED_MODULE_0__.EntityType.ACCOUNT:\n                // Account entity not implemented in current datastore\n                return false;\n            default:\n                console.warn(\"[validateEntityExists] Unknown entity type: \".concat(entityType));\n                return false;\n        }\n    } catch (error) {\n        console.error(\"[validateEntityExists] Error validating entity \".concat(entityType, \":\").concat(entityId, \":\"), error);\n        return false;\n    }\n}\n/**\r\n * Validate business rules specific to link types\r\n */ async function validateBusinessRules(linkType, source, target, metadata) {\n    const warnings = [];\n    try {\n        switch(linkType){\n            case \"PLAYER_CHARACTER\":\n                // Validate that character has valid playerId\n                const characters = await (0,_data_store_datastore__WEBPACK_IMPORTED_MODULE_1__.getAllCharacters)();\n                const character = characters.find((c)=>c.id === source.id);\n                if (character && character.playerId !== target.id) {\n                    warnings.push(\"Character playerId (\".concat(character.playerId, \") does not match target player ID (\").concat(target.id, \")\"));\n                }\n                break;\n            case \"TASK_SITE\":\n                // Validate that task has valid siteId\n                const tasks = await (0,_data_store_datastore__WEBPACK_IMPORTED_MODULE_1__.getAllTasks)();\n                const task = tasks.find((t)=>t.id === source.id);\n                if (task && task.siteId !== target.id) {\n                    warnings.push(\"Task siteId (\".concat(task.siteId, \") does not match target site ID (\").concat(target.id, \")\"));\n                }\n                break;\n            case \"ITEM_SITE\":\n                // Validate item stock location\n                const items = await (0,_data_store_datastore__WEBPACK_IMPORTED_MODULE_1__.getAllItems)();\n                const item = items.find((i)=>i.id === source.id);\n                if (item && item.stock) {\n                    const hasStockAtSite = item.stock.some((stock)=>stock.siteId === target.id);\n                    if (!hasStockAtSite) {\n                        warnings.push(\"Item does not have stock at target site: \".concat(target.id));\n                    }\n                }\n                break;\n            case \"SALE_ITEM\":\n                // Validate sale contains the item\n                const sales = await (0,_data_store_datastore__WEBPACK_IMPORTED_MODULE_1__.getAllSales)();\n                const sale = sales.find((s)=>s.id === source.id);\n                if (sale && sale.lines) {\n                    const hasItemInSale = sale.lines.some((line)=>line.kind === \"item\" && line.itemId === target.id);\n                    if (!hasItemInSale) {\n                        warnings.push(\"Sale does not contain target item: \".concat(target.id));\n                    }\n                }\n                break;\n            case \"CHARACTER_PLAYER\":\n                // Validate that character belongs to the player\n                const charForPlayer = await (0,_data_store_datastore__WEBPACK_IMPORTED_MODULE_1__.getAllCharacters)();\n                const char = charForPlayer.find((c)=>c.id === source.id);\n                if (char && char.playerId !== target.id) {\n                    warnings.push(\"Character playerId (\".concat(char.playerId, \") does not match target player ID (\").concat(target.id, \")\"));\n                }\n                break;\n            case \"SALE_CHARACTER\":\n                // Validate that character is the customer\n                const saleForChar = await (0,_data_store_datastore__WEBPACK_IMPORTED_MODULE_1__.getAllSales)();\n                const saleWithChar = saleForChar.find((s)=>s.id === source.id);\n                if (saleWithChar && saleWithChar.customerId !== target.id) {\n                    warnings.push(\"Sale customerId (\".concat(saleWithChar.customerId, \") does not match target character ID (\").concat(target.id, \")\"));\n                }\n                break;\n            // Add more business rule validations as needed\n            default:\n                break;\n        }\n        return {\n            isValid: true,\n            warnings: warnings.length > 0 ? warnings : undefined\n        };\n    } catch (error) {\n        return {\n            isValid: false,\n            reason: \"Business rules validation error: \".concat(error instanceof Error ? error.message : \"Unknown error\")\n        };\n    }\n}\n\n\n;\n    // Wrapped in an IIFE to avoid polluting the global scope\n    ;\n    (function () {\n        var _a, _b;\n        // Legacy CSS implementations will `eval` browser code in a Node.js context\n        // to extract CSS. For backwards compatibility, we need to check we're in a\n        // browser context before continuing.\n        if (typeof self !== 'undefined' &&\n            // AMP / No-JS mode does not inject these helpers:\n            '$RefreshHelpers$' in self) {\n            // @ts-ignore __webpack_module__ is global\n            var currentExports = module.exports;\n            // @ts-ignore __webpack_module__ is global\n            var prevSignature = (_b = (_a = module.hot.data) === null || _a === void 0 ? void 0 : _a.prevSignature) !== null && _b !== void 0 ? _b : null;\n            // This cannot happen in MainTemplate because the exports mismatch between\n            // templating and execution.\n            self.$RefreshHelpers$.registerExportsForReactRefresh(currentExports, module.id);\n            // A module can be accepted automatically based on its exports, e.g. when\n            // it is a Refresh Boundary.\n            if (self.$RefreshHelpers$.isReactRefreshBoundary(currentExports)) {\n                // Save the previous exports signature on update so we can compare the boundary\n                // signatures. We avoid saving exports themselves since it causes memory leaks (https://github.com/vercel/next.js/pull/53797)\n                module.hot.dispose(function (data) {\n                    data.prevSignature =\n                        self.$RefreshHelpers$.getRefreshBoundarySignature(currentExports);\n                });\n                // Unconditionally accept an update to this module, we'll check if it's\n                // still a Refresh Boundary later.\n                // @ts-ignore importMeta is replaced in the loader\n                module.hot.accept();\n                // This field is set when the previous version of this module was a\n                // Refresh Boundary, letting us know we need to check for invalidation or\n                // enqueue an update.\n                if (prevSignature !== null) {\n                    // A boundary can become ineligible if its exports are incompatible\n                    // with the previous exports.\n                    //\n                    // For example, if you add/remove/change exports, we'll want to\n                    // re-execute the importing modules, and force those components to\n                    // re-render. Similarly, if you convert a class component to a\n                    // function, we want to invalidate the boundary.\n                    if (self.$RefreshHelpers$.shouldInvalidateReactRefreshBoundary(prevSignature, self.$RefreshHelpers$.getRefreshBoundarySignature(currentExports))) {\n                        module.hot.invalidate();\n                    }\n                    else {\n                        self.$RefreshHelpers$.scheduleUpdate();\n                    }\n                }\n            }\n            else {\n                // Since we just executed the code for the module, it's possible that the\n                // new exports made it ineligible for being a boundary.\n                // We only care about the case when we were _previously_ a boundary,\n                // because we already accepted this update (accidental side effect).\n                var isNoLongerABoundary = prevSignature !== null;\n                if (isNoLongerABoundary) {\n                    module.hot.invalidate();\n                }\n            }\n        }\n    })();\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFwcC1wYWdlcy1icm93c2VyKS8uL2xpbmtzL2xpbmstdmFsaWRhdGlvbi50cyIsIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7QUFBQSwyQkFBMkI7QUFDM0IsK0NBQStDO0FBQy9DLDJEQUEyRDtBQUVOO0FBU3JCO0FBV2hDOzs7Q0FHQyxHQUNNLGVBQWVRLGFBQ3BCQyxRQUFrQixFQUNsQkMsTUFBd0MsRUFDeENDLE1BQXdDLEVBQ3hDQyxRQUE4QjtJQUU5QixNQUFNQyxXQUFxQixFQUFFO0lBRTdCLElBQUk7UUFDRixzQkFBc0I7UUFDdEIsSUFBSSxDQUFDSixZQUFZLEVBQUNDLG1CQUFBQSw2QkFBQUEsT0FBUUksSUFBSSxLQUFJLEVBQUNKLG1CQUFBQSw2QkFBQUEsT0FBUUssRUFBRSxLQUFJLEVBQUNKLG1CQUFBQSw2QkFBQUEsT0FBUUcsSUFBSSxLQUFJLEVBQUNILG1CQUFBQSw2QkFBQUEsT0FBUUksRUFBRSxHQUFFO1lBQzdFLE9BQU87Z0JBQ0xDLFNBQVM7Z0JBQ1RDLFFBQVE7WUFDVjtRQUNGO1FBRUEsK0JBQStCO1FBQy9CLElBQUlQLE9BQU9JLElBQUksS0FBS0gsT0FBT0csSUFBSSxJQUFJSixPQUFPSyxFQUFFLEtBQUtKLE9BQU9JLEVBQUUsRUFBRTtZQUMxRCxPQUFPO2dCQUNMQyxTQUFTO2dCQUNUQyxRQUFRO1lBQ1Y7UUFDRjtRQUVBLHdDQUF3QztRQUN4QyxNQUFNQyxzQkFBc0JDLDhCQUE4QlYsVUFBVUMsT0FBT0ksSUFBSSxFQUFFSCxPQUFPRyxJQUFJO1FBQzVGLElBQUksQ0FBQ0ksb0JBQW9CRixPQUFPLEVBQUU7WUFDaEMsT0FBTztnQkFDTEEsU0FBUztnQkFDVEMsUUFBUSwyQkFBc0RQLE9BQTNCRCxVQUFTLG9CQUFvQ0UsT0FBbEJELE9BQU9JLElBQUksRUFBQyxRQUFzQkksT0FBaEJQLE9BQU9HLElBQUksRUFBQyxNQUErQixPQUEzQkksb0JBQW9CRCxNQUFNO1lBQzVIO1FBQ0Y7UUFFQSxpQ0FBaUM7UUFDakMsTUFBTUcsZUFBZSxNQUFNQyxxQkFBcUJYLE9BQU9JLElBQUksRUFBRUosT0FBT0ssRUFBRTtRQUN0RSxJQUFJLENBQUNLLGNBQWM7WUFDakIsT0FBTztnQkFDTEosU0FBUztnQkFDVEMsUUFBUSxpQ0FBZ0RQLE9BQWZBLE9BQU9JLElBQUksRUFBQyxLQUFhLE9BQVZKLE9BQU9LLEVBQUU7WUFDbkU7UUFDRjtRQUVBLE1BQU1PLGVBQWUsTUFBTUQscUJBQXFCVixPQUFPRyxJQUFJLEVBQUVILE9BQU9JLEVBQUU7UUFDdEUsSUFBSSxDQUFDTyxjQUFjO1lBQ2pCLE9BQU87Z0JBQ0xOLFNBQVM7Z0JBQ1RDLFFBQVEsaUNBQWdETixPQUFmQSxPQUFPRyxJQUFJLEVBQUMsS0FBYSxPQUFWSCxPQUFPSSxFQUFFO1lBQ25FO1FBQ0Y7UUFFQSwrQkFBK0I7UUFDL0IsTUFBTVEsc0JBQXNCLE1BQU1DLHNCQUFzQmYsVUFBVUMsUUFBUUMsUUFBUUM7UUFDbEYsSUFBSSxDQUFDVyxvQkFBb0JQLE9BQU8sRUFBRTtZQUNoQyxPQUFPO2dCQUNMQSxTQUFTO2dCQUNUQyxRQUFRTSxvQkFBb0JOLE1BQU07WUFDcEM7UUFDRjtRQUVBLHVDQUF1QztRQUN2QyxJQUFJTSxvQkFBb0JWLFFBQVEsRUFBRTtZQUNoQ0EsU0FBU1ksSUFBSSxJQUFJRixvQkFBb0JWLFFBQVE7UUFDL0M7UUFFQSxPQUFPO1lBQ0xHLFNBQVM7WUFDVEgsVUFBVUEsU0FBU2EsTUFBTSxHQUFHLElBQUliLFdBQVdjO1FBQzdDO0lBRUYsRUFBRSxPQUFPQyxPQUFPO1FBQ2QsT0FBTztZQUNMWixTQUFTO1lBQ1RDLFFBQVEscUJBQThFLE9BQXpEVyxpQkFBaUJDLFFBQVFELE1BQU1FLE9BQU8sR0FBRztRQUN4RTtJQUNGO0FBQ0Y7QUFFQTs7O0NBR0MsR0FDTSxTQUFTWCw4QkFDZFYsUUFBa0IsRUFDbEJzQixVQUFzQixFQUN0QkMsVUFBc0I7SUFFdEIsNERBQTREO0lBQzVELE1BQU1DLG9CQUFzRjtRQUMxRix5QkFBeUI7UUFDekIsYUFBYTtZQUFFdkIsUUFBUTtnQkFBQ1Ysb0RBQVVBLENBQUNrQyxJQUFJO2FBQUM7WUFBRXZCLFFBQVE7Z0JBQUNYLG9EQUFVQSxDQUFDbUMsSUFBSTthQUFDO1FBQUM7UUFDcEUsZUFBZTtZQUFFekIsUUFBUTtnQkFBQ1Ysb0RBQVVBLENBQUNrQyxJQUFJO2FBQUM7WUFBRXZCLFFBQVE7Z0JBQUNYLG9EQUFVQSxDQUFDb0MsU0FBUzthQUFDO1FBQUM7UUFDM0UsYUFBYTtZQUFFMUIsUUFBUTtnQkFBQ1Ysb0RBQVVBLENBQUNrQyxJQUFJO2FBQUM7WUFBRXZCLFFBQVE7Z0JBQUNYLG9EQUFVQSxDQUFDcUMsSUFBSTthQUFDO1FBQUM7UUFDcEUsZUFBZTtZQUFFM0IsUUFBUTtnQkFBQ1Ysb0RBQVVBLENBQUNrQyxJQUFJO2FBQUM7WUFBRXZCLFFBQVE7Z0JBQUNYLG9EQUFVQSxDQUFDc0MsTUFBTTthQUFDO1FBQUM7UUFDeEUsa0JBQWtCO1lBQUU1QixRQUFRO2dCQUFDVixvREFBVUEsQ0FBQ2tDLElBQUk7YUFBQztZQUFFdkIsUUFBUTtnQkFBQ1gsb0RBQVVBLENBQUN1QyxTQUFTO2FBQUM7UUFBQztRQUM5RSxhQUFhO1lBQUU3QixRQUFRO2dCQUFDVixvREFBVUEsQ0FBQ2tDLElBQUk7YUFBQztZQUFFdkIsUUFBUTtnQkFBQ1gsb0RBQVVBLENBQUN3QyxJQUFJO2FBQUM7UUFBQztRQUVwRSx5QkFBeUI7UUFDekIsYUFBYTtZQUFFOUIsUUFBUTtnQkFBQ1Ysb0RBQVVBLENBQUNtQyxJQUFJO2FBQUM7WUFBRXhCLFFBQVE7Z0JBQUNYLG9EQUFVQSxDQUFDa0MsSUFBSTthQUFDO1FBQUM7UUFDcEUsYUFBYTtZQUFFeEIsUUFBUTtnQkFBQ1Ysb0RBQVVBLENBQUNtQyxJQUFJO2FBQUM7WUFBRXhCLFFBQVE7Z0JBQUNYLG9EQUFVQSxDQUFDcUMsSUFBSTthQUFDO1FBQUM7UUFDcEUsZUFBZTtZQUFFM0IsUUFBUTtnQkFBQ1Ysb0RBQVVBLENBQUNtQyxJQUFJO2FBQUM7WUFBRXhCLFFBQVE7Z0JBQUNYLG9EQUFVQSxDQUFDb0MsU0FBUzthQUFDO1FBQUM7UUFDM0UsZUFBZTtZQUFFMUIsUUFBUTtnQkFBQ1Ysb0RBQVVBLENBQUNtQyxJQUFJO2FBQUM7WUFBRXhCLFFBQVE7Z0JBQUNYLG9EQUFVQSxDQUFDc0MsTUFBTTthQUFDO1FBQUM7UUFDeEUsa0JBQWtCO1lBQUU1QixRQUFRO2dCQUFDVixvREFBVUEsQ0FBQ21DLElBQUk7YUFBQztZQUFFeEIsUUFBUTtnQkFBQ1gsb0RBQVVBLENBQUN1QyxTQUFTO2FBQUM7UUFBQztRQUM5RSxhQUFhO1lBQUU3QixRQUFRO2dCQUFDVixvREFBVUEsQ0FBQ21DLElBQUk7YUFBQztZQUFFeEIsUUFBUTtnQkFBQ1gsb0RBQVVBLENBQUN3QyxJQUFJO2FBQUM7UUFBQztRQUVwRSx5QkFBeUI7UUFDekIsYUFBYTtZQUFFOUIsUUFBUTtnQkFBQ1Ysb0RBQVVBLENBQUNxQyxJQUFJO2FBQUM7WUFBRTFCLFFBQVE7Z0JBQUNYLG9EQUFVQSxDQUFDa0MsSUFBSTthQUFDO1FBQUM7UUFDcEUsYUFBYTtZQUFFeEIsUUFBUTtnQkFBQ1Ysb0RBQVVBLENBQUNxQyxJQUFJO2FBQUM7WUFBRTFCLFFBQVE7Z0JBQUNYLG9EQUFVQSxDQUFDbUMsSUFBSTthQUFDO1FBQUM7UUFDcEUsZUFBZTtZQUFFekIsUUFBUTtnQkFBQ1Ysb0RBQVVBLENBQUNxQyxJQUFJO2FBQUM7WUFBRTFCLFFBQVE7Z0JBQUNYLG9EQUFVQSxDQUFDb0MsU0FBUzthQUFDO1FBQUM7UUFDM0UsZUFBZTtZQUFFMUIsUUFBUTtnQkFBQ1Ysb0RBQVVBLENBQUNxQyxJQUFJO2FBQUM7WUFBRTFCLFFBQVE7Z0JBQUNYLG9EQUFVQSxDQUFDc0MsTUFBTTthQUFDO1FBQUM7UUFDeEUsa0JBQWtCO1lBQUU1QixRQUFRO2dCQUFDVixvREFBVUEsQ0FBQ3FDLElBQUk7YUFBQztZQUFFMUIsUUFBUTtnQkFBQ1gsb0RBQVVBLENBQUN1QyxTQUFTO2FBQUM7UUFBQztRQUM5RSxhQUFhO1lBQUU3QixRQUFRO2dCQUFDVixvREFBVUEsQ0FBQ3FDLElBQUk7YUFBQztZQUFFMUIsUUFBUTtnQkFBQ1gsb0RBQVVBLENBQUN3QyxJQUFJO2FBQUM7UUFBQztRQUVwRSxxQ0FBcUM7UUFDckMsZUFBZTtZQUFFOUIsUUFBUTtnQkFBQ1Ysb0RBQVVBLENBQUNvQyxTQUFTO2FBQUM7WUFBRXpCLFFBQVE7Z0JBQUNYLG9EQUFVQSxDQUFDa0MsSUFBSTthQUFDO1FBQUM7UUFDM0UsZUFBZTtZQUFFeEIsUUFBUTtnQkFBQ1Ysb0RBQVVBLENBQUNvQyxTQUFTO2FBQUM7WUFBRXpCLFFBQVE7Z0JBQUNYLG9EQUFVQSxDQUFDbUMsSUFBSTthQUFDO1FBQUM7UUFDM0UsZUFBZTtZQUFFekIsUUFBUTtnQkFBQ1Ysb0RBQVVBLENBQUNvQyxTQUFTO2FBQUM7WUFBRXpCLFFBQVE7Z0JBQUNYLG9EQUFVQSxDQUFDcUMsSUFBSTthQUFDO1FBQUM7UUFDM0UsaUJBQWlCO1lBQUUzQixRQUFRO2dCQUFDVixvREFBVUEsQ0FBQ29DLFNBQVM7YUFBQztZQUFFekIsUUFBUTtnQkFBQ1gsb0RBQVVBLENBQUNzQyxNQUFNO2FBQUM7UUFBQztRQUMvRSxvQkFBb0I7WUFBRTVCLFFBQVE7Z0JBQUNWLG9EQUFVQSxDQUFDb0MsU0FBUzthQUFDO1lBQUV6QixRQUFRO2dCQUFDWCxvREFBVUEsQ0FBQ3VDLFNBQVM7YUFBQztRQUFDO1FBQ3JGLGVBQWU7WUFBRTdCLFFBQVE7Z0JBQUNWLG9EQUFVQSxDQUFDb0MsU0FBUzthQUFDO1lBQUV6QixRQUFRO2dCQUFDWCxvREFBVUEsQ0FBQ3dDLElBQUk7YUFBQztRQUFDO1FBRTNFLDhCQUE4QjtRQUM5QixrQkFBa0I7WUFBRTlCLFFBQVE7Z0JBQUNWLG9EQUFVQSxDQUFDdUMsU0FBUzthQUFDO1lBQUU1QixRQUFRO2dCQUFDWCxvREFBVUEsQ0FBQ2tDLElBQUk7YUFBQztRQUFDO1FBQzlFLGtCQUFrQjtZQUFFeEIsUUFBUTtnQkFBQ1Ysb0RBQVVBLENBQUN1QyxTQUFTO2FBQUM7WUFBRTVCLFFBQVE7Z0JBQUNYLG9EQUFVQSxDQUFDbUMsSUFBSTthQUFDO1FBQUM7UUFDOUUsa0JBQWtCO1lBQUV6QixRQUFRO2dCQUFDVixvREFBVUEsQ0FBQ3VDLFNBQVM7YUFBQztZQUFFNUIsUUFBUTtnQkFBQ1gsb0RBQVVBLENBQUNxQyxJQUFJO2FBQUM7UUFBQztRQUM5RSxvQkFBb0I7WUFBRTNCLFFBQVE7Z0JBQUNWLG9EQUFVQSxDQUFDdUMsU0FBUzthQUFDO1lBQUU1QixRQUFRO2dCQUFDWCxvREFBVUEsQ0FBQ29DLFNBQVM7YUFBQztRQUFDO1FBQ3JGLGtCQUFrQjtZQUFFMUIsUUFBUTtnQkFBQ1Ysb0RBQVVBLENBQUN1QyxTQUFTO2FBQUM7WUFBRTVCLFFBQVE7Z0JBQUNYLG9EQUFVQSxDQUFDd0MsSUFBSTthQUFDO1FBQUM7UUFDOUUsb0JBQW9CO1lBQUU5QixRQUFRO2dCQUFDVixvREFBVUEsQ0FBQ3VDLFNBQVM7YUFBQztZQUFFNUIsUUFBUTtnQkFBQ1gsb0RBQVVBLENBQUNzQyxNQUFNO2FBQUM7UUFBQztRQUVsRix5QkFBeUI7UUFDekIsYUFBYTtZQUFFNUIsUUFBUTtnQkFBQ1Ysb0RBQVVBLENBQUN3QyxJQUFJO2FBQUM7WUFBRTdCLFFBQVE7Z0JBQUNYLG9EQUFVQSxDQUFDa0MsSUFBSTthQUFDO1FBQUM7UUFDcEUsa0JBQWtCO1lBQUV4QixRQUFRO2dCQUFDVixvREFBVUEsQ0FBQ3dDLElBQUk7YUFBQztZQUFFN0IsUUFBUTtnQkFBQ1gsb0RBQVVBLENBQUN1QyxTQUFTO2FBQUM7UUFBQztRQUM5RSxlQUFlO1lBQUU3QixRQUFRO2dCQUFDVixvREFBVUEsQ0FBQ3dDLElBQUk7YUFBQztZQUFFN0IsUUFBUTtnQkFBQ1gsb0RBQVVBLENBQUNvQyxTQUFTO2FBQUM7UUFBQztRQUMzRSxhQUFhO1lBQUUxQixRQUFRO2dCQUFDVixvREFBVUEsQ0FBQ3dDLElBQUk7YUFBQztZQUFFN0IsUUFBUTtnQkFBQ1gsb0RBQVVBLENBQUNtQyxJQUFJO2FBQUM7UUFBQztRQUNwRSxhQUFhO1lBQUV6QixRQUFRO2dCQUFDVixvREFBVUEsQ0FBQ3dDLElBQUk7YUFBQztZQUFFN0IsUUFBUTtnQkFBQ1gsb0RBQVVBLENBQUNxQyxJQUFJO2FBQUM7UUFBQztRQUNwRSxhQUFhO1lBQUUzQixRQUFRO2dCQUFDVixvREFBVUEsQ0FBQ3dDLElBQUk7YUFBQztZQUFFN0IsUUFBUTtnQkFBQ1gsb0RBQVVBLENBQUN3QyxJQUFJO2FBQUM7UUFBQztRQUVwRSwyQkFBMkI7UUFDM0IsZUFBZTtZQUFFOUIsUUFBUTtnQkFBQ1Ysb0RBQVVBLENBQUNzQyxNQUFNO2FBQUM7WUFBRTNCLFFBQVE7Z0JBQUNYLG9EQUFVQSxDQUFDa0MsSUFBSTthQUFDO1FBQUM7UUFDeEUsZUFBZTtZQUFFeEIsUUFBUTtnQkFBQ1Ysb0RBQVVBLENBQUNzQyxNQUFNO2FBQUM7WUFBRTNCLFFBQVE7Z0JBQUNYLG9EQUFVQSxDQUFDcUMsSUFBSTthQUFDO1FBQUM7UUFDeEUsaUJBQWlCO1lBQUUzQixRQUFRO2dCQUFDVixvREFBVUEsQ0FBQ3NDLE1BQU07YUFBQztZQUFFM0IsUUFBUTtnQkFBQ1gsb0RBQVVBLENBQUNvQyxTQUFTO2FBQUM7UUFBQztRQUMvRSxlQUFlO1lBQUUxQixRQUFRO2dCQUFDVixvREFBVUEsQ0FBQ3NDLE1BQU07YUFBQztZQUFFM0IsUUFBUTtnQkFBQ1gsb0RBQVVBLENBQUNtQyxJQUFJO2FBQUM7UUFBQztRQUN4RSxvQkFBb0I7WUFBRXpCLFFBQVE7Z0JBQUNWLG9EQUFVQSxDQUFDc0MsTUFBTTthQUFDO1lBQUUzQixRQUFRO2dCQUFDWCxvREFBVUEsQ0FBQ3VDLFNBQVM7YUFBQztRQUFDO1FBRWxGLDRCQUE0QjtRQUM1QixrQkFBa0I7WUFBRTdCLFFBQVE7Z0JBQUNWLG9EQUFVQSxDQUFDeUMsT0FBTzthQUFDO1lBQUU5QixRQUFRO2dCQUFDWCxvREFBVUEsQ0FBQ3NDLE1BQU07YUFBQztRQUFDO1FBQzlFLHFCQUFxQjtZQUFFNUIsUUFBUTtnQkFBQ1Ysb0RBQVVBLENBQUN5QyxPQUFPO2FBQUM7WUFBRTlCLFFBQVE7Z0JBQUNYLG9EQUFVQSxDQUFDdUMsU0FBUzthQUFDO1FBQUM7UUFDcEYsa0JBQWtCO1lBQUU3QixRQUFRO2dCQUFDVixvREFBVUEsQ0FBQ3NDLE1BQU07YUFBQztZQUFFM0IsUUFBUTtnQkFBQ1gsb0RBQVVBLENBQUN5QyxPQUFPO2FBQUM7UUFBQztRQUM5RSxxQkFBcUI7WUFBRS9CLFFBQVE7Z0JBQUNWLG9EQUFVQSxDQUFDdUMsU0FBUzthQUFDO1lBQUU1QixRQUFRO2dCQUFDWCxvREFBVUEsQ0FBQ3lDLE9BQU87YUFBQztRQUFDO0lBQ3RGO0lBRUEsTUFBTUMsY0FBY1QsaUJBQWlCLENBQUN4QixTQUFTO0lBQy9DLElBQUksQ0FBQ2lDLGFBQWE7UUFDaEIsT0FBTztZQUNMMUIsU0FBUztZQUNUQyxRQUFRLHNCQUErQixPQUFUUjtRQUNoQztJQUNGO0lBRUEsSUFBSSxDQUFDaUMsWUFBWWhDLE1BQU0sQ0FBQ2lDLFFBQVEsQ0FBQ1osYUFBYTtRQUM1QyxPQUFPO1lBQ0xmLFNBQVM7WUFDVEMsUUFBUSwyQkFBd0NjLE9BQWJ0QixVQUFTLE1BQWtDaUMsT0FBOUJYLFlBQVcscUJBQWlELE9BQTlCVyxZQUFZaEMsTUFBTSxDQUFDa0MsSUFBSSxDQUFDO1FBQ3hHO0lBQ0Y7SUFFQSxJQUFJLENBQUNGLFlBQVkvQixNQUFNLENBQUNnQyxRQUFRLENBQUNYLGFBQWE7UUFDNUMsT0FBTztZQUNMaEIsU0FBUztZQUNUQyxRQUFRLDJCQUF3Q2UsT0FBYnZCLFVBQVMsTUFBa0NpQyxPQUE5QlYsWUFBVyxxQkFBaUQsT0FBOUJVLFlBQVkvQixNQUFNLENBQUNpQyxJQUFJLENBQUM7UUFDeEc7SUFDRjtJQUVBLE9BQU87UUFBRTVCLFNBQVM7SUFBSztBQUN6QjtBQUVBOztDQUVDLEdBQ00sZUFBZUsscUJBQXFCd0IsVUFBc0IsRUFBRUMsUUFBZ0I7SUFDakYsSUFBSTtRQUNGLE9BQVFEO1lBQ04sS0FBSzdDLG9EQUFVQSxDQUFDa0MsSUFBSTtnQkFDbEIsTUFBTWEsUUFBUSxNQUFNOUMsa0VBQVdBO2dCQUMvQixNQUFNK0MsT0FBT0QsTUFBTUUsSUFBSSxDQUFDQyxDQUFBQSxJQUFLQSxFQUFFbkMsRUFBRSxLQUFLK0I7Z0JBQ3RDLE9BQU8sQ0FBQyxDQUFDRTtZQUNYLEtBQUtoRCxvREFBVUEsQ0FBQ21DLElBQUk7Z0JBQ2xCLE1BQU1nQixRQUFRLE1BQU1qRCxrRUFBV0E7Z0JBQy9CLE1BQU1rRCxPQUFPRCxNQUFNRixJQUFJLENBQUNJLENBQUFBLElBQUtBLEVBQUV0QyxFQUFFLEtBQUsrQjtnQkFDdEMsT0FBTyxDQUFDLENBQUNNO1lBQ1gsS0FBS3BELG9EQUFVQSxDQUFDb0MsU0FBUztnQkFDdkIsTUFBTWtCLG1CQUFtQixNQUFNbkQsdUVBQWdCQTtnQkFDL0MsTUFBTW9ELFlBQVlELGlCQUFpQkwsSUFBSSxDQUFDTyxDQUFBQSxJQUFLQSxFQUFFekMsRUFBRSxLQUFLK0I7Z0JBQ3RELE9BQU8sQ0FBQyxDQUFDUztZQUNYLEtBQUt2RCxvREFBVUEsQ0FBQ3FDLElBQUk7Z0JBQ2xCLE1BQU1vQixRQUFRLE1BQU1yRCxrRUFBV0E7Z0JBQy9CLE1BQU1zRCxPQUFPRCxNQUFNUixJQUFJLENBQUNVLENBQUFBLElBQUtBLEVBQUU1QyxFQUFFLEtBQUsrQjtnQkFDdEMsT0FBTyxDQUFDLENBQUNZO1lBQ1gsS0FBSzFELG9EQUFVQSxDQUFDdUMsU0FBUztnQkFDdkIsTUFBTXFCLGFBQWEsTUFBTXZELHVFQUFnQkE7Z0JBQ3pDLE1BQU13RCxZQUFZRCxXQUFXWCxJQUFJLENBQUNhLENBQUFBLElBQUtBLEVBQUUvQyxFQUFFLEtBQUsrQjtnQkFDaEQsT0FBTyxDQUFDLENBQUNlO1lBQ1gsS0FBSzdELG9EQUFVQSxDQUFDc0MsTUFBTTtnQkFDcEIsTUFBTXlCLFVBQVUsTUFBTXpELG9FQUFhQTtnQkFDbkMsTUFBTTBELFNBQVNELFFBQVFkLElBQUksQ0FBQ2dCLENBQUFBLElBQUtBLEVBQUVsRCxFQUFFLEtBQUsrQjtnQkFDMUMsT0FBTyxDQUFDLENBQUNrQjtZQUNYLEtBQUtoRSxvREFBVUEsQ0FBQ3dDLElBQUk7Z0JBQ2xCLE1BQU0wQixRQUFRLE1BQU0zRCxrRUFBV0E7Z0JBQy9CLE1BQU00RCxPQUFPRCxNQUFNakIsSUFBSSxDQUFDVSxDQUFBQSxJQUFLQSxFQUFFNUMsRUFBRSxLQUFLK0I7Z0JBQ3RDLE9BQU8sQ0FBQyxDQUFDcUI7WUFDWCxLQUFLbkUsb0RBQVVBLENBQUN5QyxPQUFPO2dCQUNyQixzREFBc0Q7Z0JBQ3RELE9BQU87WUFDVDtnQkFDRTJCLFFBQVFDLElBQUksQ0FBQywrQ0FBMEQsT0FBWHhCO2dCQUM1RCxPQUFPO1FBQ1g7SUFDRixFQUFFLE9BQU9qQixPQUFPO1FBQ2R3QyxRQUFReEMsS0FBSyxDQUFDLGtEQUFnRWtCLE9BQWRELFlBQVcsS0FBWSxPQUFUQyxVQUFTLE1BQUlsQjtRQUMzRixPQUFPO0lBQ1Q7QUFDRjtBQUVBOztDQUVDLEdBQ00sZUFBZUosc0JBQ3BCZixRQUFrQixFQUNsQkMsTUFBd0MsRUFDeENDLE1BQXdDLEVBQ3hDQyxRQUE4QjtJQUU5QixNQUFNQyxXQUFxQixFQUFFO0lBRTdCLElBQUk7UUFDRixPQUFRSjtZQUNOLEtBQUs7Z0JBQ0gsNkNBQTZDO2dCQUM3QyxNQUFNbUQsYUFBYSxNQUFNdkQsdUVBQWdCQTtnQkFDekMsTUFBTXdELFlBQVlELFdBQVdYLElBQUksQ0FBQ2EsQ0FBQUEsSUFBS0EsRUFBRS9DLEVBQUUsS0FBS0wsT0FBT0ssRUFBRTtnQkFDekQsSUFBSThDLGFBQWFBLFVBQVVTLFFBQVEsS0FBSzNELE9BQU9JLEVBQUUsRUFBRTtvQkFDakRGLFNBQVNZLElBQUksQ0FBQyx1QkFBK0VkLE9BQXhEa0QsVUFBVVMsUUFBUSxFQUFDLHVDQUErQyxPQUFWM0QsT0FBT0ksRUFBRSxFQUFDO2dCQUN6RztnQkFDQTtZQUVGLEtBQUs7Z0JBQ0gsc0NBQXNDO2dCQUN0QyxNQUFNZ0MsUUFBUSxNQUFNOUMsa0VBQVdBO2dCQUMvQixNQUFNK0MsT0FBT0QsTUFBTUUsSUFBSSxDQUFDQyxDQUFBQSxJQUFLQSxFQUFFbkMsRUFBRSxLQUFLTCxPQUFPSyxFQUFFO2dCQUMvQyxJQUFJaUMsUUFBUUEsS0FBS3VCLE1BQU0sS0FBSzVELE9BQU9JLEVBQUUsRUFBRTtvQkFDckNGLFNBQVNZLElBQUksQ0FBQyxnQkFBK0RkLE9BQS9DcUMsS0FBS3VCLE1BQU0sRUFBQyxxQ0FBNkMsT0FBVjVELE9BQU9JLEVBQUUsRUFBQztnQkFDekY7Z0JBQ0E7WUFFRixLQUFLO2dCQUNILCtCQUErQjtnQkFDL0IsTUFBTW9DLFFBQVEsTUFBTWpELGtFQUFXQTtnQkFDL0IsTUFBTWtELE9BQU9ELE1BQU1GLElBQUksQ0FBQ0ksQ0FBQUEsSUFBS0EsRUFBRXRDLEVBQUUsS0FBS0wsT0FBT0ssRUFBRTtnQkFDL0MsSUFBSXFDLFFBQVFBLEtBQUtvQixLQUFLLEVBQUU7b0JBQ3RCLE1BQU1DLGlCQUFpQnJCLEtBQUtvQixLQUFLLENBQUNFLElBQUksQ0FBQyxDQUFDRixRQUFlQSxNQUFNRCxNQUFNLEtBQUs1RCxPQUFPSSxFQUFFO29CQUNqRixJQUFJLENBQUMwRCxnQkFBZ0I7d0JBQ25CNUQsU0FBU1ksSUFBSSxDQUFDLDRDQUFzRCxPQUFWZCxPQUFPSSxFQUFFO29CQUNyRTtnQkFDRjtnQkFDQTtZQUVGLEtBQUs7Z0JBQ0gsa0NBQWtDO2dCQUNsQyxNQUFNMEMsUUFBUSxNQUFNckQsa0VBQVdBO2dCQUMvQixNQUFNc0QsT0FBT0QsTUFBTVIsSUFBSSxDQUFDVSxDQUFBQSxJQUFLQSxFQUFFNUMsRUFBRSxLQUFLTCxPQUFPSyxFQUFFO2dCQUMvQyxJQUFJMkMsUUFBUUEsS0FBS2lCLEtBQUssRUFBRTtvQkFDdEIsTUFBTUMsZ0JBQWdCbEIsS0FBS2lCLEtBQUssQ0FBQ0QsSUFBSSxDQUFDLENBQUNHLE9BQWNBLEtBQUtDLElBQUksS0FBSyxVQUFVRCxLQUFLRSxNQUFNLEtBQUtwRSxPQUFPSSxFQUFFO29CQUN0RyxJQUFJLENBQUM2RCxlQUFlO3dCQUNsQi9ELFNBQVNZLElBQUksQ0FBQyxzQ0FBZ0QsT0FBVmQsT0FBT0ksRUFBRTtvQkFDL0Q7Z0JBQ0Y7Z0JBQ0E7WUFFRixLQUFLO2dCQUNILGdEQUFnRDtnQkFDaEQsTUFBTWlFLGdCQUFnQixNQUFNM0UsdUVBQWdCQTtnQkFDNUMsTUFBTTRFLE9BQU9ELGNBQWMvQixJQUFJLENBQUNhLENBQUFBLElBQUtBLEVBQUUvQyxFQUFFLEtBQUtMLE9BQU9LLEVBQUU7Z0JBQ3ZELElBQUlrRSxRQUFRQSxLQUFLWCxRQUFRLEtBQUszRCxPQUFPSSxFQUFFLEVBQUU7b0JBQ3ZDRixTQUFTWSxJQUFJLENBQUMsdUJBQTBFZCxPQUFuRHNFLEtBQUtYLFFBQVEsRUFBQyx1Q0FBK0MsT0FBVjNELE9BQU9JLEVBQUUsRUFBQztnQkFDcEc7Z0JBQ0E7WUFFRixLQUFLO2dCQUNILDBDQUEwQztnQkFDMUMsTUFBTW1FLGNBQWMsTUFBTTlFLGtFQUFXQTtnQkFDckMsTUFBTStFLGVBQWVELFlBQVlqQyxJQUFJLENBQUNVLENBQUFBLElBQUtBLEVBQUU1QyxFQUFFLEtBQUtMLE9BQU9LLEVBQUU7Z0JBQzdELElBQUlvRSxnQkFBZ0JBLGFBQWFDLFVBQVUsS0FBS3pFLE9BQU9JLEVBQUUsRUFBRTtvQkFDekRGLFNBQVNZLElBQUksQ0FBQyxvQkFBb0ZkLE9BQWhFd0UsYUFBYUMsVUFBVSxFQUFDLDBDQUFrRCxPQUFWekUsT0FBT0ksRUFBRSxFQUFDO2dCQUM5RztnQkFDQTtZQUVGLCtDQUErQztZQUMvQztnQkFFRTtRQUNKO1FBRUEsT0FBTztZQUNMQyxTQUFTO1lBQ1RILFVBQVVBLFNBQVNhLE1BQU0sR0FBRyxJQUFJYixXQUFXYztRQUM3QztJQUVGLEVBQUUsT0FBT0MsT0FBTztRQUNkLE9BQU87WUFDTFosU0FBUztZQUNUQyxRQUFRLG9DQUE2RixPQUF6RFcsaUJBQWlCQyxRQUFRRCxNQUFNRSxPQUFPLEdBQUc7UUFDdkY7SUFDRjtBQUNGIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vX05fRS8uL2xpbmtzL2xpbmstdmFsaWRhdGlvbi50cz9lM2FhIl0sInNvdXJjZXNDb250ZW50IjpbIi8vIGxpbmtzL2xpbmstdmFsaWRhdGlvbi50c1xyXG4vLyBMaW5rIFZhbGlkYXRpb24gU3lzdGVtIGZvciBUaGUgUm9zZXR0YSBTdG9uZVxyXG4vLyBNaWdyYXRlZCBmcm9tIGxpYi9nYW1lLW1lY2hhbmljcy93b3JrZmxvdy1pbnRlZ3JhdGlvbi50c1xyXG5cclxuaW1wb3J0IHsgTGlua1R5cGUsIEVudGl0eVR5cGUgfSBmcm9tICdAL3R5cGVzL2VudW1zJztcclxuaW1wb3J0IHsgXHJcbiAgZ2V0QWxsVGFza3MsXHJcbiAgZ2V0QWxsSXRlbXMsXHJcbiAgZ2V0QWxsRmluYW5jaWFscyxcclxuICBnZXRBbGxTYWxlcyxcclxuICBnZXRBbGxDaGFyYWN0ZXJzLFxyXG4gIGdldEFsbFBsYXllcnMsXHJcbiAgZ2V0QWxsU2l0ZXNcclxufSBmcm9tICdAL2RhdGEtc3RvcmUvZGF0YXN0b3JlJztcclxuXHJcbi8qKlxyXG4gKiBMaW5rIHZhbGlkYXRpb24gcmVzdWx0IGludGVyZmFjZVxyXG4gKi9cclxuZXhwb3J0IGludGVyZmFjZSBMaW5rVmFsaWRhdGlvblJlc3VsdCB7XHJcbiAgaXNWYWxpZDogYm9vbGVhbjtcclxuICByZWFzb24/OiBzdHJpbmc7XHJcbiAgd2FybmluZ3M/OiBzdHJpbmdbXTtcclxufVxyXG5cclxuLyoqXHJcbiAqIE1haW4gbGluayB2YWxpZGF0aW9uIG9yY2hlc3RyYXRvclxyXG4gKiBWYWxpZGF0ZXMgbGluayB0eXBlIGNvbXBhdGliaWxpdHksIGVudGl0eSBleGlzdGVuY2UsIGFuZCBidXNpbmVzcyBydWxlc1xyXG4gKi9cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIHZhbGlkYXRlTGluayhcclxuICBsaW5rVHlwZTogTGlua1R5cGUsXHJcbiAgc291cmNlOiB7IHR5cGU6IEVudGl0eVR5cGU7IGlkOiBzdHJpbmcgfSxcclxuICB0YXJnZXQ6IHsgdHlwZTogRW50aXR5VHlwZTsgaWQ6IHN0cmluZyB9LFxyXG4gIG1ldGFkYXRhPzogUmVjb3JkPHN0cmluZywgYW55PlxyXG4pOiBQcm9taXNlPExpbmtWYWxpZGF0aW9uUmVzdWx0PiB7XHJcbiAgY29uc3Qgd2FybmluZ3M6IHN0cmluZ1tdID0gW107XHJcbiAgXHJcbiAgdHJ5IHtcclxuICAgIC8vIDEuIEJhc2ljIHZhbGlkYXRpb25cclxuICAgIGlmICghbGlua1R5cGUgfHwgIXNvdXJjZT8udHlwZSB8fCAhc291cmNlPy5pZCB8fCAhdGFyZ2V0Py50eXBlIHx8ICF0YXJnZXQ/LmlkKSB7XHJcbiAgICAgIHJldHVybiB7XHJcbiAgICAgICAgaXNWYWxpZDogZmFsc2UsXHJcbiAgICAgICAgcmVhc29uOiAnTWlzc2luZyByZXF1aXJlZCBmaWVsZHM6IGxpbmtUeXBlLCBzb3VyY2UudHlwZSwgc291cmNlLmlkLCB0YXJnZXQudHlwZSwgdGFyZ2V0LmlkJ1xyXG4gICAgICB9O1xyXG4gICAgfVxyXG5cclxuICAgIC8vIDIuIFNlbGYtcmVmZXJlbmNlIHZhbGlkYXRpb25cclxuICAgIGlmIChzb3VyY2UudHlwZSA9PT0gdGFyZ2V0LnR5cGUgJiYgc291cmNlLmlkID09PSB0YXJnZXQuaWQpIHtcclxuICAgICAgcmV0dXJuIHtcclxuICAgICAgICBpc1ZhbGlkOiBmYWxzZSxcclxuICAgICAgICByZWFzb246ICdTZWxmLXJlZmVyZW5jaW5nIGxpbmtzIGFyZSBub3QgYWxsb3dlZCdcclxuICAgICAgfTtcclxuICAgIH1cclxuXHJcbiAgICAvLyAzLiBMaW5rIHR5cGUgY29tcGF0aWJpbGl0eSB2YWxpZGF0aW9uXHJcbiAgICBjb25zdCBjb21wYXRpYmlsaXR5UmVzdWx0ID0gdmFsaWRhdGVMaW5rVHlwZUNvbXBhdGliaWxpdHkobGlua1R5cGUsIHNvdXJjZS50eXBlLCB0YXJnZXQudHlwZSk7XHJcbiAgICBpZiAoIWNvbXBhdGliaWxpdHlSZXN1bHQuaXNWYWxpZCkge1xyXG4gICAgICByZXR1cm4ge1xyXG4gICAgICAgIGlzVmFsaWQ6IGZhbHNlLFxyXG4gICAgICAgIHJlYXNvbjogYEluY29tcGF0aWJsZSBsaW5rIHR5cGU6ICR7bGlua1R5cGV9IGNhbm5vdCBjb25uZWN0ICR7c291cmNlLnR5cGV9IHRvICR7dGFyZ2V0LnR5cGV9LiAke2NvbXBhdGliaWxpdHlSZXN1bHQucmVhc29ufWBcclxuICAgICAgfTtcclxuICAgIH1cclxuXHJcbiAgICAvLyA0LiBFbnRpdHkgZXhpc3RlbmNlIHZhbGlkYXRpb25cclxuICAgIGNvbnN0IHNvdXJjZUV4aXN0cyA9IGF3YWl0IHZhbGlkYXRlRW50aXR5RXhpc3RzKHNvdXJjZS50eXBlLCBzb3VyY2UuaWQpO1xyXG4gICAgaWYgKCFzb3VyY2VFeGlzdHMpIHtcclxuICAgICAgcmV0dXJuIHtcclxuICAgICAgICBpc1ZhbGlkOiBmYWxzZSxcclxuICAgICAgICByZWFzb246IGBTb3VyY2UgZW50aXR5IGRvZXMgbm90IGV4aXN0OiAke3NvdXJjZS50eXBlfToke3NvdXJjZS5pZH1gXHJcbiAgICAgIH07XHJcbiAgICB9XHJcblxyXG4gICAgY29uc3QgdGFyZ2V0RXhpc3RzID0gYXdhaXQgdmFsaWRhdGVFbnRpdHlFeGlzdHModGFyZ2V0LnR5cGUsIHRhcmdldC5pZCk7XHJcbiAgICBpZiAoIXRhcmdldEV4aXN0cykge1xyXG4gICAgICByZXR1cm4ge1xyXG4gICAgICAgIGlzVmFsaWQ6IGZhbHNlLFxyXG4gICAgICAgIHJlYXNvbjogYFRhcmdldCBlbnRpdHkgZG9lcyBub3QgZXhpc3Q6ICR7dGFyZ2V0LnR5cGV9OiR7dGFyZ2V0LmlkfWBcclxuICAgICAgfTtcclxuICAgIH1cclxuXHJcbiAgICAvLyA1LiBCdXNpbmVzcyBydWxlcyB2YWxpZGF0aW9uXHJcbiAgICBjb25zdCBidXNpbmVzc1J1bGVzUmVzdWx0ID0gYXdhaXQgdmFsaWRhdGVCdXNpbmVzc1J1bGVzKGxpbmtUeXBlLCBzb3VyY2UsIHRhcmdldCwgbWV0YWRhdGEpO1xyXG4gICAgaWYgKCFidXNpbmVzc1J1bGVzUmVzdWx0LmlzVmFsaWQpIHtcclxuICAgICAgcmV0dXJuIHtcclxuICAgICAgICBpc1ZhbGlkOiBmYWxzZSxcclxuICAgICAgICByZWFzb246IGJ1c2luZXNzUnVsZXNSZXN1bHQucmVhc29uXHJcbiAgICAgIH07XHJcbiAgICB9XHJcblxyXG4gICAgLy8gQWRkIGFueSB3YXJuaW5ncyBmcm9tIGJ1c2luZXNzIHJ1bGVzXHJcbiAgICBpZiAoYnVzaW5lc3NSdWxlc1Jlc3VsdC53YXJuaW5ncykge1xyXG4gICAgICB3YXJuaW5ncy5wdXNoKC4uLmJ1c2luZXNzUnVsZXNSZXN1bHQud2FybmluZ3MpO1xyXG4gICAgfVxyXG5cclxuICAgIHJldHVybiB7XHJcbiAgICAgIGlzVmFsaWQ6IHRydWUsXHJcbiAgICAgIHdhcm5pbmdzOiB3YXJuaW5ncy5sZW5ndGggPiAwID8gd2FybmluZ3MgOiB1bmRlZmluZWRcclxuICAgIH07XHJcblxyXG4gIH0gY2F0Y2ggKGVycm9yKSB7XHJcbiAgICByZXR1cm4ge1xyXG4gICAgICBpc1ZhbGlkOiBmYWxzZSxcclxuICAgICAgcmVhc29uOiBgVmFsaWRhdGlvbiBlcnJvcjogJHtlcnJvciBpbnN0YW5jZW9mIEVycm9yID8gZXJyb3IubWVzc2FnZSA6ICdVbmtub3duIGVycm9yJ31gXHJcbiAgICB9O1xyXG4gIH1cclxufVxyXG5cclxuLyoqXHJcbiAqIFZhbGlkYXRlIGxpbmsgdHlwZSBjb21wYXRpYmlsaXR5IHdpdGggc291cmNlIGFuZCB0YXJnZXQgZW50aXR5IHR5cGVzXHJcbiAqIENvbXBsZXRlIG1hcHBpbmcgb2YgYWxsIDM5IGxpbmsgdHlwZXNcclxuICovXHJcbmV4cG9ydCBmdW5jdGlvbiB2YWxpZGF0ZUxpbmtUeXBlQ29tcGF0aWJpbGl0eShcclxuICBsaW5rVHlwZTogTGlua1R5cGUsXHJcbiAgc291cmNlVHlwZTogRW50aXR5VHlwZSxcclxuICB0YXJnZXRUeXBlOiBFbnRpdHlUeXBlXHJcbik6IExpbmtWYWxpZGF0aW9uUmVzdWx0IHtcclxuICAvLyBEZWZpbmUgdmFsaWQgbGluayB0eXBlIGNvbWJpbmF0aW9ucyBmb3IgYWxsIDM5IGxpbmsgdHlwZXNcclxuICBjb25zdCB2YWxpZENvbWJpbmF0aW9uczogUmVjb3JkPExpbmtUeXBlLCB7IHNvdXJjZTogRW50aXR5VHlwZVtdLCB0YXJnZXQ6IEVudGl0eVR5cGVbXSB9PiA9IHtcclxuICAgIC8vIFRBU0sgcmVsYXRpb25zaGlwcyAoNilcclxuICAgICdUQVNLX0lURU0nOiB7IHNvdXJjZTogW0VudGl0eVR5cGUuVEFTS10sIHRhcmdldDogW0VudGl0eVR5cGUuSVRFTV0gfSxcclxuICAgICdUQVNLX0ZJTlJFQyc6IHsgc291cmNlOiBbRW50aXR5VHlwZS5UQVNLXSwgdGFyZ2V0OiBbRW50aXR5VHlwZS5GSU5BTkNJQUxdIH0sXHJcbiAgICAnVEFTS19TQUxFJzogeyBzb3VyY2U6IFtFbnRpdHlUeXBlLlRBU0tdLCB0YXJnZXQ6IFtFbnRpdHlUeXBlLlNBTEVdIH0sXHJcbiAgICAnVEFTS19QTEFZRVInOiB7IHNvdXJjZTogW0VudGl0eVR5cGUuVEFTS10sIHRhcmdldDogW0VudGl0eVR5cGUuUExBWUVSXSB9LFxyXG4gICAgJ1RBU0tfQ0hBUkFDVEVSJzogeyBzb3VyY2U6IFtFbnRpdHlUeXBlLlRBU0tdLCB0YXJnZXQ6IFtFbnRpdHlUeXBlLkNIQVJBQ1RFUl0gfSxcclxuICAgICdUQVNLX1NJVEUnOiB7IHNvdXJjZTogW0VudGl0eVR5cGUuVEFTS10sIHRhcmdldDogW0VudGl0eVR5cGUuU0lURV0gfSxcclxuICAgIFxyXG4gICAgLy8gSVRFTSByZWxhdGlvbnNoaXBzICg2KVxyXG4gICAgJ0lURU1fVEFTSyc6IHsgc291cmNlOiBbRW50aXR5VHlwZS5JVEVNXSwgdGFyZ2V0OiBbRW50aXR5VHlwZS5UQVNLXSB9LFxyXG4gICAgJ0lURU1fU0FMRSc6IHsgc291cmNlOiBbRW50aXR5VHlwZS5JVEVNXSwgdGFyZ2V0OiBbRW50aXR5VHlwZS5TQUxFXSB9LFxyXG4gICAgJ0lURU1fRklOUkVDJzogeyBzb3VyY2U6IFtFbnRpdHlUeXBlLklURU1dLCB0YXJnZXQ6IFtFbnRpdHlUeXBlLkZJTkFOQ0lBTF0gfSxcclxuICAgICdJVEVNX1BMQVlFUic6IHsgc291cmNlOiBbRW50aXR5VHlwZS5JVEVNXSwgdGFyZ2V0OiBbRW50aXR5VHlwZS5QTEFZRVJdIH0sXHJcbiAgICAnSVRFTV9DSEFSQUNURVInOiB7IHNvdXJjZTogW0VudGl0eVR5cGUuSVRFTV0sIHRhcmdldDogW0VudGl0eVR5cGUuQ0hBUkFDVEVSXSB9LFxyXG4gICAgJ0lURU1fU0lURSc6IHsgc291cmNlOiBbRW50aXR5VHlwZS5JVEVNXSwgdGFyZ2V0OiBbRW50aXR5VHlwZS5TSVRFXSB9LFxyXG5cclxuICAgIC8vIFNBTEUgcmVsYXRpb25zaGlwcyAoNilcclxuICAgICdTQUxFX1RBU0snOiB7IHNvdXJjZTogW0VudGl0eVR5cGUuU0FMRV0sIHRhcmdldDogW0VudGl0eVR5cGUuVEFTS10gfSxcclxuICAgICdTQUxFX0lURU0nOiB7IHNvdXJjZTogW0VudGl0eVR5cGUuU0FMRV0sIHRhcmdldDogW0VudGl0eVR5cGUuSVRFTV0gfSxcclxuICAgICdTQUxFX0ZJTlJFQyc6IHsgc291cmNlOiBbRW50aXR5VHlwZS5TQUxFXSwgdGFyZ2V0OiBbRW50aXR5VHlwZS5GSU5BTkNJQUxdIH0sXHJcbiAgICAnU0FMRV9QTEFZRVInOiB7IHNvdXJjZTogW0VudGl0eVR5cGUuU0FMRV0sIHRhcmdldDogW0VudGl0eVR5cGUuUExBWUVSXSB9LFxyXG4gICAgJ1NBTEVfQ0hBUkFDVEVSJzogeyBzb3VyY2U6IFtFbnRpdHlUeXBlLlNBTEVdLCB0YXJnZXQ6IFtFbnRpdHlUeXBlLkNIQVJBQ1RFUl0gfSxcclxuICAgICdTQUxFX1NJVEUnOiB7IHNvdXJjZTogW0VudGl0eVR5cGUuU0FMRV0sIHRhcmdldDogW0VudGl0eVR5cGUuU0lURV0gfSxcclxuXHJcbiAgICAvLyBGSU5BTkNJQUwgUkVDT1JEIHJlbGF0aW9uc2hpcHMgKDYpXHJcbiAgICAnRklOUkVDX1RBU0snOiB7IHNvdXJjZTogW0VudGl0eVR5cGUuRklOQU5DSUFMXSwgdGFyZ2V0OiBbRW50aXR5VHlwZS5UQVNLXSB9LFxyXG4gICAgJ0ZJTlJFQ19JVEVNJzogeyBzb3VyY2U6IFtFbnRpdHlUeXBlLkZJTkFOQ0lBTF0sIHRhcmdldDogW0VudGl0eVR5cGUuSVRFTV0gfSxcclxuICAgICdGSU5SRUNfU0FMRSc6IHsgc291cmNlOiBbRW50aXR5VHlwZS5GSU5BTkNJQUxdLCB0YXJnZXQ6IFtFbnRpdHlUeXBlLlNBTEVdIH0sXHJcbiAgICAnRklOUkVDX1BMQVlFUic6IHsgc291cmNlOiBbRW50aXR5VHlwZS5GSU5BTkNJQUxdLCB0YXJnZXQ6IFtFbnRpdHlUeXBlLlBMQVlFUl0gfSxcclxuICAgICdGSU5SRUNfQ0hBUkFDVEVSJzogeyBzb3VyY2U6IFtFbnRpdHlUeXBlLkZJTkFOQ0lBTF0sIHRhcmdldDogW0VudGl0eVR5cGUuQ0hBUkFDVEVSXSB9LFxyXG4gICAgJ0ZJTlJFQ19TSVRFJzogeyBzb3VyY2U6IFtFbnRpdHlUeXBlLkZJTkFOQ0lBTF0sIHRhcmdldDogW0VudGl0eVR5cGUuU0lURV0gfSxcclxuXHJcbiAgICAvLyBDSEFSQUNURVIgcmVsYXRpb25zaGlwcyAoNilcclxuICAgICdDSEFSQUNURVJfVEFTSyc6IHsgc291cmNlOiBbRW50aXR5VHlwZS5DSEFSQUNURVJdLCB0YXJnZXQ6IFtFbnRpdHlUeXBlLlRBU0tdIH0sXHJcbiAgICAnQ0hBUkFDVEVSX0lURU0nOiB7IHNvdXJjZTogW0VudGl0eVR5cGUuQ0hBUkFDVEVSXSwgdGFyZ2V0OiBbRW50aXR5VHlwZS5JVEVNXSB9LFxyXG4gICAgJ0NIQVJBQ1RFUl9TQUxFJzogeyBzb3VyY2U6IFtFbnRpdHlUeXBlLkNIQVJBQ1RFUl0sIHRhcmdldDogW0VudGl0eVR5cGUuU0FMRV0gfSxcclxuICAgICdDSEFSQUNURVJfRklOUkVDJzogeyBzb3VyY2U6IFtFbnRpdHlUeXBlLkNIQVJBQ1RFUl0sIHRhcmdldDogW0VudGl0eVR5cGUuRklOQU5DSUFMXSB9LFxyXG4gICAgJ0NIQVJBQ1RFUl9TSVRFJzogeyBzb3VyY2U6IFtFbnRpdHlUeXBlLkNIQVJBQ1RFUl0sIHRhcmdldDogW0VudGl0eVR5cGUuU0lURV0gfSxcclxuICAgICdDSEFSQUNURVJfUExBWUVSJzogeyBzb3VyY2U6IFtFbnRpdHlUeXBlLkNIQVJBQ1RFUl0sIHRhcmdldDogW0VudGl0eVR5cGUuUExBWUVSXSB9LFxyXG5cclxuICAgIC8vIFNJVEUgcmVsYXRpb25zaGlwcyAoNilcclxuICAgICdTSVRFX1RBU0snOiB7IHNvdXJjZTogW0VudGl0eVR5cGUuU0lURV0sIHRhcmdldDogW0VudGl0eVR5cGUuVEFTS10gfSxcclxuICAgICdTSVRFX0NIQVJBQ1RFUic6IHsgc291cmNlOiBbRW50aXR5VHlwZS5TSVRFXSwgdGFyZ2V0OiBbRW50aXR5VHlwZS5DSEFSQUNURVJdIH0sXHJcbiAgICAnU0lURV9GSU5SRUMnOiB7IHNvdXJjZTogW0VudGl0eVR5cGUuU0lURV0sIHRhcmdldDogW0VudGl0eVR5cGUuRklOQU5DSUFMXSB9LFxyXG4gICAgJ1NJVEVfSVRFTSc6IHsgc291cmNlOiBbRW50aXR5VHlwZS5TSVRFXSwgdGFyZ2V0OiBbRW50aXR5VHlwZS5JVEVNXSB9LFxyXG4gICAgJ1NJVEVfU0FMRSc6IHsgc291cmNlOiBbRW50aXR5VHlwZS5TSVRFXSwgdGFyZ2V0OiBbRW50aXR5VHlwZS5TQUxFXSB9LFxyXG4gICAgJ1NJVEVfU0lURSc6IHsgc291cmNlOiBbRW50aXR5VHlwZS5TSVRFXSwgdGFyZ2V0OiBbRW50aXR5VHlwZS5TSVRFXSB9LFxyXG5cclxuICAgIC8vIFBMQVlFUiByZWxhdGlvbnNoaXBzICg1KVxyXG4gICAgJ1BMQVlFUl9UQVNLJzogeyBzb3VyY2U6IFtFbnRpdHlUeXBlLlBMQVlFUl0sIHRhcmdldDogW0VudGl0eVR5cGUuVEFTS10gfSxcclxuICAgICdQTEFZRVJfU0FMRSc6IHsgc291cmNlOiBbRW50aXR5VHlwZS5QTEFZRVJdLCB0YXJnZXQ6IFtFbnRpdHlUeXBlLlNBTEVdIH0sXHJcbiAgICAnUExBWUVSX0ZJTlJFQyc6IHsgc291cmNlOiBbRW50aXR5VHlwZS5QTEFZRVJdLCB0YXJnZXQ6IFtFbnRpdHlUeXBlLkZJTkFOQ0lBTF0gfSxcclxuICAgICdQTEFZRVJfSVRFTSc6IHsgc291cmNlOiBbRW50aXR5VHlwZS5QTEFZRVJdLCB0YXJnZXQ6IFtFbnRpdHlUeXBlLklURU1dIH0sXHJcbiAgICAnUExBWUVSX0NIQVJBQ1RFUic6IHsgc291cmNlOiBbRW50aXR5VHlwZS5QTEFZRVJdLCB0YXJnZXQ6IFtFbnRpdHlUeXBlLkNIQVJBQ1RFUl0gfSxcclxuXHJcbiAgICAvLyBBQ0NPVU5UIHJlbGF0aW9uc2hpcHMgKDQpXHJcbiAgICAnQUNDT1VOVF9QTEFZRVInOiB7IHNvdXJjZTogW0VudGl0eVR5cGUuQUNDT1VOVF0sIHRhcmdldDogW0VudGl0eVR5cGUuUExBWUVSXSB9LFxyXG4gICAgJ0FDQ09VTlRfQ0hBUkFDVEVSJzogeyBzb3VyY2U6IFtFbnRpdHlUeXBlLkFDQ09VTlRdLCB0YXJnZXQ6IFtFbnRpdHlUeXBlLkNIQVJBQ1RFUl0gfSxcclxuICAgICdQTEFZRVJfQUNDT1VOVCc6IHsgc291cmNlOiBbRW50aXR5VHlwZS5QTEFZRVJdLCB0YXJnZXQ6IFtFbnRpdHlUeXBlLkFDQ09VTlRdIH0sXHJcbiAgICAnQ0hBUkFDVEVSX0FDQ09VTlQnOiB7IHNvdXJjZTogW0VudGl0eVR5cGUuQ0hBUkFDVEVSXSwgdGFyZ2V0OiBbRW50aXR5VHlwZS5BQ0NPVU5UXSB9XHJcbiAgfTtcclxuXHJcbiAgY29uc3QgY29tYmluYXRpb24gPSB2YWxpZENvbWJpbmF0aW9uc1tsaW5rVHlwZV07XHJcbiAgaWYgKCFjb21iaW5hdGlvbikge1xyXG4gICAgcmV0dXJuIHtcclxuICAgICAgaXNWYWxpZDogZmFsc2UsXHJcbiAgICAgIHJlYXNvbjogYFVua25vd24gbGluayB0eXBlOiAke2xpbmtUeXBlfWBcclxuICAgIH07XHJcbiAgfVxyXG5cclxuICBpZiAoIWNvbWJpbmF0aW9uLnNvdXJjZS5pbmNsdWRlcyhzb3VyY2VUeXBlKSkge1xyXG4gICAgcmV0dXJuIHtcclxuICAgICAgaXNWYWxpZDogZmFsc2UsXHJcbiAgICAgIHJlYXNvbjogYEludmFsaWQgc291cmNlIHR5cGUgZm9yICR7bGlua1R5cGV9OiAke3NvdXJjZVR5cGV9LiBWYWxpZCBzb3VyY2VzOiAke2NvbWJpbmF0aW9uLnNvdXJjZS5qb2luKCcsICcpfWBcclxuICAgIH07XHJcbiAgfVxyXG5cclxuICBpZiAoIWNvbWJpbmF0aW9uLnRhcmdldC5pbmNsdWRlcyh0YXJnZXRUeXBlKSkge1xyXG4gICAgcmV0dXJuIHtcclxuICAgICAgaXNWYWxpZDogZmFsc2UsXHJcbiAgICAgIHJlYXNvbjogYEludmFsaWQgdGFyZ2V0IHR5cGUgZm9yICR7bGlua1R5cGV9OiAke3RhcmdldFR5cGV9LiBWYWxpZCB0YXJnZXRzOiAke2NvbWJpbmF0aW9uLnRhcmdldC5qb2luKCcsICcpfWBcclxuICAgIH07XHJcbiAgfVxyXG5cclxuICByZXR1cm4geyBpc1ZhbGlkOiB0cnVlIH07XHJcbn1cclxuXHJcbi8qKlxyXG4gKiBWYWxpZGF0ZSB0aGF0IGVudGl0eSBleGlzdHMgaW4gdGhlIHN5c3RlbVxyXG4gKi9cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIHZhbGlkYXRlRW50aXR5RXhpc3RzKGVudGl0eVR5cGU6IEVudGl0eVR5cGUsIGVudGl0eUlkOiBzdHJpbmcpOiBQcm9taXNlPGJvb2xlYW4+IHtcclxuICB0cnkge1xyXG4gICAgc3dpdGNoIChlbnRpdHlUeXBlKSB7XHJcbiAgICAgIGNhc2UgRW50aXR5VHlwZS5UQVNLOlxyXG4gICAgICAgIGNvbnN0IHRhc2tzID0gYXdhaXQgZ2V0QWxsVGFza3MoKTtcclxuICAgICAgICBjb25zdCB0YXNrID0gdGFza3MuZmluZCh0ID0+IHQuaWQgPT09IGVudGl0eUlkKTtcclxuICAgICAgICByZXR1cm4gISF0YXNrO1xyXG4gICAgICBjYXNlIEVudGl0eVR5cGUuSVRFTTpcclxuICAgICAgICBjb25zdCBpdGVtcyA9IGF3YWl0IGdldEFsbEl0ZW1zKCk7XHJcbiAgICAgICAgY29uc3QgaXRlbSA9IGl0ZW1zLmZpbmQoaSA9PiBpLmlkID09PSBlbnRpdHlJZCk7XHJcbiAgICAgICAgcmV0dXJuICEhaXRlbTtcclxuICAgICAgY2FzZSBFbnRpdHlUeXBlLkZJTkFOQ0lBTDpcclxuICAgICAgICBjb25zdCBmaW5hbmNpYWxSZWNvcmRzID0gYXdhaXQgZ2V0QWxsRmluYW5jaWFscygpO1xyXG4gICAgICAgIGNvbnN0IGZpbmFuY2lhbCA9IGZpbmFuY2lhbFJlY29yZHMuZmluZChmID0+IGYuaWQgPT09IGVudGl0eUlkKTtcclxuICAgICAgICByZXR1cm4gISFmaW5hbmNpYWw7XHJcbiAgICAgIGNhc2UgRW50aXR5VHlwZS5TQUxFOlxyXG4gICAgICAgIGNvbnN0IHNhbGVzID0gYXdhaXQgZ2V0QWxsU2FsZXMoKTtcclxuICAgICAgICBjb25zdCBzYWxlID0gc2FsZXMuZmluZChzID0+IHMuaWQgPT09IGVudGl0eUlkKTtcclxuICAgICAgICByZXR1cm4gISFzYWxlO1xyXG4gICAgICBjYXNlIEVudGl0eVR5cGUuQ0hBUkFDVEVSOlxyXG4gICAgICAgIGNvbnN0IGNoYXJhY3RlcnMgPSBhd2FpdCBnZXRBbGxDaGFyYWN0ZXJzKCk7XHJcbiAgICAgICAgY29uc3QgY2hhcmFjdGVyID0gY2hhcmFjdGVycy5maW5kKGMgPT4gYy5pZCA9PT0gZW50aXR5SWQpO1xyXG4gICAgICAgIHJldHVybiAhIWNoYXJhY3RlcjtcclxuICAgICAgY2FzZSBFbnRpdHlUeXBlLlBMQVlFUjpcclxuICAgICAgICBjb25zdCBwbGF5ZXJzID0gYXdhaXQgZ2V0QWxsUGxheWVycygpO1xyXG4gICAgICAgIGNvbnN0IHBsYXllciA9IHBsYXllcnMuZmluZChwID0+IHAuaWQgPT09IGVudGl0eUlkKTtcclxuICAgICAgICByZXR1cm4gISFwbGF5ZXI7XHJcbiAgICAgIGNhc2UgRW50aXR5VHlwZS5TSVRFOlxyXG4gICAgICAgIGNvbnN0IHNpdGVzID0gYXdhaXQgZ2V0QWxsU2l0ZXMoKTtcclxuICAgICAgICBjb25zdCBzaXRlID0gc2l0ZXMuZmluZChzID0+IHMuaWQgPT09IGVudGl0eUlkKTtcclxuICAgICAgICByZXR1cm4gISFzaXRlO1xyXG4gICAgICBjYXNlIEVudGl0eVR5cGUuQUNDT1VOVDpcclxuICAgICAgICAvLyBBY2NvdW50IGVudGl0eSBub3QgaW1wbGVtZW50ZWQgaW4gY3VycmVudCBkYXRhc3RvcmVcclxuICAgICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICAgIGRlZmF1bHQ6XHJcbiAgICAgICAgY29uc29sZS53YXJuKGBbdmFsaWRhdGVFbnRpdHlFeGlzdHNdIFVua25vd24gZW50aXR5IHR5cGU6ICR7ZW50aXR5VHlwZX1gKTtcclxuICAgICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICB9XHJcbiAgfSBjYXRjaCAoZXJyb3IpIHtcclxuICAgIGNvbnNvbGUuZXJyb3IoYFt2YWxpZGF0ZUVudGl0eUV4aXN0c10gRXJyb3IgdmFsaWRhdGluZyBlbnRpdHkgJHtlbnRpdHlUeXBlfToke2VudGl0eUlkfTpgLCBlcnJvcik7XHJcbiAgICByZXR1cm4gZmFsc2U7XHJcbiAgfVxyXG59XHJcblxyXG4vKipcclxuICogVmFsaWRhdGUgYnVzaW5lc3MgcnVsZXMgc3BlY2lmaWMgdG8gbGluayB0eXBlc1xyXG4gKi9cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIHZhbGlkYXRlQnVzaW5lc3NSdWxlcyhcclxuICBsaW5rVHlwZTogTGlua1R5cGUsXHJcbiAgc291cmNlOiB7IHR5cGU6IEVudGl0eVR5cGU7IGlkOiBzdHJpbmcgfSxcclxuICB0YXJnZXQ6IHsgdHlwZTogRW50aXR5VHlwZTsgaWQ6IHN0cmluZyB9LFxyXG4gIG1ldGFkYXRhPzogUmVjb3JkPHN0cmluZywgYW55PlxyXG4pOiBQcm9taXNlPExpbmtWYWxpZGF0aW9uUmVzdWx0PiB7XHJcbiAgY29uc3Qgd2FybmluZ3M6IHN0cmluZ1tdID0gW107XHJcblxyXG4gIHRyeSB7XHJcbiAgICBzd2l0Y2ggKGxpbmtUeXBlKSB7XHJcbiAgICAgIGNhc2UgJ1BMQVlFUl9DSEFSQUNURVInOlxyXG4gICAgICAgIC8vIFZhbGlkYXRlIHRoYXQgY2hhcmFjdGVyIGhhcyB2YWxpZCBwbGF5ZXJJZFxyXG4gICAgICAgIGNvbnN0IGNoYXJhY3RlcnMgPSBhd2FpdCBnZXRBbGxDaGFyYWN0ZXJzKCk7XHJcbiAgICAgICAgY29uc3QgY2hhcmFjdGVyID0gY2hhcmFjdGVycy5maW5kKGMgPT4gYy5pZCA9PT0gc291cmNlLmlkKTtcclxuICAgICAgICBpZiAoY2hhcmFjdGVyICYmIGNoYXJhY3Rlci5wbGF5ZXJJZCAhPT0gdGFyZ2V0LmlkKSB7XHJcbiAgICAgICAgICB3YXJuaW5ncy5wdXNoKGBDaGFyYWN0ZXIgcGxheWVySWQgKCR7Y2hhcmFjdGVyLnBsYXllcklkfSkgZG9lcyBub3QgbWF0Y2ggdGFyZ2V0IHBsYXllciBJRCAoJHt0YXJnZXQuaWR9KWApO1xyXG4gICAgICAgIH1cclxuICAgICAgICBicmVhaztcclxuXHJcbiAgICAgIGNhc2UgJ1RBU0tfU0lURSc6XHJcbiAgICAgICAgLy8gVmFsaWRhdGUgdGhhdCB0YXNrIGhhcyB2YWxpZCBzaXRlSWRcclxuICAgICAgICBjb25zdCB0YXNrcyA9IGF3YWl0IGdldEFsbFRhc2tzKCk7XHJcbiAgICAgICAgY29uc3QgdGFzayA9IHRhc2tzLmZpbmQodCA9PiB0LmlkID09PSBzb3VyY2UuaWQpO1xyXG4gICAgICAgIGlmICh0YXNrICYmIHRhc2suc2l0ZUlkICE9PSB0YXJnZXQuaWQpIHtcclxuICAgICAgICAgIHdhcm5pbmdzLnB1c2goYFRhc2sgc2l0ZUlkICgke3Rhc2suc2l0ZUlkfSkgZG9lcyBub3QgbWF0Y2ggdGFyZ2V0IHNpdGUgSUQgKCR7dGFyZ2V0LmlkfSlgKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgYnJlYWs7XHJcblxyXG4gICAgICBjYXNlICdJVEVNX1NJVEUnOlxyXG4gICAgICAgIC8vIFZhbGlkYXRlIGl0ZW0gc3RvY2sgbG9jYXRpb25cclxuICAgICAgICBjb25zdCBpdGVtcyA9IGF3YWl0IGdldEFsbEl0ZW1zKCk7XHJcbiAgICAgICAgY29uc3QgaXRlbSA9IGl0ZW1zLmZpbmQoaSA9PiBpLmlkID09PSBzb3VyY2UuaWQpO1xyXG4gICAgICAgIGlmIChpdGVtICYmIGl0ZW0uc3RvY2spIHtcclxuICAgICAgICAgIGNvbnN0IGhhc1N0b2NrQXRTaXRlID0gaXRlbS5zdG9jay5zb21lKChzdG9jazogYW55KSA9PiBzdG9jay5zaXRlSWQgPT09IHRhcmdldC5pZCk7XHJcbiAgICAgICAgICBpZiAoIWhhc1N0b2NrQXRTaXRlKSB7XHJcbiAgICAgICAgICAgIHdhcm5pbmdzLnB1c2goYEl0ZW0gZG9lcyBub3QgaGF2ZSBzdG9jayBhdCB0YXJnZXQgc2l0ZTogJHt0YXJnZXQuaWR9YCk7XHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGJyZWFrO1xyXG5cclxuICAgICAgY2FzZSAnU0FMRV9JVEVNJzpcclxuICAgICAgICAvLyBWYWxpZGF0ZSBzYWxlIGNvbnRhaW5zIHRoZSBpdGVtXHJcbiAgICAgICAgY29uc3Qgc2FsZXMgPSBhd2FpdCBnZXRBbGxTYWxlcygpO1xyXG4gICAgICAgIGNvbnN0IHNhbGUgPSBzYWxlcy5maW5kKHMgPT4gcy5pZCA9PT0gc291cmNlLmlkKTtcclxuICAgICAgICBpZiAoc2FsZSAmJiBzYWxlLmxpbmVzKSB7XHJcbiAgICAgICAgICBjb25zdCBoYXNJdGVtSW5TYWxlID0gc2FsZS5saW5lcy5zb21lKChsaW5lOiBhbnkpID0+IGxpbmUua2luZCA9PT0gJ2l0ZW0nICYmIGxpbmUuaXRlbUlkID09PSB0YXJnZXQuaWQpO1xyXG4gICAgICAgICAgaWYgKCFoYXNJdGVtSW5TYWxlKSB7XHJcbiAgICAgICAgICAgIHdhcm5pbmdzLnB1c2goYFNhbGUgZG9lcyBub3QgY29udGFpbiB0YXJnZXQgaXRlbTogJHt0YXJnZXQuaWR9YCk7XHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGJyZWFrO1xyXG5cclxuICAgICAgY2FzZSAnQ0hBUkFDVEVSX1BMQVlFUic6XHJcbiAgICAgICAgLy8gVmFsaWRhdGUgdGhhdCBjaGFyYWN0ZXIgYmVsb25ncyB0byB0aGUgcGxheWVyXHJcbiAgICAgICAgY29uc3QgY2hhckZvclBsYXllciA9IGF3YWl0IGdldEFsbENoYXJhY3RlcnMoKTtcclxuICAgICAgICBjb25zdCBjaGFyID0gY2hhckZvclBsYXllci5maW5kKGMgPT4gYy5pZCA9PT0gc291cmNlLmlkKTtcclxuICAgICAgICBpZiAoY2hhciAmJiBjaGFyLnBsYXllcklkICE9PSB0YXJnZXQuaWQpIHtcclxuICAgICAgICAgIHdhcm5pbmdzLnB1c2goYENoYXJhY3RlciBwbGF5ZXJJZCAoJHtjaGFyLnBsYXllcklkfSkgZG9lcyBub3QgbWF0Y2ggdGFyZ2V0IHBsYXllciBJRCAoJHt0YXJnZXQuaWR9KWApO1xyXG4gICAgICAgIH1cclxuICAgICAgICBicmVhaztcclxuXHJcbiAgICAgIGNhc2UgJ1NBTEVfQ0hBUkFDVEVSJzpcclxuICAgICAgICAvLyBWYWxpZGF0ZSB0aGF0IGNoYXJhY3RlciBpcyB0aGUgY3VzdG9tZXJcclxuICAgICAgICBjb25zdCBzYWxlRm9yQ2hhciA9IGF3YWl0IGdldEFsbFNhbGVzKCk7XHJcbiAgICAgICAgY29uc3Qgc2FsZVdpdGhDaGFyID0gc2FsZUZvckNoYXIuZmluZChzID0+IHMuaWQgPT09IHNvdXJjZS5pZCk7XHJcbiAgICAgICAgaWYgKHNhbGVXaXRoQ2hhciAmJiBzYWxlV2l0aENoYXIuY3VzdG9tZXJJZCAhPT0gdGFyZ2V0LmlkKSB7XHJcbiAgICAgICAgICB3YXJuaW5ncy5wdXNoKGBTYWxlIGN1c3RvbWVySWQgKCR7c2FsZVdpdGhDaGFyLmN1c3RvbWVySWR9KSBkb2VzIG5vdCBtYXRjaCB0YXJnZXQgY2hhcmFjdGVyIElEICgke3RhcmdldC5pZH0pYCk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGJyZWFrO1xyXG5cclxuICAgICAgLy8gQWRkIG1vcmUgYnVzaW5lc3MgcnVsZSB2YWxpZGF0aW9ucyBhcyBuZWVkZWRcclxuICAgICAgZGVmYXVsdDpcclxuICAgICAgICAvLyBObyBzcGVjaWZpYyBidXNpbmVzcyBydWxlcyBmb3IgdGhpcyBsaW5rIHR5cGVcclxuICAgICAgICBicmVhaztcclxuICAgIH1cclxuXHJcbiAgICByZXR1cm4ge1xyXG4gICAgICBpc1ZhbGlkOiB0cnVlLFxyXG4gICAgICB3YXJuaW5nczogd2FybmluZ3MubGVuZ3RoID4gMCA/IHdhcm5pbmdzIDogdW5kZWZpbmVkXHJcbiAgICB9O1xyXG5cclxuICB9IGNhdGNoIChlcnJvcikge1xyXG4gICAgcmV0dXJuIHtcclxuICAgICAgaXNWYWxpZDogZmFsc2UsXHJcbiAgICAgIHJlYXNvbjogYEJ1c2luZXNzIHJ1bGVzIHZhbGlkYXRpb24gZXJyb3I6ICR7ZXJyb3IgaW5zdGFuY2VvZiBFcnJvciA/IGVycm9yLm1lc3NhZ2UgOiAnVW5rbm93biBlcnJvcid9YFxyXG4gICAgfTtcclxuICB9XHJcbn1cclxuIl0sIm5hbWVzIjpbIkVudGl0eVR5cGUiLCJnZXRBbGxUYXNrcyIsImdldEFsbEl0ZW1zIiwiZ2V0QWxsRmluYW5jaWFscyIsImdldEFsbFNhbGVzIiwiZ2V0QWxsQ2hhcmFjdGVycyIsImdldEFsbFBsYXllcnMiLCJnZXRBbGxTaXRlcyIsInZhbGlkYXRlTGluayIsImxpbmtUeXBlIiwic291cmNlIiwidGFyZ2V0IiwibWV0YWRhdGEiLCJ3YXJuaW5ncyIsInR5cGUiLCJpZCIsImlzVmFsaWQiLCJyZWFzb24iLCJjb21wYXRpYmlsaXR5UmVzdWx0IiwidmFsaWRhdGVMaW5rVHlwZUNvbXBhdGliaWxpdHkiLCJzb3VyY2VFeGlzdHMiLCJ2YWxpZGF0ZUVudGl0eUV4aXN0cyIsInRhcmdldEV4aXN0cyIsImJ1c2luZXNzUnVsZXNSZXN1bHQiLCJ2YWxpZGF0ZUJ1c2luZXNzUnVsZXMiLCJwdXNoIiwibGVuZ3RoIiwidW5kZWZpbmVkIiwiZXJyb3IiLCJFcnJvciIsIm1lc3NhZ2UiLCJzb3VyY2VUeXBlIiwidGFyZ2V0VHlwZSIsInZhbGlkQ29tYmluYXRpb25zIiwiVEFTSyIsIklURU0iLCJGSU5BTkNJQUwiLCJTQUxFIiwiUExBWUVSIiwiQ0hBUkFDVEVSIiwiU0lURSIsIkFDQ09VTlQiLCJjb21iaW5hdGlvbiIsImluY2x1ZGVzIiwiam9pbiIsImVudGl0eVR5cGUiLCJlbnRpdHlJZCIsInRhc2tzIiwidGFzayIsImZpbmQiLCJ0IiwiaXRlbXMiLCJpdGVtIiwiaSIsImZpbmFuY2lhbFJlY29yZHMiLCJmaW5hbmNpYWwiLCJmIiwic2FsZXMiLCJzYWxlIiwicyIsImNoYXJhY3RlcnMiLCJjaGFyYWN0ZXIiLCJjIiwicGxheWVycyIsInBsYXllciIsInAiLCJzaXRlcyIsInNpdGUiLCJjb25zb2xlIiwid2FybiIsInBsYXllcklkIiwic2l0ZUlkIiwic3RvY2siLCJoYXNTdG9ja0F0U2l0ZSIsInNvbWUiLCJsaW5lcyIsImhhc0l0ZW1JblNhbGUiLCJsaW5lIiwia2luZCIsIml0ZW1JZCIsImNoYXJGb3JQbGF5ZXIiLCJjaGFyIiwic2FsZUZvckNoYXIiLCJzYWxlV2l0aENoYXIiLCJjdXN0b21lcklkIl0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(app-pages-browser)/./links/link-validation.ts\n"));

/***/ }),

/***/ "(app-pages-browser)/./links/links-logging.ts":
/*!********************************!*\
  !*** ./links/links-logging.ts ***!
  \********************************/
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval(__webpack_require__.ts("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   appendLinkLog: function() { return /* binding */ appendLinkLog; }\n/* harmony export */ });\n/* harmony import */ var _data_store_kv__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @/data-store/kv */ \"(app-pages-browser)/./data-store/kv.ts\");\n/* harmony import */ var _data_store_keys__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @/data-store/keys */ \"(app-pages-browser)/./data-store/keys.ts\");\n// links/links-logging.ts\n// Links self-logging: append link events to KV\n\n\nconst ENTITY = \"links\";\nasync function appendLinkLog(link) {\n    let kind = arguments.length > 1 && arguments[1] !== void 0 ? arguments[1] : \"created\";\n    const key = (0,_data_store_keys__WEBPACK_IMPORTED_MODULE_1__.buildLogKey)(ENTITY);\n    const list = await (0,_data_store_kv__WEBPACK_IMPORTED_MODULE_0__.kvGet)(key) || [];\n    list.push({\n        kind,\n        linkId: link.id,\n        linkType: String(link.linkType),\n        source: {\n            type: String(link.source.type),\n            id: link.source.id\n        },\n        target: {\n            type: String(link.target.type),\n            id: link.target.id\n        },\n        metadata: link.metadata,\n        at: new Date().toISOString()\n    });\n    await (0,_data_store_kv__WEBPACK_IMPORTED_MODULE_0__.kvSet)(key, list);\n}\n\n\n;\n    // Wrapped in an IIFE to avoid polluting the global scope\n    ;\n    (function () {\n        var _a, _b;\n        // Legacy CSS implementations will `eval` browser code in a Node.js context\n        // to extract CSS. For backwards compatibility, we need to check we're in a\n        // browser context before continuing.\n        if (typeof self !== 'undefined' &&\n            // AMP / No-JS mode does not inject these helpers:\n            '$RefreshHelpers$' in self) {\n            // @ts-ignore __webpack_module__ is global\n            var currentExports = module.exports;\n            // @ts-ignore __webpack_module__ is global\n            var prevSignature = (_b = (_a = module.hot.data) === null || _a === void 0 ? void 0 : _a.prevSignature) !== null && _b !== void 0 ? _b : null;\n            // This cannot happen in MainTemplate because the exports mismatch between\n            // templating and execution.\n            self.$RefreshHelpers$.registerExportsForReactRefresh(currentExports, module.id);\n            // A module can be accepted automatically based on its exports, e.g. when\n            // it is a Refresh Boundary.\n            if (self.$RefreshHelpers$.isReactRefreshBoundary(currentExports)) {\n                // Save the previous exports signature on update so we can compare the boundary\n                // signatures. We avoid saving exports themselves since it causes memory leaks (https://github.com/vercel/next.js/pull/53797)\n                module.hot.dispose(function (data) {\n                    data.prevSignature =\n                        self.$RefreshHelpers$.getRefreshBoundarySignature(currentExports);\n                });\n                // Unconditionally accept an update to this module, we'll check if it's\n                // still a Refresh Boundary later.\n                // @ts-ignore importMeta is replaced in the loader\n                module.hot.accept();\n                // This field is set when the previous version of this module was a\n                // Refresh Boundary, letting us know we need to check for invalidation or\n                // enqueue an update.\n                if (prevSignature !== null) {\n                    // A boundary can become ineligible if its exports are incompatible\n                    // with the previous exports.\n                    //\n                    // For example, if you add/remove/change exports, we'll want to\n                    // re-execute the importing modules, and force those components to\n                    // re-render. Similarly, if you convert a class component to a\n                    // function, we want to invalidate the boundary.\n                    if (self.$RefreshHelpers$.shouldInvalidateReactRefreshBoundary(prevSignature, self.$RefreshHelpers$.getRefreshBoundarySignature(currentExports))) {\n                        module.hot.invalidate();\n                    }\n                    else {\n                        self.$RefreshHelpers$.scheduleUpdate();\n                    }\n                }\n            }\n            else {\n                // Since we just executed the code for the module, it's possible that the\n                // new exports made it ineligible for being a boundary.\n                // We only care about the case when we were _previously_ a boundary,\n                // because we already accepted this update (accidental side effect).\n                var isNoLongerABoundary = prevSignature !== null;\n                if (isNoLongerABoundary) {\n                    module.hot.invalidate();\n                }\n            }\n        }\n    })();\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFwcC1wYWdlcy1icm93c2VyKS8uL2xpbmtzL2xpbmtzLWxvZ2dpbmcudHMiLCJtYXBwaW5ncyI6Ijs7Ozs7O0FBQUEseUJBQXlCO0FBQ3pCLCtDQUErQztBQUdBO0FBQ0M7QUFFaEQsTUFBTUcsU0FBUztBQVlSLGVBQWVDLGNBQWNDLElBQVU7UUFBRUMsT0FBQUEsaUVBQTZCO0lBQzNFLE1BQU1DLE1BQU1MLDZEQUFXQSxDQUFDQztJQUN4QixNQUFNSyxPQUFPLE1BQU9SLHFEQUFLQSxDQUFpQk8sUUFBUyxFQUFFO0lBQ3JEQyxLQUFLQyxJQUFJLENBQUM7UUFDUkg7UUFDQUksUUFBUUwsS0FBS00sRUFBRTtRQUNmQyxVQUFVQyxPQUFPUixLQUFLTyxRQUFRO1FBQzlCRSxRQUFRO1lBQUVDLE1BQU1GLE9BQU9SLEtBQUtTLE1BQU0sQ0FBQ0MsSUFBSTtZQUFHSixJQUFJTixLQUFLUyxNQUFNLENBQUNILEVBQUU7UUFBQztRQUM3REssUUFBUTtZQUFFRCxNQUFNRixPQUFPUixLQUFLVyxNQUFNLENBQUNELElBQUk7WUFBR0osSUFBSU4sS0FBS1csTUFBTSxDQUFDTCxFQUFFO1FBQUM7UUFDN0RNLFVBQVVaLEtBQUtZLFFBQVE7UUFDdkJDLElBQUksSUFBSUMsT0FBT0MsV0FBVztJQUM1QjtJQUNBLE1BQU1uQixxREFBS0EsQ0FBQ00sS0FBS0M7QUFDbkIiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9fTl9FLy4vbGlua3MvbGlua3MtbG9nZ2luZy50cz9kNDJlIl0sInNvdXJjZXNDb250ZW50IjpbIi8vIGxpbmtzL2xpbmtzLWxvZ2dpbmcudHNcclxuLy8gTGlua3Mgc2VsZi1sb2dnaW5nOiBhcHBlbmQgbGluayBldmVudHMgdG8gS1ZcclxuXHJcbmltcG9ydCB0eXBlIHsgTGluayB9IGZyb20gJ0AvdHlwZXMvZW50aXRpZXMnO1xyXG5pbXBvcnQgeyBrdkdldCwga3ZTZXQgfSBmcm9tICdAL2RhdGEtc3RvcmUva3YnO1xyXG5pbXBvcnQgeyBidWlsZExvZ0tleSB9IGZyb20gJ0AvZGF0YS1zdG9yZS9rZXlzJztcclxuXHJcbmNvbnN0IEVOVElUWSA9ICdsaW5rcyc7XHJcblxyXG5leHBvcnQgdHlwZSBMaW5rTG9nRXZlbnQgPSB7XHJcbiAga2luZDogJ2NyZWF0ZWQnIHwgJ3JlbW92ZWQnIHwgJ3VwZGF0ZWQnO1xyXG4gIGxpbmtJZDogc3RyaW5nO1xyXG4gIGxpbmtUeXBlOiBzdHJpbmc7XHJcbiAgc291cmNlOiB7IHR5cGU6IHN0cmluZzsgaWQ6IHN0cmluZyB9O1xyXG4gIHRhcmdldDogeyB0eXBlOiBzdHJpbmc7IGlkOiBzdHJpbmcgfTtcclxuICBtZXRhZGF0YT86IFJlY29yZDxzdHJpbmcsIGFueT47XHJcbiAgYXQ6IHN0cmluZzsgLy8gSVNPIHRpbWVzdGFtcFxyXG59O1xyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGFwcGVuZExpbmtMb2cobGluazogTGluaywga2luZDogTGlua0xvZ0V2ZW50WydraW5kJ10gPSAnY3JlYXRlZCcpOiBQcm9taXNlPHZvaWQ+IHtcclxuICBjb25zdCBrZXkgPSBidWlsZExvZ0tleShFTlRJVFkpO1xyXG4gIGNvbnN0IGxpc3QgPSAoYXdhaXQga3ZHZXQ8TGlua0xvZ0V2ZW50W10+KGtleSkpIHx8IFtdO1xyXG4gIGxpc3QucHVzaCh7XHJcbiAgICBraW5kLFxyXG4gICAgbGlua0lkOiBsaW5rLmlkLFxyXG4gICAgbGlua1R5cGU6IFN0cmluZyhsaW5rLmxpbmtUeXBlKSxcclxuICAgIHNvdXJjZTogeyB0eXBlOiBTdHJpbmcobGluay5zb3VyY2UudHlwZSksIGlkOiBsaW5rLnNvdXJjZS5pZCB9LFxyXG4gICAgdGFyZ2V0OiB7IHR5cGU6IFN0cmluZyhsaW5rLnRhcmdldC50eXBlKSwgaWQ6IGxpbmsudGFyZ2V0LmlkIH0sXHJcbiAgICBtZXRhZGF0YTogbGluay5tZXRhZGF0YSxcclxuICAgIGF0OiBuZXcgRGF0ZSgpLnRvSVNPU3RyaW5nKCksXHJcbiAgfSk7XHJcbiAgYXdhaXQga3ZTZXQoa2V5LCBsaXN0KTtcclxufVxyXG5cclxuXHJcbiJdLCJuYW1lcyI6WyJrdkdldCIsImt2U2V0IiwiYnVpbGRMb2dLZXkiLCJFTlRJVFkiLCJhcHBlbmRMaW5rTG9nIiwibGluayIsImtpbmQiLCJrZXkiLCJsaXN0IiwicHVzaCIsImxpbmtJZCIsImlkIiwibGlua1R5cGUiLCJTdHJpbmciLCJzb3VyY2UiLCJ0eXBlIiwidGFyZ2V0IiwibWV0YWRhdGEiLCJhdCIsIkRhdGUiLCJ0b0lTT1N0cmluZyJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(app-pages-browser)/./links/links-logging.ts\n"));

/***/ }),

/***/ "(app-pages-browser)/./links/links-workflows.ts":
/*!**********************************!*\
  !*** ./links/links-workflows.ts ***!
  \**********************************/
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval(__webpack_require__.ts("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   makeLink: function() { return /* binding */ makeLink; },\n/* harmony export */   processCharacterEffects: function() { return /* binding */ processCharacterEffects; },\n/* harmony export */   processFinancialEffects: function() { return /* binding */ processFinancialEffects; },\n/* harmony export */   processItemEffects: function() { return /* binding */ processItemEffects; },\n/* harmony export */   processLinkEntity: function() { return /* binding */ processLinkEntity; },\n/* harmony export */   processPlayerEffects: function() { return /* binding */ processPlayerEffects; },\n/* harmony export */   processSaleEffects: function() { return /* binding */ processSaleEffects; },\n/* harmony export */   processTaskEffects: function() { return /* binding */ processTaskEffects; }\n/* harmony export */ });\n/* harmony import */ var _types_enums__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @/types/enums */ \"(app-pages-browser)/./types/enums.ts\");\n/* harmony import */ var _link_registry__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./link-registry */ \"(app-pages-browser)/./links/link-registry.ts\");\n/* harmony import */ var _links_logging__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./links-logging */ \"(app-pages-browser)/./links/links-logging.ts\");\n/* harmony import */ var _data_store_datastore__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! @/data-store/datastore */ \"(app-pages-browser)/./data-store/datastore.ts\");\n/* harmony import */ var uuid__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! uuid */ \"(app-pages-browser)/./node_modules/uuid/dist/esm-browser/v4.js\");\n/* harmony import */ var _data_store_effects_registry__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! @/data-store/effects-registry */ \"(app-pages-browser)/./data-store/effects-registry.ts\");\n// links/links-workflows.ts\n// Universal entry point for creating links from entities (property inspection)\n\n\n\n\n\n\nfunction makeLink(linkType, source, target, metadata) {\n    return {\n        id: (0,uuid__WEBPACK_IMPORTED_MODULE_5__[\"default\"])(),\n        linkType,\n        source,\n        target,\n        createdAt: new Date(),\n        metadata\n    };\n}\nasync function processLinkEntity(entity, entityType) {\n    // Check for circular reference\n    if ((0,_data_store_effects_registry__WEBPACK_IMPORTED_MODULE_4__.isProcessing)(entityType, entity.id)) {\n        console.warn(\"[CircuitBreaker] Already processing \".concat(entityType, \":\").concat(entity.id, \" - skipping to prevent circular reference\"));\n        return;\n    }\n    try {\n        (0,_data_store_effects_registry__WEBPACK_IMPORTED_MODULE_4__.startProcessing)(entityType, entity.id);\n        switch(entityType){\n            case _types_enums__WEBPACK_IMPORTED_MODULE_0__.EntityType.TASK:\n                await processTaskEffects(entity);\n                break;\n            case _types_enums__WEBPACK_IMPORTED_MODULE_0__.EntityType.ITEM:\n                await processItemEffects(entity);\n                break;\n            case _types_enums__WEBPACK_IMPORTED_MODULE_0__.EntityType.SALE:\n                await processSaleEffects(entity);\n                break;\n            case _types_enums__WEBPACK_IMPORTED_MODULE_0__.EntityType.FINANCIAL:\n                await processFinancialEffects(entity);\n                break;\n            case _types_enums__WEBPACK_IMPORTED_MODULE_0__.EntityType.CHARACTER:\n                await processCharacterEffects(entity);\n                break;\n            case _types_enums__WEBPACK_IMPORTED_MODULE_0__.EntityType.PLAYER:\n                await processPlayerEffects(entity);\n                break;\n            case _types_enums__WEBPACK_IMPORTED_MODULE_0__.EntityType.SITE:\n                break;\n            default:\n                return;\n        }\n    } finally{\n        (0,_data_store_effects_registry__WEBPACK_IMPORTED_MODULE_4__.endProcessing)(entityType, entity.id);\n    }\n}\nasync function processTaskEffects(task) {\n    if (task.siteId) {\n        const l = makeLink(_types_enums__WEBPACK_IMPORTED_MODULE_0__.LinkType.TASK_SITE, {\n            type: _types_enums__WEBPACK_IMPORTED_MODULE_0__.EntityType.TASK,\n            id: task.id\n        }, {\n            type: _types_enums__WEBPACK_IMPORTED_MODULE_0__.EntityType.SITE,\n            id: task.siteId\n        });\n        await (0,_link_registry__WEBPACK_IMPORTED_MODULE_1__.createLink)(l);\n        await (0,_links_logging__WEBPACK_IMPORTED_MODULE_2__.appendLinkLog)(l, \"created\");\n    }\n    if (task.outputItemId) {\n        const l = makeLink(_types_enums__WEBPACK_IMPORTED_MODULE_0__.LinkType.TASK_ITEM, {\n            type: _types_enums__WEBPACK_IMPORTED_MODULE_0__.EntityType.TASK,\n            id: task.id\n        }, {\n            type: _types_enums__WEBPACK_IMPORTED_MODULE_0__.EntityType.ITEM,\n            id: task.outputItemId\n        });\n        await (0,_link_registry__WEBPACK_IMPORTED_MODULE_1__.createLink)(l);\n        await (0,_links_logging__WEBPACK_IMPORTED_MODULE_2__.appendLinkLog)(l, \"created\");\n    }\n    // TASK_CHARACTER link\n    if (task.characterId) {\n        const l = makeLink(_types_enums__WEBPACK_IMPORTED_MODULE_0__.LinkType.TASK_CHARACTER, {\n            type: _types_enums__WEBPACK_IMPORTED_MODULE_0__.EntityType.TASK,\n            id: task.id\n        }, {\n            type: _types_enums__WEBPACK_IMPORTED_MODULE_0__.EntityType.CHARACTER,\n            id: task.characterId\n        });\n        await (0,_link_registry__WEBPACK_IMPORTED_MODULE_1__.createLink)(l);\n        await (0,_links_logging__WEBPACK_IMPORTED_MODULE_2__.appendLinkLog)(l, \"created\");\n    }\n    // Create TASK_ITEM link for items created from task emissary fields\n    if (task.outputItemType && task.outputQuantity && task.status === \"Done\") {\n        // Find the item created by this task\n        const items = await (0,_data_store_datastore__WEBPACK_IMPORTED_MODULE_3__.getAllItems)();\n        const createdItem = items.find((item)=>item.sourceTaskId === task.id && item.type === task.outputItemType);\n        if (createdItem) {\n            const l = makeLink(_types_enums__WEBPACK_IMPORTED_MODULE_0__.LinkType.TASK_ITEM, {\n                type: _types_enums__WEBPACK_IMPORTED_MODULE_0__.EntityType.TASK,\n                id: task.id\n            }, {\n                type: _types_enums__WEBPACK_IMPORTED_MODULE_0__.EntityType.ITEM,\n                id: createdItem.id\n            }, {\n                quantity: task.outputQuantity,\n                unitCost: task.outputUnitCost,\n                price: task.outputItemPrice,\n                itemType: task.outputItemType\n            });\n            await (0,_link_registry__WEBPACK_IMPORTED_MODULE_1__.createLink)(l);\n            await (0,_links_logging__WEBPACK_IMPORTED_MODULE_2__.appendLinkLog)(l, \"created\");\n        }\n    }\n// Note: TASK_PLAYER handled by points-rewards-utils.ts \n// Note: TASK_FINREC handled by financial-record-utils.ts \n}\nasync function processItemEffects(item) {\n    if (item.sourceTaskId) {\n        const l = makeLink(_types_enums__WEBPACK_IMPORTED_MODULE_0__.LinkType.ITEM_TASK, {\n            type: _types_enums__WEBPACK_IMPORTED_MODULE_0__.EntityType.ITEM,\n            id: item.id\n        }, {\n            type: _types_enums__WEBPACK_IMPORTED_MODULE_0__.EntityType.TASK,\n            id: item.sourceTaskId\n        });\n        await (0,_link_registry__WEBPACK_IMPORTED_MODULE_1__.createLink)(l);\n        await (0,_links_logging__WEBPACK_IMPORTED_MODULE_2__.appendLinkLog)(l, \"created\");\n    }\n    for (const s of item.stock || []){\n        if (s.siteId) {\n            const l = makeLink(_types_enums__WEBPACK_IMPORTED_MODULE_0__.LinkType.ITEM_SITE, {\n                type: _types_enums__WEBPACK_IMPORTED_MODULE_0__.EntityType.ITEM,\n                id: item.id\n            }, {\n                type: _types_enums__WEBPACK_IMPORTED_MODULE_0__.EntityType.SITE,\n                id: s.siteId\n            });\n            await (0,_link_registry__WEBPACK_IMPORTED_MODULE_1__.createLink)(l);\n            await (0,_links_logging__WEBPACK_IMPORTED_MODULE_2__.appendLinkLog)(l, \"created\");\n        }\n    }\n    // ITEM_CHARACTER link\n    if (item.ownerCharacterId) {\n        const l = makeLink(_types_enums__WEBPACK_IMPORTED_MODULE_0__.LinkType.ITEM_CHARACTER, {\n            type: _types_enums__WEBPACK_IMPORTED_MODULE_0__.EntityType.ITEM,\n            id: item.id\n        }, {\n            type: _types_enums__WEBPACK_IMPORTED_MODULE_0__.EntityType.CHARACTER,\n            id: item.ownerCharacterId\n        });\n        await (0,_link_registry__WEBPACK_IMPORTED_MODULE_1__.createLink)(l);\n        await (0,_links_logging__WEBPACK_IMPORTED_MODULE_2__.appendLinkLog)(l, \"created\");\n    }\n// Note: ITEM_SALE links handled in processSaleEffects (from sale.lines)\n}\nasync function processSaleEffects(sale) {\n    if (sale.siteId) {\n        const l = makeLink(_types_enums__WEBPACK_IMPORTED_MODULE_0__.LinkType.SALE_SITE, {\n            type: _types_enums__WEBPACK_IMPORTED_MODULE_0__.EntityType.SALE,\n            id: sale.id\n        }, {\n            type: _types_enums__WEBPACK_IMPORTED_MODULE_0__.EntityType.SITE,\n            id: sale.siteId\n        });\n        await (0,_link_registry__WEBPACK_IMPORTED_MODULE_1__.createLink)(l);\n        await (0,_links_logging__WEBPACK_IMPORTED_MODULE_2__.appendLinkLog)(l, \"created\");\n    }\n    // SALE_CHARACTER link\n    if (sale.customerId) {\n        const l = makeLink(_types_enums__WEBPACK_IMPORTED_MODULE_0__.LinkType.SALE_CHARACTER, {\n            type: _types_enums__WEBPACK_IMPORTED_MODULE_0__.EntityType.SALE,\n            id: sale.id\n        }, {\n            type: _types_enums__WEBPACK_IMPORTED_MODULE_0__.EntityType.CHARACTER,\n            id: sale.customerId\n        });\n        await (0,_link_registry__WEBPACK_IMPORTED_MODULE_1__.createLink)(l);\n        await (0,_links_logging__WEBPACK_IMPORTED_MODULE_2__.appendLinkLog)(l, \"created\");\n    }\n    // SALE_ITEM links (from sale lines)\n    if (sale.lines && sale.lines.length > 0) {\n        for (const line of sale.lines){\n            if (line.kind === \"item\" && line.itemId) {\n                const l = makeLink(_types_enums__WEBPACK_IMPORTED_MODULE_0__.LinkType.SALE_ITEM, {\n                    type: _types_enums__WEBPACK_IMPORTED_MODULE_0__.EntityType.SALE,\n                    id: sale.id\n                }, {\n                    type: _types_enums__WEBPACK_IMPORTED_MODULE_0__.EntityType.ITEM,\n                    id: line.itemId\n                }, {\n                    quantity: line.quantity,\n                    unitPrice: line.unitPrice\n                });\n                await (0,_link_registry__WEBPACK_IMPORTED_MODULE_1__.createLink)(l);\n                await (0,_links_logging__WEBPACK_IMPORTED_MODULE_2__.appendLinkLog)(l, \"created\");\n            }\n        }\n    }\n    // SALE_TASK link (if sale spawned from task)\n    if (sale.sourceTaskId) {\n        const l = makeLink(_types_enums__WEBPACK_IMPORTED_MODULE_0__.LinkType.SALE_TASK, {\n            type: _types_enums__WEBPACK_IMPORTED_MODULE_0__.EntityType.SALE,\n            id: sale.id\n        }, {\n            type: _types_enums__WEBPACK_IMPORTED_MODULE_0__.EntityType.TASK,\n            id: sale.sourceTaskId\n        });\n        await (0,_link_registry__WEBPACK_IMPORTED_MODULE_1__.createLink)(l);\n        await (0,_links_logging__WEBPACK_IMPORTED_MODULE_2__.appendLinkLog)(l, \"created\");\n    }\n// Note: SALE_PLAYER handled by points-rewards-utils.ts \n}\nasync function processFinancialEffects(fin) {\n    if (fin.siteId) {\n        const l = makeLink(_types_enums__WEBPACK_IMPORTED_MODULE_0__.LinkType.FINREC_SITE, {\n            type: _types_enums__WEBPACK_IMPORTED_MODULE_0__.EntityType.FINANCIAL,\n            id: fin.id\n        }, {\n            type: _types_enums__WEBPACK_IMPORTED_MODULE_0__.EntityType.SITE,\n            id: fin.siteId\n        });\n        await (0,_link_registry__WEBPACK_IMPORTED_MODULE_1__.createLink)(l);\n        await (0,_links_logging__WEBPACK_IMPORTED_MODULE_2__.appendLinkLog)(l, \"created\");\n    }\n    // FINREC_CHARACTER link\n    if (fin.customerCharacterId) {\n        const l = makeLink(_types_enums__WEBPACK_IMPORTED_MODULE_0__.LinkType.FINREC_CHARACTER, {\n            type: _types_enums__WEBPACK_IMPORTED_MODULE_0__.EntityType.FINANCIAL,\n            id: fin.id\n        }, {\n            type: _types_enums__WEBPACK_IMPORTED_MODULE_0__.EntityType.CHARACTER,\n            id: fin.customerCharacterId\n        });\n        await (0,_link_registry__WEBPACK_IMPORTED_MODULE_1__.createLink)(l);\n        await (0,_links_logging__WEBPACK_IMPORTED_MODULE_2__.appendLinkLog)(l, \"created\");\n    }\n    // Create FINREC_ITEM link for items created from financial record emissary fields\n    if (fin.outputItemType && fin.outputQuantity) {\n        // Find the item created by this financial record\n        const items = await (0,_data_store_datastore__WEBPACK_IMPORTED_MODULE_3__.getAllItems)();\n        const createdItem = items.find((item)=>item.sourceRecordId === fin.id && item.type === fin.outputItemType);\n        if (createdItem) {\n            const l = makeLink(_types_enums__WEBPACK_IMPORTED_MODULE_0__.LinkType.FINREC_ITEM, {\n                type: _types_enums__WEBPACK_IMPORTED_MODULE_0__.EntityType.FINANCIAL,\n                id: fin.id\n            }, {\n                type: _types_enums__WEBPACK_IMPORTED_MODULE_0__.EntityType.ITEM,\n                id: createdItem.id\n            }, {\n                quantity: fin.outputQuantity,\n                unitCost: fin.outputUnitCost,\n                price: fin.outputItemPrice,\n                itemType: fin.outputItemType\n            });\n            await (0,_link_registry__WEBPACK_IMPORTED_MODULE_1__.createLink)(l);\n            await (0,_links_logging__WEBPACK_IMPORTED_MODULE_2__.appendLinkLog)(l, \"created\");\n        }\n    }\n// Note: FINREC_TASK handled by financial-record-utils.ts \n// Note: FINREC_PLAYER handled by points-rewards-utils.ts \n}\nasync function processCharacterEffects(character) {\n    // CHARACTER_PLAYER link\n    if (character.playerId) {\n        const link = makeLink(_types_enums__WEBPACK_IMPORTED_MODULE_0__.LinkType.CHARACTER_PLAYER, {\n            type: _types_enums__WEBPACK_IMPORTED_MODULE_0__.EntityType.CHARACTER,\n            id: character.id\n        }, {\n            type: _types_enums__WEBPACK_IMPORTED_MODULE_0__.EntityType.PLAYER,\n            id: character.playerId\n        });\n        await (0,_link_registry__WEBPACK_IMPORTED_MODULE_1__.createLink)(link);\n        await (0,_links_logging__WEBPACK_IMPORTED_MODULE_2__.appendLinkLog)(link, \"created\");\n    }\n    // CHARACTER_SITE link (if character has home site)\n    if (character.siteId) {\n        const link = makeLink(_types_enums__WEBPACK_IMPORTED_MODULE_0__.LinkType.CHARACTER_SITE, {\n            type: _types_enums__WEBPACK_IMPORTED_MODULE_0__.EntityType.CHARACTER,\n            id: character.id\n        }, {\n            type: _types_enums__WEBPACK_IMPORTED_MODULE_0__.EntityType.SITE,\n            id: character.siteId\n        });\n        await (0,_link_registry__WEBPACK_IMPORTED_MODULE_1__.createLink)(link);\n        await (0,_links_logging__WEBPACK_IMPORTED_MODULE_2__.appendLinkLog)(link, \"created\");\n    }\n}\nasync function processPlayerEffects(player) {\n    // PLAYER_CHARACTER links (array of characters)\n    if (player.characterIds && player.characterIds.length > 0) {\n        for (const characterId of player.characterIds){\n            const link = makeLink(_types_enums__WEBPACK_IMPORTED_MODULE_0__.LinkType.PLAYER_CHARACTER, {\n                type: _types_enums__WEBPACK_IMPORTED_MODULE_0__.EntityType.PLAYER,\n                id: player.id\n            }, {\n                type: _types_enums__WEBPACK_IMPORTED_MODULE_0__.EntityType.CHARACTER,\n                id: characterId\n            });\n            await (0,_link_registry__WEBPACK_IMPORTED_MODULE_1__.createLink)(link);\n            await (0,_links_logging__WEBPACK_IMPORTED_MODULE_2__.appendLinkLog)(link, \"created\");\n        }\n    }\n// Note: PLAYER_SITE links not implemented - Player doesn't have siteId field\n} // Sites don't create links when saved - they're primarily link targets\n // SITE_SITE links are created by movement operations (see workflows/site-movement-utils.ts)\n // No processSiteEffects function needed - sites have no link-creating properties\n\n\n;\n    // Wrapped in an IIFE to avoid polluting the global scope\n    ;\n    (function () {\n        var _a, _b;\n        // Legacy CSS implementations will `eval` browser code in a Node.js context\n        // to extract CSS. For backwards compatibility, we need to check we're in a\n        // browser context before continuing.\n        if (typeof self !== 'undefined' &&\n            // AMP / No-JS mode does not inject these helpers:\n            '$RefreshHelpers$' in self) {\n            // @ts-ignore __webpack_module__ is global\n            var currentExports = module.exports;\n            // @ts-ignore __webpack_module__ is global\n            var prevSignature = (_b = (_a = module.hot.data) === null || _a === void 0 ? void 0 : _a.prevSignature) !== null && _b !== void 0 ? _b : null;\n            // This cannot happen in MainTemplate because the exports mismatch between\n            // templating and execution.\n            self.$RefreshHelpers$.registerExportsForReactRefresh(currentExports, module.id);\n            // A module can be accepted automatically based on its exports, e.g. when\n            // it is a Refresh Boundary.\n            if (self.$RefreshHelpers$.isReactRefreshBoundary(currentExports)) {\n                // Save the previous exports signature on update so we can compare the boundary\n                // signatures. We avoid saving exports themselves since it causes memory leaks (https://github.com/vercel/next.js/pull/53797)\n                module.hot.dispose(function (data) {\n                    data.prevSignature =\n                        self.$RefreshHelpers$.getRefreshBoundarySignature(currentExports);\n                });\n                // Unconditionally accept an update to this module, we'll check if it's\n                // still a Refresh Boundary later.\n                // @ts-ignore importMeta is replaced in the loader\n                module.hot.accept();\n                // This field is set when the previous version of this module was a\n                // Refresh Boundary, letting us know we need to check for invalidation or\n                // enqueue an update.\n                if (prevSignature !== null) {\n                    // A boundary can become ineligible if its exports are incompatible\n                    // with the previous exports.\n                    //\n                    // For example, if you add/remove/change exports, we'll want to\n                    // re-execute the importing modules, and force those components to\n                    // re-render. Similarly, if you convert a class component to a\n                    // function, we want to invalidate the boundary.\n                    if (self.$RefreshHelpers$.shouldInvalidateReactRefreshBoundary(prevSignature, self.$RefreshHelpers$.getRefreshBoundarySignature(currentExports))) {\n                        module.hot.invalidate();\n                    }\n                    else {\n                        self.$RefreshHelpers$.scheduleUpdate();\n                    }\n                }\n            }\n            else {\n                // Since we just executed the code for the module, it's possible that the\n                // new exports made it ineligible for being a boundary.\n                // We only care about the case when we were _previously_ a boundary,\n                // because we already accepted this update (accidental side effect).\n                var isNoLongerABoundary = prevSignature !== null;\n                if (isNoLongerABoundary) {\n                    module.hot.invalidate();\n                }\n            }\n        }\n    })();\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFwcC1wYWdlcy1icm93c2VyKS8uL2xpbmtzL2xpbmtzLXdvcmtmbG93cy50cyIsIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7Ozs7OztBQUFBLDJCQUEyQjtBQUMzQiwrRUFBK0U7QUFFMUI7QUFFUjtBQUNHO0FBQ0s7QUFDbkI7QUFDMkQ7QUFFdEYsU0FBU1UsU0FBU0MsUUFBa0IsRUFBRUMsTUFBd0MsRUFBRUMsTUFBd0MsRUFBRUMsUUFBOEI7SUFDN0osT0FBTztRQUNMQyxJQUFJVCxnREFBSUE7UUFDUks7UUFDQUM7UUFDQUM7UUFDQUcsV0FBVyxJQUFJQztRQUNmSDtJQUNGO0FBQ0Y7QUFFTyxlQUFlSSxrQkFBa0JDLE1BQVcsRUFBRUMsVUFBc0I7SUFDekUsK0JBQStCO0lBQy9CLElBQUliLDBFQUFZQSxDQUFDYSxZQUFZRCxPQUFPSixFQUFFLEdBQUc7UUFDdkNNLFFBQVFDLElBQUksQ0FBQyx1Q0FBcURILE9BQWRDLFlBQVcsS0FBYSxPQUFWRCxPQUFPSixFQUFFLEVBQUM7UUFDNUU7SUFDRjtJQUVBLElBQUk7UUFDRlAsNkVBQWVBLENBQUNZLFlBQVlELE9BQU9KLEVBQUU7UUFFckMsT0FBUUs7WUFDTixLQUFLcEIsb0RBQVVBLENBQUN1QixJQUFJO2dCQUNsQixNQUFNQyxtQkFBbUJMO2dCQUN6QjtZQUNGLEtBQUtuQixvREFBVUEsQ0FBQ3lCLElBQUk7Z0JBQ2xCLE1BQU1DLG1CQUFtQlA7Z0JBQ3pCO1lBQ0YsS0FBS25CLG9EQUFVQSxDQUFDMkIsSUFBSTtnQkFDbEIsTUFBTUMsbUJBQW1CVDtnQkFDekI7WUFDRixLQUFLbkIsb0RBQVVBLENBQUM2QixTQUFTO2dCQUN2QixNQUFNQyx3QkFBd0JYO2dCQUM5QjtZQUNGLEtBQUtuQixvREFBVUEsQ0FBQytCLFNBQVM7Z0JBQ3ZCLE1BQU1DLHdCQUF3QmI7Z0JBQzlCO1lBQ0YsS0FBS25CLG9EQUFVQSxDQUFDaUMsTUFBTTtnQkFDcEIsTUFBTUMscUJBQXFCZjtnQkFDM0I7WUFDRixLQUFLbkIsb0RB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LFVBQVVDLFFBQVE7UUFBQztRQUVwRCxNQUFNbEYsMERBQVVBLENBQUNtRjtRQUNqQixNQUFNbEYsNkRBQWFBLENBQUNrRixNQUFNO0lBQzVCO0lBRUEsbURBQW1EO0lBQ25ELElBQUlGLFVBQVU5QyxNQUFNLEVBQUU7UUFDcEIsTUFBTWdELE9BQU8zRSxTQUNYVCxrREFBUUEsQ0FBQ3NGLGNBQWMsRUFDdkI7WUFBRS9DLE1BQU14QyxvREFBVUEsQ0FBQytCLFNBQVM7WUFBRWhCLElBQUlvRSxVQUFVcEUsRUFBRTtRQUFDLEdBQy9DO1lBQUV5QixNQUFNeEMsb0RBQVVBLENBQUNtQyxJQUFJO1lBQUVwQixJQUFJb0UsVUFBVTlDLE1BQU07UUFBQztRQUVoRCxNQUFNbkMsMERBQVVBLENBQUNtRjtRQUNqQixNQUFNbEYsNkRBQWFBLENBQUNrRixNQUFNO0lBQzVCO0FBQ0Y7QUFFTyxlQUFlbkQscUJBQXFCc0QsTUFBYztJQUN2RCwrQ0FBK0M7SUFDL0MsSUFBSUEsT0FBT0MsWUFBWSxJQUFJRCxPQUFPQyxZQUFZLENBQUNuQixNQUFNLEdBQUcsR0FBRztRQUN6RCxLQUFLLE1BQU0zQixlQUFlNkMsT0FBT0MsWUFBWSxDQUFFO1lBQzdDLE1BQU1KLE9BQU8zRSxTQUNYVCxrREFBUUEsQ0FBQ3lGLGdCQUFnQixFQUN6QjtnQkFBRWxELE1BQU14QyxvREFBVUEsQ0FBQ2lDLE1BQU07Z0JBQUVsQixJQUFJeUUsT0FBT3pFLEVBQUU7WUFBQyxHQUN6QztnQkFBRXlCLE1BQU14QyxvREFBVUEsQ0FBQytCLFNBQVM7Z0JBQUVoQixJQUFJNEI7WUFBWTtZQUVoRCxNQUFNekMsMERBQVVBLENBQUNtRjtZQUNqQixNQUFNbEYsNkRBQWFBLENBQUNrRixNQUFNO1FBQzVCO0lBQ0Y7QUFFQSw2RUFBNkU7QUFDL0UsRUFFQSx1RUFBdUU7Q0FDdkUsNEZBQTRGO0NBQzVGLGlGQUFpRiIsInNvdXJjZXMiOlsid2VicGFjazovL19OX0UvLi9saW5rcy9saW5rcy13b3JrZmxvd3MudHM/YTFiZCJdLCJzb3VyY2VzQ29udGVudCI6WyIvLyBsaW5rcy9saW5rcy13b3JrZmxvd3MudHNcclxuLy8gVW5pdmVyc2FsIGVudHJ5IHBvaW50IGZvciBjcmVhdGluZyBsaW5rcyBmcm9tIGVudGl0aWVzIChwcm9wZXJ0eSBpbnNwZWN0aW9uKVxyXG5cclxuaW1wb3J0IHsgRW50aXR5VHlwZSwgTGlua1R5cGUgfSBmcm9tICdAL3R5cGVzL2VudW1zJztcclxuaW1wb3J0IHR5cGUgeyBUYXNrLCBJdGVtLCBTYWxlLCBGaW5hbmNpYWxSZWNvcmQsIENoYXJhY3RlciwgUGxheWVyLCBTaXRlLCBMaW5rIH0gZnJvbSAnQC90eXBlcy9lbnRpdGllcyc7XHJcbmltcG9ydCB7IGNyZWF0ZUxpbmsgfSBmcm9tICcuL2xpbmstcmVnaXN0cnknO1xyXG5pbXBvcnQgeyBhcHBlbmRMaW5rTG9nIH0gZnJvbSAnLi9saW5rcy1sb2dnaW5nJztcclxuaW1wb3J0IHsgZ2V0QWxsSXRlbXMgfSBmcm9tICdAL2RhdGEtc3RvcmUvZGF0YXN0b3JlJztcclxuaW1wb3J0IHsgdjQgYXMgdXVpZCB9IGZyb20gJ3V1aWQnO1xyXG5pbXBvcnQgeyBpc1Byb2Nlc3NpbmcsIHN0YXJ0UHJvY2Vzc2luZywgZW5kUHJvY2Vzc2luZyB9IGZyb20gJ0AvZGF0YS1zdG9yZS9lZmZlY3RzLXJlZ2lzdHJ5JztcclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBtYWtlTGluayhsaW5rVHlwZTogTGlua1R5cGUsIHNvdXJjZTogeyB0eXBlOiBFbnRpdHlUeXBlOyBpZDogc3RyaW5nIH0sIHRhcmdldDogeyB0eXBlOiBFbnRpdHlUeXBlOyBpZDogc3RyaW5nIH0sIG1ldGFkYXRhPzogUmVjb3JkPHN0cmluZywgYW55Pik6IExpbmsge1xyXG4gIHJldHVybiB7XHJcbiAgICBpZDogdXVpZCgpLFxyXG4gICAgbGlua1R5cGUsXHJcbiAgICBzb3VyY2UsXHJcbiAgICB0YXJnZXQsXHJcbiAgICBjcmVhdGVkQXQ6IG5ldyBEYXRlKCksXHJcbiAgICBtZXRhZGF0YSxcclxuICB9O1xyXG59XHJcblxyXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gcHJvY2Vzc0xpbmtFbnRpdHkoZW50aXR5OiBhbnksIGVudGl0eVR5cGU6IEVudGl0eVR5cGUpOiBQcm9taXNlPHZvaWQ+IHtcclxuICAvLyBDaGVjayBmb3IgY2lyY3VsYXIgcmVmZXJlbmNlXHJcbiAgaWYgKGlzUHJvY2Vzc2luZyhlbnRpdHlUeXBlLCBlbnRpdHkuaWQpKSB7XHJcbiAgICBjb25zb2xlLndhcm4oYFtDaXJjdWl0QnJlYWtlcl0gQWxyZWFkeSBwcm9jZXNzaW5nICR7ZW50aXR5VHlwZX06JHtlbnRpdHkuaWR9IC0gc2tpcHBpbmcgdG8gcHJldmVudCBjaXJjdWxhciByZWZlcmVuY2VgKTtcclxuICAgIHJldHVybjtcclxuICB9XHJcbiAgXHJcbiAgdHJ5IHtcclxuICAgIHN0YXJ0UHJvY2Vzc2luZyhlbnRpdHlUeXBlLCBlbnRpdHkuaWQpO1xyXG4gICAgXHJcbiAgICBzd2l0Y2ggKGVudGl0eVR5cGUpIHtcclxuICAgICAgY2FzZSBFbnRpdHlUeXBlLlRBU0s6XHJcbiAgICAgICAgYXdhaXQgcHJvY2Vzc1Rhc2tFZmZlY3RzKGVudGl0eSBhcyBUYXNrKTtcclxuICAgICAgICBicmVhaztcclxuICAgICAgY2FzZSBFbnRpdHlUeXBlLklURU06XHJcbiAgICAgICAgYXdhaXQgcHJvY2Vzc0l0ZW1FZmZlY3RzKGVudGl0eSBhcyBJdGVtKTtcclxuICAgICAgICBicmVhaztcclxuICAgICAgY2FzZSBFbnRpdHlUeXBlLlNBTEU6XHJcbiAgICAgICAgYXdhaXQgcHJvY2Vzc1NhbGVFZmZlY3RzKGVudGl0eSBhcyBTYWxlKTtcclxuICAgICAgICBicmVhaztcclxuICAgICAgY2FzZSBFbnRpdHlUeXBlLkZJTkFOQ0lBTDpcclxuICAgICAgICBhd2FpdCBwcm9jZXNzRmluYW5jaWFsRWZmZWN0cyhlbnRpdHkgYXMgRmluYW5jaWFsUmVjb3JkKTtcclxuICAgICAgICBicmVhaztcclxuICAgICAgY2FzZSBFbnRpdHlUeXBlLkNIQVJBQ1RFUjpcclxuICAgICAgICBhd2FpdCBwcm9jZXNzQ2hhcmFjdGVyRWZmZWN0cyhlbnRpdHkgYXMgQ2hhcmFjdGVyKTtcclxuICAgICAgICBicmVhaztcclxuICAgICAgY2FzZSBFbnRpdHlUeXBlLlBMQVlFUjpcclxuICAgICAgICBhd2FpdCBwcm9jZXNzUGxheWVyRWZmZWN0cyhlbnRpdHkgYXMgUGxheWVyKTtcclxuICAgICAgICBicmVhaztcclxuICAgICAgY2FzZSBFbnRpdHlUeXBlLlNJVEU6XHJcbiAgICAgICAgLy8gU2l0ZXMgZG9uJ3QgY3JlYXRlIGxpbmtzIHdoZW4gc2F2ZWQgLSB0aGV5J3JlIGxpbmsgdGFyZ2V0cyBvbmx5XHJcbiAgICAgICAgLy8gU0lURV9TSVRFIGxpbmtzIGNyZWF0ZWQgYnkgbW92ZW1lbnQgb3BlcmF0aW9ucyAod29ya2Zsb3dzL3NpdGUtbW92ZW1lbnQtdXRpbHMudHMpXHJcbiAgICAgICAgYnJlYWs7XHJcbiAgICAgIGRlZmF1bHQ6XHJcbiAgICAgICAgcmV0dXJuO1xyXG4gICAgfVxyXG4gIH0gZmluYWxseSB7XHJcbiAgICBlbmRQcm9jZXNzaW5nKGVudGl0eVR5cGUsIGVudGl0eS5pZCk7XHJcbiAgfVxyXG59XHJcblxyXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gcHJvY2Vzc1Rhc2tFZmZlY3RzKHRhc2s6IFRhc2spOiBQcm9taXNlPHZvaWQ+IHtcclxuICBpZiAodGFzay5zaXRlSWQpIHtcclxuICAgIGNvbnN0IGwgPSBtYWtlTGluayhMaW5rVHlwZS5UQVNLX1NJVEUsIHsgdHlwZTogRW50aXR5VHlwZS5UQVNLLCBpZDogdGFzay5pZCB9LCB7IHR5cGU6IEVudGl0eVR5cGUuU0lURSwgaWQ6IHRhc2suc2l0ZUlkIH0pO1xyXG4gICAgYXdhaXQgY3JlYXRlTGluayhsKTtcclxuICAgIGF3YWl0IGFwcGVuZExpbmtMb2cobCwgJ2NyZWF0ZWQnKTtcclxuICB9XHJcbiAgaWYgKHRhc2sub3V0cHV0SXRlbUlkKSB7XHJcbiAgICBjb25zdCBsID0gbWFrZUxpbmsoTGlua1R5cGUuVEFTS19JVEVNLCB7IHR5cGU6IEVudGl0eVR5cGUuVEFTSywgaWQ6IHRhc2suaWQgfSwgeyB0eXBlOiBFbnRpdHlUeXBlLklURU0sIGlkOiB0YXNrLm91dHB1dEl0ZW1JZCB9KTtcclxuICAgIGF3YWl0IGNyZWF0ZUxpbmsobCk7XHJcbiAgICBhd2FpdCBhcHBlbmRMaW5rTG9nKGwsICdjcmVhdGVkJyk7XHJcbiAgfVxyXG4gIFxyXG4gIC8vIFRBU0tfQ0hBUkFDVEVSIGxpbmtcclxuICBpZiAodGFzay5jaGFyYWN0ZXJJZCkge1xyXG4gICAgY29uc3QgbCA9IG1ha2VMaW5rKFxyXG4gICAgICBMaW5rVHlwZS5UQVNLX0NIQVJBQ1RFUixcclxuICAgICAgeyB0eXBlOiBFbnRpdHlUeXBlLlRBU0ssIGlkOiB0YXNrLmlkIH0sXHJcbiAgICAgIHsgdHlwZTogRW50aXR5VHlwZS5DSEFSQUNURVIsIGlkOiB0YXNrLmNoYXJhY3RlcklkIH1cclxuICAgICk7XHJcbiAgICBhd2FpdCBjcmVhdGVMaW5rKGwpO1xyXG4gICAgYXdhaXQgYXBwZW5kTGlua0xvZyhsLCAnY3JlYXRlZCcpO1xyXG4gIH1cclxuICBcclxuICAvLyBDcmVhdGUgVEFTS19JVEVNIGxpbmsgZm9yIGl0ZW1zIGNyZWF0ZWQgZnJvbSB0YXNrIGVtaXNzYXJ5IGZpZWxkc1xyXG4gIGlmICh0YXNrLm91dHB1dEl0ZW1UeXBlICYmIHRhc2sub3V0cHV0UXVhbnRpdHkgJiYgdGFzay5zdGF0dXMgPT09ICdEb25lJykge1xyXG4gICAgLy8gRmluZCB0aGUgaXRlbSBjcmVhdGVkIGJ5IHRoaXMgdGFza1xyXG4gICAgY29uc3QgaXRlbXMgPSBhd2FpdCBnZXRBbGxJdGVtcygpO1xyXG4gICAgY29uc3QgY3JlYXRlZEl0ZW0gPSBpdGVtcy5maW5kKGl0ZW0gPT4gaXRlbS5zb3VyY2VUYXNrSWQgPT09IHRhc2suaWQgJiYgaXRlbS50eXBlID09PSB0YXNrLm91dHB1dEl0ZW1UeXBlKTtcclxuICAgIFxyXG4gICAgaWYgKGNyZWF0ZWRJdGVtKSB7XHJcbiAgICAgIGNvbnN0IGwgPSBtYWtlTGluayhcclxuICAgICAgICBMaW5rVHlwZS5UQVNLX0lURU0sIFxyXG4gICAgICAgIHsgdHlwZTogRW50aXR5VHlwZS5UQVNLLCBpZDogdGFzay5pZCB9LCBcclxuICAgICAgICB7IHR5cGU6IEVudGl0eVR5cGUuSVRFTSwgaWQ6IGNyZWF0ZWRJdGVtLmlkIH0sXHJcbiAgICAgICAge1xyXG4gICAgICAgICAgcXVhbnRpdHk6IHRhc2sub3V0cHV0UXVhbnRpdHksXHJcbiAgICAgICAgICB1bml0Q29zdDogdGFzay5vdXRwdXRVbml0Q29zdCxcclxuICAgICAgICAgIHByaWNlOiB0YXNrLm91dHB1dEl0ZW1QcmljZSxcclxuICAgICAgICAgIGl0ZW1UeXBlOiB0YXNrLm91dHB1dEl0ZW1UeXBlXHJcbiAgICAgICAgfVxyXG4gICAgICApO1xyXG4gICAgICBhd2FpdCBjcmVhdGVMaW5rKGwpO1xyXG4gICAgICBhd2FpdCBhcHBlbmRMaW5rTG9nKGwsICdjcmVhdGVkJyk7XHJcbiAgICB9XHJcbiAgfVxyXG4gIFxyXG4gIC8vIE5vdGU6IFRBU0tfUExBWUVSIGhhbmRsZWQgYnkgcG9pbnRzLXJld2FyZHMtdXRpbHMudHMg4pyFXHJcbiAgLy8gTm90ZTogVEFTS19GSU5SRUMgaGFuZGxlZCBieSBmaW5hbmNpYWwtcmVjb3JkLXV0aWxzLnRzIOKchVxyXG59XHJcblxyXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gcHJvY2Vzc0l0ZW1FZmZlY3RzKGl0ZW06IEl0ZW0pOiBQcm9taXNlPHZvaWQ+IHtcclxuICBpZiAoaXRlbS5zb3VyY2VUYXNrSWQpIHtcclxuICAgIGNvbnN0IGwgPSBtYWtlTGluayhMaW5rVHlwZS5JVEVNX1RBU0ssIHsgdHlwZTogRW50aXR5VHlwZS5JVEVNLCBpZDogaXRlbS5pZCB9LCB7IHR5cGU6IEVudGl0eVR5cGUuVEFTSywgaWQ6IGl0ZW0uc291cmNlVGFza0lkIH0pO1xyXG4gICAgYXdhaXQgY3JlYXRlTGluayhsKTtcclxuICAgIGF3YWl0IGFwcGVuZExpbmtMb2cobCwgJ2NyZWF0ZWQnKTtcclxuICB9XHJcbiAgZm9yIChjb25zdCBzIG9mIGl0ZW0uc3RvY2sgfHwgW10pIHtcclxuICAgIGlmIChzLnNpdGVJZCkge1xyXG4gICAgICBjb25zdCBsID0gbWFrZUxpbmsoTGlua1R5cGUuSVRFTV9TSVRFLCB7IHR5cGU6IEVudGl0eVR5cGUuSVRFTSwgaWQ6IGl0ZW0uaWQgfSwgeyB0eXBlOiBFbnRpdHlUeXBlLlNJVEUsIGlkOiBzLnNpdGVJZCB9KTtcclxuICAgICAgYXdhaXQgY3JlYXRlTGluayhsKTtcclxuICAgICAgYXdhaXQgYXBwZW5kTGlua0xvZyhsLCAnY3JlYXRlZCcpO1xyXG4gICAgfVxyXG4gIH1cclxuICBcclxuICAvLyBJVEVNX0NIQVJBQ1RFUiBsaW5rXHJcbiAgaWYgKGl0ZW0ub3duZXJDaGFyYWN0ZXJJZCkge1xyXG4gICAgY29uc3QgbCA9IG1ha2VMaW5rKFxyXG4gICAgICBMaW5rVHlwZS5JVEVNX0NIQVJBQ1RFUixcclxuICAgICAgeyB0eXBlOiBFbnRpdHlUeXBlLklURU0sIGlkOiBpdGVtLmlkIH0sXHJcbiAgICAgIHsgdHlwZTogRW50aXR5VHlwZS5DSEFSQUNURVIsIGlkOiBpdGVtLm93bmVyQ2hhcmFjdGVySWQgfVxyXG4gICAgKTtcclxuICAgIGF3YWl0IGNyZWF0ZUxpbmsobCk7XHJcbiAgICBhd2FpdCBhcHBlbmRMaW5rTG9nKGwsICdjcmVhdGVkJyk7XHJcbiAgfVxyXG4gIFxyXG4gIC8vIE5vdGU6IElURU1fU0FMRSBsaW5rcyBoYW5kbGVkIGluIHByb2Nlc3NTYWxlRWZmZWN0cyAoZnJvbSBzYWxlLmxpbmVzKVxyXG59XHJcblxyXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gcHJvY2Vzc1NhbGVFZmZlY3RzKHNhbGU6IFNhbGUpOiBQcm9taXNlPHZvaWQ+IHtcclxuICBpZiAoc2FsZS5zaXRlSWQpIHtcclxuICAgIGNvbnN0IGwgPSBtYWtlTGluayhMaW5rVHlwZS5TQUxFX1NJVEUsIHsgdHlwZTogRW50aXR5VHlwZS5TQUxFLCBpZDogc2FsZS5pZCB9LCB7IHR5cGU6IEVudGl0eVR5cGUuU0lURSwgaWQ6IHNhbGUuc2l0ZUlkIH0pO1xyXG4gICAgYXdhaXQgY3JlYXRlTGluayhsKTtcclxuICAgIGF3YWl0IGFwcGVuZExpbmtMb2cobCwgJ2NyZWF0ZWQnKTtcclxuICB9XHJcbiAgXHJcbiAgLy8gU0FMRV9DSEFSQUNURVIgbGlua1xyXG4gIGlmIChzYWxlLmN1c3RvbWVySWQpIHtcclxuICAgIGNvbnN0IGwgPSBtYWtlTGluayhcclxuICAgICAgTGlua1R5cGUuU0FMRV9DSEFSQUNURVIsXHJcbiAgICAgIHsgdHlwZTogRW50aXR5VHlwZS5TQUxFLCBpZDogc2FsZS5pZCB9LFxyXG4gICAgICB7IHR5cGU6IEVudGl0eVR5cGUuQ0hBUkFDVEVSLCBpZDogc2FsZS5jdXN0b21lcklkIH1cclxuICAgICk7XHJcbiAgICBhd2FpdCBjcmVhdGVMaW5rKGwpO1xyXG4gICAgYXdhaXQgYXBwZW5kTGlua0xvZyhsLCAnY3JlYXRlZCcpO1xyXG4gIH1cclxuICBcclxuICAvLyBTQUxFX0lURU0gbGlua3MgKGZyb20gc2FsZSBsaW5lcylcclxuICBpZiAoc2FsZS5saW5lcyAmJiBzYWxlLmxpbmVzLmxlbmd0aCA+IDApIHtcclxuICAgIGZvciAoY29uc3QgbGluZSBvZiBzYWxlLmxpbmVzKSB7XHJcbiAgICAgIGlmIChsaW5lLmtpbmQgPT09ICdpdGVtJyAmJiBsaW5lLml0ZW1JZCkge1xyXG4gICAgICAgIGNvbnN0IGwgPSBtYWtlTGluayhcclxuICAgICAgICAgIExpbmtUeXBlLlNBTEVfSVRFTSxcclxuICAgICAgICAgIHsgdHlwZTogRW50aXR5VHlwZS5TQUxFLCBpZDogc2FsZS5pZCB9LFxyXG4gICAgICAgICAgeyB0eXBlOiBFbnRpdHlUeXBlLklURU0sIGlkOiBsaW5lLml0ZW1JZCB9LFxyXG4gICAgICAgICAgeyBxdWFudGl0eTogbGluZS5xdWFudGl0eSwgdW5pdFByaWNlOiBsaW5lLnVuaXRQcmljZSB9XHJcbiAgICAgICAgKTtcclxuICAgICAgICBhd2FpdCBjcmVhdGVMaW5rKGwpO1xyXG4gICAgICAgIGF3YWl0IGFwcGVuZExpbmtMb2cobCwgJ2NyZWF0ZWQnKTtcclxuICAgICAgfVxyXG4gICAgfVxyXG4gIH1cclxuICBcclxuICAvLyBTQUxFX1RBU0sgbGluayAoaWYgc2FsZSBzcGF3bmVkIGZyb20gdGFzaylcclxuICBpZiAoc2FsZS5zb3VyY2VUYXNrSWQpIHtcclxuICAgIGNvbnN0IGwgPSBtYWtlTGluayhcclxuICAgICAgTGlua1R5cGUuU0FMRV9UQVNLLFxyXG4gICAgICB7IHR5cGU6IEVudGl0eVR5cGUuU0FMRSwgaWQ6IHNhbGUuaWQgfSxcclxuICAgICAgeyB0eXBlOiBFbnRpdHlUeXBlLlRBU0ssIGlkOiBzYWxlLnNvdXJjZVRhc2tJZCB9XHJcbiAgICApO1xyXG4gICAgYXdhaXQgY3JlYXRlTGluayhsKTtcclxuICAgIGF3YWl0IGFwcGVuZExpbmtMb2cobCwgJ2NyZWF0ZWQnKTtcclxuICB9XHJcbiAgXHJcbiAgLy8gTm90ZTogU0FMRV9QTEFZRVIgaGFuZGxlZCBieSBwb2ludHMtcmV3YXJkcy11dGlscy50cyDinIVcclxufVxyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIHByb2Nlc3NGaW5hbmNpYWxFZmZlY3RzKGZpbjogRmluYW5jaWFsUmVjb3JkKTogUHJvbWlzZTx2b2lkPiB7XHJcbiAgaWYgKGZpbi5zaXRlSWQpIHtcclxuICAgIGNvbnN0IGwgPSBtYWtlTGluayhMaW5rVHlwZS5GSU5SRUNfU0lURSwgeyB0eXBlOiBFbnRpdHlUeXBlLkZJTkFOQ0lBTCwgaWQ6IGZpbi5pZCB9LCB7IHR5cGU6IEVudGl0eVR5cGUuU0lURSwgaWQ6IGZpbi5zaXRlSWQgfSk7XHJcbiAgICBhd2FpdCBjcmVhdGVMaW5rKGwpO1xyXG4gICAgYXdhaXQgYXBwZW5kTGlua0xvZyhsLCAnY3JlYXRlZCcpO1xyXG4gIH1cclxuICBcclxuICAvLyBGSU5SRUNfQ0hBUkFDVEVSIGxpbmtcclxuICBpZiAoZmluLmN1c3RvbWVyQ2hhcmFjdGVySWQpIHtcclxuICAgIGNvbnN0IGwgPSBtYWtlTGluayhcclxuICAgICAgTGlua1R5cGUuRklOUkVDX0NIQVJBQ1RFUixcclxuICAgICAgeyB0eXBlOiBFbnRpdHlUeXBlLkZJTkFOQ0lBTCwgaWQ6IGZpbi5pZCB9LFxyXG4gICAgICB7IHR5cGU6IEVudGl0eVR5cGUuQ0hBUkFDVEVSLCBpZDogZmluLmN1c3RvbWVyQ2hhcmFjdGVySWQgfVxyXG4gICAgKTtcclxuICAgIGF3YWl0IGNyZWF0ZUxpbmsobCk7XHJcbiAgICBhd2FpdCBhcHBlbmRMaW5rTG9nKGwsICdjcmVhdGVkJyk7XHJcbiAgfVxyXG4gIFxyXG4gIC8vIENyZWF0ZSBGSU5SRUNfSVRFTSBsaW5rIGZvciBpdGVtcyBjcmVhdGVkIGZyb20gZmluYW5jaWFsIHJlY29yZCBlbWlzc2FyeSBmaWVsZHNcclxuICBpZiAoZmluLm91dHB1dEl0ZW1UeXBlICYmIGZpbi5vdXRwdXRRdWFudGl0eSkge1xyXG4gICAgLy8gRmluZCB0aGUgaXRlbSBjcmVhdGVkIGJ5IHRoaXMgZmluYW5jaWFsIHJlY29yZFxyXG4gICAgY29uc3QgaXRlbXMgPSBhd2FpdCBnZXRBbGxJdGVtcygpO1xyXG4gICAgY29uc3QgY3JlYXRlZEl0ZW0gPSBpdGVtcy5maW5kKGl0ZW0gPT4gaXRlbS5zb3VyY2VSZWNvcmRJZCA9PT0gZmluLmlkICYmIGl0ZW0udHlwZSA9PT0gZmluLm91dHB1dEl0ZW1UeXBlKTtcclxuICAgIFxyXG4gICAgaWYgKGNyZWF0ZWRJdGVtKSB7XHJcbiAgICAgIGNvbnN0IGwgPSBtYWtlTGluayhcclxuICAgICAgICBMaW5rVHlwZS5GSU5SRUNfSVRFTSwgXHJcbiAgICAgICAgeyB0eXBlOiBFbnRpdHlUeXBlLkZJTkFOQ0lBTCwgaWQ6IGZpbi5pZCB9LCBcclxuICAgICAgICB7IHR5cGU6IEVudGl0eVR5cGUuSVRFTSwgaWQ6IGNyZWF0ZWRJdGVtLmlkIH0sXHJcbiAgICAgICAge1xyXG4gICAgICAgICAgcXVhbnRpdHk6IGZpbi5vdXRwdXRRdWFudGl0eSxcclxuICAgICAgICAgIHVuaXRDb3N0OiBmaW4ub3V0cHV0VW5pdENvc3QsXHJcbiAgICAgICAgICBwcmljZTogZmluLm91dHB1dEl0ZW1QcmljZSxcclxuICAgICAgICAgIGl0ZW1UeXBlOiBmaW4ub3V0cHV0SXRlbVR5cGVcclxuICAgICAgICB9XHJcbiAgICAgICk7XHJcbiAgICAgIGF3YWl0IGNyZWF0ZUxpbmsobCk7XHJcbiAgICAgIGF3YWl0IGFwcGVuZExpbmtMb2cobCwgJ2NyZWF0ZWQnKTtcclxuICAgIH1cclxuICB9XHJcbiAgXHJcbiAgLy8gTm90ZTogRklOUkVDX1RBU0sgaGFuZGxlZCBieSBmaW5hbmNpYWwtcmVjb3JkLXV0aWxzLnRzIOKchVxyXG4gIC8vIE5vdGU6IEZJTlJFQ19QTEFZRVIgaGFuZGxlZCBieSBwb2ludHMtcmV3YXJkcy11dGlscy50cyDinIVcclxufVxyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIHByb2Nlc3NDaGFyYWN0ZXJFZmZlY3RzKGNoYXJhY3RlcjogQ2hhcmFjdGVyKTogUHJvbWlzZTx2b2lkPiB7XHJcbiAgLy8gQ0hBUkFDVEVSX1BMQVlFUiBsaW5rXHJcbiAgaWYgKGNoYXJhY3Rlci5wbGF5ZXJJZCkge1xyXG4gICAgY29uc3QgbGluayA9IG1ha2VMaW5rKFxyXG4gICAgICBMaW5rVHlwZS5DSEFSQUNURVJfUExBWUVSLFxyXG4gICAgICB7IHR5cGU6IEVudGl0eVR5cGUuQ0hBUkFDVEVSLCBpZDogY2hhcmFjdGVyLmlkIH0sXHJcbiAgICAgIHsgdHlwZTogRW50aXR5VHlwZS5QTEFZRVIsIGlkOiBjaGFyYWN0ZXIucGxheWVySWQgfVxyXG4gICAgKTtcclxuICAgIGF3YWl0IGNyZWF0ZUxpbmsobGluayk7XHJcbiAgICBhd2FpdCBhcHBlbmRMaW5rTG9nKGxpbmssICdjcmVhdGVkJyk7XHJcbiAgfVxyXG4gIFxyXG4gIC8vIENIQVJBQ1RFUl9TSVRFIGxpbmsgKGlmIGNoYXJhY3RlciBoYXMgaG9tZSBzaXRlKVxyXG4gIGlmIChjaGFyYWN0ZXIuc2l0ZUlkKSB7XHJcbiAgICBjb25zdCBsaW5rID0gbWFrZUxpbmsoXHJcbiAgICAgIExpbmtUeXBlLkNIQVJBQ1RFUl9TSVRFLFxyXG4gICAgICB7IHR5cGU6IEVudGl0eVR5cGUuQ0hBUkFDVEVSLCBpZDogY2hhcmFjdGVyLmlkIH0sXHJcbiAgICAgIHsgdHlwZTogRW50aXR5VHlwZS5TSVRFLCBpZDogY2hhcmFjdGVyLnNpdGVJZCB9XHJcbiAgICApO1xyXG4gICAgYXdhaXQgY3JlYXRlTGluayhsaW5rKTtcclxuICAgIGF3YWl0IGFwcGVuZExpbmtMb2cobGluaywgJ2NyZWF0ZWQnKTtcclxuICB9XHJcbn1cclxuXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBwcm9jZXNzUGxheWVyRWZmZWN0cyhwbGF5ZXI6IFBsYXllcik6IFByb21pc2U8dm9pZD4ge1xyXG4gIC8vIFBMQVlFUl9DSEFSQUNURVIgbGlua3MgKGFycmF5IG9mIGNoYXJhY3RlcnMpXHJcbiAgaWYgKHBsYXllci5jaGFyYWN0ZXJJZHMgJiYgcGxheWVyLmNoYXJhY3Rlcklkcy5sZW5ndGggPiAwKSB7XHJcbiAgICBmb3IgKGNvbnN0IGNoYXJhY3RlcklkIG9mIHBsYXllci5jaGFyYWN0ZXJJZHMpIHtcclxuICAgICAgY29uc3QgbGluayA9IG1ha2VMaW5rKFxyXG4gICAgICAgIExpbmtUeXBlLlBMQVlFUl9DSEFSQUNURVIsXHJcbiAgICAgICAgeyB0eXBlOiBFbnRpdHlUeXBlLlBMQVlFUiwgaWQ6IHBsYXllci5pZCB9LFxyXG4gICAgICAgIHsgdHlwZTogRW50aXR5VHlwZS5DSEFSQUNURVIsIGlkOiBjaGFyYWN0ZXJJZCB9XHJcbiAgICAgICk7XHJcbiAgICAgIGF3YWl0IGNyZWF0ZUxpbmsobGluayk7XHJcbiAgICAgIGF3YWl0IGFwcGVuZExpbmtMb2cobGluaywgJ2NyZWF0ZWQnKTtcclxuICAgIH1cclxuICB9XHJcbiAgXHJcbiAgLy8gTm90ZTogUExBWUVSX1NJVEUgbGlua3Mgbm90IGltcGxlbWVudGVkIC0gUGxheWVyIGRvZXNuJ3QgaGF2ZSBzaXRlSWQgZmllbGRcclxufVxyXG5cclxuLy8gU2l0ZXMgZG9uJ3QgY3JlYXRlIGxpbmtzIHdoZW4gc2F2ZWQgLSB0aGV5J3JlIHByaW1hcmlseSBsaW5rIHRhcmdldHNcclxuLy8gU0lURV9TSVRFIGxpbmtzIGFyZSBjcmVhdGVkIGJ5IG1vdmVtZW50IG9wZXJhdGlvbnMgKHNlZSB3b3JrZmxvd3Mvc2l0ZS1tb3ZlbWVudC11dGlscy50cylcclxuLy8gTm8gcHJvY2Vzc1NpdGVFZmZlY3RzIGZ1bmN0aW9uIG5lZWRlZCAtIHNpdGVzIGhhdmUgbm8gbGluay1jcmVhdGluZyBwcm9wZXJ0aWVzXHJcblxyXG5cclxuIl0sIm5hbWVzIjpbIkVudGl0eVR5cGUiLCJMaW5rVHlwZSIsImNyZWF0ZUxpbmsiLCJhcHBlbmRMaW5rTG9nIiwiZ2V0QWxsSXRlbXMiLCJ2NCIsInV1aWQiLCJpc1Byb2Nlc3NpbmciLCJzdGFydFByb2Nlc3NpbmciLCJlbmRQcm9jZXNzaW5nIiwibWFrZUxpbmsiLCJsaW5rVHlwZSIsInNvdXJjZSIsInRhcmdldCIsIm1ldGFkYXRhIiwiaWQiLCJjcmVhdGVkQXQiLCJEYXRlIiwicHJvY2Vzc0xpbmtFbnRpdHkiLCJlbnRpdHkiLCJlbnRpdHlUeXBlIiwiY29uc29sZSIsIndhcm4iLCJUQVNLIiwicHJvY2Vzc1Rhc2tFZmZlY3RzIiwiSVRFTSIsInByb2Nlc3NJdGVtRWZmZWN0cyIsIlNBTEUiLCJwcm9jZXNzU2FsZUVmZmVjdHMiLCJGSU5BTkNJQUwiLCJwcm9jZXNzRmluYW5jaWFsRWZmZWN0cyIsIkNIQVJBQ1RFUiIsInByb2Nlc3NDaGFyYWN0ZXJFZmZlY3RzIiwiUExBWUVSIiwicHJvY2Vzc1BsYXllckVmZmVjdHMiLCJTSVRFIiwidGFzayIsInNpdGVJZCIsImwiLCJUQVNLX1NJVEUiLCJ0eXBlIiwib3V0cHV0SXRlbUlkIiwiVEFTS19JVEVNIiwiY2hhcmFjdGVySWQiLCJUQVNLX0NIQVJBQ1RFUiIsIm91dHB1dEl0ZW1UeXBlIiwib3V0cHV0UXVhbnRpdHkiLCJzdGF0dXMiLCJpdGVtcyIsImNyZWF0ZWRJdGVtIiwiZmluZCIsIml0ZW0iLCJzb3VyY2VUYXNrSWQiLCJxdWFudGl0eSIsInVuaXRDb3N0Iiwib3V0cHV0VW5pdENvc3QiLCJwcmljZSIsIm91dHB1dEl0ZW1QcmljZSIsIml0ZW1UeXBlIiwiSVRFTV9UQVNLIiwicyIsInN0b2NrIiwiSVRFTV9TSVRFIiwib3duZXJDaGFyYWN0ZXJJZCIsIklURU1fQ0hBUkFDVEVSIiwic2FsZSIsIlNBTEVfU0lURSIsImN1c3RvbWVySWQiLCJTQUxFX0NIQVJBQ1RFUiIsImxpbmVzIiwibGVuZ3RoIiwibGluZSIsImtpbmQiLCJpdGVtSWQiLCJTQUxFX0lURU0iLCJ1bml0UHJpY2UiLCJTQUxFX1RBU0siLCJmaW4iLCJGSU5SRUNfU0lURSIsImN1c3RvbWVyQ2hhcmFjdGVySWQiLCJGSU5SRUNfQ0hBUkFDVEVSIiwic291cmNlUmVjb3JkSWQiLCJGSU5SRUNfSVRFTSIsImNoYXJhY3RlciIsInBsYXllcklkIiwibGluayIsIkNIQVJBQ1RFUl9QTEFZRVIiLCJDSEFSQUNURVJfU0lURSIsInBsYXllciIsImNoYXJhY3RlcklkcyIsIlBMQVlFUl9DSEFSQUNURVIiXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(app-pages-browser)/./links/links-workflows.ts\n"));

/***/ }),

/***/ "(app-pages-browser)/./workflows/entities-logging.ts":
/*!***************************************!*\
  !*** ./workflows/entities-logging.ts ***!
  \***************************************/
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval(__webpack_require__.ts("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   appendBulkOperationLog: function() { return /* binding */ appendBulkOperationLog; },\n/* harmony export */   appendCharacterJungleCoinsLog: function() { return /* binding */ appendCharacterJungleCoinsLog; },\n/* harmony export */   appendEntityLog: function() { return /* binding */ appendEntityLog; },\n/* harmony export */   appendItemCreationLog: function() { return /* binding */ appendItemCreationLog; },\n/* harmony export */   appendPlayerPointsLog: function() { return /* binding */ appendPlayerPointsLog; },\n/* harmony export */   appendPlayerPointsUpdateLog: function() { return /* binding */ appendPlayerPointsUpdateLog; },\n/* harmony export */   updateEntityLogField: function() { return /* binding */ updateEntityLogField; }\n/* harmony export */ });\n/* harmony import */ var _data_store_kv__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @/data-store/kv */ \"(app-pages-browser)/./data-store/kv.ts\");\n/* harmony import */ var _data_store_keys__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @/data-store/keys */ \"(app-pages-browser)/./data-store/keys.ts\");\n/* harmony import */ var uuid__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! uuid */ \"(app-pages-browser)/./node_modules/uuid/dist/esm-browser/v4.js\");\n// workflows/entities-logging.ts\n// Append-only lifecycle logs + in-place field updates for descriptive changes\n\n\n\nasync function appendEntityLog(entityType, entityId, event, details) {\n    const key = (0,_data_store_keys__WEBPACK_IMPORTED_MODULE_1__.buildLogKey)(entityType);\n    const list = await (0,_data_store_kv__WEBPACK_IMPORTED_MODULE_0__.kvGet)(key) || [];\n    list.push({\n        event,\n        entityId,\n        ...details,\n        timestamp: new Date().toISOString()\n    });\n    await (0,_data_store_kv__WEBPACK_IMPORTED_MODULE_0__.kvSet)(key, list);\n}\nasync function updateEntityLogField(entityType, entityId, fieldName, oldValue, newValue) {\n    const key = (0,_data_store_keys__WEBPACK_IMPORTED_MODULE_1__.buildLogKey)(entityType);\n    const list = await (0,_data_store_kv__WEBPACK_IMPORTED_MODULE_0__.kvGet)(key) || [];\n    // Find the most recent log entry for this entity\n    for(let i = list.length - 1; i >= 0; i--){\n        var _list_i;\n        if (((_list_i = list[i]) === null || _list_i === void 0 ? void 0 : _list_i.entityId) === entityId) {\n            list[i][fieldName] = newValue;\n            list[i].lastUpdated = new Date().toISOString();\n            break;\n        }\n    }\n    await (0,_data_store_kv__WEBPACK_IMPORTED_MODULE_0__.kvSet)(key, list);\n}\nasync function appendBulkOperationLog(entityType, operation, details) {\n    const key = (0,_data_store_keys__WEBPACK_IMPORTED_MODULE_1__.buildLogKey)(entityType);\n    const list = await (0,_data_store_kv__WEBPACK_IMPORTED_MODULE_0__.kvGet)(key) || [];\n    const event = operation === \"import\" ? \"BULK_IMPORT\" : \"BULK_EXPORT\";\n    const operationId = (0,uuid__WEBPACK_IMPORTED_MODULE_2__[\"default\"])();\n    list.push({\n        event,\n        operationId,\n        operation,\n        count: details.count,\n        source: details.source,\n        importMode: details.importMode,\n        exportFormat: details.exportFormat,\n        extra: details.extra,\n        timestamp: new Date().toISOString()\n    });\n    await (0,_data_store_kv__WEBPACK_IMPORTED_MODULE_0__.kvSet)(key, list);\n}\n/**\r\n * Log item creation with source tracking\r\n * Used for items created from tasks, financial records, or directly\r\n */ async function appendItemCreationLog(item, sourceType, sourceId) {\n    var _item_stock, _item_stock1, _item_stock2;\n    const key = (0,_data_store_keys__WEBPACK_IMPORTED_MODULE_1__.buildLogKey)(\"item\");\n    const list = await (0,_data_store_kv__WEBPACK_IMPORTED_MODULE_0__.kvGet)(key) || [];\n    const logEntry = {\n        event: \"CREATED\",\n        entityId: item.id,\n        itemName: item.name,\n        itemType: item.type,\n        collection: item.collection,\n        status: item.status,\n        quantity: ((_item_stock = item.stock) === null || _item_stock === void 0 ? void 0 : _item_stock.reduce((sum, stock)=>sum + stock.quantity, 0)) || 0,\n        unitCost: item.unitCost || 0,\n        totalCost: (((_item_stock1 = item.stock) === null || _item_stock1 === void 0 ? void 0 : _item_stock1.reduce((sum, stock)=>sum + stock.quantity, 0)) || 0) * (item.unitCost || 0),\n        price: item.price || 0,\n        station: item.station,\n        category: item.category,\n        year: item.year,\n        sourceType,\n        sourceId,\n        description: \"Item created from \".concat(sourceType, \": \").concat(item.type, \" (\").concat(((_item_stock2 = item.stock) === null || _item_stock2 === void 0 ? void 0 : _item_stock2.reduce((sum, stock)=>sum + stock.quantity, 0)) || 0, \"x)\"),\n        timestamp: new Date().toISOString()\n    };\n    list.push(logEntry);\n    await (0,_data_store_kv__WEBPACK_IMPORTED_MODULE_0__.kvSet)(key, list);\n}\n/**\r\n * Log player points award with source tracking\r\n * Used for points awarded from tasks, financial records, or sales\r\n */ async function appendPlayerPointsLog(playerId, points, sourceId, sourceType) {\n    const key = (0,_data_store_keys__WEBPACK_IMPORTED_MODULE_1__.buildLogKey)(\"player\");\n    const list = await (0,_data_store_kv__WEBPACK_IMPORTED_MODULE_0__.kvGet)(key) || [];\n    const logEntry = {\n        event: \"POINTS_CHANGED\",\n        entityId: playerId,\n        points: points,\n        sourceId: sourceId,\n        sourceType: sourceType,\n        description: \"Points awarded from \".concat(sourceType, \": XP+\").concat(points.xp, \", RP+\").concat(points.rp, \", FP+\").concat(points.fp, \", HP+\").concat(points.hp),\n        timestamp: new Date().toISOString()\n    };\n    list.push(logEntry);\n    await (0,_data_store_kv__WEBPACK_IMPORTED_MODULE_0__.kvSet)(key, list);\n}\n/**\r\n * Log character jungle coins award with source tracking\r\n * Used for jungle coins awarded from financial records\r\n */ async function appendCharacterJungleCoinsLog(characterId, amount, sourceId, sourceType) {\n    const key = (0,_data_store_keys__WEBPACK_IMPORTED_MODULE_1__.buildLogKey)(\"character\");\n    const list = await (0,_data_store_kv__WEBPACK_IMPORTED_MODULE_0__.kvGet)(key) || [];\n    const logEntry = {\n        event: \"UPDATED\",\n        entityId: characterId,\n        jungleCoins: amount,\n        sourceId: sourceId,\n        sourceType: sourceType,\n        description: \"Jungle coins awarded from \".concat(sourceType, \": +\").concat(amount, \" J$\"),\n        timestamp: new Date().toISOString()\n    };\n    list.push(logEntry);\n    await (0,_data_store_kv__WEBPACK_IMPORTED_MODULE_0__.kvSet)(key, list);\n}\n/**\r\n * Log player points update with change tracking\r\n * Used when task rewards change and points need to be updated\r\n */ async function appendPlayerPointsUpdateLog(playerId, oldPoints, newPoints, sourceId) {\n    const key = (0,_data_store_keys__WEBPACK_IMPORTED_MODULE_1__.buildLogKey)(\"player\");\n    const list = await (0,_data_store_kv__WEBPACK_IMPORTED_MODULE_0__.kvGet)(key) || [];\n    const delta = {\n        xp: newPoints.xp - oldPoints.xp,\n        rp: newPoints.rp - oldPoints.rp,\n        fp: newPoints.fp - oldPoints.fp,\n        hp: newPoints.hp - oldPoints.hp\n    };\n    const logEntry = {\n        event: \"POINTS_CHANGED\",\n        entityId: playerId,\n        oldPoints: oldPoints,\n        newPoints: newPoints,\n        delta: delta,\n        sourceId: sourceId,\n        description: \"Points updated: XP\".concat(delta.xp >= 0 ? \"+\" : \"\").concat(delta.xp, \", RP\").concat(delta.rp >= 0 ? \"+\" : \"\").concat(delta.rp, \", FP\").concat(delta.fp >= 0 ? \"+\" : \"\").concat(delta.fp, \", HP\").concat(delta.hp >= 0 ? \"+\" : \"\").concat(delta.hp),\n        timestamp: new Date().toISOString()\n    };\n    list.push(logEntry);\n    await (0,_data_store_kv__WEBPACK_IMPORTED_MODULE_0__.kvSet)(key, list);\n}\n\n\n;\n    // Wrapped in an IIFE to avoid polluting the global scope\n    ;\n    (function () {\n        var _a, _b;\n        // Legacy CSS implementations will `eval` browser code in a Node.js context\n        // to extract CSS. For backwards compatibility, we need to check we're in a\n        // browser context before continuing.\n        if (typeof self !== 'undefined' &&\n            // AMP / No-JS mode does not inject these helpers:\n            '$RefreshHelpers$' in self) {\n            // @ts-ignore __webpack_module__ is global\n            var currentExports = module.exports;\n            // @ts-ignore __webpack_module__ is global\n            var prevSignature = (_b = (_a = module.hot.data) === null || _a === void 0 ? void 0 : _a.prevSignature) !== null && _b !== void 0 ? _b : null;\n            // This cannot happen in MainTemplate because the exports mismatch between\n            // templating and execution.\n            self.$RefreshHelpers$.registerExportsForReactRefresh(currentExports, module.id);\n            // A module can be accepted automatically based on its exports, e.g. when\n            // it is a Refresh Boundary.\n            if (self.$RefreshHelpers$.isReactRefreshBoundary(currentExports)) {\n                // Save the previous exports signature on update so we can compare the boundary\n                // signatures. We avoid saving exports themselves since it causes memory leaks (https://github.com/vercel/next.js/pull/53797)\n                module.hot.dispose(function (data) {\n                    data.prevSignature =\n                        self.$RefreshHelpers$.getRefreshBoundarySignature(currentExports);\n                });\n                // Unconditionally accept an update to this module, we'll check if it's\n                // still a Refresh Boundary later.\n                // @ts-ignore importMeta is replaced in the loader\n                module.hot.accept();\n                // This field is set when the previous version of this module was a\n                // Refresh Boundary, letting us know we need to check for invalidation or\n                // enqueue an update.\n                if (prevSignature !== null) {\n                    // A boundary can become ineligible if its exports are incompatible\n                    // with the previous exports.\n                    //\n                    // For example, if you add/remove/change exports, we'll want to\n                    // re-execute the importing modules, and force those components to\n                    // re-render. Similarly, if you convert a class component to a\n                    // function, we want to invalidate the boundary.\n                    if (self.$RefreshHelpers$.shouldInvalidateReactRefreshBoundary(prevSignature, self.$RefreshHelpers$.getRefreshBoundarySignature(currentExports))) {\n                        module.hot.invalidate();\n                    }\n                    else {\n                        self.$RefreshHelpers$.scheduleUpdate();\n                    }\n                }\n            }\n            else {\n                // Since we just executed the code for the module, it's possible that the\n                // new exports made it ineligible for being a boundary.\n                // We only care about the case when we were _previously_ a boundary,\n                // because we already accepted this update (accidental side effect).\n                var isNoLongerABoundary = prevSignature !== null;\n                if (isNoLongerABoundary) {\n                    module.hot.invalidate();\n                }\n            }\n        }\n    })();\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFwcC1wYWdlcy1icm93c2VyKS8uL3dvcmtmbG93cy9lbnRpdGllcy1sb2dnaW5nLnRzIiwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7Ozs7QUFBQSxnQ0FBZ0M7QUFDaEMsOEVBQThFO0FBRS9CO0FBQ0M7QUFDZDtBQUkzQixlQUFlSyxnQkFDcEJDLFVBQWtCLEVBQ2xCQyxRQUFnQixFQUNoQkMsS0FBZSxFQUNmQyxPQUE0QjtJQUU1QixNQUFNQyxNQUFNUiw2REFBV0EsQ0FBQ0k7SUFDeEIsTUFBTUssT0FBTyxNQUFPWCxxREFBS0EsQ0FBUVUsUUFBUyxFQUFFO0lBQzVDQyxLQUFLQyxJQUFJLENBQUM7UUFDUko7UUFDQUQ7UUFDQSxHQUFHRSxPQUFPO1FBQ1ZJLFdBQVcsSUFBSUMsT0FBT0MsV0FBVztJQUNuQztJQUNBLE1BQU1kLHFEQUFLQSxDQUFDUyxLQUFLQztBQUNuQjtBQUVPLGVBQWVLLHFCQUNwQlYsVUFBa0IsRUFDbEJDLFFBQWdCLEVBQ2hCVSxTQUFpQixFQUNqQkMsUUFBYSxFQUNiQyxRQUFhO0lBRWIsTUFBTVQsTUFBTVIsNkRBQVdBLENBQUNJO0lBQ3hCLE1BQU1LLE9BQU8sTUFBT1gscURBQUtBLENBQVFVLFFBQVMsRUFBRTtJQUU1QyxpREFBaUQ7SUFDakQsSUFBSyxJQUFJVSxJQUFJVCxLQUFLVSxNQUFNLEdBQUcsR0FBR0QsS0FBSyxHQUFHQSxJQUFLO1lBQ3JDVDtRQUFKLElBQUlBLEVBQUFBLFVBQUFBLElBQUksQ0FBQ1MsRUFBRSxjQUFQVCw4QkFBQUEsUUFBU0osUUFBUSxNQUFLQSxVQUFVO1lBQ2xDSSxJQUFJLENBQUNTLEVBQUUsQ0FBQ0gsVUFBVSxHQUFHRTtZQUNyQlIsSUFBSSxDQUFDUyxFQUFFLENBQUNFLFdBQVcsR0FBRyxJQUFJUixPQUFPQyxXQUFXO1lBQzVDO1FBQ0Y7SUFDRjtJQUVBLE1BQU1kLHFEQUFLQSxDQUFDUyxLQUFLQztBQUNuQjtBQUVPLGVBQWVZLHVCQUNwQmpCLFVBQWtCLEVBQ2xCa0IsU0FBOEIsRUFDOUJm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RUFBRSxJQUFJLElBQUksTUFBTSxJQUFvQlcsT0FBZkEsTUFBTVgsRUFBRSxFQUFDLFFBQWlDVyxPQUEzQkEsTUFBTVYsRUFBRSxJQUFJLElBQUksTUFBTSxJQUFvQlUsT0FBZkEsTUFBTVYsRUFBRSxFQUFDLFFBQWlDVSxPQUEzQkEsTUFBTVQsRUFBRSxJQUFJLElBQUksTUFBTSxJQUFvQlMsT0FBZkEsTUFBTVQsRUFBRSxFQUFDLFFBQWlDUyxPQUEzQkEsTUFBTVIsRUFBRSxJQUFJLElBQUksTUFBTSxJQUFjLE9BQVRRLE1BQU1SLEVBQUU7UUFDbk0vQyxXQUFXLElBQUlDLE9BQU9DLFdBQVc7SUFDbkM7SUFFQUosS0FBS0MsSUFBSSxDQUFDdUI7SUFDVixNQUFNbEMscURBQUtBLENBQUNTLEtBQUtDO0FBQ25CIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vX05fRS8uL3dvcmtmbG93cy9lbnRpdGllcy1sb2dnaW5nLnRzPzdlYTUiXSwic291cmNlc0NvbnRlbnQiOlsiLy8gd29ya2Zsb3dzL2VudGl0aWVzLWxvZ2dpbmcudHNcclxuLy8gQXBwZW5kLW9ubHkgbGlmZWN5Y2xlIGxvZ3MgKyBpbi1wbGFjZSBmaWVsZCB1cGRhdGVzIGZvciBkZXNjcmlwdGl2ZSBjaGFuZ2VzXHJcblxyXG5pbXBvcnQgeyBrdkdldCwga3ZTZXQgfSBmcm9tICdAL2RhdGEtc3RvcmUva3YnO1xyXG5pbXBvcnQgeyBidWlsZExvZ0tleSB9IGZyb20gJ0AvZGF0YS1zdG9yZS9rZXlzJztcclxuaW1wb3J0IHsgdjQgYXMgdXVpZCB9IGZyb20gJ3V1aWQnO1xyXG5cclxuZXhwb3J0IHR5cGUgTG9nRXZlbnQgPSAnQ1JFQVRFRCcgfCAnU1RBVFVTX0NIQU5HRUQnIHwgJ0RPTkUnIHwgJ0NPTExFQ1RFRCcgfCAnTU9WRUQnIHwgJ1NPTEQnIHwgJ0NIQVJHRUQnIHwgJ0NBTkNFTExFRCcgfCAnVVBEQVRFRCcgfCAnTEVWRUxfVVAnIHwgJ1BPSU5UU19DSEFOR0VEJyB8ICdST0xFX0NIQU5HRUQnIHwgJ0FDVElWQVRFRCcgfCAnREVBQ1RJVkFURUQnIHwgJ1VOQ09NUExFVEVEJyB8ICdCVUxLX0lNUE9SVCcgfCAnQlVMS19FWFBPUlQnO1xyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGFwcGVuZEVudGl0eUxvZyhcclxuICBlbnRpdHlUeXBlOiBzdHJpbmcsIFxyXG4gIGVudGl0eUlkOiBzdHJpbmcsXHJcbiAgZXZlbnQ6IExvZ0V2ZW50LFxyXG4gIGRldGFpbHM6IFJlY29yZDxzdHJpbmcsIGFueT5cclxuKTogUHJvbWlzZTx2b2lkPiB7XHJcbiAgY29uc3Qga2V5ID0gYnVpbGRMb2dLZXkoZW50aXR5VHlwZSk7XHJcbiAgY29uc3QgbGlzdCA9IChhd2FpdCBrdkdldDxhbnlbXT4oa2V5KSkgfHwgW107XHJcbiAgbGlzdC5wdXNoKHsgXHJcbiAgICBldmVudCxcclxuICAgIGVudGl0eUlkLFxyXG4gICAgLi4uZGV0YWlscyxcclxuICAgIHRpbWVzdGFtcDogbmV3IERhdGUoKS50b0lTT1N0cmluZygpIFxyXG4gIH0pO1xyXG4gIGF3YWl0IGt2U2V0KGtleSwgbGlzdCk7XHJcbn1cclxuXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiB1cGRhdGVFbnRpdHlMb2dGaWVsZChcclxuICBlbnRpdHlUeXBlOiBzdHJpbmcsIFxyXG4gIGVudGl0eUlkOiBzdHJpbmcsIFxyXG4gIGZpZWxkTmFtZTogc3RyaW5nLFxyXG4gIG9sZFZhbHVlOiBhbnksXHJcbiAgbmV3VmFsdWU6IGFueVxyXG4pOiBQcm9taXNlPHZvaWQ+IHtcclxuICBjb25zdCBrZXkgPSBidWlsZExvZ0tleShlbnRpdHlUeXBlKTtcclxuICBjb25zdCBsaXN0ID0gKGF3YWl0IGt2R2V0PGFueVtdPihrZXkpKSB8fCBbXTtcclxuICBcclxuICAvLyBGaW5kIHRoZSBtb3N0IHJlY2VudCBsb2cgZW50cnkgZm9yIHRoaXMgZW50aXR5XHJcbiAgZm9yIChsZXQgaSA9IGxpc3QubGVuZ3RoIC0gMTsgaSA+PSAwOyBpLS0pIHtcclxuICAgIGlmIChsaXN0W2ldPy5lbnRpdHlJZCA9PT0gZW50aXR5SWQpIHtcclxuICAgICAgbGlzdFtpXVtmaWVsZE5hbWVdID0gbmV3VmFsdWU7XHJcbiAgICAgIGxpc3RbaV0ubGFzdFVwZGF0ZWQgPSBuZXcgRGF0ZSgpLnRvSVNPU3RyaW5nKCk7XHJcbiAgICAgIGJyZWFrO1xyXG4gICAgfVxyXG4gIH1cclxuICBcclxuICBhd2FpdCBrdlNldChrZXksIGxpc3QpO1xyXG59XHJcblxyXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gYXBwZW5kQnVsa09wZXJhdGlvbkxvZyhcclxuICBlbnRpdHlUeXBlOiBzdHJpbmcsXHJcbiAgb3BlcmF0aW9uOiAnaW1wb3J0JyB8ICdleHBvcnQnLFxyXG4gIGRldGFpbHM6IHtcclxuICAgIGNvdW50OiBudW1iZXI7XHJcbiAgICBzb3VyY2U/OiBzdHJpbmc7XHJcbiAgICBpbXBvcnRNb2RlPzogJ2FkZCcgfCAnbWVyZ2UnIHwgJ3JlcGxhY2UnO1xyXG4gICAgZXhwb3J0Rm9ybWF0Pzogc3RyaW5nO1xyXG4gICAgZXh0cmE/OiBhbnk7XHJcbiAgfVxyXG4pOiBQcm9taXNlPHZvaWQ+IHtcclxuICBjb25zdCBrZXkgPSBidWlsZExvZ0tleShlbnRpdHlUeXBlKTtcclxuICBjb25zdCBsaXN0ID0gKGF3YWl0IGt2R2V0PGFueVtdPihrZXkpKSB8fCBbXTtcclxuICBcclxuICBjb25zdCBldmVudDogTG9nRXZlbnQgPSBvcGVyYXRpb24gPT09ICdpbXBvcnQnID8gJ0JVTEtfSU1QT1JUJyA6ICdCVUxLX0VYUE9SVCc7XHJcbiAgY29uc3Qgb3BlcmF0aW9uSWQgPSB1dWlkKCk7XHJcbiAgXHJcbiAgbGlzdC5wdXNoKHtcclxuICAgIGV2ZW50LFxyXG4gICAgb3BlcmF0aW9uSWQsXHJcbiAgICBvcGVyYXRpb24sXHJcbiAgICBjb3VudDogZGV0YWlscy5jb3VudCxcclxuICAgIHNvdXJjZTogZGV0YWlscy5zb3VyY2UsXHJcbiAgICBpbXBvcnRNb2RlOiBkZXRhaWxzLmltcG9ydE1vZGUsXHJcbiAgICBleHBvcnRGb3JtYXQ6IGRldGFpbHMuZXhwb3J0Rm9ybWF0LFxyXG4gICAgZXh0cmE6IGRldGFpbHMuZXh0cmEsXHJcbiAgICB0aW1lc3RhbXA6IG5ldyBEYXRlKCkudG9JU09TdHJpbmcoKVxyXG4gIH0pO1xyXG4gIFxyXG4gIGF3YWl0IGt2U2V0KGtleSwgbGlzdCk7XHJcbn1cclxuXHJcbi8qKlxyXG4gKiBMb2cgaXRlbSBjcmVhdGlvbiB3aXRoIHNvdXJjZSB0cmFja2luZ1xyXG4gKiBVc2VkIGZvciBpdGVtcyBjcmVhdGVkIGZyb20gdGFza3MsIGZpbmFuY2lhbCByZWNvcmRzLCBvciBkaXJlY3RseVxyXG4gKi9cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGFwcGVuZEl0ZW1DcmVhdGlvbkxvZyhcclxuICBpdGVtOiBhbnksXHJcbiAgc291cmNlVHlwZTogJ3Rhc2snIHwgJ3JlY29yZCcgfCAnZGlyZWN0JyxcclxuICBzb3VyY2VJZD86IHN0cmluZ1xyXG4pOiBQcm9taXNlPHZvaWQ+IHtcclxuICBjb25zdCBrZXkgPSBidWlsZExvZ0tleSgnaXRlbScpO1xyXG4gIGNvbnN0IGxpc3QgPSAoYXdhaXQga3ZHZXQ8YW55W10+KGtleSkpIHx8IFtdO1xyXG4gIFxyXG4gIGNvbnN0IGxvZ0VudHJ5ID0ge1xyXG4gICAgZXZlbnQ6ICdDUkVBVEVEJyBhcyBMb2dFdmVudCxcclxuICAgIGVudGl0eUlkOiBpdGVtLmlkLFxyXG4gICAgaXRlbU5hbWU6IGl0ZW0ubmFtZSxcclxuICAgIGl0ZW1UeXBlOiBpdGVtLnR5cGUsXHJcbiAgICBjb2xsZWN0aW9uOiBpdGVtLmNvbGxlY3Rpb24sXHJcbiAgICBzdGF0dXM6IGl0ZW0uc3RhdHVzLFxyXG4gICAgcXVhbnRpdHk6IGl0ZW0uc3RvY2s/LnJlZHVjZSgoc3VtOiBudW1iZXIsIHN0b2NrOiBhbnkpID0+IHN1bSArIHN0b2NrLnF1YW50aXR5LCAwKSB8fCAwLFxyXG4gICAgdW5pdENvc3Q6IGl0ZW0udW5pdENvc3QgfHwgMCxcclxuICAgIHRvdGFsQ29zdDogKGl0ZW0uc3RvY2s/LnJlZHVjZSgoc3VtOiBudW1iZXIsIHN0b2NrOiBhbnkpID0+IHN1bSArIHN0b2NrLnF1YW50aXR5LCAwKSB8fCAwKSAqIChpdGVtLnVuaXRDb3N0IHx8IDApLFxyXG4gICAgcHJpY2U6IGl0ZW0ucHJpY2UgfHwgMCxcclxuICAgIHN0YXRpb246IGl0ZW0uc3RhdGlvbixcclxuICAgIGNhdGVnb3J5OiBpdGVtLmNhdGVnb3J5LFxyXG4gICAgeWVhcjogaXRlbS55ZWFyLFxyXG4gICAgc291cmNlVHlwZSxcclxuICAgIHNvdXJjZUlkLFxyXG4gICAgZGVzY3JpcHRpb246IGBJdGVtIGNyZWF0ZWQgZnJvbSAke3NvdXJjZVR5cGV9OiAke2l0ZW0udHlwZX0gKCR7aXRlbS5zdG9jaz8ucmVkdWNlKChzdW06IG51bWJlciwgc3RvY2s6IGFueSkgPT4gc3VtICsgc3RvY2sucXVhbnRpdHksIDApIHx8IDB9eClgLFxyXG4gICAgdGltZXN0YW1wOiBuZXcgRGF0ZSgpLnRvSVNPU3RyaW5nKClcclxuICB9O1xyXG4gIFxyXG4gIGxpc3QucHVzaChsb2dFbnRyeSk7XHJcbiAgYXdhaXQga3ZTZXQoa2V5LCBsaXN0KTtcclxufVxyXG5cclxuLyoqXHJcbiAqIExvZyBwbGF5ZXIgcG9pbnRzIGF3YXJkIHdpdGggc291cmNlIHRyYWNraW5nXHJcbiAqIFVzZWQgZm9yIHBvaW50cyBhd2FyZGVkIGZyb20gdGFza3MsIGZpbmFuY2lhbCByZWNvcmRzLCBvciBzYWxlc1xyXG4gKi9cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGFwcGVuZFBsYXllclBvaW50c0xvZyhcclxuICBwbGF5ZXJJZDogc3RyaW5nLFxyXG4gIHBvaW50czogeyB4cDogbnVtYmVyOyBycDogbnVtYmVyOyBmcDogbnVtYmVyOyBocDogbnVtYmVyIH0sXHJcbiAgc291cmNlSWQ6IHN0cmluZyxcclxuICBzb3VyY2VUeXBlOiBzdHJpbmdcclxuKTogUHJvbWlzZTx2b2lkPiB7XHJcbiAgY29uc3Qga2V5ID0gYnVpbGRMb2dLZXkoJ3BsYXllcicpO1xyXG4gIGNvbnN0IGxpc3QgPSAoYXdhaXQga3ZHZXQ8YW55W10+KGtleSkpIHx8IFtdO1xyXG4gIFxyXG4gIGNvbnN0IGxvZ0VudHJ5ID0ge1xyXG4gICAgZXZlbnQ6ICdQT0lOVFNfQ0hBTkdFRCcgYXMgTG9nRXZlbnQsXHJcbiAgICBlbnRpdHlJZDogcGxheWVySWQsXHJcbiAgICBwb2ludHM6IHBvaW50cyxcclxuICAgIHNvdXJjZUlkOiBzb3VyY2VJZCxcclxuICAgIHNvdXJjZVR5cGU6IHNvdXJjZVR5cGUsXHJcbiAgICBkZXNjcmlwdGlvbjogYFBvaW50cyBhd2FyZGVkIGZyb20gJHtzb3VyY2VUeXBlfTogWFArJHtwb2ludHMueHB9LCBSUCske3BvaW50cy5ycH0sIEZQKyR7cG9pbnRzLmZwfSwgSFArJHtwb2ludHMuaHB9YCxcclxuICAgIHRpbWVzdGFtcDogbmV3IERhdGUoKS50b0lTT1N0cmluZygpXHJcbiAgfTtcclxuICBcclxuICBsaXN0LnB1c2gobG9nRW50cnkpO1xyXG4gIGF3YWl0IGt2U2V0KGtleSwgbGlzdCk7XHJcbn1cclxuXHJcbi8qKlxyXG4gKiBMb2cgY2hhcmFjdGVyIGp1bmdsZSBjb2lucyBhd2FyZCB3aXRoIHNvdXJjZSB0cmFja2luZ1xyXG4gKiBVc2VkIGZvciBqdW5nbGUgY29pbnMgYXdhcmRlZCBmcm9tIGZpbmFuY2lhbCByZWNvcmRzXHJcbiAqL1xyXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gYXBwZW5kQ2hhcmFjdGVySnVuZ2xlQ29pbnNMb2coXHJcbiAgY2hhcmFjdGVySWQ6IHN0cmluZyxcclxuICBhbW91bnQ6IG51bWJlcixcclxuICBzb3VyY2VJZDogc3RyaW5nLFxyXG4gIHNvdXJjZVR5cGU6IHN0cmluZ1xyXG4pOiBQcm9taXNlPHZvaWQ+IHtcclxuICBjb25zdCBrZXkgPSBidWlsZExvZ0tleSgnY2hhcmFjdGVyJyk7XHJcbiAgY29uc3QgbGlzdCA9IChhd2FpdCBrdkdldDxhbnlbXT4oa2V5KSkgfHwgW107XHJcbiAgXHJcbiAgY29uc3QgbG9nRW50cnkgPSB7XHJcbiAgICBldmVudDogJ1VQREFURUQnIGFzIExvZ0V2ZW50LFxyXG4gICAgZW50aXR5SWQ6IGNoYXJhY3RlcklkLFxyXG4gICAganVuZ2xlQ29pbnM6IGFtb3VudCxcclxuICAgIHNvdXJjZUlkOiBzb3VyY2VJZCxcclxuICAgIHNvdXJjZVR5cGU6IHNvdXJjZVR5cGUsXHJcbiAgICBkZXNjcmlwdGlvbjogYEp1bmdsZSBjb2lucyBhd2FyZGVkIGZyb20gJHtzb3VyY2VUeXBlfTogKyR7YW1vdW50fSBKJGAsXHJcbiAgICB0aW1lc3RhbXA6IG5ldyBEYXRlKCkudG9JU09TdHJpbmcoKVxyXG4gIH07XHJcbiAgXHJcbiAgbGlzdC5wdXNoKGxvZ0VudHJ5KTtcclxuICBhd2FpdCBrdlNldChrZXksIGxpc3QpO1xyXG59XHJcblxyXG4vKipcclxuICogTG9nIHBsYXllciBwb2ludHMgdXBkYXRlIHdpdGggY2hhbmdlIHRyYWNraW5nXHJcbiAqIFVzZWQgd2hlbiB0YXNrIHJld2FyZHMgY2hhbmdlIGFuZCBwb2ludHMgbmVlZCB0byBiZSB1cGRhdGVkXHJcbiAqL1xyXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gYXBwZW5kUGxheWVyUG9pbnRzVXBkYXRlTG9nKFxyXG4gIHBsYXllcklkOiBzdHJpbmcsXHJcbiAgb2xkUG9pbnRzOiB7IHhwOiBudW1iZXI7IHJwOiBudW1iZXI7IGZwOiBudW1iZXI7IGhwOiBudW1iZXIgfSxcclxuICBuZXdQb2ludHM6IHsgeHA6IG51bWJlcjsgcnA6IG51bWJlcjsgZnA6IG51bWJlcjsgaHA6IG51bWJlciB9LFxyXG4gIHNvdXJjZUlkOiBzdHJpbmdcclxuKTogUHJvbWlzZTx2b2lkPiB7XHJcbiAgY29uc3Qga2V5ID0gYnVpbGRMb2dLZXkoJ3BsYXllcicpO1xyXG4gIGNvbnN0IGxpc3QgPSAoYXdhaXQga3ZHZXQ8YW55W10+KGtleSkpIHx8IFtdO1xyXG4gIFxyXG4gIGNvbnN0IGRlbHRhID0ge1xyXG4gICAgeHA6IG5ld1BvaW50cy54cCAtIG9sZFBvaW50cy54cCxcclxuICAgIHJwOiBuZXdQb2ludHMucnAgLSBvbGRQb2ludHMucnAsXHJcbiAgICBmcDogbmV3UG9pbnRzLmZwIC0gb2xkUG9pbnRzLmZwLFxyXG4gICAgaHA6IG5ld1BvaW50cy5ocCAtIG9sZFBvaW50cy5ocFxyXG4gIH07XHJcbiAgXHJcbiAgY29uc3QgbG9nRW50cnkgPSB7XHJcbiAgICBldmVudDogJ1BPSU5UU19DSEFOR0VEJyBhcyBMb2dFdmVudCxcclxuICAgIGVudGl0eUlkOiBwbGF5ZXJJZCxcclxuICAgIG9sZFBvaW50czogb2xkUG9pbnRzLFxyXG4gICAgbmV3UG9pbnRzOiBuZXdQb2ludHMsXHJcbiAgICBkZWx0YTogZGVsdGEsXHJcbiAgICBzb3VyY2VJZDogc291cmNlSWQsXHJcbiAgICBkZXNjcmlwdGlvbjogYFBvaW50cyB1cGRhdGVkOiBYUCR7ZGVsdGEueHAgPj0gMCA/ICcrJyA6ICcnfSR7ZGVsdGEueHB9LCBSUCR7ZGVsdGEucnAgPj0gMCA/ICcrJyA6ICcnfSR7ZGVsdGEucnB9LCBGUCR7ZGVsdGEuZnAgPj0gMCA/ICcrJyA6ICcnfSR7ZGVsdGEuZnB9LCBIUCR7ZGVsdGEuaHAgPj0gMCA/ICcrJyA6ICcnfSR7ZGVsdGEuaHB9YCxcclxuICAgIHRpbWVzdGFtcDogbmV3IERhdGUoKS50b0lTT1N0cmluZygpXHJcbiAgfTtcclxuICBcclxuICBsaXN0LnB1c2gobG9nRW50cnkpO1xyXG4gIGF3YWl0IGt2U2V0KGtleSwgbGlzdCk7XHJcbn1cclxuXHJcblxyXG4iXSwibmFtZXMiOlsia3ZHZXQiLCJrdlNldCIsImJ1aWxkTG9nS2V5IiwidjQiLCJ1dWlkIiwiYXBwZW5kRW50aXR5TG9nIiwiZW50aXR5VHlwZSIsImVudGl0eUlkIiwiZXZlbnQiLCJkZXRhaWxzIiwia2V5IiwibGlzdCIsInB1c2giLCJ0aW1lc3RhbXAiLCJEYXRlIiwidG9JU09TdHJpbmciLCJ1cGRhdGVFbnRpdHlMb2dGaWVsZCIsImZpZWxkTmFtZSIsIm9sZFZhbHVlIiwibmV3VmFsdWUiLCJpIiwibGVuZ3RoIiwibGFzdFVwZGF0ZWQiLCJhcHBlbmRCdWxrT3BlcmF0aW9uTG9nIiwib3BlcmF0aW9uIiwib3BlcmF0aW9uSWQiLCJjb3VudCIsInNvdXJjZSIsImltcG9ydE1vZGUiLCJleHBvcnRGb3JtYXQiLCJleHRyYSIsImFwcGVuZEl0ZW1DcmVhdGlvbkxvZyIsIml0ZW0iLCJzb3VyY2VUeXBlIiwic291cmNlSWQiLCJsb2dFbnRyeSIsImlkIiwiaXRlbU5hbWUiLCJuYW1lIiwiaXRlbVR5cGUiLCJ0eXBlIiwiY29sbGVjdGlvbiIsInN0YXR1cyIsInF1YW50aXR5Iiwic3RvY2siLCJyZWR1Y2UiLCJzdW0iLCJ1bml0Q29zdCIsInRvdGFsQ29zdCIsInByaWNlIiwic3RhdGlvbiIsImNhdGVnb3J5IiwieWVhciIsImRlc2NyaXB0aW9uIiwiYXBwZW5kUGxheWVyUG9pbnRzTG9nIiwicGxheWVySWQiLCJwb2ludHMiLCJ4cCIsInJwIiwiZnAiLCJocCIsImFwcGVuZENoYXJhY3Rlckp1bmdsZUNvaW5zTG9nIiwiY2hhcmFjdGVySWQiLCJhbW91bnQiLCJqdW5nbGVDb2lucyIsImFwcGVuZFBsYXllclBvaW50c1VwZGF0ZUxvZyIsIm9sZFBvaW50cyIsIm5ld1BvaW50cyIsImRlbHRhIl0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(app-pages-browser)/./workflows/entities-logging.ts\n"));

/***/ }),

/***/ "(app-pages-browser)/./workflows/entities-workflows/character.workflow.ts":
/*!************************************************************!*\
  !*** ./workflows/entities-workflows/character.workflow.ts ***!
  \************************************************************/
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval(__webpack_require__.ts("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   logCharacterEffect: function() { return /* binding */ logCharacterEffect; },\n/* harmony export */   logCharacterEffectFromRecord: function() { return /* binding */ logCharacterEffectFromRecord; },\n/* harmony export */   logCharacterUpdateFromTask: function() { return /* binding */ logCharacterUpdateFromTask; },\n/* harmony export */   onCharacterUpsert: function() { return /* binding */ onCharacterUpsert; },\n/* harmony export */   removeCharacterEffectsOnDelete: function() { return /* binding */ removeCharacterEffectsOnDelete; }\n/* harmony export */ });\n/* harmony import */ var _entities_logging__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../entities-logging */ \"(app-pages-browser)/./workflows/entities-logging.ts\");\n/* harmony import */ var _data_store_effects_registry__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @/data-store/effects-registry */ \"(app-pages-browser)/./data-store/effects-registry.ts\");\n/* harmony import */ var _lib_client_api__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @/lib/client-api */ \"(app-pages-browser)/./lib/client-api.ts\");\n// workflows/entities-workflows/character.workflow.ts\n// Character-specific workflow with ROLE_CHANGED event\n\n\n\n\nconst STATE_FIELDS = [\n    \"roles\",\n    \"isActive\"\n];\nconst DESCRIPTIVE_FIELDS = [\n    \"name\",\n    \"description\",\n    \"contactEmail\",\n    \"contactPhone\",\n    \"commColor\"\n];\nasync function onCharacterUpsert(character, previousCharacter) {\n    // New character creation\n    if (!previousCharacter) {\n        const effectKey = \"character:\".concat(character.id, \":created\");\n        if (await (0,_data_store_effects_registry__WEBPACK_IMPORTED_MODULE_1__.hasEffect)(effectKey)) return;\n        await (0,_entities_logging__WEBPACK_IMPORTED_MODULE_0__.appendEntityLog)(\"character\", character.id, \"CREATED\", {\n            name: character.name,\n            roles: character.roles\n        });\n        await (0,_data_store_effects_registry__WEBPACK_IMPORTED_MODULE_1__.markEffect)(effectKey);\n        return;\n    }\n    // Role changes - ROLE_CHANGED event\n    const rolesChanged = JSON.stringify(previousCharacter.roles) !== JSON.stringify(character.roles);\n    if (rolesChanged) {\n        await (0,_entities_logging__WEBPACK_IMPORTED_MODULE_0__.appendEntityLog)(\"character\", character.id, \"ROLE_CHANGED\", {\n            name: character.name,\n            oldRoles: previousCharacter.roles,\n            newRoles: character.roles\n        });\n    }\n    // General updates - UPDATED event\n    const hasSignificantChanges = previousCharacter.isActive !== character.isActive;\n    if (hasSignificantChanges) {\n        await (0,_entities_logging__WEBPACK_IMPORTED_MODULE_0__.appendEntityLog)(\"character\", character.id, \"UPDATED\", {\n            name: character.name,\n            isActive: character.isActive\n        });\n    }\n    // Descriptive changes - update in-place\n    for (const field of DESCRIPTIVE_FIELDS){\n        if (previousCharacter[field] !== character[field]) {\n            await (0,_entities_logging__WEBPACK_IMPORTED_MODULE_0__.updateEntityLogField)(\"character\", character.id, field, previousCharacter[field], character[field]);\n        }\n    }\n}\n/**\r\n * Remove character effects when character is deleted\r\n * Characters can have entries in character log and related links\r\n */ async function removeCharacterEffectsOnDelete(characterId) {\n    try {\n        console.log(\"[removeCharacterEffectsOnDelete] Starting cleanup for character: \".concat(characterId));\n        // 1. Remove all Links related to this character\n        const characterLinks = await _lib_client_api__WEBPACK_IMPORTED_MODULE_2__.ClientAPI.getLinksFor({\n            type: \"character\",\n            id: characterId\n        });\n        console.log(\"[removeCharacterEffectsOnDelete] Found \".concat(characterLinks.length, \" links to remove\"));\n        for (const link of characterLinks){\n            try {\n                await _lib_client_api__WEBPACK_IMPORTED_MODULE_2__.ClientAPI.removeLink(link.id);\n                console.log(\"[removeCharacterEffectsOnDelete]  Removed link: \".concat(link.linkType));\n            } catch (error) {\n                console.error(\"[removeCharacterEffectsOnDelete]  Failed to remove link \".concat(link.id, \":\"), error);\n            }\n        }\n        // 2. Clear all effects for this character\n        await (0,_data_store_effects_registry__WEBPACK_IMPORTED_MODULE_1__.clearEffect)(\"character:\".concat(characterId, \":created\"));\n        await (0,_data_store_effects_registry__WEBPACK_IMPORTED_MODULE_1__.clearEffectsByPrefix)(\"character\", characterId, \"\");\n        // 3. Remove log entries from character log\n        console.log(\"[removeCharacterEffectsOnDelete] Starting log entry removal for character: \".concat(characterId));\n        const result = await _lib_client_api__WEBPACK_IMPORTED_MODULE_2__.ClientAPI.removeLogEntry(\"character\", characterId);\n        if (result.success) {\n            console.log(\"[removeCharacterEffectsOnDelete]  Character log entries removed successfully for character: \".concat(characterId));\n        } else {\n            console.error(\"[removeCharacterEffectsOnDelete] Failed to remove character log entries: \".concat(result.message));\n        }\n        console.log(\"[removeCharacterEffectsOnDelete]  Cleared effects, removed links, and removed log entries for character \".concat(characterId));\n    } catch (error) {\n        console.error(\"Error removing character effects:\", error);\n    }\n}\n/**\r\n * Log character effect from task completion\r\n * This is currently a no-op since tasks don't award jungle coins anymore\r\n * J$ are only earned via Points Exchange\r\n */ async function logCharacterEffect(task) {\n    // J$ no longer awarded as task rewards - only earned via Points Exchange\n    // This function is now a no-op since tasks don't award J$ anymore\n    return;\n}\n/**\r\n * Log character effect from financial record\r\n * This logs the jungle coins awarded to the character from a financial record\r\n */ async function logCharacterEffectFromRecord(record) {\n    try {\n        console.log(\"[logCharacterEffectFromRecord] Logging character effect for record: \".concat(record.name, \" (\").concat(record.id, \")\"));\n        // Only log if there are jungle coins to award\n        if (!record.jungleCoins || record.jungleCoins <= 0) {\n            console.log(\"[logCharacterEffectFromRecord] No jungle coins to log, skipping\");\n            return;\n        }\n        // Get main character ID (V0.1 constant)\n        const mainCharacterId = \"CHARACTER_ONE_ID\";\n        await (0,_entities_logging__WEBPACK_IMPORTED_MODULE_0__.appendCharacterJungleCoinsLog)(mainCharacterId, record.jungleCoins, record.id, \"financial\");\n        console.log(\"[logCharacterEffectFromRecord]  Character effect logged successfully for \".concat(record.name));\n    } catch (error) {\n        console.error(\"Error logging character effect from record:\", error);\n    }\n}\n/**\r\n * Log character update from task changes\r\n * This is currently a no-op since tasks don't award jungle coins anymore\r\n * J$ are only earned via Points Exchange\r\n */ async function logCharacterUpdateFromTask(task, oldTask) {\n    // J$ no longer awarded as task rewards - only earned via Points Exchange\n    // This function is now a no-op since tasks don't award J$ anymore\n    return;\n}\n\n\n;\n    // Wrapped in an IIFE to avoid polluting the global scope\n    ;\n    (function () {\n        var _a, _b;\n        // Legacy CSS implementations will `eval` browser code in a Node.js context\n        // to extract CSS. For backwards compatibility, we need to check we're in a\n        // browser context before continuing.\n        if (typeof self !== 'undefined' &&\n            // AMP / No-JS mode does not inject these helpers:\n            '$RefreshHelpers$' in self) {\n            // @ts-ignore __webpack_module__ is global\n            var currentExports = module.exports;\n            // @ts-ignore __webpack_module__ is global\n            var prevSignature = (_b = (_a = module.hot.data) === null || _a === void 0 ? void 0 : _a.prevSignature) !== null && _b !== void 0 ? _b : null;\n            // This cannot happen in MainTemplate because the exports mismatch between\n            // templating and execution.\n            self.$RefreshHelpers$.registerExportsForReactRefresh(currentExports, module.id);\n            // A module can be accepted automatically based on its exports, e.g. when\n            // it is a Refresh Boundary.\n            if (self.$RefreshHelpers$.isReactRefreshBoundary(currentExports)) {\n                // Save the previous exports signature on update so we can compare the boundary\n                // signatures. We avoid saving exports themselves since it causes memory leaks (https://github.com/vercel/next.js/pull/53797)\n                module.hot.dispose(function (data) {\n                    data.prevSignature =\n                        self.$RefreshHelpers$.getRefreshBoundarySignature(currentExports);\n                });\n                // Unconditionally accept an update to this module, we'll check if it's\n                // still a Refresh Boundary later.\n                // @ts-ignore importMeta is replaced in the loader\n                module.hot.accept();\n                // This field is set when the previous version of this module was a\n                // Refresh Boundary, letting us know we need to check for invalidation or\n                // enqueue an update.\n                if (prevSignature !== null) {\n                    // A boundary can become ineligible if its exports are incompatible\n                    // with the previous exports.\n                    //\n                    // For example, if you add/remove/change exports, we'll want to\n                    // re-execute the importing modules, and force those components to\n                    // re-render. Similarly, if you convert a class component to a\n                    // function, we want to invalidate the boundary.\n                    if (self.$RefreshHelpers$.shouldInvalidateReactRefreshBoundary(prevSignature, self.$RefreshHelpers$.getRefreshBoundarySignature(currentExports))) {\n                        module.hot.invalidate();\n                    }\n                    else {\n                        self.$RefreshHelpers$.scheduleUpdate();\n                    }\n                }\n            }\n            else {\n                // Since we just executed the code for the module, it's possible that the\n                // new exports made it ineligible for being a boundary.\n                // We only care about the case when we were _previously_ a boundary,\n                // because we already accepted this update (accidental side effect).\n                var isNoLongerABoundary = prevSignature !== null;\n                if (isNoLongerABoundary) {\n                    module.hot.invalidate();\n                }\n            }\n        }\n    })();\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFwcC1wYWdlcy1icm93c2VyKS8uL3dvcmtmbG93cy9lbnRpdGllcy13b3JrZmxvd3MvY2hhcmFjdGVyLndvcmtmbG93LnRzIiwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7O0FBQUEscURBQXFEO0FBQ3JELHNEQUFzRDtBQUdzQjtBQUM2QjtBQUM1RDtBQUN1QjtBQUdwRSxNQUFNUSxlQUFlO0lBQUM7SUFBUztDQUFXO0FBQzFDLE1BQU1DLHFCQUFxQjtJQUFDO0lBQVE7SUFBZTtJQUFnQjtJQUFnQjtDQUFZO0FBRXhGLGVBQWVDLGtCQUFrQkMsU0FBb0IsRUFBRUMsaUJBQTZCO0lBQ3pGLHlCQUF5QjtJQUN6QixJQUFJLENBQUNBLG1CQUFtQjtRQUN0QixNQUFNQyxZQUFZLGFBQTBCLE9BQWJGLFVBQVVHLEVBQUUsRUFBQztRQUM1QyxJQUFJLE1BQU1aLHVFQUFTQSxDQUFDVyxZQUFZO1FBRWhDLE1BQU1iLGtFQUFlQSxDQUFDLGFBQWFXLFVBQVVHLEVBQUUsRUFBRSxXQUFXO1lBQzFEQyxNQUFNSixVQUFVSSxJQUFJO1lBQ3BCQyxPQUFPTCxVQUFVSyxLQUFLO1FBQ3hCO1FBQ0EsTUFBTWIsd0VBQVVBLENBQUNVO1FBQ2pCO0lBQ0Y7SUFFQSxvQ0FBb0M7SUFDcEMsTUFBTUksZUFBZUMsS0FBS0MsU0FBUyxDQUFDUCxrQkFBa0JJLEtBQUssTUFBTUUsS0FBS0MsU0FBUyxDQUFDUixVQUFVSyxLQUFLO0lBQy9GLElBQUlDLGNBQWM7UUFDaEIsTUFBTWpCLGtFQUFlQSxDQUFDLGFBQWFXLFVBQVVHLEVBQUUsRUFBRSxnQkFBZ0I7WUFDL0RDLE1BQU1KLFVBQVVJLElBQUk7WUFDcEJLLFVBQVVSLGtCQUFrQkksS0FBSztZQUNqQ0ssVUFBVVYsVUFBVUssS0FBSztRQUMzQjtJQUNGO0lBRUEsa0NBQWtDO0lBQ2xDLE1BQU1NLHdCQUF3QlYsa0JBQWtCVyxRQUFRLEtBQUtaLFVBQVVZLFFBQVE7SUFDL0UsSUFBSUQsdUJBQXVCO1FBQ3pCLE1BQU10QixrRUFBZUEsQ0FBQyxhQUFhVyxVQUFVRyxFQUFFLEVBQUUsV0FBVztZQUMxREMsTUFBTUosVUFBVUksSUFBSTtZQUNwQlEsVUFBVVosVUFBVVksUUFBUTtRQUM5QjtJQUNGO0lBRUEsd0NBQXdDO0lBQ3hDLEtBQUssTUFBTUMsU0FBU2YsbUJBQW9CO1FBQ3RDLElBQUksaUJBQTBCLENBQUNlLE1BQU0sS0FBSyxTQUFrQixDQUFDQSxNQUFNLEVBQUU7WUFDbkUsTUFBTXZCLHVFQUFvQkEsQ0FBQyxhQUFhVSxVQUFVRyxFQUFFLEVBQUVVLE9BQU8saUJBQTBCLENBQUNBLE1BQU0sRUFBRSxTQUFrQixDQUFDQSxNQUFNO1FBQzNIO0lBQ0Y7QUFDRjtBQUVBOzs7Q0FHQyxHQUNNLGVBQWVDLCtCQUErQkMsV0FBbUI7SUFDdEUsSUFBSTtRQUNGQyxRQUFRQyxHQUFHLENBQUMsb0VBQWdGLE9BQVpGO1FBRWhGLGdEQUFnRDtRQUNoRCxNQUFNRyxpQkFBaUIsTUFBTXZCLHNEQUFTQSxDQUFDd0IsV0FBVyxDQUFDO1lBQUVDLE1BQU07WUFBYWpCLElBQUlZO1FBQVk7UUFDeEZDLFFBQVFDLEdBQUcsQ0FBQywwQ0FBZ0UsT0FBdEJDLGVBQWVHLE1BQU0sRUFBQztRQUU1RSxLQUFLLE1BQU1DLFFBQVFKLGVBQWdCO1lBQ2pDLElBQUk7Z0JBQ0YsTUFBTXZCLHNEQUFTQSxDQUFDNEIsVUFBVSxDQUFDRCxLQUFLbkIsRUFBRTtnQkFDbENhLFFBQVFDLEdBQUcsQ0FBQyxvREFBa0UsT0FBZEssS0FBS0UsUUFBUTtZQUMvRSxFQUFFLE9BQU9DLE9BQU87Z0JBQ2RULFFBQVFTLEtBQUssQ0FBQyw0REFBb0UsT0FBUkgsS0FBS25CLEVBQUUsRUFBQyxNQUFJc0I7WUFDeEY7UUFDRjtRQUVBLDBDQUEwQztRQUMxQyxNQUFNaEMseUVBQVdBLENBQUMsYUFBeUIsT0FBWnNCLGFBQVk7UUFDM0MsTUFBTXJCLGtGQUFvQkEsQ0FBQyxhQUFhcUIsYUFBYTtRQUVyRCwyQ0FBMkM7UUFDM0NDLFFBQVFDLEdBQUcsQ0FBQyw4RUFBMEYsT0FBWkY7UUFFMUYsTUFBTVcsU0FBUyxNQUFNL0Isc0RBQVNBLENBQUNnQyxjQUFjLENBQUMsYUFBYVo7UUFFM0QsSUFBSVcsT0FBT0UsT0FBTyxFQUFFO1lBQ2xCWixRQUFRQyxHQUFHLENBQUMsZ0dBQTRHLE9BQVpGO1FBQzlHLE9BQU87WUFDTEMsUUFBUVMsS0FBSyxDQUFDLDRFQUEyRixPQUFmQyxPQUFPRyxPQUFPO1FBQzFHO1FBRUFiLFFBQVFDLEdBQUcsQ0FBQyw0R0FBd0gsT0FBWkY7SUFDMUgsRUFBRSxPQUFPVSxPQUFPO1FBQ2RULFFBQVFTLEtBQUssQ0FBQyxxQ0FBcUNBO0lBQ3JEO0FBQ0Y7QUFFQTs7OztDQUlDLEdBQ00sZUFBZUssbUJBQW1CQyxJQUFVO0lBQ2pELHlFQUF5RTtJQUN6RSxrRUFBa0U7SUFDbEU7QUFDRjtBQUVBOzs7Q0FHQyxHQUNNLGVBQWVDLDZCQUE2QkMsTUFBdUI7SUFDeEUsSUFBSTtRQUNGakIsUUFBUUMsR0FBRyxDQUFDLHVFQUF1RmdCLE9BQWhCQSxPQUFPN0IsSUFBSSxFQUFDLE1BQWMsT0FBVjZCLE9BQU85QixFQUFFLEVBQUM7UUFFN0csOENBQThDO1FBQzlDLElBQUksQ0FBQzhCLE9BQU9DLFdBQVcsSUFBSUQsT0FBT0MsV0FBVyxJQUFJLEdBQUc7WUFDbERsQixRQUFRQyxHQUFHLENBQUM7WUFDWjtRQUNGO1FBRUEsd0NBQXdDO1FBQ3hDLE1BQU1rQixrQkFBa0I7UUFFeEIsTUFBTXZDLGdGQUE2QkEsQ0FDakN1QyxpQkFDQUYsT0FBT0MsV0FBVyxFQUNsQkQsT0FBTzlCLEVBQUUsRUFDVDtRQUdGYSxRQUFRQyxHQUFHLENBQUMsNkVBQXlGLE9BQVpnQixPQUFPN0IsSUFBSTtJQUN0RyxFQUFFLE9BQU9xQixPQUFPO1FBQ2RULFFBQVFTLEtBQUssQ0FBQywrQ0FBK0NBO0lBQy9EO0FBQ0Y7QUFFQTs7OztDQUlDLEdBQ00sZUFBZVcsMkJBQTJCTCxJQUFVLEVBQUVNLE9BQWE7SUFDeEUseUVBQXlFO0lBQ3pFLGtFQUFrRTtJQUNsRTtBQUNGIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vX05fRS8uL3dvcmtmbG93cy9lbnRpdGllcy13b3JrZmxvd3MvY2hhcmFjdGVyLndvcmtmbG93LnRzP2U1NTgiXSwic291cmNlc0NvbnRlbnQiOlsiLy8gd29ya2Zsb3dzL2VudGl0aWVzLXdvcmtmbG93cy9jaGFyYWN0ZXIud29ya2Zsb3cudHNcclxuLy8gQ2hhcmFjdGVyLXNwZWNpZmljIHdvcmtmbG93IHdpdGggUk9MRV9DSEFOR0VEIGV2ZW50XHJcblxyXG5pbXBvcnQgdHlwZSB7IENoYXJhY3RlciB9IGZyb20gJ0AvdHlwZXMvZW50aXRpZXMnO1xyXG5pbXBvcnQgeyBhcHBlbmRFbnRpdHlMb2csIHVwZGF0ZUVudGl0eUxvZ0ZpZWxkIH0gZnJvbSAnLi4vZW50aXRpZXMtbG9nZ2luZyc7XHJcbmltcG9ydCB7IGhhc0VmZmVjdCwgbWFya0VmZmVjdCwgY2xlYXJFZmZlY3QsIGNsZWFyRWZmZWN0c0J5UHJlZml4IH0gZnJvbSAnQC9kYXRhLXN0b3JlL2VmZmVjdHMtcmVnaXN0cnknO1xyXG5pbXBvcnQgeyBDbGllbnRBUEkgfSBmcm9tICdAL2xpYi9jbGllbnQtYXBpJztcclxuaW1wb3J0IHsgYXBwZW5kQ2hhcmFjdGVySnVuZ2xlQ29pbnNMb2cgfSBmcm9tICcuLi9lbnRpdGllcy1sb2dnaW5nJztcclxuaW1wb3J0IHR5cGUgeyBUYXNrLCBGaW5hbmNpYWxSZWNvcmQgfSBmcm9tICdAL3R5cGVzL2VudGl0aWVzJztcclxuXHJcbmNvbnN0IFNUQVRFX0ZJRUxEUyA9IFsncm9sZXMnLCAnaXNBY3RpdmUnXTtcclxuY29uc3QgREVTQ1JJUFRJVkVfRklFTERTID0gWyduYW1lJywgJ2Rlc2NyaXB0aW9uJywgJ2NvbnRhY3RFbWFpbCcsICdjb250YWN0UGhvbmUnLCAnY29tbUNvbG9yJ107XHJcblxyXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gb25DaGFyYWN0ZXJVcHNlcnQoY2hhcmFjdGVyOiBDaGFyYWN0ZXIsIHByZXZpb3VzQ2hhcmFjdGVyPzogQ2hhcmFjdGVyKTogUHJvbWlzZTx2b2lkPiB7XHJcbiAgLy8gTmV3IGNoYXJhY3RlciBjcmVhdGlvblxyXG4gIGlmICghcHJldmlvdXNDaGFyYWN0ZXIpIHtcclxuICAgIGNvbnN0IGVmZmVjdEtleSA9IGBjaGFyYWN0ZXI6JHtjaGFyYWN0ZXIuaWR9OmNyZWF0ZWRgO1xyXG4gICAgaWYgKGF3YWl0IGhhc0VmZmVjdChlZmZlY3RLZXkpKSByZXR1cm47XHJcbiAgICBcclxuICAgIGF3YWl0IGFwcGVuZEVudGl0eUxvZygnY2hhcmFjdGVyJywgY2hhcmFjdGVyLmlkLCAnQ1JFQVRFRCcsIHsgXHJcbiAgICAgIG5hbWU6IGNoYXJhY3Rlci5uYW1lLCBcclxuICAgICAgcm9sZXM6IGNoYXJhY3Rlci5yb2xlc1xyXG4gICAgfSk7XHJcbiAgICBhd2FpdCBtYXJrRWZmZWN0KGVmZmVjdEtleSk7XHJcbiAgICByZXR1cm47XHJcbiAgfVxyXG4gIFxyXG4gIC8vIFJvbGUgY2hhbmdlcyAtIFJPTEVfQ0hBTkdFRCBldmVudFxyXG4gIGNvbnN0IHJvbGVzQ2hhbmdlZCA9IEpTT04uc3RyaW5naWZ5KHByZXZpb3VzQ2hhcmFjdGVyLnJvbGVzKSAhPT0gSlNPTi5zdHJpbmdpZnkoY2hhcmFjdGVyLnJvbGVzKTtcclxuICBpZiAocm9sZXNDaGFuZ2VkKSB7XHJcbiAgICBhd2FpdCBhcHBlbmRFbnRpdHlMb2coJ2NoYXJhY3RlcicsIGNoYXJhY3Rlci5pZCwgJ1JPTEVfQ0hBTkdFRCcsIHtcclxuICAgICAgbmFtZTogY2hhcmFjdGVyLm5hbWUsXHJcbiAgICAgIG9sZFJvbGVzOiBwcmV2aW91c0NoYXJhY3Rlci5yb2xlcyxcclxuICAgICAgbmV3Um9sZXM6IGNoYXJhY3Rlci5yb2xlc1xyXG4gICAgfSk7XHJcbiAgfVxyXG4gIFxyXG4gIC8vIEdlbmVyYWwgdXBkYXRlcyAtIFVQREFURUQgZXZlbnRcclxuICBjb25zdCBoYXNTaWduaWZpY2FudENoYW5nZXMgPSBwcmV2aW91c0NoYXJhY3Rlci5pc0FjdGl2ZSAhPT0gY2hhcmFjdGVyLmlzQWN0aXZlO1xyXG4gIGlmIChoYXNTaWduaWZpY2FudENoYW5nZXMpIHtcclxuICAgIGF3YWl0IGFwcGVuZEVudGl0eUxvZygnY2hhcmFjdGVyJywgY2hhcmFjdGVyLmlkLCAnVVBEQVRFRCcsIHtcclxuICAgICAgbmFtZTogY2hhcmFjdGVyLm5hbWUsXHJcbiAgICAgIGlzQWN0aXZlOiBjaGFyYWN0ZXIuaXNBY3RpdmVcclxuICAgIH0pO1xyXG4gIH1cclxuICBcclxuICAvLyBEZXNjcmlwdGl2ZSBjaGFuZ2VzIC0gdXBkYXRlIGluLXBsYWNlXHJcbiAgZm9yIChjb25zdCBmaWVsZCBvZiBERVNDUklQVElWRV9GSUVMRFMpIHtcclxuICAgIGlmICgocHJldmlvdXNDaGFyYWN0ZXIgYXMgYW55KVtmaWVsZF0gIT09IChjaGFyYWN0ZXIgYXMgYW55KVtmaWVsZF0pIHtcclxuICAgICAgYXdhaXQgdXBkYXRlRW50aXR5TG9nRmllbGQoJ2NoYXJhY3RlcicsIGNoYXJhY3Rlci5pZCwgZmllbGQsIChwcmV2aW91c0NoYXJhY3RlciBhcyBhbnkpW2ZpZWxkXSwgKGNoYXJhY3RlciBhcyBhbnkpW2ZpZWxkXSk7XHJcbiAgICB9XHJcbiAgfVxyXG59XHJcblxyXG4vKipcclxuICogUmVtb3ZlIGNoYXJhY3RlciBlZmZlY3RzIHdoZW4gY2hhcmFjdGVyIGlzIGRlbGV0ZWRcclxuICogQ2hhcmFjdGVycyBjYW4gaGF2ZSBlbnRyaWVzIGluIGNoYXJhY3RlciBsb2cgYW5kIHJlbGF0ZWQgbGlua3NcclxuICovXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiByZW1vdmVDaGFyYWN0ZXJFZmZlY3RzT25EZWxldGUoY2hhcmFjdGVySWQ6IHN0cmluZyk6IFByb21pc2U8dm9pZD4ge1xyXG4gIHRyeSB7XHJcbiAgICBjb25zb2xlLmxvZyhgW3JlbW92ZUNoYXJhY3RlckVmZmVjdHNPbkRlbGV0ZV0gU3RhcnRpbmcgY2xlYW51cCBmb3IgY2hhcmFjdGVyOiAke2NoYXJhY3RlcklkfWApO1xyXG4gICAgXHJcbiAgICAvLyAxLiBSZW1vdmUgYWxsIExpbmtzIHJlbGF0ZWQgdG8gdGhpcyBjaGFyYWN0ZXJcclxuICAgIGNvbnN0IGNoYXJhY3RlckxpbmtzID0gYXdhaXQgQ2xpZW50QVBJLmdldExpbmtzRm9yKHsgdHlwZTogJ2NoYXJhY3RlcicsIGlkOiBjaGFyYWN0ZXJJZCB9KTtcclxuICAgIGNvbnNvbGUubG9nKGBbcmVtb3ZlQ2hhcmFjdGVyRWZmZWN0c09uRGVsZXRlXSBGb3VuZCAke2NoYXJhY3RlckxpbmtzLmxlbmd0aH0gbGlua3MgdG8gcmVtb3ZlYCk7XHJcbiAgICBcclxuICAgIGZvciAoY29uc3QgbGluayBvZiBjaGFyYWN0ZXJMaW5rcykge1xyXG4gICAgICB0cnkge1xyXG4gICAgICAgIGF3YWl0IENsaWVudEFQSS5yZW1vdmVMaW5rKGxpbmsuaWQpO1xyXG4gICAgICAgIGNvbnNvbGUubG9nKGBbcmVtb3ZlQ2hhcmFjdGVyRWZmZWN0c09uRGVsZXRlXSDinIUgUmVtb3ZlZCBsaW5rOiAke2xpbmsubGlua1R5cGV9YCk7XHJcbiAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XHJcbiAgICAgICAgY29uc29sZS5lcnJvcihgW3JlbW92ZUNoYXJhY3RlckVmZmVjdHNPbkRlbGV0ZV0g4p2MIEZhaWxlZCB0byByZW1vdmUgbGluayAke2xpbmsuaWR9OmAsIGVycm9yKTtcclxuICAgICAgfVxyXG4gICAgfVxyXG4gICAgXHJcbiAgICAvLyAyLiBDbGVhciBhbGwgZWZmZWN0cyBmb3IgdGhpcyBjaGFyYWN0ZXJcclxuICAgIGF3YWl0IGNsZWFyRWZmZWN0KGBjaGFyYWN0ZXI6JHtjaGFyYWN0ZXJJZH06Y3JlYXRlZGApO1xyXG4gICAgYXdhaXQgY2xlYXJFZmZlY3RzQnlQcmVmaXgoJ2NoYXJhY3RlcicsIGNoYXJhY3RlcklkLCAnJyk7XHJcbiAgICBcclxuICAgIC8vIDMuIFJlbW92ZSBsb2cgZW50cmllcyBmcm9tIGNoYXJhY3RlciBsb2dcclxuICAgIGNvbnNvbGUubG9nKGBbcmVtb3ZlQ2hhcmFjdGVyRWZmZWN0c09uRGVsZXRlXSBTdGFydGluZyBsb2cgZW50cnkgcmVtb3ZhbCBmb3IgY2hhcmFjdGVyOiAke2NoYXJhY3RlcklkfWApO1xyXG4gICAgXHJcbiAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBDbGllbnRBUEkucmVtb3ZlTG9nRW50cnkoJ2NoYXJhY3RlcicsIGNoYXJhY3RlcklkKTtcclxuICAgIFxyXG4gICAgaWYgKHJlc3VsdC5zdWNjZXNzKSB7XHJcbiAgICAgIGNvbnNvbGUubG9nKGBbcmVtb3ZlQ2hhcmFjdGVyRWZmZWN0c09uRGVsZXRlXSDinIUgQ2hhcmFjdGVyIGxvZyBlbnRyaWVzIHJlbW92ZWQgc3VjY2Vzc2Z1bGx5IGZvciBjaGFyYWN0ZXI6ICR7Y2hhcmFjdGVySWR9YCk7XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICBjb25zb2xlLmVycm9yKGBbcmVtb3ZlQ2hhcmFjdGVyRWZmZWN0c09uRGVsZXRlXSBGYWlsZWQgdG8gcmVtb3ZlIGNoYXJhY3RlciBsb2cgZW50cmllczogJHtyZXN1bHQubWVzc2FnZX1gKTtcclxuICAgIH1cclxuICAgIFxyXG4gICAgY29uc29sZS5sb2coYFtyZW1vdmVDaGFyYWN0ZXJFZmZlY3RzT25EZWxldGVdIOKchSBDbGVhcmVkIGVmZmVjdHMsIHJlbW92ZWQgbGlua3MsIGFuZCByZW1vdmVkIGxvZyBlbnRyaWVzIGZvciBjaGFyYWN0ZXIgJHtjaGFyYWN0ZXJJZH1gKTtcclxuICB9IGNhdGNoIChlcnJvcikge1xyXG4gICAgY29uc29sZS5lcnJvcignRXJyb3IgcmVtb3ZpbmcgY2hhcmFjdGVyIGVmZmVjdHM6JywgZXJyb3IpO1xyXG4gIH1cclxufVxyXG5cclxuLyoqXHJcbiAqIExvZyBjaGFyYWN0ZXIgZWZmZWN0IGZyb20gdGFzayBjb21wbGV0aW9uXHJcbiAqIFRoaXMgaXMgY3VycmVudGx5IGEgbm8tb3Agc2luY2UgdGFza3MgZG9uJ3QgYXdhcmQganVuZ2xlIGNvaW5zIGFueW1vcmVcclxuICogSiQgYXJlIG9ubHkgZWFybmVkIHZpYSBQb2ludHMgRXhjaGFuZ2VcclxuICovXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBsb2dDaGFyYWN0ZXJFZmZlY3QodGFzazogVGFzayk6IFByb21pc2U8dm9pZD4ge1xyXG4gIC8vIEokIG5vIGxvbmdlciBhd2FyZGVkIGFzIHRhc2sgcmV3YXJkcyAtIG9ubHkgZWFybmVkIHZpYSBQb2ludHMgRXhjaGFuZ2VcclxuICAvLyBUaGlzIGZ1bmN0aW9uIGlzIG5vdyBhIG5vLW9wIHNpbmNlIHRhc2tzIGRvbid0IGF3YXJkIEokIGFueW1vcmVcclxuICByZXR1cm47XHJcbn1cclxuXHJcbi8qKlxyXG4gKiBMb2cgY2hhcmFjdGVyIGVmZmVjdCBmcm9tIGZpbmFuY2lhbCByZWNvcmRcclxuICogVGhpcyBsb2dzIHRoZSBqdW5nbGUgY29pbnMgYXdhcmRlZCB0byB0aGUgY2hhcmFjdGVyIGZyb20gYSBmaW5hbmNpYWwgcmVjb3JkXHJcbiAqL1xyXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gbG9nQ2hhcmFjdGVyRWZmZWN0RnJvbVJlY29yZChyZWNvcmQ6IEZpbmFuY2lhbFJlY29yZCk6IFByb21pc2U8dm9pZD4ge1xyXG4gIHRyeSB7XHJcbiAgICBjb25zb2xlLmxvZyhgW2xvZ0NoYXJhY3RlckVmZmVjdEZyb21SZWNvcmRdIExvZ2dpbmcgY2hhcmFjdGVyIGVmZmVjdCBmb3IgcmVjb3JkOiAke3JlY29yZC5uYW1lfSAoJHtyZWNvcmQuaWR9KWApO1xyXG4gICAgXHJcbiAgICAvLyBPbmx5IGxvZyBpZiB0aGVyZSBhcmUganVuZ2xlIGNvaW5zIHRvIGF3YXJkXHJcbiAgICBpZiAoIXJlY29yZC5qdW5nbGVDb2lucyB8fCByZWNvcmQuanVuZ2xlQ29pbnMgPD0gMCkge1xyXG4gICAgICBjb25zb2xlLmxvZygnW2xvZ0NoYXJhY3RlckVmZmVjdEZyb21SZWNvcmRdIE5vIGp1bmdsZSBjb2lucyB0byBsb2csIHNraXBwaW5nJyk7XHJcbiAgICAgIHJldHVybjtcclxuICAgIH1cclxuICAgIFxyXG4gICAgLy8gR2V0IG1haW4gY2hhcmFjdGVyIElEIChWMC4xIGNvbnN0YW50KVxyXG4gICAgY29uc3QgbWFpbkNoYXJhY3RlcklkID0gJ0NIQVJBQ1RFUl9PTkVfSUQnO1xyXG4gICAgXHJcbiAgICBhd2FpdCBhcHBlbmRDaGFyYWN0ZXJKdW5nbGVDb2luc0xvZyhcclxuICAgICAgbWFpbkNoYXJhY3RlcklkLFxyXG4gICAgICByZWNvcmQuanVuZ2xlQ29pbnMsXHJcbiAgICAgIHJlY29yZC5pZCxcclxuICAgICAgJ2ZpbmFuY2lhbCdcclxuICAgICk7XHJcbiAgICBcclxuICAgIGNvbnNvbGUubG9nKGBbbG9nQ2hhcmFjdGVyRWZmZWN0RnJvbVJlY29yZF0g4pyFIENoYXJhY3RlciBlZmZlY3QgbG9nZ2VkIHN1Y2Nlc3NmdWxseSBmb3IgJHtyZWNvcmQubmFtZX1gKTtcclxuICB9IGNhdGNoIChlcnJvcikge1xyXG4gICAgY29uc29sZS5lcnJvcignRXJyb3IgbG9nZ2luZyBjaGFyYWN0ZXIgZWZmZWN0IGZyb20gcmVjb3JkOicsIGVycm9yKTtcclxuICB9XHJcbn1cclxuXHJcbi8qKlxyXG4gKiBMb2cgY2hhcmFjdGVyIHVwZGF0ZSBmcm9tIHRhc2sgY2hhbmdlc1xyXG4gKiBUaGlzIGlzIGN1cnJlbnRseSBhIG5vLW9wIHNpbmNlIHRhc2tzIGRvbid0IGF3YXJkIGp1bmdsZSBjb2lucyBhbnltb3JlXHJcbiAqIEokIGFyZSBvbmx5IGVhcm5lZCB2aWEgUG9pbnRzIEV4Y2hhbmdlXHJcbiAqL1xyXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gbG9nQ2hhcmFjdGVyVXBkYXRlRnJvbVRhc2sodGFzazogVGFzaywgb2xkVGFzazogVGFzayk6IFByb21pc2U8dm9pZD4ge1xyXG4gIC8vIEokIG5vIGxvbmdlciBhd2FyZGVkIGFzIHRhc2sgcmV3YXJkcyAtIG9ubHkgZWFybmVkIHZpYSBQb2ludHMgRXhjaGFuZ2VcclxuICAvLyBUaGlzIGZ1bmN0aW9uIGlzIG5vdyBhIG5vLW9wIHNpbmNlIHRhc2tzIGRvbid0IGF3YXJkIEokIGFueW1vcmVcclxuICByZXR1cm47XHJcbn0iXSwibmFtZXMiOlsiYXBwZW5kRW50aXR5TG9nIiwidXBkYXRlRW50aXR5TG9nRmllbGQiLCJoYXNFZmZlY3QiLCJtYXJrRWZmZWN0IiwiY2xlYXJFZmZlY3QiLCJjbGVhckVmZmVjdHNCeVByZWZpeCIsIkNsaWVudEFQSSIsImFwcGVuZENoYXJhY3Rlckp1bmdsZUNvaW5zTG9nIiwiU1RBVEVfRklFTERTIiwiREVTQ1JJUFRJVkVfRklFTERTIiwib25DaGFyYWN0ZXJVcHNlcnQiLCJjaGFyYWN0ZXIiLCJwcmV2aW91c0NoYXJhY3RlciIsImVmZmVjdEtleSIsImlkIiwibmFtZSIsInJvbGVzIiwicm9sZXNDaGFuZ2VkIiwiSlNPTiIsInN0cmluZ2lmeSIsIm9sZFJvbGVzIiwibmV3Um9sZXMiLCJoYXNTaWduaWZpY2FudENoYW5nZXMiLCJpc0FjdGl2ZSIsImZpZWxkIiwicmVtb3ZlQ2hhcmFjdGVyRWZmZWN0c09uRGVsZXRlIiwiY2hhcmFjdGVySWQiLCJjb25zb2xlIiwibG9nIiwiY2hhcmFjdGVyTGlua3MiLCJnZXRMaW5rc0ZvciIsInR5cGUiLCJsZW5ndGgiLCJsaW5rIiwicmVtb3ZlTGluayIsImxpbmtUeXBlIiwiZXJyb3IiLCJyZXN1bHQiLCJyZW1vdmVMb2dFbnRyeSIsInN1Y2Nlc3MiLCJtZXNzYWdlIiwibG9nQ2hhcmFjdGVyRWZmZWN0IiwidGFzayIsImxvZ0NoYXJhY3RlckVmZmVjdEZyb21SZWNvcmQiLCJyZWNvcmQiLCJqdW5nbGVDb2lucyIsIm1haW5DaGFyYWN0ZXJJZCIsImxvZ0NoYXJhY3RlclVwZGF0ZUZyb21UYXNrIiwib2xkVGFzayJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(app-pages-browser)/./workflows/entities-workflows/character.workflow.ts\n"));

/***/ }),

/***/ "(app-pages-browser)/./workflows/entities-workflows/financial.workflow.ts":
/*!************************************************************!*\
  !*** ./workflows/entities-workflows/financial.workflow.ts ***!
  \************************************************************/
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval(__webpack_require__.ts("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   onFinancialUpsert: function() { return /* binding */ onFinancialUpsert; },\n/* harmony export */   removeRecordEffectsOnDelete: function() { return /* binding */ removeRecordEffectsOnDelete; }\n/* harmony export */ });\n/* harmony import */ var _entities_logging__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../entities-logging */ \"(app-pages-browser)/./workflows/entities-logging.ts\");\n/* harmony import */ var _data_store_effects_registry__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @/data-store/effects-registry */ \"(app-pages-browser)/./data-store/effects-registry.ts\");\n/* harmony import */ var _lib_client_api__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @/lib/client-api */ \"(app-pages-browser)/./lib/client-api.ts\");\n/* harmony import */ var _item_creation_utils__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../item-creation-utils */ \"(app-pages-browser)/./workflows/item-creation-utils.ts\");\n/* harmony import */ var _points_rewards_utils__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../points-rewards-utils */ \"(app-pages-browser)/./workflows/points-rewards-utils.ts\");\n/* harmony import */ var _update_propagation_utils__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../update-propagation-utils */ \"(app-pages-browser)/./workflows/update-propagation-utils.ts\");\n// workflows/entities-workflows/financial.workflow.ts\n// Financial-specific workflow with CHARGED, COLLECTED events\n\n\n\n\n\n\nconst STATE_FIELDS = [\n    \"isNotPaid\",\n    \"isNotCharged\",\n    \"isCollected\"\n];\nconst DESCRIPTIVE_FIELDS = [\n    \"name\",\n    \"description\",\n    \"cost\",\n    \"revenue\",\n    \"jungleCoins\",\n    \"notes\"\n];\nasync function onFinancialUpsert(financial, previousFinancial) {\n    // New financial record creation\n    if (!previousFinancial) {\n        var _financial_rewards;\n        const effectKey = \"financial:\".concat(financial.id, \":created\");\n        if (await (0,_data_store_effects_registry__WEBPACK_IMPORTED_MODULE_1__.hasEffect)(effectKey)) return;\n        await (0,_entities_logging__WEBPACK_IMPORTED_MODULE_0__.appendEntityLog)(\"financial\", financial.id, \"CREATED\", {\n            name: financial.name,\n            type: financial.type,\n            station: financial.station\n        });\n        await (0,_data_store_effects_registry__WEBPACK_IMPORTED_MODULE_1__.markEffect)(effectKey);\n        // Item creation from emissary fields - on record creation\n        if (financial.outputItemType && financial.outputQuantity) {\n            const itemEffectKey = \"financial:\".concat(financial.id, \":itemCreated\");\n            if (!await (0,_data_store_effects_registry__WEBPACK_IMPORTED_MODULE_1__.hasEffect)(itemEffectKey)) {\n                console.log(\"[onFinancialUpsert] Creating item from financial record emissary fields: \".concat(financial.name));\n                const createdItem = await (0,_item_creation_utils__WEBPACK_IMPORTED_MODULE_3__.createItemFromRecord)(financial);\n                if (createdItem) {\n                    await (0,_data_store_effects_registry__WEBPACK_IMPORTED_MODULE_1__.markEffect)(itemEffectKey);\n                    console.log(\"[onFinancialUpsert]  Item created and effect marked: \".concat(createdItem.name));\n                }\n            }\n        }\n        // Points awarding - on record creation with rewards\n        if ((_financial_rewards = financial.rewards) === null || _financial_rewards === void 0 ? void 0 : _financial_rewards.points) {\n            const pointsEffectKey = \"financial:\".concat(financial.id, \":pointsAwarded\");\n            if (!await (0,_data_store_effects_registry__WEBPACK_IMPORTED_MODULE_1__.hasEffect)(pointsEffectKey)) {\n                console.log(\"[onFinancialUpsert] Awarding points from financial record: \".concat(financial.name));\n                await (0,_points_rewards_utils__WEBPACK_IMPORTED_MODULE_4__.awardPointsToPlayer)((0,_points_rewards_utils__WEBPACK_IMPORTED_MODULE_4__.getMainPlayerId)(), {\n                    xp: financial.rewards.points.xp || 0,\n                    rp: financial.rewards.points.rp || 0,\n                    fp: financial.rewards.points.fp || 0,\n                    hp: financial.rewards.points.hp || 0\n                }, financial.id, \"financial\");\n                await (0,_data_store_effects_registry__WEBPACK_IMPORTED_MODULE_1__.markEffect)(pointsEffectKey);\n                console.log(\"[onFinancialUpsert]  Points awarded and effect marked for record: \".concat(financial.name));\n            }\n        }\n        // Jungle coins awarding - on record creation\n        if (financial.jungleCoins && financial.jungleCoins > 0) {\n            const jungleCoinsEffectKey = \"financial:\".concat(financial.id, \":jungleCoinsAwarded\");\n            if (!await (0,_data_store_effects_registry__WEBPACK_IMPORTED_MODULE_1__.hasEffect)(jungleCoinsEffectKey)) {\n                console.log(\"[onFinancialUpsert] Awarding jungle coins from financial record: \".concat(financial.name));\n                await (0,_points_rewards_utils__WEBPACK_IMPORTED_MODULE_4__.awardJungleCoinsToCharacter)((0,_points_rewards_utils__WEBPACK_IMPORTED_MODULE_4__.getMainCharacterId)(), financial.jungleCoins, financial.id, \"financial\");\n                await (0,_data_store_effects_registry__WEBPACK_IMPORTED_MODULE_1__.markEffect)(jungleCoinsEffectKey);\n                console.log(\"[onFinancialUpsert]  Jungle coins awarded and effect marked for record: \".concat(financial.name));\n            }\n        }\n        return;\n    }\n    // Payment status changes - CHARGED event\n    if (previousFinancial.isNotCharged && !financial.isNotCharged) {\n        await (0,_entities_logging__WEBPACK_IMPORTED_MODULE_0__.appendEntityLog)(\"financial\", financial.id, \"CHARGED\", {\n            name: financial.name,\n            revenue: financial.revenue,\n            chargedAt: new Date().toISOString()\n        });\n    }\n    // Collection status - COLLECTED event\n    if (!previousFinancial.isCollected && financial.isCollected) {\n        await (0,_entities_logging__WEBPACK_IMPORTED_MODULE_0__.appendEntityLog)(\"financial\", financial.id, \"COLLECTED\", {\n            name: financial.name,\n            collectedAt: new Date().toISOString()\n        });\n    }\n    // COMPREHENSIVE UPDATE PROPAGATION - when financial record properties change\n    if (previousFinancial) {\n        // Propagate to Tasks\n        if ((0,_update_propagation_utils__WEBPACK_IMPORTED_MODULE_5__.hasFinancialPropsChanged)(financial, previousFinancial)) {\n            console.log(\"[onFinancialUpsert] Propagating financial changes to tasks: \".concat(financial.name));\n            await (0,_update_propagation_utils__WEBPACK_IMPORTED_MODULE_5__.updateTasksFromFinancialRecord)(financial, previousFinancial);\n        }\n        // Propagate to Items\n        if ((0,_update_propagation_utils__WEBPACK_IMPORTED_MODULE_5__.hasOutputPropsChanged)(financial, previousFinancial)) {\n            console.log(\"[onFinancialUpsert] Propagating output changes to items: \".concat(financial.name));\n            await (0,_update_propagation_utils__WEBPACK_IMPORTED_MODULE_5__.updateItemsCreatedByRecord)(financial, previousFinancial);\n        }\n        // Propagate to Player (points delta)\n        if ((0,_update_propagation_utils__WEBPACK_IMPORTED_MODULE_5__.hasRewardsChanged)(financial, previousFinancial)) {\n            console.log(\"[onFinancialUpsert] Propagating points changes to player: \".concat(financial.name));\n            await (0,_update_propagation_utils__WEBPACK_IMPORTED_MODULE_5__.updatePlayerPointsFromSource)(\"financial\", financial, previousFinancial);\n        }\n        // Propagate to Character (jungle coins delta)\n        if ((0,_update_propagation_utils__WEBPACK_IMPORTED_MODULE_5__.hasJungleCoinsChanged)(financial, previousFinancial)) {\n            console.log(\"[onFinancialUpsert] Propagating jungle coins changes to character: \".concat(financial.name));\n            await (0,_update_propagation_utils__WEBPACK_IMPORTED_MODULE_5__.updateCharacterJungleCoinsFromRecord)(financial, previousFinancial);\n        }\n    }\n    // Descriptive changes - update in-place\n    for (const field of DESCRIPTIVE_FIELDS){\n        if (previousFinancial[field] !== financial[field]) {\n            await (0,_entities_logging__WEBPACK_IMPORTED_MODULE_0__.updateEntityLogField)(\"financial\", financial.id, field, previousFinancial[field], financial[field]);\n        }\n    }\n}\n/**\r\n * Remove financial record effects when record is deleted\r\n * Financial records can have entries in multiple logs: financials, character, player, items\r\n */ async function removeRecordEffectsOnDelete(recordId) {\n    try {\n        console.log(\"[removeRecordEffectsOnDelete] Starting cleanup for record: \".concat(recordId));\n        // 1. Remove items created by this record\n        await (0,_item_creation_utils__WEBPACK_IMPORTED_MODULE_3__.removeItemsCreatedByRecord)(recordId);\n        // 2. Remove player points that were awarded by this record (if points were badly given)\n        await removePlayerPointsFromRecord(recordId);\n        // 3. Remove jungle coins that were awarded by this record\n        await removeJungleCoinsFromRecord(recordId);\n        // 4. Remove all Links related to this record\n        const recordLinks = await _lib_client_api__WEBPACK_IMPORTED_MODULE_2__.ClientAPI.getLinksFor({\n            type: \"financial\",\n            id: recordId\n        });\n        console.log(\"[removeRecordEffectsOnDelete] Found \".concat(recordLinks.length, \" links to remove\"));\n        for (const link of recordLinks){\n            try {\n                await _lib_client_api__WEBPACK_IMPORTED_MODULE_2__.ClientAPI.removeLink(link.id);\n                console.log(\"[removeRecordEffectsOnDelete]  Removed link: \".concat(link.linkType));\n            } catch (error) {\n                console.error(\"[removeRecordEffectsOnDelete]  Failed to remove link \".concat(link.id, \":\"), error);\n            }\n        }\n        // 5. Clear effects registry\n        await (0,_data_store_effects_registry__WEBPACK_IMPORTED_MODULE_1__.clearEffect)(\"financial:\".concat(recordId, \":created\"));\n        await (0,_data_store_effects_registry__WEBPACK_IMPORTED_MODULE_1__.clearEffect)(\"financial:\".concat(recordId, \":itemCreated\"));\n        await (0,_data_store_effects_registry__WEBPACK_IMPORTED_MODULE_1__.clearEffect)(\"financial:\".concat(recordId, \":pointsAwarded\"));\n        await (0,_data_store_effects_registry__WEBPACK_IMPORTED_MODULE_1__.clearEffect)(\"financial:\".concat(recordId, \":jungleCoinsAwarded\"));\n        await (0,_data_store_effects_registry__WEBPACK_IMPORTED_MODULE_1__.clearEffectsByPrefix)(\"financial\", recordId, \"pointsLogged:\");\n        await (0,_data_store_effects_registry__WEBPACK_IMPORTED_MODULE_1__.clearEffectsByPrefix)(\"financial\", recordId, \"financialLogged:\");\n        // 6. Remove log entries from all relevant logs\n        console.log(\"[removeRecordEffectsOnDelete] Starting log entry removal for record: \".concat(recordId));\n        const removals = await Promise.all([\n            _lib_client_api__WEBPACK_IMPORTED_MODULE_2__.ClientAPI.removeLogEntry(\"financials\", recordId).then((r)=>{\n                console.log(\"[removeRecordEffectsOnDelete] Financials log removal result:\", r);\n                return r;\n            }).catch((e)=>({\n                    success: false,\n                    message: String(e)\n                })),\n            _lib_client_api__WEBPACK_IMPORTED_MODULE_2__.ClientAPI.removeLogEntry(\"character\", recordId).then((r)=>{\n                console.log(\"[removeRecordEffectsOnDelete] Character log removal result:\", r);\n                return r;\n            }).catch((e)=>({\n                    success: false,\n                    message: String(e)\n                })),\n            _lib_client_api__WEBPACK_IMPORTED_MODULE_2__.ClientAPI.removeLogEntry(\"player\", recordId).then((r)=>{\n                console.log(\"[removeRecordEffectsOnDelete] Player log removal result:\", r);\n                return r;\n            }).catch((e)=>({\n                    success: false,\n                    message: String(e)\n                })),\n            _lib_client_api__WEBPACK_IMPORTED_MODULE_2__.ClientAPI.removeLogEntry(\"items\", recordId).then((r)=>{\n                console.log(\"[removeRecordEffectsOnDelete] Items log removal result:\", r);\n                return r;\n            }).catch((e)=>({\n                    success: false,\n                    message: String(e)\n                }))\n        ]);\n        console.log(\"[removeRecordEffectsOnDelete] All removal results:\", removals);\n        const failed = removals.filter((r)=>!r.success);\n        if (failed.length > 0) {\n            console.error(\"[removeRecordEffectsOnDelete] Some log removals failed:\", failed);\n        } else {\n            console.log(\"[removeRecordEffectsOnDelete]  All log entries removed successfully for record: \".concat(recordId));\n        }\n        console.log(\"[removeRecordEffectsOnDelete]  Cleared effects, removed links, deleted created items, and removed log entries for record \".concat(recordId));\n    } catch (error) {\n        console.error(\"Error removing record effects:\", error);\n    }\n}\n/**\r\n * Remove player points that were awarded by a specific financial record\r\n * This is used when rolling back a record that incorrectly awarded points\r\n */ async function removePlayerPointsFromRecord(recordId) {\n    try {\n        var _record_rewards;\n        console.log(\"[removePlayerPointsFromRecord] Removing points for record: \".concat(recordId));\n        // Get the record to find what points were awarded\n        const records = await _lib_client_api__WEBPACK_IMPORTED_MODULE_2__.ClientAPI.getFinancialRecords();\n        const record = records.find((r)=>r.id === recordId);\n        if (!record || !((_record_rewards = record.rewards) === null || _record_rewards === void 0 ? void 0 : _record_rewards.points)) {\n            console.log(\"[removePlayerPointsFromRecord] Record \".concat(recordId, \" has no points to remove\"));\n            return;\n        }\n        // Get the main player\n        const mainPlayerId = (0,_points_rewards_utils__WEBPACK_IMPORTED_MODULE_4__.getMainPlayerId)();\n        const players = await _lib_client_api__WEBPACK_IMPORTED_MODULE_2__.ClientAPI.getPlayers();\n        const mainPlayer = players.find((p)=>p.id === mainPlayerId);\n        if (!mainPlayer) {\n            console.log(\"[removePlayerPointsFromRecord] Main player not found, skipping points removal\");\n            return;\n        }\n        // Check if any points were actually awarded\n        const pointsToRemove = record.rewards.points;\n        const hasPoints = (pointsToRemove.xp || 0) > 0 || (pointsToRemove.rp || 0) > 0 || (pointsToRemove.fp || 0) > 0 || (pointsToRemove.hp || 0) > 0;\n        if (!hasPoints) {\n            console.log(\"[removePlayerPointsFromRecord] No points to remove from record \".concat(recordId));\n            return;\n        }\n        // Remove the points from the player\n        await (0,_points_rewards_utils__WEBPACK_IMPORTED_MODULE_4__.removePointsFromPlayer)(mainPlayerId, {\n            xp: pointsToRemove.xp || 0,\n            rp: pointsToRemove.rp || 0,\n            fp: pointsToRemove.fp || 0,\n            hp: pointsToRemove.hp || 0\n        });\n        console.log(\"[removePlayerPointsFromRecord]  Removed points from player: \".concat(JSON.stringify(pointsToRemove)));\n    } catch (error) {\n        console.error(\"[removePlayerPointsFromRecord]  Failed to remove player points for record \".concat(recordId, \":\"), error);\n    }\n}\n/**\r\n * Remove jungle coins that were awarded by a specific financial record\r\n * This is used when rolling back a record that incorrectly awarded jungle coins\r\n */ async function removeJungleCoinsFromRecord(recordId) {\n    try {\n        console.log(\"[removeJungleCoinsFromRecord] Removing jungle coins for record: \".concat(recordId));\n        // Get the record to find what jungle coins were awarded\n        const records = await _lib_client_api__WEBPACK_IMPORTED_MODULE_2__.ClientAPI.getFinancialRecords();\n        const record = records.find((r)=>r.id === recordId);\n        if (!record || !record.jungleCoins || record.jungleCoins <= 0) {\n            console.log(\"[removeJungleCoinsFromRecord] Record \".concat(recordId, \" has no jungle coins to remove\"));\n            return;\n        }\n        // Get the main character\n        const mainCharacterId = (0,_points_rewards_utils__WEBPACK_IMPORTED_MODULE_4__.getMainCharacterId)();\n        const characters = await _lib_client_api__WEBPACK_IMPORTED_MODULE_2__.ClientAPI.getCharacters();\n        const mainCharacter = characters.find((c)=>c.id === mainCharacterId);\n        if (!mainCharacter) {\n            console.log(\"[removeJungleCoinsFromRecord] Main character not found, skipping jungle coins removal\");\n            return;\n        }\n        // Remove the jungle coins from the character\n        await (0,_points_rewards_utils__WEBPACK_IMPORTED_MODULE_4__.removeJungleCoinsFromCharacter)(mainCharacterId, record.jungleCoins);\n        console.log(\"[removeJungleCoinsFromRecord]  Removed \".concat(record.jungleCoins, \" jungle coins from character\"));\n    } catch (error) {\n        console.error(\"[removeJungleCoinsFromRecord]  Failed to remove jungle coins for record \".concat(recordId, \":\"), error);\n    }\n}\n\n\n;\n    // Wrapped in an IIFE to avoid polluting the global scope\n    ;\n    (function () {\n        var _a, _b;\n        // Legacy CSS implementations will `eval` browser code in a Node.js context\n        // to extract CSS. For backwards compatibility, we need to check we're in a\n        // browser context before continuing.\n        if (typeof self !== 'undefined' &&\n            // AMP / No-JS mode does not inject these helpers:\n            '$RefreshHelpers$' in self) {\n            // @ts-ignore __webpack_module__ is global\n            var currentExports = module.exports;\n            // @ts-ignore __webpack_module__ is global\n            var prevSignature = (_b = (_a = module.hot.data) === null || _a === void 0 ? void 0 : _a.prevSignature) !== null && _b !== void 0 ? _b : null;\n            // This cannot happen in MainTemplate because the exports mismatch between\n            // templating and execution.\n            self.$RefreshHelpers$.registerExportsForReactRefresh(currentExports, module.id);\n            // A module can be accepted automatically based on its exports, e.g. when\n            // it is a Refresh Boundary.\n            if (self.$RefreshHelpers$.isReactRefreshBoundary(currentExports)) {\n                // Save the previous exports signature on update so we can compare the boundary\n                // signatures. We avoid saving exports themselves since it causes memory leaks (https://github.com/vercel/next.js/pull/53797)\n                module.hot.dispose(function (data) {\n                    data.prevSignature =\n                        self.$RefreshHelpers$.getRefreshBoundarySignature(currentExports);\n                });\n                // Unconditionally accept an update to this module, we'll check if it's\n                // still a Refresh Boundary later.\n                // @ts-ignore importMeta is replaced in the loader\n                module.hot.accept();\n                // This field is set when the previous version of this module was a\n                // Refresh Boundary, letting us know we need to check for invalidation or\n                // enqueue an update.\n                if (prevSignature !== null) {\n                    // A boundary can become ineligible if its exports are incompatible\n                    // with the previous exports.\n                    //\n                    // For example, if you add/remove/change exports, we'll want to\n                    // re-execute the importing modules, and force those components to\n                    // re-render. Similarly, if you convert a class component to a\n                    // function, we want to invalidate the boundary.\n                    if (self.$RefreshHelpers$.shouldInvalidateReactRefreshBoundary(prevSignature, self.$RefreshHelpers$.getRefreshBoundarySignature(currentExports))) {\n                        module.hot.invalidate();\n                    }\n                    else {\n                        self.$RefreshHelpers$.scheduleUpdate();\n                    }\n                }\n            }\n            else {\n                // Since we just executed the code for the module, it's possible that the\n                // new exports made it ineligible for being a boundary.\n                // We only care about the case when we were _previously_ a boundary,\n                // because we already accepted this update (accidental side effect).\n                var isNoLongerABoundary = prevSignature !== null;\n                if (isNoLongerABoundary) {\n                    module.hot.invalidate();\n                }\n            }\n        }\n    })();\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFwcC1wYWdlcy1icm93c2VyKS8uL3dvcmtmbG93cy9lbnRpdGllcy13b3JrZmxvd3MvZmluYW5jaWFsLndvcmtmbG93LnRzIiwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7O0FBQUEscURBQXFEO0FBQ3JELDZEQUE2RDtBQUdlO0FBQzZCO0FBQzVEO0FBQzZDO0FBQzhGO0FBVW5KO0FBRXJDLE1BQU11QixlQUFlO0lBQUM7SUFBYTtJQUFnQjtDQUFjO0FBQ2pFLE1BQU1DLHFCQUFxQjtJQUFDO0lBQVE7SUFBZTtJQUFRO0lBQVc7SUFBZTtDQUFRO0FBRXRGLGVBQWVDLGtCQUFrQkMsU0FBMEIsRUFBRUMsaUJBQW1DO0lBQ3JHLGdDQUFnQztJQUNoQyxJQUFJLENBQUNBLG1CQUFtQjtZQXlCbEJEO1FBeEJKLE1BQU1FLFlBQVksYUFBMEIsT0FBYkYsVUFBVUcsRUFBRSxFQUFDO1FBQzVDLElBQUksTUFBTTNCLHVFQUFTQSxDQUFDMEIsWUFBWTtRQUVoQyxNQUFNNUIsa0VBQWVBLENBQUMsYUFBYTBCLFVBQVVHLEVBQUUsRUFBRSxXQUFXO1lBQzFEQyxNQUFNSixVQUFVSSxJQUFJO1lBQ3BCQyxNQUFNTCxVQUFVSyxJQUFJO1lBQ3BCQyxTQUFTTixVQUFVTSxPQUFPO1FBQzVCO1FBQ0EsTUFBTTdCLHdFQUFVQSxDQUFDeUI7UUFFakIsMERBQTBEO1FBQzFELElBQUlGLFVBQVVPLGNBQWMsSUFBSVAsVUFBVVEsY0FBYyxFQUFFO1lBQ3hELE1BQU1DLGdCQUFnQixhQUEwQixPQUFiVCxVQUFVRyxFQUFFLEVBQUM7WUFDaEQsSUFBSSxDQUFFLE1BQU0zQix1RUFBU0EsQ0FBQ2lDLGdCQUFpQjtnQkFDckNDLFFBQVFDLEdBQUcsQ0FBQyw0RUFBMkYsT0FBZlgsVUFBVUksSUFBSTtnQkFDdEcsTUFBTVEsY0FBYyxNQUFNL0IsMEVBQW9CQSxDQUFDbUI7Z0JBQy9DLElBQUlZLGFBQWE7b0JBQ2YsTUFBTW5DLHdFQUFVQSxDQUFDZ0M7b0JBQ2pCQyxRQUFRQyxHQUFHLENBQUMs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QU13QixVQUFVLE1BQU0zRSxzREFBU0EsQ0FBQzRFLG1CQUFtQjtRQUNuRCxNQUFNRixTQUFTQyxRQUFRRSxJQUFJLENBQUNYLENBQUFBLElBQUtBLEVBQUUzQyxFQUFFLEtBQUs0QjtRQUUxQyxJQUFJLENBQUN1QixVQUFVLENBQUNBLE9BQU9sQyxXQUFXLElBQUlrQyxPQUFPbEMsV0FBVyxJQUFJLEdBQUc7WUFDN0RWLFFBQVFDLEdBQUcsQ0FBQyx3Q0FBaUQsT0FBVG9CLFVBQVM7WUFDN0Q7UUFDRjtRQUVBLHlCQUF5QjtRQUN6QixNQUFNb0Msa0JBQWtCL0UseUVBQWtCQTtRQUMxQyxNQUFNZ0YsYUFBYSxNQUFNeEYsc0RBQVNBLENBQUN5RixhQUFhO1FBQ2hELE1BQU1DLGdCQUFnQkYsV0FBV1gsSUFBSSxDQUFDYyxDQUFBQSxJQUFLQSxFQUFFcEUsRUFBRSxLQUFLZ0U7UUFFcEQsSUFBSSxDQUFDRyxlQUFlO1lBQ2xCNUQsUUFBUUMsR0FBRyxDQUFFO1lBQ2I7UUFDRjtRQUVBLDZDQUE2QztRQUM3QyxNQUFNekIscUZBQThCQSxDQUFDaUYsaUJBQWlCYixPQUFPbEMsV0FBVztRQUN4RVYsUUFBUUMsR0FBRyxDQUFDLDJDQUE4RCxPQUFuQjJDLE9BQU9sQyxXQUFXLEVBQUM7SUFFNUUsRUFBRSxPQUFPb0IsT0FBTztRQUNkOUIsUUFBUThCLEtBQUssQ0FBQyw0RUFBcUYsT0FBVFQsVUFBUyxNQUFJUztJQUN6RztBQUNGIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vX05fRS8uL3dvcmtmbG93cy9lbnRpdGllcy13b3JrZmxvd3MvZmluYW5jaWFsLndvcmtmbG93LnRzPzNjNGYiXSwic291cmNlc0NvbnRlbnQiOlsiLy8gd29ya2Zsb3dzL2VudGl0aWVzLXdvcmtmbG93cy9maW5hbmNpYWwud29ya2Zsb3cudHNcclxuLy8gRmluYW5jaWFsLXNwZWNpZmljIHdvcmtmbG93IHdpdGggQ0hBUkdFRCwgQ09MTEVDVEVEIGV2ZW50c1xyXG5cclxuaW1wb3J0IHR5cGUgeyBGaW5hbmNpYWxSZWNvcmQgfSBmcm9tICdAL3R5cGVzL2VudGl0aWVzJztcclxuaW1wb3J0IHsgYXBwZW5kRW50aXR5TG9nLCB1cGRhdGVFbnRpdHlMb2dGaWVsZCB9IGZyb20gJy4uL2VudGl0aWVzLWxvZ2dpbmcnO1xyXG5pbXBvcnQgeyBoYXNFZmZlY3QsIG1hcmtFZmZlY3QsIGNsZWFyRWZmZWN0LCBjbGVhckVmZmVjdHNCeVByZWZpeCB9IGZyb20gJ0AvZGF0YS1zdG9yZS9lZmZlY3RzLXJlZ2lzdHJ5JztcclxuaW1wb3J0IHsgQ2xpZW50QVBJIH0gZnJvbSAnQC9saWIvY2xpZW50LWFwaSc7XHJcbmltcG9ydCB7IGNyZWF0ZUl0ZW1Gcm9tUmVjb3JkLCByZW1vdmVJdGVtc0NyZWF0ZWRCeVJlY29yZCB9IGZyb20gJy4uL2l0ZW0tY3JlYXRpb24tdXRpbHMnO1xyXG5pbXBvcnQgeyBhd2FyZFBvaW50c1RvUGxheWVyLCByZW1vdmVQb2ludHNGcm9tUGxheWVyLCBhd2FyZEp1bmdsZUNvaW5zVG9DaGFyYWN0ZXIsIHJlbW92ZUp1bmdsZUNvaW5zRnJvbUNoYXJhY3RlciwgZ2V0TWFpblBsYXllcklkLCBnZXRNYWluQ2hhcmFjdGVySWQgfSBmcm9tICcuLi9wb2ludHMtcmV3YXJkcy11dGlscyc7XHJcbmltcG9ydCB7IFxyXG4gIHVwZGF0ZVRhc2tzRnJvbUZpbmFuY2lhbFJlY29yZCwgXHJcbiAgdXBkYXRlSXRlbXNDcmVhdGVkQnlSZWNvcmQsIFxyXG4gIHVwZGF0ZVBsYXllclBvaW50c0Zyb21Tb3VyY2UsXHJcbiAgdXBkYXRlQ2hhcmFjdGVySnVuZ2xlQ29pbnNGcm9tUmVjb3JkLFxyXG4gIGhhc0ZpbmFuY2lhbFByb3BzQ2hhbmdlZCxcclxuICBoYXNPdXRwdXRQcm9wc0NoYW5nZWQsXHJcbiAgaGFzUmV3YXJkc0NoYW5nZWQsXHJcbiAgaGFzSnVuZ2xlQ29pbnNDaGFuZ2VkXHJcbn0gZnJvbSAnLi4vdXBkYXRlLXByb3BhZ2F0aW9uLXV0aWxzJztcclxuXHJcbmNvbnN0IFNUQVRFX0ZJRUxEUyA9IFsnaXNOb3RQYWlkJywgJ2lzTm90Q2hhcmdlZCcsICdpc0NvbGxlY3RlZCddO1xyXG5jb25zdCBERVNDUklQVElWRV9GSUVMRFMgPSBbJ25hbWUnLCAnZGVzY3JpcHRpb24nLCAnY29zdCcsICdyZXZlbnVlJywgJ2p1bmdsZUNvaW5zJywgJ25vdGVzJ107XHJcblxyXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gb25GaW5hbmNpYWxVcHNlcnQoZmluYW5jaWFsOiBGaW5hbmNpYWxSZWNvcmQsIHByZXZpb3VzRmluYW5jaWFsPzogRmluYW5jaWFsUmVjb3JkKTogUHJvbWlzZTx2b2lkPiB7XHJcbiAgLy8gTmV3IGZpbmFuY2lhbCByZWNvcmQgY3JlYXRpb25cclxuICBpZiAoIXByZXZpb3VzRmluYW5jaWFsKSB7XHJcbiAgICBjb25zdCBlZmZlY3RLZXkgPSBgZmluYW5jaWFsOiR7ZmluYW5jaWFsLmlkfTpjcmVhdGVkYDtcclxuICAgIGlmIChhd2FpdCBoYXNFZmZlY3QoZWZmZWN0S2V5KSkgcmV0dXJuO1xyXG4gICAgXHJcbiAgICBhd2FpdCBhcHBlbmRFbnRpdHlMb2coJ2ZpbmFuY2lhbCcsIGZpbmFuY2lhbC5pZCwgJ0NSRUFURUQnLCB7IFxyXG4gICAgICBuYW1lOiBmaW5hbmNpYWwubmFtZSwgXHJcbiAgICAgIHR5cGU6IGZpbmFuY2lhbC50eXBlLFxyXG4gICAgICBzdGF0aW9uOiBmaW5hbmNpYWwuc3RhdGlvbixcclxuICAgIH0pO1xyXG4gICAgYXdhaXQgbWFya0VmZmVjdChlZmZlY3RLZXkpO1xyXG4gICAgXHJcbiAgICAvLyBJdGVtIGNyZWF0aW9uIGZyb20gZW1pc3NhcnkgZmllbGRzIC0gb24gcmVjb3JkIGNyZWF0aW9uXHJcbiAgICBpZiAoZmluYW5jaWFsLm91dHB1dEl0ZW1UeXBlICYmIGZpbmFuY2lhbC5vdXRwdXRRdWFudGl0eSkge1xyXG4gICAgICBjb25zdCBpdGVtRWZmZWN0S2V5ID0gYGZpbmFuY2lhbDoke2ZpbmFuY2lhbC5pZH06aXRlbUNyZWF0ZWRgO1xyXG4gICAgICBpZiAoIShhd2FpdCBoYXNFZmZlY3QoaXRlbUVmZmVjdEtleSkpKSB7XHJcbiAgICAgICAgY29uc29sZS5sb2coYFtvbkZpbmFuY2lhbFVwc2VydF0gQ3JlYXRpbmcgaXRlbSBmcm9tIGZpbmFuY2lhbCByZWNvcmQgZW1pc3NhcnkgZmllbGRzOiAke2ZpbmFuY2lhbC5uYW1lfWApO1xyXG4gICAgICAgIGNvbnN0IGNyZWF0ZWRJdGVtID0gYXdhaXQgY3JlYXRlSXRlbUZyb21SZWNvcmQoZmluYW5jaWFsKTtcclxuICAgICAgICBpZiAoY3JlYXRlZEl0ZW0pIHtcclxuICAgICAgICAgIGF3YWl0IG1hcmtFZmZlY3QoaXRlbUVmZmVjdEtleSk7XHJcbiAgICAgICAgICBjb25zb2xlLmxvZyhgW29uRmluYW5jaWFsVXBzZXJ0XSDinIUgSXRlbSBjcmVhdGVkIGFuZCBlZmZlY3QgbWFya2VkOiAke2NyZWF0ZWRJdGVtLm5hbWV9YCk7XHJcbiAgICAgICAgfVxyXG4gICAgICB9XHJcbiAgICB9XHJcbiAgICBcclxuICAgIC8vIFBvaW50cyBhd2FyZGluZyAtIG9uIHJlY29yZCBjcmVhdGlvbiB3aXRoIHJld2FyZHNcclxuICAgIGlmIChmaW5hbmNpYWwucmV3YXJkcz8ucG9pbnRzKSB7XHJcbiAgICAgIGNvbnN0IHBvaW50c0VmZmVjdEtleSA9IGBmaW5hbmNpYWw6JHtmaW5hbmNpYWwuaWR9OnBvaW50c0F3YXJkZWRgO1xyXG4gICAgICBpZiAoIShhd2FpdCBoYXNFZmZlY3QocG9pbnRzRWZmZWN0S2V5KSkpIHtcclxuICAgICAgICBjb25zb2xlLmxvZyhgW29uRmluYW5jaWFsVXBzZXJ0XSBBd2FyZGluZyBwb2ludHMgZnJvbSBmaW5hbmNpYWwgcmVjb3JkOiAke2ZpbmFuY2lhbC5uYW1lfWApO1xyXG4gICAgICAgIGF3YWl0IGF3YXJkUG9pbnRzVG9QbGF5ZXIoZ2V0TWFpblBsYXllcklkKCksIHtcclxuICAgICAgICAgIHhwOiBmaW5hbmNpYWwucmV3YXJkcy5wb2ludHMueHAgfHwgMCxcclxuICAgICAgICAgIHJwOiBmaW5hbmNpYWwucmV3YXJkcy5wb2ludHMucnAgfHwgMCxcclxuICAgICAgICAgIGZwOiBmaW5hbmNpYWwucmV3YXJkcy5wb2ludHMuZnAgfHwgMCxcclxuICAgICAgICAgIGhwOiBmaW5hbmNpYWwucmV3YXJkcy5wb2ludHMuaHAgfHwgMFxyXG4gICAgICAgIH0sIGZpbmFuY2lhbC5pZCwgJ2ZpbmFuY2lhbCcpO1xyXG4gICAgICAgIGF3YWl0IG1hcmtFZmZlY3QocG9pbnRzRWZmZWN0S2V5KTtcclxuICAgICAgICBjb25zb2xlLmxvZyhgW29uRmluYW5jaWFsVXBzZXJ0XSDinIUgUG9pbnRzIGF3YXJkZWQgYW5kIGVmZmVjdCBtYXJrZWQgZm9yIHJlY29yZDogJHtmaW5hbmNpYWwubmFtZX1gKTtcclxuICAgICAgfVxyXG4gICAgfVxyXG4gICAgXHJcbiAgICAvLyBKdW5nbGUgY29pbnMgYXdhcmRpbmcgLSBvbiByZWNvcmQgY3JlYXRpb25cclxuICAgIGlmIChmaW5hbmNpYWwuanVuZ2xlQ29pbnMgJiYgZmluYW5jaWFsLmp1bmdsZUNvaW5zID4gMCkge1xyXG4gICAgICBjb25zdCBqdW5nbGVDb2luc0VmZmVjdEtleSA9IGBmaW5hbmNpYWw6JHtmaW5hbmNpYWwuaWR9Omp1bmdsZUNvaW5zQXdhcmRlZGA7XHJcbiAgICAgIGlmICghKGF3YWl0IGhhc0VmZmVjdChqdW5nbGVDb2luc0VmZmVjdEtleSkpKSB7XHJcbiAgICAgICAgY29uc29sZS5sb2coYFtvbkZpbmFuY2lhbFVwc2VydF0gQXdhcmRpbmcganVuZ2xlIGNvaW5zIGZyb20gZmluYW5jaWFsIHJlY29yZDogJHtmaW5hbmNpYWwubmFtZX1gKTtcclxuICAgICAgICBhd2FpdCBhd2FyZEp1bmdsZUNvaW5zVG9DaGFyYWN0ZXIoZ2V0TWFpbkNoYXJhY3RlcklkKCksIGZpbmFuY2lhbC5qdW5nbGVDb2lucywgZmluYW5jaWFsLmlkLCAnZmluYW5jaWFsJyk7XHJcbiAgICAgICAgYXdhaXQgbWFya0VmZmVjdChqdW5nbGVDb2luc0VmZmVjdEtleSk7XHJcbiAgICAgICAgY29uc29sZS5sb2coYFtvbkZpbmFuY2lhbFVwc2VydF0g4pyFIEp1bmdsZSBjb2lucyBhd2FyZGVkIGFuZCBlZmZlY3QgbWFya2VkIGZvciByZWNvcmQ6ICR7ZmluYW5jaWFsLm5hbWV9YCk7XHJcbiAgICAgIH1cclxuICAgIH1cclxuICAgIFxyXG4gICAgcmV0dXJuO1xyXG4gIH1cclxuICBcclxuICAvLyBQYXltZW50IHN0YXR1cyBjaGFuZ2VzIC0gQ0hBUkdFRCBldmVudFxyXG4gIGlmIChwcmV2aW91c0ZpbmFuY2lhbC5pc05vdENoYXJnZWQgJiYgIWZpbmFuY2lhbC5pc05vdENoYXJnZWQpIHtcclxuICAgIGF3YWl0IGFwcGVuZEVudGl0eUxvZygnZmluYW5jaWFsJywgZmluYW5jaWFsLmlkLCAnQ0hBUkdFRCcsIHtcclxuICAgICAgbmFtZTogZmluYW5jaWFsLm5hbWUsXHJcbiAgICAgIHJldmVudWU6IGZpbmFuY2lhbC5yZXZlbnVlLFxyXG4gICAgICBjaGFyZ2VkQXQ6IG5ldyBEYXRlKCkudG9JU09TdHJpbmcoKVxyXG4gICAgfSk7XHJcbiAgfVxyXG4gIFxyXG4gIC8vIENvbGxlY3Rpb24gc3RhdHVzIC0gQ09MTEVDVEVEIGV2ZW50XHJcbiAgaWYgKCFwcmV2aW91c0ZpbmFuY2lhbC5pc0NvbGxlY3RlZCAmJiBmaW5hbmNpYWwuaXNDb2xsZWN0ZWQpIHtcclxuICAgIGF3YWl0IGFwcGVuZEVudGl0eUxvZygnZmluYW5jaWFsJywgZmluYW5jaWFsLmlkLCAnQ09MTEVDVEVEJywge1xyXG4gICAgICBuYW1lOiBmaW5hbmNpYWwubmFtZSxcclxuICAgICAgY29sbGVjdGVkQXQ6IG5ldyBEYXRlKCkudG9JU09TdHJpbmcoKVxyXG4gICAgfSk7XHJcbiAgfVxyXG4gIFxyXG4gIC8vIENPTVBSRUhFTlNJVkUgVVBEQVRFIFBST1BBR0FUSU9OIC0gd2hlbiBmaW5hbmNpYWwgcmVjb3JkIHByb3BlcnRpZXMgY2hhbmdlXHJcbiAgaWYgKHByZXZpb3VzRmluYW5jaWFsKSB7XHJcbiAgICAvLyBQcm9wYWdhdGUgdG8gVGFza3NcclxuICAgIGlmIChoYXNGaW5hbmNpYWxQcm9wc0NoYW5nZWQoZmluYW5jaWFsLCBwcmV2aW91c0ZpbmFuY2lhbCkpIHtcclxuICAgICAgY29uc29sZS5sb2coYFtvbkZpbmFuY2lhbFVwc2VydF0gUHJvcGFnYXRpbmcgZmluYW5jaWFsIGNoYW5nZXMgdG8gdGFza3M6ICR7ZmluYW5jaWFsLm5hbWV9YCk7XHJcbiAgICAgIGF3YWl0IHVwZGF0ZVRhc2tzRnJvbUZpbmFuY2lhbFJlY29yZChmaW5hbmNpYWwsIHByZXZpb3VzRmluYW5jaWFsKTtcclxuICAgIH1cclxuICAgIFxyXG4gICAgLy8gUHJvcGFnYXRlIHRvIEl0ZW1zXHJcbiAgICBpZiAoaGFzT3V0cHV0UHJvcHNDaGFuZ2VkKGZpbmFuY2lhbCwgcHJldmlvdXNGaW5hbmNpYWwpKSB7XHJcbiAgICAgIGNvbnNvbGUubG9nKGBbb25GaW5hbmNpYWxVcHNlcnRdIFByb3BhZ2F0aW5nIG91dHB1dCBjaGFuZ2VzIHRvIGl0ZW1zOiAke2ZpbmFuY2lhbC5uYW1lfWApO1xyXG4gICAgICBhd2FpdCB1cGRhdGVJdGVtc0NyZWF0ZWRCeVJlY29yZChmaW5hbmNpYWwsIHByZXZpb3VzRmluYW5jaWFsKTtcclxuICAgIH1cclxuICAgIFxyXG4gICAgLy8gUHJvcGFnYXRlIHRvIFBsYXllciAocG9pbnRzIGRlbHRhKVxyXG4gICAgaWYgKGhhc1Jld2FyZHNDaGFuZ2VkKGZpbmFuY2lhbCwgcHJldmlvdXNGaW5hbmNpYWwpKSB7XHJcbiAgICAgIGNvbnNvbGUubG9nKGBbb25GaW5hbmNpYWxVcHNlcnRdIFByb3BhZ2F0aW5nIHBvaW50cyBjaGFuZ2VzIHRvIHBsYXllcjogJHtmaW5hbmNpYWwubmFtZX1gKTtcclxuICAgICAgYXdhaXQgdXBkYXRlUGxheWVyUG9pbnRzRnJvbVNvdXJjZSgnZmluYW5jaWFsJywgZmluYW5jaWFsLCBwcmV2aW91c0ZpbmFuY2lhbCk7XHJcbiAgICB9XHJcbiAgICBcclxuICAgIC8vIFByb3BhZ2F0ZSB0byBDaGFyYWN0ZXIgKGp1bmdsZSBjb2lucyBkZWx0YSlcclxuICAgIGlmIChoYXNKdW5nbGVDb2luc0NoYW5nZWQoZmluYW5jaWFsLCBwcmV2aW91c0ZpbmFuY2lhbCkpIHtcclxuICAgICAgY29uc29sZS5sb2coYFtvbkZpbmFuY2lhbFVwc2VydF0gUHJvcGFnYXRpbmcganVuZ2xlIGNvaW5zIGNoYW5nZXMgdG8gY2hhcmFjdGVyOiAke2ZpbmFuY2lhbC5uYW1lfWApO1xyXG4gICAgICBhd2FpdCB1cGRhdGVDaGFyYWN0ZXJKdW5nbGVDb2luc0Zyb21SZWNvcmQoZmluYW5jaWFsLCBwcmV2aW91c0ZpbmFuY2lhbCk7XHJcbiAgICB9XHJcbiAgfVxyXG4gIFxyXG4gIC8vIERlc2NyaXB0aXZlIGNoYW5nZXMgLSB1cGRhdGUgaW4tcGxhY2VcclxuICBmb3IgKGNvbnN0IGZpZWxkIG9mIERFU0NSSVBUSVZFX0ZJRUxEUykge1xyXG4gICAgaWYgKChwcmV2aW91c0ZpbmFuY2lhbCBhcyBhbnkpW2ZpZWxkXSAhPT0gKGZpbmFuY2lhbCBhcyBhbnkpW2ZpZWxkXSkge1xyXG4gICAgICBhd2FpdCB1cGRhdGVFbnRpdHlMb2dGaWVsZCgnZmluYW5jaWFsJywgZmluYW5jaWFsLmlkLCBmaWVsZCwgKHByZXZpb3VzRmluYW5jaWFsIGFzIGFueSlbZmllbGRdLCAoZmluYW5jaWFsIGFzIGFueSlbZmllbGRdKTtcclxuICAgIH1cclxuICB9XHJcbn1cclxuXHJcbi8qKlxyXG4gKiBSZW1vdmUgZmluYW5jaWFsIHJlY29yZCBlZmZlY3RzIHdoZW4gcmVjb3JkIGlzIGRlbGV0ZWRcclxuICogRmluYW5jaWFsIHJlY29yZHMgY2FuIGhhdmUgZW50cmllcyBpbiBtdWx0aXBsZSBsb2dzOiBmaW5hbmNpYWxzLCBjaGFyYWN0ZXIsIHBsYXllciwgaXRlbXNcclxuICovXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiByZW1vdmVSZWNvcmRFZmZlY3RzT25EZWxldGUocmVjb3JkSWQ6IHN0cmluZyk6IFByb21pc2U8dm9pZD4ge1xyXG4gIHRyeSB7XHJcbiAgICBjb25zb2xlLmxvZyhgW3JlbW92ZVJlY29yZEVmZmVjdHNPbkRlbGV0ZV0gU3RhcnRpbmcgY2xlYW51cCBmb3IgcmVjb3JkOiAke3JlY29yZElkfWApO1xyXG4gICAgXHJcbiAgICAvLyAxLiBSZW1vdmUgaXRlbXMgY3JlYXRlZCBieSB0aGlzIHJlY29yZFxyXG4gICAgYXdhaXQgcmVtb3ZlSXRlbXNDcmVhdGVkQnlSZWNvcmQocmVjb3JkSWQpO1xyXG4gICAgXHJcbiAgICAvLyAyLiBSZW1vdmUgcGxheWVyIHBvaW50cyB0aGF0IHdlcmUgYXdhcmRlZCBieSB0aGlzIHJlY29yZCAoaWYgcG9pbnRzIHdlcmUgYmFkbHkgZ2l2ZW4pXHJcbiAgICBhd2FpdCByZW1vdmVQbGF5ZXJQb2ludHNGcm9tUmVjb3JkKHJlY29yZElkKTtcclxuICAgIFxyXG4gICAgLy8gMy4gUmVtb3ZlIGp1bmdsZSBjb2lucyB0aGF0IHdlcmUgYXdhcmRlZCBieSB0aGlzIHJlY29yZFxyXG4gICAgYXdhaXQgcmVtb3ZlSnVuZ2xlQ29pbnNGcm9tUmVjb3JkKHJlY29yZElkKTtcclxuICAgIFxyXG4gICAgLy8gNC4gUmVtb3ZlIGFsbCBMaW5rcyByZWxhdGVkIHRvIHRoaXMgcmVjb3JkXHJcbiAgICBjb25zdCByZWNvcmRMaW5rcyA9IGF3YWl0IENsaWVudEFQSS5nZXRMaW5rc0Zvcih7IHR5cGU6ICdmaW5hbmNpYWwnLCBpZDogcmVjb3JkSWQgfSk7XHJcbiAgICBjb25zb2xlLmxvZyhgW3JlbW92ZVJlY29yZEVmZmVjdHNPbkRlbGV0ZV0gRm91bmQgJHtyZWNvcmRMaW5rcy5sZW5ndGh9IGxpbmtzIHRvIHJlbW92ZWApO1xyXG4gICAgXHJcbiAgICBmb3IgKGNvbnN0IGxpbmsgb2YgcmVjb3JkTGlua3MpIHtcclxuICAgICAgdHJ5IHtcclxuICAgICAgICBhd2FpdCBDbGllbnRBUEkucmVtb3ZlTGluayhsaW5rLmlkKTtcclxuICAgICAgICBjb25zb2xlLmxvZyhgW3JlbW92ZVJlY29yZEVmZmVjdHNPbkRlbGV0ZV0g4pyFIFJlbW92ZWQgbGluazogJHtsaW5rLmxpbmtUeXBlfWApO1xyXG4gICAgICB9IGNhdGNoIChlcnJvcikge1xyXG4gICAgICAgIGNvbnNvbGUuZXJyb3IoYFtyZW1vdmVSZWNvcmRFZmZlY3RzT25EZWxldGVdIOKdjCBGYWlsZWQgdG8gcmVtb3ZlIGxpbmsgJHtsaW5rLmlkfTpgLCBlcnJvcik7XHJcbiAgICAgIH1cclxuICAgIH1cclxuICAgIFxyXG4gICAgLy8gNS4gQ2xlYXIgZWZmZWN0cyByZWdpc3RyeVxyXG4gICAgYXdhaXQgY2xlYXJFZmZlY3QoYGZpbmFuY2lhbDoke3JlY29yZElkfTpjcmVhdGVkYCk7XHJcbiAgICBhd2FpdCBjbGVhckVmZmVjdChgZmluYW5jaWFsOiR7cmVjb3JkSWR9Oml0ZW1DcmVhdGVkYCk7XHJcbiAgICBhd2FpdCBjbGVhckVmZmVjdChgZmluYW5jaWFsOiR7cmVjb3JkSWR9OnBvaW50c0F3YXJkZWRgKTtcclxuICAgIGF3YWl0IGNsZWFyRWZmZWN0KGBmaW5hbmNpYWw6JHtyZWNvcmRJZH06anVuZ2xlQ29pbnNBd2FyZGVkYCk7XHJcbiAgICBhd2FpdCBjbGVhckVmZmVjdHNCeVByZWZpeCgnZmluYW5jaWFsJywgcmVjb3JkSWQsICdwb2ludHNMb2dnZWQ6Jyk7XHJcbiAgICBhd2FpdCBjbGVhckVmZmVjdHNCeVByZWZpeCgnZmluYW5jaWFsJywgcmVjb3JkSWQsICdmaW5hbmNpYWxMb2dnZWQ6Jyk7XHJcbiAgICBcclxuICAgIC8vIDYuIFJlbW92ZSBsb2cgZW50cmllcyBmcm9tIGFsbCByZWxldmFudCBsb2dzXHJcbiAgICBjb25zb2xlLmxvZyhgW3JlbW92ZVJlY29yZEVmZmVjdHNPbkRlbGV0ZV0gU3RhcnRpbmcgbG9nIGVudHJ5IHJlbW92YWwgZm9yIHJlY29yZDogJHtyZWNvcmRJZH1gKTtcclxuICAgIFxyXG4gICAgY29uc3QgcmVtb3ZhbHMgPSBhd2FpdCBQcm9taXNlLmFsbChbXHJcbiAgICAgIENsaWVudEFQSS5yZW1vdmVMb2dFbnRyeSgnZmluYW5jaWFscycsIHJlY29yZElkKS50aGVuKHIgPT4geyBjb25zb2xlLmxvZyhgW3JlbW92ZVJlY29yZEVmZmVjdHNPbkRlbGV0ZV0gRmluYW5jaWFscyBsb2cgcmVtb3ZhbCByZXN1bHQ6YCwgcik7IHJldHVybiByOyB9KS5jYXRjaChlID0+ICh7IHN1Y2Nlc3M6IGZhbHNlLCBtZXNzYWdlOiBTdHJpbmcoZSkgfSkpLFxyXG4gICAgICBDbGllbnRBUEkucmVtb3ZlTG9nRW50cnkoJ2NoYXJhY3RlcicsIHJlY29yZElkKS50aGVuKHIgPT4geyBjb25zb2xlLmxvZyhgW3JlbW92ZVJlY29yZEVmZmVjdHNPbkRlbGV0ZV0gQ2hhcmFjdGVyIGxvZyByZW1vdmFsIHJlc3VsdDpgLCByKTsgcmV0dXJuIHI7IH0pLmNhdGNoKGUgPT4gKHsgc3VjY2VzczogZmFsc2UsIG1lc3NhZ2U6IFN0cmluZyhlKSB9KSksXHJcbiAgICAgIENsaWVudEFQSS5yZW1vdmVMb2dFbnRyeSgncGxheWVyJywgcmVjb3JkSWQpLnRoZW4ociA9PiB7IGNvbnNvbGUubG9nKGBbcmVtb3ZlUmVjb3JkRWZmZWN0c09uRGVsZXRlXSBQbGF5ZXIgbG9nIHJlbW92YWwgcmVzdWx0OmAsIHIpOyByZXR1cm4gcjsgfSkuY2F0Y2goZSA9PiAoeyBzdWNjZXNzOiBmYWxzZSwgbWVzc2FnZTogU3RyaW5nKGUpIH0pKSxcclxuICAgICAgQ2xpZW50QVBJLnJlbW92ZUxvZ0VudHJ5KCdpdGVtcycsIHJlY29yZElkKS50aGVuKHIgPT4geyBjb25zb2xlLmxvZyhgW3JlbW92ZVJlY29yZEVmZmVjdHNPbkRlbGV0ZV0gSXRlbXMgbG9nIHJlbW92YWwgcmVzdWx0OmAsIHIpOyByZXR1cm4gcjsgfSkuY2F0Y2goZSA9PiAoeyBzdWNjZXNzOiBmYWxzZSwgbWVzc2FnZTogU3RyaW5nKGUpIH0pKSxcclxuICAgIF0pO1xyXG5cclxuICAgIGNvbnNvbGUubG9nKGBbcmVtb3ZlUmVjb3JkRWZmZWN0c09uRGVsZXRlXSBBbGwgcmVtb3ZhbCByZXN1bHRzOmAsIHJlbW92YWxzKTtcclxuICAgIGNvbnN0IGZhaWxlZCA9IHJlbW92YWxzLmZpbHRlcihyID0+ICFyLnN1Y2Nlc3MpO1xyXG4gICAgaWYgKGZhaWxlZC5sZW5ndGggPiAwKSB7XHJcbiAgICAgIGNvbnNvbGUuZXJyb3IoJ1tyZW1vdmVSZWNvcmRFZmZlY3RzT25EZWxldGVdIFNvbWUgbG9nIHJlbW92YWxzIGZhaWxlZDonLCBmYWlsZWQpO1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgY29uc29sZS5sb2coYFtyZW1vdmVSZWNvcmRFZmZlY3RzT25EZWxldGVdIOKchSBBbGwgbG9nIGVudHJpZXMgcmVtb3ZlZCBzdWNjZXNzZnVsbHkgZm9yIHJlY29yZDogJHtyZWNvcmRJZH1gKTtcclxuICAgIH1cclxuICAgIFxyXG4gICAgY29uc29sZS5sb2coYFtyZW1vdmVSZWNvcmRFZmZlY3RzT25EZWxldGVdIOKchSBDbGVhcmVkIGVmZmVjdHMsIHJlbW92ZWQgbGlua3MsIGRlbGV0ZWQgY3JlYXRlZCBpdGVtcywgYW5kIHJlbW92ZWQgbG9nIGVudHJpZXMgZm9yIHJlY29yZCAke3JlY29yZElkfWApO1xyXG4gIH0gY2F0Y2ggKGVycm9yKSB7XHJcbiAgICBjb25zb2xlLmVycm9yKCdFcnJvciByZW1vdmluZyByZWNvcmQgZWZmZWN0czonLCBlcnJvcik7XHJcbiAgfVxyXG59XHJcblxyXG4vKipcclxuICogUmVtb3ZlIHBsYXllciBwb2ludHMgdGhhdCB3ZXJlIGF3YXJkZWQgYnkgYSBzcGVjaWZpYyBmaW5hbmNpYWwgcmVjb3JkXHJcbiAqIFRoaXMgaXMgdXNlZCB3aGVuIHJvbGxpbmcgYmFjayBhIHJlY29yZCB0aGF0IGluY29ycmVjdGx5IGF3YXJkZWQgcG9pbnRzXHJcbiAqL1xyXG5hc3luYyBmdW5jdGlvbiByZW1vdmVQbGF5ZXJQb2ludHNGcm9tUmVjb3JkKHJlY29yZElkOiBzdHJpbmcpOiBQcm9taXNlPHZvaWQ+IHtcclxuICB0cnkge1xyXG4gICAgY29uc29sZS5sb2coYFtyZW1vdmVQbGF5ZXJQb2ludHNGcm9tUmVjb3JkXSBSZW1vdmluZyBwb2ludHMgZm9yIHJlY29yZDogJHtyZWNvcmRJZH1gKTtcclxuICAgIFxyXG4gICAgLy8gR2V0IHRoZSByZWNvcmQgdG8gZmluZCB3aGF0IHBvaW50cyB3ZXJlIGF3YXJkZWRcclxuICAgIGNvbnN0IHJlY29yZHMgPSBhd2FpdCBDbGllbnRBUEkuZ2V0RmluYW5jaWFsUmVjb3JkcygpO1xyXG4gICAgY29uc3QgcmVjb3JkID0gcmVjb3Jkcy5maW5kKHIgPT4gci5pZCA9PT0gcmVjb3JkSWQpO1xyXG4gICAgXHJcbiAgICBpZiAoIXJlY29yZCB8fCAhcmVjb3JkLnJld2FyZHM/LnBvaW50cykge1xyXG4gICAgICBjb25zb2xlLmxvZyhgW3JlbW92ZVBsYXllclBvaW50c0Zyb21SZWNvcmRdIFJlY29yZCAke3JlY29yZElkfSBoYXMgbm8gcG9pbnRzIHRvIHJlbW92ZWApO1xyXG4gICAgICByZXR1cm47XHJcbiAgICB9XHJcbiAgICBcclxuICAgIC8vIEdldCB0aGUgbWFpbiBwbGF5ZXJcclxuICAgIGNvbnN0IG1haW5QbGF5ZXJJZCA9IGdldE1haW5QbGF5ZXJJZCgpO1xyXG4gICAgY29uc3QgcGxheWVycyA9IGF3YWl0IENsaWVudEFQSS5nZXRQbGF5ZXJzKCk7XHJcbiAgICBjb25zdCBtYWluUGxheWVyID0gcGxheWVycy5maW5kKHAgPT4gcC5pZCA9PT0gbWFpblBsYXllcklkKTtcclxuICAgIFxyXG4gICAgaWYgKCFtYWluUGxheWVyKSB7XHJcbiAgICAgIGNvbnNvbGUubG9nKGBbcmVtb3ZlUGxheWVyUG9pbnRzRnJvbVJlY29yZF0gTWFpbiBwbGF5ZXIgbm90IGZvdW5kLCBza2lwcGluZyBwb2ludHMgcmVtb3ZhbGApO1xyXG4gICAgICByZXR1cm47XHJcbiAgICB9XHJcbiAgICBcclxuICAgIC8vIENoZWNrIGlmIGFueSBwb2ludHMgd2VyZSBhY3R1YWxseSBhd2FyZGVkXHJcbiAgICBjb25zdCBwb2ludHNUb1JlbW92ZSA9IHJlY29yZC5yZXdhcmRzLnBvaW50cztcclxuICAgIGNvbnN0IGhhc1BvaW50cyA9IChwb2ludHNUb1JlbW92ZS54cCB8fCAwKSA+IDAgfHwgKHBvaW50c1RvUmVtb3ZlLnJwIHx8IDApID4gMCB8fCBcclxuICAgICAgICAgICAgICAgICAgICAgKHBvaW50c1RvUmVtb3ZlLmZwIHx8IDApID4gMCB8fCAocG9pbnRzVG9SZW1vdmUuaHAgfHwgMCkgPiAwO1xyXG4gICAgXHJcbiAgICBpZiAoIWhhc1BvaW50cykge1xyXG4gICAgICBjb25zb2xlLmxvZyhgW3JlbW92ZVBsYXllclBvaW50c0Zyb21SZWNvcmRdIE5vIHBvaW50cyB0byByZW1vdmUgZnJvbSByZWNvcmQgJHtyZWNvcmRJZH1gKTtcclxuICAgICAgcmV0dXJuO1xyXG4gICAgfVxyXG4gICAgXHJcbiAgICAvLyBSZW1vdmUgdGhlIHBvaW50cyBmcm9tIHRoZSBwbGF5ZXJcclxuICAgIGF3YWl0IHJlbW92ZVBvaW50c0Zyb21QbGF5ZXIobWFpblBsYXllcklkLCB7XHJcbiAgICAgIHhwOiBwb2ludHNUb1JlbW92ZS54cCB8fCAwLFxyXG4gICAgICBycDogcG9pbnRzVG9SZW1vdmUucnAgfHwgMCxcclxuICAgICAgZnA6IHBvaW50c1RvUmVtb3ZlLmZwIHx8IDAsXHJcbiAgICAgIGhwOiBwb2ludHNUb1JlbW92ZS5ocCB8fCAwXHJcbiAgICB9KTtcclxuICAgIGNvbnNvbGUubG9nKGBbcmVtb3ZlUGxheWVyUG9pbnRzRnJvbVJlY29yZF0g4pyFIFJlbW92ZWQgcG9pbnRzIGZyb20gcGxheWVyOiAke0pTT04uc3RyaW5naWZ5KHBvaW50c1RvUmVtb3ZlKX1gKTtcclxuICAgIFxyXG4gIH0gY2F0Y2ggKGVycm9yKSB7XHJcbiAgICBjb25zb2xlLmVycm9yKGBbcmVtb3ZlUGxheWVyUG9pbnRzRnJvbVJlY29yZF0g4p2MIEZhaWxlZCB0byByZW1vdmUgcGxheWVyIHBvaW50cyBmb3IgcmVjb3JkICR7cmVjb3JkSWR9OmAsIGVycm9yKTtcclxuICB9XHJcbn1cclxuXHJcbi8qKlxyXG4gKiBSZW1vdmUganVuZ2xlIGNvaW5zIHRoYXQgd2VyZSBhd2FyZGVkIGJ5IGEgc3BlY2lmaWMgZmluYW5jaWFsIHJlY29yZFxyXG4gKiBUaGlzIGlzIHVzZWQgd2hlbiByb2xsaW5nIGJhY2sgYSByZWNvcmQgdGhhdCBpbmNvcnJlY3RseSBhd2FyZGVkIGp1bmdsZSBjb2luc1xyXG4gKi9cclxuYXN5bmMgZnVuY3Rpb24gcmVtb3ZlSnVuZ2xlQ29pbnNGcm9tUmVjb3JkKHJlY29yZElkOiBzdHJpbmcpOiBQcm9taXNlPHZvaWQ+IHtcclxuICB0cnkge1xyXG4gICAgY29uc29sZS5sb2coYFtyZW1vdmVKdW5nbGVDb2luc0Zyb21SZWNvcmRdIFJlbW92aW5nIGp1bmdsZSBjb2lucyBmb3IgcmVjb3JkOiAke3JlY29yZElkfWApO1xyXG4gICAgXHJcbiAgICAvLyBHZXQgdGhlIHJlY29yZCB0byBmaW5kIHdoYXQganVuZ2xlIGNvaW5zIHdlcmUgYXdhcmRlZFxyXG4gICAgY29uc3QgcmVjb3JkcyA9IGF3YWl0IENsaWVudEFQSS5nZXRGaW5hbmNpYWxSZWNvcmRzKCk7XHJcbiAgICBjb25zdCByZWNvcmQgPSByZWNvcmRzLmZpbmQociA9PiByLmlkID09PSByZWNvcmRJZCk7XHJcbiAgICBcclxuICAgIGlmICghcmVjb3JkIHx8ICFyZWNvcmQuanVuZ2xlQ29pbnMgfHwgcmVjb3JkLmp1bmdsZUNvaW5zIDw9IDApIHtcclxuICAgICAgY29uc29sZS5sb2coYFtyZW1vdmVKdW5nbGVDb2luc0Zyb21SZWNvcmRdIFJlY29yZCAke3JlY29yZElkfSBoYXMgbm8ganVuZ2xlIGNvaW5zIHRvIHJlbW92ZWApO1xyXG4gICAgICByZXR1cm47XHJcbiAgICB9XHJcbiAgICBcclxuICAgIC8vIEdldCB0aGUgbWFpbiBjaGFyYWN0ZXJcclxuICAgIGNvbnN0IG1haW5DaGFyYWN0ZXJJZCA9IGdldE1haW5DaGFyYWN0ZXJJZCgpO1xyXG4gICAgY29uc3QgY2hhcmFjdGVycyA9IGF3YWl0IENsaWVudEFQSS5nZXRDaGFyYWN0ZXJzKCk7XHJcbiAgICBjb25zdCBtYWluQ2hhcmFjdGVyID0gY2hhcmFjdGVycy5maW5kKGMgPT4gYy5pZCA9PT0gbWFpbkNoYXJhY3RlcklkKTtcclxuICAgIFxyXG4gICAgaWYgKCFtYWluQ2hhcmFjdGVyKSB7XHJcbiAgICAgIGNvbnNvbGUubG9nKGBbcmVtb3ZlSnVuZ2xlQ29pbnNGcm9tUmVjb3JkXSBNYWluIGNoYXJhY3RlciBub3QgZm91bmQsIHNraXBwaW5nIGp1bmdsZSBjb2lucyByZW1vdmFsYCk7XHJcbiAgICAgIHJldHVybjtcclxuICAgIH1cclxuICAgIFxyXG4gICAgLy8gUmVtb3ZlIHRoZSBqdW5nbGUgY29pbnMgZnJvbSB0aGUgY2hhcmFjdGVyXHJcbiAgICBhd2FpdCByZW1vdmVKdW5nbGVDb2luc0Zyb21DaGFyYWN0ZXIobWFpbkNoYXJhY3RlcklkLCByZWNvcmQuanVuZ2xlQ29pbnMpO1xyXG4gICAgY29uc29sZS5sb2coYFtyZW1vdmVKdW5nbGVDb2luc0Zyb21SZWNvcmRdIOKchSBSZW1vdmVkICR7cmVjb3JkLmp1bmdsZUNvaW5zfSBqdW5nbGUgY29pbnMgZnJvbSBjaGFyYWN0ZXJgKTtcclxuICAgIFxyXG4gIH0gY2F0Y2ggKGVycm9yKSB7XHJcbiAgICBjb25zb2xlLmVycm9yKGBbcmVtb3ZlSnVuZ2xlQ29pbnNGcm9tUmVjb3JkXSDinYwgRmFpbGVkIHRvIHJlbW92ZSBqdW5nbGUgY29pbnMgZm9yIHJlY29yZCAke3JlY29yZElkfTpgLCBlcnJvcik7XHJcbiAgfVxyXG59Il0sIm5hbWVzIjpbImFwcGVuZEVudGl0eUxvZyIsInVwZGF0ZUVudGl0eUxvZ0ZpZWxkIiwiaGFzRWZmZWN0IiwibWFya0VmZmVjdCIsImNsZWFyRWZmZWN0IiwiY2xlYXJFZmZlY3RzQnlQcmVmaXgiLCJDbGllbnRBUEkiLCJjcmVhdGVJdGVtRnJvbVJlY29yZCIsInJlbW92ZUl0ZW1zQ3JlYXRlZEJ5UmVjb3JkIiwiYXdhcmRQb2ludHNUb1BsYXllciIsInJlbW92ZVBvaW50c0Zyb21QbGF5ZXIiLCJhd2FyZEp1bmdsZUNvaW5zVG9DaGFyYWN0ZXIiLCJyZW1vdmVKdW5nbGVDb2luc0Zyb21DaGFyYWN0ZXIiLCJnZXRNYWluUGxheWVySWQiLCJnZXRNYWluQ2hhcmFjdGVySWQiLCJ1cGRhdGVUYXNrc0Zyb21GaW5hbmNpYWxSZWNvcmQiLCJ1cGRhdGVJdGVtc0NyZWF0ZWRCeVJlY29yZCIsInVwZGF0ZVBsYXllclBvaW50c0Zyb21Tb3VyY2UiLCJ1cGRhdGVDaGFyYWN0ZXJKdW5nbGVDb2luc0Zyb21SZWNvcmQiLCJoYXNGaW5hbmNpYWxQcm9wc0NoYW5nZWQiLCJoYXNPdXRwdXRQcm9wc0NoYW5nZWQiLCJoYXNSZXdhcmRzQ2hhbmdlZCIsImhhc0p1bmdsZUNvaW5zQ2hhbmdlZCIsIlNUQVRFX0ZJRUxEUyIsIkRFU0NSSVBUSVZFX0ZJRUxEUyIsIm9uRmluYW5jaWFsVXBzZXJ0IiwiZmluYW5jaWFsIiwicHJldmlvdXNGaW5hbmNpYWwiLCJlZmZlY3RLZXkiLCJpZCIsIm5hbWUiLCJ0eXBlIiwic3RhdGlvbiIsIm91dHB1dEl0ZW1UeXBlIiwib3V0cHV0UXVhbnRpdHkiLCJpdGVtRWZmZWN0S2V5IiwiY29uc29sZSIsImxvZyIsImNyZWF0ZWRJdGVtIiwicmV3YXJkcyIsInBvaW50cyIsInBvaW50c0VmZmVjdEtleSIsInhwIiwicnAiLCJmcCIsImhwIiwianVuZ2xlQ29pbnMiLCJqdW5nbGVDb2luc0VmZmVjdEtleSIsImlzTm90Q2hhcmdlZCIsInJldmVudWUiLCJjaGFyZ2VkQXQiLCJEYXRlIiwidG9JU09TdHJpbmciLCJpc0NvbGxlY3RlZCIsImNvbGxlY3RlZEF0IiwiZmllbGQiLCJyZW1vdmVSZWNvcmRFZmZlY3RzT25EZWxldGUiLCJyZWNvcmRJZCIsInJlbW92ZVBsYXllclBvaW50c0Zyb21SZWNvcmQiLCJyZW1vdmVKdW5nbGVDb2luc0Zyb21SZWNvcmQiLCJyZWNvcmRMaW5rcyIsImdldExpbmtzRm9yIiwibGVuZ3RoIiwibGluayIsInJlbW92ZUxpbmsiLCJsaW5rVHlwZSIsImVycm9yIiwicmVtb3ZhbHMiLCJQcm9taXNlIiwiYWxsIiwicmVtb3ZlTG9nRW50cnkiLCJ0aGVuIiwiciIsImNhdGNoIiwiZSIsInN1Y2Nlc3MiLCJtZXNzYWdlIiwiU3RyaW5nIiwiZmFpbGVkIiwiZmlsdGVyIiwicmVjb3JkIiwicmVjb3JkcyIsImdldEZpbmFuY2lhbFJlY29yZHMiLCJmaW5kIiwibWFpblBsYXllcklkIiwicGxheWVycyIsImdldFBsYXllcnMiLCJtYWluUGxheWVyIiwicCIsInBvaW50c1RvUmVtb3ZlIiwiaGFzUG9pbnRzIiwiSlNPTiIsInN0cmluZ2lmeSIsIm1haW5DaGFyYWN0ZXJJZCIsImNoYXJhY3RlcnMiLCJnZXRDaGFyYWN0ZXJzIiwibWFpbkNoYXJhY3RlciIsImMiXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(app-pages-browser)/./workflows/entities-workflows/financial.workflow.ts\n"));

/***/ }),

/***/ "(app-pages-browser)/./workflows/entities-workflows/item.workflow.ts":
/*!*******************************************************!*\
  !*** ./workflows/entities-workflows/item.workflow.ts ***!
  \*******************************************************/
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval(__webpack_require__.ts("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   logItemCreationForItem: function() { return /* binding */ logItemCreationForItem; },\n/* harmony export */   onItemUpsert: function() { return /* binding */ onItemUpsert; },\n/* harmony export */   processItemCreationEffects: function() { return /* binding */ processItemCreationEffects; },\n/* harmony export */   removeItemEffectsOnDelete: function() { return /* binding */ removeItemEffectsOnDelete; },\n/* harmony export */   updateAllItemLogEntries: function() { return /* binding */ updateAllItemLogEntries; },\n/* harmony export */   updateItemLogEntryForItem: function() { return /* binding */ updateItemLogEntryForItem; }\n/* harmony export */ });\n/* harmony import */ var _entities_logging__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../entities-logging */ \"(app-pages-browser)/./workflows/entities-logging.ts\");\n/* harmony import */ var _data_store_effects_registry__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @/data-store/effects-registry */ \"(app-pages-browser)/./data-store/effects-registry.ts\");\n/* harmony import */ var _lib_client_api__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @/lib/client-api */ \"(app-pages-browser)/./lib/client-api.ts\");\n// workflows/entities-workflows/item.workflow.ts\n// Item-specific workflow with MOVED, SOLD, COLLECTED events\n\n\n\nconst STATE_FIELDS = [\n    \"status\",\n    \"stock\",\n    \"quantitySold\",\n    \"isCollected\"\n];\nconst DESCRIPTIVE_FIELDS = [\n    \"name\",\n    \"description\",\n    \"price\",\n    \"unitCost\",\n    \"additionalCost\",\n    \"value\"\n];\nasync function onItemUpsert(item, previousItem) {\n    // New item creation\n    if (!previousItem) {\n        const effectKey = \"item:\".concat(item.id, \":created\");\n        if (await (0,_data_store_effects_registry__WEBPACK_IMPORTED_MODULE_1__.hasEffect)(effectKey)) return;\n        await (0,_entities_logging__WEBPACK_IMPORTED_MODULE_0__.appendEntityLog)(\"item\", item.id, \"CREATED\", {\n            name: item.name,\n            type: item.type,\n            station: item.station\n        });\n        // Log item creation with source tracking\n        const sourceType = item.sourceTaskId ? \"task\" : item.sourceRecordId ? \"record\" : \"direct\";\n        const sourceId = item.sourceTaskId || item.sourceRecordId || undefined;\n        await (0,_entities_logging__WEBPACK_IMPORTED_MODULE_0__.appendItemCreationLog)(item, sourceType, sourceId);\n        await (0,_data_store_effects_registry__WEBPACK_IMPORTED_MODULE_1__.markEffect)(effectKey);\n        return;\n    }\n    // Stock changes - MOVED event\n    const stockChanged = JSON.stringify(previousItem.stock) !== JSON.stringify(item.stock);\n    if (stockChanged) {\n        await (0,_entities_logging__WEBPACK_IMPORTED_MODULE_0__.appendEntityLog)(\"item\", item.id, \"MOVED\", {\n            name: item.name,\n            oldStock: previousItem.stock,\n            newStock: item.stock\n        });\n    }\n    // Quantity sold changes - SOLD event\n    if (previousItem.quantitySold !== item.quantitySold && item.quantitySold > previousItem.quantitySold) {\n        await (0,_entities_logging__WEBPACK_IMPORTED_MODULE_0__.appendEntityLog)(\"item\", item.id, \"SOLD\", {\n            name: item.name,\n            quantitySold: item.quantitySold,\n            oldQuantitySold: previousItem.quantitySold\n        });\n    }\n    // Collection status - COLLECTED event\n    if (!previousItem.isCollected && item.isCollected) {\n        await (0,_entities_logging__WEBPACK_IMPORTED_MODULE_0__.appendEntityLog)(\"item\", item.id, \"COLLECTED\", {\n            name: item.name,\n            collectedAt: new Date().toISOString()\n        });\n    }\n    // Descriptive changes - update in-place\n    for (const field of DESCRIPTIVE_FIELDS){\n        if (previousItem[field] !== item[field]) {\n            await (0,_entities_logging__WEBPACK_IMPORTED_MODULE_0__.updateEntityLogField)(\"item\", item.id, field, previousItem[field], item[field]);\n        }\n    }\n}\n/**\r\n * Remove item effects when item is deleted\r\n * Items can have entries in items log and related links\r\n */ async function removeItemEffectsOnDelete(itemId) {\n    try {\n        console.log(\"[removeItemEffectsOnDelete] Starting cleanup for item: \".concat(itemId));\n        // 1. Remove all Links related to this item\n        const itemLinks = await _lib_client_api__WEBPACK_IMPORTED_MODULE_2__.ClientAPI.getLinksFor({\n            type: \"item\",\n            id: itemId\n        });\n        console.log(\"[removeItemEffectsOnDelete] Found \".concat(itemLinks.length, \" links to remove\"));\n        for (const link of itemLinks){\n            try {\n                await _lib_client_api__WEBPACK_IMPORTED_MODULE_2__.ClientAPI.removeLink(link.id);\n                console.log(\"[removeItemEffectsOnDelete]  Removed link: \".concat(link.linkType));\n            } catch (error) {\n                console.error(\"[removeItemEffectsOnDelete]  Failed to remove link \".concat(link.id, \":\"), error);\n            }\n        }\n        // 2. Clear all effects for this item\n        await (0,_data_store_effects_registry__WEBPACK_IMPORTED_MODULE_1__.clearEffect)(\"item:\".concat(itemId, \":created\"));\n        await (0,_data_store_effects_registry__WEBPACK_IMPORTED_MODULE_1__.clearEffectsByPrefix)(\"item\", itemId, \"financialLogged:\");\n        await (0,_data_store_effects_registry__WEBPACK_IMPORTED_MODULE_1__.clearEffectsByPrefix)(\"item\", itemId, \"pointsLogged:\");\n        // 3. Remove log entries from items log only (Items don't have financial/player effects)\n        console.log(\"[removeItemEffectsOnDelete] Starting log entry removal for item: \".concat(itemId));\n        const result = await _lib_client_api__WEBPACK_IMPORTED_MODULE_2__.ClientAPI.removeLogEntry(\"items\", itemId);\n        if (result.success) {\n            console.log(\"[removeItemEffectsOnDelete]  Item log entries removed successfully for item: \".concat(itemId));\n        } else {\n            console.error(\"[removeItemEffectsOnDelete] Failed to remove item log entries: \".concat(result.message));\n        }\n        console.log(\"[removeItemEffectsOnDelete]  Cleared effects, removed links, and removed log entries for item \".concat(itemId));\n    } catch (error) {\n        console.error(\"Error removing item effects:\", error);\n    }\n}\n/**\r\n * Process item creation effects when item is created\r\n * Handles side effects when item is created directly (not from task/record)\r\n */ async function processItemCreationEffects(item) {\n    console.log(\"[processItemCreationEffects] Processing item creation effects for: \".concat(item.name, \" (\").concat(item.id, \")\"));\n    // Log item creation once (with idempotency)\n    const itemCreated = await (0,_data_store_effects_registry__WEBPACK_IMPORTED_MODULE_1__.hasEffect)(\"item:\".concat(item.id, \":itemCreated\"));\n    if (!itemCreated) {\n        await logItemCreationForItem(item);\n        await (0,_data_store_effects_registry__WEBPACK_IMPORTED_MODULE_1__.markEffect)(\"item:\".concat(item.id, \":itemCreated\"));\n    }\n// Items created from Item Modal have NO financial effects\n// Items are just inventory/assets - financial effects come from Tasks/Records\n// This is different from Tasks/Records which have cost/revenue properties\n}\n/**\r\n * Log item creation when item is created directly (not from task/record)\r\n */ async function logItemCreationForItem(item) {\n    try {\n        console.log(\"[logItemCreationForItem] Logging direct item creation: \".concat(item.name, \" (\").concat(item.id, \")\"));\n        await (0,_entities_logging__WEBPACK_IMPORTED_MODULE_0__.appendItemCreationLog)(item, \"direct\");\n        console.log(\"[logItemCreationForItem]  Direct item creation logged successfully for \".concat(item.name));\n    } catch (error) {\n        console.error(\"Error logging direct item creation:\", error);\n    }\n}\n/**\r\n * Update item log entry when item properties change\r\n * This function updates existing item log entries with new item data\r\n */ async function updateItemLogEntryForItem(item) {\n    let dispatchEvents = arguments.length > 1 && arguments[1] !== void 0 ? arguments[1] : true;\n    try {\n        var _item_stock, _item_stock1, _item_stock2;\n        const updates = {\n            itemName: item.name,\n            itemType: item.type,\n            collection: item.collection,\n            status: item.status,\n            quantity: ((_item_stock = item.stock) === null || _item_stock === void 0 ? void 0 : _item_stock.reduce((sum, stock)=>sum + stock.quantity, 0)) || 0,\n            unitCost: item.unitCost || 0,\n            price: item.price || 0,\n            station: item.station,\n            year: item.year,\n            description: \"Item created directly: \".concat(item.type, \" (\").concat(((_item_stock1 = item.stock) === null || _item_stock1 === void 0 ? void 0 : _item_stock1.reduce((sum, stock)=>sum + stock.quantity, 0)) || 0, \"x)\")\n        };\n        // Update the most recent log entry for this item\n        await (0,_entities_logging__WEBPACK_IMPORTED_MODULE_0__.updateEntityLogField)(\"item\", item.id, \"itemName\", \"\", item.name);\n        await (0,_entities_logging__WEBPACK_IMPORTED_MODULE_0__.updateEntityLogField)(\"item\", item.id, \"itemType\", \"\", item.type);\n        await (0,_entities_logging__WEBPACK_IMPORTED_MODULE_0__.updateEntityLogField)(\"item\", item.id, \"status\", \"\", item.status);\n        await (0,_entities_logging__WEBPACK_IMPORTED_MODULE_0__.updateEntityLogField)(\"item\", item.id, \"quantity\", \"\", ((_item_stock2 = item.stock) === null || _item_stock2 === void 0 ? void 0 : _item_stock2.reduce((sum, stock)=>sum + stock.quantity, 0)) || 0);\n        await (0,_entities_logging__WEBPACK_IMPORTED_MODULE_0__.updateEntityLogField)(\"item\", item.id, \"unitCost\", \"\", item.unitCost || 0);\n        await (0,_entities_logging__WEBPACK_IMPORTED_MODULE_0__.updateEntityLogField)(\"item\", item.id, \"price\", \"\", item.price || 0);\n        console.log(\"[updateItemLogEntryForItem]  Item log entry updated successfully for \".concat(item.name));\n        // Dispatch event to notify frontend of items update\n        if (dispatchEvents && \"object\" !== \"undefined\") {\n            window.dispatchEvent(new CustomEvent(\"itemsUpdated\"));\n        }\n    } catch (error) {\n        console.error(\"Error updating item log entry:\", error);\n    }\n}\n/**\r\n * Update all log entries when item properties change\r\n * This function updates existing log entries across all log types with new item data\r\n */ async function updateAllItemLogEntries(item) {\n    let dispatchEvents = arguments.length > 1 && arguments[1] !== void 0 ? arguments[1] : true;\n    try {\n        console.log(\"[updateAllItemLogEntries] Updating all log entries for item: \".concat(item.name, \" (\").concat(item.id, \")\"));\n        // Update item log entries\n        await updateItemLogEntryForItem(item, false);\n        // Dispatch event to notify frontend of items update\n        if (dispatchEvents && \"object\" !== \"undefined\") {\n            window.dispatchEvent(new CustomEvent(\"itemsUpdated\"));\n        }\n        console.log(\"[updateAllItemLogEntries]  All log entries updated successfully for \".concat(item.name));\n    } catch (error) {\n        console.error(\"Error updating all item log entries:\", error);\n    }\n}\n\n\n;\n    // Wrapped in an IIFE to avoid polluting the global scope\n    ;\n    (function () {\n        var _a, _b;\n        // Legacy CSS implementations will `eval` browser code in a Node.js context\n        // to extract CSS. For backwards compatibility, we need to check we're in a\n        // browser context before continuing.\n        if (typeof self !== 'undefined' &&\n            // AMP / No-JS mode does not inject these helpers:\n            '$RefreshHelpers$' in self) {\n            // @ts-ignore __webpack_module__ is global\n            var currentExports = module.exports;\n            // @ts-ignore __webpack_module__ is global\n            var prevSignature = (_b = (_a = module.hot.data) === null || _a === void 0 ? void 0 : _a.prevSignature) !== null && _b !== void 0 ? _b : null;\n            // This cannot happen in MainTemplate because the exports mismatch between\n            // templating and execution.\n            self.$RefreshHelpers$.registerExportsForReactRefresh(currentExports, module.id);\n            // A module can be accepted automatically based on its exports, e.g. when\n            // it is a Refresh Boundary.\n            if (self.$RefreshHelpers$.isReactRefreshBoundary(currentExports)) {\n                // Save the previous exports signature on update so we can compare the boundary\n                // signatures. We avoid saving exports themselves since it causes memory leaks (https://github.com/vercel/next.js/pull/53797)\n                module.hot.dispose(function (data) {\n                    data.prevSignature =\n                        self.$RefreshHelpers$.getRefreshBoundarySignature(currentExports);\n                });\n                // Unconditionally accept an update to this module, we'll check if it's\n                // still a Refresh Boundary later.\n                // @ts-ignore importMeta is replaced in the loader\n                module.hot.accept();\n                // This field is set when the previous version of this module was a\n                // Refresh Boundary, letting us know we need to check for invalidation or\n                // enqueue an update.\n                if (prevSignature !== null) {\n                    // A boundary can become ineligible if its exports are incompatible\n                    // with the previous exports.\n                    //\n                    // For example, if you add/remove/change exports, we'll want to\n                    // re-execute the importing modules, and force those components to\n                    // re-render. Similarly, if you convert a class component to a\n                    // function, we want to invalidate the boundary.\n                    if (self.$RefreshHelpers$.shouldInvalidateReactRefreshBoundary(prevSignature, self.$RefreshHelpers$.getRefreshBoundarySignature(currentExports))) {\n                        module.hot.invalidate();\n                    }\n                    else {\n                        self.$RefreshHelpers$.scheduleUpdate();\n                    }\n                }\n            }\n            else {\n                // Since we just executed the code for the module, it's possible that the\n                // new exports made it ineligible for being a boundary.\n                // We only care about the case when we were _previously_ a boundary,\n                // because we already accepted this update (accidental side effect).\n                var isNoLongerABoundary = prevSignature !== null;\n                if (isNoLongerABoundary) {\n                    module.hot.invalidate();\n                }\n            }\n        }\n    })();\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFwcC1wYWdlcy1icm93c2VyKS8uL3dvcmtmbG93cy9lbnRpdGllcy13b3JrZmxvd3MvaXRlbS53b3JrZmxvdy50cyIsIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7QUFBQSxnREFBZ0Q7QUFDaEQsNERBQTREO0FBR3VDO0FBQ007QUFDNUQ7QUFFN0MsTUFBTVEsZUFBZTtJQUFDO0lBQVU7SUFBUztJQUFnQjtDQUFjO0FBQ3ZFLE1BQU1DLHFCQUFxQjtJQUFDO0lBQVE7SUFBZTtJQUFTO0lBQVk7SUFBa0I7Q0FBUTtBQUUzRixlQUFlQyxhQUFhQyxJQUFVLEVBQUVDLFlBQW1CO0lBQ2hFLG9CQUFvQjtJQUNwQixJQUFJLENBQUNBLGNBQWM7UUFDakIsTUFBTUMsWUFBWSxRQUFnQixPQUFSRixLQUFLRyxFQUFFLEVBQUM7UUFDbEMsSUFBSSxNQUFNWCx1RUFBU0EsQ0FBQ1UsWUFBWTtRQUVoQyxNQUFNYixrRUFBZUEsQ0FBQyxRQUFRVyxLQUFLRyxFQUFFLEVBQUUsV0FBVztZQUNoREMsTUFBTUosS0FBS0ksSUFBSTtZQUNmQyxNQUFNTCxLQUFLSyxJQUFJO1lBQ2ZDLFNBQVNOLEtBQUtNLE9BQU87UUFDdkI7UUFFQSx5Q0FBeUM7UUFDekMsTUFBTUMsYUFBYVAsS0FBS1EsWUFBWSxHQUFHLFNBQVNSLEtBQUtTLGNBQWMsR0FBRyxXQUFXO1FBQ2pGLE1BQU1DLFdBQVdWLEtBQUtRLFlBQVksSUFBSVIsS0FBS1MsY0FBYyxJQUFJRTtRQUM3RCxNQUFNcEIsd0VBQXFCQSxDQUFDUyxNQUFNTyxZQUFZRztRQUU5QyxNQUFNakIsd0VBQVVBLENBQUNTO1FBQ2pCO0lBQ0Y7SUFFQSw4QkFBOEI7SUFDOUIsTUFBTVUsZUFBZUMsS0FBS0MsU0FBUyxDQUFDYixhQUFhYyxLQUFLLE1BQU1GLEtBQUtDLFNBQVMsQ0FBQ2QsS0FBS2UsS0FBSztJQUNyRixJQUFJSCxjQUFjO1FBQ2hCLE1BQU12QixrRUFBZUEsQ0FBQyxRQUFRVyxLQUFLRyxFQUFFLEVBQUUsU0FBUztZQUM5Q0Ms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QXdCNUQsSUFBVTtRQUFFNEMsaUJBQUFBLGlFQUEwQjtJQUNsRixJQUFJO1FBQ0ZqQixRQUFRQyxHQUFHLENBQUMsZ0VBQThFNUIsT0FBZEEsS0FBS0ksSUFBSSxFQUFDLE1BQVksT0FBUkosS0FBS0csRUFBRSxFQUFDO1FBRWxHLDBCQUEwQjtRQUMxQixNQUFNd0MsMEJBQTBCM0MsTUFBTTtRQUV0QyxvREFBb0Q7UUFDcEQsSUFBSTRDLGtCQUFrQixhQUFrQixhQUFhO1lBQ25EYSxPQUFPQyxhQUFhLENBQUMsSUFBSUMsWUFBWTtRQUN2QztRQUVBaEMsUUFBUUMsR0FBRyxDQUFDLHdFQUFrRixPQUFWNUIsS0FBS0ksSUFBSTtJQUMvRixFQUFFLE9BQU8rQixPQUFPO1FBQ2RSLFFBQVFRLEtBQUssQ0FBQyx3Q0FBd0NBO0lBQ3hEO0FBQ0YiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9fTl9FLy4vd29ya2Zsb3dzL2VudGl0aWVzLXdvcmtmbG93cy9pdGVtLndvcmtmbG93LnRzPzU1M2MiXSwic291cmNlc0NvbnRlbnQiOlsiLy8gd29ya2Zsb3dzL2VudGl0aWVzLXdvcmtmbG93cy9pdGVtLndvcmtmbG93LnRzXHJcbi8vIEl0ZW0tc3BlY2lmaWMgd29ya2Zsb3cgd2l0aCBNT1ZFRCwgU09MRCwgQ09MTEVDVEVEIGV2ZW50c1xyXG5cclxuaW1wb3J0IHR5cGUgeyBJdGVtIH0gZnJvbSAnQC90eXBlcy9lbnRpdGllcyc7XHJcbmltcG9ydCB7IGFwcGVuZEVudGl0eUxvZywgdXBkYXRlRW50aXR5TG9nRmllbGQsIGFwcGVuZEl0ZW1DcmVhdGlvbkxvZyB9IGZyb20gJy4uL2VudGl0aWVzLWxvZ2dpbmcnO1xyXG5pbXBvcnQgeyBoYXNFZmZlY3QsIG1hcmtFZmZlY3QsIGNsZWFyRWZmZWN0LCBjbGVhckVmZmVjdHNCeVByZWZpeCB9IGZyb20gJ0AvZGF0YS1zdG9yZS9lZmZlY3RzLXJlZ2lzdHJ5JztcclxuaW1wb3J0IHsgQ2xpZW50QVBJIH0gZnJvbSAnQC9saWIvY2xpZW50LWFwaSc7XHJcblxyXG5jb25zdCBTVEFURV9GSUVMRFMgPSBbJ3N0YXR1cycsICdzdG9jaycsICdxdWFudGl0eVNvbGQnLCAnaXNDb2xsZWN0ZWQnXTtcclxuY29uc3QgREVTQ1JJUFRJVkVfRklFTERTID0gWyduYW1lJywgJ2Rlc2NyaXB0aW9uJywgJ3ByaWNlJywgJ3VuaXRDb3N0JywgJ2FkZGl0aW9uYWxDb3N0JywgJ3ZhbHVlJ107XHJcblxyXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gb25JdGVtVXBzZXJ0KGl0ZW06IEl0ZW0sIHByZXZpb3VzSXRlbT86IEl0ZW0pOiBQcm9taXNlPHZvaWQ+IHtcclxuICAvLyBOZXcgaXRlbSBjcmVhdGlvblxyXG4gIGlmICghcHJldmlvdXNJdGVtKSB7XHJcbiAgICBjb25zdCBlZmZlY3RLZXkgPSBgaXRlbToke2l0ZW0uaWR9OmNyZWF0ZWRgO1xyXG4gICAgaWYgKGF3YWl0IGhhc0VmZmVjdChlZmZlY3RLZXkpKSByZXR1cm47XHJcbiAgICBcclxuICAgIGF3YWl0IGFwcGVuZEVudGl0eUxvZygnaXRlbScsIGl0ZW0uaWQsICdDUkVBVEVEJywgeyBcclxuICAgICAgbmFtZTogaXRlbS5uYW1lLCBcclxuICAgICAgdHlwZTogaXRlbS50eXBlLFxyXG4gICAgICBzdGF0aW9uOiBpdGVtLnN0YXRpb24gXHJcbiAgICB9KTtcclxuICAgIFxyXG4gICAgLy8gTG9nIGl0ZW0gY3JlYXRpb24gd2l0aCBzb3VyY2UgdHJhY2tpbmdcclxuICAgIGNvbnN0IHNvdXJjZVR5cGUgPSBpdGVtLnNvdXJjZVRhc2tJZCA/ICd0YXNrJyA6IGl0ZW0uc291cmNlUmVjb3JkSWQgPyAncmVjb3JkJyA6ICdkaXJlY3QnO1xyXG4gICAgY29uc3Qgc291cmNlSWQgPSBpdGVtLnNvdXJjZVRhc2tJZCB8fCBpdGVtLnNvdXJjZVJlY29yZElkIHx8IHVuZGVmaW5lZDtcclxuICAgIGF3YWl0IGFwcGVuZEl0ZW1DcmVhdGlvbkxvZyhpdGVtLCBzb3VyY2VUeXBlLCBzb3VyY2VJZCk7XHJcbiAgICBcclxuICAgIGF3YWl0IG1hcmtFZmZlY3QoZWZmZWN0S2V5KTtcclxuICAgIHJldHVybjtcclxuICB9XHJcbiAgXHJcbiAgLy8gU3RvY2sgY2hhbmdlcyAtIE1PVkVEIGV2ZW50XHJcbiAgY29uc3Qgc3RvY2tDaGFuZ2VkID0gSlNPTi5zdHJpbmdpZnkocHJldmlvdXNJdGVtLnN0b2NrKSAhPT0gSlNPTi5zdHJpbmdpZnkoaXRlbS5zdG9jayk7XHJcbiAgaWYgKHN0b2NrQ2hhbmdlZCkge1xyXG4gICAgYXdhaXQgYXBwZW5kRW50aXR5TG9nKCdpdGVtJywgaXRlbS5pZCwgJ01PVkVEJywge1xyXG4gICAgICBuYW1lOiBpdGVtLm5hbWUsXHJcbiAgICAgIG9sZFN0b2NrOiBwcmV2aW91c0l0ZW0uc3RvY2ssXHJcbiAgICAgIG5ld1N0b2NrOiBpdGVtLnN0b2NrXHJcbiAgICB9KTtcclxuICB9XHJcbiAgXHJcbiAgLy8gUXVhbnRpdHkgc29sZCBjaGFuZ2VzIC0gU09MRCBldmVudFxyXG4gIGlmIChwcmV2aW91c0l0ZW0ucXVhbnRpdHlTb2xkICE9PSBpdGVtLnF1YW50aXR5U29sZCAmJiBpdGVtLnF1YW50aXR5U29sZCA+IHByZXZpb3VzSXRlbS5xdWFudGl0eVNvbGQpIHtcclxuICAgIGF3YWl0IGFwcGVuZEVudGl0eUxvZygnaXRlbScsIGl0ZW0uaWQsICdTT0xEJywge1xyXG4gICAgICBuYW1lOiBpdGVtLm5hbWUsXHJcbiAgICAgIHF1YW50aXR5U29sZDogaXRlbS5xdWFudGl0eVNvbGQsXHJcbiAgICAgIG9sZFF1YW50aXR5U29sZDogcHJldmlvdXNJdGVtLnF1YW50aXR5U29sZFxyXG4gICAgfSk7XHJcbiAgfVxyXG4gIFxyXG4gIC8vIENvbGxlY3Rpb24gc3RhdHVzIC0gQ09MTEVDVEVEIGV2ZW50XHJcbiAgaWYgKCFwcmV2aW91c0l0ZW0uaXNDb2xsZWN0ZWQgJiYgaXRlbS5pc0NvbGxlY3RlZCkge1xyXG4gICAgYXdhaXQgYXBwZW5kRW50aXR5TG9nKCdpdGVtJywgaXRlbS5pZCwgJ0NPTExFQ1RFRCcsIHtcclxuICAgICAgbmFtZTogaXRlbS5uYW1lLFxyXG4gICAgICBjb2xsZWN0ZWRBdDogbmV3IERhdGUoKS50b0lTT1N0cmluZygpXHJcbiAgICB9KTtcclxuICB9XHJcbiAgXHJcbiAgLy8gRGVzY3JpcHRpdmUgY2hhbmdlcyAtIHVwZGF0ZSBpbi1wbGFjZVxyXG4gIGZvciAoY29uc3QgZmllbGQgb2YgREVTQ1JJUFRJVkVfRklFTERTKSB7XHJcbiAgICBpZiAoKHByZXZpb3VzSXRlbSBhcyBhbnkpW2ZpZWxkXSAhPT0gKGl0ZW0gYXMgYW55KVtmaWVsZF0pIHtcclxuICAgICAgYXdhaXQgdXBkYXRlRW50aXR5TG9nRmllbGQoJ2l0ZW0nLCBpdGVtLmlkLCBmaWVsZCwgKHByZXZpb3VzSXRlbSBhcyBhbnkpW2ZpZWxkXSwgKGl0ZW0gYXMgYW55KVtmaWVsZF0pO1xyXG4gICAgfVxyXG4gIH1cclxufVxyXG5cclxuLyoqXHJcbiAqIFJlbW92ZSBpdGVtIGVmZmVjdHMgd2hlbiBpdGVtIGlzIGRlbGV0ZWRcclxuICogSXRlbXMgY2FuIGhhdmUgZW50cmllcyBpbiBpdGVtcyBsb2cgYW5kIHJlbGF0ZWQgbGlua3NcclxuICovXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiByZW1vdmVJdGVtRWZmZWN0c09uRGVsZXRlKGl0ZW1JZDogc3RyaW5nKTogUHJvbWlzZTx2b2lkPiB7XHJcbiAgdHJ5IHtcclxuICAgIGNvbnNvbGUubG9nKGBbcmVtb3ZlSXRlbUVmZmVjdHNPbkRlbGV0ZV0gU3RhcnRpbmcgY2xlYW51cCBmb3IgaXRlbTogJHtpdGVtSWR9YCk7XHJcbiAgICBcclxuICAgIC8vIDEuIFJlbW92ZSBhbGwgTGlua3MgcmVsYXRlZCB0byB0aGlzIGl0ZW1cclxuICAgIGNvbnN0IGl0ZW1MaW5rcyA9IGF3YWl0IENsaWVudEFQSS5nZXRMaW5rc0Zvcih7IHR5cGU6ICdpdGVtJywgaWQ6IGl0ZW1JZCB9KTtcclxuICAgIGNvbnNvbGUubG9nKGBbcmVtb3ZlSXRlbUVmZmVjdHNPbkRlbGV0ZV0gRm91bmQgJHtpdGVtTGlua3MubGVuZ3RofSBsaW5rcyB0byByZW1vdmVgKTtcclxuICAgIFxyXG4gICAgZm9yIChjb25zdCBsaW5rIG9mIGl0ZW1MaW5rcykge1xyXG4gICAgICB0cnkge1xyXG4gICAgICAgIGF3YWl0IENsaWVudEFQSS5yZW1vdmVMaW5rKGxpbmsuaWQpO1xyXG4gICAgICAgIGNvbnNvbGUubG9nKGBbcmVtb3ZlSXRlbUVmZmVjdHNPbkRlbGV0ZV0g4pyFIFJlbW92ZWQgbGluazogJHtsaW5rLmxpbmtUeXBlfWApO1xyXG4gICAgICB9IGNhdGNoIChlcnJvcikge1xyXG4gICAgICAgIGNvbnNvbGUuZXJyb3IoYFtyZW1vdmVJdGVtRWZmZWN0c09uRGVsZXRlXSDinYwgRmFpbGVkIHRvIHJlbW92ZSBsaW5rICR7bGluay5pZH06YCwgZXJyb3IpO1xyXG4gICAgICB9XHJcbiAgICB9XHJcbiAgICBcclxuICAgIC8vIDIuIENsZWFyIGFsbCBlZmZlY3RzIGZvciB0aGlzIGl0ZW1cclxuICAgIGF3YWl0IGNsZWFyRWZmZWN0KGBpdGVtOiR7aXRlbUlkfTpjcmVhdGVkYCk7XHJcbiAgICBhd2FpdCBjbGVhckVmZmVjdHNCeVByZWZpeCgnaXRlbScsIGl0ZW1JZCwgJ2ZpbmFuY2lhbExvZ2dlZDonKTtcclxuICAgIGF3YWl0IGNsZWFyRWZmZWN0c0J5UHJlZml4KCdpdGVtJywgaXRlbUlkLCAncG9pbnRzTG9nZ2VkOicpO1xyXG4gICAgXHJcbiAgICAvLyAzLiBSZW1vdmUgbG9nIGVudHJpZXMgZnJvbSBpdGVtcyBsb2cgb25seSAoSXRlbXMgZG9uJ3QgaGF2ZSBmaW5hbmNpYWwvcGxheWVyIGVmZmVjdHMpXHJcbiAgICBjb25zb2xlLmxvZyhgW3JlbW92ZUl0ZW1FZmZlY3RzT25EZWxldGVdIFN0YXJ0aW5nIGxvZyBlbnRyeSByZW1vdmFsIGZvciBpdGVtOiAke2l0ZW1JZH1gKTtcclxuICAgIFxyXG4gICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgQ2xpZW50QVBJLnJlbW92ZUxvZ0VudHJ5KCdpdGVtcycsIGl0ZW1JZCk7XHJcbiAgICBcclxuICAgIGlmIChyZXN1bHQuc3VjY2Vzcykge1xyXG4gICAgICBjb25zb2xlLmxvZyhgW3JlbW92ZUl0ZW1FZmZlY3RzT25EZWxldGVdIOKchSBJdGVtIGxvZyBlbnRyaWVzIHJlbW92ZWQgc3VjY2Vzc2Z1bGx5IGZvciBpdGVtOiAke2l0ZW1JZH1gKTtcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgIGNvbnNvbGUuZXJyb3IoYFtyZW1vdmVJdGVtRWZmZWN0c09uRGVsZXRlXSBGYWlsZWQgdG8gcmVtb3ZlIGl0ZW0gbG9nIGVudHJpZXM6ICR7cmVzdWx0Lm1lc3NhZ2V9YCk7XHJcbiAgICB9XHJcbiAgICBcclxuICAgIGNvbnNvbGUubG9nKGBbcmVtb3ZlSXRlbUVmZmVjdHNPbkRlbGV0ZV0g4pyFIENsZWFyZWQgZWZmZWN0cywgcmVtb3ZlZCBsaW5rcywgYW5kIHJlbW92ZWQgbG9nIGVudHJpZXMgZm9yIGl0ZW0gJHtpdGVtSWR9YCk7XHJcbiAgfSBjYXRjaCAoZXJyb3IpIHtcclxuICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIHJlbW92aW5nIGl0ZW0gZWZmZWN0czonLCBlcnJvcik7XHJcbiAgfVxyXG59XHJcblxyXG4vKipcclxuICogUHJvY2VzcyBpdGVtIGNyZWF0aW9uIGVmZmVjdHMgd2hlbiBpdGVtIGlzIGNyZWF0ZWRcclxuICogSGFuZGxlcyBzaWRlIGVmZmVjdHMgd2hlbiBpdGVtIGlzIGNyZWF0ZWQgZGlyZWN0bHkgKG5vdCBmcm9tIHRhc2svcmVjb3JkKVxyXG4gKi9cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIHByb2Nlc3NJdGVtQ3JlYXRpb25FZmZlY3RzKGl0ZW06IEl0ZW0pOiBQcm9taXNlPHZvaWQ+IHtcclxuICBjb25zb2xlLmxvZyhgW3Byb2Nlc3NJdGVtQ3JlYXRpb25FZmZlY3RzXSBQcm9jZXNzaW5nIGl0ZW0gY3JlYXRpb24gZWZmZWN0cyBmb3I6ICR7aXRlbS5uYW1lfSAoJHtpdGVtLmlkfSlgKTtcclxuICBcclxuICAvLyBMb2cgaXRlbSBjcmVhdGlvbiBvbmNlICh3aXRoIGlkZW1wb3RlbmN5KVxyXG4gIGNvbnN0IGl0ZW1DcmVhdGVkID0gYXdhaXQgaGFzRWZmZWN0KGBpdGVtOiR7aXRlbS5pZH06aXRlbUNyZWF0ZWRgKTtcclxuICBpZiAoIWl0ZW1DcmVhdGVkKSB7XHJcbiAgICBhd2FpdCBsb2dJdGVtQ3JlYXRpb25Gb3JJdGVtKGl0ZW0pO1xyXG4gICAgYXdhaXQgbWFya0VmZmVjdChgaXRlbToke2l0ZW0uaWR9Oml0ZW1DcmVhdGVkYCk7XHJcbiAgfVxyXG5cclxuICAvLyBJdGVtcyBjcmVhdGVkIGZyb20gSXRlbSBNb2RhbCBoYXZlIE5PIGZpbmFuY2lhbCBlZmZlY3RzXHJcbiAgLy8gSXRlbXMgYXJlIGp1c3QgaW52ZW50b3J5L2Fzc2V0cyAtIGZpbmFuY2lhbCBlZmZlY3RzIGNvbWUgZnJvbSBUYXNrcy9SZWNvcmRzXHJcbiAgLy8gVGhpcyBpcyBkaWZmZXJlbnQgZnJvbSBUYXNrcy9SZWNvcmRzIHdoaWNoIGhhdmUgY29zdC9yZXZlbnVlIHByb3BlcnRpZXNcclxufVxyXG5cclxuLyoqXHJcbiAqIExvZyBpdGVtIGNyZWF0aW9uIHdoZW4gaXRlbSBpcyBjcmVhdGVkIGRpcmVjdGx5IChub3QgZnJvbSB0YXNrL3JlY29yZClcclxuICovXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBsb2dJdGVtQ3JlYXRpb25Gb3JJdGVtKGl0ZW06IEl0ZW0pOiBQcm9taXNlPHZvaWQ+IHtcclxuICB0cnkge1xyXG4gICAgY29uc29sZS5sb2coYFtsb2dJdGVtQ3JlYXRpb25Gb3JJdGVtXSBMb2dnaW5nIGRpcmVjdCBpdGVtIGNyZWF0aW9uOiAke2l0ZW0ubmFtZX0gKCR7aXRlbS5pZH0pYCk7XHJcbiAgICBcclxuICAgIGF3YWl0IGFwcGVuZEl0ZW1DcmVhdGlvbkxvZyhpdGVtLCAnZGlyZWN0Jyk7XHJcbiAgICBjb25zb2xlLmxvZyhgW2xvZ0l0ZW1DcmVhdGlvbkZvckl0ZW1dIOKchSBEaXJlY3QgaXRlbSBjcmVhdGlvbiBsb2dnZWQgc3VjY2Vzc2Z1bGx5IGZvciAke2l0ZW0ubmFtZX1gKTtcclxuICB9IGNhdGNoIChlcnJvcikge1xyXG4gICAgY29uc29sZS5lcnJvcignRXJyb3IgbG9nZ2luZyBkaXJlY3QgaXRlbSBjcmVhdGlvbjonLCBlcnJvcik7XHJcbiAgfVxyXG59XHJcblxyXG4vKipcclxuICogVXBkYXRlIGl0ZW0gbG9nIGVudHJ5IHdoZW4gaXRlbSBwcm9wZXJ0aWVzIGNoYW5nZVxyXG4gKiBUaGlzIGZ1bmN0aW9uIHVwZGF0ZXMgZXhpc3RpbmcgaXRlbSBsb2cgZW50cmllcyB3aXRoIG5ldyBpdGVtIGRhdGFcclxuICovXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiB1cGRhdGVJdGVtTG9nRW50cnlGb3JJdGVtKGl0ZW06IEl0ZW0sIGRpc3BhdGNoRXZlbnRzOiBib29sZWFuID0gdHJ1ZSk6IFByb21pc2U8dm9pZD4ge1xyXG4gIHRyeSB7XHJcbiAgICBjb25zdCB1cGRhdGVzID0ge1xyXG4gICAgICBpdGVtTmFtZTogaXRlbS5uYW1lLFxyXG4gICAgICBpdGVtVHlwZTogaXRlbS50eXBlLFxyXG4gICAgICBjb2xsZWN0aW9uOiBpdGVtLmNvbGxlY3Rpb24sXHJcbiAgICAgIHN0YXR1czogaXRlbS5zdGF0dXMsXHJcbiAgICAgIHF1YW50aXR5OiBpdGVtLnN0b2NrPy5yZWR1Y2UoKHN1bTogbnVtYmVyLCBzdG9jazogYW55KSA9PiBzdW0gKyBzdG9jay5xdWFudGl0eSwgMCkgfHwgMCxcclxuICAgICAgdW5pdENvc3Q6IGl0ZW0udW5pdENvc3QgfHwgMCxcclxuICAgICAgcHJpY2U6IGl0ZW0ucHJpY2UgfHwgMCxcclxuICAgICAgc3RhdGlvbjogaXRlbS5zdGF0aW9uLFxyXG4gICAgICB5ZWFyOiBpdGVtLnllYXIsXHJcbiAgICAgIGRlc2NyaXB0aW9uOiBgSXRlbSBjcmVhdGVkIGRpcmVjdGx5OiAke2l0ZW0udHlwZX0gKCR7aXRlbS5zdG9jaz8ucmVkdWNlKChzdW06IG51bWJlciwgc3RvY2s6IGFueSkgPT4gc3VtICsgc3RvY2sucXVhbnRpdHksIDApIHx8IDB9eClgXHJcbiAgICB9O1xyXG5cclxuICAgIC8vIFVwZGF0ZSB0aGUgbW9zdCByZWNlbnQgbG9nIGVudHJ5IGZvciB0aGlzIGl0ZW1cclxuICAgIGF3YWl0IHVwZGF0ZUVudGl0eUxvZ0ZpZWxkKCdpdGVtJywgaXRlbS5pZCwgJ2l0ZW1OYW1lJywgJycsIGl0ZW0ubmFtZSk7XHJcbiAgICBhd2FpdCB1cGRhdGVFbnRpdHlMb2dGaWVsZCgnaXRlbScsIGl0ZW0uaWQsICdpdGVtVHlwZScsICcnLCBpdGVtLnR5cGUpO1xyXG4gICAgYXdhaXQgdXBkYXRlRW50aXR5TG9nRmllbGQoJ2l0ZW0nLCBpdGVtLmlkLCAnc3RhdHVzJywgJycsIGl0ZW0uc3RhdHVzKTtcclxuICAgIGF3YWl0IHVwZGF0ZUVudGl0eUxvZ0ZpZWxkKCdpdGVtJywgaXRlbS5pZCwgJ3F1YW50aXR5JywgJycsIGl0ZW0uc3RvY2s/LnJlZHVjZSgoc3VtOiBudW1iZXIsIHN0b2NrOiBhbnkpID0+IHN1bSArIHN0b2NrLnF1YW50aXR5LCAwKSB8fCAwKTtcclxuICAgIGF3YWl0IHVwZGF0ZUVudGl0eUxvZ0ZpZWxkKCdpdGVtJywgaXRlbS5pZCwgJ3VuaXRDb3N0JywgJycsIGl0ZW0udW5pdENvc3QgfHwgMCk7XHJcbiAgICBhd2FpdCB1cGRhdGVFbnRpdHlMb2dGaWVsZCgnaXRlbScsIGl0ZW0uaWQsICdwcmljZScsICcnLCBpdGVtLnByaWNlIHx8IDApO1xyXG5cclxuICAgIGNvbnNvbGUubG9nKGBbdXBkYXRlSXRlbUxvZ0VudHJ5Rm9ySXRlbV0g4pyFIEl0ZW0gbG9nIGVudHJ5IHVwZGF0ZWQgc3VjY2Vzc2Z1bGx5IGZvciAke2l0ZW0ubmFtZX1gKTtcclxuICAgIFxyXG4gICAgLy8gRGlzcGF0Y2ggZXZlbnQgdG8gbm90aWZ5IGZyb250ZW5kIG9mIGl0ZW1zIHVwZGF0ZVxyXG4gICAgaWYgKGRpc3BhdGNoRXZlbnRzICYmIHR5cGVvZiB3aW5kb3cgIT09ICd1bmRlZmluZWQnKSB7XHJcbiAgICAgIHdpbmRvdy5kaXNwYXRjaEV2ZW50KG5ldyBDdXN0b21FdmVudCgnaXRlbXNVcGRhdGVkJykpO1xyXG4gICAgfVxyXG4gIH0gY2F0Y2ggKGVycm9yKSB7XHJcbiAgICBjb25zb2xlLmVycm9yKCdFcnJvciB1cGRhdGluZyBpdGVtIGxvZyBlbnRyeTonLCBlcnJvcik7XHJcbiAgfVxyXG59XHJcblxyXG4vKipcclxuICogVXBkYXRlIGFsbCBsb2cgZW50cmllcyB3aGVuIGl0ZW0gcHJvcGVydGllcyBjaGFuZ2VcclxuICogVGhpcyBmdW5jdGlvbiB1cGRhdGVzIGV4aXN0aW5nIGxvZyBlbnRyaWVzIGFjcm9zcyBhbGwgbG9nIHR5cGVzIHdpdGggbmV3IGl0ZW0gZGF0YVxyXG4gKi9cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIHVwZGF0ZUFsbEl0ZW1Mb2dFbnRyaWVzKGl0ZW06IEl0ZW0sIGRpc3BhdGNoRXZlbnRzOiBib29sZWFuID0gdHJ1ZSk6IFByb21pc2U8dm9pZD4ge1xyXG4gIHRyeSB7XHJcbiAgICBjb25zb2xlLmxvZyhgW3VwZGF0ZUFsbEl0ZW1Mb2dFbnRyaWVzXSBVcGRhdGluZyBhbGwgbG9nIGVudHJpZXMgZm9yIGl0ZW06ICR7aXRlbS5uYW1lfSAoJHtpdGVtLmlkfSlgKTtcclxuICAgIFxyXG4gICAgLy8gVXBkYXRlIGl0ZW0gbG9nIGVudHJpZXNcclxuICAgIGF3YWl0IHVwZGF0ZUl0ZW1Mb2dFbnRyeUZvckl0ZW0oaXRlbSwgZmFsc2UpO1xyXG4gICAgXHJcbiAgICAvLyBEaXNwYXRjaCBldmVudCB0byBub3RpZnkgZnJvbnRlbmQgb2YgaXRlbXMgdXBkYXRlXHJcbiAgICBpZiAoZGlzcGF0Y2hFdmVudHMgJiYgdHlwZW9mIHdpbmRvdyAhPT0gJ3VuZGVmaW5lZCcpIHtcclxuICAgICAgd2luZG93LmRpc3BhdGNoRXZlbnQobmV3IEN1c3RvbUV2ZW50KCdpdGVtc1VwZGF0ZWQnKSk7XHJcbiAgICB9XHJcbiAgICBcclxuICAgIGNvbnNvbGUubG9nKGBbdXBkYXRlQWxsSXRlbUxvZ0VudHJpZXNdIOKchSBBbGwgbG9nIGVudHJpZXMgdXBkYXRlZCBzdWNjZXNzZnVsbHkgZm9yICR7aXRlbS5uYW1lfWApO1xyXG4gIH0gY2F0Y2ggKGVycm9yKSB7XHJcbiAgICBjb25zb2xlLmVycm9yKCdFcnJvciB1cGRhdGluZyBhbGwgaXRlbSBsb2cgZW50cmllczonLCBlcnJvcik7XHJcbiAgfVxyXG59Il0sIm5hbWVzIjpbImFwcGVuZEVudGl0eUxvZyIsInVwZGF0ZUVudGl0eUxvZ0ZpZWxkIiwiYXBwZW5kSXRlbUNyZWF0aW9uTG9nIiwiaGFzRWZmZWN0IiwibWFya0VmZmVjdCIsImNsZWFyRWZmZWN0IiwiY2xlYXJFZmZlY3RzQnlQcmVmaXgiLCJDbGllbnRBUEkiLCJTVEFURV9GSUVMRFMiLCJERVNDUklQVElWRV9GSUVMRFMiLCJvbkl0ZW1VcHNlcnQiLCJpdGVtIiwicHJldmlvdXNJdGVtIiwiZWZmZWN0S2V5IiwiaWQiLCJuYW1lIiwidHlwZSIsInN0YXRpb24iLCJzb3VyY2VUeXBlIiwic291cmNlVGFza0lkIiwic291cmNlUmVjb3JkSWQiLCJzb3VyY2VJZCIsInVuZGVmaW5lZCIsInN0b2NrQ2hhbmdlZCIsIkpTT04iLCJzdHJpbmdpZnkiLCJzdG9jayIsIm9sZFN0b2NrIiwibmV3U3RvY2siLCJxdWFudGl0eVNvbGQiLCJvbGRRdWFudGl0eVNvbGQiLCJpc0NvbGxlY3RlZCIsImNvbGxlY3RlZEF0IiwiRGF0ZSIsInRvSVNPU3RyaW5nIiwiZmllbGQiLCJyZW1vdmVJdGVtRWZmZWN0c09uRGVsZXRlIiwiaXRlbUlkIiwiY29uc29sZSIsImxvZyIsIml0ZW1MaW5rcyIsImdldExpbmtzRm9yIiwibGVuZ3RoIiwibGluayIsInJlbW92ZUxpbmsiLCJsaW5rVHlwZSIsImVycm9yIiwicmVzdWx0IiwicmVtb3ZlTG9nRW50cnkiLCJzdWNjZXNzIiwibWVzc2FnZSIsInByb2Nlc3NJdGVtQ3JlYXRpb25FZmZlY3RzIiwiaXRlbUNyZWF0ZWQiLCJsb2dJdGVtQ3JlYXRpb25Gb3JJdGVtIiwidXBkYXRlSXRlbUxvZ0VudHJ5Rm9ySXRlbSIsImRpc3BhdGNoRXZlbnRzIiwidXBkYXRlcyIsIml0ZW1OYW1lIiwiaXRlbVR5cGUiLCJjb2xsZWN0aW9uIiwic3RhdHVzIiwicXVhbnRpdHkiLCJyZWR1Y2UiLCJzdW0iLCJ1bml0Q29zdCIsInByaWNlIiwieWVhciIsImRlc2NyaXB0aW9uIiwid2luZG93IiwiZGlzcGF0Y2hFdmVudCIsIkN1c3RvbUV2ZW50IiwidXBkYXRlQWxsSXRlbUxvZ0VudHJpZXMiXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(app-pages-browser)/./workflows/entities-workflows/item.workflow.ts\n"));

/***/ }),

/***/ "(app-pages-browser)/./workflows/entities-workflows/player.workflow.ts":
/*!*********************************************************!*\
  !*** ./workflows/entities-workflows/player.workflow.ts ***!
  \*********************************************************/
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval(__webpack_require__.ts("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   logPlayerEffect: function() { return /* binding */ logPlayerEffect; },\n/* harmony export */   logPlayerEffectFromRecord: function() { return /* binding */ logPlayerEffectFromRecord; },\n/* harmony export */   logPlayerUpdateFromTask: function() { return /* binding */ logPlayerUpdateFromTask; },\n/* harmony export */   onPlayerUpsert: function() { return /* binding */ onPlayerUpsert; },\n/* harmony export */   removePlayerEffectsOnDelete: function() { return /* binding */ removePlayerEffectsOnDelete; },\n/* harmony export */   updatePlayerPointsFromTask: function() { return /* binding */ updatePlayerPointsFromTask; }\n/* harmony export */ });\n/* harmony import */ var _entities_logging__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../entities-logging */ \"(app-pages-browser)/./workflows/entities-logging.ts\");\n/* harmony import */ var _data_store_effects_registry__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @/data-store/effects-registry */ \"(app-pages-browser)/./data-store/effects-registry.ts\");\n/* harmony import */ var _lib_client_api__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @/lib/client-api */ \"(app-pages-browser)/./lib/client-api.ts\");\n// workflows/entities-workflows/player.workflow.ts\n// Player-specific workflow with LEVEL_UP, POINTS_CHANGED events\n\n\n\n\nconst STATE_FIELDS = [\n    \"level\",\n    \"totalPoints\",\n    \"points\",\n    \"isActive\"\n];\nconst DESCRIPTIVE_FIELDS = [\n    \"name\",\n    \"email\"\n];\nasync function onPlayerUpsert(player, previousPlayer) {\n    // New player creation\n    if (!previousPlayer) {\n        const effectKey = \"player:\".concat(player.id, \":created\");\n        if (await (0,_data_store_effects_registry__WEBPACK_IMPORTED_MODULE_1__.hasEffect)(effectKey)) return;\n        await (0,_entities_logging__WEBPACK_IMPORTED_MODULE_0__.appendEntityLog)(\"player\", player.id, \"CREATED\", {\n            name: player.name,\n            level: player.level\n        });\n        await (0,_data_store_effects_registry__WEBPACK_IMPORTED_MODULE_1__.markEffect)(effectKey);\n        return;\n    }\n    // Level up - LEVEL_UP event\n    if (previousPlayer.level < player.level) {\n        await (0,_entities_logging__WEBPACK_IMPORTED_MODULE_0__.appendEntityLog)(\"player\", player.id, \"LEVEL_UP\", {\n            name: player.name,\n            oldLevel: previousPlayer.level,\n            newLevel: player.level\n        });\n    }\n    // Points changes - POINTS_CHANGED event\n    const pointsChanged = JSON.stringify(previousPlayer.totalPoints) !== JSON.stringify(player.totalPoints) || JSON.stringify(previousPlayer.points) !== JSON.stringify(player.points);\n    if (pointsChanged) {\n        await (0,_entities_logging__WEBPACK_IMPORTED_MODULE_0__.appendEntityLog)(\"player\", player.id, \"POINTS_CHANGED\", {\n            name: player.name,\n            totalPoints: player.totalPoints,\n            points: player.points\n        });\n    }\n    // General updates - UPDATED event\n    const hasSignificantChanges = previousPlayer.isActive !== player.isActive;\n    if (hasSignificantChanges) {\n        await (0,_entities_logging__WEBPACK_IMPORTED_MODULE_0__.appendEntityLog)(\"player\", player.id, \"UPDATED\", {\n            name: player.name,\n            isActive: player.isActive\n        });\n    }\n    // Descriptive changes - update in-place\n    for (const field of DESCRIPTIVE_FIELDS){\n        if (previousPlayer[field] !== player[field]) {\n            await (0,_entities_logging__WEBPACK_IMPORTED_MODULE_0__.updateEntityLogField)(\"player\", player.id, field, previousPlayer[field], player[field]);\n        }\n    }\n}\n/**\r\n * Remove player effects when player is deleted\r\n * Players can have entries in player log and related links\r\n */ async function removePlayerEffectsOnDelete(playerId) {\n    try {\n        console.log(\"[removePlayerEffectsOnDelete] Starting cleanup for player: \".concat(playerId));\n        // 1. Remove all Links related to this player\n        const playerLinks = await _lib_client_api__WEBPACK_IMPORTED_MODULE_2__.ClientAPI.getLinksFor({\n            type: \"player\",\n            id: playerId\n        });\n        console.log(\"[removePlayerEffectsOnDelete] Found \".concat(playerLinks.length, \" links to remove\"));\n        for (const link of playerLinks){\n            try {\n                await _lib_client_api__WEBPACK_IMPORTED_MODULE_2__.ClientAPI.removeLink(link.id);\n                console.log(\"[removePlayerEffectsOnDelete]  Removed link: \".concat(link.linkType));\n            } catch (error) {\n                console.error(\"[removePlayerEffectsOnDelete]  Failed to remove link \".concat(link.id, \":\"), error);\n            }\n        }\n        // 2. Clear all effects for this player\n        await (0,_data_store_effects_registry__WEBPACK_IMPORTED_MODULE_1__.clearEffect)(\"player:\".concat(playerId, \":created\"));\n        await (0,_data_store_effects_registry__WEBPACK_IMPORTED_MODULE_1__.clearEffectsByPrefix)(\"player\", playerId, \"\");\n        // 3. Remove log entries from player log\n        console.log(\"[removePlayerEffectsOnDelete] Starting log entry removal for player: \".concat(playerId));\n        const result = await _lib_client_api__WEBPACK_IMPORTED_MODULE_2__.ClientAPI.removeLogEntry(\"player\", playerId);\n        if (result.success) {\n            console.log(\"[removePlayerEffectsOnDelete]  Player log entries removed successfully for player: \".concat(playerId));\n        } else {\n            console.error(\"[removePlayerEffectsOnDelete] Failed to remove player log entries: \".concat(result.message));\n        }\n        console.log(\"[removePlayerEffectsOnDelete]  Cleared effects, removed links, and removed log entries for player \".concat(playerId));\n    } catch (error) {\n        console.error(\"Error removing player effects:\", error);\n    }\n}\n/**\r\n * Log player effect from task completion\r\n * This logs the points awarded to the player from completing a task\r\n */ async function logPlayerEffect(task) {\n    try {\n        var _task_rewards;\n        console.log(\"[logPlayerEffect] Logging player effect for task: \".concat(task.name, \" (\").concat(task.id, \")\"));\n        // Only log if there are points to award\n        const hasPoints = ((_task_rewards = task.rewards) === null || _task_rewards === void 0 ? void 0 : _task_rewards.points) && ((task.rewards.points.xp || 0) > 0 || (task.rewards.points.rp || 0) > 0 || (task.rewards.points.fp || 0) > 0 || (task.rewards.points.hp || 0) > 0);\n        if (!hasPoints) {\n            console.log(\"[logPlayerEffect] No points to log, skipping\");\n            return;\n        }\n        // Get main player ID (V0.1 constant)\n        const mainPlayerId = \"PLAYER_ONE_ID\";\n        await (0,_entities_logging__WEBPACK_IMPORTED_MODULE_0__.appendPlayerPointsLog)(mainPlayerId, {\n            xp: task.rewards.points.xp || 0,\n            rp: task.rewards.points.rp || 0,\n            fp: task.rewards.points.fp || 0,\n            hp: task.rewards.points.hp || 0\n        }, task.id, \"task\");\n        console.log(\"[logPlayerEffect]  Player effect logged successfully for \".concat(task.name));\n    } catch (error) {\n        console.error(\"Error logging player effect:\", error);\n    }\n}\n/**\r\n * Log player effect from financial record\r\n * This logs the points awarded to the player from a financial record\r\n */ async function logPlayerEffectFromRecord(record) {\n    try {\n        var _record_rewards, _record_rewards_points, _record_rewards1, _record_rewards_points1, _record_rewards2, _record_rewards_points2, _record_rewards3, _record_rewards_points3, _record_rewards4;\n        console.log(\"[logPlayerEffectFromRecord] Logging player effect for record: \".concat(record.name, \" (\").concat(record.id, \")\"));\n        // Only log if there are points to award\n        const hasPoints = ((_record_rewards = record.rewards) === null || _record_rewards === void 0 ? void 0 : _record_rewards.points) && ((record.rewards.points.xp || 0) > 0 || (record.rewards.points.rp || 0) > 0 || (record.rewards.points.fp || 0) > 0 || (record.rewards.points.hp || 0) > 0);\n        if (!hasPoints) {\n            console.log(\"[logPlayerEffectFromRecord] No points to log, skipping\");\n            return;\n        }\n        // Get main player ID (V0.1 constant)\n        const mainPlayerId = \"PLAYER_ONE_ID\";\n        await (0,_entities_logging__WEBPACK_IMPORTED_MODULE_0__.appendPlayerPointsLog)(mainPlayerId, {\n            xp: ((_record_rewards1 = record.rewards) === null || _record_rewards1 === void 0 ? void 0 : (_record_rewards_points = _record_rewards1.points) === null || _record_rewards_points === void 0 ? void 0 : _record_rewards_points.xp) || 0,\n            rp: ((_record_rewards2 = record.rewards) === null || _record_rewards2 === void 0 ? void 0 : (_record_rewards_points1 = _record_rewards2.points) === null || _record_rewards_points1 === void 0 ? void 0 : _record_rewards_points1.rp) || 0,\n            fp: ((_record_rewards3 = record.rewards) === null || _record_rewards3 === void 0 ? void 0 : (_record_rewards_points2 = _record_rewards3.points) === null || _record_rewards_points2 === void 0 ? void 0 : _record_rewards_points2.fp) || 0,\n            hp: ((_record_rewards4 = record.rewards) === null || _record_rewards4 === void 0 ? void 0 : (_record_rewards_points3 = _record_rewards4.points) === null || _record_rewards_points3 === void 0 ? void 0 : _record_rewards_points3.hp) || 0\n        }, record.id, \"financial\");\n        console.log(\"[logPlayerEffectFromRecord]  Player effect logged successfully for \".concat(record.name));\n    } catch (error) {\n        console.error(\"Error logging player effect from record:\", error);\n    }\n}\n/**\r\n * Log player update from task changes\r\n * This logs when task rewards change and player points need to be updated\r\n */ async function logPlayerUpdateFromTask(task, oldTask) {\n    try {\n        var _oldTask_rewards, _task_rewards;\n        console.log(\"[logPlayerUpdateFromTask] Logging player update for task: \".concat(task.name, \" (\").concat(task.id, \")\"));\n        const oldRewards = ((_oldTask_rewards = oldTask.rewards) === null || _oldTask_rewards === void 0 ? void 0 : _oldTask_rewards.points) || {\n            xp: 0,\n            rp: 0,\n            fp: 0,\n            hp: 0\n        };\n        const newRewards = ((_task_rewards = task.rewards) === null || _task_rewards === void 0 ? void 0 : _task_rewards.points) || {\n            xp: 0,\n            rp: 0,\n            fp: 0,\n            hp: 0\n        };\n        // Check if rewards actually changed\n        const rewardsChanged = JSON.stringify(oldRewards) !== JSON.stringify(newRewards);\n        if (!rewardsChanged) {\n            console.log(\"[logPlayerUpdateFromTask] No reward changes to log, skipping\");\n            return;\n        }\n        // Get main player ID (V0.1 constant)\n        const mainPlayerId = \"PLAYER_ONE_ID\";\n        await (0,_entities_logging__WEBPACK_IMPORTED_MODULE_0__.appendPlayerPointsUpdateLog)(mainPlayerId, {\n            xp: oldRewards.xp || 0,\n            rp: oldRewards.rp || 0,\n            fp: oldRewards.fp || 0,\n            hp: oldRewards.hp || 0\n        }, {\n            xp: newRewards.xp || 0,\n            rp: newRewards.rp || 0,\n            fp: newRewards.fp || 0,\n            hp: newRewards.hp || 0\n        }, task.id);\n        console.log(\"[logPlayerUpdateFromTask]  Player update logged successfully for \".concat(task.name));\n    } catch (error) {\n        console.error(\"Error logging player update from task:\", error);\n    }\n}\n/**\r\n * Update player points from task changes\r\n * This updates the player's points when task rewards change\r\n */ async function updatePlayerPointsFromTask(task, oldTask) {\n    try {\n        var _oldTask_rewards, _task_rewards, _mainPlayer_points, _mainPlayer_points1, _mainPlayer_points2, _mainPlayer_points3, _mainPlayer_totalPoints, _mainPlayer_totalPoints1, _mainPlayer_totalPoints2, _mainPlayer_totalPoints3;\n        console.log(\"[updatePlayerPointsFromTask] Updating player points for task: \".concat(task.name, \" (\").concat(task.id, \")\"));\n        const oldRewards = ((_oldTask_rewards = oldTask.rewards) === null || _oldTask_rewards === void 0 ? void 0 : _oldTask_rewards.points) || {\n            xp: 0,\n            rp: 0,\n            fp: 0,\n            hp: 0\n        };\n        const newRewards = ((_task_rewards = task.rewards) === null || _task_rewards === void 0 ? void 0 : _task_rewards.points) || {\n            xp: 0,\n            rp: 0,\n            fp: 0,\n            hp: 0\n        };\n        // Calculate point delta\n        const delta = {\n            xp: (newRewards.xp || 0) - (oldRewards.xp || 0),\n            rp: (newRewards.rp || 0) - (oldRewards.rp || 0),\n            fp: (newRewards.fp || 0) - (oldRewards.fp || 0),\n            hp: (newRewards.hp || 0) - (oldRewards.hp || 0)\n        };\n        // Check if there are any changes\n        const hasChanges = delta.xp !== 0 || delta.rp !== 0 || delta.fp !== 0 || delta.hp !== 0;\n        if (!hasChanges) {\n            console.log(\"[updatePlayerPointsFromTask] No point changes to apply, skipping\");\n            return;\n        }\n        // Get main player\n        const mainPlayerId = \"PLAYER_ONE_ID\";\n        const players = await _lib_client_api__WEBPACK_IMPORTED_MODULE_2__.ClientAPI.getPlayers();\n        const mainPlayer = players.find((p)=>p.id === mainPlayerId);\n        if (!mainPlayer) {\n            console.log(\"[updatePlayerPointsFromTask] Main player not found, skipping\");\n            return;\n        }\n        // Apply delta to player points\n        const updatedPlayer = {\n            ...mainPlayer,\n            points: {\n                xp: Math.max(0, (((_mainPlayer_points = mainPlayer.points) === null || _mainPlayer_points === void 0 ? void 0 : _mainPlayer_points.xp) || 0) + delta.xp),\n                rp: Math.max(0, (((_mainPlayer_points1 = mainPlayer.points) === null || _mainPlayer_points1 === void 0 ? void 0 : _mainPlayer_points1.rp) || 0) + delta.rp),\n                fp: Math.max(0, (((_mainPlayer_points2 = mainPlayer.points) === null || _mainPlayer_points2 === void 0 ? void 0 : _mainPlayer_points2.fp) || 0) + delta.fp),\n                hp: Math.max(0, (((_mainPlayer_points3 = mainPlayer.points) === null || _mainPlayer_points3 === void 0 ? void 0 : _mainPlayer_points3.hp) || 0) + delta.hp)\n            },\n            totalPoints: {\n                xp: Math.max(0, (((_mainPlayer_totalPoints = mainPlayer.totalPoints) === null || _mainPlayer_totalPoints === void 0 ? void 0 : _mainPlayer_totalPoints.xp) || 0) + delta.xp),\n                rp: Math.max(0, (((_mainPlayer_totalPoints1 = mainPlayer.totalPoints) === null || _mainPlayer_totalPoints1 === void 0 ? void 0 : _mainPlayer_totalPoints1.rp) || 0) + delta.rp),\n                fp: Math.max(0, (((_mainPlayer_totalPoints2 = mainPlayer.totalPoints) === null || _mainPlayer_totalPoints2 === void 0 ? void 0 : _mainPlayer_totalPoints2.fp) || 0) + delta.fp),\n                hp: Math.max(0, (((_mainPlayer_totalPoints3 = mainPlayer.totalPoints) === null || _mainPlayer_totalPoints3 === void 0 ? void 0 : _mainPlayer_totalPoints3.hp) || 0) + delta.hp)\n            },\n            updatedAt: new Date()\n        };\n        // Store the updated player\n        console.log(\"[updatePlayerPointsFromTask] Applying point delta:\", delta);\n        await _lib_client_api__WEBPACK_IMPORTED_MODULE_2__.ClientAPI.upsertPlayer(updatedPlayer);\n        console.log(\"[updatePlayerPointsFromTask]  Player points updated successfully\");\n    } catch (error) {\n        console.error(\"Error updating player points from task:\", error);\n    }\n}\n\n\n;\n    // Wrapped in an IIFE to avoid polluting the global scope\n    ;\n    (function () {\n        var _a, _b;\n        // Legacy CSS implementations will `eval` browser code in a Node.js context\n        // to extract CSS. For backwards compatibility, we need to check we're in a\n        // browser context before continuing.\n        if (typeof self !== 'undefined' &&\n            // AMP / No-JS mode does not inject these helpers:\n            '$RefreshHelpers$' in self) {\n            // @ts-ignore __webpack_module__ is global\n            var currentExports = module.exports;\n            // @ts-ignore __webpack_module__ is global\n            var prevSignature = (_b = (_a = module.hot.data) === null || _a === void 0 ? void 0 : _a.prevSignature) !== null && _b !== void 0 ? _b : null;\n            // This cannot happen in MainTemplate because the exports mismatch between\n            // templating and execution.\n            self.$RefreshHelpers$.registerExportsForReactRefresh(currentExports, module.id);\n            // A module can be accepted automatically based on its exports, e.g. when\n            // it is a Refresh Boundary.\n            if (self.$RefreshHelpers$.isReactRefreshBoundary(currentExports)) {\n                // Save the previous exports signature on update so we can compare the boundary\n                // signatures. We avoid saving exports themselves since it causes memory leaks (https://github.com/vercel/next.js/pull/53797)\n                module.hot.dispose(function (data) {\n                    data.prevSignature =\n                        self.$RefreshHelpers$.getRefreshBoundarySignature(currentExports);\n                });\n                // Unconditionally accept an update to this module, we'll check if it's\n                // still a Refresh Boundary later.\n                // @ts-ignore importMeta is replaced in the loader\n                module.hot.accept();\n                // This field is set when the previous version of this module was a\n                // Refresh Boundary, letting us know we need to check for invalidation or\n                // enqueue an update.\n                if (prevSignature !== null) {\n                    // A boundary can become ineligible if its exports are incompatible\n                    // with the previous exports.\n                    //\n                    // For example, if you add/remove/change exports, we'll want to\n                    // re-execute the importing modules, and force those components to\n                    // re-render. Similarly, if you convert a class component to a\n                    // function, we want to invalidate the boundary.\n                    if (self.$RefreshHelpers$.shouldInvalidateReactRefreshBoundary(prevSignature, self.$RefreshHelpers$.getRefreshBoundarySignature(currentExports))) {\n                        module.hot.invalidate();\n                    }\n                    else {\n                        self.$RefreshHelpers$.scheduleUpdate();\n                    }\n                }\n            }\n            else {\n                // Since we just executed the code for the module, it's possible that the\n                // new exports made it ineligible for being a boundary.\n                // We only care about the case when we were _previously_ a boundary,\n                // because we already accepted this update (accidental side effect).\n                var isNoLongerABoundary = prevSignature !== null;\n                if (isNoLongerABoundary) {\n                    module.hot.invalidate();\n                }\n            }\n        }\n    })();\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFwcC1wYWdlcy1icm93c2VyKS8uL3dvcmtmbG93cy9lbnRpdGllcy13b3JrZmxvd3MvcGxheWVyLndvcmtmbG93LnRzIiwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7OztBQUFBLGtEQUFrRDtBQUNsRCxnRUFBZ0U7QUFHWTtBQUM2QjtBQUM1RDtBQUM0QztBQUd6RixNQUFNUyxlQUFlO0lBQUM7SUFBUztJQUFlO0lBQVU7Q0FBVztBQUNuRSxNQUFNQyxxQkFBcUI7SUFBQztJQUFRO0NBQVE7QUFFckMsZUFBZUMsZUFBZUMsTUFBYyxFQUFFQyxjQUF1QjtJQUMxRSxzQkFBc0I7SUFDdEIsSUFBSSxDQUFDQSxnQkFBZ0I7UUFDbkIsTUFBTUMsWUFBWSxVQUFvQixPQUFWRixPQUFPRyxFQUFFLEVBQUM7UUFDdEMsSUFBSSxNQUFNYix1RUFBU0EsQ0FBQ1ksWUFBWTtRQUVoQyxNQUFNZCxrRUFBZUEsQ0FBQyxVQUFVWSxPQUFPRyxFQUFFLEVBQUUsV0FBVztZQUNwREMsTUFBTUosT0FBT0ksSUFBSTtZQUNqQkMsT0FBT0wsT0FBT0ssS0FBSztRQUNyQjtRQUNBLE1BQU1kLHdFQUFVQSxDQUFDVztRQUNqQjtJQUNGO0lBRUEsNEJBQTRCO0lBQzVCLElBQUlELGVBQWVJLEtBQUssR0FBR0wsT0FBT0ssS0FBSyxFQUFFO1FBQ3ZDLE1BQU1qQixrRUFBZUEsQ0FBQyxVQUFVWSxPQUFPRyxFQUFFLEVBQUUsWUFBWTtZQUNyREMsTUFBTUosT0FBT0ksSUFBSTtZQUNqQkUsVUFBVUwsZUFBZUksS0FBSztZQUM5QkUsVUFBVVAsT0FBT0ssS0FBSztRQUN4QjtJQUNGO0lBRUEsd0NBQXdDO0lBQ3hDLE1BQU1HLGdCQUFnQkMsS0FBS0MsU0FBUyxDQUFDVCxlQUFlVSxXQUFXLE1BQU1GLEtBQUtDLFNBQVMsQ0FBQ1YsT0FBT1csV0FBVyxLQUNqRkYsS0FBS0MsU0FBUyxDQUFDVCxlQUFlVyxNQUFNLE1BQU1ILEtBQUtDLFNBQVMsQ0FBQ1YsT0FBT1ksTUFBTTtJQUMzRixJQUFJSixl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RyxDQUFDVCxFQUFBQSwyQkFBQUEsV0FBV3RDLFdBQVcsY0FBdEJzQywrQ0FBQUEseUJBQXdCWixFQUFFLEtBQUksS0FBS2EsTUFBTWIsRUFBRTtnQkFDNURDLElBQUltQixLQUFLQyxHQUFHLENBQUMsR0FBRyxDQUFDVCxFQUFBQSwyQkFBQUEsV0FBV3RDLFdBQVcsY0FBdEJzQywrQ0FBQUEseUJBQXdCWCxFQUFFLEtBQUksS0FBS1ksTUFBTVosRUFBRTtnQkFDNURDLElBQUlrQixLQUFLQyxHQUFHLENBQUMsR0FBRyxDQUFDVCxFQUFBQSwyQkFBQUEsV0FBV3RDLFdBQVcsY0FBdEJzQywrQ0FBQUEseUJBQXdCVixFQUFFLEtBQUksS0FBS1csTUFBTVgsRUFBRTtZQUM5RDtZQUNBb0IsV0FBVyxJQUFJQztRQUNqQjtRQUVBLDJCQUEyQjtRQUMzQjFDLFFBQVFDLEdBQUcsQ0FBRSxzREFBcUQrQjtRQUNsRSxNQUFNeEQsc0RBQVNBLENBQUNtRSxZQUFZLENBQUNMO1FBRTdCdEMsUUFBUUMsR0FBRyxDQUFFO0lBQ2YsRUFBRSxPQUFPUSxPQUFPO1FBQ2RULFFBQVFTLEtBQUssQ0FBQywyQ0FBMkNBO0lBQzNEO0FBQ0YiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9fTl9FLy4vd29ya2Zsb3dzL2VudGl0aWVzLXdvcmtmbG93cy9wbGF5ZXIud29ya2Zsb3cudHM/ODgzYiJdLCJzb3VyY2VzQ29udGVudCI6WyIvLyB3b3JrZmxvd3MvZW50aXRpZXMtd29ya2Zsb3dzL3BsYXllci53b3JrZmxvdy50c1xyXG4vLyBQbGF5ZXItc3BlY2lmaWMgd29ya2Zsb3cgd2l0aCBMRVZFTF9VUCwgUE9JTlRTX0NIQU5HRUQgZXZlbnRzXHJcblxyXG5pbXBvcnQgdHlwZSB7IFBsYXllciB9IGZyb20gJ0AvdHlwZXMvZW50aXRpZXMnO1xyXG5pbXBvcnQgeyBhcHBlbmRFbnRpdHlMb2csIHVwZGF0ZUVudGl0eUxvZ0ZpZWxkIH0gZnJvbSAnLi4vZW50aXRpZXMtbG9nZ2luZyc7XHJcbmltcG9ydCB7IGhhc0VmZmVjdCwgbWFya0VmZmVjdCwgY2xlYXJFZmZlY3QsIGNsZWFyRWZmZWN0c0J5UHJlZml4IH0gZnJvbSAnQC9kYXRhLXN0b3JlL2VmZmVjdHMtcmVnaXN0cnknO1xyXG5pbXBvcnQgeyBDbGllbnRBUEkgfSBmcm9tICdAL2xpYi9jbGllbnQtYXBpJztcclxuaW1wb3J0IHsgYXBwZW5kUGxheWVyUG9pbnRzTG9nLCBhcHBlbmRQbGF5ZXJQb2ludHNVcGRhdGVMb2cgfSBmcm9tICcuLi9lbnRpdGllcy1sb2dnaW5nJztcclxuaW1wb3J0IHR5cGUgeyBUYXNrLCBGaW5hbmNpYWxSZWNvcmQgfSBmcm9tICdAL3R5cGVzL2VudGl0aWVzJztcclxuXHJcbmNvbnN0IFNUQVRFX0ZJRUxEUyA9IFsnbGV2ZWwnLCAndG90YWxQb2ludHMnLCAncG9pbnRzJywgJ2lzQWN0aXZlJ107XHJcbmNvbnN0IERFU0NSSVBUSVZFX0ZJRUxEUyA9IFsnbmFtZScsICdlbWFpbCddO1xyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIG9uUGxheWVyVXBzZXJ0KHBsYXllcjogUGxheWVyLCBwcmV2aW91c1BsYXllcj86IFBsYXllcik6IFByb21pc2U8dm9pZD4ge1xyXG4gIC8vIE5ldyBwbGF5ZXIgY3JlYXRpb25cclxuICBpZiAoIXByZXZpb3VzUGxheWVyKSB7XHJcbiAgICBjb25zdCBlZmZlY3RLZXkgPSBgcGxheWVyOiR7cGxheWVyLmlkfTpjcmVhdGVkYDtcclxuICAgIGlmIChhd2FpdCBoYXNFZmZlY3QoZWZmZWN0S2V5KSkgcmV0dXJuO1xyXG4gICAgXHJcbiAgICBhd2FpdCBhcHBlbmRFbnRpdHlMb2coJ3BsYXllcicsIHBsYXllci5pZCwgJ0NSRUFURUQnLCB7IFxyXG4gICAgICBuYW1lOiBwbGF5ZXIubmFtZSwgXHJcbiAgICAgIGxldmVsOiBwbGF5ZXIubGV2ZWxcclxuICAgIH0pO1xyXG4gICAgYXdhaXQgbWFya0VmZmVjdChlZmZlY3RLZXkpO1xyXG4gICAgcmV0dXJuO1xyXG4gIH1cclxuICBcclxuICAvLyBMZXZlbCB1cCAtIExFVkVMX1VQIGV2ZW50XHJcbiAgaWYgKHByZXZpb3VzUGxheWVyLmxldmVsIDwgcGxheWVyLmxldmVsKSB7XHJcbiAgICBhd2FpdCBhcHBlbmRFbnRpdHlMb2coJ3BsYXllcicsIHBsYXllci5pZCwgJ0xFVkVMX1VQJywge1xyXG4gICAgICBuYW1lOiBwbGF5ZXIubmFtZSxcclxuICAgICAgb2xkTGV2ZWw6IHByZXZpb3VzUGxheWVyLmxldmVsLFxyXG4gICAgICBuZXdMZXZlbDogcGxheWVyLmxldmVsXHJcbiAgICB9KTtcclxuICB9XHJcbiAgXHJcbiAgLy8gUG9pbnRzIGNoYW5nZXMgLSBQT0lOVFNfQ0hBTkdFRCBldmVudFxyXG4gIGNvbnN0IHBvaW50c0NoYW5nZWQgPSBKU09OLnN0cmluZ2lmeShwcmV2aW91c1BsYXllci50b3RhbFBvaW50cykgIT09IEpTT04uc3RyaW5naWZ5KHBsYXllci50b3RhbFBvaW50cykgfHxcclxuICAgICAgICAgICAgICAgICAgICAgICBKU09OLnN0cmluZ2lmeShwcmV2aW91c1BsYXllci5wb2ludHMpICE9PSBKU09OLnN0cmluZ2lmeShwbGF5ZXIucG9pbnRzKTtcclxuICBpZiAocG9pbnRzQ2hhbmdlZCkge1xyXG4gICAgYXdhaXQgYXBwZW5kRW50aXR5TG9nKCdwbGF5ZXInLCBwbGF5ZXIuaWQsICdQT0lOVFNfQ0hBTkdFRCcsIHtcclxuICAgICAgbmFtZTogcGxheWVyLm5hbWUsXHJcbiAgICAgIHRvdGFsUG9pbnRzOiBwbGF5ZXIudG90YWxQb2ludHMsXHJcbiAgICAgIHBvaW50czogcGxheWVyLnBvaW50c1xyXG4gICAgfSk7XHJcbiAgfVxyXG4gIFxyXG4gIC8vIEdlbmVyYWwgdXBkYXRlcyAtIFVQREFURUQgZXZlbnRcclxuICBjb25zdCBoYXNTaWduaWZpY2FudENoYW5nZXMgPSBwcmV2aW91c1BsYXllci5pc0FjdGl2ZSAhPT0gcGxheWVyLmlzQWN0aXZlO1xyXG4gIGlmIChoYXNTaWduaWZpY2FudENoYW5nZXMpIHtcclxuICAgIGF3YWl0IGFwcGVuZEVudGl0eUxvZygncGxheWVyJywgcGxheWVyLmlkLCAnVVBEQVRFRCcsIHtcclxuICAgICAgbmFtZTogcGxheWVyLm5hbWUsXHJcbiAgICAgIGlzQWN0aXZlOiBwbGF5ZXIuaXNBY3RpdmVcclxuICAgIH0pO1xyXG4gIH1cclxuICBcclxuICAvLyBEZXNjcmlwdGl2ZSBjaGFuZ2VzIC0gdXBkYXRlIGluLXBsYWNlXHJcbiAgZm9yIChjb25zdCBmaWVsZCBvZiBERVNDUklQVElWRV9GSUVMRFMpIHtcclxuICAgIGlmICgocHJldmlvdXNQbGF5ZXIgYXMgYW55KVtmaWVsZF0gIT09IChwbGF5ZXIgYXMgYW55KVtmaWVsZF0pIHtcclxuICAgICAgYXdhaXQgdXBkYXRlRW50aXR5TG9nRmllbGQoJ3BsYXllcicsIHBsYXllci5pZCwgZmllbGQsIChwcmV2aW91c1BsYXllciBhcyBhbnkpW2ZpZWxkXSwgKHBsYXllciBhcyBhbnkpW2ZpZWxkXSk7XHJcbiAgICB9XHJcbiAgfVxyXG59XHJcblxyXG4vKipcclxuICogUmVtb3ZlIHBsYXllciBlZmZlY3RzIHdoZW4gcGxheWVyIGlzIGRlbGV0ZWRcclxuICogUGxheWVycyBjYW4gaGF2ZSBlbnRyaWVzIGluIHBsYXllciBsb2cgYW5kIHJlbGF0ZWQgbGlua3NcclxuICovXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiByZW1vdmVQbGF5ZXJFZmZlY3RzT25EZWxldGUocGxheWVySWQ6IHN0cmluZyk6IFByb21pc2U8dm9pZD4ge1xyXG4gIHRyeSB7XHJcbiAgICBjb25zb2xlLmxvZyhgW3JlbW92ZVBsYXllckVmZmVjdHNPbkRlbGV0ZV0gU3RhcnRpbmcgY2xlYW51cCBmb3IgcGxheWVyOiAke3BsYXllcklkfWApO1xyXG4gICAgXHJcbiAgICAvLyAxLiBSZW1vdmUgYWxsIExpbmtzIHJlbGF0ZWQgdG8gdGhpcyBwbGF5ZXJcclxuICAgIGNvbnN0IHBsYXllckxpbmtzID0gYXdhaXQgQ2xpZW50QVBJLmdldExpbmtzRm9yKHsgdHlwZTogJ3BsYXllcicsIGlkOiBwbGF5ZXJJZCB9KTtcclxuICAgIGNvbnNvbGUubG9nKGBbcmVtb3ZlUGxheWVyRWZmZWN0c09uRGVsZXRlXSBGb3VuZCAke3BsYXllckxpbmtzLmxlbmd0aH0gbGlua3MgdG8gcmVtb3ZlYCk7XHJcbiAgICBcclxuICAgIGZvciAoY29uc3QgbGluayBvZiBwbGF5ZXJMaW5rcykge1xyXG4gICAgICB0cnkge1xyXG4gICAgICAgIGF3YWl0IENsaWVudEFQSS5yZW1vdmVMaW5rKGxpbmsuaWQpO1xyXG4gICAgICAgIGNvbnNvbGUubG9nKGBbcmVtb3ZlUGxheWVyRWZmZWN0c09uRGVsZXRlXSDinIUgUmVtb3ZlZCBsaW5rOiAke2xpbmsubGlua1R5cGV9YCk7XHJcbiAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XHJcbiAgICAgICAgY29uc29sZS5lcnJvcihgW3JlbW92ZVBsYXllckVmZmVjdHNPbkRlbGV0ZV0g4p2MIEZhaWxlZCB0byByZW1vdmUgbGluayAke2xpbmsuaWR9OmAsIGVycm9yKTtcclxuICAgICAgfVxyXG4gICAgfVxyXG4gICAgXHJcbiAgICAvLyAyLiBDbGVhciBhbGwgZWZmZWN0cyBmb3IgdGhpcyBwbGF5ZXJcclxuICAgIGF3YWl0IGNsZWFyRWZmZWN0KGBwbGF5ZXI6JHtwbGF5ZXJJZH06Y3JlYXRlZGApO1xyXG4gICAgYXdhaXQgY2xlYXJFZmZlY3RzQnlQcmVmaXgoJ3BsYXllcicsIHBsYXllcklkLCAnJyk7XHJcbiAgICBcclxuICAgIC8vIDMuIFJlbW92ZSBsb2cgZW50cmllcyBmcm9tIHBsYXllciBsb2dcclxuICAgIGNvbnNvbGUubG9nKGBbcmVtb3ZlUGxheWVyRWZmZWN0c09uRGVsZXRlXSBTdGFydGluZyBsb2cgZW50cnkgcmVtb3ZhbCBmb3IgcGxheWVyOiAke3BsYXllcklkfWApO1xyXG4gICAgXHJcbiAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBDbGllbnRBUEkucmVtb3ZlTG9nRW50cnkoJ3BsYXllcicsIHBsYXllcklkKTtcclxuICAgIFxyXG4gICAgaWYgKHJlc3VsdC5zdWNjZXNzKSB7XHJcbiAgICAgIGNvbnNvbGUubG9nKGBbcmVtb3ZlUGxheWVyRWZmZWN0c09uRGVsZXRlXSDinIUgUGxheWVyIGxvZyBlbnRyaWVzIHJlbW92ZWQgc3VjY2Vzc2Z1bGx5IGZvciBwbGF5ZXI6ICR7cGxheWVySWR9YCk7XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICBjb25zb2xlLmVycm9yKGBbcmVtb3ZlUGxheWVyRWZmZWN0c09uRGVsZXRlXSBGYWlsZWQgdG8gcmVtb3ZlIHBsYXllciBsb2cgZW50cmllczogJHtyZXN1bHQubWVzc2FnZX1gKTtcclxuICAgIH1cclxuICAgIFxyXG4gICAgY29uc29sZS5sb2coYFtyZW1vdmVQbGF5ZXJFZmZlY3RzT25EZWxldGVdIOKchSBDbGVhcmVkIGVmZmVjdHMsIHJlbW92ZWQgbGlua3MsIGFuZCByZW1vdmVkIGxvZyBlbnRyaWVzIGZvciBwbGF5ZXIgJHtwbGF5ZXJJZH1gKTtcclxuICB9IGNhdGNoIChlcnJvcikge1xyXG4gICAgY29uc29sZS5lcnJvcignRXJyb3IgcmVtb3ZpbmcgcGxheWVyIGVmZmVjdHM6JywgZXJyb3IpO1xyXG4gIH1cclxufVxyXG5cclxuLyoqXHJcbiAqIExvZyBwbGF5ZXIgZWZmZWN0IGZyb20gdGFzayBjb21wbGV0aW9uXHJcbiAqIFRoaXMgbG9ncyB0aGUgcG9pbnRzIGF3YXJkZWQgdG8gdGhlIHBsYXllciBmcm9tIGNvbXBsZXRpbmcgYSB0YXNrXHJcbiAqL1xyXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gbG9nUGxheWVyRWZmZWN0KHRhc2s6IFRhc2spOiBQcm9taXNlPHZvaWQ+IHtcclxuICB0cnkge1xyXG4gICAgY29uc29sZS5sb2coYFtsb2dQbGF5ZXJFZmZlY3RdIExvZ2dpbmcgcGxheWVyIGVmZmVjdCBmb3IgdGFzazogJHt0YXNrLm5hbWV9ICgke3Rhc2suaWR9KWApO1xyXG4gICAgXHJcbiAgICAvLyBPbmx5IGxvZyBpZiB0aGVyZSBhcmUgcG9pbnRzIHRvIGF3YXJkXHJcbiAgICBjb25zdCBoYXNQb2ludHMgPSB0YXNrLnJld2FyZHM/LnBvaW50cyAmJiAoXHJcbiAgICAgICh0YXNrLnJld2FyZHMucG9pbnRzLnhwIHx8IDApID4gMCB8fFxyXG4gICAgICAodGFzay5yZXdhcmRzLnBvaW50cy5ycCB8fCAwKSA+IDAgfHxcclxuICAgICAgKHRhc2sucmV3YXJkcy5wb2ludHMuZnAgfHwgMCkgPiAwIHx8XHJcbiAgICAgICh0YXNrLnJld2FyZHMucG9pbnRzLmhwIHx8IDApID4gMFxyXG4gICAgKTtcclxuICAgIFxyXG4gICAgaWYgKCFoYXNQb2ludHMpIHtcclxuICAgICAgY29uc29sZS5sb2coJ1tsb2dQbGF5ZXJFZmZlY3RdIE5vIHBvaW50cyB0byBsb2csIHNraXBwaW5nJyk7XHJcbiAgICAgIHJldHVybjtcclxuICAgIH1cclxuICAgIFxyXG4gICAgLy8gR2V0IG1haW4gcGxheWVyIElEIChWMC4xIGNvbnN0YW50KVxyXG4gICAgY29uc3QgbWFpblBsYXllcklkID0gJ1BMQVlFUl9PTkVfSUQnO1xyXG4gICAgXHJcbiAgICBhd2FpdCBhcHBlbmRQbGF5ZXJQb2ludHNMb2coXHJcbiAgICAgIG1haW5QbGF5ZXJJZCxcclxuICAgICAge1xyXG4gICAgICAgIHhwOiB0YXNrLnJld2FyZHMucG9pbnRzLnhwIHx8IDAsXHJcbiAgICAgICAgcnA6IHRhc2sucmV3YXJkcy5wb2ludHMucnAgfHwgMCxcclxuICAgICAgICBmcDogdGFzay5yZXdhcmRzLnBvaW50cy5mcCB8fCAwLFxyXG4gICAgICAgIGhwOiB0YXNrLnJld2FyZHMucG9pbnRzLmhwIHx8IDBcclxuICAgICAgfSxcclxuICAgICAgdGFzay5pZCxcclxuICAgICAgJ3Rhc2snXHJcbiAgICApO1xyXG4gICAgXHJcbiAgICBjb25zb2xlLmxvZyhgW2xvZ1BsYXllckVmZmVjdF0g4pyFIFBsYXllciBlZmZlY3QgbG9nZ2VkIHN1Y2Nlc3NmdWxseSBmb3IgJHt0YXNrLm5hbWV9YCk7XHJcbiAgfSBjYXRjaCAoZXJyb3IpIHtcclxuICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGxvZ2dpbmcgcGxheWVyIGVmZmVjdDonLCBlcnJvcik7XHJcbiAgfVxyXG59XHJcblxyXG4vKipcclxuICogTG9nIHBsYXllciBlZmZlY3QgZnJvbSBmaW5hbmNpYWwgcmVjb3JkXHJcbiAqIFRoaXMgbG9ncyB0aGUgcG9pbnRzIGF3YXJkZWQgdG8gdGhlIHBsYXllciBmcm9tIGEgZmluYW5jaWFsIHJlY29yZFxyXG4gKi9cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGxvZ1BsYXllckVmZmVjdEZyb21SZWNvcmQocmVjb3JkOiBGaW5hbmNpYWxSZWNvcmQpOiBQcm9taXNlPHZvaWQ+IHtcclxuICB0cnkge1xyXG4gICAgY29uc29sZS5sb2coYFtsb2dQbGF5ZXJFZmZlY3RGcm9tUmVjb3JkXSBMb2dnaW5nIHBsYXllciBlZmZlY3QgZm9yIHJlY29yZDogJHtyZWNvcmQubmFtZX0gKCR7cmVjb3JkLmlkfSlgKTtcclxuICAgIFxyXG4gICAgLy8gT25seSBsb2cgaWYgdGhlcmUgYXJlIHBvaW50cyB0byBhd2FyZFxyXG4gICAgY29uc3QgaGFzUG9pbnRzID0gcmVjb3JkLnJld2FyZHM/LnBvaW50cyAmJiAoXHJcbiAgICAgIChyZWNvcmQucmV3YXJkcy5wb2ludHMueHAgfHwgMCkgPiAwIHx8XHJcbiAgICAgIChyZWNvcmQucmV3YXJkcy5wb2ludHMucnAgfHwgMCkgPiAwIHx8XHJcbiAgICAgIChyZWNvcmQucmV3YXJkcy5wb2ludHMuZnAgfHwgMCkgPiAwIHx8XHJcbiAgICAgIChyZWNvcmQucmV3YXJkcy5wb2ludHMuaHAgfHwgMCkgPiAwXHJcbiAgICApO1xyXG4gICAgXHJcbiAgICBpZiAoIWhhc1BvaW50cykge1xyXG4gICAgICBjb25zb2xlLmxvZygnW2xvZ1BsYXllckVmZmVjdEZyb21SZWNvcmRdIE5vIHBvaW50cyB0byBsb2csIHNraXBwaW5nJyk7XHJcbiAgICAgIHJldHVybjtcclxuICAgIH1cclxuICAgIFxyXG4gICAgLy8gR2V0IG1haW4gcGxheWVyIElEIChWMC4xIGNvbnN0YW50KVxyXG4gICAgY29uc3QgbWFpblBsYXllcklkID0gJ1BMQVlFUl9PTkVfSUQnO1xyXG4gICAgXHJcbiAgICBhd2FpdCBhcHBlbmRQbGF5ZXJQb2ludHNMb2coXHJcbiAgICAgIG1haW5QbGF5ZXJJZCxcclxuICAgICAge1xyXG4gICAgICAgIHhwOiByZWNvcmQucmV3YXJkcz8ucG9pbnRzPy54cCB8fCAwLFxyXG4gICAgICAgIHJwOiByZWNvcmQucmV3YXJkcz8ucG9pbnRzPy5ycCB8fCAwLFxyXG4gICAgICAgIGZwOiByZWNvcmQucmV3YXJkcz8ucG9pbnRzPy5mcCB8fCAwLFxyXG4gICAgICAgIGhwOiByZWNvcmQucmV3YXJkcz8ucG9pbnRzPy5ocCB8fCAwXHJcbiAgICAgIH0sXHJcbiAgICAgIHJlY29yZC5pZCxcclxuICAgICAgJ2ZpbmFuY2lhbCdcclxuICAgICk7XHJcbiAgICBcclxuICAgIGNvbnNvbGUubG9nKGBbbG9nUGxheWVyRWZmZWN0RnJvbVJlY29yZF0g4pyFIFBsYXllciBlZmZlY3QgbG9nZ2VkIHN1Y2Nlc3NmdWxseSBmb3IgJHtyZWNvcmQubmFtZX1gKTtcclxuICB9IGNhdGNoIChlcnJvcikge1xyXG4gICAgY29uc29sZS5lcnJvcignRXJyb3IgbG9nZ2luZyBwbGF5ZXIgZWZmZWN0IGZyb20gcmVjb3JkOicsIGVycm9yKTtcclxuICB9XHJcbn1cclxuXHJcbi8qKlxyXG4gKiBMb2cgcGxheWVyIHVwZGF0ZSBmcm9tIHRhc2sgY2hhbmdlc1xyXG4gKiBUaGlzIGxvZ3Mgd2hlbiB0YXNrIHJld2FyZHMgY2hhbmdlIGFuZCBwbGF5ZXIgcG9pbnRzIG5lZWQgdG8gYmUgdXBkYXRlZFxyXG4gKi9cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGxvZ1BsYXllclVwZGF0ZUZyb21UYXNrKHRhc2s6IFRhc2ssIG9sZFRhc2s6IFRhc2spOiBQcm9taXNlPHZvaWQ+IHtcclxuICB0cnkge1xyXG4gICAgY29uc29sZS5sb2coYFtsb2dQbGF5ZXJVcGRhdGVGcm9tVGFza10gTG9nZ2luZyBwbGF5ZXIgdXBkYXRlIGZvciB0YXNrOiAke3Rhc2submFtZX0gKCR7dGFzay5pZH0pYCk7XHJcbiAgICBcclxuICAgIGNvbnN0IG9sZFJld2FyZHMgPSBvbGRUYXNrLnJld2FyZHM/LnBvaW50cyB8fCB7IHhwOiAwLCBycDogMCwgZnA6IDAsIGhwOiAwIH07XHJcbiAgICBjb25zdCBuZXdSZXdhcmRzID0gdGFzay5yZXdhcmRzPy5wb2ludHMgfHwgeyB4cDogMCwgcnA6IDAsIGZwOiAwLCBocDogMCB9O1xyXG4gICAgXHJcbiAgICAvLyBDaGVjayBpZiByZXdhcmRzIGFjdHVhbGx5IGNoYW5nZWRcclxuICAgIGNvbnN0IHJld2FyZHNDaGFuZ2VkID0gSlNPTi5zdHJpbmdpZnkob2xkUmV3YXJkcykgIT09IEpTT04uc3RyaW5naWZ5KG5ld1Jld2FyZHMpO1xyXG4gICAgXHJcbiAgICBpZiAoIXJld2FyZHNDaGFuZ2VkKSB7XHJcbiAgICAgIGNvbnNvbGUubG9nKCdbbG9nUGxheWVyVXBkYXRlRnJvbVRhc2tdIE5vIHJld2FyZCBjaGFuZ2VzIHRvIGxvZywgc2tpcHBpbmcnKTtcclxuICAgICAgcmV0dXJuO1xyXG4gICAgfVxyXG4gICAgXHJcbiAgICAvLyBHZXQgbWFpbiBwbGF5ZXIgSUQgKFYwLjEgY29uc3RhbnQpXHJcbiAgICBjb25zdCBtYWluUGxheWVySWQgPSAnUExBWUVSX09ORV9JRCc7XHJcbiAgICBcclxuICAgIGF3YWl0IGFwcGVuZFBsYXllclBvaW50c1VwZGF0ZUxvZyhcclxuICAgICAgbWFpblBsYXllcklkLFxyXG4gICAgICB7XHJcbiAgICAgICAgeHA6IG9sZFJld2FyZHMueHAgfHwgMCxcclxuICAgICAgICBycDogb2xkUmV3YXJkcy5ycCB8fCAwLFxyXG4gICAgICAgIGZwOiBvbGRSZXdhcmRzLmZwIHx8IDAsXHJcbiAgICAgICAgaHA6IG9sZFJld2FyZHMuaHAgfHwgMFxyXG4gICAgICB9LFxyXG4gICAgICB7XHJcbiAgICAgICAgeHA6IG5ld1Jld2FyZHMueHAgfHwgMCxcclxuICAgICAgICBycDogbmV3UmV3YXJkcy5ycCB8fCAwLFxyXG4gICAgICAgIGZwOiBuZXdSZXdhcmRzLmZwIHx8IDAsXHJcbiAgICAgICAgaHA6IG5ld1Jld2FyZHMuaHAgfHwgMFxyXG4gICAgICB9LFxyXG4gICAgICB0YXNrLmlkXHJcbiAgICApO1xyXG4gICAgXHJcbiAgICBjb25zb2xlLmxvZyhgW2xvZ1BsYXllclVwZGF0ZUZyb21UYXNrXSDinIUgUGxheWVyIHVwZGF0ZSBsb2dnZWQgc3VjY2Vzc2Z1bGx5IGZvciAke3Rhc2submFtZX1gKTtcclxuICB9IGNhdGNoIChlcnJvcikge1xyXG4gICAgY29uc29sZS5lcnJvcignRXJyb3IgbG9nZ2luZyBwbGF5ZXIgdXBkYXRlIGZyb20gdGFzazonLCBlcnJvcik7XHJcbiAgfVxyXG59XHJcblxyXG4vKipcclxuICogVXBkYXRlIHBsYXllciBwb2ludHMgZnJvbSB0YXNrIGNoYW5nZXNcclxuICogVGhpcyB1cGRhdGVzIHRoZSBwbGF5ZXIncyBwb2ludHMgd2hlbiB0YXNrIHJld2FyZHMgY2hhbmdlXHJcbiAqL1xyXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gdXBkYXRlUGxheWVyUG9pbnRzRnJvbVRhc2sodGFzazogVGFzaywgb2xkVGFzazogVGFzayk6IFByb21pc2U8dm9pZD4ge1xyXG4gIHRyeSB7XHJcbiAgICBjb25zb2xlLmxvZyhgW3VwZGF0ZVBsYXllclBvaW50c0Zyb21UYXNrXSBVcGRhdGluZyBwbGF5ZXIgcG9pbnRzIGZvciB0YXNrOiAke3Rhc2submFtZX0gKCR7dGFzay5pZH0pYCk7XHJcbiAgICBcclxuICAgIGNvbnN0IG9sZFJld2FyZHMgPSBvbGRUYXNrLnJld2FyZHM/LnBvaW50cyB8fCB7IHhwOiAwLCBycDogMCwgZnA6IDAsIGhwOiAwIH07XHJcbiAgICBjb25zdCBuZXdSZXdhcmRzID0gdGFzay5yZXdhcmRzPy5wb2ludHMgfHwgeyB4cDogMCwgcnA6IDAsIGZwOiAwLCBocDogMCB9O1xyXG4gICAgXHJcbiAgICAvLyBDYWxjdWxhdGUgcG9pbnQgZGVsdGFcclxuICAgIGNvbnN0IGRlbHRhID0ge1xyXG4gICAgICB4cDogKG5ld1Jld2FyZHMueHAgfHwgMCkgLSAob2xkUmV3YXJkcy54cCB8fCAwKSxcclxuICAgICAgcnA6IChuZXdSZXdhcmRzLnJwIHx8IDApIC0gKG9sZFJld2FyZHMucnAgfHwgMCksXHJcbiAgICAgIGZwOiAobmV3UmV3YXJkcy5mcCB8fCAwKSAtIChvbGRSZXdhcmRzLmZwIHx8IDApLFxyXG4gICAgICBocDogKG5ld1Jld2FyZHMuaHAgfHwgMCkgLSAob2xkUmV3YXJkcy5ocCB8fCAwKVxyXG4gICAgfTtcclxuICAgIFxyXG4gICAgLy8gQ2hlY2sgaWYgdGhlcmUgYXJlIGFueSBjaGFuZ2VzXHJcbiAgICBjb25zdCBoYXNDaGFuZ2VzID0gZGVsdGEueHAgIT09IDAgfHwgZGVsdGEucnAgIT09IDAgfHwgZGVsdGEuZnAgIT09IDAgfHwgZGVsdGEuaHAgIT09IDA7XHJcbiAgICBcclxuICAgIGlmICghaGFzQ2hhbmdlcykge1xyXG4gICAgICBjb25zb2xlLmxvZygnW3VwZGF0ZVBsYXllclBvaW50c0Zyb21UYXNrXSBObyBwb2ludCBjaGFuZ2VzIHRvIGFwcGx5LCBza2lwcGluZycpO1xyXG4gICAgICByZXR1cm47XHJcbiAgICB9XHJcbiAgICBcclxuICAgIC8vIEdldCBtYWluIHBsYXllclxyXG4gICAgY29uc3QgbWFpblBsYXllcklkID0gJ1BMQVlFUl9PTkVfSUQnO1xyXG4gICAgY29uc3QgcGxheWVycyA9IGF3YWl0IENsaWVudEFQSS5nZXRQbGF5ZXJzKCk7XHJcbiAgICBjb25zdCBtYWluUGxheWVyID0gcGxheWVycy5maW5kKHAgPT4gcC5pZCA9PT0gbWFpblBsYXllcklkKTtcclxuICAgIFxyXG4gICAgaWYgKCFtYWluUGxheWVyKSB7XHJcbiAgICAgIGNvbnNvbGUubG9nKCdbdXBkYXRlUGxheWVyUG9pbnRzRnJvbVRhc2tdIE1haW4gcGxheWVyIG5vdCBmb3VuZCwgc2tpcHBpbmcnKTtcclxuICAgICAgcmV0dXJuO1xyXG4gICAgfVxyXG4gICAgXHJcbiAgICAvLyBBcHBseSBkZWx0YSB0byBwbGF5ZXIgcG9pbnRzXHJcbiAgICBjb25zdCB1cGRhdGVkUGxheWVyOiBQbGF5ZXIgPSB7XHJcbiAgICAgIC4uLm1haW5QbGF5ZXIsXHJcbiAgICAgIHBvaW50czoge1xyXG4gICAgICAgIHhwOiBNYXRoLm1heCgwLCAobWFpblBsYXllci5wb2ludHM/LnhwIHx8IDApICsgZGVsdGEueHApLFxyXG4gICAgICAgIHJwOiBNYXRoLm1heCgwLCAobWFpblBsYXllci5wb2ludHM/LnJwIHx8IDApICsgZGVsdGEucnApLFxyXG4gICAgICAgIGZwOiBNYXRoLm1heCgwLCAobWFpblBsYXllci5wb2ludHM/LmZwIHx8IDApICsgZGVsdGEuZnApLFxyXG4gICAgICAgIGhwOiBNYXRoLm1heCgwLCAobWFpblBsYXllci5wb2ludHM/LmhwIHx8IDApICsgZGVsdGEuaHApXHJcbiAgICAgIH0sXHJcbiAgICAgIHRvdGFsUG9pbnRzOiB7XHJcbiAgICAgICAgeHA6IE1hdGgubWF4KDAsIChtYWluUGxheWVyLnRvdGFsUG9pbnRzPy54cCB8fCAwKSArIGRlbHRhLnhwKSxcclxuICAgICAgICBycDogTWF0aC5tYXgoMCwgKG1haW5QbGF5ZXIudG90YWxQb2ludHM/LnJwIHx8IDApICsgZGVsdGEucnApLFxyXG4gICAgICAgIGZwOiBNYXRoLm1heCgwLCAobWFpblBsYXllci50b3RhbFBvaW50cz8uZnAgfHwgMCkgKyBkZWx0YS5mcCksXHJcbiAgICAgICAgaHA6IE1hdGgubWF4KDAsIChtYWluUGxheWVyLnRvdGFsUG9pbnRzPy5ocCB8fCAwKSArIGRlbHRhLmhwKVxyXG4gICAgICB9LFxyXG4gICAgICB1cGRhdGVkQXQ6IG5ldyBEYXRlKClcclxuICAgIH07XHJcbiAgICBcclxuICAgIC8vIFN0b3JlIHRoZSB1cGRhdGVkIHBsYXllclxyXG4gICAgY29uc29sZS5sb2coYFt1cGRhdGVQbGF5ZXJQb2ludHNGcm9tVGFza10gQXBwbHlpbmcgcG9pbnQgZGVsdGE6YCwgZGVsdGEpO1xyXG4gICAgYXdhaXQgQ2xpZW50QVBJLnVwc2VydFBsYXllcih1cGRhdGVkUGxheWVyKTtcclxuICAgIFxyXG4gICAgY29uc29sZS5sb2coYFt1cGRhdGVQbGF5ZXJQb2ludHNGcm9tVGFza10g4pyFIFBsYXllciBwb2ludHMgdXBkYXRlZCBzdWNjZXNzZnVsbHlgKTtcclxuICB9IGNhdGNoIChlcnJvcikge1xyXG4gICAgY29uc29sZS5lcnJvcignRXJyb3IgdXBkYXRpbmcgcGxheWVyIHBvaW50cyBmcm9tIHRhc2s6JywgZXJyb3IpO1xyXG4gIH1cclxufSJdLCJuYW1lcyI6WyJhcHBlbmRFbnRpdHlMb2ciLCJ1cGRhdGVFbnRpdHlMb2dGaWVsZCIsImhhc0VmZmVjdCIsIm1hcmtFZmZlY3QiLCJjbGVhckVmZmVjdCIsImNsZWFyRWZmZWN0c0J5UHJlZml4IiwiQ2xpZW50QVBJIiwiYXBwZW5kUGxheWVyUG9pbnRzTG9nIiwiYXBwZW5kUGxheWVyUG9pbnRzVXBkYXRlTG9nIiwiU1RBVEVfRklFTERTIiwiREVTQ1JJUFRJVkVfRklFTERTIiwib25QbGF5ZXJVcHNlcnQiLCJwbGF5ZXIiLCJwcmV2aW91c1BsYXllciIsImVmZmVjdEtleSIsImlkIiwibmFtZSIsImxldmVsIiwib2xkTGV2ZWwiLCJuZXdMZXZlbCIsInBvaW50c0NoYW5nZWQiLCJKU09OIiwic3RyaW5naWZ5IiwidG90YWxQb2ludHMiLCJwb2ludHMiLCJoYXNTaWduaWZpY2FudENoYW5nZXMiLCJpc0FjdGl2ZSIsImZpZWxkIiwicmVtb3ZlUGxheWVyRWZmZWN0c09uRGVsZXRlIiwicGxheWVySWQiLCJjb25zb2xlIiwibG9nIiwicGxheWVyTGlua3MiLCJnZXRMaW5rc0ZvciIsInR5cGUiLCJsZW5ndGgiLCJsaW5rIiwicmVtb3ZlTGluayIsImxpbmtUeXBlIiwiZXJyb3IiLCJyZXN1bHQiLCJyZW1vdmVMb2dFbnRyeSIsInN1Y2Nlc3MiLCJtZXNzYWdlIiwibG9nUGxheWVyRWZmZWN0IiwidGFzayIsImhhc1BvaW50cyIsInJld2FyZHMiLCJ4cCIsInJwIiwiZnAiLCJocCIsIm1haW5QbGF5ZXJJZCIsImxvZ1BsYXllckVmZmVjdEZyb21SZWNvcmQiLCJyZWNvcmQiLCJsb2dQbGF5ZXJVcGRhdGVGcm9tVGFzayIsIm9sZFRhc2siLCJvbGRSZXdhcmRzIiwibmV3UmV3YXJkcyIsInJld2FyZHNDaGFuZ2VkIiwidXBkYXRlUGxheWVyUG9pbnRzRnJvbVRhc2siLCJtYWluUGxheWVyIiwiZGVsdGEiLCJoYXNDaGFuZ2VzIiwicGxheWVycyIsImdldFBsYXllcnMiLCJmaW5kIiwicCIsInVwZGF0ZWRQbGF5ZXIiLCJNYXRoIiwibWF4IiwidXBkYXRlZEF0IiwiRGF0ZSIsInVwc2VydFBsYXllciJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(app-pages-browser)/./workflows/entities-workflows/player.workflow.ts\n"));

/***/ }),

/***/ "(app-pages-browser)/./workflows/entities-workflows/sale.workflow.ts":
/*!*******************************************************!*\
  !*** ./workflows/entities-workflows/sale.workflow.ts ***!
  \*******************************************************/
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval(__webpack_require__.ts("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   onSaleUpsert: function() { return /* binding */ onSaleUpsert; },\n/* harmony export */   removeSaleEffectsOnDelete: function() { return /* binding */ removeSaleEffectsOnDelete; }\n/* harmony export */ });\n/* harmony import */ var _entities_logging__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../entities-logging */ \"(app-pages-browser)/./workflows/entities-logging.ts\");\n/* harmony import */ var _data_store_effects_registry__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @/data-store/effects-registry */ \"(app-pages-browser)/./data-store/effects-registry.ts\");\n/* harmony import */ var _lib_client_api__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @/lib/client-api */ \"(app-pages-browser)/./lib/client-api.ts\");\n/* harmony import */ var _points_rewards_utils__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../points-rewards-utils */ \"(app-pages-browser)/./workflows/points-rewards-utils.ts\");\n/* harmony import */ var _sale_line_utils__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../sale-line-utils */ \"(app-pages-browser)/./workflows/sale-line-utils.ts\");\n/* harmony import */ var _update_propagation_utils__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../update-propagation-utils */ \"(app-pages-browser)/./workflows/update-propagation-utils.ts\");\n// workflows/entities-workflows/sale.workflow.ts\n// Sale-specific workflow with CHARGED, CANCELLED, COLLECTED events\n\n\n\n\n\n\nconst STATE_FIELDS = [\n    \"status\",\n    \"isNotPaid\",\n    \"isNotCharged\",\n    \"isCollected\",\n    \"postedAt\",\n    \"doneAt\",\n    \"cancelledAt\"\n];\nconst DESCRIPTIVE_FIELDS = [\n    \"counterpartyName\",\n    \"totals\"\n];\nasync function onSaleUpsert(sale, previousSale) {\n    // New sale creation\n    if (!previousSale) {\n        const effectKey = \"sale:\".concat(sale.id, \":created\");\n        if (await (0,_data_store_effects_registry__WEBPACK_IMPORTED_MODULE_1__.hasEffect)(effectKey)) return;\n        await (0,_entities_logging__WEBPACK_IMPORTED_MODULE_0__.appendEntityLog)(\"sale\", sale.id, \"CREATED\", {\n            type: sale.type,\n            status: sale.status,\n            counterpartyName: sale.counterpartyName,\n            totalRevenue: sale.totals.totalRevenue\n        });\n        await (0,_data_store_effects_registry__WEBPACK_IMPORTED_MODULE_1__.markEffect)(effectKey);\n        // Points awarding - on sale creation with revenue\n        if (sale.totals.totalRevenue > 0) {\n            const pointsEffectKey = \"sale:\".concat(sale.id, \":pointsAwarded\");\n            if (!await (0,_data_store_effects_registry__WEBPACK_IMPORTED_MODULE_1__.hasEffect)(pointsEffectKey)) {\n                console.log(\"[onSaleUpsert] Awarding points from sale revenue: \".concat(sale.counterpartyName));\n                const points = (0,_points_rewards_utils__WEBPACK_IMPORTED_MODULE_3__.calculatePointsFromRevenue)(sale.totals.totalRevenue);\n                await (0,_points_rewards_utils__WEBPACK_IMPORTED_MODULE_3__.awardPointsToPlayer)((0,_points_rewards_utils__WEBPACK_IMPORTED_MODULE_3__.getMainPlayerId)(), points, sale.id, \"sale\");\n                await (0,_data_store_effects_registry__WEBPACK_IMPORTED_MODULE_1__.markEffect)(pointsEffectKey);\n                console.log(\"[onSaleUpsert]  Points awarded and effect marked for sale: \".concat(sale.counterpartyName));\n            }\n        }\n        return;\n    }\n    // Status changes\n    if (previousSale.status !== sale.status) {\n        if (sale.status === \"CHARGED\") {\n            await (0,_entities_logging__WEBPACK_IMPORTED_MODULE_0__.appendEntityLog)(\"sale\", sale.id, \"CHARGED\", {\n                counterpartyName: sale.counterpartyName,\n                totalRevenue: sale.totals.totalRevenue,\n                chargedAt: new Date().toISOString()\n            });\n            // Process sale lines when sale is charged\n            const linesProcessedKey = \"sale:\".concat(sale.id, \":linesProcessed\");\n            if (!await (0,_data_store_effects_registry__WEBPACK_IMPORTED_MODULE_1__.hasEffect)(linesProcessedKey)) {\n                console.log(\"[onSaleUpsert] Processing sale lines for charged sale: \".concat(sale.counterpartyName));\n                await (0,_sale_line_utils__WEBPACK_IMPORTED_MODULE_4__.processSaleLines)(sale);\n                await (0,_data_store_effects_registry__WEBPACK_IMPORTED_MODULE_1__.markEffect)(linesProcessedKey);\n                console.log(\"[onSaleUpsert]  Sale lines processed and effect marked: \".concat(sale.counterpartyName));\n            }\n        } else if (sale.status === \"CANCELLED\") {\n            await (0,_entities_logging__WEBPACK_IMPORTED_MODULE_0__.appendEntityLog)(\"sale\", sale.id, \"CANCELLED\", {\n                counterpartyName: sale.counterpartyName,\n                cancelledAt: sale.cancelledAt || new Date().toISOString()\n            });\n        }\n    }\n    // Collection status - COLLECTED event\n    if (!previousSale.isCollected && sale.isCollected) {\n        await (0,_entities_logging__WEBPACK_IMPORTED_MODULE_0__.appendEntityLog)(\"sale\", sale.id, \"COLLECTED\", {\n            counterpartyName: sale.counterpartyName,\n            collectedAt: new Date().toISOString()\n        });\n    }\n    // COMPREHENSIVE UPDATE PROPAGATION - when sale properties change\n    if (previousSale) {\n        // Propagate to Financial Records\n        if ((0,_update_propagation_utils__WEBPACK_IMPORTED_MODULE_5__.hasRevenueChanged)(sale, previousSale)) {\n            console.log(\"[onSaleUpsert] Propagating revenue changes to financial records: \".concat(sale.counterpartyName));\n            await (0,_update_propagation_utils__WEBPACK_IMPORTED_MODULE_5__.updateFinancialRecordsFromSale)(sale, previousSale);\n        }\n        // Propagate to Items (stock updates)\n        if ((0,_update_propagation_utils__WEBPACK_IMPORTED_MODULE_5__.hasLinesChanged)(sale, previousSale)) {\n            console.log(\"[onSaleUpsert] Propagating line changes to items: \".concat(sale.counterpartyName));\n            await (0,_update_propagation_utils__WEBPACK_IMPORTED_MODULE_5__.updateItemsFromSale)(sale, previousSale);\n        }\n        // Propagate to Player (points delta from revenue)\n        if ((0,_update_propagation_utils__WEBPACK_IMPORTED_MODULE_5__.hasRevenueChanged)(sale, previousSale)) {\n            console.log(\"[onSaleUpsert] Propagating revenue changes to player points: \".concat(sale.counterpartyName));\n            await (0,_update_propagation_utils__WEBPACK_IMPORTED_MODULE_5__.updatePlayerPointsFromSource)(\"sale\", sale, previousSale);\n        }\n    }\n    // Descriptive changes - update in-place\n    for (const field of DESCRIPTIVE_FIELDS){\n        if (previousSale[field] !== sale[field]) {\n            await (0,_entities_logging__WEBPACK_IMPORTED_MODULE_0__.updateEntityLogField)(\"sale\", sale.id, field, previousSale[field], sale[field]);\n        }\n    }\n}\n/**\r\n * Remove sale effects when sale is deleted\r\n * Sales can have entries in multiple logs: sales, financials, character, items\r\n */ async function removeSaleEffectsOnDelete(saleId) {\n    try {\n        console.log(\"[removeSaleEffectsOnDelete] Starting cleanup for sale: \".concat(saleId));\n        // 1. Remove player points that were awarded by this sale (if points were badly given)\n        await removePlayerPointsFromSale(saleId);\n        // 2. Remove all Links related to this sale\n        const saleLinks = await _lib_client_api__WEBPACK_IMPORTED_MODULE_2__.ClientAPI.getLinksFor({\n            type: \"sale\",\n            id: saleId\n        });\n        console.log(\"[removeSaleEffectsOnDelete] Found \".concat(saleLinks.length, \" links to remove\"));\n        for (const link of saleLinks){\n            try {\n                await _lib_client_api__WEBPACK_IMPORTED_MODULE_2__.ClientAPI.removeLink(link.id);\n                console.log(\"[removeSaleEffectsOnDelete]  Removed link: \".concat(link.linkType));\n            } catch (error) {\n                console.error(\"[removeSaleEffectsOnDelete]  Failed to remove link \".concat(link.id, \":\"), error);\n            }\n        }\n        // 3. Clear effects registry\n        await (0,_data_store_effects_registry__WEBPACK_IMPORTED_MODULE_1__.clearEffectsByPrefix)(\"sale\", saleId, \"sale:\");\n        await (0,_data_store_effects_registry__WEBPACK_IMPORTED_MODULE_1__.clearEffectsByPrefix)(\"sale\", saleId, \"pointsAwarded:\");\n        // 4. Remove log entries from all relevant logs\n        console.log(\"[removeSaleEffectsOnDelete] Starting log entry removal for sale: \".concat(saleId));\n        const removals = await Promise.all([\n            _lib_client_api__WEBPACK_IMPORTED_MODULE_2__.ClientAPI.removeLogEntry(\"sales\", saleId).then((r)=>{\n                console.log(\"[removeSaleEffectsOnDelete] Sales log removal result:\", r);\n                return r;\n            }).catch((e)=>({\n                    success: false,\n                    message: String(e)\n                })),\n            _lib_client_api__WEBPACK_IMPORTED_MODULE_2__.ClientAPI.removeLogEntry(\"financials\", saleId).then((r)=>{\n                console.log(\"[removeSaleEffectsOnDelete] Financials log removal result:\", r);\n                return r;\n            }).catch((e)=>({\n                    success: false,\n                    message: String(e)\n                })),\n            _lib_client_api__WEBPACK_IMPORTED_MODULE_2__.ClientAPI.removeLogEntry(\"character\", saleId).then((r)=>{\n                console.log(\"[removeSaleEffectsOnDelete] Character log removal result:\", r);\n                return r;\n            }).catch((e)=>({\n                    success: false,\n                    message: String(e)\n                })),\n            _lib_client_api__WEBPACK_IMPORTED_MODULE_2__.ClientAPI.removeLogEntry(\"items\", saleId).then((r)=>{\n                console.log(\"[removeSaleEffectsOnDelete] Items log removal result:\", r);\n                return r;\n            }).catch((e)=>({\n                    success: false,\n                    message: String(e)\n                }))\n        ]);\n        console.log(\"[removeSaleEffectsOnDelete] All removal results:\", removals);\n        const failed = removals.filter((r)=>!r.success);\n        if (failed.length > 0) {\n            console.error(\"[removeSaleEffectsOnDelete] Some log removals failed:\", failed);\n        } else {\n            console.log(\"[removeSaleEffectsOnDelete]  All log entries removed successfully for sale: \".concat(saleId));\n        }\n        console.log(\"[removeSaleEffectsOnDelete]  Cleared effects, removed links, and removed log entries for sale \".concat(saleId));\n    } catch (error) {\n        console.error(\"Error removing sale effects:\", error);\n    }\n}\n/**\r\n * Remove player points that were awarded by a specific sale\r\n * This is used when rolling back a sale that incorrectly awarded points\r\n */ async function removePlayerPointsFromSale(saleId) {\n    try {\n        console.log(\"[removePlayerPointsFromSale] Removing points for sale: \".concat(saleId));\n        // Get the sale to find what points were awarded\n        const sales = await _lib_client_api__WEBPACK_IMPORTED_MODULE_2__.ClientAPI.getSales();\n        const sale = sales.find((s)=>s.id === saleId);\n        if (!sale || sale.totals.totalRevenue <= 0) {\n            console.log(\"[removePlayerPointsFromSale] Sale \".concat(saleId, \" has no revenue to remove points from\"));\n            return;\n        }\n        // Get the main player\n        const mainPlayerId = (0,_points_rewards_utils__WEBPACK_IMPORTED_MODULE_3__.getMainPlayerId)();\n        const players = await _lib_client_api__WEBPACK_IMPORTED_MODULE_2__.ClientAPI.getPlayers();\n        const mainPlayer = players.find((p)=>p.id === mainPlayerId);\n        if (!mainPlayer) {\n            console.log(\"[removePlayerPointsFromSale] Main player not found, skipping points removal\");\n            return;\n        }\n        // Calculate points to remove based on sale revenue (1 Point = $100)\n        const pointsToRemove = (0,_points_rewards_utils__WEBPACK_IMPORTED_MODULE_3__.calculatePointsFromRevenue)(sale.totals.totalRevenue);\n        // Check if any points were actually awarded\n        const hasPoints = (pointsToRemove.xp || 0) > 0 || (pointsToRemove.rp || 0) > 0 || (pointsToRemove.fp || 0) > 0 || (pointsToRemove.hp || 0) > 0;\n        if (!hasPoints) {\n            console.log(\"[removePlayerPointsFromSale] No points to remove from sale \".concat(saleId, \" (revenue: \").concat(sale.totals.totalRevenue, \")\"));\n            return;\n        }\n        // Remove the points from the player\n        await (0,_points_rewards_utils__WEBPACK_IMPORTED_MODULE_3__.removePointsFromPlayer)(mainPlayerId, pointsToRemove);\n        console.log(\"[removePlayerPointsFromSale]  Removed points from player: \".concat(JSON.stringify(pointsToRemove), \" (sale revenue: \").concat(sale.totals.totalRevenue, \")\"));\n    } catch (error) {\n        console.error(\"[removePlayerPointsFromSale]  Failed to remove player points for sale \".concat(saleId, \":\"), error);\n    }\n}\n\n\n;\n    // Wrapped in an IIFE to avoid polluting the global scope\n    ;\n    (function () {\n        var _a, _b;\n        // Legacy CSS implementations will `eval` browser code in a Node.js context\n        // to extract CSS. For backwards compatibility, we need to check we're in a\n        // browser context before continuing.\n        if (typeof self !== 'undefined' &&\n            // AMP / No-JS mode does not inject these helpers:\n            '$RefreshHelpers$' in self) {\n            // @ts-ignore __webpack_module__ is global\n            var currentExports = module.exports;\n            // @ts-ignore __webpack_module__ is global\n            var prevSignature = (_b = (_a = module.hot.data) === null || _a === void 0 ? void 0 : _a.prevSignature) !== null && _b !== void 0 ? _b : null;\n            // This cannot happen in MainTemplate because the exports mismatch between\n            // templating and execution.\n            self.$RefreshHelpers$.registerExportsForReactRefresh(currentExports, module.id);\n            // A module can be accepted automatically based on its exports, e.g. when\n            // it is a Refresh Boundary.\n            if (self.$RefreshHelpers$.isReactRefreshBoundary(currentExports)) {\n                // Save the previous exports signature on update so we can compare the boundary\n                // signatures. We avoid saving exports themselves since it causes memory leaks (https://github.com/vercel/next.js/pull/53797)\n                module.hot.dispose(function (data) {\n                    data.prevSignature =\n                        self.$RefreshHelpers$.getRefreshBoundarySignature(currentExports);\n                });\n                // Unconditionally accept an update to this module, we'll check if it's\n                // still a Refresh Boundary later.\n                // @ts-ignore importMeta is replaced in the loader\n                module.hot.accept();\n                // This field is set when the previous version of this module was a\n                // Refresh Boundary, letting us know we need to check for invalidation or\n                // enqueue an update.\n                if (prevSignature !== null) {\n                    // A boundary can become ineligible if its exports are incompatible\n                    // with the previous exports.\n                    //\n                    // For example, if you add/remove/change exports, we'll want to\n                    // re-execute the importing modules, and force those components to\n                    // re-render. Similarly, if you convert a class component to a\n                    // function, we want to invalidate the boundary.\n                    if (self.$RefreshHelpers$.shouldInvalidateReactRefreshBoundary(prevSignature, self.$RefreshHelpers$.getRefreshBoundarySignature(currentExports))) {\n                        module.hot.invalidate();\n                    }\n                    else {\n                        self.$RefreshHelpers$.scheduleUpdate();\n                    }\n                }\n            }\n            else {\n                // Since we just executed the code for the module, it's possible that the\n                // new exports made it ineligible for being a boundary.\n                // We only care about the case when we were _previously_ a boundary,\n                // because we already accepted this update (accidental side effect).\n                var isNoLongerABoundary = prevSignature !== null;\n                if (isNoLongerABoundary) {\n                    module.hot.invalidate();\n                }\n            }\n        }\n    })();\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFwcC1wYWdlcy1icm93c2VyKS8uL3dvcmtmbG93cy9lbnRpdGllcy13b3JrZmxvd3Mvc2FsZS53b3JrZmxvdy50cyIsIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7OztBQUFBLGdEQUFnRDtBQUNoRCxtRUFBbUU7QUFHUztBQUNnQjtBQUMvQztBQUNzRjtBQUM3RTtBQU9qQjtBQUVyQyxNQUFNZ0IsZUFBZTtJQUFDO0lBQVU7SUFBYTtJQUFnQjtJQUFlO0lBQVk7SUFBVTtDQUFjO0FBQ2hILE1BQU1DLHFCQUFxQjtJQUFDO0lBQW9CO0NBQVM7QUFFbEQsZUFBZUMsYUFBYUMsSUFBVSxFQUFFQyxZQUFtQjtJQUNoRSxvQkFBb0I7SUFDcEIsSUFBSSxDQUFDQSxjQUFjO1FBQ2pCLE1BQU1DLFlBQVksUUFBZ0IsT0FBUkYsS0FBS0csRUFBRSxFQUFDO1FBQ2xDLElBQUksTUFBTXBCLHVFQUFTQSxDQUFDbUIsWUFBWTtRQUVoQyxNQUFNckIsa0VBQWVBLENBQUMsUUFBUW1CLEtBQUtHLEVBQUUsRUFBRSxXQUFXO1lBQ2hEQyxNQUFNSixLQUFLSSxJQUFJO1lBQ2ZDLFFBQVFMLEtBQUtLLE1BQU07WUFDbkJDLGtCQUFrQk4sS0FBS00sZ0JBQWdCO1lBQ3ZDQyxjQUFjUCxLQUFLUSxNQUFNLENBQUNELFlBQVk7UUFDeEM7UUFDQSxNQUFNdkIsd0VBQVVBLENBQUNrQjtRQUVqQixrREFBa0Q7UUFDbEQsSUFBSUYsS0FBS1EsTUFBTSxDQUFDRCxZQUFZLEdBQUcsR0FBRztZQUNoQyxNQUFNRSxrQkFBa0IsUUFBZ0IsT0FBUlQsS0FBS0csRUFBRSxFQUFDO1lBQ3hDLElBQUksQ0FBRSxNQUFNcEIsdUVBQVNBLENBQUMwQixrQkFBbUI7Z0JBQ3ZDQyxRQUFRQyxHQUFHLENBQUMscURBQTJFLE9BQXRCWCxLQUFLTSxnQkFBZ0I7Z0JBQ3RGLE1BQU1NLFNBQVN2QixpRkFBMEJBLENBQUNXLEtBQUtRLE1BQU0sQ0FBQ0QsWUFBWTtnQkFDbEUsTUFBTXBCLDBFQUFtQkEsQ0FBQ0csc0VB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cy9lbnRpdGllcy13b3JrZmxvd3Mvc2FsZS53b3JrZmxvdy50cz8yZjQ4Il0sInNvdXJjZXNDb250ZW50IjpbIi8vIHdvcmtmbG93cy9lbnRpdGllcy13b3JrZmxvd3Mvc2FsZS53b3JrZmxvdy50c1xyXG4vLyBTYWxlLXNwZWNpZmljIHdvcmtmbG93IHdpdGggQ0hBUkdFRCwgQ0FOQ0VMTEVELCBDT0xMRUNURUQgZXZlbnRzXHJcblxyXG5pbXBvcnQgdHlwZSB7IFNhbGUgfSBmcm9tICdAL3R5cGVzL2VudGl0aWVzJztcclxuaW1wb3J0IHsgYXBwZW5kRW50aXR5TG9nLCB1cGRhdGVFbnRpdHlMb2dGaWVsZCB9IGZyb20gJy4uL2VudGl0aWVzLWxvZ2dpbmcnO1xyXG5pbXBvcnQgeyBoYXNFZmZlY3QsIG1hcmtFZmZlY3QsIGNsZWFyRWZmZWN0c0J5UHJlZml4IH0gZnJvbSAnQC9kYXRhLXN0b3JlL2VmZmVjdHMtcmVnaXN0cnknO1xyXG5pbXBvcnQgeyBDbGllbnRBUEkgfSBmcm9tICdAL2xpYi9jbGllbnQtYXBpJztcclxuaW1wb3J0IHsgYXdhcmRQb2ludHNUb1BsYXllciwgcmVtb3ZlUG9pbnRzRnJvbVBsYXllciwgY2FsY3VsYXRlUG9pbnRzRnJvbVJldmVudWUsIGdldE1haW5QbGF5ZXJJZCB9IGZyb20gJy4uL3BvaW50cy1yZXdhcmRzLXV0aWxzJztcclxuaW1wb3J0IHsgcHJvY2Vzc1NhbGVMaW5lcyB9IGZyb20gJy4uL3NhbGUtbGluZS11dGlscyc7XHJcbmltcG9ydCB7IFxyXG4gIHVwZGF0ZUZpbmFuY2lhbFJlY29yZHNGcm9tU2FsZSwgXHJcbiAgdXBkYXRlSXRlbXNGcm9tU2FsZSwgXHJcbiAgdXBkYXRlUGxheWVyUG9pbnRzRnJvbVNvdXJjZSxcclxuICBoYXNSZXZlbnVlQ2hhbmdlZCxcclxuICBoYXNMaW5lc0NoYW5nZWRcclxufSBmcm9tICcuLi91cGRhdGUtcHJvcGFnYXRpb24tdXRpbHMnO1xyXG5cclxuY29uc3QgU1RBVEVfRklFTERTID0gWydzdGF0dXMnLCAnaXNOb3RQYWlkJywgJ2lzTm90Q2hhcmdlZCcsICdpc0NvbGxlY3RlZCcsICdwb3N0ZWRBdCcsICdkb25lQXQnLCAnY2FuY2VsbGVkQXQnXTtcclxuY29uc3QgREVTQ1JJUFRJVkVfRklFTERTID0gWydjb3VudGVycGFydHlOYW1lJywgJ3RvdGFscyddO1xyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIG9uU2FsZVVwc2VydChzYWxlOiBTYWxlLCBwcmV2aW91c1NhbGU/OiBTYWxlKTogUHJvbWlzZTx2b2lkPiB7XHJcbiAgLy8gTmV3IHNhbGUgY3JlYXRpb25cclxuICBpZiAoIXByZXZpb3VzU2FsZSkge1xyXG4gICAgY29uc3QgZWZmZWN0S2V5ID0gYHNhbGU6JHtzYWxlLmlkfTpjcmVhdGVkYDtcclxuICAgIGlmIChhd2FpdCBoYXNFZmZlY3QoZWZmZWN0S2V5KSkgcmV0dXJuO1xyXG4gICAgXHJcbiAgICBhd2FpdCBhcHBlbmRFbnRpdHlMb2coJ3NhbGUnLCBzYWxlLmlkLCAnQ1JFQVRFRCcsIHsgXHJcbiAgICAgIHR5cGU6IHNhbGUudHlwZSxcclxuICAgICAgc3RhdHVzOiBzYWxlLnN0YXR1cyxcclxuICAgICAgY291bnRlcnBhcnR5TmFtZTogc2FsZS5jb3VudGVycGFydHlOYW1lLFxyXG4gICAgICB0b3RhbFJldmVudWU6IHNhbGUudG90YWxzLnRvdGFsUmV2ZW51ZVxyXG4gICAgfSk7XHJcbiAgICBhd2FpdCBtYXJrRWZmZWN0KGVmZmVjdEtleSk7XHJcbiAgICBcclxuICAgIC8vIFBvaW50cyBhd2FyZGluZyAtIG9uIHNhbGUgY3JlYXRpb24gd2l0aCByZXZlbnVlXHJcbiAgICBpZiAoc2FsZS50b3RhbHMudG90YWxSZXZlbnVlID4gMCkge1xyXG4gICAgICBjb25zdCBwb2ludHNFZmZlY3RLZXkgPSBgc2FsZToke3NhbGUuaWR9OnBvaW50c0F3YXJkZWRgO1xyXG4gICAgICBpZiAoIShhd2FpdCBoYXNFZmZlY3QocG9pbnRzRWZmZWN0S2V5KSkpIHtcclxuICAgICAgICBjb25zb2xlLmxvZyhgW29uU2FsZVVwc2VydF0gQXdhcmRpbmcgcG9pbnRzIGZyb20gc2FsZSByZXZlbnVlOiAke3NhbGUuY291bnRlcnBhcnR5TmFtZX1gKTtcclxuICAgICAgICBjb25zdCBwb2ludHMgPSBjYWxjdWxhdGVQb2ludHNGcm9tUmV2ZW51ZShzYWxlLnRvdGFscy50b3RhbFJldmVudWUpO1xyXG4gICAgICAgIGF3YWl0IGF3YXJkUG9pbnRzVG9QbGF5ZXIoZ2V0TWFpblBsYXllcklkKCksIHBvaW50cywgc2FsZS5pZCwgJ3NhbGUnKTtcclxuICAgICAgICBhd2FpdCBtYXJrRWZmZWN0KHBvaW50c0VmZmVjdEtleSk7XHJcbiAgICAgICAgY29uc29sZS5sb2coYFtvblNhbGVVcHNlcnRdIOKchSBQb2ludHMgYXdhcmRlZCBhbmQgZWZmZWN0IG1hcmtlZCBmb3Igc2FsZTogJHtzYWxlLmNvdW50ZXJwYXJ0eU5hbWV9YCk7XHJcbiAgICAgIH1cclxuICAgIH1cclxuICAgIFxyXG4gICAgcmV0dXJuO1xyXG4gIH1cclxuICBcclxuICAvLyBTdGF0dXMgY2hhbmdlc1xyXG4gIGlmIChwcmV2aW91c1NhbGUuc3RhdHVzICE9PSBzYWxlLnN0YXR1cykge1xyXG4gICAgaWYgKHNhbGUuc3RhdHVzID09PSAnQ0hBUkdFRCcpIHtcclxuICAgICAgYXdhaXQgYXBwZW5kRW50aXR5TG9nKCdzYWxlJywgc2FsZS5pZCwgJ0NIQVJHRUQnLCB7XHJcbiAgICAgICAgY291bnRlcnBhcnR5TmFtZTogc2FsZS5jb3VudGVycGFydHlOYW1lLFxyXG4gICAgICAgIHRvdGFsUmV2ZW51ZTogc2FsZS50b3RhbHMudG90YWxSZXZlbnVlLFxyXG4gICAgICAgIGNoYXJnZWRBdDogbmV3IERhdGUoKS50b0lTT1N0cmluZygpXHJcbiAgICAgIH0pO1xyXG4gICAgICBcclxuICAgICAgLy8gUHJvY2VzcyBzYWxlIGxpbmVzIHdoZW4gc2FsZSBpcyBjaGFyZ2VkXHJcbiAgICAgIGNvbnN0IGxpbmVzUHJvY2Vzc2VkS2V5ID0gYHNhbGU6JHtzYWxlLmlkfTpsaW5lc1Byb2Nlc3NlZGA7XHJcbiAgICAgIGlmICghKGF3YWl0IGhhc0VmZmVjdChsaW5lc1Byb2Nlc3NlZEtleSkpKSB7XHJcbiAgICAgICAgY29uc29sZS5sb2coYFtvblNhbGVVcHNlcnRdIFByb2Nlc3Npbmcgc2FsZSBsaW5lcyBmb3IgY2hhcmdlZCBzYWxlOiAke3NhbGUuY291bnRlcnBhcnR5TmFtZX1gKTtcclxuICAgICAgICBhd2FpdCBwcm9jZXNzU2FsZUxpbmVzKHNhbGUpO1xyXG4gICAgICAgIGF3YWl0IG1hcmtFZmZlY3QobGluZXNQcm9jZXNzZWRLZXkpO1xyXG4gICAgICAgIGNvbnNvbGUubG9nKGBbb25TYWxlVXBzZXJ0XSDinIUgU2FsZSBsaW5lcyBwcm9jZXNzZWQgYW5kIGVmZmVjdCBtYXJrZWQ6ICR7c2FsZS5jb3VudGVycGFydHlOYW1lfWApO1xyXG4gICAgICB9XHJcbiAgICB9IGVsc2UgaWYgKHNhbGUuc3RhdHVzID09PSAnQ0FOQ0VMTEVEJykge1xyXG4gICAgICBhd2FpdCBhcHBlbmRFbnRpdHlMb2coJ3NhbGUnLCBzYWxlLmlkLCAnQ0FOQ0VMTEVEJywge1xyXG4gICAgICAgIGNvdW50ZXJwYXJ0eU5hbWU6IHNhbGUuY291bnRlcnBhcnR5TmFtZSxcclxuICAgICAgICBjYW5jZWxsZWRBdDogc2FsZS5jYW5jZWxsZWRBdCB8fCBuZXcgRGF0ZSgpLnRvSVNPU3RyaW5nKClcclxuICAgICAgfSk7XHJcbiAgICB9XHJcbiAgfVxyXG4gIFxyXG4gIC8vIENvbGxlY3Rpb24gc3RhdHVzIC0gQ09MTEVDVEVEIGV2ZW50XHJcbiAgaWYgKCFwcmV2aW91c1NhbGUuaXNDb2xsZWN0ZWQgJiYgc2FsZS5pc0NvbGxlY3RlZCkge1xyXG4gICAgYXdhaXQgYXBwZW5kRW50aXR5TG9nKCdzYWxlJywgc2FsZS5pZCwgJ0NPTExFQ1RFRCcsIHtcclxuICAgICAgY291bnRlcnBhcnR5TmFtZTogc2FsZS5jb3VudGVycGFydHlOYW1lLFxyXG4gICAgICBjb2xsZWN0ZWRBdDogbmV3IERhdGUoKS50b0lTT1N0cmluZygpXHJcbiAgICB9KTtcclxuICB9XHJcbiAgXHJcbiAgLy8gQ09NUFJFSEVOU0lWRSBVUERBVEUgUFJPUEFHQVRJT04gLSB3aGVuIHNhbGUgcHJvcGVydGllcyBjaGFuZ2VcclxuICBpZiAocHJldmlvdXNTYWxlKSB7XHJcbiAgICAvLyBQcm9wYWdhdGUgdG8gRmluYW5jaWFsIFJlY29yZHNcclxuICAgIGlmIChoYXNSZXZlbnVlQ2hhbmdlZChzYWxlLCBwcmV2aW91c1NhbGUpKSB7XHJcbiAgICAgIGNvbnNvbGUubG9nKGBbb25TYWxlVXBzZXJ0XSBQcm9wYWdhdGluZyByZXZlbnVlIGNoYW5nZXMgdG8gZmluYW5jaWFsIHJlY29yZHM6ICR7c2FsZS5jb3VudGVycGFydHlOYW1lfWApO1xyXG4gICAgICBhd2FpdCB1cGRhdGVGaW5hbmNpYWxSZWNvcmRzRnJvbVNhbGUoc2FsZSwgcHJldmlvdXNTYWxlKTtcclxuICAgIH1cclxuICAgIFxyXG4gICAgLy8gUHJvcGFnYXRlIHRvIEl0ZW1zIChzdG9jayB1cGRhdGVzKVxyXG4gICAgaWYgKGhhc0xpbmVzQ2hhbmdlZChzYWxlLCBwcmV2aW91c1NhbGUpKSB7XHJcbiAgICAgIGNvbnNvbGUubG9nKGBbb25TYWxlVXBzZXJ0XSBQcm9wYWdhdGluZyBsaW5lIGNoYW5nZXMgdG8gaXRlbXM6ICR7c2FsZS5jb3VudGVycGFydHlOYW1lfWApO1xyXG4gICAgICBhd2FpdCB1cGRhdGVJdGVtc0Zyb21TYWxlKHNhbGUsIHByZXZpb3VzU2FsZSk7XHJcbiAgICB9XHJcbiAgICBcclxuICAgIC8vIFByb3BhZ2F0ZSB0byBQbGF5ZXIgKHBvaW50cyBkZWx0YSBmcm9tIHJldmVudWUpXHJcbiAgICBpZiAoaGFzUmV2ZW51ZUNoYW5nZWQoc2FsZSwgcHJldmlvdXNTYWxlKSkge1xyXG4gICAgICBjb25zb2xlLmxvZyhgW29uU2FsZVVwc2VydF0gUHJvcGFnYXRpbmcgcmV2ZW51ZSBjaGFuZ2VzIHRvIHBsYXllciBwb2ludHM6ICR7c2FsZS5jb3VudGVycGFydHlOYW1lfWApO1xyXG4gICAgICBhd2FpdCB1cGRhdGVQbGF5ZXJQb2ludHNGcm9tU291cmNlKCdzYWxlJywgc2FsZSwgcHJldmlvdXNTYWxlKTtcclxuICAgIH1cclxuICB9XHJcbiAgXHJcbiAgLy8gRGVzY3JpcHRpdmUgY2hhbmdlcyAtIHVwZGF0ZSBpbi1wbGFjZVxyXG4gIGZvciAoY29uc3QgZmllbGQgb2YgREVTQ1JJUFRJVkVfRklFTERTKSB7XHJcbiAgICBpZiAoKHByZXZpb3VzU2FsZSBhcyBhbnkpW2ZpZWxkXSAhPT0gKHNhbGUgYXMgYW55KVtmaWVsZF0pIHtcclxuICAgICAgYXdhaXQgdXBkYXRlRW50aXR5TG9nRmllbGQoJ3NhbGUnLCBzYWxlLmlkLCBmaWVsZCwgKHByZXZpb3VzU2FsZSBhcyBhbnkpW2ZpZWxkXSwgKHNhbGUgYXMgYW55KVtmaWVsZF0pO1xyXG4gICAgfVxyXG4gIH1cclxufVxyXG5cclxuLyoqXHJcbiAqIFJlbW92ZSBzYWxlIGVmZmVjdHMgd2hlbiBzYWxlIGlzIGRlbGV0ZWRcclxuICogU2FsZXMgY2FuIGhhdmUgZW50cmllcyBpbiBtdWx0aXBsZSBsb2dzOiBzYWxlcywgZmluYW5jaWFscywgY2hhcmFjdGVyLCBpdGVtc1xyXG4gKi9cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIHJlbW92ZVNhbGVFZmZlY3RzT25EZWxldGUoc2FsZUlkOiBzdHJpbmcpOiBQcm9taXNlPHZvaWQ+IHtcclxuICB0cnkge1xyXG4gICAgY29uc29sZS5sb2coYFtyZW1vdmVTYWxlRWZmZWN0c09uRGVsZXRlXSBTdGFydGluZyBjbGVhbnVwIGZvciBzYWxlOiAke3NhbGVJZH1gKTtcclxuICAgIFxyXG4gICAgLy8gMS4gUmVtb3ZlIHBsYXllciBwb2ludHMgdGhhdCB3ZXJlIGF3YXJkZWQgYnkgdGhpcyBzYWxlIChpZiBwb2ludHMgd2VyZSBiYWRseSBnaXZlbilcclxuICAgIGF3YWl0IHJlbW92ZVBsYXllclBvaW50c0Zyb21TYWxlKHNhbGVJZCk7XHJcbiAgICBcclxuICAgIC8vIDIuIFJlbW92ZSBhbGwgTGlua3MgcmVsYXRlZCB0byB0aGlzIHNhbGVcclxuICAgIGNvbnN0IHNhbGVMaW5rcyA9IGF3YWl0IENsaWVudEFQSS5nZXRMaW5rc0Zvcih7IHR5cGU6ICdzYWxlJywgaWQ6IHNhbGVJZCB9KTtcclxuICAgIGNvbnNvbGUubG9nKGBbcmVtb3ZlU2FsZUVmZmVjdHNPbkRlbGV0ZV0gRm91bmQgJHtzYWxlTGlua3MubGVuZ3RofSBsaW5rcyB0byByZW1vdmVgKTtcclxuICAgIFxyXG4gICAgZm9yIChjb25zdCBsaW5rIG9mIHNhbGVMaW5rcykge1xyXG4gICAgICB0cnkge1xyXG4gICAgICAgIGF3YWl0IENsaWVudEFQSS5yZW1vdmVMaW5rKGxpbmsuaWQpO1xyXG4gICAgICAgIGNvbnNvbGUubG9nKGBbcmVtb3ZlU2FsZUVmZmVjdHNPbkRlbGV0ZV0g4pyFIFJlbW92ZWQgbGluazogJHtsaW5rLmxpbmtUeXBlfWApO1xyXG4gICAgICB9IGNhdGNoIChlcnJvcikge1xyXG4gICAgICAgIGNvbnNvbGUuZXJyb3IoYFtyZW1vdmVTYWxlRWZmZWN0c09uRGVsZXRlXSDinYwgRmFpbGVkIHRvIHJlbW92ZSBsaW5rICR7bGluay5pZH06YCwgZXJyb3IpO1xyXG4gICAgICB9XHJcbiAgICB9XHJcbiAgICBcclxuICAgIC8vIDMuIENsZWFyIGVmZmVjdHMgcmVnaXN0cnlcclxuICAgIGF3YWl0IGNsZWFyRWZmZWN0c0J5UHJlZml4KCdzYWxlJywgc2FsZUlkLCAnc2FsZTonKTtcclxuICAgIGF3YWl0IGNsZWFyRWZmZWN0c0J5UHJlZml4KCdzYWxlJywgc2FsZUlkLCAncG9pbnRzQXdhcmRlZDonKTtcclxuICAgIFxyXG4gICAgLy8gNC4gUmVtb3ZlIGxvZyBlbnRyaWVzIGZyb20gYWxsIHJlbGV2YW50IGxvZ3NcclxuICAgIGNvbnNvbGUubG9nKGBbcmVtb3ZlU2FsZUVmZmVjdHNPbkRlbGV0ZV0gU3RhcnRpbmcgbG9nIGVudHJ5IHJlbW92YWwgZm9yIHNhbGU6ICR7c2FsZUlkfWApO1xyXG4gICAgXHJcbiAgICBjb25zdCByZW1vdmFscyA9IGF3YWl0IFByb21pc2UuYWxsKFtcclxuICAgICAgQ2xpZW50QVBJLnJlbW92ZUxvZ0VudHJ5KCdzYWxlcycsIHNhbGVJZCkudGhlbihyID0+IHsgY29uc29sZS5sb2coYFtyZW1vdmVTYWxlRWZmZWN0c09uRGVsZXRlXSBTYWxlcyBsb2cgcmVtb3ZhbCByZXN1bHQ6YCwgcik7IHJldHVybiByOyB9KS5jYXRjaChlID0+ICh7IHN1Y2Nlc3M6IGZhbHNlLCBtZXNzYWdlOiBTdHJpbmcoZSkgfSkpLFxyXG4gICAgICBDbGllbnRBUEkucmVtb3ZlTG9nRW50cnkoJ2ZpbmFuY2lhbHMnLCBzYWxlSWQpLnRoZW4ociA9PiB7IGNvbnNvbGUubG9nKGBbcmVtb3ZlU2FsZUVmZmVjdHNPbkRlbGV0ZV0gRmluYW5jaWFscyBsb2cgcmVtb3ZhbCByZXN1bHQ6YCwgcik7IHJldHVybiByOyB9KS5jYXRjaChlID0+ICh7IHN1Y2Nlc3M6IGZhbHNlLCBtZXNzYWdlOiBTdHJpbmcoZSkgfSkpLFxyXG4gICAgICBDbGllbnRBUEkucmVtb3ZlTG9nRW50cnkoJ2NoYXJhY3RlcicsIHNhbGVJZCkudGhlbihyID0+IHsgY29uc29sZS5sb2coYFtyZW1vdmVTYWxlRWZmZWN0c09uRGVsZXRlXSBDaGFyYWN0ZXIgbG9nIHJlbW92YWwgcmVzdWx0OmAsIHIpOyByZXR1cm4gcjsgfSkuY2F0Y2goZSA9PiAoeyBzdWNjZXNzOiBmYWxzZSwgbWVzc2FnZTogU3RyaW5nKGUpIH0pKSxcclxuICAgICAgQ2xpZW50QVBJLnJlbW92ZUxvZ0VudHJ5KCdpdGVtcycsIHNhbGVJZCkudGhlbihyID0+IHsgY29uc29sZS5sb2coYFtyZW1vdmVTYWxlRWZmZWN0c09uRGVsZXRlXSBJdGVtcyBsb2cgcmVtb3ZhbCByZXN1bHQ6YCwgcik7IHJldHVybiByOyB9KS5jYXRjaChlID0+ICh7IHN1Y2Nlc3M6IGZhbHNlLCBtZXNzYWdlOiBTdHJpbmcoZSkgfSkpLFxyXG4gICAgXSk7XHJcblxyXG4gICAgY29uc29sZS5sb2coYFtyZW1vdmVTYWxlRWZmZWN0c09uRGVsZXRlXSBBbGwgcmVtb3ZhbCByZXN1bHRzOmAsIHJlbW92YWxzKTtcclxuICAgIGNvbnN0IGZhaWxlZCA9IHJlbW92YWxzLmZpbHRlcihyID0+ICFyLnN1Y2Nlc3MpO1xyXG4gICAgaWYgKGZhaWxlZC5sZW5ndGggPiAwKSB7XHJcbiAgICAgIGNvbnNvbGUuZXJyb3IoJ1tyZW1vdmVTYWxlRWZmZWN0c09uRGVsZXRlXSBTb21lIGxvZyByZW1vdmFscyBmYWlsZWQ6JywgZmFpbGVkKTtcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgIGNvbnNvbGUubG9nKGBbcmVtb3ZlU2FsZUVmZmVjdHNPbkRlbGV0ZV0g4pyFIEFsbCBsb2cgZW50cmllcyByZW1vdmVkIHN1Y2Nlc3NmdWxseSBmb3Igc2FsZTogJHtzYWxlSWR9YCk7XHJcbiAgICB9XHJcbiAgICBcclxuICAgIGNvbnNvbGUubG9nKGBbcmVtb3ZlU2FsZUVmZmVjdHNPbkRlbGV0ZV0g4pyFIENsZWFyZWQgZWZmZWN0cywgcmVtb3ZlZCBsaW5rcywgYW5kIHJlbW92ZWQgbG9nIGVudHJpZXMgZm9yIHNhbGUgJHtzYWxlSWR9YCk7XHJcbiAgfSBjYXRjaCAoZXJyb3IpIHtcclxuICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIHJlbW92aW5nIHNhbGUgZWZmZWN0czonLCBlcnJvcik7XHJcbiAgfVxyXG59XHJcblxyXG4vKipcclxuICogUmVtb3ZlIHBsYXllciBwb2ludHMgdGhhdCB3ZXJlIGF3YXJkZWQgYnkgYSBzcGVjaWZpYyBzYWxlXHJcbiAqIFRoaXMgaXMgdXNlZCB3aGVuIHJvbGxpbmcgYmFjayBhIHNhbGUgdGhhdCBpbmNvcnJlY3RseSBhd2FyZGVkIHBvaW50c1xyXG4gKi9cclxuYXN5bmMgZnVuY3Rpb24gcmVtb3ZlUGxheWVyUG9pbnRzRnJvbVNhbGUoc2FsZUlkOiBzdHJpbmcpOiBQcm9taXNlPHZvaWQ+IHtcclxuICB0cnkge1xyXG4gICAgY29uc29sZS5sb2coYFtyZW1vdmVQbGF5ZXJQb2ludHNGcm9tU2FsZV0gUmVtb3ZpbmcgcG9pbnRzIGZvciBzYWxlOiAke3NhbGVJZH1gKTtcclxuICAgIFxyXG4gICAgLy8gR2V0IHRoZSBzYWxlIHRvIGZpbmQgd2hhdCBwb2ludHMgd2VyZSBhd2FyZGVkXHJcbiAgICBjb25zdCBzYWxlcyA9IGF3YWl0IENsaWVudEFQSS5nZXRTYWxlcygpO1xyXG4gICAgY29uc3Qgc2FsZSA9IHNhbGVzLmZpbmQocyA9PiBzLmlkID09PSBzYWxlSWQpO1xyXG4gICAgXHJcbiAgICBpZiAoIXNhbGUgfHwgc2FsZS50b3RhbHMudG90YWxSZXZlbnVlIDw9IDApIHtcclxuICAgICAgY29uc29sZS5sb2coYFtyZW1vdmVQbGF5ZXJQb2ludHNGcm9tU2FsZV0gU2FsZSAke3NhbGVJZH0gaGFzIG5vIHJldmVudWUgdG8gcmVtb3ZlIHBvaW50cyBmcm9tYCk7XHJcbiAgICAgIHJldHVybjtcclxuICAgIH1cclxuICAgIFxyXG4gICAgLy8gR2V0IHRoZSBtYWluIHBsYXllclxyXG4gICAgY29uc3QgbWFpblBsYXllcklkID0gZ2V0TWFpblBsYXllcklkKCk7XHJcbiAgICBjb25zdCBwbGF5ZXJzID0gYXdhaXQgQ2xpZW50QVBJLmdldFBsYXllcnMoKTtcclxuICAgIGNvbnN0IG1haW5QbGF5ZXIgPSBwbGF5ZXJzLmZpbmQocCA9PiBwLmlkID09PSBtYWluUGxheWVySWQpO1xyXG4gICAgXHJcbiAgICBpZiAoIW1haW5QbGF5ZXIpIHtcclxuICAgICAgY29uc29sZS5sb2coYFtyZW1vdmVQbGF5ZXJQb2ludHNGcm9tU2FsZV0gTWFpbiBwbGF5ZXIgbm90IGZvdW5kLCBza2lwcGluZyBwb2ludHMgcmVtb3ZhbGApO1xyXG4gICAgICByZXR1cm47XHJcbiAgICB9XHJcbiAgICBcclxuICAgIC8vIENhbGN1bGF0ZSBwb2ludHMgdG8gcmVtb3ZlIGJhc2VkIG9uIHNhbGUgcmV2ZW51ZSAoMSBQb2ludCA9ICQxMDApXHJcbiAgICBjb25zdCBwb2ludHNUb1JlbW92ZSA9IGNhbGN1bGF0ZVBvaW50c0Zyb21SZXZlbnVlKHNhbGUudG90YWxzLnRvdGFsUmV2ZW51ZSk7XHJcbiAgICBcclxuICAgIC8vIENoZWNrIGlmIGFueSBwb2ludHMgd2VyZSBhY3R1YWxseSBhd2FyZGVkXHJcbiAgICBjb25zdCBoYXNQb2ludHMgPSAocG9pbnRzVG9SZW1vdmUueHAgfHwgMCkgPiAwIHx8IChwb2ludHNUb1JlbW92ZS5ycCB8fCAwKSA+IDAgfHwgXHJcbiAgICAgICAgICAgICAgICAgICAgIChwb2ludHNUb1JlbW92ZS5mcCB8fCAwKSA+IDAgfHwgKHBvaW50c1RvUmVtb3ZlLmhwIHx8IDApID4gMDtcclxuICAgIFxyXG4gICAgaWYgKCFoYXNQb2ludHMpIHtcclxuICAgICAgY29uc29sZS5sb2coYFtyZW1vdmVQbGF5ZXJQb2ludHNGcm9tU2FsZV0gTm8gcG9pbnRzIHRvIHJlbW92ZSBmcm9tIHNhbGUgJHtzYWxlSWR9IChyZXZlbnVlOiAke3NhbGUudG90YWxzLnRvdGFsUmV2ZW51ZX0pYCk7XHJcbiAgICAgIHJldHVybjtcclxuICAgIH1cclxuICAgIFxyXG4gICAgLy8gUmVtb3ZlIHRoZSBwb2ludHMgZnJvbSB0aGUgcGxheWVyXHJcbiAgICBhd2FpdCByZW1vdmVQb2ludHNGcm9tUGxheWVyKG1haW5QbGF5ZXJJZCwgcG9pbnRzVG9SZW1vdmUpO1xyXG4gICAgY29uc29sZS5sb2coYFtyZW1vdmVQbGF5ZXJQb2ludHNGcm9tU2FsZV0g4pyFIFJlbW92ZWQgcG9pbnRzIGZyb20gcGxheWVyOiAke0pTT04uc3RyaW5naWZ5KHBvaW50c1RvUmVtb3ZlKX0gKHNhbGUgcmV2ZW51ZTogJHtzYWxlLnRvdGFscy50b3RhbFJldmVudWV9KWApO1xyXG4gICAgXHJcbiAgfSBjYXRjaCAoZXJyb3IpIHtcclxuICAgIGNvbnNvbGUuZXJyb3IoYFtyZW1vdmVQbGF5ZXJQb2ludHNGcm9tU2FsZV0g4p2MIEZhaWxlZCB0byByZW1vdmUgcGxheWVyIHBvaW50cyBmb3Igc2FsZSAke3NhbGVJZH06YCwgZXJyb3IpO1xyXG4gIH1cclxufSJdLCJuYW1lcyI6WyJhcHBlbmRFbnRpdHlMb2ciLCJ1cGRhdGVFbnRpdHlMb2dGaWVsZCIsImhhc0VmZmVjdCIsIm1hcmtFZmZlY3QiLCJjbGVhckVmZmVjdHNCeVByZWZpeCIsIkNsaWVudEFQSSIsImF3YXJkUG9pbnRzVG9QbGF5ZXIiLCJyZW1vdmVQb2ludHNGcm9tUGxheWVyIiwiY2FsY3VsYXRlUG9pbnRzRnJvbVJldmVudWUiLCJnZXRNYWluUGxheWVySWQiLCJwcm9jZXNzU2FsZUxpbmVzIiwidXBkYXRlRmluYW5jaWFsUmVjb3Jkc0Zyb21TYWxlIiwidXBkYXRlSXRlbXNGcm9tU2FsZSIsInVwZGF0ZVBsYXllclBvaW50c0Zyb21Tb3VyY2UiLCJoYXNSZXZlbnVlQ2hhbmdlZCIsImhhc0xpbmVzQ2hhbmdlZCIsIlNUQVRFX0ZJRUxEUyIsIkRFU0NSSVBUSVZFX0ZJRUxEUyIsIm9uU2FsZVVwc2VydCIsInNhbGUiLCJwcmV2aW91c1NhbGUiLCJlZmZlY3RLZXkiLCJpZCIsInR5cGUiLCJzdGF0dXMiLCJjb3VudGVycGFydHlOYW1lIiwidG90YWxSZXZlbnVlIiwidG90YWxzIiwicG9pbnRzRWZmZWN0S2V5IiwiY29uc29sZSIsImxvZyIsInBvaW50cyIsImNoYXJnZWRBdCIsIkRhdGUiLCJ0b0lTT1N0cmluZyIsImxpbmVzUHJvY2Vzc2VkS2V5IiwiY2FuY2VsbGVkQXQiLCJpc0NvbGxlY3RlZCIsImNvbGxlY3RlZEF0IiwiZmllbGQiLCJyZW1vdmVTYWxlRWZmZWN0c09uRGVsZXRlIiwic2FsZUlkIiwicmVtb3ZlUGxheWVyUG9pbnRzRnJvbVNhbGUiLCJzYWxlTGlua3MiLCJnZXRMaW5rc0ZvciIsImxlbmd0aCIsImxpbmsiLCJyZW1vdmVMaW5rIiwibGlua1R5cGUiLCJlcnJvciIsInJlbW92YWxzIiwiUHJvbWlzZSIsImFsbCIsInJlbW92ZUxvZ0VudHJ5IiwidGhlbiIsInIiLCJjYXRjaCIsImUiLCJzdWNjZXNzIiwibWVzc2FnZSIsIlN0cmluZyIsImZhaWxlZCIsImZpbHRlciIsInNhbGVzIiwiZ2V0U2FsZXMiLCJmaW5kIiwicyIsIm1haW5QbGF5ZXJJZCIsInBsYXllcnMiLCJnZXRQbGF5ZXJzIiwibWFpblBsYXllciIsInAiLCJwb2ludHNUb1JlbW92ZSIsImhhc1BvaW50cyIsInhwIiwicnAiLCJmcCIsImhwIiwiSlNPTiIsInN0cmluZ2lmeSJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(app-pages-browser)/./workflows/entities-workflows/sale.workflow.ts\n"));

/***/ }),

/***/ "(app-pages-browser)/./workflows/entities-workflows/site.workflow.ts":
/*!*******************************************************!*\
  !*** ./workflows/entities-workflows/site.workflow.ts ***!
  \*******************************************************/
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval(__webpack_require__.ts("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   onSiteUpsert: function() { return /* binding */ onSiteUpsert; },\n/* harmony export */   removeSiteEffectsOnDelete: function() { return /* binding */ removeSiteEffectsOnDelete; }\n/* harmony export */ });\n/* harmony import */ var _entities_logging__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../entities-logging */ \"(app-pages-browser)/./workflows/entities-logging.ts\");\n/* harmony import */ var _data_store_effects_registry__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @/data-store/effects-registry */ \"(app-pages-browser)/./data-store/effects-registry.ts\");\n/* harmony import */ var _lib_client_api__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @/lib/client-api */ \"(app-pages-browser)/./lib/client-api.ts\");\n// workflows/entities-workflows/site.workflow.ts\n// Site-specific workflow with ACTIVATED, DEACTIVATED events\n\n\n\nconst STATE_FIELDS = [\n    \"isActive\",\n    \"status\"\n];\nconst DESCRIPTIVE_FIELDS = [\n    \"name\",\n    \"description\",\n    \"metadata\"\n];\nasync function onSiteUpsert(site, previousSite) {\n    // New site creation\n    if (!previousSite) {\n        const effectKey = \"site:\".concat(site.id, \":created\");\n        if (await (0,_data_store_effects_registry__WEBPACK_IMPORTED_MODULE_1__.hasEffect)(effectKey)) return;\n        await (0,_entities_logging__WEBPACK_IMPORTED_MODULE_0__.appendEntityLog)(\"site\", site.id, \"CREATED\", {\n            name: site.name,\n            type: site.metadata.type,\n            isActive: site.isActive\n        });\n        await (0,_data_store_effects_registry__WEBPACK_IMPORTED_MODULE_1__.markEffect)(effectKey);\n        return;\n    }\n    // Activation status changes\n    if (previousSite.isActive !== site.isActive) {\n        if (site.isActive) {\n            await (0,_entities_logging__WEBPACK_IMPORTED_MODULE_0__.appendEntityLog)(\"site\", site.id, \"ACTIVATED\", {\n                name: site.name,\n                activatedAt: new Date().toISOString()\n            });\n        } else {\n            await (0,_entities_logging__WEBPACK_IMPORTED_MODULE_0__.appendEntityLog)(\"site\", site.id, \"DEACTIVATED\", {\n                name: site.name,\n                deactivatedAt: new Date().toISOString()\n            });\n        }\n    }\n    // Status changes - UPDATED event\n    if (previousSite.status !== site.status) {\n        await (0,_entities_logging__WEBPACK_IMPORTED_MODULE_0__.appendEntityLog)(\"site\", site.id, \"UPDATED\", {\n            name: site.name,\n            oldStatus: previousSite.status,\n            newStatus: site.status\n        });\n    }\n    // Descriptive changes - update in-place\n    for (const field of DESCRIPTIVE_FIELDS){\n        if (previousSite[field] !== site[field]) {\n            await (0,_entities_logging__WEBPACK_IMPORTED_MODULE_0__.updateEntityLogField)(\"site\", site.id, field, previousSite[field], site[field]);\n        }\n    }\n}\n/**\r\n * Remove site effects when site is deleted\r\n * Sites can have entries in sites log and related links\r\n */ async function removeSiteEffectsOnDelete(siteId) {\n    try {\n        console.log(\"[removeSiteEffectsOnDelete] Starting cleanup for site: \".concat(siteId));\n        // 1. Remove all Links related to this site\n        const siteLinks = await _lib_client_api__WEBPACK_IMPORTED_MODULE_2__.ClientAPI.getLinksFor({\n            type: \"site\",\n            id: siteId\n        });\n        console.log(\"[removeSiteEffectsOnDelete] Found \".concat(siteLinks.length, \" links to remove\"));\n        for (const link of siteLinks){\n            try {\n                await _lib_client_api__WEBPACK_IMPORTED_MODULE_2__.ClientAPI.removeLink(link.id);\n                console.log(\"[removeSiteEffectsOnDelete]  Removed link: \".concat(link.linkType));\n            } catch (error) {\n                console.error(\"[removeSiteEffectsOnDelete]  Failed to remove link \".concat(link.id, \":\"), error);\n            }\n        }\n        // 2. Clear all effects for this site\n        await (0,_data_store_effects_registry__WEBPACK_IMPORTED_MODULE_1__.clearEffect)(\"site:\".concat(siteId, \":created\"));\n        await (0,_data_store_effects_registry__WEBPACK_IMPORTED_MODULE_1__.clearEffectsByPrefix)(\"site\", siteId, \"\");\n        // 3. Remove log entries from sites log\n        console.log(\"[removeSiteEffectsOnDelete] Starting log entry removal for site: \".concat(siteId));\n        const result = await _lib_client_api__WEBPACK_IMPORTED_MODULE_2__.ClientAPI.removeLogEntry(\"sites\", siteId);\n        if (result.success) {\n            console.log(\"[removeSiteEffectsOnDelete]  Site log entries removed successfully for site: \".concat(siteId));\n        } else if (result.message === \"No matching entries found\") {\n            console.log(\"[removeSiteEffectsOnDelete]  No log entries found for site: \".concat(siteId, \" (this is normal)\"));\n        } else {\n            console.error(\"[removeSiteEffectsOnDelete] Failed to remove site log entries: \".concat(result.message));\n        }\n        console.log(\"[removeSiteEffectsOnDelete]  Cleared effects, removed links, and removed log entries for site \".concat(siteId));\n    } catch (error) {\n        console.error(\"Error removing site effects:\", error);\n    }\n}\n\n\n;\n    // Wrapped in an IIFE to avoid polluting the global scope\n    ;\n    (function () {\n        var _a, _b;\n        // Legacy CSS implementations will `eval` browser code in a Node.js context\n        // to extract CSS. For backwards compatibility, we need to check we're in a\n        // browser context before continuing.\n        if (typeof self !== 'undefined' &&\n            // AMP / No-JS mode does not inject these helpers:\n            '$RefreshHelpers$' in self) {\n            // @ts-ignore __webpack_module__ is global\n            var currentExports = module.exports;\n            // @ts-ignore __webpack_module__ is global\n            var prevSignature = (_b = (_a = module.hot.data) === null || _a === void 0 ? void 0 : _a.prevSignature) !== null && _b !== void 0 ? _b : null;\n            // This cannot happen in MainTemplate because the exports mismatch between\n            // templating and execution.\n            self.$RefreshHelpers$.registerExportsForReactRefresh(currentExports, module.id);\n            // A module can be accepted automatically based on its exports, e.g. when\n            // it is a Refresh Boundary.\n            if (self.$RefreshHelpers$.isReactRefreshBoundary(currentExports)) {\n                // Save the previous exports signature on update so we can compare the boundary\n                // signatures. We avoid saving exports themselves since it causes memory leaks (https://github.com/vercel/next.js/pull/53797)\n                module.hot.dispose(function (data) {\n                    data.prevSignature =\n                        self.$RefreshHelpers$.getRefreshBoundarySignature(currentExports);\n                });\n                // Unconditionally accept an update to this module, we'll check if it's\n                // still a Refresh Boundary later.\n                // @ts-ignore importMeta is replaced in the loader\n                module.hot.accept();\n                // This field is set when the previous version of this module was a\n                // Refresh Boundary, letting us know we need to check for invalidation or\n                // enqueue an update.\n                if (prevSignature !== null) {\n                    // A boundary can become ineligible if its exports are incompatible\n                    // with the previous exports.\n                    //\n                    // For example, if you add/remove/change exports, we'll want to\n                    // re-execute the importing modules, and force those components to\n                    // re-render. Similarly, if you convert a class component to a\n                    // function, we want to invalidate the boundary.\n                    if (self.$RefreshHelpers$.shouldInvalidateReactRefreshBoundary(prevSignature, self.$RefreshHelpers$.getRefreshBoundarySignature(currentExports))) {\n                        module.hot.invalidate();\n                    }\n                    else {\n                        self.$RefreshHelpers$.scheduleUpdate();\n                    }\n                }\n            }\n            else {\n                // Since we just executed the code for the module, it's possible that the\n                // new exports made it ineligible for being a boundary.\n                // We only care about the case when we were _previously_ a boundary,\n                // because we already accepted this update (accidental side effect).\n                var isNoLongerABoundary = prevSignature !== null;\n                if (isNoLongerABoundary) {\n                    module.hot.invalidate();\n                }\n            }\n        }\n    })();\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFwcC1wYWdlcy1icm93c2VyKS8uL3dvcmtmbG93cy9lbnRpdGllcy13b3JrZmxvd3Mvc2l0ZS53b3JrZmxvdy50cyIsIm1hcHBpbmdzIjoiOzs7Ozs7OztBQUFBLGdEQUFnRDtBQUNoRCw0REFBNEQ7QUFHZ0I7QUFDNkI7QUFDNUQ7QUFFN0MsTUFBTU8sZUFBZTtJQUFDO0lBQVk7Q0FBUztBQUMzQyxNQUFNQyxxQkFBcUI7SUFBQztJQUFRO0lBQWU7Q0FBVztBQUV2RCxlQUFlQyxhQUFhQyxJQUFVLEVBQUVDLFlBQW1CO0lBQ2hFLG9CQUFvQjtJQUNwQixJQUFJLENBQUNBLGNBQWM7UUFDakIsTUFBTUMsWUFBWSxRQUFnQixPQUFSRixLQUFLRyxFQUFFLEVBQUM7UUFDbEMsSUFBSSxNQUFNWCx1RUFBU0EsQ0FBQ1UsWUFBWTtRQUVoQyxNQUFNWixrRUFBZUEsQ0FBQyxRQUFRVSxLQUFLRyxFQUFFLEVBQUUsV0FBVztZQUNoREMsTUFBTUosS0FBS0ksSUFBSTtZQUNmQyxNQUFNTCxLQUFLTSxRQUFRLENBQUNELElBQUk7WUFDeEJFLFVBQVVQLEtBQUtPLFFBQVE7UUFDekI7UUFDQSxNQUFNZCx3RUFBVUEsQ0FBQ1M7UUFDakI7SUFDRjtJQUVBLDRCQUE0QjtJQUM1QixJQUFJRCxhQUFhTSxRQUFRLEtBQUtQLEtBQUtPLFFBQVEsRUFBRTtRQUMzQyxJQUFJUCxLQUFLTyxRQUFRLEVBQUU7WUFDakIsTUFBTWpCLGtFQUFlQSxDQUFDLFFBQVFVLEtBQUtHLEVBQUUsRUFBRSxhQUFhO2dCQUNsREMsTUFBTUosS0FBS0ksSUFBSTtnQkFDZkksYUFBYSxJQUFJQyxPQUFPQyxXQUFXO1lBQ3JDO1FBQ0YsT0FBTztZQUNMLE1BQU1wQixrRUFBZUEsQ0FBQyxRQUFRVSxLQUFLRyxFQUFFLEVBQUUsZUFBZTtnQkFDcERDLE1BQU1KLEtBQUtJLElBQUk7Z0JBQ2ZPLGVBQWUsSUFBSUYsT0FBT0MsV0FBVztZQUN2QztRQUNGO0lBQ0Y7SUFFQSxpQ0FBaUM7SUFDakMsSUFBSVQsYUFBYVcsTUFBTSxLQUFLWixLQUFLWSxNQUFNLEVBQUU7UUFDdkMsTUFBTXRCLGtFQUFlQSxDQUFDLFFBQVFVLEtBQUtHLEVBQUUsRUFBRSxXQUFXO1lBQ2hEQyxNQUFNSixLQUFLSSxJQUFJO1lBQ2ZTLFdBQVdaLGFBQWFXLE1BQU07WUFDOUJFLFdBQVdkLEtBQUtZLE1BQU07UUFDeEI7SUFDRjtJQUVBLHdDQUF3QztJQUN4QyxLQUFLLE1BQU1HLFNBQVNqQixtQkFBb0I7UUFDdEMsSUFBSSxZQUFxQixDQUFDaUIsTUFBTSxLQUFLLElBQWEsQ0FBQ0EsTUFBTSxFQUFFO1lBQ3pELE1BQU14Qix1RUFBb0JBLENBQUMsUUFBUVMsS0FBS0csRUFBRSxFQUFFWSxPQUFPLFlBQXFCLENBQUNBLE1BQU0sRUFBRSxJQUFhLENBQUNBLE1BQU07UUFDdkc7SUFDRjtBQUNGO0FBRUE7OztDQUdDLEdBQ00sZUFBZUMsMEJBQTBCQyxNQUFjO0lBQzVELElBQUk7UUFDRkMsUUFBUUMsR0FBRyxDQUFDLDBEQUFpRSxPQUFQRjtRQUV0RSwyQ0FBMkM7UUFDM0MsTUFBTUcsWUFBWSxNQUFNeEIsc0RBQVNBLENBQUN5QixXQUFXLENBQUM7WUFBRWhCLE1BQU07WUFBUUYsSUFBSWM7UUFBTztRQUN6RUMsUUFBUUMsR0FBRyxDQUFDLHFDQUFzRCxPQUFqQkMsVUFBVUUsTUFBTSxFQUFDO1FBRWxFLEtBQUssTUFBTUMsUUFBUUgsVUFBVztZQUM1QixJQUFJO2dCQUNGLE1BQU14QixzREFBU0EsQ0FBQzRCLFVBQVUsQ0FBQ0QsS0FBS3BCLEVBQUU7Z0JBQ2xDZSxRQUFRQyxHQUFHLENBQUMsK0NBQTZELE9BQWRJLEtBQUtFLFFBQVE7WUFDMUUsRUFBRSxPQUFPQyxPQUFPO2dCQUNkUixRQUFRUSxLQUFLLENBQUMsdURBQStELE9BQVJILEtBQUtwQixFQUFFLEVBQUMsTUFBSXVCO1lBQ25GO1FBQ0Y7UUFFQSxxQ0FBcUM7UUFDckMsTUFBTWhDLHlFQUFXQSxDQUFDLFFBQWUsT0FBUHVCLFFBQU87UUFDakMsTUFBTXRCLGtGQUFvQkEsQ0FBQyxRQUFRc0IsUUFBUTtRQUUzQyx1Q0FBdUM7UUFDdkNDLFFBQVFDLEdBQUcsQ0FBQyxvRUFBMkUsT0FBUEY7UUFFaEYsTUFBTVUsU0FBUyxNQUFNL0Isc0RBQVNBLENBQUNnQyxjQUFjLENBQUMsU0FBU1g7UUFFdkQsSUFBSVUsT0FBT0UsT0FBTyxFQUFFO1lBQ2xCWCxRQUFRQyxHQUFHLENBQUMsaUZBQXdGLE9BQVBGO1FBQy9GLE9BQU8sSUFBSVUsT0FBT0csT0FBTyxLQUFLLDZCQUE2QjtZQUN6RFosUUFBUUMsR0FBRyxDQUFDLGlFQUF3RSxPQUFQRixRQUFPO1FBQ3RGLE9BQU87WUFDTEMsUUFBUVEsS0FBSyxDQUFDLGtFQUFpRixPQUFmQyxPQUFPRyxPQUFPO1FBQ2hHO1FBRUFaLFFBQVFDLEdBQUcsQ0FBQyxrR0FBeUcsT0FBUEY7SUFDaEgsRUFBRSxPQUFPUyxPQUFPO1FBQ2RSLFFBQVFRLEtBQUssQ0FBQyxnQ0FBZ0NBO0lBQ2hEO0FBQ0YiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9fTl9FLy4vd29ya2Zsb3dzL2VudGl0aWVzLXdvcmtmbG93cy9zaXRlLndvcmtmbG93LnRzP2EyYmQiXSwic291cmNlc0NvbnRlbnQiOlsiLy8gd29ya2Zsb3dzL2VudGl0aWVzLXdvcmtmbG93cy9zaXRlLndvcmtmbG93LnRzXHJcbi8vIFNpdGUtc3BlY2lmaWMgd29ya2Zsb3cgd2l0aCBBQ1RJVkFURUQsIERFQUNUSVZBVEVEIGV2ZW50c1xyXG5cclxuaW1wb3J0IHR5cGUgeyBTaXRlIH0gZnJvbSAnQC90eXBlcy9lbnRpdGllcyc7XHJcbmltcG9ydCB7IGFwcGVuZEVudGl0eUxvZywgdXBkYXRlRW50aXR5TG9nRmllbGQgfSBmcm9tICcuLi9lbnRpdGllcy1sb2dnaW5nJztcclxuaW1wb3J0IHsgaGFzRWZmZWN0LCBtYXJrRWZmZWN0LCBjbGVhckVmZmVjdCwgY2xlYXJFZmZlY3RzQnlQcmVmaXggfSBmcm9tICdAL2RhdGEtc3RvcmUvZWZmZWN0cy1yZWdpc3RyeSc7XHJcbmltcG9ydCB7IENsaWVudEFQSSB9IGZyb20gJ0AvbGliL2NsaWVudC1hcGknO1xyXG5cclxuY29uc3QgU1RBVEVfRklFTERTID0gWydpc0FjdGl2ZScsICdzdGF0dXMnXTtcclxuY29uc3QgREVTQ1JJUFRJVkVfRklFTERTID0gWyduYW1lJywgJ2Rlc2NyaXB0aW9uJywgJ21ldGFkYXRhJ107XHJcblxyXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gb25TaXRlVXBzZXJ0KHNpdGU6IFNpdGUsIHByZXZpb3VzU2l0ZT86IFNpdGUpOiBQcm9taXNlPHZvaWQ+IHtcclxuICAvLyBOZXcgc2l0ZSBjcmVhdGlvblxyXG4gIGlmICghcHJldmlvdXNTaXRlKSB7XHJcbiAgICBjb25zdCBlZmZlY3RLZXkgPSBgc2l0ZToke3NpdGUuaWR9OmNyZWF0ZWRgO1xyXG4gICAgaWYgKGF3YWl0IGhhc0VmZmVjdChlZmZlY3RLZXkpKSByZXR1cm47XHJcbiAgICBcclxuICAgIGF3YWl0IGFwcGVuZEVudGl0eUxvZygnc2l0ZScsIHNpdGUuaWQsICdDUkVBVEVEJywgeyBcclxuICAgICAgbmFtZTogc2l0ZS5uYW1lLCBcclxuICAgICAgdHlwZTogc2l0ZS5tZXRhZGF0YS50eXBlLFxyXG4gICAgICBpc0FjdGl2ZTogc2l0ZS5pc0FjdGl2ZVxyXG4gICAgfSk7XHJcbiAgICBhd2FpdCBtYXJrRWZmZWN0KGVmZmVjdEtleSk7XHJcbiAgICByZXR1cm47XHJcbiAgfVxyXG4gIFxyXG4gIC8vIEFjdGl2YXRpb24gc3RhdHVzIGNoYW5nZXNcclxuICBpZiAocHJldmlvdXNTaXRlLmlzQWN0aXZlICE9PSBzaXRlLmlzQWN0aXZlKSB7XHJcbiAgICBpZiAoc2l0ZS5pc0FjdGl2ZSkge1xyXG4gICAgICBhd2FpdCBhcHBlbmRFbnRpdHlMb2coJ3NpdGUnLCBzaXRlLmlkLCAnQUNUSVZBVEVEJywge1xyXG4gICAgICAgIG5hbWU6IHNpdGUubmFtZSxcclxuICAgICAgICBhY3RpdmF0ZWRBdDogbmV3IERhdGUoKS50b0lTT1N0cmluZygpXHJcbiAgICAgIH0pO1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgYXdhaXQgYXBwZW5kRW50aXR5TG9nKCdzaXRlJywgc2l0ZS5pZCwgJ0RFQUNUSVZBVEVEJywge1xyXG4gICAgICAgIG5hbWU6IHNpdGUubmFtZSxcclxuICAgICAgICBkZWFjdGl2YXRlZEF0OiBuZXcgRGF0ZSgpLnRvSVNPU3RyaW5nKClcclxuICAgICAgfSk7XHJcbiAgICB9XHJcbiAgfVxyXG4gIFxyXG4gIC8vIFN0YXR1cyBjaGFuZ2VzIC0gVVBEQVRFRCBldmVudFxyXG4gIGlmIChwcmV2aW91c1NpdGUuc3RhdHVzICE9PSBzaXRlLnN0YXR1cykge1xyXG4gICAgYXdhaXQgYXBwZW5kRW50aXR5TG9nKCdzaXRlJywgc2l0ZS5pZCwgJ1VQREFURUQnLCB7XHJcbiAgICAgIG5hbWU6IHNpdGUubmFtZSxcclxuICAgICAgb2xkU3RhdHVzOiBwcmV2aW91c1NpdGUuc3RhdHVzLFxyXG4gICAgICBuZXdTdGF0dXM6IHNpdGUuc3RhdHVzXHJcbiAgICB9KTtcclxuICB9XHJcbiAgXHJcbiAgLy8gRGVzY3JpcHRpdmUgY2hhbmdlcyAtIHVwZGF0ZSBpbi1wbGFjZVxyXG4gIGZvciAoY29uc3QgZmllbGQgb2YgREVTQ1JJUFRJVkVfRklFTERTKSB7XHJcbiAgICBpZiAoKHByZXZpb3VzU2l0ZSBhcyBhbnkpW2ZpZWxkXSAhPT0gKHNpdGUgYXMgYW55KVtmaWVsZF0pIHtcclxuICAgICAgYXdhaXQgdXBkYXRlRW50aXR5TG9nRmllbGQoJ3NpdGUnLCBzaXRlLmlkLCBmaWVsZCwgKHByZXZpb3VzU2l0ZSBhcyBhbnkpW2ZpZWxkXSwgKHNpdGUgYXMgYW55KVtmaWVsZF0pO1xyXG4gICAgfVxyXG4gIH1cclxufVxyXG5cclxuLyoqXHJcbiAqIFJlbW92ZSBzaXRlIGVmZmVjdHMgd2hlbiBzaXRlIGlzIGRlbGV0ZWRcclxuICogU2l0ZXMgY2FuIGhhdmUgZW50cmllcyBpbiBzaXRlcyBsb2cgYW5kIHJlbGF0ZWQgbGlua3NcclxuICovXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiByZW1vdmVTaXRlRWZmZWN0c09uRGVsZXRlKHNpdGVJZDogc3RyaW5nKTogUHJvbWlzZTx2b2lkPiB7XHJcbiAgdHJ5IHtcclxuICAgIGNvbnNvbGUubG9nKGBbcmVtb3ZlU2l0ZUVmZmVjdHNPbkRlbGV0ZV0gU3RhcnRpbmcgY2xlYW51cCBmb3Igc2l0ZTogJHtzaXRlSWR9YCk7XHJcbiAgICBcclxuICAgIC8vIDEuIFJlbW92ZSBhbGwgTGlua3MgcmVsYXRlZCB0byB0aGlzIHNpdGVcclxuICAgIGNvbnN0IHNpdGVMaW5rcyA9IGF3YWl0IENsaWVudEFQSS5nZXRMaW5rc0Zvcih7IHR5cGU6ICdzaXRlJywgaWQ6IHNpdGVJZCB9KTtcclxuICAgIGNvbnNvbGUubG9nKGBbcmVtb3ZlU2l0ZUVmZmVjdHNPbkRlbGV0ZV0gRm91bmQgJHtzaXRlTGlua3MubGVuZ3RofSBsaW5rcyB0byByZW1vdmVgKTtcclxuICAgIFxyXG4gICAgZm9yIChjb25zdCBsaW5rIG9mIHNpdGVMaW5rcykge1xyXG4gICAgICB0cnkge1xyXG4gICAgICAgIGF3YWl0IENsaWVudEFQSS5yZW1vdmVMaW5rKGxpbmsuaWQpO1xyXG4gICAgICAgIGNvbnNvbGUubG9nKGBbcmVtb3ZlU2l0ZUVmZmVjdHNPbkRlbGV0ZV0g4pyFIFJlbW92ZWQgbGluazogJHtsaW5rLmxpbmtUeXBlfWApO1xyXG4gICAgICB9IGNhdGNoIChlcnJvcikge1xyXG4gICAgICAgIGNvbnNvbGUuZXJyb3IoYFtyZW1vdmVTaXRlRWZmZWN0c09uRGVsZXRlXSDinYwgRmFpbGVkIHRvIHJlbW92ZSBsaW5rICR7bGluay5pZH06YCwgZXJyb3IpO1xyXG4gICAgICB9XHJcbiAgICB9XHJcbiAgICBcclxuICAgIC8vIDIuIENsZWFyIGFsbCBlZmZlY3RzIGZvciB0aGlzIHNpdGVcclxuICAgIGF3YWl0IGNsZWFyRWZmZWN0KGBzaXRlOiR7c2l0ZUlkfTpjcmVhdGVkYCk7XHJcbiAgICBhd2FpdCBjbGVhckVmZmVjdHNCeVByZWZpeCgnc2l0ZScsIHNpdGVJZCwgJycpO1xyXG4gICAgXHJcbiAgICAvLyAzLiBSZW1vdmUgbG9nIGVudHJpZXMgZnJvbSBzaXRlcyBsb2dcclxuICAgIGNvbnNvbGUubG9nKGBbcmVtb3ZlU2l0ZUVmZmVjdHNPbkRlbGV0ZV0gU3RhcnRpbmcgbG9nIGVudHJ5IHJlbW92YWwgZm9yIHNpdGU6ICR7c2l0ZUlkfWApO1xyXG4gICAgXHJcbiAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBDbGllbnRBUEkucmVtb3ZlTG9nRW50cnkoJ3NpdGVzJywgc2l0ZUlkKTtcclxuICAgIFxyXG4gICAgaWYgKHJlc3VsdC5zdWNjZXNzKSB7XHJcbiAgICAgIGNvbnNvbGUubG9nKGBbcmVtb3ZlU2l0ZUVmZmVjdHNPbkRlbGV0ZV0g4pyFIFNpdGUgbG9nIGVudHJpZXMgcmVtb3ZlZCBzdWNjZXNzZnVsbHkgZm9yIHNpdGU6ICR7c2l0ZUlkfWApO1xyXG4gICAgfSBlbHNlIGlmIChyZXN1bHQubWVzc2FnZSA9PT0gJ05vIG1hdGNoaW5nIGVudHJpZXMgZm91bmQnKSB7XHJcbiAgICAgIGNvbnNvbGUubG9nKGBbcmVtb3ZlU2l0ZUVmZmVjdHNPbkRlbGV0ZV0g4o+t77iPIE5vIGxvZyBlbnRyaWVzIGZvdW5kIGZvciBzaXRlOiAke3NpdGVJZH0gKHRoaXMgaXMgbm9ybWFsKWApO1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgY29uc29sZS5lcnJvcihgW3JlbW92ZVNpdGVFZmZlY3RzT25EZWxldGVdIEZhaWxlZCB0byByZW1vdmUgc2l0ZSBsb2cgZW50cmllczogJHtyZXN1bHQubWVzc2FnZX1gKTtcclxuICAgIH1cclxuICAgIFxyXG4gICAgY29uc29sZS5sb2coYFtyZW1vdmVTaXRlRWZmZWN0c09uRGVsZXRlXSDinIUgQ2xlYXJlZCBlZmZlY3RzLCByZW1vdmVkIGxpbmtzLCBhbmQgcmVtb3ZlZCBsb2cgZW50cmllcyBmb3Igc2l0ZSAke3NpdGVJZH1gKTtcclxuICB9IGNhdGNoIChlcnJvcikge1xyXG4gICAgY29uc29sZS5lcnJvcignRXJyb3IgcmVtb3Zpbmcgc2l0ZSBlZmZlY3RzOicsIGVycm9yKTtcclxuICB9XHJcbn0iXSwibmFtZXMiOlsiYXBwZW5kRW50aXR5TG9nIiwidXBkYXRlRW50aXR5TG9nRmllbGQiLCJoYXNFZmZlY3QiLCJtYXJrRWZmZWN0IiwiY2xlYXJFZmZlY3QiLCJjbGVhckVmZmVjdHNCeVByZWZpeCIsIkNsaWVudEFQSSIsIlNUQVRFX0ZJRUxEUyIsIkRFU0NSSVBUSVZFX0ZJRUxEUyIsIm9uU2l0ZVVwc2VydCIsInNpdGUiLCJwcmV2aW91c1NpdGUiLCJlZmZlY3RLZXkiLCJpZCIsIm5hbWUiLCJ0eXBlIiwibWV0YWRhdGEiLCJpc0FjdGl2ZSIsImFjdGl2YXRlZEF0IiwiRGF0ZSIsInRvSVNPU3RyaW5nIiwiZGVhY3RpdmF0ZWRBdCIsInN0YXR1cyIsIm9sZFN0YXR1cyIsIm5ld1N0YXR1cyIsImZpZWxkIiwicmVtb3ZlU2l0ZUVmZmVjdHNPbkRlbGV0ZSIsInNpdGVJZCIsImNvbnNvbGUiLCJsb2ciLCJzaXRlTGlua3MiLCJnZXRMaW5rc0ZvciIsImxlbmd0aCIsImxpbmsiLCJyZW1vdmVMaW5rIiwibGlua1R5cGUiLCJlcnJvciIsInJlc3VsdCIsInJlbW92ZUxvZ0VudHJ5Iiwic3VjY2VzcyIsIm1lc3NhZ2UiXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(app-pages-browser)/./workflows/entities-workflows/site.workflow.ts\n"));

/***/ }),

/***/ "(app-pages-browser)/./workflows/entities-workflows/task.workflow.ts":
/*!*******************************************************!*\
  !*** ./workflows/entities-workflows/task.workflow.ts ***!
  \*******************************************************/
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval(__webpack_require__.ts("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   onTaskUpsert: function() { return /* binding */ onTaskUpsert; },\n/* harmony export */   removeTaskLogEntriesOnDelete: function() { return /* binding */ removeTaskLogEntriesOnDelete; },\n/* harmony export */   uncompleteTask: function() { return /* binding */ uncompleteTask; }\n/* harmony export */ });\n/* harmony import */ var _types_enums__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @/types/enums */ \"(app-pages-browser)/./types/enums.ts\");\n/* harmony import */ var _entities_logging__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../entities-logging */ \"(app-pages-browser)/./workflows/entities-logging.ts\");\n/* harmony import */ var _data_store_effects_registry__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @/data-store/effects-registry */ \"(app-pages-browser)/./data-store/effects-registry.ts\");\n/* harmony import */ var _data_store_datastore__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! @/data-store/datastore */ \"(app-pages-browser)/./data-store/datastore.ts\");\n/* harmony import */ var _links_link_registry__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! @/links/link-registry */ \"(app-pages-browser)/./links/link-registry.ts\");\n/* harmony import */ var _item_creation_utils__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../item-creation-utils */ \"(app-pages-browser)/./workflows/item-creation-utils.ts\");\n/* harmony import */ var _points_rewards_utils__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../points-rewards-utils */ \"(app-pages-browser)/./workflows/points-rewards-utils.ts\");\n/* harmony import */ var _financial_record_utils__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../financial-record-utils */ \"(app-pages-browser)/./workflows/financial-record-utils.ts\");\n/* harmony import */ var _update_propagation_utils__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ../update-propagation-utils */ \"(app-pages-browser)/./workflows/update-propagation-utils.ts\");\n// workflows/entities-workflows/task.workflow.ts\n// Task-specific workflow with state vs descriptive field detection\n\n\n\n\n\n\n\n\n\nconst STATE_FIELDS = [\n    \"status\",\n    \"progress\",\n    \"doneAt\",\n    \"collectedAt\",\n    \"siteId\",\n    \"targetSiteId\"\n];\nconst DESCRIPTIVE_FIELDS = [\n    \"name\",\n    \"description\",\n    \"cost\",\n    \"revenue\",\n    \"rewards\",\n    \"priority\"\n];\nasync function onTaskUpsert(task, previousTask) {\n    var _task_rewards;\n    // New task creation\n    if (!previousTask) {\n        const effectKey = \"task:\".concat(task.id, \":created\");\n        if (await (0,_data_store_effects_registry__WEBPACK_IMPORTED_MODULE_2__.hasEffect)(effectKey)) return;\n        await (0,_entities_logging__WEBPACK_IMPORTED_MODULE_1__.appendEntityLog)(\"task\", task.id, \"CREATED\", {\n            name: task.name,\n            status: task.status,\n            station: task.station\n        });\n        await (0,_data_store_effects_registry__WEBPACK_IMPORTED_MODULE_2__.markEffect)(effectKey);\n        return;\n    }\n    // State changes - append new log\n    if (previousTask.status !== task.status) {\n        console.log(\"[onTaskUpsert] Task status changed: \".concat(previousTask.status, \"  \").concat(task.status));\n        // Log status change with transition context\n        await (0,_entities_logging__WEBPACK_IMPORTED_MODULE_1__.appendEntityLog)(\"task\", task.id, \"STATUS_CHANGED\", {\n            oldStatus: previousTask.status,\n            newStatus: task.status,\n            name: task.name,\n            transition: \"\".concat(previousTask.status, \"  \").concat(task.status),\n            changedAt: new Date().toISOString()\n        });\n        // Handle uncompletion (Done  Other status)\n        if (previousTask.status === \"Done\" && task.status !== \"Done\" && task.status !== \"Collected\") {\n            console.log(\"[onTaskUpsert] Task uncompleted: \".concat(task.name, \" (\").concat(previousTask.status, \"  \").concat(task.status, \")\"));\n            // Uncomplete the task and remove effects\n            await uncompleteTask(task.id);\n        }\n    }\n    if (!previousTask.doneAt && task.doneAt) {\n        await (0,_entities_logging__WEBPACK_IMPORTED_MODULE_1__.appendEntityLog)(\"task\", task.id, \"DONE\", {\n            name: task.name,\n            doneAt: task.doneAt\n        });\n    }\n    if (!previousTask.collectedAt && task.collectedAt) {\n        await (0,_entities_logging__WEBPACK_IMPORTED_MODULE_1__.appendEntityLog)(\"task\", task.id, \"COLLECTED\", {\n            name: task.name,\n            collectedAt: task.collectedAt\n        });\n    }\n    // Site changes - MOVED event\n    if (previousTask.siteId !== task.siteId || previousTask.targetSiteId !== task.targetSiteId) {\n        await (0,_entities_logging__WEBPACK_IMPORTED_MODULE_1__.appendEntityLog)(\"task\", task.id, \"MOVED\", {\n            name: task.name,\n            oldSiteId: previousTask.siteId,\n            newSiteId: task.siteId,\n            oldTargetSiteId: previousTask.targetSiteId,\n            newTargetSiteId: task.targetSiteId\n        });\n    }\n    // Item creation from emissary fields - when task is completed\n    if (task.outputItemType && task.outputQuantity && task.status === \"Done\") {\n        const effectKey = \"task:\".concat(task.id, \":itemCreated\");\n        if (!await (0,_data_store_effects_registry__WEBPACK_IMPORTED_MODULE_2__.hasEffect)(effectKey)) {\n            console.log(\"[onTaskUpsert] Creating item from task emissary fields: \".concat(task.name));\n            const createdItem = await (0,_item_creation_utils__WEBPACK_IMPORTED_MODULE_5__.createItemFromTask)(task);\n            if (createdItem) {\n                await (0,_data_store_effects_registry__WEBPACK_IMPORTED_MODULE_2__.markEffect)(effectKey);\n                console.log(\"[onTaskUpsert]  Item created and effect marked: \".concat(createdItem.name));\n            }\n        }\n    }\n    // Points awarding - when task is completed with rewards\n    if (task.status === \"Done\" && ((_task_rewards = task.rewards) === null || _task_rewards === void 0 ? void 0 : _task_rewards.points)) {\n        const effectKey = \"task:\".concat(task.id, \":pointsAwarded\");\n        if (!await (0,_data_store_effects_registry__WEBPACK_IMPORTED_MODULE_2__.hasEffect)(effectKey)) {\n            console.log(\"[onTaskUpsert] Awarding points from task completion: \".concat(task.name));\n            await (0,_points_rewards_utils__WEBPACK_IMPORTED_MODULE_6__.awardPointsToPlayer)((0,_points_rewards_utils__WEBPACK_IMPORTED_MODULE_6__.getMainPlayerId)(), task.rewards.points, task.id, \"task\");\n            await (0,_data_store_effects_registry__WEBPACK_IMPORTED_MODULE_2__.markEffect)(effectKey);\n            console.log(\"[onTaskUpsert]  Points awarded and effect marked for task: \".concat(task.name));\n        }\n    }\n    // Financial record creation from task - when task has cost or revenue\n    if (task.cost || task.revenue) {\n        const effectKey = \"task:\".concat(task.id, \":financialCreated\");\n        if (!await (0,_data_store_effects_registry__WEBPACK_IMPORTED_MODULE_2__.hasEffect)(effectKey)) {\n            console.log(\"[onTaskUpsert] Creating financial record from task: \".concat(task.name));\n            const createdFinancial = await (0,_financial_record_utils__WEBPACK_IMPORTED_MODULE_7__.createFinancialRecordFromTask)(task);\n            if (createdFinancial) {\n                await (0,_data_store_effects_registry__WEBPACK_IMPORTED_MODULE_2__.markEffect)(effectKey);\n                console.log(\"[onTaskUpsert]  Financial record created and effect marked: \".concat(createdFinancial.name));\n            }\n        }\n    }\n    // COMPREHENSIVE UPDATE PROPAGATION - when task properties change\n    if (previousTask) {\n        // Propagate to Financial Records\n        if ((0,_update_propagation_utils__WEBPACK_IMPORTED_MODULE_8__.hasFinancialPropsChanged)(task, previousTask)) {\n            console.log(\"[onTaskUpsert] Propagating financial changes from task: \".concat(task.name));\n            await (0,_update_propagation_utils__WEBPACK_IMPORTED_MODULE_8__.updateFinancialRecordsFromTask)(task, previousTask);\n        }\n        // Propagate to Items\n        if ((0,_update_propagation_utils__WEBPACK_IMPORTED_MODULE_8__.hasOutputPropsChanged)(task, previousTask)) {\n            console.log(\"[onTaskUpsert] Propagating output changes from task: \".concat(task.name));\n            await (0,_update_propagation_utils__WEBPACK_IMPORTED_MODULE_8__.updateItemsCreatedByTask)(task, previousTask);\n        }\n        // Propagate to Player (points delta)\n        if ((0,_update_propagation_utils__WEBPACK_IMPORTED_MODULE_8__.hasRewardsChanged)(task, previousTask)) {\n            console.log(\"[onTaskUpsert] Propagating points changes from task: \".concat(task.name));\n            await (0,_update_propagation_utils__WEBPACK_IMPORTED_MODULE_8__.updatePlayerPointsFromSource)(\"task\", task, previousTask);\n        }\n    }\n    // Descriptive changes - update in-place\n    for (const field of DESCRIPTIVE_FIELDS){\n        if (previousTask[field] !== task[field]) {\n            await (0,_entities_logging__WEBPACK_IMPORTED_MODULE_1__.updateEntityLogField)(\"task\", task.id, field, previousTask[field], task[field]);\n        }\n    }\n}\n/**\r\n * Remove task effects when task is deleted\r\n * Tasks can have entries in multiple logs: tasks, financials, character, player, items\r\n */ async function removeTaskLogEntriesOnDelete(taskId) {\n    try {\n        console.log(\"[removeTaskLogEntriesOnDelete] Starting cleanup for task: \".concat(taskId));\n        // 1. Remove items created by this task\n        await (0,_item_creation_utils__WEBPACK_IMPORTED_MODULE_5__.removeItemsCreatedByTask)(taskId);\n        // 2. Remove financial records created by this task\n        await (0,_financial_record_utils__WEBPACK_IMPORTED_MODULE_7__.removeFinancialRecordsCreatedByTask)(taskId);\n        // 3. Remove player points that were awarded by this task (if points were badly given)\n        await removePlayerPointsFromTask(taskId);\n        // 3. Remove all Links related to this task\n        const taskLinks = await (0,_links_link_registry__WEBPACK_IMPORTED_MODULE_4__.getLinksFor)({\n            type: _types_enums__WEBPACK_IMPORTED_MODULE_0__.EntityType.TASK,\n            id: taskId\n        });\n        console.log(\"[removeTaskLogEntriesOnDelete] Found \".concat(taskLinks.length, \" links to remove\"));\n        for (const link of taskLinks){\n            try {\n                await (0,_links_link_registry__WEBPACK_IMPORTED_MODULE_4__.removeLink)(link.id);\n                console.log(\"[removeTaskLogEntriesOnDelete]  Removed link: \".concat(link.linkType));\n            } catch (error) {\n                console.error(\"[removeTaskLogEntriesOnDelete]  Failed to remove link \".concat(link.id, \":\"), error);\n            }\n        }\n        // 4. Clear effects registry\n        await (0,_data_store_effects_registry__WEBPACK_IMPORTED_MODULE_2__.clearEffect)(\"task:\".concat(taskId, \":created\"));\n        await (0,_data_store_effects_registry__WEBPACK_IMPORTED_MODULE_2__.clearEffect)(\"task:\".concat(taskId, \":itemCreated\"));\n        await (0,_data_store_effects_registry__WEBPACK_IMPORTED_MODULE_2__.clearEffect)(\"task:\".concat(taskId, \":financialCreated\"));\n        await (0,_data_store_effects_registry__WEBPACK_IMPORTED_MODULE_2__.clearEffect)(\"task:\".concat(taskId, \":pointsAwarded\"));\n        await (0,_data_store_effects_registry__WEBPACK_IMPORTED_MODULE_2__.clearEffectsByPrefix)(\"task\", taskId, \"pointsLogged:\");\n        await (0,_data_store_effects_registry__WEBPACK_IMPORTED_MODULE_2__.clearEffectsByPrefix)(\"task\", taskId, \"financialLogged:\");\n        // 5. Remove log entries from all relevant logs\n        // Note: Log removal is handled client-side via API calls\n        // Server-side log removal would require implementing removeLogEntry in entities-logging.ts\n        console.log(\"[removeTaskLogEntriesOnDelete] Log entry removal handled client-side for task: \".concat(taskId));\n        console.log(\"[removeTaskLogEntriesOnDelete]  Cleared effects, removed links for task \".concat(taskId));\n    } catch (error) {\n        console.error(\"Error removing task effects:\", error);\n    }\n}\n/**\r\n * Remove player points that were awarded by a specific task\r\n * This is used when rolling back a task that incorrectly awarded points\r\n */ async function removePlayerPointsFromTask(taskId) {\n    try {\n        var _task_rewards;\n        console.log(\"[removePlayerPointsFromTask] Removing points for task: \".concat(taskId));\n        // Get the task to find what points were awarded\n        const tasks = await (0,_data_store_datastore__WEBPACK_IMPORTED_MODULE_3__.getAllTasks)();\n        const task = tasks.find((t)=>t.id === taskId);\n        if (!task || !((_task_rewards = task.rewards) === null || _task_rewards === void 0 ? void 0 : _task_rewards.points)) {\n            console.log(\"[removePlayerPointsFromTask] Task \".concat(taskId, \" has no points to remove\"));\n            return;\n        }\n        // Get the main player\n        const mainPlayerId = (0,_points_rewards_utils__WEBPACK_IMPORTED_MODULE_6__.getMainPlayerId)();\n        const players = await (0,_data_store_datastore__WEBPACK_IMPORTED_MODULE_3__.getAllPlayers)();\n        const mainPlayer = players.find((p)=>p.id === mainPlayerId);\n        if (!mainPlayer) {\n            console.log(\"[removePlayerPointsFromTask] Main player not found, skipping points removal\");\n            return;\n        }\n        // Check if any points were actually awarded\n        const pointsToRemove = task.rewards.points;\n        const hasPoints = (pointsToRemove.xp || 0) > 0 || (pointsToRemove.rp || 0) > 0 || (pointsToRemove.fp || 0) > 0 || (pointsToRemove.hp || 0) > 0;\n        if (!hasPoints) {\n            console.log(\"[removePlayerPointsFromTask] No points to remove from task \".concat(taskId));\n            return;\n        }\n        // Remove the points from the player\n        await (0,_points_rewards_utils__WEBPACK_IMPORTED_MODULE_6__.removePointsFromPlayer)(mainPlayerId, pointsToRemove);\n        console.log(\"[removePlayerPointsFromTask]  Removed points from player: \".concat(JSON.stringify(pointsToRemove)));\n    } catch (error) {\n        console.error(\"[removePlayerPointsFromTask]  Failed to remove player points for task \".concat(taskId, \":\"), error);\n    }\n}\n/**\r\n * Uncomplete a task and remove effects\r\n * This function handles when a task status changes back from Done\r\n * Reverses all side effects that were applied during completion\r\n */ async function uncompleteTask(taskId) {\n    try {\n        console.log(\"[uncompleteTask] Uncompleting task: \".concat(taskId));\n        // Get the task\n        const tasks = await (0,_data_store_datastore__WEBPACK_IMPORTED_MODULE_3__.getAllTasks)();\n        const task = tasks.find((t)=>t.id === taskId);\n        if (!task) {\n            console.log(\"[uncompleteTask] Task \".concat(taskId, \" not found\"));\n            return;\n        }\n        // Check if task was previously completed (has doneAt)\n        if (!task.doneAt) {\n            console.log(\"[uncompleteTask] Task \".concat(taskId, \" was not completed, nothing to uncomplete\"));\n            return;\n        }\n        console.log(\"[uncompleteTask] Reversing completion for task: \".concat(task.name));\n        // 1. Remove items created by this task\n        await (0,_item_creation_utils__WEBPACK_IMPORTED_MODULE_5__.removeItemsCreatedByTask)(taskId);\n        console.log(\"[uncompleteTask]  Removed items created by task\");\n        // 2. Remove points awarded by this task\n        await removePlayerPointsFromTask(taskId);\n        console.log(\"[uncompleteTask]  Removed points awarded by task\");\n        // 3. Clear effects registry entries\n        await (0,_data_store_effects_registry__WEBPACK_IMPORTED_MODULE_2__.clearEffect)(\"task:\".concat(taskId, \":itemCreated\"));\n        await (0,_data_store_effects_registry__WEBPACK_IMPORTED_MODULE_2__.clearEffect)(\"task:\".concat(taskId, \":pointsAwarded\"));\n        console.log(\"[uncompleteTask]  Cleared effects registry entries\");\n        // 4. Log UNCOMPLETED event\n        await (0,_entities_logging__WEBPACK_IMPORTED_MODULE_1__.appendEntityLog)(\"task\", taskId, \"UNCOMPLETED\", {\n            name: task.name,\n            previousStatus: \"Done\",\n            uncompletedAt: new Date().toISOString()\n        });\n        console.log(\"[uncompleteTask]  Logged UNCOMPLETED event\");\n        console.log(\"[uncompleteTask]  Successfully uncompleted task: \".concat(task.name));\n    } catch (error) {\n        console.error(\"[uncompleteTask]  Failed to uncomplete task \".concat(taskId, \":\"), error);\n        throw error;\n    }\n}\n\n\n;\n    // Wrapped in an IIFE to avoid polluting the global scope\n    ;\n    (function () {\n        var _a, _b;\n        // Legacy CSS implementations will `eval` browser code in a Node.js context\n        // to extract CSS. For backwards compatibility, we need to check we're in a\n        // browser context before continuing.\n        if (typeof self !== 'undefined' &&\n            // AMP / No-JS mode does not inject these helpers:\n            '$RefreshHelpers$' in self) {\n            // @ts-ignore __webpack_module__ is global\n            var currentExports = module.exports;\n            // @ts-ignore __webpack_module__ is global\n            var prevSignature = (_b = (_a = module.hot.data) === null || _a === void 0 ? void 0 : _a.prevSignature) !== null && _b !== void 0 ? _b : null;\n            // This cannot happen in MainTemplate because the exports mismatch between\n            // templating and execution.\n            self.$RefreshHelpers$.registerExportsForReactRefresh(currentExports, module.id);\n            // A module can be accepted automatically based on its exports, e.g. when\n            // it is a Refresh Boundary.\n            if (self.$RefreshHelpers$.isReactRefreshBoundary(currentExports)) {\n                // Save the previous exports signature on update so we can compare the boundary\n                // signatures. We avoid saving exports themselves since it causes memory leaks (https://github.com/vercel/next.js/pull/53797)\n                module.hot.dispose(function (data) {\n                    data.prevSignature =\n                        self.$RefreshHelpers$.getRefreshBoundarySignature(currentExports);\n                });\n                // Unconditionally accept an update to this module, we'll check if it's\n                // still a Refresh Boundary later.\n                // @ts-ignore importMeta is replaced in the loader\n                module.hot.accept();\n                // This field is set when the previous version of this module was a\n                // Refresh Boundary, letting us know we need to check for invalidation or\n                // enqueue an update.\n                if (prevSignature !== null) {\n                    // A boundary can become ineligible if its exports are incompatible\n                    // with the previous exports.\n                    //\n                    // For example, if you add/remove/change exports, we'll want to\n                    // re-execute the importing modules, and force those components to\n                    // re-render. Similarly, if you convert a class component to a\n                    // function, we want to invalidate the boundary.\n                    if (self.$RefreshHelpers$.shouldInvalidateReactRefreshBoundary(prevSignature, self.$RefreshHelpers$.getRefreshBoundarySignature(currentExports))) {\n                        module.hot.invalidate();\n                    }\n                    else {\n                        self.$RefreshHelpers$.scheduleUpdate();\n                    }\n                }\n            }\n            else {\n                // Since we just executed the code for the module, it's possible that the\n                // new exports made it ineligible for being a boundary.\n                // We only care about the case when we were _previously_ a boundary,\n                // because we already accepted this update (accidental side effect).\n                var isNoLongerABoundary = prevSignature !== null;\n                if (isNoLongerABoundary) {\n                    module.hot.invalidate();\n                }\n            }\n        }\n    })();\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFwcC1wYWdlcy1icm93c2VyKS8uL3dvcmtmbG93cy9lbnRpdGllcy13b3JrZmxvd3MvdGFzay53b3JrZmxvdy50cyIsIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7Ozs7QUFBQSxnREFBZ0Q7QUFDaEQsbUVBQW1FO0FBRXhCO0FBRWlDO0FBQzZCO0FBRXJDO0FBQ0o7QUFDc0I7QUFDaUI7QUFDdUM7QUFRekc7QUFFckMsTUFBTXdCLGVBQWU7SUFBQztJQUFVO0lBQVk7SUFBVTtJQUFlO0lBQVU7Q0FBZTtBQUM5RixNQUFNQyxxQkFBcUI7SUFBQztJQUFRO0lBQWU7SUFBUTtJQUFXO0lBQVc7Q0FBVztBQUVyRixlQUFlQyxhQUFhQyxJQUFVLEVBQUVDLFlBQW1CO1FBNEVsQ0Q7SUEzRTlCLG9CQUFvQjtJQUNwQixJQUFJLENBQUNDLGNBQWM7UUFDakIsTUFBTUMsWUFBWSxRQUFnQixPQUFSRixLQUFLRyxFQUFFLEVBQUM7UUFDbEMsSUFBSSxNQUFNM0IsdUVBQVNBLENBQUMwQixZQUFZO1FBRWhDLE1BQU01QixrRUFBZUEsQ0FBQyxRQUFRMEIsS0FBS0csRUFBRSxFQUFFLFdBQVc7WUFDaERDLE1BQU1KLEtBQUtJLElBQUk7WUFDZkMsUUFBUUwsS0FBS0ssTUFBTTtZQUNuQkMsU0FBU04sS0FBS00sT0FBTztRQUN2QjtRQUNBLE1BQU03Qix3RUFBVUEsQ0FBQ3lCO1FBQ2pCO0lBQ0Y7SUFFQSxpQ0FBaUM7SUFDakMsSUFBSUQsYUFBYUksTUFBTSxLQUFLTCxLQUFLSyxNQUFNLEVBQUU7UUFDdkNFLFFBQVFDLEdBQUcsQ0FBQyx1Q0FBZ0VSLE9BQXpCQyxhQUFhSSxNQUFNLEVBQUMsT0FBaUIsT0FBWkwsS0FBS0ssTUFBTTtRQUV2Riw0Q0FBNEM7UUFDNUMsTUFBTS9CLGtFQUFlQSxDQUFDLFFBQVEwQixLQUFLRyxFQUFFLEVBQUUsa0JBQWtCO1lBQ3ZETSxXQUFXUixhQUFhSSxNQUFNO1lBQzlCSyxXQUFXVixLQUFLSyxNQUFNO1lBQ3RCRCxNQUFNSixLQUFLSSxJQUFJO1lBQ2ZPLFlBQVksR0FBNEJYLE9BQXpCQyxhQUFhSSxNQUFNLEVBQUMsT0FBaUIsT0FBWkwsS0FBS0ssTUFBTTtZQUNuRE8sV0FBVyxJQUFJQyxPQUFPQyxXQUFXO1FBQ25DO1FBRUEsNENBQTRDO1FBQzVDLElBQUliLGFBQWFJLE1BQU0sS0FBSyxVQUFVTCxLQUFLSyxNQUFNLEtBQUssVUFBVUwsS0FBS0ssTUFBTSxLQUFLLGFBQWE7WUFDM0ZFLFFBQVFDLEdBQUcsQ0FBQyxvQ0FBa0RQLE9BQWRELEtBQUtJLElBQUksRUFBQyxNQUE2QkosT0FBekJDLGFBQWFJLE1BQU0sRUFBQyxPQUFpQixPQUFaTCxLQUFLSyxNQUFNLEVBQUM7WUFFbkcseUNBQXlDO1lBQ3pDLE1BQU1VLGVBQWVmLEtBQUtHLEVBQUU7UUFDOUI7SUFDRjtJQUVBLElBQUksQ0FBQ0YsYUFBYWUsTUFBTSxJQUFJaEIsS0FBS2dCLE1BQU0sRUFBRTtRQUN2QyxNQUFNMUMsa0VBQWVBLENBQUMsUUFBUTBCLEtBQUtHLEVBQUUsRUFBRSxRQUFRO1lBQzdDQyxNQUFNSixLQUFLSSxJQUFJO1lBQ2ZZLFFBQVFoQixLQUFLZ0IsTUFBTTtRQUNyQjtJQUNGO0lBRUEsSUFBSSxDQUFDZixhQUFhZ0IsV0FBVyxJQUFJakIsS0FBS2lCLFdBQVcsRUFBRTtRQUNqRCxNQUFNM0Msa0VBQWVBLENBQUMsUUFBUTBCLEtBQUtHLEVBQUUsRUFBRSxhQUFhO1lBQ2xEQyxNQUFNSixLQUFLSSxJQUFJO1lBQ2ZhLGFBQWFqQixLQUFLaUIsV0FBVztRQUMvQjtJQUNGO0lBRUEsNkJBQTZCO0lBQzdCLElBQUloQixhQUFhaUIsTUFBTSxLQUFLbEIsS0FBS2tCLE1BQU0sSUFBSWpCLGFBQWFrQixZQUFZLEtBQUtuQixLQUFLbUIsWUFBWSxFQUFFO1FBQzFGLE1BQU03QyxrRUFBZUEsQ0FBQyxRQUFRMEIsS0FBS0csRUFBRSxFQUFFLFNBQVM7WUFDOUNDLE1BQU1KLEtBQUtJLElBQUk7WUFDZmdCLFdBQVduQixhQUFhaUIsTUFBTTtZQUM5QkcsV0FBV3JCLEtBQUtrQixNQUFNO1lBQ3RCSSxpQkFBaUJyQixhQUFha0IsWUFBWTtZQUMxQ0ksaUJBQWlCdkIsS0FBS21CLFlBQVk7UUFDcEM7SUFDRjtJQUVBLDhEQUE4RDtJQUM5RCxJQUFJbkIsS0FBS3dCLGNBQWMsSUFBSXhCLEtBQUt5QixjQUFjLElBQUl6QixLQUFLSyxNQUFNLEtBQUssUUFBUTtRQUN4RSxNQUFNSCxZQUFZLFFBQWdCLE9BQVJGLEtBQUtHLEVBQUUsRUFBQztRQUNsQyxJQUFJLENBQUUsTUFBTTNCLHVFQUFTQSxDQUFDMEIsWUFBYTtZQUNqQ0ssUUFBUUMsR0FBRyxDQUFDLDJEQUFxRSxPQUFWUixLQUFLSSxJQUFJO1lBQ2hGLE1BQU1zQixjQUFjLE1BQU0xQyx3RUFBa0JBLENBQUNnQjtZQUM3QyxJQUFJMEIsYUFBYTtnQkFDZixNQUFNakQsd0VBQVVBLENBQUN5QjtnQkFDakJLLFFBQVFDLEdBQUcsQ0FBQyxvREFBcUUsT0FBakJrQixZQUFZdEIsSUFBSTtZQUNsRjtRQUNGO0lBQ0Y7SUFFQSx3REFBd0Q7SUFDeEQsSUFBSUosS0FBS0ssTUFBTSxLQUFLLFlBQVVMLGdCQUFBQSxLQUFLMkIsT0FBTyxjQUFaM0Isb0NBQUFBLGNBQWM0QixNQUFNLEdBQUU7UUFDbEQsTUFBTTFCLFlBQVksUUFBZ0IsT0FBUkYsS0FBS0csRUFBRSxFQUFDO1FBQ2xDLElBQUksQ0FBRSxNQUFNM0IsdUVBQVNBLENBQUMwQixZQUFhO1lBQ2pDSyxRQUFRQyxHQUFHLENBQUMsd0RBQWtFLE9BQVZSLEtBQUtJLElBQUk7WUFDN0UsTUFBTWxCLDBFQUFtQkEsQ0FBQ0Usc0VBQWVBLElBQUlZLEtBQUsyQixPQUFPLENBQUNDLE1BQU0sRUFBRTVCLEtBQUtHLEVBQUUsRUFBRTtZQUMzRSxNQUFNMUIsd0VBQVVBLENBQUN5QjtZQUNqQkssUUFBUUMsR0FBRyxDQUFDLCtEQUF5RSxPQUFWUixLQUFLSSxJQUFJO1FBQ3RGO0lBQ0Y7SUFFQSxzRUFBc0U7SUFDdEUsSUFBSUosS0FBSzZCLElBQUksSUFBSTdCLEtBQUs4QixPQUFPLEVBQUU7UUFDN0IsTUFBTTVCLFlBQVksUUFBZ0IsT0FBUkYsS0FBS0csRUFBRSxFQUFDO1FBQ2xDLElBQUksQ0FBRSxNQUFNM0IsdUVBQVNBLENBQUMwQixZQUFhO1lBQ2pDSyxRQUFRQyxHQUFHLENBQUMsdURBQWlFLE9BQVZSLEtBQUtJLElBQUk7WUFDNUUsTUFBTTJCLG1CQUFtQixNQUFNMUMsc0ZBQTZCQSxDQUFDVztZQUM3RCxJQUFJK0Isa0JBQWtCO2dCQUNwQixNQUFNdEQsd0VBQVVBLENBQUN5QjtnQkFDakJLLFFBQVFDLEdBQUcsQ0FBQyxnRUFBc0YsT0FBdEJ1QixpQkFBaUIzQixJQUFJO1lBQ25HO1FBQ0Y7SUFDRjtJQUVBLGlFQUFpRTtJQUNqRSxJQUFJSCxjQUFjO1FBQ2hCLGlDQUFpQztRQUNqQyxJQUFJUCxtRkFBd0JBLENBQUNNLE1BQU1DLGVBQWU7WUFDaERNLFFBQVFDLEdBQUcsQ0FBQywyREFBcUUsT0FBVlIsS0FBS0ksSUFBSTtZQUNoRixNQUFNYix5RkFBOEJBLENBQUNTLE1BQU1DO1FBQzdDO1FBRUEscUJBQXFCO1FBQ3JCLElBQUlOLGdGQUFxQkEsQ0FBQ0ssTUFBTUMsZUFBZTtZQUM3Q00sUUFBUUMsR0FBRyxDQUFDLHdEQUFrRSxPQUFWUixLQUFLSSxJQUFJO1lBQzdFLE1BQU1aLG1GQUF3QkEsQ0FBQ1EsTUFBTUM7UUFDdkM7UUFFQSxxQ0FBcUM7UUFDckMsSUFBSUwsNEVBQWlCQSxDQUFDSSxNQUFNQyxlQUFlO1lBQ3pDTSxRQUFRQyxHQUFHLENBQUMsd0RBQWtFLE9BQVZSLEtBQUtJLElBQUk7WUFDN0UsTUFBTVgsdUZBQTRCQSxDQUFDLFFBQVFPLE1BQU1DO1FBQ25EO0lBQ0Y7SUFFQSx3Q0FBd0M7SUFDeEMsS0FBSyxNQUFNK0IsU0FBU2xDLG1CQUFvQjtRQUN0QyxJQUFJLFlBQXFCLENBQUNrQyxNQUFNLEtBQUssSUFBYSxDQUFDQSxNQUFNLEVBQUU7WUFDekQsTUFBTXpELHVFQUFvQkEsQ0FBQyxRQUFReUIsS0FBS0csRUFBRSxFQUFFNkIsT0FBTyxZQUFxQixDQUFDQSxNQUFNLEVBQUUsSUFBYSxDQUFDQSxNQUFNO1FBQ3ZHO0lBQ0Y7QUFDRjtBQUVBOzs7Q0FHQyxHQUNNLGVBQWVDLDZCQUE2QkMsTUFBYztJQUMvRCxJQUFJO1FBQ0YzQixRQUFRQyxHQUFHLENBQUMsNkRBQW9FLE9BQVAwQjtRQUV6RSx1Q0FBdUM7UUFDdkMsTUFBTWpELDhFQUF3QkEsQ0FBQ2lEO1FBRS9CLG1EQUFtRDtRQUNuRCxNQUFNNUMsNEZBQW1DQSxDQUFDNEM7UUFFMUMsc0ZBQXNGO1FBQ3RGLE1BQU1DLDJCQUEyQkQ7UUFFakMsMkNBQTJDO1FBQzNDLE1BQU1FLFlBQVksTUFBTXRELGlFQUFXQSxDQUFDO1lBQUV1RCxNQUFNaEUsb0RBQVVBLENBQUNpRSxJQUFJO1lBQUVuQyxJQUFJK0I7UUFBTztRQUN4RTNCLFFBQVFDLEdBQUcsQ0FBQyx3Q0FBeUQsT0FBakI0QixVQUFVRyxNQUFNLEVBQUM7UUFFckUsS0FBSyxNQUFNQyxRQUFRSixVQUFXO1lBQzVCLElBQUk7Z0JBQ0YsTUFBTXJELGdFQUFVQSxDQUFDeUQsS0FBS3JDLEVBQUU7Z0JBQ3hCSSxRQUFRQyxHQUFHLENBQUMsa0RBQWdFLE9BQWRnQyxLQUFLQyxRQUFRO1lBQzdFLEVBQUUsT0FBT0MsT0FBTztnQkFDZG5DLFFBQVFtQyxLQUFLLENBQUMsMERBQWtFLE9BQVJGLEtBQUtyQyxFQUFFLEVBQUMsTUFBSXVDO1lBQ3RGO1FBQ0Y7UUFFQSw0QkFBNEI7UUFDNUIsTUFBTWhFLHlFQUFXQSxDQUFDLFFBQWUsT0FBUHdELFFBQU87UUFDakMsTUFBTXhELHlFQUFXQSxDQUFDLFFBQWUsT0FBUHdELFFBQU87UUFDakMsTUFBTXhELHlFQUFXQSxDQUFDLFFBQWUsT0FBUHdELFFBQU87UUFDakMsTUFBTXhELHlFQUFXQSxDQUFDLFFBQWUsT0FBUHdELFFBQU87UUFDakMsTUFBTXZELGtGQUFvQkEsQ0FBQyxRQUFRdUQsUUFBUTtRQUMzQyxNQUFNdkQsa0ZBQW9CQSxDQUFDLFFBQVF1RCxRQUFRO1FBRTNDLCtDQUErQztRQUMvQyx5REFBeUQ7UUFDekQsMkZBQTJGO1FBQzNGM0IsUUFBUUMsR0FBRyxDQUFDLGtGQUF5RixPQUFQMEI7UUFFOUYzQixRQUFRQyxHQUFHLENBQUMsNEVBQW1GLE9BQVAwQjtJQUMxRixFQUFFLE9BQU9RLE9BQU87UUFDZG5DLFFBQVFtQyxLQUFLLENBQUMsZ0NBQWdDQTtJQUNoRDtBQUNGO0FBRUE7OztDQUdDLEdBQ0QsZUFBZVAsMkJBQTJCRCxNQUFjO0lBQ3RELElBQUk7WUFPWWxDO1FBTmRPLFFBQVFDLEdBQUcsQ0FBQywwREFBaUUsT0FBUDBCO1FBRXRFLGdEQUFnRDtRQUNoRCxNQUFNUyxRQUFRLE1BQU0vRCxrRUFBV0E7UUFDL0IsTUFBTW9CLE9BQU8yQyxNQUFNQyxJQUFJLENBQUNDLENBQUFBLElBQUtBLEVBQUUxQyxFQUFFLEtBQUsrQjtRQUV0QyxJQUFJLENBQUNsQyxRQUFRLEdBQUNBLGdCQUFBQSxLQUFLMkIsT0FBTyxjQUFaM0Isb0NBQUFBLGNBQWM0QixNQUFNLEdBQUU7WUFDbENyQixRQUFRQyxHQUFHLENBQUMscUNBQTRDLE9BQVAwQixRQUFPO1lBQ3hEO1FBQ0Y7UUFFQSxzQkFBc0I7UUFDdEIsTUFBTVksZUFBZTFELHNFQUFlQTtRQUNwQyxNQUFNMkQsVUFBVSxNQUFNbEUsb0VBQWFBO1FBQ25DLE1BQU1tRSxhQUFhRCxRQUFRSCxJQUFJLENBQUNLLENBQUFBLElBQUtBLEVBQUU5QyxFQUFFLEtBQUsyQztRQUU5QyxJQUFJLENBQUNFLFlBQVk7WUFDZnpDLFFBQVFDLEdBQUcsQ0FBRTtZQUNiO1FBQ0Y7UUFFQSw0Q0FBNEM7UUFDNUMsTUFBTTBDLGlCQUFpQmxELEtBQUsyQixPQUFPLENBQUNDLE1BQU07UUFDMUMsTUFBTXVCLFlBQVksQ0FBQ0QsZUFBZUUsRUFBRSxJQUFJLEtBQUssS0FBSyxDQUFDRixlQUFlRyxFQUFFLElBQUksS0FBSyxLQUM1RCxDQUFDSCxlQUFlSSxFQUFFLElBQUksS0FBSyxLQUFLLENBQUNKLGVBQWVLLEVBQUUsSUFBSSxLQUFLO1FBRTVFLElBQUksQ0FBQ0osV0FBVztZQUNkNUMsUUFBUUMsR0FBRyxDQUFDLDhEQUFxRSxPQUFQMEI7WUFDMUU7UUFDRjtRQUVBLG9DQUFvQztRQUNwQyxNQUFNL0MsNkVBQXNCQSxDQUFDMkQsY0FBY0k7UUFDM0MzQyxRQUFRQyxHQUFHLENBQUMsOERBQTZGLE9BQS9CZ0QsS0FBS0MsU0FBUyxDQUFDUDtJQUUzRixFQUFFLE9BQU9SLE9BQU87UUFDZG5DLFFBQVFtQyxLQUFLLENBQUMsMEVBQWlGLE9BQVBSLFFBQU8sTUFBSVE7SUFDckc7QUFDRjtBQUVBOzs7O0NBSUMsR0FDTSxlQUFlM0IsZUFBZW1CLE1BQWM7SUFDakQsSUFBSTtRQUNGM0IsUUFBUUMsR0FBRyxDQUFDLHVDQUE4QyxPQUFQMEI7UUFFbkQsZUFBZTtRQUNmLE1BQU1TLFFBQVEsTUFBTS9ELGtFQUFXQTtRQUMvQixNQUFNb0IsT0FBTzJDLE1BQU1DLElBQUksQ0FBQ0MsQ0FBQUEsSUFBS0EsRUFBRTFDLEVBQUUsS0FBSytCO1FBRXRDLElBQUksQ0FBQ2xDLE1BQU07WUFDVE8sUUFBUUMsR0FBRyxDQUFDLHlCQUFnQyxPQUFQMEIsUUFBTztZQUM1QztRQUNGO1FBRUEsc0RBQXNEO1FBQ3RELElBQUksQ0FBQ2xDLEtBQUtnQixNQUFNLEVBQUU7WUFDaEJULFFBQVFDLEdBQUcsQ0FBQyx5QkFBZ0MsT0FBUDBCLFFBQU87WUFDNUM7UUFDRjtRQUVBM0IsUUFBUUMsR0FBRyxDQUFDLG1EQUE2RCxPQUFWUixLQUFLSSxJQUFJO1FBRXhFLHVDQUF1QztRQUN2QyxNQUFNbkIsOEVBQXdCQSxDQUFDaUQ7UUFDL0IzQixRQUFRQyxHQUFHLENBQUU7UUFFYix3Q0FBd0M7UUFDeEMsTUFBTTJCLDJCQUEyQkQ7UUFDakMzQixRQUFRQyxHQUFHLENBQUU7UUFFYixvQ0FBb0M7UUFDcEMsTUFBTTlCLHlFQUFXQSxDQUFDLFFBQWUsT0FBUHdELFFBQU87UUFDakMsTUFBTXhELHlFQUFXQSxDQUFDLFFBQWUsT0FBUHdELFFBQU87UUFDakMzQixRQUFRQyxHQUFHLENBQUU7UUFFYiwyQkFBMkI7UUFDM0IsTUFBTWxDLGtFQUFlQSxDQUFDLFFBQVE0RCxRQUFRLGVBQWU7WUFDbkQ5QixNQUFNSixLQUFLSSxJQUFJO1lBQ2ZzRCxnQkFBZ0I7WUFDaEJDLGVBQWUsSUFBSTlDLE9BQU9DLFdBQVc7UUFDdkM7UUFDQVAsUUFBUUMsR0FBRyxDQUFFO1FBRWJELFFBQVFDLEdBQUcsQ0FBQyxxREFBK0QsT0FBVlIsS0FBS0ksSUFBSTtJQUU1RSxFQUFFLE9BQU9zQyxPQUFPO1FBQ2RuQyxRQUFRbUMsS0FBSyxDQUFDLGdEQUF1RCxPQUFQUixRQUFPLE1BQUlRO1FBQ3pFLE1BQU1BO0lBQ1I7QUFDRiIsInNvdXJjZXMiOlsid2VicGFjazovL19OX0UvLi93b3JrZmxvd3MvZW50aXRpZXMtd29ya2Zsb3dzL3Rhc2sud29ya2Zsb3cudHM/Nzg2OSJdLCJzb3VyY2VzQ29udGVudCI6WyIvLyB3b3JrZmxvd3MvZW50aXRpZXMtd29ya2Zsb3dzL3Rhc2sud29ya2Zsb3cudHNcclxuLy8gVGFzay1zcGVjaWZpYyB3b3JrZmxvdyB3aXRoIHN0YXRlIHZzIGRlc2NyaXB0aXZlIGZpZWxkIGRldGVjdGlvblxyXG5cclxuaW1wb3J0IHsgRW50aXR5VHlwZSB9IGZyb20gJ0AvdHlwZXMvZW51bXMnO1xyXG5pbXBvcnQgdHlwZSB7IFRhc2sgfSBmcm9tICdAL3R5cGVzL2VudGl0aWVzJztcclxuaW1wb3J0IHsgYXBwZW5kRW50aXR5TG9nLCB1cGRhdGVFbnRpdHlMb2dGaWVsZCB9IGZyb20gJy4uL2VudGl0aWVzLWxvZ2dpbmcnO1xyXG5pbXBvcnQgeyBoYXNFZmZlY3QsIG1hcmtFZmZlY3QsIGNsZWFyRWZmZWN0LCBjbGVhckVmZmVjdHNCeVByZWZpeCB9IGZyb20gJ0AvZGF0YS1zdG9yZS9lZmZlY3RzLXJlZ2lzdHJ5JztcclxuaW1wb3J0IHsgQ2xpZW50QVBJIH0gZnJvbSAnQC9saWIvY2xpZW50LWFwaSc7XHJcbmltcG9ydCB7IGdldEFsbFRhc2tzLCBnZXRBbGxQbGF5ZXJzIH0gZnJvbSAnQC9kYXRhLXN0b3JlL2RhdGFzdG9yZSc7XHJcbmltcG9ydCB7IGdldExpbmtzRm9yLCByZW1vdmVMaW5rIH0gZnJvbSAnQC9saW5rcy9saW5rLXJlZ2lzdHJ5JztcclxuaW1wb3J0IHsgY3JlYXRlSXRlbUZyb21UYXNrLCByZW1vdmVJdGVtc0NyZWF0ZWRCeVRhc2sgfSBmcm9tICcuLi9pdGVtLWNyZWF0aW9uLXV0aWxzJztcclxuaW1wb3J0IHsgYXdhcmRQb2ludHNUb1BsYXllciwgcmVtb3ZlUG9pbnRzRnJvbVBsYXllciwgZ2V0TWFpblBsYXllcklkIH0gZnJvbSAnLi4vcG9pbnRzLXJld2FyZHMtdXRpbHMnO1xyXG5pbXBvcnQgeyBjcmVhdGVGaW5hbmNpYWxSZWNvcmRGcm9tVGFzaywgdXBkYXRlRmluYW5jaWFsUmVjb3JkRnJvbVRhc2ssIHJlbW92ZUZpbmFuY2lhbFJlY29yZHNDcmVhdGVkQnlUYXNrIH0gZnJvbSAnLi4vZmluYW5jaWFsLXJlY29yZC11dGlscyc7XHJcbmltcG9ydCB7IFxyXG4gIHVwZGF0ZUZpbmFuY2lhbFJlY29yZHNGcm9tVGFzaywgXHJcbiAgdXBkYXRlSXRlbXNDcmVhdGVkQnlUYXNrLCBcclxuICB1cGRhdGVQbGF5ZXJQb2ludHNGcm9tU291cmNlLFxyXG4gIGhhc0ZpbmFuY2lhbFByb3BzQ2hhbmdlZCxcclxuICBoYXNPdXRwdXRQcm9wc0NoYW5nZWQsXHJcbiAgaGFzUmV3YXJkc0NoYW5nZWRcclxufSBmcm9tICcuLi91cGRhdGUtcHJvcGFnYXRpb24tdXRpbHMnO1xyXG5cclxuY29uc3QgU1RBVEVfRklFTERTID0gWydzdGF0dXMnLCAncHJvZ3Jlc3MnLCAnZG9uZUF0JywgJ2NvbGxlY3RlZEF0JywgJ3NpdGVJZCcsICd0YXJnZXRTaXRlSWQnXTtcclxuY29uc3QgREVTQ1JJUFRJVkVfRklFTERTID0gWyduYW1lJywgJ2Rlc2NyaXB0aW9uJywgJ2Nvc3QnLCAncmV2ZW51ZScsICdyZXdhcmRzJywgJ3ByaW9yaXR5J107XHJcblxyXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gb25UYXNrVXBzZXJ0KHRhc2s6IFRhc2ssIHByZXZpb3VzVGFzaz86IFRhc2spOiBQcm9taXNlPHZvaWQ+IHtcclxuICAvLyBOZXcgdGFzayBjcmVhdGlvblxyXG4gIGlmICghcHJldmlvdXNUYXNrKSB7XHJcbiAgICBjb25zdCBlZmZlY3RLZXkgPSBgdGFzazoke3Rhc2suaWR9OmNyZWF0ZWRgO1xyXG4gICAgaWYgKGF3YWl0IGhhc0VmZmVjdChlZmZlY3RLZXkpKSByZXR1cm47XHJcbiAgICBcclxuICAgIGF3YWl0IGFwcGVuZEVudGl0eUxvZygndGFzaycsIHRhc2suaWQsICdDUkVBVEVEJywgeyBcclxuICAgICAgbmFtZTogdGFzay5uYW1lLCBcclxuICAgICAgc3RhdHVzOiB0YXNrLnN0YXR1cyxcclxuICAgICAgc3RhdGlvbjogdGFzay5zdGF0aW9uIFxyXG4gICAgfSk7XHJcbiAgICBhd2FpdCBtYXJrRWZmZWN0KGVmZmVjdEtleSk7XHJcbiAgICByZXR1cm47XHJcbiAgfVxyXG4gIFxyXG4gIC8vIFN0YXRlIGNoYW5nZXMgLSBhcHBlbmQgbmV3IGxvZ1xyXG4gIGlmIChwcmV2aW91c1Rhc2suc3RhdHVzICE9PSB0YXNrLnN0YXR1cykge1xyXG4gICAgY29uc29sZS5sb2coYFtvblRhc2tVcHNlcnRdIFRhc2sgc3RhdHVzIGNoYW5nZWQ6ICR7cHJldmlvdXNUYXNrLnN0YXR1c30g4oaSICR7dGFzay5zdGF0dXN9YCk7XHJcbiAgICBcclxuICAgIC8vIExvZyBzdGF0dXMgY2hhbmdlIHdpdGggdHJhbnNpdGlvbiBjb250ZXh0XHJcbiAgICBhd2FpdCBhcHBlbmRFbnRpdHlMb2coJ3Rhc2snLCB0YXNrLmlkLCAnU1RBVFVTX0NIQU5HRUQnLCB7XHJcbiAgICAgIG9sZFN0YXR1czogcHJldmlvdXNUYXNrLnN0YXR1cyxcclxuICAgICAgbmV3U3RhdHVzOiB0YXNrLnN0YXR1cyxcclxuICAgICAgbmFtZTogdGFzay5uYW1lLFxyXG4gICAgICB0cmFuc2l0aW9uOiBgJHtwcmV2aW91c1Rhc2suc3RhdHVzfSDihpIgJHt0YXNrLnN0YXR1c31gLFxyXG4gICAgICBjaGFuZ2VkQXQ6IG5ldyBEYXRlKCkudG9JU09TdHJpbmcoKVxyXG4gICAgfSk7XHJcbiAgICBcclxuICAgIC8vIEhhbmRsZSB1bmNvbXBsZXRpb24gKERvbmUg4oaSIE90aGVyIHN0YXR1cylcclxuICAgIGlmIChwcmV2aW91c1Rhc2suc3RhdHVzID09PSAnRG9uZScgJiYgdGFzay5zdGF0dXMgIT09ICdEb25lJyAmJiB0YXNrLnN0YXR1cyAhPT0gJ0NvbGxlY3RlZCcpIHtcclxuICAgICAgY29uc29sZS5sb2coYFtvblRhc2tVcHNlcnRdIFRhc2sgdW5jb21wbGV0ZWQ6ICR7dGFzay5uYW1lfSAoJHtwcmV2aW91c1Rhc2suc3RhdHVzfSDihpIgJHt0YXNrLnN0YXR1c30pYCk7XHJcbiAgICAgIFxyXG4gICAgICAvLyBVbmNvbXBsZXRlIHRoZSB0YXNrIGFuZCByZW1vdmUgZWZmZWN0c1xyXG4gICAgICBhd2FpdCB1bmNvbXBsZXRlVGFzayh0YXNrLmlkKTtcclxuICAgIH1cclxuICB9XHJcbiAgXHJcbiAgaWYgKCFwcmV2aW91c1Rhc2suZG9uZUF0ICYmIHRhc2suZG9uZUF0KSB7XHJcbiAgICBhd2FpdCBhcHBlbmRFbnRpdHlMb2coJ3Rhc2snLCB0YXNrLmlkLCAnRE9ORScsIHtcclxuICAgICAgbmFtZTogdGFzay5uYW1lLFxyXG4gICAgICBkb25lQXQ6IHRhc2suZG9uZUF0XHJcbiAgICB9KTtcclxuICB9XHJcbiAgXHJcbiAgaWYgKCFwcmV2aW91c1Rhc2suY29sbGVjdGVkQXQgJiYgdGFzay5jb2xsZWN0ZWRBdCkge1xyXG4gICAgYXdhaXQgYXBwZW5kRW50aXR5TG9nKCd0YXNrJywgdGFzay5pZCwgJ0NPTExFQ1RFRCcsIHtcclxuICAgICAgbmFtZTogdGFzay5uYW1lLFxyXG4gICAgICBjb2xsZWN0ZWRBdDogdGFzay5jb2xsZWN0ZWRBdFxyXG4gICAgfSk7XHJcbiAgfVxyXG4gIFxyXG4gIC8vIFNpdGUgY2hhbmdlcyAtIE1PVkVEIGV2ZW50XHJcbiAgaWYgKHByZXZpb3VzVGFzay5zaXRlSWQgIT09IHRhc2suc2l0ZUlkIHx8IHByZXZpb3VzVGFzay50YXJnZXRTaXRlSWQgIT09IHRhc2sudGFyZ2V0U2l0ZUlkKSB7XHJcbiAgICBhd2FpdCBhcHBlbmRFbnRpdHlMb2coJ3Rhc2snLCB0YXNrLmlkLCAnTU9WRUQnLCB7XHJcbiAgICAgIG5hbWU6IHRhc2submFtZSxcclxuICAgICAgb2xkU2l0ZUlkOiBwcmV2aW91c1Rhc2suc2l0ZUlkLFxyXG4gICAgICBuZXdTaXRlSWQ6IHRhc2suc2l0ZUlkLFxyXG4gICAgICBvbGRUYXJnZXRTaXRlSWQ6IHByZXZpb3VzVGFzay50YXJnZXRTaXRlSWQsXHJcbiAgICAgIG5ld1RhcmdldFNpdGVJZDogdGFzay50YXJnZXRTaXRlSWRcclxuICAgIH0pO1xyXG4gIH1cclxuICBcclxuICAvLyBJdGVtIGNyZWF0aW9uIGZyb20gZW1pc3NhcnkgZmllbGRzIC0gd2hlbiB0YXNrIGlzIGNvbXBsZXRlZFxyXG4gIGlmICh0YXNrLm91dHB1dEl0ZW1UeXBlICYmIHRhc2sub3V0cHV0UXVhbnRpdHkgJiYgdGFzay5zdGF0dXMgPT09ICdEb25lJykge1xyXG4gICAgY29uc3QgZWZmZWN0S2V5ID0gYHRhc2s6JHt0YXNrLmlkfTppdGVtQ3JlYXRlZGA7XHJcbiAgICBpZiAoIShhd2FpdCBoYXNFZmZlY3QoZWZmZWN0S2V5KSkpIHtcclxuICAgICAgY29uc29sZS5sb2coYFtvblRhc2tVcHNlcnRdIENyZWF0aW5nIGl0ZW0gZnJvbSB0YXNrIGVtaXNzYXJ5IGZpZWxkczogJHt0YXNrLm5hbWV9YCk7XHJcbiAgICAgIGNvbnN0IGNyZWF0ZWRJdGVtID0gYXdhaXQgY3JlYXRlSXRlbUZyb21UYXNrKHRhc2spO1xyXG4gICAgICBpZiAoY3JlYXRlZEl0ZW0pIHtcclxuICAgICAgICBhd2FpdCBtYXJrRWZmZWN0KGVmZmVjdEtleSk7XHJcbiAgICAgICAgY29uc29sZS5sb2coYFtvblRhc2tVcHNlcnRdIOKchSBJdGVtIGNyZWF0ZWQgYW5kIGVmZmVjdCBtYXJrZWQ6ICR7Y3JlYXRlZEl0ZW0ubmFtZX1gKTtcclxuICAgICAgfVxyXG4gICAgfVxyXG4gIH1cclxuICBcclxuICAvLyBQb2ludHMgYXdhcmRpbmcgLSB3aGVuIHRhc2sgaXMgY29tcGxldGVkIHdpdGggcmV3YXJkc1xyXG4gIGlmICh0YXNrLnN0YXR1cyA9PT0gJ0RvbmUnICYmIHRhc2sucmV3YXJkcz8ucG9pbnRzKSB7XHJcbiAgICBjb25zdCBlZmZlY3RLZXkgPSBgdGFzazoke3Rhc2suaWR9OnBvaW50c0F3YXJkZWRgO1xyXG4gICAgaWYgKCEoYXdhaXQgaGFzRWZmZWN0KGVmZmVjdEtleSkpKSB7XHJcbiAgICAgIGNvbnNvbGUubG9nKGBbb25UYXNrVXBzZXJ0XSBBd2FyZGluZyBwb2ludHMgZnJvbSB0YXNrIGNvbXBsZXRpb246ICR7dGFzay5uYW1lfWApO1xyXG4gICAgICBhd2FpdCBhd2FyZFBvaW50c1RvUGxheWVyKGdldE1haW5QbGF5ZXJJZCgpLCB0YXNrLnJld2FyZHMucG9pbnRzLCB0YXNrLmlkLCAndGFzaycpO1xyXG4gICAgICBhd2FpdCBtYXJrRWZmZWN0KGVmZmVjdEtleSk7XHJcbiAgICAgIGNvbnNvbGUubG9nKGBbb25UYXNrVXBzZXJ0XSDinIUgUG9pbnRzIGF3YXJkZWQgYW5kIGVmZmVjdCBtYXJrZWQgZm9yIHRhc2s6ICR7dGFzay5uYW1lfWApO1xyXG4gICAgfVxyXG4gIH1cclxuICBcclxuICAvLyBGaW5hbmNpYWwgcmVjb3JkIGNyZWF0aW9uIGZyb20gdGFzayAtIHdoZW4gdGFzayBoYXMgY29zdCBvciByZXZlbnVlXHJcbiAgaWYgKHRhc2suY29zdCB8fCB0YXNrLnJldmVudWUpIHtcclxuICAgIGNvbnN0IGVmZmVjdEtleSA9IGB0YXNrOiR7dGFzay5pZH06ZmluYW5jaWFsQ3JlYXRlZGA7XHJcbiAgICBpZiAoIShhd2FpdCBoYXNFZmZlY3QoZWZmZWN0S2V5KSkpIHtcclxuICAgICAgY29uc29sZS5sb2coYFtvblRhc2tVcHNlcnRdIENyZWF0aW5nIGZpbmFuY2lhbCByZWNvcmQgZnJvbSB0YXNrOiAke3Rhc2submFtZX1gKTtcclxuICAgICAgY29uc3QgY3JlYXRlZEZpbmFuY2lhbCA9IGF3YWl0IGNyZWF0ZUZpbmFuY2lhbFJlY29yZEZyb21UYXNrKHRhc2spO1xyXG4gICAgICBpZiAoY3JlYXRlZEZpbmFuY2lhbCkge1xyXG4gICAgICAgIGF3YWl0IG1hcmtFZmZlY3QoZWZmZWN0S2V5KTtcclxuICAgICAgICBjb25zb2xlLmxvZyhgW29uVGFza1Vwc2VydF0g4pyFIEZpbmFuY2lhbCByZWNvcmQgY3JlYXRlZCBhbmQgZWZmZWN0IG1hcmtlZDogJHtjcmVhdGVkRmluYW5jaWFsLm5hbWV9YCk7XHJcbiAgICAgIH1cclxuICAgIH1cclxuICB9XHJcbiAgXHJcbiAgLy8gQ09NUFJFSEVOU0lWRSBVUERBVEUgUFJPUEFHQVRJT04gLSB3aGVuIHRhc2sgcHJvcGVydGllcyBjaGFuZ2VcclxuICBpZiAocHJldmlvdXNUYXNrKSB7XHJcbiAgICAvLyBQcm9wYWdhdGUgdG8gRmluYW5jaWFsIFJlY29yZHNcclxuICAgIGlmIChoYXNGaW5hbmNpYWxQcm9wc0NoYW5nZWQodGFzaywgcHJldmlvdXNUYXNrKSkge1xyXG4gICAgICBjb25zb2xlLmxvZyhgW29uVGFza1Vwc2VydF0gUHJvcGFnYXRpbmcgZmluYW5jaWFsIGNoYW5nZXMgZnJvbSB0YXNrOiAke3Rhc2submFtZX1gKTtcclxuICAgICAgYXdhaXQgdXBkYXRlRmluYW5jaWFsUmVjb3Jkc0Zyb21UYXNrKHRhc2ssIHByZXZpb3VzVGFzayk7XHJcbiAgICB9XHJcbiAgICBcclxuICAgIC8vIFByb3BhZ2F0ZSB0byBJdGVtc1xyXG4gICAgaWYgKGhhc091dHB1dFByb3BzQ2hhbmdlZCh0YXNrLCBwcmV2aW91c1Rhc2spKSB7XHJcbiAgICAgIGNvbnNvbGUubG9nKGBbb25UYXNrVXBzZXJ0XSBQcm9wYWdhdGluZyBvdXRwdXQgY2hhbmdlcyBmcm9tIHRhc2s6ICR7dGFzay5uYW1lfWApO1xyXG4gICAgICBhd2FpdCB1cGRhdGVJdGVtc0NyZWF0ZWRCeVRhc2sodGFzaywgcHJldmlvdXNUYXNrKTtcclxuICAgIH1cclxuICAgIFxyXG4gICAgLy8gUHJvcGFnYXRlIHRvIFBsYXllciAocG9pbnRzIGRlbHRhKVxyXG4gICAgaWYgKGhhc1Jld2FyZHNDaGFuZ2VkKHRhc2ssIHByZXZpb3VzVGFzaykpIHtcclxuICAgICAgY29uc29sZS5sb2coYFtvblRhc2tVcHNlcnRdIFByb3BhZ2F0aW5nIHBvaW50cyBjaGFuZ2VzIGZyb20gdGFzazogJHt0YXNrLm5hbWV9YCk7XHJcbiAgICAgIGF3YWl0IHVwZGF0ZVBsYXllclBvaW50c0Zyb21Tb3VyY2UoJ3Rhc2snLCB0YXNrLCBwcmV2aW91c1Rhc2spO1xyXG4gICAgfVxyXG4gIH1cclxuICBcclxuICAvLyBEZXNjcmlwdGl2ZSBjaGFuZ2VzIC0gdXBkYXRlIGluLXBsYWNlXHJcbiAgZm9yIChjb25zdCBmaWVsZCBvZiBERVNDUklQVElWRV9GSUVMRFMpIHtcclxuICAgIGlmICgocHJldmlvdXNUYXNrIGFzIGFueSlbZmllbGRdICE9PSAodGFzayBhcyBhbnkpW2ZpZWxkXSkge1xyXG4gICAgICBhd2FpdCB1cGRhdGVFbnRpdHlMb2dGaWVsZCgndGFzaycsIHRhc2suaWQsIGZpZWxkLCAocHJldmlvdXNUYXNrIGFzIGFueSlbZmllbGRdLCAodGFzayBhcyBhbnkpW2ZpZWxkXSk7XHJcbiAgICB9XHJcbiAgfVxyXG59XHJcblxyXG4vKipcclxuICogUmVtb3ZlIHRhc2sgZWZmZWN0cyB3aGVuIHRhc2sgaXMgZGVsZXRlZFxyXG4gKiBUYXNrcyBjYW4gaGF2ZSBlbnRyaWVzIGluIG11bHRpcGxlIGxvZ3M6IHRhc2tzLCBmaW5hbmNpYWxzLCBjaGFyYWN0ZXIsIHBsYXllciwgaXRlbXNcclxuICovXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiByZW1vdmVUYXNrTG9nRW50cmllc09uRGVsZXRlKHRhc2tJZDogc3RyaW5nKTogUHJvbWlzZTx2b2lkPiB7XHJcbiAgdHJ5IHtcclxuICAgIGNvbnNvbGUubG9nKGBbcmVtb3ZlVGFza0xvZ0VudHJpZXNPbkRlbGV0ZV0gU3RhcnRpbmcgY2xlYW51cCBmb3IgdGFzazogJHt0YXNrSWR9YCk7XHJcbiAgICBcclxuICAgIC8vIDEuIFJlbW92ZSBpdGVtcyBjcmVhdGVkIGJ5IHRoaXMgdGFza1xyXG4gICAgYXdhaXQgcmVtb3ZlSXRlbXNDcmVhdGVkQnlUYXNrKHRhc2tJZCk7XHJcbiAgICBcclxuICAgIC8vIDIuIFJlbW92ZSBmaW5hbmNpYWwgcmVjb3JkcyBjcmVhdGVkIGJ5IHRoaXMgdGFza1xyXG4gICAgYXdhaXQgcmVtb3ZlRmluYW5jaWFsUmVjb3Jkc0NyZWF0ZWRCeVRhc2sodGFza0lkKTtcclxuICAgIFxyXG4gICAgLy8gMy4gUmVtb3ZlIHBsYXllciBwb2ludHMgdGhhdCB3ZXJlIGF3YXJkZWQgYnkgdGhpcyB0YXNrIChpZiBwb2ludHMgd2VyZSBiYWRseSBnaXZlbilcclxuICAgIGF3YWl0IHJlbW92ZVBsYXllclBvaW50c0Zyb21UYXNrKHRhc2tJZCk7XHJcbiAgICBcclxuICAgIC8vIDMuIFJlbW92ZSBhbGwgTGlua3MgcmVsYXRlZCB0byB0aGlzIHRhc2tcclxuICAgIGNvbnN0IHRhc2tMaW5rcyA9IGF3YWl0IGdldExpbmtzRm9yKHsgdHlwZTogRW50aXR5VHlwZS5UQVNLLCBpZDogdGFza0lkIH0pO1xyXG4gICAgY29uc29sZS5sb2coYFtyZW1vdmVUYXNrTG9nRW50cmllc09uRGVsZXRlXSBGb3VuZCAke3Rhc2tMaW5rcy5sZW5ndGh9IGxpbmtzIHRvIHJlbW92ZWApO1xyXG4gICAgXHJcbiAgICBmb3IgKGNvbnN0IGxpbmsgb2YgdGFza0xpbmtzKSB7XHJcbiAgICAgIHRyeSB7XHJcbiAgICAgICAgYXdhaXQgcmVtb3ZlTGluayhsaW5rLmlkKTtcclxuICAgICAgICBjb25zb2xlLmxvZyhgW3JlbW92ZVRhc2tMb2dFbnRyaWVzT25EZWxldGVdIOKchSBSZW1vdmVkIGxpbms6ICR7bGluay5saW5rVHlwZX1gKTtcclxuICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcclxuICAgICAgICBjb25zb2xlLmVycm9yKGBbcmVtb3ZlVGFza0xvZ0VudHJpZXNPbkRlbGV0ZV0g4p2MIEZhaWxlZCB0byByZW1vdmUgbGluayAke2xpbmsuaWR9OmAsIGVycm9yKTtcclxuICAgICAgfVxyXG4gICAgfVxyXG4gICAgXHJcbiAgICAvLyA0LiBDbGVhciBlZmZlY3RzIHJlZ2lzdHJ5XHJcbiAgICBhd2FpdCBjbGVhckVmZmVjdChgdGFzazoke3Rhc2tJZH06Y3JlYXRlZGApO1xyXG4gICAgYXdhaXQgY2xlYXJFZmZlY3QoYHRhc2s6JHt0YXNrSWR9Oml0ZW1DcmVhdGVkYCk7XHJcbiAgICBhd2FpdCBjbGVhckVmZmVjdChgdGFzazoke3Rhc2tJZH06ZmluYW5jaWFsQ3JlYXRlZGApO1xyXG4gICAgYXdhaXQgY2xlYXJFZmZlY3QoYHRhc2s6JHt0YXNrSWR9OnBvaW50c0F3YXJkZWRgKTtcclxuICAgIGF3YWl0IGNsZWFyRWZmZWN0c0J5UHJlZml4KCd0YXNrJywgdGFza0lkLCAncG9pbnRzTG9nZ2VkOicpO1xyXG4gICAgYXdhaXQgY2xlYXJFZmZlY3RzQnlQcmVmaXgoJ3Rhc2snLCB0YXNrSWQsICdmaW5hbmNpYWxMb2dnZWQ6Jyk7XHJcbiAgICBcclxuICAgIC8vIDUuIFJlbW92ZSBsb2cgZW50cmllcyBmcm9tIGFsbCByZWxldmFudCBsb2dzXHJcbiAgICAvLyBOb3RlOiBMb2cgcmVtb3ZhbCBpcyBoYW5kbGVkIGNsaWVudC1zaWRlIHZpYSBBUEkgY2FsbHNcclxuICAgIC8vIFNlcnZlci1zaWRlIGxvZyByZW1vdmFsIHdvdWxkIHJlcXVpcmUgaW1wbGVtZW50aW5nIHJlbW92ZUxvZ0VudHJ5IGluIGVudGl0aWVzLWxvZ2dpbmcudHNcclxuICAgIGNvbnNvbGUubG9nKGBbcmVtb3ZlVGFza0xvZ0VudHJpZXNPbkRlbGV0ZV0gTG9nIGVudHJ5IHJlbW92YWwgaGFuZGxlZCBjbGllbnQtc2lkZSBmb3IgdGFzazogJHt0YXNrSWR9YCk7XHJcbiAgICBcclxuICAgIGNvbnNvbGUubG9nKGBbcmVtb3ZlVGFza0xvZ0VudHJpZXNPbkRlbGV0ZV0g4pyFIENsZWFyZWQgZWZmZWN0cywgcmVtb3ZlZCBsaW5rcyBmb3IgdGFzayAke3Rhc2tJZH1gKTtcclxuICB9IGNhdGNoIChlcnJvcikge1xyXG4gICAgY29uc29sZS5lcnJvcignRXJyb3IgcmVtb3ZpbmcgdGFzayBlZmZlY3RzOicsIGVycm9yKTtcclxuICB9XHJcbn1cclxuXHJcbi8qKlxyXG4gKiBSZW1vdmUgcGxheWVyIHBvaW50cyB0aGF0IHdlcmUgYXdhcmRlZCBieSBhIHNwZWNpZmljIHRhc2tcclxuICogVGhpcyBpcyB1c2VkIHdoZW4gcm9sbGluZyBiYWNrIGEgdGFzayB0aGF0IGluY29ycmVjdGx5IGF3YXJkZWQgcG9pbnRzXHJcbiAqL1xyXG5hc3luYyBmdW5jdGlvbiByZW1vdmVQbGF5ZXJQb2ludHNGcm9tVGFzayh0YXNrSWQ6IHN0cmluZyk6IFByb21pc2U8dm9pZD4ge1xyXG4gIHRyeSB7XHJcbiAgICBjb25zb2xlLmxvZyhgW3JlbW92ZVBsYXllclBvaW50c0Zyb21UYXNrXSBSZW1vdmluZyBwb2ludHMgZm9yIHRhc2s6ICR7dGFza0lkfWApO1xyXG4gICAgXHJcbiAgICAvLyBHZXQgdGhlIHRhc2sgdG8gZmluZCB3aGF0IHBvaW50cyB3ZXJlIGF3YXJkZWRcclxuICAgIGNvbnN0IHRhc2tzID0gYXdhaXQgZ2V0QWxsVGFza3MoKTtcclxuICAgIGNvbnN0IHRhc2sgPSB0YXNrcy5maW5kKHQgPT4gdC5pZCA9PT0gdGFza0lkKTtcclxuICAgIFxyXG4gICAgaWYgKCF0YXNrIHx8ICF0YXNrLnJld2FyZHM/LnBvaW50cykge1xyXG4gICAgICBjb25zb2xlLmxvZyhgW3JlbW92ZVBsYXllclBvaW50c0Zyb21UYXNrXSBUYXNrICR7dGFza0lkfSBoYXMgbm8gcG9pbnRzIHRvIHJlbW92ZWApO1xyXG4gICAgICByZXR1cm47XHJcbiAgICB9XHJcbiAgICBcclxuICAgIC8vIEdldCB0aGUgbWFpbiBwbGF5ZXJcclxuICAgIGNvbnN0IG1haW5QbGF5ZXJJZCA9IGdldE1haW5QbGF5ZXJJZCgpO1xyXG4gICAgY29uc3QgcGxheWVycyA9IGF3YWl0IGdldEFsbFBsYXllcnMoKTtcclxuICAgIGNvbnN0IG1haW5QbGF5ZXIgPSBwbGF5ZXJzLmZpbmQocCA9PiBwLmlkID09PSBtYWluUGxheWVySWQpO1xyXG4gICAgXHJcbiAgICBpZiAoIW1haW5QbGF5ZXIpIHtcclxuICAgICAgY29uc29sZS5sb2coYFtyZW1vdmVQbGF5ZXJQb2ludHNGcm9tVGFza10gTWFpbiBwbGF5ZXIgbm90IGZvdW5kLCBza2lwcGluZyBwb2ludHMgcmVtb3ZhbGApO1xyXG4gICAgICByZXR1cm47XHJcbiAgICB9XHJcbiAgICBcclxuICAgIC8vIENoZWNrIGlmIGFueSBwb2ludHMgd2VyZSBhY3R1YWxseSBhd2FyZGVkXHJcbiAgICBjb25zdCBwb2ludHNUb1JlbW92ZSA9IHRhc2sucmV3YXJkcy5wb2ludHM7XHJcbiAgICBjb25zdCBoYXNQb2ludHMgPSAocG9pbnRzVG9SZW1vdmUueHAgfHwgMCkgPiAwIHx8IChwb2ludHNUb1JlbW92ZS5ycCB8fCAwKSA+IDAgfHwgXHJcbiAgICAgICAgICAgICAgICAgICAgIChwb2ludHNUb1JlbW92ZS5mcCB8fCAwKSA+IDAgfHwgKHBvaW50c1RvUmVtb3ZlLmhwIHx8IDApID4gMDtcclxuICAgIFxyXG4gICAgaWYgKCFoYXNQb2ludHMpIHtcclxuICAgICAgY29uc29sZS5sb2coYFtyZW1vdmVQbGF5ZXJQb2ludHNGcm9tVGFza10gTm8gcG9pbnRzIHRvIHJlbW92ZSBmcm9tIHRhc2sgJHt0YXNrSWR9YCk7XHJcbiAgICAgIHJldHVybjtcclxuICAgIH1cclxuICAgIFxyXG4gICAgLy8gUmVtb3ZlIHRoZSBwb2ludHMgZnJvbSB0aGUgcGxheWVyXHJcbiAgICBhd2FpdCByZW1vdmVQb2ludHNGcm9tUGxheWVyKG1haW5QbGF5ZXJJZCwgcG9pbnRzVG9SZW1vdmUpO1xyXG4gICAgY29uc29sZS5sb2coYFtyZW1vdmVQbGF5ZXJQb2ludHNGcm9tVGFza10g4pyFIFJlbW92ZWQgcG9pbnRzIGZyb20gcGxheWVyOiAke0pTT04uc3RyaW5naWZ5KHBvaW50c1RvUmVtb3ZlKX1gKTtcclxuICAgIFxyXG4gIH0gY2F0Y2ggKGVycm9yKSB7XHJcbiAgICBjb25zb2xlLmVycm9yKGBbcmVtb3ZlUGxheWVyUG9pbnRzRnJvbVRhc2tdIOKdjCBGYWlsZWQgdG8gcmVtb3ZlIHBsYXllciBwb2ludHMgZm9yIHRhc2sgJHt0YXNrSWR9OmAsIGVycm9yKTtcclxuICB9XHJcbn1cclxuXHJcbi8qKlxyXG4gKiBVbmNvbXBsZXRlIGEgdGFzayBhbmQgcmVtb3ZlIGVmZmVjdHNcclxuICogVGhpcyBmdW5jdGlvbiBoYW5kbGVzIHdoZW4gYSB0YXNrIHN0YXR1cyBjaGFuZ2VzIGJhY2sgZnJvbSBEb25lXHJcbiAqIFJldmVyc2VzIGFsbCBzaWRlIGVmZmVjdHMgdGhhdCB3ZXJlIGFwcGxpZWQgZHVyaW5nIGNvbXBsZXRpb25cclxuICovXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiB1bmNvbXBsZXRlVGFzayh0YXNrSWQ6IHN0cmluZyk6IFByb21pc2U8dm9pZD4ge1xyXG4gIHRyeSB7XHJcbiAgICBjb25zb2xlLmxvZyhgW3VuY29tcGxldGVUYXNrXSBVbmNvbXBsZXRpbmcgdGFzazogJHt0YXNrSWR9YCk7XHJcbiAgICBcclxuICAgIC8vIEdldCB0aGUgdGFza1xyXG4gICAgY29uc3QgdGFza3MgPSBhd2FpdCBnZXRBbGxUYXNrcygpO1xyXG4gICAgY29uc3QgdGFzayA9IHRhc2tzLmZpbmQodCA9PiB0LmlkID09PSB0YXNrSWQpO1xyXG4gICAgXHJcbiAgICBpZiAoIXRhc2spIHtcclxuICAgICAgY29uc29sZS5sb2coYFt1bmNvbXBsZXRlVGFza10gVGFzayAke3Rhc2tJZH0gbm90IGZvdW5kYCk7XHJcbiAgICAgIHJldHVybjtcclxuICAgIH1cclxuICAgIFxyXG4gICAgLy8gQ2hlY2sgaWYgdGFzayB3YXMgcHJldmlvdXNseSBjb21wbGV0ZWQgKGhhcyBkb25lQXQpXHJcbiAgICBpZiAoIXRhc2suZG9uZUF0KSB7XHJcbiAgICAgIGNvbnNvbGUubG9nKGBbdW5jb21wbGV0ZVRhc2tdIFRhc2sgJHt0YXNrSWR9IHdhcyBub3QgY29tcGxldGVkLCBub3RoaW5nIHRvIHVuY29tcGxldGVgKTtcclxuICAgICAgcmV0dXJuO1xyXG4gICAgfVxyXG4gICAgXHJcbiAgICBjb25zb2xlLmxvZyhgW3VuY29tcGxldGVUYXNrXSBSZXZlcnNpbmcgY29tcGxldGlvbiBmb3IgdGFzazogJHt0YXNrLm5hbWV9YCk7XHJcbiAgICBcclxuICAgIC8vIDEuIFJlbW92ZSBpdGVtcyBjcmVhdGVkIGJ5IHRoaXMgdGFza1xyXG4gICAgYXdhaXQgcmVtb3ZlSXRlbXNDcmVhdGVkQnlUYXNrKHRhc2tJZCk7XHJcbiAgICBjb25zb2xlLmxvZyhgW3VuY29tcGxldGVUYXNrXSDinIUgUmVtb3ZlZCBpdGVtcyBjcmVhdGVkIGJ5IHRhc2tgKTtcclxuICAgIFxyXG4gICAgLy8gMi4gUmVtb3ZlIHBvaW50cyBhd2FyZGVkIGJ5IHRoaXMgdGFza1xyXG4gICAgYXdhaXQgcmVtb3ZlUGxheWVyUG9pbnRzRnJvbVRhc2sodGFza0lkKTtcclxuICAgIGNvbnNvbGUubG9nKGBbdW5jb21wbGV0ZVRhc2tdIOKchSBSZW1vdmVkIHBvaW50cyBhd2FyZGVkIGJ5IHRhc2tgKTtcclxuICAgIFxyXG4gICAgLy8gMy4gQ2xlYXIgZWZmZWN0cyByZWdpc3RyeSBlbnRyaWVzXHJcbiAgICBhd2FpdCBjbGVhckVmZmVjdChgdGFzazoke3Rhc2tJZH06aXRlbUNyZWF0ZWRgKTtcclxuICAgIGF3YWl0IGNsZWFyRWZmZWN0KGB0YXNrOiR7dGFza0lkfTpwb2ludHNBd2FyZGVkYCk7XHJcbiAgICBjb25zb2xlLmxvZyhgW3VuY29tcGxldGVUYXNrXSDinIUgQ2xlYXJlZCBlZmZlY3RzIHJlZ2lzdHJ5IGVudHJpZXNgKTtcclxuICAgIFxyXG4gICAgLy8gNC4gTG9nIFVOQ09NUExFVEVEIGV2ZW50XHJcbiAgICBhd2FpdCBhcHBlbmRFbnRpdHlMb2coJ3Rhc2snLCB0YXNrSWQsICdVTkNPTVBMRVRFRCcsIHtcclxuICAgICAgbmFtZTogdGFzay5uYW1lLFxyXG4gICAgICBwcmV2aW91c1N0YXR1czogJ0RvbmUnLFxyXG4gICAgICB1bmNvbXBsZXRlZEF0OiBuZXcgRGF0ZSgpLnRvSVNPU3RyaW5nKClcclxuICAgIH0pO1xyXG4gICAgY29uc29sZS5sb2coYFt1bmNvbXBsZXRlVGFza10g4pyFIExvZ2dlZCBVTkNPTVBMRVRFRCBldmVudGApO1xyXG4gICAgXHJcbiAgICBjb25zb2xlLmxvZyhgW3VuY29tcGxldGVUYXNrXSDinIUgU3VjY2Vzc2Z1bGx5IHVuY29tcGxldGVkIHRhc2s6ICR7dGFzay5uYW1lfWApO1xyXG4gICAgXHJcbiAgfSBjYXRjaCAoZXJyb3IpIHtcclxuICAgIGNvbnNvbGUuZXJyb3IoYFt1bmNvbXBsZXRlVGFza10g4p2MIEZhaWxlZCB0byB1bmNvbXBsZXRlIHRhc2sgJHt0YXNrSWR9OmAsIGVycm9yKTtcclxuICAgIHRocm93IGVycm9yO1xyXG4gIH1cclxufVxyXG4iXSwibmFtZXMiOlsiRW50aXR5VHlwZSIsImFwcGVuZEVudGl0eUxvZyIsInVwZGF0ZUVudGl0eUxvZ0ZpZWxkIiwiaGFzRWZmZWN0IiwibWFya0VmZmVjdCIsImNsZWFyRWZmZWN0IiwiY2xlYXJFZmZlY3RzQnlQcmVmaXgiLCJnZXRBbGxUYXNrcyIsImdldEFsbFBsYXllcnMiLCJnZXRMaW5rc0ZvciIsInJlbW92ZUxpbmsiLCJjcmVhdGVJdGVtRnJvbVRhc2siLCJyZW1vdmVJdGVtc0NyZWF0ZWRCeVRhc2siLCJhd2FyZFBvaW50c1RvUGxheWVyIiwicmVtb3ZlUG9pbnRzRnJvbVBsYXllciIsImdldE1haW5QbGF5ZXJJZCIsImNyZWF0ZUZpbmFuY2lhbFJlY29yZEZyb21UYXNrIiwicmVtb3ZlRmluYW5jaWFsUmVjb3Jkc0NyZWF0ZWRCeVRhc2siLCJ1cGRhdGVGaW5hbmNpYWxSZWNvcmRzRnJvbVRhc2siLCJ1cGRhdGVJdGVtc0NyZWF0ZWRCeVRhc2siLCJ1cGRhdGVQbGF5ZXJQb2ludHNGcm9tU291cmNlIiwiaGFzRmluYW5jaWFsUHJvcHNDaGFuZ2VkIiwiaGFzT3V0cHV0UHJvcHNDaGFuZ2VkIiwiaGFzUmV3YXJkc0NoYW5nZWQiLCJTVEFURV9GSUVMRFMiLCJERVNDUklQVElWRV9GSUVMRFMiLCJvblRhc2tVcHNlcnQiLCJ0YXNrIiwicHJldmlvdXNUYXNrIiwiZWZmZWN0S2V5IiwiaWQiLCJuYW1lIiwic3RhdHVzIiwic3RhdGlvbiIsImNvbnNvbGUiLCJsb2ciLCJvbGRTdGF0dXMiLCJuZXdTdGF0dXMiLCJ0cmFuc2l0aW9uIiwiY2hhbmdlZEF0IiwiRGF0ZSIsInRvSVNPU3RyaW5nIiwidW5jb21wbGV0ZVRhc2siLCJkb25lQXQiLCJjb2xsZWN0ZWRBdCIsInNpdGVJZCIsInRhcmdldFNpdGVJZCIsIm9sZFNpdGVJZCIsIm5ld1NpdGVJZCIsIm9sZFRhcmdldFNpdGVJZCIsIm5ld1RhcmdldFNpdGVJZCIsIm91dHB1dEl0ZW1UeXBlIiwib3V0cHV0UXVhbnRpdHkiLCJjcmVhdGVkSXRlbSIsInJld2FyZHMiLCJwb2ludHMiLCJjb3N0IiwicmV2ZW51ZSIsImNyZWF0ZWRGaW5hbmNpYWwiLCJmaWVsZCIsInJlbW92ZVRhc2tMb2dFbnRyaWVzT25EZWxldGUiLCJ0YXNrSWQiLCJyZW1vdmVQbGF5ZXJQb2ludHNGcm9tVGFzayIsInRhc2tMaW5rcyIsInR5cGUiLCJUQVNLIiwibGVuZ3RoIiwibGluayIsImxpbmtUeXBlIiwiZXJyb3IiLCJ0YXNrcyIsImZpbmQiLCJ0IiwibWFpblBsYXllcklkIiwicGxheWVycyIsIm1haW5QbGF5ZXIiLCJwIiwicG9pbnRzVG9SZW1vdmUiLCJoYXNQb2ludHMiLCJ4cCIsInJwIiwiZnAiLCJocCIsIkpTT04iLCJzdHJpbmdpZnkiLCJwcmV2aW91c1N0YXR1cyIsInVuY29tcGxldGVkQXQiXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(app-pages-browser)/./workflows/entities-workflows/task.workflow.ts\n"));

/***/ }),

/***/ "(app-pages-browser)/./workflows/financial-record-utils.ts":
/*!*********************************************!*\
  !*** ./workflows/financial-record-utils.ts ***!
  \*********************************************/
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval(__webpack_require__.ts("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   createFinancialRecordFromSale: function() { return /* binding */ createFinancialRecordFromSale; },\n/* harmony export */   createFinancialRecordFromTask: function() { return /* binding */ createFinancialRecordFromTask; },\n/* harmony export */   processFinancialRecordCreationWithLinks: function() { return /* binding */ processFinancialRecordCreationWithLinks; },\n/* harmony export */   removeFinancialRecordsCreatedByTask: function() { return /* binding */ removeFinancialRecordsCreatedByTask; },\n/* harmony export */   updateFinancialRecordFromTask: function() { return /* binding */ updateFinancialRecordFromTask; }\n/* harmony export */ });\n/* harmony import */ var _types_enums__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @/types/enums */ \"(app-pages-browser)/./types/enums.ts\");\n/* harmony import */ var _lib_client_api__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @/lib/client-api */ \"(app-pages-browser)/./lib/client-api.ts\");\n/* harmony import */ var _links_links_workflows__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @/links/links-workflows */ \"(app-pages-browser)/./links/links-workflows.ts\");\n/* harmony import */ var _links_link_registry__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! @/links/link-registry */ \"(app-pages-browser)/./links/link-registry.ts\");\n/* harmony import */ var _entities_logging__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./entities-logging */ \"(app-pages-browser)/./workflows/entities-logging.ts\");\n// workflows/financial-record-utils.ts\n// Financial record creation and management utilities\n\n\n\n\n\n/**\r\n * Create a financial record from a task (when task has cost or revenue)\r\n * This implements the emissary pattern: Task DNA  FinancialRecord entity\r\n */ async function createFinancialRecordFromTask(task) {\n    try {\n        console.log(\"[createFinancialRecordFromTask] Starting financial record creation for task: \".concat(task.name, \" (\").concat(task.id, \")\"));\n        // Check if task has cost or revenue\n        if (!task.cost && !task.revenue) {\n            console.log(\"[createFinancialRecordFromTask] Task \".concat(task.name, \" has no cost or revenue, skipping financial record creation\"));\n            return null;\n        }\n        // IDEMPOTENCY CHECK: Look for existing financial record created by this task\n        const allFinancials = await _lib_client_api__WEBPACK_IMPORTED_MODULE_1__.ClientAPI.getFinancialRecords();\n        const existingFinrec = allFinancials.find((fr)=>fr.sourceTaskId === task.id);\n        if (existingFinrec) {\n            console.log(\"[createFinancialRecordFromTask] Financial record already exists for task \".concat(task.id, \", skipping creation\"));\n            return existingFinrec;\n        }\n        const currentDate = new Date();\n        const newFinrec = {\n            id: \"finrec-\".concat(task.id, \"-\").concat(Date.now()),\n            name: task.name,\n            description: \"Financial record from task: \".concat(task.name),\n            year: currentDate.getFullYear(),\n            month: currentDate.getMonth() + 1,\n            station: task.station,\n            type: \"company\",\n            siteId: task.siteId,\n            targetSiteId: task.targetSiteId,\n            sourceTaskId: task.id,\n            cost: task.cost || 0,\n            revenue: task.revenue || 0,\n            jungleCoins: 0,\n            isNotPaid: task.isNotPaid,\n            isNotCharged: task.isNotCharged,\n            rewards: task.rewards,\n            netCashflow: (task.revenue || 0) - (task.cost || 0),\n            jungleCoinsValue: 0,\n            isCollected: false,\n            createdAt: new Date(),\n            updatedAt: new Date(),\n            links: []\n        };\n        // Store the financial record\n        console.log(\"[createFinancialRecordFromTask] Creating new financial record:\", newFinrec);\n        const createdFinrec = await _lib_client_api__WEBPACK_IMPORTED_MODULE_1__.ClientAPI.upsertFinancialRecord(newFinrec);\n        // Create TASK_FINREC link with metadata\n        const linkMetadata = {\n            cost: task.cost || 0,\n            revenue: task.revenue || 0,\n            isNotPaid: task.isNotPaid || false,\n            isNotCharged: task.isNotCharged || false,\n            rewards: task.rewards,\n            netCashflow: newFinrec.netCashflow,\n            createdFrom: \"task\"\n        };\n        const link = (0,_links_links_workflows__WEBPACK_IMPORTED_MODULE_2__.makeLink)(_types_enums__WEBPACK_IMPORTED_MODULE_0__.LinkType.TASK_FINREC, {\n            type: _types_enums__WEBPACK_IMPORTED_MODULE_0__.EntityType.TASK,\n            id: task.id\n        }, {\n            type: _types_enums__WEBPACK_IMPORTED_MODULE_0__.EntityType.FINANCIAL,\n            id: createdFinrec.id\n        }, linkMetadata);\n        await (0,_links_link_registry__WEBPACK_IMPORTED_MODULE_3__.createLink)(link);\n        console.log(\"[createFinancialRecordFromTask]  Financial record created and TASK_FINREC link established: \".concat(createdFinrec.name));\n        return createdFinrec;\n    } catch (error) {\n        console.error(\"[createFinancialRecordFromTask]  Failed to create financial record from task \".concat(task.id, \":\"), error);\n        throw error;\n    }\n}\n/**\r\n * Update an existing financial record when task properties change\r\n * This ensures financial records stay in sync with their source tasks\r\n */ async function updateFinancialRecordFromTask(task, previousTask) {\n    try {\n        console.log(\"[updateFinancialRecordFromTask] Updating financial record for task: \".concat(task.name, \" (\").concat(task.id, \")\"));\n        // Find the existing financial record created by this task\n        const allFinancials = await _lib_client_api__WEBPACK_IMPORTED_MODULE_1__.ClientAPI.getFinancialRecords();\n        const existingFinrec = allFinancials.find((fr)=>fr.sourceTaskId === task.id);\n        if (!existingFinrec) {\n            console.log(\"[updateFinancialRecordFromTask] No financial record found for task \".concat(task.id, \", creating new one\"));\n            await createFinancialRecordFromTask(task);\n            return;\n        }\n        // Check if any financial properties changed\n        const financialPropsChanged = previousTask.cost !== task.cost || previousTask.revenue !== task.revenue || previousTask.isNotPaid !== task.isNotPaid || previousTask.isNotCharged !== task.isNotCharged || previousTask.name !== task.name || previousTask.station !== task.station || previousTask.siteId !== task.siteId || previousTask.targetSiteId !== task.targetSiteId;\n        if (!financialPropsChanged) {\n            console.log(\"[updateFinancialRecordFromTask] No financial properties changed for task \".concat(task.id, \", skipping update\"));\n            return;\n        }\n        // Update the financial record with new task data\n        const updatedFinrec = {\n            ...existingFinrec,\n            name: task.name,\n            description: \"Financial record from task: \".concat(task.name),\n            cost: task.cost || 0,\n            revenue: task.revenue || 0,\n            station: task.station,\n            siteId: task.siteId,\n            targetSiteId: task.targetSiteId,\n            isNotPaid: task.isNotPaid,\n            isNotCharged: task.isNotCharged,\n            rewards: task.rewards,\n            netCashflow: (task.revenue || 0) - (task.cost || 0),\n            updatedAt: new Date()\n        };\n        // Store the updated financial record\n        console.log(\"[updateFinancialRecordFromTask] Updating financial record:\", updatedFinrec);\n        await _lib_client_api__WEBPACK_IMPORTED_MODULE_1__.ClientAPI.upsertFinancialRecord(updatedFinrec);\n        // Log the update\n        await (0,_entities_logging__WEBPACK_IMPORTED_MODULE_4__.appendEntityLog)(\"financial\", existingFinrec.id, \"UPDATED\", {\n            name: task.name,\n            updatedFrom: \"task\",\n            changes: {\n                cost: {\n                    from: previousTask.cost || 0,\n                    to: task.cost || 0\n                },\n                revenue: {\n                    from: previousTask.revenue || 0,\n                    to: task.revenue || 0\n                },\n                isNotPaid: {\n                    from: previousTask.isNotPaid || false,\n                    to: task.isNotPaid || false\n                },\n                isNotCharged: {\n                    from: previousTask.isNotCharged || false,\n                    to: task.isNotCharged || false\n                }\n            },\n            updatedAt: new Date().toISOString()\n        });\n        console.log(\"[updateFinancialRecordFromTask]  Financial record updated successfully for task: \".concat(task.name));\n    } catch (error) {\n        console.error(\"[updateFinancialRecordFromTask]  Failed to update financial record for task \".concat(task.id, \":\"), error);\n        throw error;\n    }\n}\n/**\r\n * Remove financial records created by a specific task\r\n * This is used when a task is deleted to clean up associated financial records\r\n */ async function removeFinancialRecordsCreatedByTask(taskId) {\n    try {\n        console.log(\"[removeFinancialRecordsCreatedByTask] Removing financial records created by task: \".concat(taskId));\n        // Find financial records created by this task\n        const allFinancials = await _lib_client_api__WEBPACK_IMPORTED_MODULE_1__.ClientAPI.getFinancialRecords();\n        const taskFinancials = allFinancials.filter((fr)=>fr.sourceTaskId === taskId);\n        if (taskFinancials.length === 0) {\n            console.log(\"[removeFinancialRecordsCreatedByTask] No financial records found for task \".concat(taskId));\n            return;\n        }\n        console.log(\"[removeFinancialRecordsCreatedByTask] Found \".concat(taskFinancials.length, \" financial record(s) to remove\"));\n        // Remove each financial record\n        for (const financial of taskFinancials){\n            try {\n                await _lib_client_api__WEBPACK_IMPORTED_MODULE_1__.ClientAPI.deleteFinancialRecord(financial.id);\n                console.log(\"[removeFinancialRecordsCreatedByTask]  Removed financial record: \".concat(financial.name));\n            } catch (error) {\n                console.error(\"[removeFinancialRecordsCreatedByTask]  Failed to remove financial record \".concat(financial.id, \":\"), error);\n            }\n        }\n        console.log(\"[removeFinancialRecordsCreatedByTask]  Removed \".concat(taskFinancials.length, \" financial record(s) for task \").concat(taskId));\n    } catch (error) {\n        console.error(\"[removeFinancialRecordsCreatedByTask]  Failed to remove financial records for task \".concat(taskId, \":\"), error);\n        throw error;\n    }\n}\n/**\r\n * Create a financial record from a sale (when sale has revenue)\r\n * This implements the emissary pattern: Sale DNA  FinancialRecord entity\r\n */ async function createFinancialRecordFromSale(sale) {\n    try {\n        console.log(\"[createFinancialRecordFromSale] Creating financial record from sale: \".concat(sale.counterpartyName));\n        // Check if sale has revenue\n        if (sale.totals.totalRevenue <= 0) {\n            console.log(\"[createFinancialRecordFromSale] Sale \".concat(sale.id, \" has no revenue, skipping financial record creation\"));\n            return null;\n        }\n        // IDEMPOTENCY CHECK: Look for existing financial record created by this sale\n        const allFinancials = await _lib_client_api__WEBPACK_IMPORTED_MODULE_1__.ClientAPI.getFinancialRecords();\n        const existingFinrec = allFinancials.find((fr)=>fr.sourceSaleId === sale.id);\n        if (existingFinrec) {\n            console.log(\"[createFinancialRecordFromSale] Financial record already exists for sale \".concat(sale.id, \", skipping creation\"));\n            return existingFinrec;\n        }\n        const currentDate = new Date();\n        const newFinrec = {\n            id: \"finrec-\".concat(sale.id, \"-\").concat(Date.now()),\n            name: \"Sale: \".concat(sale.counterpartyName),\n            description: \"Financial record from sale: \".concat(sale.counterpartyName),\n            year: currentDate.getFullYear(),\n            month: currentDate.getMonth() + 1,\n            station: \"Sales\",\n            type: \"company\",\n            siteId: sale.siteId,\n            targetSiteId: undefined,\n            sourceSaleId: sale.id,\n            cost: 0,\n            revenue: sale.totals.totalRevenue,\n            jungleCoins: 0,\n            isNotPaid: sale.isNotPaid || false,\n            isNotCharged: sale.isNotCharged || false,\n            rewards: {\n                points: {\n                    xp: 0,\n                    rp: 0,\n                    fp: 0,\n                    hp: 0\n                }\n            },\n            netCashflow: sale.totals.totalRevenue,\n            jungleCoinsValue: 0,\n            isCollected: false,\n            createdAt: new Date(),\n            updatedAt: new Date(),\n            links: []\n        };\n        // Store the financial record\n        console.log(\"[createFinancialRecordFromSale] Creating financial record:\", newFinrec);\n        const createdFinrec = await _lib_client_api__WEBPACK_IMPORTED_MODULE_1__.ClientAPI.upsertFinancialRecord(newFinrec);\n        // Create SALE_FINREC link\n        const linkMetadata = {\n            revenue: sale.totals.totalRevenue,\n            isNotPaid: sale.isNotPaid || false,\n            isNotCharged: sale.isNotCharged || false,\n            netCashflow: newFinrec.netCashflow,\n            createdFrom: \"sale\"\n        };\n        const link = (0,_links_links_workflows__WEBPACK_IMPORTED_MODULE_2__.makeLink)(_types_enums__WEBPACK_IMPORTED_MODULE_0__.LinkType.SALE_FINREC, {\n            type: _types_enums__WEBPACK_IMPORTED_MODULE_0__.EntityType.SALE,\n            id: sale.id\n        }, {\n            type: _types_enums__WEBPACK_IMPORTED_MODULE_0__.EntityType.FINANCIAL,\n            id: createdFinrec.id\n        }, linkMetadata);\n        await (0,_links_link_registry__WEBPACK_IMPORTED_MODULE_3__.createLink)(link);\n        console.log(\"[createFinancialRecordFromSale]  Financial record created and SALE_FINREC link established: \".concat(createdFinrec.name));\n        return createdFinrec;\n    } catch (error) {\n        console.error(\"[createFinancialRecordFromSale]  Failed to create financial record from sale \".concat(sale.id, \":\"), error);\n        throw error;\n    }\n}\n/**\r\n * Enhanced financial record creation - pure business logic, no link creation\r\n */ async function processFinancialRecordCreationWithLinks(record) {\n    console.log(\"[processFinancialRecordCreationWithLinks] Processing financial record creation: \".concat(record.name, \" (\").concat(record.id, \")\"));\n    return record;\n}\n\n\n;\n    // Wrapped in an IIFE to avoid polluting the global scope\n    ;\n    (function () {\n        var _a, _b;\n        // Legacy CSS implementations will `eval` browser code in a Node.js context\n        // to extract CSS. For backwards compatibility, we need to check we're in a\n        // browser context before continuing.\n        if (typeof self !== 'undefined' &&\n            // AMP / No-JS mode does not inject these helpers:\n            '$RefreshHelpers$' in self) {\n            // @ts-ignore __webpack_module__ is global\n            var currentExports = module.exports;\n            // @ts-ignore __webpack_module__ is global\n            var prevSignature = (_b = (_a = module.hot.data) === null || _a === void 0 ? void 0 : _a.prevSignature) !== null && _b !== void 0 ? _b : null;\n            // This cannot happen in MainTemplate because the exports mismatch between\n            // templating and execution.\n            self.$RefreshHelpers$.registerExportsForReactRefresh(currentExports, module.id);\n            // A module can be accepted automatically based on its exports, e.g. when\n            // it is a Refresh Boundary.\n            if (self.$RefreshHelpers$.isReactRefreshBoundary(currentExports)) {\n                // Save the previous exports signature on update so we can compare the boundary\n                // signatures. We avoid saving exports themselves since it causes memory leaks (https://github.com/vercel/next.js/pull/53797)\n                module.hot.dispose(function (data) {\n                    data.prevSignature =\n                        self.$RefreshHelpers$.getRefreshBoundarySignature(currentExports);\n                });\n                // Unconditionally accept an update to this module, we'll check if it's\n                // still a Refresh Boundary later.\n                // @ts-ignore importMeta is replaced in the loader\n                module.hot.accept();\n                // This field is set when the previous version of this module was a\n                // Refresh Boundary, letting us know we need to check for invalidation or\n                // enqueue an update.\n                if (prevSignature !== null) {\n                    // A boundary can become ineligible if its exports are incompatible\n                    // with the previous exports.\n                    //\n                    // For example, if you add/remove/change exports, we'll want to\n                    // re-execute the importing modules, and force those components to\n                    // re-render. Similarly, if you convert a class component to a\n                    // function, we want to invalidate the boundary.\n                    if (self.$RefreshHelpers$.shouldInvalidateReactRefreshBoundary(prevSignature, self.$RefreshHelpers$.getRefreshBoundarySignature(currentExports))) {\n                        module.hot.invalidate();\n                    }\n                    else {\n                        self.$RefreshHelpers$.scheduleUpdate();\n                    }\n                }\n            }\n            else {\n                // Since we just executed the code for the module, it's possible that the\n                // new exports made it ineligible for being a boundary.\n                // We only care about the case when we were _previously_ a boundary,\n                // because we already accepted this update (accidental side effect).\n                var isNoLongerABoundary = prevSignature !== null;\n                if (isNoLongerABoundary) {\n                    module.hot.invalidate();\n                }\n            }\n        }\n    })();\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFwcC1wYWdlcy1icm93c2VyKS8uL3dvcmtmbG93cy9maW5hbmNpYWwtcmVjb3JkLXV0aWxzLnRzIiwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7Ozs7QUFBQSxzQ0FBc0M7QUFDdEMscURBQXFEO0FBR0E7QUFDUjtBQUNNO0FBQ0E7QUFDRTtBQUVyRDs7O0NBR0MsR0FDTSxlQUFlTSw4QkFBOEJDLElBQVU7SUFDNUQsSUFBSTtRQUNGQyxRQUFRQyxHQUFHLENBQUMsZ0ZBQThGRixPQUFkQSxLQUFLRyxJQUFJLEVBQUMsTUFBWSxPQUFSSCxLQUFLSSxFQUFFLEVBQUM7UUFFbEgsb0NBQW9DO1FBQ3BDLElBQUksQ0FBQ0osS0FBS0ssSUFBSSxJQUFJLENBQUNMLEtBQUtNLE9BQU8sRUFBRTtZQUMvQkwsUUFBUUMsR0FBRyxDQUFDLHdDQUFrRCxPQUFWRixLQUFLRyxJQUFJLEVBQUM7WUFDOUQsT0FBTztRQUNUO1FBRUEsNkVBQTZFO1FBQzdFLE1BQU1JLGdCQUFnQixNQUFNWixzREFBU0EsQ0FBQ2EsbUJBQW1CO1FBQ3pELE1BQU1DLGlCQUFpQkYsY0FBY0csSUFBSSxDQUFDQyxDQUFBQSxLQUFNQSxHQUFHQyxZQUFZLEtBQUtaLEtBQUtJLEVBQUU7UUFFM0UsSUFBSUssZ0JBQWdCO1lBQ2xCUixRQUFRQyxHQUFHLENBQUMsNEVBQW9GLE9BQVJGLEtBQUtJLEVBQUUsRUFBQztZQUNoRyxPQUFPSztRQUNUO1FBRUEsTUFBTUksY0FBYyxJQUFJQztRQUN4QixNQUFNQyxZQUE2QjtZQUNqQ1gsSUFBSSxVQUFxQlUsT0FBWGQsS0FBS0ksRUFBRSxFQUFDLEtBQWMsT0FBWFUsS0FBS0UsR0FBRztZQUNqQ2IsTUFBTUgsS0FBS0csSUFBSTtZQUNmYyxhQUFhLCtCQUF5QyxPQUFWakIsS0FBS0csSUFBSTtZQUNyRGUsTUFBTUwsWUFBWU0sV0FBVztZQUM3QkMsT0FBT1AsWUFBWVEsUUFBUSxLQUFLO1lBQ2hDQyxTQUFTdEIsS0FBS3NCLE9BQU87WUFDckJDLE1BQU07WUFDTkMs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QW1ILE9BQW5Ca0MsY0FBY2pDLElBQUk7UUFFOUgsT0FBT2lDO0lBRVQsRUFBRSxPQUFPUSxPQUFPO1FBQ2QzQyxRQUFRMkMsS0FBSyxDQUFDLGlGQUF5RixPQUFSa0IsS0FBSzFELEVBQUUsRUFBQyxNQUFJd0M7UUFDM0csTUFBTUE7SUFDUjtBQUNGO0FBRUE7O0NBRUMsR0FDTSxlQUFlK0Isd0NBQXdDQyxNQUF1QjtJQUNuRjNFLFFBQVFDLEdBQUcsQ0FBQyxtRkFBbUcwRSxPQUFoQkEsT0FBT3pFLElBQUksRUFBQyxNQUFjLE9BQVZ5RSxPQUFPeEUsRUFBRSxFQUFDO0lBRXpILE9BQU93RTtBQUNUIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vX05fRS8uL3dvcmtmbG93cy9maW5hbmNpYWwtcmVjb3JkLXV0aWxzLnRzP2MwNTEiXSwic291cmNlc0NvbnRlbnQiOlsiLy8gd29ya2Zsb3dzL2ZpbmFuY2lhbC1yZWNvcmQtdXRpbHMudHNcclxuLy8gRmluYW5jaWFsIHJlY29yZCBjcmVhdGlvbiBhbmQgbWFuYWdlbWVudCB1dGlsaXRpZXNcclxuXHJcbmltcG9ydCB0eXBlIHsgVGFzaywgRmluYW5jaWFsUmVjb3JkLCBTYWxlIH0gZnJvbSAnQC90eXBlcy9lbnRpdGllcyc7XHJcbmltcG9ydCB7IExpbmtUeXBlLCBFbnRpdHlUeXBlIH0gZnJvbSAnQC90eXBlcy9lbnVtcyc7XHJcbmltcG9ydCB7IENsaWVudEFQSSB9IGZyb20gJ0AvbGliL2NsaWVudC1hcGknO1xyXG5pbXBvcnQgeyBtYWtlTGluayB9IGZyb20gJ0AvbGlua3MvbGlua3Mtd29ya2Zsb3dzJztcclxuaW1wb3J0IHsgY3JlYXRlTGluayB9IGZyb20gJ0AvbGlua3MvbGluay1yZWdpc3RyeSc7XHJcbmltcG9ydCB7IGFwcGVuZEVudGl0eUxvZyB9IGZyb20gJy4vZW50aXRpZXMtbG9nZ2luZyc7XHJcblxyXG4vKipcclxuICogQ3JlYXRlIGEgZmluYW5jaWFsIHJlY29yZCBmcm9tIGEgdGFzayAod2hlbiB0YXNrIGhhcyBjb3N0IG9yIHJldmVudWUpXHJcbiAqIFRoaXMgaW1wbGVtZW50cyB0aGUgZW1pc3NhcnkgcGF0dGVybjogVGFzayBETkEg4oaSIEZpbmFuY2lhbFJlY29yZCBlbnRpdHlcclxuICovXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBjcmVhdGVGaW5hbmNpYWxSZWNvcmRGcm9tVGFzayh0YXNrOiBUYXNrKTogUHJvbWlzZTxGaW5hbmNpYWxSZWNvcmQgfCBudWxsPiB7XHJcbiAgdHJ5IHtcclxuICAgIGNvbnNvbGUubG9nKGBbY3JlYXRlRmluYW5jaWFsUmVjb3JkRnJvbVRhc2tdIFN0YXJ0aW5nIGZpbmFuY2lhbCByZWNvcmQgY3JlYXRpb24gZm9yIHRhc2s6ICR7dGFzay5uYW1lfSAoJHt0YXNrLmlkfSlgKTtcclxuICAgIFxyXG4gICAgLy8gQ2hlY2sgaWYgdGFzayBoYXMgY29zdCBvciByZXZlbnVlXHJcbiAgICBpZiAoIXRhc2suY29zdCAmJiAhdGFzay5yZXZlbnVlKSB7XHJcbiAgICAgIGNvbnNvbGUubG9nKGBbY3JlYXRlRmluYW5jaWFsUmVjb3JkRnJvbVRhc2tdIFRhc2sgJHt0YXNrLm5hbWV9IGhhcyBubyBjb3N0IG9yIHJldmVudWUsIHNraXBwaW5nIGZpbmFuY2lhbCByZWNvcmQgY3JlYXRpb25gKTtcclxuICAgICAgcmV0dXJuIG51bGw7XHJcbiAgICB9XHJcbiAgICBcclxuICAgIC8vIElERU1QT1RFTkNZIENIRUNLOiBMb29rIGZvciBleGlzdGluZyBmaW5hbmNpYWwgcmVjb3JkIGNyZWF0ZWQgYnkgdGhpcyB0YXNrXHJcbiAgICBjb25zdCBhbGxGaW5hbmNpYWxzID0gYXdhaXQgQ2xpZW50QVBJLmdldEZpbmFuY2lhbFJlY29yZHMoKTtcclxuICAgIGNvbnN0IGV4aXN0aW5nRmlucmVjID0gYWxsRmluYW5jaWFscy5maW5kKGZyID0+IGZyLnNvdXJjZVRhc2tJZCA9PT0gdGFzay5pZCk7XHJcbiAgICBcclxuICAgIGlmIChleGlzdGluZ0ZpbnJlYykge1xyXG4gICAgICBjb25zb2xlLmxvZyhgW2NyZWF0ZUZpbmFuY2lhbFJlY29yZEZyb21UYXNrXSBGaW5hbmNpYWwgcmVjb3JkIGFscmVhZHkgZXhpc3RzIGZvciB0YXNrICR7dGFzay5pZH0sIHNraXBwaW5nIGNyZWF0aW9uYCk7XHJcbiAgICAgIHJldHVybiBleGlzdGluZ0ZpbnJlYztcclxuICAgIH1cclxuICAgIFxyXG4gICAgY29uc3QgY3VycmVudERhdGUgPSBuZXcgRGF0ZSgpO1xyXG4gICAgY29uc3QgbmV3RmlucmVjOiBGaW5hbmNpYWxSZWNvcmQgPSB7XHJcbiAgICAgIGlkOiBgZmlucmVjLSR7dGFzay5pZH0tJHtEYXRlLm5vdygpfWAsXHJcbiAgICAgIG5hbWU6IHRhc2submFtZSxcclxuICAgICAgZGVzY3JpcHRpb246IGBGaW5hbmNpYWwgcmVjb3JkIGZyb20gdGFzazogJHt0YXNrLm5hbWV9YCxcclxuICAgICAgeWVhcjogY3VycmVudERhdGUuZ2V0RnVsbFllYXIoKSxcclxuICAgICAgbW9udGg6IGN1cnJlbnREYXRlLmdldE1vbnRoKCkgKyAxLFxyXG4gICAgICBzdGF0aW9uOiB0YXNrLnN0YXRpb24sXHJcbiAgICAgIHR5cGU6ICdjb21wYW55JywgLy8gVGFza3MgYXJlIGJ1c2luZXNzIGFjdGl2aXRpZXNcclxuICAgICAgc2l0ZUlkOiB0YXNrLnNpdGVJZCxcclxuICAgICAgdGFyZ2V0U2l0ZUlkOiB0YXNrLnRhcmdldFNpdGVJZCxcclxuICAgICAgc291cmNlVGFza0lkOiB0YXNrLmlkLCAvLyBBTUJBU1NBRE9SIGZpZWxkIC0gcG9pbnRzIGJhY2sgdG8gVGFza1xyXG4gICAgICBjb3N0OiB0YXNrLmNvc3QgfHwgMCxcclxuICAgICAgcmV2ZW51ZTogdGFzay5yZXZlbnVlIHx8IDAsXHJcbiAgICAgIGp1bmdsZUNvaW5zOiAwLCAvLyBKJCBubyBsb25nZXIgYXdhcmRlZCBhcyB0YXNrIHJld2FyZHNcclxuICAgICAgaXNOb3RQYWlkOiB0YXNrLmlzTm90UGFpZCwgICAgICAgLy8gQ29weSBwYXltZW50IHN0YXR1cyBmcm9tIFRhc2tcclxuICAgICAgaXNOb3RDaGFyZ2VkOiB0YXNrLmlzTm90Q2hhcmdlZCwgLy8gQ29weSBwYXltZW50IHN0YXR1cyBmcm9tIFRhc2tcclxuICAgICAgcmV3YXJkczogdGFzay5yZXdhcmRzLFxyXG4gICAgICBuZXRDYXNoZmxvdzogKHRhc2sucmV2ZW51ZSB8fCAwKSAtICh0YXNrLmNvc3QgfHwgMCksXHJcbiAgICAgIGp1bmdsZUNvaW5zVmFsdWU6IDAsIC8vIEokIG5vIGxvbmdlciBhd2FyZGVkIGFzIHRhc2sgcmV3YXJkc1xyXG4gICAgICBpc0NvbGxlY3RlZDogZmFsc2UsXHJcbiAgICAgIGNyZWF0ZWRBdDogbmV3IERhdGUoKSxcclxuICAgICAgdXBkYXRlZEF0OiBuZXcgRGF0ZSgpLFxyXG4gICAgICBsaW5rczogW11cclxuICAgIH07XHJcbiAgICBcclxuICAgIC8vIFN0b3JlIHRoZSBmaW5hbmNpYWwgcmVjb3JkXHJcbiAgICBjb25zb2xlLmxvZyhgW2NyZWF0ZUZpbmFuY2lhbFJlY29yZEZyb21UYXNrXSBDcmVhdGluZyBuZXcgZmluYW5jaWFsIHJlY29yZDpgLCBuZXdGaW5yZWMpO1xyXG4gICAgY29uc3QgY3JlYXRlZEZpbnJlYyA9IGF3YWl0IENsaWVudEFQSS51cHNlcnRGaW5hbmNpYWxSZWNvcmQobmV3RmlucmVjKTtcclxuICAgIFxyXG4gICAgLy8gQ3JlYXRlIFRBU0tfRklOUkVDIGxpbmsgd2l0aCBtZXRhZGF0YVxyXG4gICAgY29uc3QgbGlua01ldGFkYXRhID0ge1xyXG4gICAgICBjb3N0OiB0YXNrLmNvc3QgfHwgMCxcclxuICAgICAgcmV2ZW51ZTogdGFzay5yZXZlbnVlIHx8IDAsXHJcbiAgICAgIGlzTm90UGFpZDogdGFzay5pc05vdFBhaWQgfHwgZmFsc2UsXHJcbiAgICAgIGlzTm90Q2hhcmdlZDogdGFzay5pc05vdENoYXJnZWQgfHwgZmFsc2UsXHJcbiAgICAgIHJld2FyZHM6IHRhc2sucmV3YXJkcyxcclxuICAgICAgbmV0Q2FzaGZsb3c6IG5ld0ZpbnJlYy5uZXRDYXNoZmxvdyxcclxuICAgICAgY3JlYXRlZEZyb206ICd0YXNrJ1xyXG4gICAgfTtcclxuICAgIFxyXG4gICAgY29uc3QgbGluayA9IG1ha2VMaW5rKFxyXG4gICAgICBMaW5rVHlwZS5UQVNLX0ZJTlJFQyxcclxuICAgICAgeyB0eXBlOiBFbnRpdHlUeXBlLlRBU0ssIGlkOiB0YXNrLmlkIH0sXHJcbiAgICAgIHsgdHlwZTogRW50aXR5VHlwZS5GSU5BTkNJQUwsIGlkOiBjcmVhdGVkRmlucmVjLmlkIH0sXHJcbiAgICAgIGxpbmtNZXRhZGF0YVxyXG4gICAgKTtcclxuICAgIFxyXG4gICAgYXdhaXQgY3JlYXRlTGluayhsaW5rKTtcclxuICAgIFxyXG4gICAgY29uc29sZS5sb2coYFtjcmVhdGVGaW5hbmNpYWxSZWNvcmRGcm9tVGFza10g4pyFIEZpbmFuY2lhbCByZWNvcmQgY3JlYXRlZCBhbmQgVEFTS19GSU5SRUMgbGluayBlc3RhYmxpc2hlZDogJHtjcmVhdGVkRmlucmVjLm5hbWV9YCk7XHJcbiAgICBcclxuICAgIHJldHVybiBjcmVhdGVkRmlucmVjO1xyXG4gICAgXHJcbiAgfSBjYXRjaCAoZXJyb3IpIHtcclxuICAgIGNvbnNvbGUuZXJyb3IoYFtjcmVhdGVGaW5hbmNpYWxSZWNvcmRGcm9tVGFza10g4p2MIEZhaWxlZCB0byBjcmVhdGUgZmluYW5jaWFsIHJlY29yZCBmcm9tIHRhc2sgJHt0YXNrLmlkfTpgLCBlcnJvcik7XHJcbiAgICB0aHJvdyBlcnJvcjtcclxuICB9XHJcbn1cclxuXHJcbi8qKlxyXG4gKiBVcGRhdGUgYW4gZXhpc3RpbmcgZmluYW5jaWFsIHJlY29yZCB3aGVuIHRhc2sgcHJvcGVydGllcyBjaGFuZ2VcclxuICogVGhpcyBlbnN1cmVzIGZpbmFuY2lhbCByZWNvcmRzIHN0YXkgaW4gc3luYyB3aXRoIHRoZWlyIHNvdXJjZSB0YXNrc1xyXG4gKi9cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIHVwZGF0ZUZpbmFuY2lhbFJlY29yZEZyb21UYXNrKHRhc2s6IFRhc2ssIHByZXZpb3VzVGFzazogVGFzayk6IFByb21pc2U8dm9pZD4ge1xyXG4gIHRyeSB7XHJcbiAgICBjb25zb2xlLmxvZyhgW3VwZGF0ZUZpbmFuY2lhbFJlY29yZEZyb21UYXNrXSBVcGRhdGluZyBmaW5hbmNpYWwgcmVjb3JkIGZvciB0YXNrOiAke3Rhc2submFtZX0gKCR7dGFzay5pZH0pYCk7XHJcbiAgICBcclxuICAgIC8vIEZpbmQgdGhlIGV4aXN0aW5nIGZpbmFuY2lhbCByZWNvcmQgY3JlYXRlZCBieSB0aGlzIHRhc2tcclxuICAgIGNvbnN0IGFsbEZpbmFuY2lhbHMgPSBhd2FpdCBDbGllbnRBUEkuZ2V0RmluYW5jaWFsUmVjb3JkcygpO1xyXG4gICAgY29uc3QgZXhpc3RpbmdGaW5yZWMgPSBhbGxGaW5hbmNpYWxzLmZpbmQoZnIgPT4gZnIuc291cmNlVGFza0lkID09PSB0YXNrLmlkKTtcclxuICAgIFxyXG4gICAgaWYgKCFleGlzdGluZ0ZpbnJlYykge1xyXG4gICAgICBjb25zb2xlLmxvZyhgW3VwZGF0ZUZpbmFuY2lhbFJlY29yZEZyb21UYXNrXSBObyBmaW5hbmNpYWwgcmVjb3JkIGZvdW5kIGZvciB0YXNrICR7dGFzay5pZH0sIGNyZWF0aW5nIG5ldyBvbmVgKTtcclxuICAgICAgYXdhaXQgY3JlYXRlRmluYW5jaWFsUmVjb3JkRnJvbVRhc2sodGFzayk7XHJcbiAgICAgIHJldHVybjtcclxuICAgIH1cclxuICAgIFxyXG4gICAgLy8gQ2hlY2sgaWYgYW55IGZpbmFuY2lhbCBwcm9wZXJ0aWVzIGNoYW5nZWRcclxuICAgIGNvbnN0IGZpbmFuY2lhbFByb3BzQ2hhbmdlZCA9IFxyXG4gICAgICBwcmV2aW91c1Rhc2suY29zdCAhPT0gdGFzay5jb3N0IHx8XHJcbiAgICAgIHByZXZpb3VzVGFzay5yZXZlbnVlICE9PSB0YXNrLnJldmVudWUgfHxcclxuICAgICAgcHJldmlvdXNUYXNrLmlzTm90UGFpZCAhPT0gdGFzay5pc05vdFBhaWQgfHxcclxuICAgICAgcHJldmlvdXNUYXNrLmlzTm90Q2hhcmdlZCAhPT0gdGFzay5pc05vdENoYXJnZWQgfHxcclxuICAgICAgcHJldmlvdXNUYXNrLm5hbWUgIT09IHRhc2submFtZSB8fFxyXG4gICAgICBwcmV2aW91c1Rhc2suc3RhdGlvbiAhPT0gdGFzay5zdGF0aW9uIHx8XHJcbiAgICAgIHByZXZpb3VzVGFzay5zaXRlSWQgIT09IHRhc2suc2l0ZUlkIHx8XHJcbiAgICAgIHByZXZpb3VzVGFzay50YXJnZXRTaXRlSWQgIT09IHRhc2sudGFyZ2V0U2l0ZUlkO1xyXG4gICAgXHJcbiAgICBpZiAoIWZpbmFuY2lhbFByb3BzQ2hhbmdlZCkge1xyXG4gICAgICBjb25zb2xlLmxvZyhgW3VwZGF0ZUZpbmFuY2lhbFJlY29yZEZyb21UYXNrXSBObyBmaW5hbmNpYWwgcHJvcGVydGllcyBjaGFuZ2VkIGZvciB0YXNrICR7dGFzay5pZH0sIHNraXBwaW5nIHVwZGF0ZWApO1xyXG4gICAgICByZXR1cm47XHJcbiAgICB9XHJcbiAgICBcclxuICAgIC8vIFVwZGF0ZSB0aGUgZmluYW5jaWFsIHJlY29yZCB3aXRoIG5ldyB0YXNrIGRhdGFcclxuICAgIGNvbnN0IHVwZGF0ZWRGaW5yZWMgPSB7XHJcbiAgICAgIC4uLmV4aXN0aW5nRmlucmVjLFxyXG4gICAgICBuYW1lOiB0YXNrLm5hbWUsXHJcbiAgICAgIGRlc2NyaXB0aW9uOiBgRmluYW5jaWFsIHJlY29yZCBmcm9tIHRhc2s6ICR7dGFzay5uYW1lfWAsXHJcbiAgICAgIGNvc3Q6IHRhc2suY29zdCB8fCAwLFxyXG4gICAgICByZXZlbnVlOiB0YXNrLnJldmVudWUgfHwgMCxcclxuICAgICAgc3RhdGlvbjogdGFzay5zdGF0aW9uLFxyXG4gICAgICBzaXRlSWQ6IHRhc2suc2l0ZUlkLFxyXG4gICAgICB0YXJnZXRTaXRlSWQ6IHRhc2sudGFyZ2V0U2l0ZUlkLFxyXG4gICAgICBpc05vdFBhaWQ6IHRhc2suaXNOb3RQYWlkLFxyXG4gICAgICBpc05vdENoYXJnZWQ6IHRhc2suaXNOb3RDaGFyZ2VkLFxyXG4gICAgICByZXdhcmRzOiB0YXNrLnJld2FyZHMsXHJcbiAgICAgIG5ldENhc2hmbG93OiAodGFzay5yZXZlbnVlIHx8IDApIC0gKHRhc2suY29zdCB8fCAwKSxcclxuICAgICAgdXBkYXRlZEF0OiBuZXcgRGF0ZSgpXHJcbiAgICB9O1xyXG4gICAgXHJcbiAgICAvLyBTdG9yZSB0aGUgdXBkYXRlZCBmaW5hbmNpYWwgcmVjb3JkXHJcbiAgICBjb25zb2xlLmxvZyhgW3VwZGF0ZUZpbmFuY2lhbFJlY29yZEZyb21UYXNrXSBVcGRhdGluZyBmaW5hbmNpYWwgcmVjb3JkOmAsIHVwZGF0ZWRGaW5yZWMpO1xyXG4gICAgYXdhaXQgQ2xpZW50QVBJLnVwc2VydEZpbmFuY2lhbFJlY29yZCh1cGRhdGVkRmlucmVjKTtcclxuICAgIFxyXG4gICAgLy8gTG9nIHRoZSB1cGRhdGVcclxuICAgIGF3YWl0IGFwcGVuZEVudGl0eUxvZygnZmluYW5jaWFsJywgZXhpc3RpbmdGaW5yZWMuaWQsICdVUERBVEVEJywge1xyXG4gICAgICBuYW1lOiB0YXNrLm5hbWUsXHJcbiAgICAgIHVwZGF0ZWRGcm9tOiAndGFzaycsXHJcbiAgICAgIGNoYW5nZXM6IHtcclxuICAgICAgICBjb3N0OiB7IGZyb206IHByZXZpb3VzVGFzay5jb3N0IHx8IDAsIHRvOiB0YXNrLmNvc3QgfHwgMCB9LFxyXG4gICAgICAgIHJldmVudWU6IHsgZnJvbTogcHJldmlvdXNUYXNrLnJldmVudWUgfHwgMCwgdG86IHRhc2sucmV2ZW51ZSB8fCAwIH0sXHJcbiAgICAgICAgaXNOb3RQYWlkOiB7IGZyb206IHByZXZpb3VzVGFzay5pc05vdFBhaWQgfHwgZmFsc2UsIHRvOiB0YXNrLmlzTm90UGFpZCB8fCBmYWxzZSB9LFxyXG4gICAgICAgIGlzTm90Q2hhcmdlZDogeyBmcm9tOiBwcmV2aW91c1Rhc2suaXNOb3RDaGFyZ2VkIHx8IGZhbHNlLCB0bzogdGFzay5pc05vdENoYXJnZWQgfHwgZmFsc2UgfVxyXG4gICAgICB9LFxyXG4gICAgICB1cGRhdGVkQXQ6IG5ldyBEYXRlKCkudG9JU09TdHJpbmcoKVxyXG4gICAgfSk7XHJcbiAgICBcclxuICAgIGNvbnNvbGUubG9nKGBbdXBkYXRlRmluYW5jaWFsUmVjb3JkRnJvbVRhc2tdIOKchSBGaW5hbmNpYWwgcmVjb3JkIHVwZGF0ZWQgc3VjY2Vzc2Z1bGx5IGZvciB0YXNrOiAke3Rhc2submFtZX1gKTtcclxuICAgIFxyXG4gIH0gY2F0Y2ggKGVycm9yKSB7XHJcbiAgICBjb25zb2xlLmVycm9yKGBbdXBkYXRlRmluYW5jaWFsUmVjb3JkRnJvbVRhc2tdIOKdjCBGYWlsZWQgdG8gdXBkYXRlIGZpbmFuY2lhbCByZWNvcmQgZm9yIHRhc2sgJHt0YXNrLmlkfTpgLCBlcnJvcik7XHJcbiAgICB0aHJvdyBlcnJvcjtcclxuICB9XHJcbn1cclxuXHJcbi8qKlxyXG4gKiBSZW1vdmUgZmluYW5jaWFsIHJlY29yZHMgY3JlYXRlZCBieSBhIHNwZWNpZmljIHRhc2tcclxuICogVGhpcyBpcyB1c2VkIHdoZW4gYSB0YXNrIGlzIGRlbGV0ZWQgdG8gY2xlYW4gdXAgYXNzb2NpYXRlZCBmaW5hbmNpYWwgcmVjb3Jkc1xyXG4gKi9cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIHJlbW92ZUZpbmFuY2lhbFJlY29yZHNDcmVhdGVkQnlUYXNrKHRhc2tJZDogc3RyaW5nKTogUHJvbWlzZTx2b2lkPiB7XHJcbiAgdHJ5IHtcclxuICAgIGNvbnNvbGUubG9nKGBbcmVtb3ZlRmluYW5jaWFsUmVjb3Jkc0NyZWF0ZWRCeVRhc2tdIFJlbW92aW5nIGZpbmFuY2lhbCByZWNvcmRzIGNyZWF0ZWQgYnkgdGFzazogJHt0YXNrSWR9YCk7XHJcbiAgICBcclxuICAgIC8vIEZpbmQgZmluYW5jaWFsIHJlY29yZHMgY3JlYXRlZCBieSB0aGlzIHRhc2tcclxuICAgIGNvbnN0IGFsbEZpbmFuY2lhbHMgPSBhd2FpdCBDbGllbnRBUEkuZ2V0RmluYW5jaWFsUmVjb3JkcygpO1xyXG4gICAgY29uc3QgdGFza0ZpbmFuY2lhbHMgPSBhbGxGaW5hbmNpYWxzLmZpbHRlcihmciA9PiBmci5zb3VyY2VUYXNrSWQgPT09IHRhc2tJZCk7XHJcbiAgICBcclxuICAgIGlmICh0YXNrRmluYW5jaWFscy5sZW5ndGggPT09IDApIHtcclxuICAgICAgY29uc29sZS5sb2coYFtyZW1vdmVGaW5hbmNpYWxSZWNvcmRzQ3JlYXRlZEJ5VGFza10gTm8gZmluYW5jaWFsIHJlY29yZHMgZm91bmQgZm9yIHRhc2sgJHt0YXNrSWR9YCk7XHJcbiAgICAgIHJldHVybjtcclxuICAgIH1cclxuICAgIFxyXG4gICAgY29uc29sZS5sb2coYFtyZW1vdmVGaW5hbmNpYWxSZWNvcmRzQ3JlYXRlZEJ5VGFza10gRm91bmQgJHt0YXNrRmluYW5jaWFscy5sZW5ndGh9IGZpbmFuY2lhbCByZWNvcmQocykgdG8gcmVtb3ZlYCk7XHJcbiAgICBcclxuICAgIC8vIFJlbW92ZSBlYWNoIGZpbmFuY2lhbCByZWNvcmRcclxuICAgIGZvciAoY29uc3QgZmluYW5jaWFsIG9mIHRhc2tGaW5hbmNpYWxzKSB7XHJcbiAgICAgIHRyeSB7XHJcbiAgICAgICAgYXdhaXQgQ2xpZW50QVBJLmRlbGV0ZUZpbmFuY2lhbFJlY29yZChmaW5hbmNpYWwuaWQpO1xyXG4gICAgICAgIGNvbnNvbGUubG9nKGBbcmVtb3ZlRmluYW5jaWFsUmVjb3Jkc0NyZWF0ZWRCeVRhc2tdIOKchSBSZW1vdmVkIGZpbmFuY2lhbCByZWNvcmQ6ICR7ZmluYW5jaWFsLm5hbWV9YCk7XHJcbiAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XHJcbiAgICAgICAgY29uc29sZS5lcnJvcihgW3JlbW92ZUZpbmFuY2lhbFJlY29yZHNDcmVhdGVkQnlUYXNrXSDinYwgRmFpbGVkIHRvIHJlbW92ZSBmaW5hbmNpYWwgcmVjb3JkICR7ZmluYW5jaWFsLmlkfTpgLCBlcnJvcik7XHJcbiAgICAgIH1cclxuICAgIH1cclxuICAgIFxyXG4gICAgY29uc29sZS5sb2coYFtyZW1vdmVGaW5hbmNpYWxSZWNvcmRzQ3JlYXRlZEJ5VGFza10g4pyFIFJlbW92ZWQgJHt0YXNrRmluYW5jaWFscy5sZW5ndGh9IGZpbmFuY2lhbCByZWNvcmQocykgZm9yIHRhc2sgJHt0YXNrSWR9YCk7XHJcbiAgICBcclxuICB9IGNhdGNoIChlcnJvcikge1xyXG4gICAgY29uc29sZS5lcnJvcihgW3JlbW92ZUZpbmFuY2lhbFJlY29yZHNDcmVhdGVkQnlUYXNrXSDinYwgRmFpbGVkIHRvIHJlbW92ZSBmaW5hbmNpYWwgcmVjb3JkcyBmb3IgdGFzayAke3Rhc2tJZH06YCwgZXJyb3IpO1xyXG4gICAgdGhyb3cgZXJyb3I7XHJcbiAgfVxyXG59XHJcblxyXG4vKipcclxuICogQ3JlYXRlIGEgZmluYW5jaWFsIHJlY29yZCBmcm9tIGEgc2FsZSAod2hlbiBzYWxlIGhhcyByZXZlbnVlKVxyXG4gKiBUaGlzIGltcGxlbWVudHMgdGhlIGVtaXNzYXJ5IHBhdHRlcm46IFNhbGUgRE5BIOKGkiBGaW5hbmNpYWxSZWNvcmQgZW50aXR5XHJcbiAqL1xyXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gY3JlYXRlRmluYW5jaWFsUmVjb3JkRnJvbVNhbGUoc2FsZTogU2FsZSk6IFByb21pc2U8RmluYW5jaWFsUmVjb3JkIHwgbnVsbD4ge1xyXG4gIHRyeSB7XHJcbiAgICBjb25zb2xlLmxvZyhgW2NyZWF0ZUZpbmFuY2lhbFJlY29yZEZyb21TYWxlXSBDcmVhdGluZyBmaW5hbmNpYWwgcmVjb3JkIGZyb20gc2FsZTogJHtzYWxlLmNvdW50ZXJwYXJ0eU5hbWV9YCk7XHJcbiAgICBcclxuICAgIC8vIENoZWNrIGlmIHNhbGUgaGFzIHJldmVudWVcclxuICAgIGlmIChzYWxlLnRvdGFscy50b3RhbFJldmVudWUgPD0gMCkge1xyXG4gICAgICBjb25zb2xlLmxvZyhgW2NyZWF0ZUZpbmFuY2lhbFJlY29yZEZyb21TYWxlXSBTYWxlICR7c2FsZS5pZH0gaGFzIG5vIHJldmVudWUsIHNraXBwaW5nIGZpbmFuY2lhbCByZWNvcmQgY3JlYXRpb25gKTtcclxuICAgICAgcmV0dXJuIG51bGw7XHJcbiAgICB9XHJcbiAgICBcclxuICAgIC8vIElERU1QT1RFTkNZIENIRUNLOiBMb29rIGZvciBleGlzdGluZyBmaW5hbmNpYWwgcmVjb3JkIGNyZWF0ZWQgYnkgdGhpcyBzYWxlXHJcbiAgICBjb25zdCBhbGxGaW5hbmNpYWxzID0gYXdhaXQgQ2xpZW50QVBJLmdldEZpbmFuY2lhbFJlY29yZHMoKTtcclxuICAgIGNvbnN0IGV4aXN0aW5nRmlucmVjID0gYWxsRmluYW5jaWFscy5maW5kKGZyID0+IGZyLnNvdXJjZVNhbGVJZCA9PT0gc2FsZS5pZCk7XHJcbiAgICBcclxuICAgIGlmIChleGlzdGluZ0ZpbnJlYykge1xyXG4gICAgICBjb25zb2xlLmxvZyhgW2NyZWF0ZUZpbmFuY2lhbFJlY29yZEZyb21TYWxlXSBGaW5hbmNpYWwgcmVjb3JkIGFscmVhZHkgZXhpc3RzIGZvciBzYWxlICR7c2FsZS5pZH0sIHNraXBwaW5nIGNyZWF0aW9uYCk7XHJcbiAgICAgIHJldHVybiBleGlzdGluZ0ZpbnJlYztcclxuICAgIH1cclxuICAgIFxyXG4gICAgY29uc3QgY3VycmVudERhdGUgPSBuZXcgRGF0ZSgpO1xyXG4gICAgY29uc3QgbmV3RmlucmVjOiBGaW5hbmNpYWxSZWNvcmQgPSB7XHJcbiAgICAgIGlkOiBgZmlucmVjLSR7c2FsZS5pZH0tJHtEYXRlLm5vdygpfWAsXHJcbiAgICAgIG5hbWU6IGBTYWxlOiAke3NhbGUuY291bnRlcnBhcnR5TmFtZX1gLFxyXG4gICAgICBkZXNjcmlwdGlvbjogYEZpbmFuY2lhbCByZWNvcmQgZnJvbSBzYWxlOiAke3NhbGUuY291bnRlcnBhcnR5TmFtZX1gLFxyXG4gICAgICB5ZWFyOiBjdXJyZW50RGF0ZS5nZXRGdWxsWWVhcigpLFxyXG4gICAgICBtb250aDogY3VycmVudERhdGUuZ2V0TW9udGgoKSArIDEsXHJcbiAgICAgIHN0YXRpb246ICdTYWxlcycgYXMgYW55LCAvLyBTYWxlcyBhcmUgYnVzaW5lc3MgYWN0aXZpdGllc1xyXG4gICAgICB0eXBlOiAnY29tcGFueScsXHJcbiAgICAgIHNpdGVJZDogc2FsZS5zaXRlSWQsXHJcbiAgICAgIHRhcmdldFNpdGVJZDogdW5kZWZpbmVkLFxyXG4gICAgICBzb3VyY2VTYWxlSWQ6IHNhbGUuaWQsIC8vIEFNQkFTU0FET1IgZmllbGQgLSBwb2ludHMgYmFjayB0byBTYWxlXHJcbiAgICAgIGNvc3Q6IDAsIC8vIFNhbGVzIHR5cGljYWxseSBkb24ndCBoYXZlIGNvc3RzXHJcbiAgICAgIHJldmVudWU6IHNhbGUudG90YWxzLnRvdGFsUmV2ZW51ZSxcclxuICAgICAganVuZ2xlQ29pbnM6IDAsIC8vIEokIG5vIGxvbmdlciBhd2FyZGVkIGFzIHNhbGUgcmV3YXJkc1xyXG4gICAgICBpc05vdFBhaWQ6IHNhbGUuaXNOb3RQYWlkIHx8IGZhbHNlLFxyXG4gICAgICBpc05vdENoYXJnZWQ6IHNhbGUuaXNOb3RDaGFyZ2VkIHx8IGZhbHNlLFxyXG4gICAgICByZXdhcmRzOiB7IHBvaW50czogeyB4cDogMCwgcnA6IDAsIGZwOiAwLCBocDogMCB9IH0sIC8vIFBvaW50cyBoYW5kbGVkIHNlcGFyYXRlbHlcclxuICAgICAgbmV0Q2FzaGZsb3c6IHNhbGUudG90YWxzLnRvdGFsUmV2ZW51ZSxcclxuICAgICAganVuZ2xlQ29pbnNWYWx1ZTogMCxcclxuICAgICAgaXNDb2xsZWN0ZWQ6IGZhbHNlLFxyXG4gICAgICBjcmVhdGVkQXQ6IG5ldyBEYXRlKCksXHJcbiAgICAgIHVwZGF0ZWRBdDogbmV3IERhdGUoKSxcclxuICAgICAgbGlua3M6IFtdXHJcbiAgICB9O1xyXG4gICAgXHJcbiAgICAvLyBTdG9yZSB0aGUgZmluYW5jaWFsIHJlY29yZFxyXG4gICAgY29uc29sZS5sb2coYFtjcmVhdGVGaW5hbmNpYWxSZWNvcmRGcm9tU2FsZV0gQ3JlYXRpbmcgZmluYW5jaWFsIHJlY29yZDpgLCBuZXdGaW5yZWMpO1xyXG4gICAgY29uc3QgY3JlYXRlZEZpbnJlYyA9IGF3YWl0IENsaWVudEFQSS51cHNlcnRGaW5hbmNpYWxSZWNvcmQobmV3RmlucmVjKTtcclxuICAgIFxyXG4gICAgLy8gQ3JlYXRlIFNBTEVfRklOUkVDIGxpbmtcclxuICAgIGNvbnN0IGxpbmtNZXRhZGF0YSA9IHtcclxuICAgICAgcmV2ZW51ZTogc2FsZS50b3RhbHMudG90YWxSZXZlbnVlLFxyXG4gICAgICBpc05vdFBhaWQ6IHNhbGUuaXNOb3RQYWlkIHx8IGZhbHNlLFxyXG4gICAgICBpc05vdENoYXJnZWQ6IHNhbGUuaXNOb3RDaGFyZ2VkIHx8IGZhbHNlLFxyXG4gICAgICBuZXRDYXNoZmxvdzogbmV3RmlucmVjLm5ldENhc2hmbG93LFxyXG4gICAgICBjcmVhdGVkRnJvbTogJ3NhbGUnXHJcbiAgICB9O1xyXG4gICAgXHJcbiAgICBjb25zdCBsaW5rID0gbWFrZUxpbmsoXHJcbiAgICAgIExpbmtUeXBlLlNBTEVfRklOUkVDLFxyXG4gICAgICB7IHR5cGU6IEVudGl0eVR5cGUuU0FMRSwgaWQ6IHNhbGUuaWQgfSxcclxuICAgICAgeyB0eXBlOiBFbnRpdHlUeXBlLkZJTkFOQ0lBTCwgaWQ6IGNyZWF0ZWRGaW5yZWMuaWQgfSxcclxuICAgICAgbGlua01ldGFkYXRhXHJcbiAgICApO1xyXG4gICAgXHJcbiAgICBhd2FpdCBjcmVhdGVMaW5rKGxpbmspO1xyXG4gICAgXHJcbiAgICBjb25zb2xlLmxvZyhgW2NyZWF0ZUZpbmFuY2lhbFJlY29yZEZyb21TYWxlXSDinIUgRmluYW5jaWFsIHJlY29yZCBjcmVhdGVkIGFuZCBTQUxFX0ZJTlJFQyBsaW5rIGVzdGFibGlzaGVkOiAke2NyZWF0ZWRGaW5yZWMubmFtZX1gKTtcclxuICAgIFxyXG4gICAgcmV0dXJuIGNyZWF0ZWRGaW5yZWM7XHJcbiAgICBcclxuICB9IGNhdGNoIChlcnJvcikge1xyXG4gICAgY29uc29sZS5lcnJvcihgW2NyZWF0ZUZpbmFuY2lhbFJlY29yZEZyb21TYWxlXSDinYwgRmFpbGVkIHRvIGNyZWF0ZSBmaW5hbmNpYWwgcmVjb3JkIGZyb20gc2FsZSAke3NhbGUuaWR9OmAsIGVycm9yKTtcclxuICAgIHRocm93IGVycm9yO1xyXG4gIH1cclxufVxyXG5cclxuLyoqXHJcbiAqIEVuaGFuY2VkIGZpbmFuY2lhbCByZWNvcmQgY3JlYXRpb24gLSBwdXJlIGJ1c2luZXNzIGxvZ2ljLCBubyBsaW5rIGNyZWF0aW9uXHJcbiAqL1xyXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gcHJvY2Vzc0ZpbmFuY2lhbFJlY29yZENyZWF0aW9uV2l0aExpbmtzKHJlY29yZDogRmluYW5jaWFsUmVjb3JkKTogUHJvbWlzZTxGaW5hbmNpYWxSZWNvcmQ+IHtcclxuICBjb25zb2xlLmxvZyhgW3Byb2Nlc3NGaW5hbmNpYWxSZWNvcmRDcmVhdGlvbldpdGhMaW5rc10gUHJvY2Vzc2luZyBmaW5hbmNpYWwgcmVjb3JkIGNyZWF0aW9uOiAke3JlY29yZC5uYW1lfSAoJHtyZWNvcmQuaWR9KWApO1xyXG4gIFxyXG4gIHJldHVybiByZWNvcmQ7XHJcbn0iXSwibmFtZXMiOlsiTGlua1R5cGUiLCJFbnRpdHlUeXBlIiwiQ2xpZW50QVBJIiwibWFrZUxpbmsiLCJjcmVhdGVMaW5rIiwiYXBwZW5kRW50aXR5TG9nIiwiY3JlYXRlRmluYW5jaWFsUmVjb3JkRnJvbVRhc2siLCJ0YXNrIiwiY29uc29sZSIsImxvZyIsIm5hbWUiLCJpZCIsImNvc3QiLCJyZXZlbnVlIiwiYWxsRmluYW5jaWFscyIsImdldEZpbmFuY2lhbFJlY29yZHMiLCJleGlzdGluZ0ZpbnJlYyIsImZpbmQiLCJmciIsInNvdXJjZVRhc2tJZCIsImN1cnJlbnREYXRlIiwiRGF0ZSIsIm5ld0ZpbnJlYyIsIm5vdyIsImRlc2NyaXB0aW9uIiwieWVhciIsImdldEZ1bGxZZWFyIiwibW9udGgiLCJnZXRNb250aCIsInN0YXRpb24iLCJ0eXBlIiwic2l0ZUlkIiwidGFyZ2V0U2l0ZUlkIiwianVuZ2xlQ29pbnMiLCJpc05vdFBhaWQiLCJpc05vdENoYXJnZWQiLCJyZXdhcmRzIiwibmV0Q2FzaGZsb3ciLCJqdW5nbGVDb2luc1ZhbHVlIiwiaXNDb2xsZWN0ZWQiLCJjcmVhdGVkQXQiLCJ1cGRhdGVkQXQiLCJsaW5rcyIsImNyZWF0ZWRGaW5yZWMiLCJ1cHNlcnRGaW5hbmNpYWxSZWNvcmQiLCJsaW5rTWV0YWRhdGEiLCJjcmVhdGVkRnJvbSIsImxpbmsiLCJUQVNLX0ZJTlJFQyIsIlRBU0siLCJGSU5BTkNJQUwiLCJlcnJvciIsInVwZGF0ZUZpbmFuY2lhbFJlY29yZEZyb21UYXNrIiwicHJldmlvdXNUYXNrIiwiZmluYW5jaWFsUHJvcHNDaGFuZ2VkIiwidXBkYXRlZEZpbnJlYyIsInVwZGF0ZWRGcm9tIiwiY2hhbmdlcyIsImZyb20iLCJ0byIsInRvSVNPU3RyaW5nIiwicmVtb3ZlRmluYW5jaWFsUmVjb3Jkc0NyZWF0ZWRCeVRhc2siLCJ0YXNrSWQiLCJ0YXNrRmluYW5jaWFscyIsImZpbHRlciIsImxlbmd0aCIsImZpbmFuY2lhbCIsImRlbGV0ZUZpbmFuY2lhbFJlY29yZCIsImNyZWF0ZUZpbmFuY2lhbFJlY29yZEZyb21TYWxlIiwic2FsZSIsImNvdW50ZXJwYXJ0eU5hbWUiLCJ0b3RhbHMiLCJ0b3RhbFJldmVudWUiLCJzb3VyY2VTYWxlSWQiLCJ1bmRlZmluZWQiLCJwb2ludHMiLCJ4cCIsInJwIiwiZnAiLCJocCIsIlNBTEVfRklOUkVDIiwiU0FMRSIsInByb2Nlc3NGaW5hbmNpYWxSZWNvcmRDcmVhdGlvbldpdGhMaW5rcyIsInJlY29yZCJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(app-pages-browser)/./workflows/financial-record-utils.ts\n"));

/***/ }),

/***/ "(app-pages-browser)/./workflows/item-creation-utils.ts":
/*!******************************************!*\
  !*** ./workflows/item-creation-utils.ts ***!
  \******************************************/
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval(__webpack_require__.ts("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   createItemFromRecord: function() { return /* binding */ createItemFromRecord; },\n/* harmony export */   createItemFromTask: function() { return /* binding */ createItemFromTask; },\n/* harmony export */   getDefaultItemStatus: function() { return /* binding */ getDefaultItemStatus; },\n/* harmony export */   processItemCreationWithLinks: function() { return /* binding */ processItemCreationWithLinks; },\n/* harmony export */   removeItemsCreatedByRecord: function() { return /* binding */ removeItemsCreatedByRecord; },\n/* harmony export */   removeItemsCreatedByTask: function() { return /* binding */ removeItemsCreatedByTask; }\n/* harmony export */ });\n/* harmony import */ var _types_enums__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @/types/enums */ \"(app-pages-browser)/./types/enums.ts\");\n/* harmony import */ var _data_store_datastore__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @/data-store/datastore */ \"(app-pages-browser)/./data-store/datastore.ts\");\n/* harmony import */ var _data_store_repositories_item_repo__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @/data-store/repositories/item.repo */ \"(app-pages-browser)/./data-store/repositories/item.repo.ts\");\n// workflows/item-creation-utils.ts\n// Item Creation System - DNA/RNA Molecular Pattern Implementation\n// Creates items from Tasks and Financial Records using emissary fields\n\n\n\n/**\r\n * Determines the default item status based on item type and sale status\r\n * All newly created items start as CREATED, regardless of type\r\n * Their status will change based on business logic later\r\n */ function getDefaultItemStatus(itemType) {\n    let isSold = arguments.length > 1 && arguments[1] !== void 0 ? arguments[1] : false;\n    if (isSold) {\n        return _types_enums__WEBPACK_IMPORTED_MODULE_0__.ItemStatus.SOLD;\n    }\n    // All newly created items start as CREATED, regardless of type\n    // Their status will change based on business logic later\n    return _types_enums__WEBPACK_IMPORTED_MODULE_0__.ItemStatus.CREATED;\n}\n/**\r\n * Creates an Item entity from a Task's emissary fields\r\n * IDEMPOTENT: Checks if item already exists before creating\r\n * Uses atomic operations to prevent race conditions\r\n */ async function createItemFromTask(task) {\n    try {\n        console.log(\"[createItemFromTask] Starting item creation for task: \".concat(task.name, \" (\").concat(task.id, \")\"));\n        console.log(\"[createItemFromTask] outputItemType: \".concat(task.outputItemType));\n        console.log(\"[createItemFromTask] outputQuantity: \".concat(task.outputQuantity));\n        if (!task.outputItemType) {\n            console.error(\"Cannot create item: outputItemType is required\");\n            return null;\n        }\n        // IDEMPOTENCY CHECK: Look for existing item created by this task\n        console.log(\"[createItemFromTask] Checking for existing items...\");\n        const allItems = await (0,_data_store_datastore__WEBPACK_IMPORTED_MODULE_1__.getAllItems)();\n        console.log(\"[createItemFromTask] Found \".concat(allItems.length, \" total items\"));\n        const existingItems = allItems.filter((item)=>item.sourceTaskId === task.id && item.type === task.outputItemType);\n        console.log(\"[createItemFromTask] Found \".concat(existingItems.length, \" existing items for this task\"));\n        if (existingItems.length > 0) {\n            console.log(\"[createItemFromTask] Item already exists, skipping creation\");\n            return existingItems[0]; // Return existing item\n        }\n        const newItem = {\n            id: \"item-\".concat(task.id, \"-\").concat(Date.now()),\n            name: task.outputItemName || \"\".concat(task.outputItemType, \" from \").concat(task.name),\n            description: \"Created from task: \".concat(task.name),\n            type: task.outputItemType,\n            collection: task.outputItemCollection || undefined,\n            status: getDefaultItemStatus(task.outputItemType || \"\", task.isSold || false),\n            station: task.station,\n            unitCost: task.outputUnitCost || 0,\n            additionalCost: 0,\n            price: task.outputItemPrice || 0,\n            value: 0,\n            quantitySold: 0,\n            sourceTaskId: task.id,\n            ownerCharacterId: task.customerCharacterId || null,\n            isCollected: false,\n            year: new Date().getFullYear(),\n            createdAt: new Date(),\n            updatedAt: new Date(),\n            links: [],\n            stock: [\n                {\n                    siteId: task.targetSiteId || task.siteId || \"home-storage\",\n                    quantity: task.outputQuantity || 1\n                }\n            ]\n        };\n        // Store the item in DataStore\n        console.log(\"[createItemFromTask] Creating new item:\", newItem);\n        const createdItem = await (0,_data_store_datastore__WEBPACK_IMPORTED_MODULE_1__.upsertItem)(newItem);\n        console.log(\"[createItemFromTask]  Item created successfully\");\n        return createdItem;\n    } catch (error) {\n        console.error(\"Error creating item from task:\", error);\n        return null;\n    }\n}\n/**\r\n * Creates an Item entity from a Financial Record's emissary fields\r\n * IDEMPOTENT: Checks if item already exists before creating\r\n * Uses atomic operations to prevent race conditions\r\n */ async function createItemFromRecord(record) {\n    try {\n        console.log(\"[createItemFromRecord] Starting item creation for record: \".concat(record.name, \" (\").concat(record.id, \")\"));\n        console.log(\"[createItemFromRecord] outputItemType: \".concat(record.outputItemType));\n        console.log(\"[createItemFromRecord] outputQuantity: \".concat(record.outputQuantity));\n        if (!record.outputItemType) {\n            console.error(\"Cannot create item: outputItemType is required\");\n            return null;\n        }\n        // IDEMPOTENCY CHECK: Look for existing item created by this record\n        console.log(\"[createItemFromRecord] Checking for existing items...\");\n        const allItems = await (0,_data_store_datastore__WEBPACK_IMPORTED_MODULE_1__.getAllItems)();\n        console.log(\"[createItemFromRecord] Found \".concat(allItems.length, \" total items\"));\n        const existingItems = allItems.filter((item)=>item.sourceRecordId === record.id && item.type === record.outputItemType);\n        console.log(\"[createItemFromRecord] Found \".concat(existingItems.length, \" existing items for this record\"));\n        if (existingItems.length > 0) {\n            console.log(\"[createItemFromRecord] Item already exists, skipping creation\");\n            return existingItems[0]; // Return existing item\n        }\n        const newItem = {\n            id: \"item-\".concat(record.id, \"-\").concat(Date.now()),\n            name: record.outputItemName || \"\".concat(record.outputItemType, \" from \").concat(record.name),\n            description: \"Created from record: \".concat(record.name),\n            type: record.outputItemType,\n            collection: record.outputItemCollection || undefined,\n            status: getDefaultItemStatus(record.outputItemType || \"\", record.isSold || false),\n            station: record.station,\n            unitCost: record.outputUnitCost || 0,\n            additionalCost: 0,\n            price: record.outputItemPrice || 0,\n            value: 0,\n            quantitySold: 0,\n            sourceRecordId: record.id,\n            isCollected: false,\n            year: record.year,\n            createdAt: new Date(),\n            updatedAt: new Date(),\n            links: [],\n            stock: [\n                {\n                    siteId: record.siteId || \"home-storage\",\n                    quantity: record.outputQuantity || 1\n                }\n            ]\n        };\n        // Store the item in DataStore\n        console.log(\"[createItemFromRecord] Creating new item:\", newItem);\n        const createdItem = await (0,_data_store_datastore__WEBPACK_IMPORTED_MODULE_1__.upsertItem)(newItem);\n        console.log(\"[createItemFromRecord]  Item created successfully\");\n        return createdItem;\n    } catch (error) {\n        console.error(\"Error creating item from record:\", error);\n        return null;\n    }\n}\n/**\r\n * Removes all items created by a specific task\r\n * Used when task is uncompleted or deleted\r\n */ async function removeItemsCreatedByTask(taskId) {\n    try {\n        console.log(\"[removeItemsCreatedByTask] Removing items created by task: \".concat(taskId));\n        const items = await (0,_data_store_datastore__WEBPACK_IMPORTED_MODULE_1__.getAllItems)();\n        const itemsToRemove = items.filter((item)=>item.sourceTaskId === taskId);\n        console.log(\"[removeItemsCreatedByTask] Found \".concat(itemsToRemove.length, \" items to remove\"));\n        // Remove each item created by this task\n        for (const item of itemsToRemove){\n            try {\n                await (0,_data_store_repositories_item_repo__WEBPACK_IMPORTED_MODULE_2__.deleteItem)(item.id);\n                console.log(\"[removeItemsCreatedByTask]  Removed item: \".concat(item.name, \" (\").concat(item.id, \")\"));\n            } catch (error) {\n                console.error(\"[removeItemsCreatedByTask]  Failed to remove item \".concat(item.id, \":\"), error);\n            }\n        }\n        // Dispatch event to update UI\n        if (true) {\n            window.dispatchEvent(new CustomEvent(\"itemsUpdated\"));\n        }\n        console.log(\"[removeItemsCreatedByTask]  Completed removal of \".concat(itemsToRemove.length, \" items\"));\n    } catch (error) {\n        console.error(\"Error removing items created by task:\", error);\n    }\n}\n/**\r\n * Removes all items created by a specific financial record\r\n * Used when financial record is deleted\r\n */ async function removeItemsCreatedByRecord(recordId) {\n    try {\n        console.log(\"[removeItemsCreatedByRecord] Removing items created by record: \".concat(recordId));\n        const items = await (0,_data_store_datastore__WEBPACK_IMPORTED_MODULE_1__.getAllItems)();\n        const itemsToRemove = items.filter((item)=>item.sourceRecordId === recordId);\n        console.log(\"[removeItemsCreatedByRecord] Found \".concat(itemsToRemove.length, \" items to remove\"));\n        // Remove each item created by this record\n        for (const item of itemsToRemove){\n            try {\n                await (0,_data_store_repositories_item_repo__WEBPACK_IMPORTED_MODULE_2__.deleteItem)(item.id);\n                console.log(\"[removeItemsCreatedByRecord]  Removed item: \".concat(item.name, \" (\").concat(item.id, \")\"));\n            } catch (error) {\n                console.error(\"[removeItemsCreatedByRecord]  Failed to remove item \".concat(item.id, \":\"), error);\n            }\n        }\n        // Dispatch event to update UI\n        if (true) {\n            window.dispatchEvent(new CustomEvent(\"itemsUpdated\"));\n        }\n        console.log(\"[removeItemsCreatedByRecord]  Completed removal of \".concat(itemsToRemove.length, \" items\"));\n    } catch (error) {\n        console.error(\"Error removing items created by record:\", error);\n    }\n}\n/**\r\n * Enhanced item creation - pure business logic, no link creation\r\n */ async function processItemCreationWithLinks(item) {\n    console.log(\"[processItemCreationWithLinks] Processing item creation: \".concat(item.name, \" (\").concat(item.id, \")\"));\n    return item;\n}\n\n\n;\n    // Wrapped in an IIFE to avoid polluting the global scope\n    ;\n    (function () {\n        var _a, _b;\n        // Legacy CSS implementations will `eval` browser code in a Node.js context\n        // to extract CSS. For backwards compatibility, we need to check we're in a\n        // browser context before continuing.\n        if (typeof self !== 'undefined' &&\n            // AMP / No-JS mode does not inject these helpers:\n            '$RefreshHelpers$' in self) {\n            // @ts-ignore __webpack_module__ is global\n            var currentExports = module.exports;\n            // @ts-ignore __webpack_module__ is global\n            var prevSignature = (_b = (_a = module.hot.data) === null || _a === void 0 ? void 0 : _a.prevSignature) !== null && _b !== void 0 ? _b : null;\n            // This cannot happen in MainTemplate because the exports mismatch between\n            // templating and execution.\n            self.$RefreshHelpers$.registerExportsForReactRefresh(currentExports, module.id);\n            // A module can be accepted automatically based on its exports, e.g. when\n            // it is a Refresh Boundary.\n            if (self.$RefreshHelpers$.isReactRefreshBoundary(currentExports)) {\n                // Save the previous exports signature on update so we can compare the boundary\n                // signatures. We avoid saving exports themselves since it causes memory leaks (https://github.com/vercel/next.js/pull/53797)\n                module.hot.dispose(function (data) {\n                    data.prevSignature =\n                        self.$RefreshHelpers$.getRefreshBoundarySignature(currentExports);\n                });\n                // Unconditionally accept an update to this module, we'll check if it's\n                // still a Refresh Boundary later.\n                // @ts-ignore importMeta is replaced in the loader\n                module.hot.accept();\n                // This field is set when the previous version of this module was a\n                // Refresh Boundary, letting us know we need to check for invalidation or\n                // enqueue an update.\n                if (prevSignature !== null) {\n                    // A boundary can become ineligible if its exports are incompatible\n                    // with the previous exports.\n                    //\n                    // For example, if you add/remove/change exports, we'll want to\n                    // re-execute the importing modules, and force those components to\n                    // re-render. Similarly, if you convert a class component to a\n                    // function, we want to invalidate the boundary.\n                    if (self.$RefreshHelpers$.shouldInvalidateReactRefreshBoundary(prevSignature, self.$RefreshHelpers$.getRefreshBoundarySignature(currentExports))) {\n                        module.hot.invalidate();\n                    }\n                    else {\n                        self.$RefreshHelpers$.scheduleUpdate();\n                    }\n                }\n            }\n            else {\n                // Since we just executed the code for the module, it's possible that the\n                // new exports made it ineligible for being a boundary.\n                // We only care about the case when we were _previously_ a boundary,\n                // because we already accepted this update (accidental side effect).\n                var isNoLongerABoundary = prevSignature !== null;\n                if (isNoLongerABoundary) {\n                    module.hot.invalidate();\n                }\n            }\n        }\n    })();\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFwcC1wYWdlcy1icm93c2VyKS8uL3dvcmtmbG93cy9pdGVtLWNyZWF0aW9uLXV0aWxzLnRzIiwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7OztBQUFBLG1DQUFtQztBQUNuQyxrRUFBa0U7QUFDbEUsdUVBQXVFO0FBR0k7QUFDVjtBQUNBO0FBS2pFOzs7O0NBSUMsR0FDTSxTQUFTSSxxQkFBcUJDLFFBQWdCO1FBQUVDLFNBQUFBLGlFQUFrQjtJQUN2RSxJQUFJQSxRQUFRO1FBQ1YsT0FBT04sb0RBQVVBLENBQUNPLElBQUk7SUFDeEI7SUFFQSwrREFBK0Q7SUFDL0QseURBQXlEO0lBQ3pELE9BQU9QLG9EQUFVQSxDQUFDUSxPQUFPO0FBQzNCO0FBRUE7Ozs7Q0FJQyxHQUNNLGVBQWVDLG1CQUFtQkMsSUFBVTtJQUNqRCxJQUFJO1FBQ0ZDLFFBQVFDLEdBQUcsQ0FBQyx5REFBdUVGLE9BQWRBLEtBQUtHLElBQUksRUFBQyxNQUFZLE9BQVJILEtBQUtJLEVBQUUsRUFBQztRQUMzRkgsUUFBUUMsR0FBRyxDQUFDLHdDQUE0RCxPQUFwQkYsS0FBS0ssY0FBYztRQUN2RUosUUFBUUMsR0FBRyxDQUFDLHdDQUE0RCxPQUFwQkYsS0FBS00sY0FBYztRQUV2RSxJQUFJLENBQUNOLEtBQUtLLGNBQWMsRUFBRTtZQUN4QkosUUFBUU0sS0FBSyxDQUFDO1lBQ2QsT0FBTztRQUNUO1FBRUEsaUVBQWlFO1FBQ2pFTixRQUFRQyxHQUFHLENBQUU7UUFDYixNQUFNTSxXQUFXLE1BQU1oQixrRUFBV0E7UUFDbENTLFFBQVFDLEdBQUcsQ0FBQyw4QkFBOEMsT0FBaEJNLFNBQVNDLE1BQU0sRUFBQztRQUUxRCxNQUFNQyxnQkFBZ0JGLFNBQVNHLE1BQU0sQ0FBQ0MsQ0FBQUEsT0FDcENBLEtBQUtDLFlBQVksS0FBS2IsS0FBS0ksRUFBRSxJQUM3QlEsS0FBS0UsSUFBSSxLQUFLZCxLQUFLSyxjQUFjO1FBRW5DSixRQUFRQyxHQUFHLENBQUMsOEJBQW1ELE9BQXJCUSxjQUFjRCxNQUFNLEVB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QkFDeEJILFFBQVFDLEdBQUcsQ0FBQyxnREFBOERVLE9BQWRBLEtBQUtULElBQUksRUFBQyxNQUFZLE9BQVJTLEtBQUtSLEVBQUUsRUFBQztZQUNwRixFQUFFLE9BQU9HLE9BQU87Z0JBQ2ROLFFBQVFNLEtBQUssQ0FBQyx3REFBZ0UsT0FBUkssS0FBS1IsRUFBRSxFQUFDLE1BQUlHO1lBQ3BGO1FBQ0Y7UUFFQSw4QkFBOEI7UUFDOUIsSUFBSSxJQUFrQixFQUFhO1lBQ2pDNkMsT0FBT0MsYUFBYSxDQUFDLElBQUlDLFlBQVk7UUFDdkM7UUFFQXJELFFBQVFDLEdBQUcsQ0FBQyx1REFBNEUsT0FBckJpRCxjQUFjMUMsTUFBTSxFQUFDO0lBQzFGLEVBQUUsT0FBT0YsT0FBTztRQUNkTixRQUFRTSxLQUFLLENBQUMsMkNBQTJDQTtJQUMzRDtBQUNGO0FBRUE7O0NBRUMsR0FDTSxlQUFla0QsNkJBQTZCN0MsSUFBVTtJQUMzRFgsUUFBUUMsR0FBRyxDQUFDLDREQUEwRVUsT0FBZEEsS0FBS1QsSUFBSSxFQUFDLE1BQVksT0FBUlMsS0FBS1IsRUFBRSxFQUFDO0lBRTlGLE9BQU9RO0FBQ1QiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9fTl9FLy4vd29ya2Zsb3dzL2l0ZW0tY3JlYXRpb24tdXRpbHMudHM/ZTI1ZSJdLCJzb3VyY2VzQ29udGVudCI6WyIvLyB3b3JrZmxvd3MvaXRlbS1jcmVhdGlvbi11dGlscy50c1xyXG4vLyBJdGVtIENyZWF0aW9uIFN5c3RlbSAtIEROQS9STkEgTW9sZWN1bGFyIFBhdHRlcm4gSW1wbGVtZW50YXRpb25cclxuLy8gQ3JlYXRlcyBpdGVtcyBmcm9tIFRhc2tzIGFuZCBGaW5hbmNpYWwgUmVjb3JkcyB1c2luZyBlbWlzc2FyeSBmaWVsZHNcclxuXHJcbmltcG9ydCB0eXBlIHsgVGFzaywgSXRlbSwgRmluYW5jaWFsUmVjb3JkIH0gZnJvbSAnQC90eXBlcy9lbnRpdGllcyc7XHJcbmltcG9ydCB7IEl0ZW1TdGF0dXMsIEl0ZW1UeXBlLCBMaW5rVHlwZSwgRW50aXR5VHlwZSB9IGZyb20gJ0AvdHlwZXMvZW51bXMnO1xyXG5pbXBvcnQgeyB1cHNlcnRJdGVtLCBnZXRBbGxJdGVtcyB9IGZyb20gJ0AvZGF0YS1zdG9yZS9kYXRhc3RvcmUnO1xyXG5pbXBvcnQgeyBkZWxldGVJdGVtIH0gZnJvbSAnQC9kYXRhLXN0b3JlL3JlcG9zaXRvcmllcy9pdGVtLnJlcG8nO1xyXG5pbXBvcnQgeyBoYXNFZmZlY3QsIG1hcmtFZmZlY3QgfSBmcm9tICdAL2RhdGEtc3RvcmUvZWZmZWN0cy1yZWdpc3RyeSc7XHJcbi8vIGxpbmtzIGFyZSBjcmVhdGVkIGJ5IHByb2Nlc3NMaW5rRW50aXR5KClcclxuaW1wb3J0IHsgdjQgYXMgdXVpZCB9IGZyb20gJ3V1aWQnO1xyXG5cclxuLyoqXHJcbiAqIERldGVybWluZXMgdGhlIGRlZmF1bHQgaXRlbSBzdGF0dXMgYmFzZWQgb24gaXRlbSB0eXBlIGFuZCBzYWxlIHN0YXR1c1xyXG4gKiBBbGwgbmV3bHkgY3JlYXRlZCBpdGVtcyBzdGFydCBhcyBDUkVBVEVELCByZWdhcmRsZXNzIG9mIHR5cGVcclxuICogVGhlaXIgc3RhdHVzIHdpbGwgY2hhbmdlIGJhc2VkIG9uIGJ1c2luZXNzIGxvZ2ljIGxhdGVyXHJcbiAqL1xyXG5leHBvcnQgZnVuY3Rpb24gZ2V0RGVmYXVsdEl0ZW1TdGF0dXMoaXRlbVR5cGU6IHN0cmluZywgaXNTb2xkOiBib29sZWFuID0gZmFsc2UpOiBJdGVtU3RhdHVzIHtcclxuICBpZiAoaXNTb2xkKSB7XHJcbiAgICByZXR1cm4gSXRlbVN0YXR1cy5TT0xEO1xyXG4gIH1cclxuICBcclxuICAvLyBBbGwgbmV3bHkgY3JlYXRlZCBpdGVtcyBzdGFydCBhcyBDUkVBVEVELCByZWdhcmRsZXNzIG9mIHR5cGVcclxuICAvLyBUaGVpciBzdGF0dXMgd2lsbCBjaGFuZ2UgYmFzZWQgb24gYnVzaW5lc3MgbG9naWMgbGF0ZXJcclxuICByZXR1cm4gSXRlbVN0YXR1cy5DUkVBVEVEO1xyXG59XHJcblxyXG4vKipcclxuICogQ3JlYXRlcyBhbiBJdGVtIGVudGl0eSBmcm9tIGEgVGFzaydzIGVtaXNzYXJ5IGZpZWxkc1xyXG4gKiBJREVNUE9URU5UOiBDaGVja3MgaWYgaXRlbSBhbHJlYWR5IGV4aXN0cyBiZWZvcmUgY3JlYXRpbmdcclxuICogVXNlcyBhdG9taWMgb3BlcmF0aW9ucyB0byBwcmV2ZW50IHJhY2UgY29uZGl0aW9uc1xyXG4gKi9cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGNyZWF0ZUl0ZW1Gcm9tVGFzayh0YXNrOiBUYXNrKTogUHJvbWlzZTxJdGVtIHwgbnVsbD4ge1xyXG4gIHRyeSB7XHJcbiAgICBjb25zb2xlLmxvZyhgW2NyZWF0ZUl0ZW1Gcm9tVGFza10gU3RhcnRpbmcgaXRlbSBjcmVhdGlvbiBmb3IgdGFzazogJHt0YXNrLm5hbWV9ICgke3Rhc2suaWR9KWApO1xyXG4gICAgY29uc29sZS5sb2coYFtjcmVhdGVJdGVtRnJvbVRhc2tdIG91dHB1dEl0ZW1UeXBlOiAke3Rhc2sub3V0cHV0SXRlbVR5cGV9YCk7XHJcbiAgICBjb25zb2xlLmxvZyhgW2NyZWF0ZUl0ZW1Gcm9tVGFza10gb3V0cHV0UXVhbnRpdHk6ICR7dGFzay5vdXRwdXRRdWFudGl0eX1gKTtcclxuICAgIFxyXG4gICAgaWYgKCF0YXNrLm91dHB1dEl0ZW1UeXBlKSB7XHJcbiAgICAgIGNvbnNvbGUuZXJyb3IoJ0Nhbm5vdCBjcmVhdGUgaXRlbTogb3V0cHV0SXRlbVR5cGUgaXMgcmVxdWlyZWQnKTtcclxuICAgICAgcmV0dXJuIG51bGw7XHJcbiAgICB9XHJcbiAgICBcclxuICAgIC8vIElERU1QT1RFTkNZIENIRUNLOiBMb29rIGZvciBleGlzdGluZyBpdGVtIGNyZWF0ZWQgYnkgdGhpcyB0YXNrXHJcbiAgICBjb25zb2xlLmxvZyhgW2NyZWF0ZUl0ZW1Gcm9tVGFza10gQ2hlY2tpbmcgZm9yIGV4aXN0aW5nIGl0ZW1zLi4uYCk7XHJcbiAgICBjb25zdCBhbGxJdGVtcyA9IGF3YWl0IGdldEFsbEl0ZW1zKCk7XHJcbiAgICBjb25zb2xlLmxvZyhgW2NyZWF0ZUl0ZW1Gcm9tVGFza10gRm91bmQgJHthbGxJdGVtcy5sZW5ndGh9IHRvdGFsIGl0ZW1zYCk7XHJcbiAgICBcclxuICAgIGNvbnN0IGV4aXN0aW5nSXRlbXMgPSBhbGxJdGVtcy5maWx0ZXIoaXRlbSA9PiBcclxuICAgICAgaXRlbS5zb3VyY2VUYXNrSWQgPT09IHRhc2suaWQgJiYgXHJcbiAgICAgIGl0ZW0udHlwZSA9PT0gdGFzay5vdXRwdXRJdGVtVHlwZVxyXG4gICAgKTtcclxuICAgIGNvbnNvbGUubG9nKGBbY3JlYXRlSXRlbUZyb21UYXNrXSBGb3VuZCAke2V4aXN0aW5nSXRlbXMubGVuZ3RofSBleGlzdGluZyBpdGVtcyBmb3IgdGhpcyB0YXNrYCk7XHJcbiAgICBcclxuICAgIGlmIChleGlzdGluZ0l0ZW1zLmxlbmd0aCA+IDApIHtcclxuICAgICAgY29uc29sZS5sb2coYFtjcmVhdGVJdGVtRnJvbVRhc2tdIEl0ZW0gYWxyZWFkeSBleGlzdHMsIHNraXBwaW5nIGNyZWF0aW9uYCk7XHJcbiAgICAgIHJldHVybiBleGlzdGluZ0l0ZW1zWzBdOyAvLyBSZXR1cm4gZXhpc3RpbmcgaXRlbVxyXG4gICAgfVxyXG4gICAgXHJcbiAgICBjb25zdCBuZXdJdGVtOiBJdGVtID0ge1xyXG4gICAgICBpZDogYGl0ZW0tJHt0YXNrLmlkfS0ke0RhdGUubm93KCl9YCwgLy8gTW9yZSBwcmVkaWN0YWJsZSBJRCBiYXNlZCBvbiB0YXNrIElEXHJcbiAgICAgIG5hbWU6IHRhc2sub3V0cHV0SXRlbU5hbWUgfHwgYCR7dGFzay5vdXRwdXRJdGVtVHlwZX0gZnJvbSAke3Rhc2submFtZX1gLFxyXG4gICAgICBkZXNjcmlwdGlvbjogYENyZWF0ZWQgZnJvbSB0YXNrOiAke3Rhc2submFtZX1gLFxyXG4gICAgICB0eXBlOiB0YXNrLm91dHB1dEl0ZW1UeXBlIGFzIEl0ZW1UeXBlLFxyXG4gICAgICBjb2xsZWN0aW9uOiB0YXNrLm91dHB1dEl0ZW1Db2xsZWN0aW9uIHx8IHVuZGVmaW5lZCxcclxuICAgICAgc3RhdHVzOiBnZXREZWZhdWx0SXRlbVN0YXR1cyh0YXNrLm91dHB1dEl0ZW1UeXBlIHx8ICcnLCB0YXNrLmlzU29sZCB8fCBmYWxzZSksXHJcbiAgICAgIHN0YXRpb246IHRhc2suc3RhdGlvbixcclxuICAgICAgdW5pdENvc3Q6IHRhc2sub3V0cHV0VW5pdENvc3QgfHwgMCxcclxuICAgICAgYWRkaXRpb25hbENvc3Q6IDAsXHJcbiAgICAgIHByaWNlOiB0YXNrLm91dHB1dEl0ZW1QcmljZSB8fCAwLCAvLyBVc2UgdGFzaydzIG91dHB1dEl0ZW1QcmljZSBpbnN0ZWFkIG9mIHVuaXRDb3N0XHJcbiAgICAgIHZhbHVlOiAwLFxyXG4gICAgICBxdWFudGl0eVNvbGQ6IDAsXHJcbiAgICAgIHNvdXJjZVRhc2tJZDogdGFzay5pZCwgLy8gTGluayBpdGVtIGJhY2sgdG8gdGhlIHRhc2sgdGhhdCBjcmVhdGVkIGl0XHJcbiAgICAgIG93bmVyQ2hhcmFjdGVySWQ6IHRhc2suY3VzdG9tZXJDaGFyYWN0ZXJJZCB8fCBudWxsLCAvLyBFbWlzc2FyeTogUGFzcyBjdXN0b21lciBhcyBpdGVtIG93bmVyXHJcbiAgICAgIGlzQ29sbGVjdGVkOiBmYWxzZSxcclxuICAgICAgeWVhcjogbmV3IERhdGUoKS5nZXRGdWxsWWVhcigpLCAvLyBTZXQgY3VycmVudCB5ZWFyXHJcbiAgICAgIGNyZWF0ZWRBdDogbmV3IERhdGUoKSxcclxuICAgICAgdXBkYXRlZEF0OiBuZXcgRGF0ZSgpLFxyXG4gICAgICBsaW5rczogW10sICAvLyBJbml0aWFsaXplIGxpbmtzIGFycmF5IChUaGUgUm9zZXR0YSBTdG9uZSlcclxuICAgICAgc3RvY2s6IFtcclxuICAgICAgICB7XHJcbiAgICAgICAgICBzaXRlSWQ6IHRhc2sudGFyZ2V0U2l0ZUlkIHx8IHRhc2suc2l0ZUlkIHx8ICdob21lLXN0b3JhZ2UnLCAvLyBEZWZhdWx0IHRvIGhvbWUgc3RvcmFnZVxyXG4gICAgICAgICAgcXVhbnRpdHk6IHRhc2sub3V0cHV0UXVhbnRpdHkgfHwgMVxyXG4gICAgICAgIH1cclxuICAgICAgXVxyXG4gICAgfTtcclxuICAgIFxyXG4gICAgLy8gU3RvcmUgdGhlIGl0ZW0gaW4gRGF0YVN0b3JlXHJcbiAgICBjb25zb2xlLmxvZyhgW2NyZWF0ZUl0ZW1Gcm9tVGFza10gQ3JlYXRpbmcgbmV3IGl0ZW06YCwgbmV3SXRlbSk7XHJcbiAgICBjb25zdCBjcmVhdGVkSXRlbSA9IGF3YWl0IHVwc2VydEl0ZW0obmV3SXRlbSk7XHJcbiAgICBjb25zb2xlLmxvZyhgW2NyZWF0ZUl0ZW1Gcm9tVGFza10g4pyFIEl0ZW0gY3JlYXRlZCBzdWNjZXNzZnVsbHlgKTtcclxuICAgIFxyXG4gICAgcmV0dXJuIGNyZWF0ZWRJdGVtO1xyXG4gIH0gY2F0Y2ggKGVycm9yKSB7XHJcbiAgICBjb25zb2xlLmVycm9yKCdFcnJvciBjcmVhdGluZyBpdGVtIGZyb20gdGFzazonLCBlcnJvcik7XHJcbiAgICByZXR1cm4gbnVsbDtcclxuICB9XHJcbn1cclxuXHJcbi8qKlxyXG4gKiBDcmVhdGVzIGFuIEl0ZW0gZW50aXR5IGZyb20gYSBGaW5hbmNpYWwgUmVjb3JkJ3MgZW1pc3NhcnkgZmllbGRzXHJcbiAqIElERU1QT1RFTlQ6IENoZWNrcyBpZiBpdGVtIGFscmVhZHkgZXhpc3RzIGJlZm9yZSBjcmVhdGluZ1xyXG4gKiBVc2VzIGF0b21pYyBvcGVyYXRpb25zIHRvIHByZXZlbnQgcmFjZSBjb25kaXRpb25zXHJcbiAqL1xyXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gY3JlYXRlSXRlbUZyb21SZWNvcmQocmVjb3JkOiBGaW5hbmNpYWxSZWNvcmQpOiBQcm9taXNlPEl0ZW0gfCBudWxsPiB7XHJcbiAgdHJ5IHtcclxuICAgIGNvbnNvbGUubG9nKGBbY3JlYXRlSXRlbUZyb21SZWNvcmRdIFN0YXJ0aW5nIGl0ZW0gY3JlYXRpb24gZm9yIHJlY29yZDogJHtyZWNvcmQubmFtZX0gKCR7cmVjb3JkLmlkfSlgKTtcclxuICAgIGNvbnNvbGUubG9nKGBbY3JlYXRlSXRlbUZyb21SZWNvcmRdIG91dHB1dEl0ZW1UeXBlOiAke3JlY29yZC5vdXRwdXRJdGVtVHlwZX1gKTtcclxuICAgIGNvbnNvbGUubG9nKGBbY3JlYXRlSXRlbUZyb21SZWNvcmRdIG91dHB1dFF1YW50aXR5OiAke3JlY29yZC5vdXRwdXRRdWFudGl0eX1gKTtcclxuICAgIFxyXG4gICAgaWYgKCFyZWNvcmQub3V0cHV0SXRlbVR5cGUpIHtcclxuICAgICAgY29uc29sZS5lcnJvcignQ2Fubm90IGNyZWF0ZSBpdGVtOiBvdXRwdXRJdGVtVHlwZSBpcyByZXF1aXJlZCcpO1xyXG4gICAgICByZXR1cm4gbnVsbDtcclxuICAgIH1cclxuICAgIFxyXG4gICAgLy8gSURFTVBPVEVOQ1kgQ0hFQ0s6IExvb2sgZm9yIGV4aXN0aW5nIGl0ZW0gY3JlYXRlZCBieSB0aGlzIHJlY29yZFxyXG4gICAgY29uc29sZS5sb2coYFtjcmVhdGVJdGVtRnJvbVJlY29yZF0gQ2hlY2tpbmcgZm9yIGV4aXN0aW5nIGl0ZW1zLi4uYCk7XHJcbiAgICBjb25zdCBhbGxJdGVtcyA9IGF3YWl0IGdldEFsbEl0ZW1zKCk7XHJcbiAgICBjb25zb2xlLmxvZyhgW2NyZWF0ZUl0ZW1Gcm9tUmVjb3JkXSBGb3VuZCAke2FsbEl0ZW1zLmxlbmd0aH0gdG90YWwgaXRlbXNgKTtcclxuICAgIFxyXG4gICAgY29uc3QgZXhpc3RpbmdJdGVtcyA9IGFsbEl0ZW1zLmZpbHRlcihpdGVtID0+IFxyXG4gICAgICBpdGVtLnNvdXJjZVJlY29yZElkID09PSByZWNvcmQuaWQgJiYgXHJcbiAgICAgIGl0ZW0udHlwZSA9PT0gcmVjb3JkLm91dHB1dEl0ZW1UeXBlXHJcbiAgICApO1xyXG4gICAgY29uc29sZS5sb2coYFtjcmVhdGVJdGVtRnJvbVJlY29yZF0gRm91bmQgJHtleGlzdGluZ0l0ZW1zLmxlbmd0aH0gZXhpc3RpbmcgaXRlbXMgZm9yIHRoaXMgcmVjb3JkYCk7XHJcbiAgICBcclxuICAgIGlmIChleGlzdGluZ0l0ZW1zLmxlbmd0aCA+IDApIHtcclxuICAgICAgY29uc29sZS5sb2coYFtjcmVhdGVJdGVtRnJvbVJlY29yZF0gSXRlbSBhbHJlYWR5IGV4aXN0cywgc2tpcHBpbmcgY3JlYXRpb25gKTtcclxuICAgICAgcmV0dXJuIGV4aXN0aW5nSXRlbXNbMF07IC8vIFJldHVybiBleGlzdGluZyBpdGVtXHJcbiAgICB9XHJcbiAgICBcclxuICAgIGNvbnN0IG5ld0l0ZW06IEl0ZW0gPSB7XHJcbiAgICAgIGlkOiBgaXRlbS0ke3JlY29yZC5pZH0tJHtEYXRlLm5vdygpfWAsIC8vIE1vcmUgcHJlZGljdGFibGUgSUQgYmFzZWQgb24gcmVjb3JkIElEXHJcbiAgICAgIG5hbWU6IHJlY29yZC5vdXRwdXRJdGVtTmFtZSB8fCBgJHtyZWNvcmQub3V0cHV0SXRlbVR5cGV9IGZyb20gJHtyZWNvcmQubmFtZX1gLFxyXG4gICAgICBkZXNjcmlwdGlvbjogYENyZWF0ZWQgZnJvbSByZWNvcmQ6ICR7cmVjb3JkLm5hbWV9YCxcclxuICAgICAgdHlwZTogcmVjb3JkLm91dHB1dEl0ZW1UeXBlIGFzIEl0ZW1UeXBlLFxyXG4gICAgICBjb2xsZWN0aW9uOiByZWNvcmQub3V0cHV0SXRlbUNvbGxlY3Rpb24gfHwgdW5kZWZpbmVkLFxyXG4gICAgICBzdGF0dXM6IGdldERlZmF1bHRJdGVtU3RhdHVzKHJlY29yZC5vdXRwdXRJdGVtVHlwZSB8fCAnJywgcmVjb3JkLmlzU29sZCB8fCBmYWxzZSksXHJcbiAgICAgIHN0YXRpb246IHJlY29yZC5zdGF0aW9uLFxyXG4gICAgICB1bml0Q29zdDogcmVjb3JkLm91dHB1dFVuaXRDb3N0IHx8IDAsXHJcbiAgICAgIGFkZGl0aW9uYWxDb3N0OiAwLFxyXG4gICAgICBwcmljZTogcmVjb3JkLm91dHB1dEl0ZW1QcmljZSB8fCAwLCAvLyBVc2UgcmVjb3JkJ3Mgb3V0cHV0SXRlbVByaWNlIGluc3RlYWQgb2YgdW5pdENvc3RcclxuICAgICAgdmFsdWU6IDAsXHJcbiAgICAgIHF1YW50aXR5U29sZDogMCxcclxuICAgICAgc291cmNlUmVjb3JkSWQ6IHJlY29yZC5pZCwgLy8gTGluayBpdGVtIGJhY2sgdG8gdGhlIHJlY29yZCB0aGF0IGNyZWF0ZWQgaXRcclxuICAgICAgaXNDb2xsZWN0ZWQ6IGZhbHNlLFxyXG4gICAgICB5ZWFyOiByZWNvcmQueWVhciwgLy8gVXNlIHJlY29yZCdzIHllYXJcclxuICAgICAgY3JlYXRlZEF0OiBuZXcgRGF0ZSgpLFxyXG4gICAgICB1cGRhdGVkQXQ6IG5ldyBEYXRlKCksXHJcbiAgICAgIGxpbmtzOiBbXSwgIC8vIEluaXRpYWxpemUgbGlua3MgYXJyYXkgKFRoZSBSb3NldHRhIFN0b25lKVxyXG4gICAgICBzdG9jazogW1xyXG4gICAgICAgIHtcclxuICAgICAgICAgIHNpdGVJZDogcmVjb3JkLnNpdGVJZCB8fCAnaG9tZS1zdG9yYWdlJywgLy8gRGVmYXVsdCB0byBob21lIHN0b3JhZ2VcclxuICAgICAgICAgIHF1YW50aXR5OiByZWNvcmQub3V0cHV0UXVhbnRpdHkgfHwgMVxyXG4gICAgICAgIH1cclxuICAgICAgXVxyXG4gICAgfTtcclxuICAgIFxyXG4gICAgLy8gU3RvcmUgdGhlIGl0ZW0gaW4gRGF0YVN0b3JlXHJcbiAgICBjb25zb2xlLmxvZyhgW2NyZWF0ZUl0ZW1Gcm9tUmVjb3JkXSBDcmVhdGluZyBuZXcgaXRlbTpgLCBuZXdJdGVtKTtcclxuICAgIGNvbnN0IGNyZWF0ZWRJdGVtID0gYXdhaXQgdXBzZXJ0SXRlbShuZXdJdGVtKTtcclxuICAgIGNvbnNvbGUubG9nKGBbY3JlYXRlSXRlbUZyb21SZWNvcmRdIOKchSBJdGVtIGNyZWF0ZWQgc3VjY2Vzc2Z1bGx5YCk7XHJcbiAgICBcclxuICAgIHJldHVybiBjcmVhdGVkSXRlbTtcclxuICB9IGNhdGNoIChlcnJvcikge1xyXG4gICAgY29uc29sZS5lcnJvcignRXJyb3IgY3JlYXRpbmcgaXRlbSBmcm9tIHJlY29yZDonLCBlcnJvcik7XHJcbiAgICByZXR1cm4gbnVsbDtcclxuICB9XHJcbn1cclxuXHJcbi8qKlxyXG4gKiBSZW1vdmVzIGFsbCBpdGVtcyBjcmVhdGVkIGJ5IGEgc3BlY2lmaWMgdGFza1xyXG4gKiBVc2VkIHdoZW4gdGFzayBpcyB1bmNvbXBsZXRlZCBvciBkZWxldGVkXHJcbiAqL1xyXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gcmVtb3ZlSXRlbXNDcmVhdGVkQnlUYXNrKHRhc2tJZDogc3RyaW5nKTogUHJvbWlzZTx2b2lkPiB7XHJcbiAgdHJ5IHtcclxuICAgIGNvbnNvbGUubG9nKGBbcmVtb3ZlSXRlbXNDcmVhdGVkQnlUYXNrXSBSZW1vdmluZyBpdGVtcyBjcmVhdGVkIGJ5IHRhc2s6ICR7dGFza0lkfWApO1xyXG4gICAgXHJcbiAgICBjb25zdCBpdGVtcyA9IGF3YWl0IGdldEFsbEl0ZW1zKCk7XHJcbiAgICBjb25zdCBpdGVtc1RvUmVtb3ZlID0gaXRlbXMuZmlsdGVyKGl0ZW0gPT4gaXRlbS5zb3VyY2VUYXNrSWQgPT09IHRhc2tJZCk7XHJcbiAgICBcclxuICAgIGNvbnNvbGUubG9nKGBbcmVtb3ZlSXRlbXNDcmVhdGVkQnlUYXNrXSBGb3VuZCAke2l0ZW1zVG9SZW1vdmUubGVuZ3RofSBpdGVtcyB0byByZW1vdmVgKTtcclxuICAgIFxyXG4gICAgLy8gUmVtb3ZlIGVhY2ggaXRlbSBjcmVhdGVkIGJ5IHRoaXMgdGFza1xyXG4gICAgZm9yIChjb25zdCBpdGVtIG9mIGl0ZW1zVG9SZW1vdmUpIHtcclxuICAgICAgdHJ5IHtcclxuICAgICAgICBhd2FpdCBkZWxldGVJdGVtKGl0ZW0uaWQpO1xyXG4gICAgICAgIGNvbnNvbGUubG9nKGBbcmVtb3ZlSXRlbXNDcmVhdGVkQnlUYXNrXSDinIUgUmVtb3ZlZCBpdGVtOiAke2l0ZW0ubmFtZX0gKCR7aXRlbS5pZH0pYCk7XHJcbiAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XHJcbiAgICAgICAgY29uc29sZS5lcnJvcihgW3JlbW92ZUl0ZW1zQ3JlYXRlZEJ5VGFza10g4p2MIEZhaWxlZCB0byByZW1vdmUgaXRlbSAke2l0ZW0uaWR9OmAsIGVycm9yKTtcclxuICAgICAgfVxyXG4gICAgfVxyXG4gICAgXHJcbiAgICAvLyBEaXNwYXRjaCBldmVudCB0byB1cGRhdGUgVUlcclxuICAgIGlmICh0eXBlb2Ygd2luZG93ICE9PSAndW5kZWZpbmVkJykge1xyXG4gICAgICB3aW5kb3cuZGlzcGF0Y2hFdmVudChuZXcgQ3VzdG9tRXZlbnQoJ2l0ZW1zVXBkYXRlZCcpKTtcclxuICAgIH1cclxuICAgIFxyXG4gICAgY29uc29sZS5sb2coYFtyZW1vdmVJdGVtc0NyZWF0ZWRCeVRhc2tdIOKchSBDb21wbGV0ZWQgcmVtb3ZhbCBvZiAke2l0ZW1zVG9SZW1vdmUubGVuZ3RofSBpdGVtc2ApO1xyXG4gIH0gY2F0Y2ggKGVycm9yKSB7XHJcbiAgICBjb25zb2xlLmVycm9yKCdFcnJvciByZW1vdmluZyBpdGVtcyBjcmVhdGVkIGJ5IHRhc2s6JywgZXJyb3IpO1xyXG4gIH1cclxufVxyXG5cclxuLyoqXHJcbiAqIFJlbW92ZXMgYWxsIGl0ZW1zIGNyZWF0ZWQgYnkgYSBzcGVjaWZpYyBmaW5hbmNpYWwgcmVjb3JkXHJcbiAqIFVzZWQgd2hlbiBmaW5hbmNpYWwgcmVjb3JkIGlzIGRlbGV0ZWRcclxuICovXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiByZW1vdmVJdGVtc0NyZWF0ZWRCeVJlY29yZChyZWNvcmRJZDogc3RyaW5nKTogUHJvbWlzZTx2b2lkPiB7XHJcbiAgdHJ5IHtcclxuICAgIGNvbnNvbGUubG9nKGBbcmVtb3ZlSXRlbXNDcmVhdGVkQnlSZWNvcmRdIFJlbW92aW5nIGl0ZW1zIGNyZWF0ZWQgYnkgcmVjb3JkOiAke3JlY29yZElkfWApO1xyXG4gICAgXHJcbiAgICBjb25zdCBpdGVtcyA9IGF3YWl0IGdldEFsbEl0ZW1zKCk7XHJcbiAgICBjb25zdCBpdGVtc1RvUmVtb3ZlID0gaXRlbXMuZmlsdGVyKGl0ZW0gPT4gaXRlbS5zb3VyY2VSZWNvcmRJZCA9PT0gcmVjb3JkSWQpO1xyXG4gICAgXHJcbiAgICBjb25zb2xlLmxvZyhgW3JlbW92ZUl0ZW1zQ3JlYXRlZEJ5UmVjb3JkXSBGb3VuZCAke2l0ZW1zVG9SZW1vdmUubGVuZ3RofSBpdGVtcyB0byByZW1vdmVgKTtcclxuICAgIFxyXG4gICAgLy8gUmVtb3ZlIGVhY2ggaXRlbSBjcmVhdGVkIGJ5IHRoaXMgcmVjb3JkXHJcbiAgICBmb3IgKGNvbnN0IGl0ZW0gb2YgaXRlbXNUb1JlbW92ZSkge1xyXG4gICAgICB0cnkge1xyXG4gICAgICAgIGF3YWl0IGRlbGV0ZUl0ZW0oaXRlbS5pZCk7XHJcbiAgICAgICAgY29uc29sZS5sb2coYFtyZW1vdmVJdGVtc0NyZWF0ZWRCeVJlY29yZF0g4pyFIFJlbW92ZWQgaXRlbTogJHtpdGVtLm5hbWV9ICgke2l0ZW0uaWR9KWApO1xyXG4gICAgICB9IGNhdGNoIChlcnJvcikge1xyXG4gICAgICAgIGNvbnNvbGUuZXJyb3IoYFtyZW1vdmVJdGVtc0NyZWF0ZWRCeVJlY29yZF0g4p2MIEZhaWxlZCB0byByZW1vdmUgaXRlbSAke2l0ZW0uaWR9OmAsIGVycm9yKTtcclxuICAgICAgfVxyXG4gICAgfVxyXG4gICAgXHJcbiAgICAvLyBEaXNwYXRjaCBldmVudCB0byB1cGRhdGUgVUlcclxuICAgIGlmICh0eXBlb2Ygd2luZG93ICE9PSAndW5kZWZpbmVkJykge1xyXG4gICAgICB3aW5kb3cuZGlzcGF0Y2hFdmVudChuZXcgQ3VzdG9tRXZlbnQoJ2l0ZW1zVXBkYXRlZCcpKTtcclxuICAgIH1cclxuICAgIFxyXG4gICAgY29uc29sZS5sb2coYFtyZW1vdmVJdGVtc0NyZWF0ZWRCeVJlY29yZF0g4pyFIENvbXBsZXRlZCByZW1vdmFsIG9mICR7aXRlbXNUb1JlbW92ZS5sZW5ndGh9IGl0ZW1zYCk7XHJcbiAgfSBjYXRjaCAoZXJyb3IpIHtcclxuICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIHJlbW92aW5nIGl0ZW1zIGNyZWF0ZWQgYnkgcmVjb3JkOicsIGVycm9yKTtcclxuICB9XHJcbn1cclxuXHJcbi8qKlxyXG4gKiBFbmhhbmNlZCBpdGVtIGNyZWF0aW9uIC0gcHVyZSBidXNpbmVzcyBsb2dpYywgbm8gbGluayBjcmVhdGlvblxyXG4gKi9cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIHByb2Nlc3NJdGVtQ3JlYXRpb25XaXRoTGlua3MoaXRlbTogSXRlbSk6IFByb21pc2U8SXRlbT4ge1xyXG4gIGNvbnNvbGUubG9nKGBbcHJvY2Vzc0l0ZW1DcmVhdGlvbldpdGhMaW5rc10gUHJvY2Vzc2luZyBpdGVtIGNyZWF0aW9uOiAke2l0ZW0ubmFtZX0gKCR7aXRlbS5pZH0pYCk7XHJcbiAgXHJcbiAgcmV0dXJuIGl0ZW07XHJcbn1cclxuIl0sIm5hbWVzIjpbIkl0ZW1TdGF0dXMiLCJ1cHNlcnRJdGVtIiwiZ2V0QWxsSXRlbXMiLCJkZWxldGVJdGVtIiwiZ2V0RGVmYXVsdEl0ZW1TdGF0dXMiLCJpdGVtVHlwZSIsImlzU29sZCIsIlNPTEQiLCJDUkVBVEVEIiwiY3JlYXRlSXRlbUZyb21UYXNrIiwidGFzayIsImNvbnNvbGUiLCJsb2ciLCJuYW1lIiwiaWQiLCJvdXRwdXRJdGVtVHlwZSIsIm91dHB1dFF1YW50aXR5IiwiZXJyb3IiLCJhbGxJdGVtcyIsImxlbmd0aCIsImV4aXN0aW5nSXRlbXMiLCJmaWx0ZXIiLCJpdGVtIiwic291cmNlVGFza0lkIiwidHlwZSIsIm5ld0l0ZW0iLCJEYXRlIiwibm93Iiwib3V0cHV0SXRlbU5hbWUiLCJkZXNjcmlwdGlvbiIsImNvbGxlY3Rpb24iLCJvdXRwdXRJdGVtQ29sbGVjdGlvbiIsInVuZGVmaW5lZCIsInN0YXR1cyIsInN0YXRpb24iLCJ1bml0Q29zdCIsIm91dHB1dFVuaXRDb3N0IiwiYWRkaXRpb25hbENvc3QiLCJwcmljZSIsIm91dHB1dEl0ZW1QcmljZSIsInZhbHVlIiwicXVhbnRpdHlTb2xkIiwib3duZXJDaGFyYWN0ZXJJZCIsImN1c3RvbWVyQ2hhcmFjdGVySWQiLCJpc0NvbGxlY3RlZCIsInllYXIiLCJnZXRGdWxsWWVhciIsImNyZWF0ZWRBdCIsInVwZGF0ZWRBdCIsImxpbmtzIiwic3RvY2siLCJzaXRlSWQiLCJ0YXJnZXRTaXRlSWQiLCJxdWFudGl0eSIsImNyZWF0ZWRJdGVtIiwiY3JlYXRlSXRlbUZyb21SZWNvcmQiLCJyZWNvcmQiLCJzb3VyY2VSZWNvcmRJZCIsInJlbW92ZUl0ZW1zQ3JlYXRlZEJ5VGFzayIsInRhc2tJZCIsIml0ZW1zIiwiaXRlbXNUb1JlbW92ZSIsIndpbmRvdyIsImRpc3BhdGNoRXZlbnQiLCJDdXN0b21FdmVudCIsInJlbW92ZUl0ZW1zQ3JlYXRlZEJ5UmVjb3JkIiwicmVjb3JkSWQiLCJwcm9jZXNzSXRlbUNyZWF0aW9uV2l0aExpbmtzIl0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(app-pages-browser)/./workflows/item-creation-utils.ts\n"));

/***/ }),

/***/ "(app-pages-browser)/./workflows/points-rewards-utils.ts":
/*!*******************************************!*\
  !*** ./workflows/points-rewards-utils.ts ***!
  \*******************************************/
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval(__webpack_require__.ts("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   awardJungleCoinsToCharacter: function() { return /* binding */ awardJungleCoinsToCharacter; },\n/* harmony export */   awardPointsToPlayer: function() { return /* binding */ awardPointsToPlayer; },\n/* harmony export */   calculatePointsFromRevenue: function() { return /* binding */ calculatePointsFromRevenue; },\n/* harmony export */   getMainCharacterId: function() { return /* binding */ getMainCharacterId; },\n/* harmony export */   getMainPlayerId: function() { return /* binding */ getMainPlayerId; },\n/* harmony export */   removeJungleCoinsFromCharacter: function() { return /* binding */ removeJungleCoinsFromCharacter; },\n/* harmony export */   removePointsFromPlayer: function() { return /* binding */ removePointsFromPlayer; }\n/* harmony export */ });\n/* harmony import */ var _lib_client_api__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @/lib/client-api */ \"(app-pages-browser)/./lib/client-api.ts\");\n/* harmony import */ var _links_links_workflows__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @/links/links-workflows */ \"(app-pages-browser)/./links/links-workflows.ts\");\n/* harmony import */ var _links_link_registry__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @/links/link-registry */ \"(app-pages-browser)/./links/link-registry.ts\");\n/* harmony import */ var _types_enums__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! @/types/enums */ \"(app-pages-browser)/./types/enums.ts\");\n// thegame/workflows/points-rewards-utils.ts\n\n\n\n\n/**\r\n * Awards points to a player with idempotency and proper tracking\r\n * @param playerId - ID of the player to award points to\r\n * @param points - Points to award (XP, RP, FP, HP)\r\n * @param sourceId - ID of the entity that triggered the award\r\n * @param sourceType - Type of entity (task, financial, sale)\r\n */ async function awardPointsToPlayer(playerId, points, sourceId, sourceType) {\n    try {\n        var _player_points, _player_points1, _player_points2, _player_points3, _player_totalPoints, _player_totalPoints1, _player_totalPoints2, _player_totalPoints3;\n        console.log(\"[awardPointsToPlayer] Awarding points to player \".concat(playerId, \" from \").concat(sourceType, \" \").concat(sourceId));\n        // Get the player\n        const players = await _lib_client_api__WEBPACK_IMPORTED_MODULE_0__.ClientAPI.getPlayers();\n        const player = players.find((p)=>p.id === playerId);\n        if (!player) {\n            console.log(\"[awardPointsToPlayer] Player \".concat(playerId, \" not found, skipping\"));\n            return;\n        }\n        // Check if any points to award\n        const hasPoints = (points.xp || 0) > 0 || (points.rp || 0) > 0 || (points.fp || 0) > 0 || (points.hp || 0) > 0;\n        if (!hasPoints) {\n            console.log(\"[awardPointsToPlayer] No points to award, skipping\");\n            return;\n        }\n        // Update player points\n        const updatedPlayer = {\n            ...player,\n            points: {\n                xp: (((_player_points = player.points) === null || _player_points === void 0 ? void 0 : _player_points.xp) || 0) + (points.xp || 0),\n                rp: (((_player_points1 = player.points) === null || _player_points1 === void 0 ? void 0 : _player_points1.rp) || 0) + (points.rp || 0),\n                fp: (((_player_points2 = player.points) === null || _player_points2 === void 0 ? void 0 : _player_points2.fp) || 0) + (points.fp || 0),\n                hp: (((_player_points3 = player.points) === null || _player_points3 === void 0 ? void 0 : _player_points3.hp) || 0) + (points.hp || 0)\n            },\n            totalPoints: {\n                xp: (((_player_totalPoints = player.totalPoints) === null || _player_totalPoints === void 0 ? void 0 : _player_totalPoints.xp) || 0) + (points.xp || 0),\n                rp: (((_player_totalPoints1 = player.totalPoints) === null || _player_totalPoints1 === void 0 ? void 0 : _player_totalPoints1.rp) || 0) + (points.rp || 0),\n                fp: (((_player_totalPoints2 = player.totalPoints) === null || _player_totalPoints2 === void 0 ? void 0 : _player_totalPoints2.fp) || 0) + (points.fp || 0),\n                hp: (((_player_totalPoints3 = player.totalPoints) === null || _player_totalPoints3 === void 0 ? void 0 : _player_totalPoints3.hp) || 0) + (points.hp || 0)\n            },\n            updatedAt: new Date()\n        };\n        // Save updated player\n        await _lib_client_api__WEBPACK_IMPORTED_MODULE_0__.ClientAPI.upsertPlayer(updatedPlayer);\n        console.log(\"[awardPointsToPlayer]  Points awarded successfully:\", points);\n        // Create appropriate link based on source type - use forward links (SOURCE  PLAYER)\n        let linkType;\n        let sourceEntityType;\n        switch(sourceType){\n            case \"task\":\n                linkType = _types_enums__WEBPACK_IMPORTED_MODULE_3__.LinkType.TASK_PLAYER;\n                sourceEntityType = _types_enums__WEBPACK_IMPORTED_MODULE_3__.EntityType.TASK;\n                break;\n            case \"financial\":\n                linkType = _types_enums__WEBPACK_IMPORTED_MODULE_3__.LinkType.FINREC_PLAYER;\n                sourceEntityType = _types_enums__WEBPACK_IMPORTED_MODULE_3__.EntityType.FINANCIAL;\n                break;\n            case \"sale\":\n                linkType = _types_enums__WEBPACK_IMPORTED_MODULE_3__.LinkType.SALE_PLAYER;\n                sourceEntityType = _types_enums__WEBPACK_IMPORTED_MODULE_3__.EntityType.SALE;\n                break;\n            default:\n                console.warn(\"[awardPointsToPlayer] Unknown source type: \".concat(sourceType));\n                return;\n        }\n        // Create link with points metadata (forward link: SOURCE  PLAYER)\n        const link = (0,_links_links_workflows__WEBPACK_IMPORTED_MODULE_1__.makeLink)(linkType, {\n            type: sourceEntityType,\n            id: sourceId\n        }, {\n            type: _types_enums__WEBPACK_IMPORTED_MODULE_3__.EntityType.PLAYER,\n            id: playerId\n        }, {\n            points: points,\n            sourceType: sourceType,\n            awardedAt: new Date().toISOString()\n        });\n        await (0,_links_link_registry__WEBPACK_IMPORTED_MODULE_2__.createLink)(link);\n        console.log(\"[awardPointsToPlayer]  Link created: \".concat(linkType));\n    } catch (error) {\n        console.error(\"[awardPointsToPlayer]  Failed to award points:\", error);\n        throw error;\n    }\n}\n/**\r\n * Removes points from a player (rollback function)\r\n * @param playerId - ID of the player to remove points from\r\n * @param points - Points to remove (XP, RP, FP, HP)\r\n */ async function removePointsFromPlayer(playerId, points) {\n    try {\n        var _player_points, _player_points1, _player_points2, _player_points3;\n        console.log(\"[removePointsFromPlayer] Removing points from player \".concat(playerId));\n        // Get the player\n        const players = await _lib_client_api__WEBPACK_IMPORTED_MODULE_0__.ClientAPI.getPlayers();\n        const player = players.find((p)=>p.id === playerId);\n        if (!player) {\n            console.log(\"[removePointsFromPlayer] Player \".concat(playerId, \" not found, skipping\"));\n            return;\n        }\n        // Check if any points to remove\n        const hasPoints = (points.xp || 0) > 0 || (points.rp || 0) > 0 || (points.fp || 0) > 0 || (points.hp || 0) > 0;\n        if (!hasPoints) {\n            console.log(\"[removePointsFromPlayer] No points to remove, skipping\");\n            return;\n        }\n        // Update player points (ensure they don't go negative)\n        const updatedPlayer = {\n            ...player,\n            points: {\n                xp: Math.max(0, (((_player_points = player.points) === null || _player_points === void 0 ? void 0 : _player_points.xp) || 0) - (points.xp || 0)),\n                rp: Math.max(0, (((_player_points1 = player.points) === null || _player_points1 === void 0 ? void 0 : _player_points1.rp) || 0) - (points.rp || 0)),\n                fp: Math.max(0, (((_player_points2 = player.points) === null || _player_points2 === void 0 ? void 0 : _player_points2.fp) || 0) - (points.fp || 0)),\n                hp: Math.max(0, (((_player_points3 = player.points) === null || _player_points3 === void 0 ? void 0 : _player_points3.hp) || 0) - (points.hp || 0))\n            },\n            // Note: totalPoints are NOT reduced (they track lifetime earnings)\n            updatedAt: new Date()\n        };\n        // Save updated player\n        await _lib_client_api__WEBPACK_IMPORTED_MODULE_0__.ClientAPI.upsertPlayer(updatedPlayer);\n        console.log(\"[removePointsFromPlayer]  Points removed successfully:\", points);\n    } catch (error) {\n        console.error(\"[removePointsFromPlayer]  Failed to remove points:\", error);\n        throw error;\n    }\n}\n/**\r\n * Awards jungle coins to a character\r\n * @param characterId - ID of the character to award jungle coins to\r\n * @param amount - Amount of jungle coins to award\r\n * @param sourceId - ID of the entity that triggered the award\r\n * @param sourceType - Type of entity (task, financial, sale)\r\n */ async function awardJungleCoinsToCharacter(characterId, amount, sourceId, sourceType) {\n    try {\n        console.log(\"[awardJungleCoinsToCharacter] Awarding \".concat(amount, \" J$ to character \").concat(characterId, \" from \").concat(sourceType, \" \").concat(sourceId));\n        if (amount <= 0) {\n            console.log(\"[awardJungleCoinsToCharacter] No jungle coins to award, skipping\");\n            return;\n        }\n        // Get the character\n        const characters = await _lib_client_api__WEBPACK_IMPORTED_MODULE_0__.ClientAPI.getCharacters();\n        const character = characters.find((c)=>c.id === characterId);\n        if (!character) {\n            console.log(\"[awardJungleCoinsToCharacter] Character \".concat(characterId, \" not found, skipping\"));\n            return;\n        }\n        // Update character jungle coins\n        const updatedCharacter = {\n            ...character,\n            jungleCoins: (character.jungleCoins || 0) + amount,\n            updatedAt: new Date()\n        };\n        // Save updated character\n        await _lib_client_api__WEBPACK_IMPORTED_MODULE_0__.ClientAPI.upsertCharacter(updatedCharacter);\n        console.log(\"[awardJungleCoinsToCharacter]  Jungle coins awarded successfully: \".concat(amount, \" J$\"));\n        // NOTE: J$ (Jungle Coins) are CURRENCY that belongs to FINANCIALS\n        // They can be borrowed as AMBASSADOR by Player and Character, but don't belong to them\n        // No link creation needed here - J$ are handled by the Financial system\n        console.log(\"[awardJungleCoinsToCharacter]  Jungle coins awarded to character (J$ handled by Financial system)\");\n    } catch (error) {\n        console.error(\"[awardJungleCoinsToCharacter]  Failed to award jungle coins:\", error);\n        throw error;\n    }\n}\n/**\r\n * Removes jungle coins from a character (rollback function)\r\n * @param characterId - ID of the character to remove jungle coins from\r\n * @param amount - Amount of jungle coins to remove\r\n */ async function removeJungleCoinsFromCharacter(characterId, amount) {\n    try {\n        console.log(\"[removeJungleCoinsFromCharacter] Removing \".concat(amount, \" J$ from character \").concat(characterId));\n        if (amount <= 0) {\n            console.log(\"[removeJungleCoinsFromCharacter] No jungle coins to remove, skipping\");\n            return;\n        }\n        // Get the character\n        const characters = await _lib_client_api__WEBPACK_IMPORTED_MODULE_0__.ClientAPI.getCharacters();\n        const character = characters.find((c)=>c.id === characterId);\n        if (!character) {\n            console.log(\"[removeJungleCoinsFromCharacter] Character \".concat(characterId, \" not found, skipping\"));\n            return;\n        }\n        // Update character jungle coins (ensure they don't go negative)\n        const updatedCharacter = {\n            ...character,\n            jungleCoins: Math.max(0, (character.jungleCoins || 0) - amount),\n            updatedAt: new Date()\n        };\n        // Save updated character\n        await _lib_client_api__WEBPACK_IMPORTED_MODULE_0__.ClientAPI.upsertCharacter(updatedCharacter);\n        console.log(\"[removeJungleCoinsFromCharacter]  Jungle coins removed successfully: \".concat(amount, \" J$\"));\n    } catch (error) {\n        console.error(\"[removeJungleCoinsFromCharacter]  Failed to remove jungle coins:\", error);\n        throw error;\n    }\n}\n/**\r\n * Calculates points from sale revenue (1 Point = $100)\r\n * @param revenue - Revenue amount in dollars\r\n * @returns Points to award (distributed across all types)\r\n */ function calculatePointsFromRevenue(revenue) {\n    const pointsAwarded = Math.floor(revenue / 100);\n    if (pointsAwarded <= 0) {\n        return {\n            xp: 0,\n            rp: 0,\n            fp: 0,\n            hp: 0\n        };\n    }\n    // Distribute points across all types equally\n    const pointsPerType = Math.floor(pointsAwarded / 4);\n    const remainder = pointsAwarded % 4;\n    return {\n        xp: pointsPerType + (remainder > 0 ? 1 : 0),\n        rp: pointsPerType + (remainder > 1 ? 1 : 0),\n        fp: pointsPerType + (remainder > 2 ? 1 : 0),\n        hp: pointsPerType\n    };\n}\n/**\r\n * Gets the main player ID (V0.1 constant)\r\n * TODO: V0.2 - Use character.playerId field\r\n */ function getMainPlayerId() {\n    return \"PLAYER_ONE_ID\"; // V0.1 constant\n}\n/**\r\n * Gets the main character ID (V0.1 constant)\r\n * TODO: V0.2 - Use proper character selection\r\n */ function getMainCharacterId() {\n    return \"CHARACTER_ONE_ID\"; // V0.1 constant\n}\n\n\n;\n    // Wrapped in an IIFE to avoid polluting the global scope\n    ;\n    (function () {\n        var _a, _b;\n        // Legacy CSS implementations will `eval` browser code in a Node.js context\n        // to extract CSS. For backwards compatibility, we need to check we're in a\n        // browser context before continuing.\n        if (typeof self !== 'undefined' &&\n            // AMP / No-JS mode does not inject these helpers:\n            '$RefreshHelpers$' in self) {\n            // @ts-ignore __webpack_module__ is global\n            var currentExports = module.exports;\n            // @ts-ignore __webpack_module__ is global\n            var prevSignature = (_b = (_a = module.hot.data) === null || _a === void 0 ? void 0 : _a.prevSignature) !== null && _b !== void 0 ? _b : null;\n            // This cannot happen in MainTemplate because the exports mismatch between\n            // templating and execution.\n            self.$RefreshHelpers$.registerExportsForReactRefresh(currentExports, module.id);\n            // A module can be accepted automatically based on its exports, e.g. when\n            // it is a Refresh Boundary.\n            if (self.$RefreshHelpers$.isReactRefreshBoundary(currentExports)) {\n                // Save the previous exports signature on update so we can compare the boundary\n                // signatures. We avoid saving exports themselves since it causes memory leaks (https://github.com/vercel/next.js/pull/53797)\n                module.hot.dispose(function (data) {\n                    data.prevSignature =\n                        self.$RefreshHelpers$.getRefreshBoundarySignature(currentExports);\n                });\n                // Unconditionally accept an update to this module, we'll check if it's\n                // still a Refresh Boundary later.\n                // @ts-ignore importMeta is replaced in the loader\n                module.hot.accept();\n                // This field is set when the previous version of this module was a\n                // Refresh Boundary, letting us know we need to check for invalidation or\n                // enqueue an update.\n                if (prevSignature !== null) {\n                    // A boundary can become ineligible if its exports are incompatible\n                    // with the previous exports.\n                    //\n                    // For example, if you add/remove/change exports, we'll want to\n                    // re-execute the importing modules, and force those components to\n                    // re-render. Similarly, if you convert a class component to a\n                    // function, we want to invalidate the boundary.\n                    if (self.$RefreshHelpers$.shouldInvalidateReactRefreshBoundary(prevSignature, self.$RefreshHelpers$.getRefreshBoundarySignature(currentExports))) {\n                        module.hot.invalidate();\n                    }\n                    else {\n                        self.$RefreshHelpers$.scheduleUpdate();\n                    }\n                }\n            }\n            else {\n                // Since we just executed the code for the module, it's possible that the\n                // new exports made it ineligible for being a boundary.\n                // We only care about the case when we were _previously_ a boundary,\n                // because we already accepted this update (accidental side effect).\n                var isNoLongerABoundary = prevSignature !== null;\n                if (isNoLongerABoundary) {\n                    module.hot.invalidate();\n                }\n            }\n        }\n    })();\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFwcC1wYWdlcy1icm93c2VyKS8uL3dvcmtmbG93cy9wb2ludHMtcmV3YXJkcy11dGlscy50cyIsIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7OztBQUFBLDRDQUE0QztBQUVDO0FBQ007QUFDQTtBQUNFO0FBRXJEOzs7Ozs7Q0FNQyxHQUNNLGVBQWVLLG9CQUNwQkMsUUFBZ0IsRUFDaEJDLE1BQXlCLEVBQ3pCQyxRQUFnQixFQUNoQkMsVUFBa0I7SUFFbEIsSUFBSTtZQXdCT0MsZ0JBQ0FBLGlCQUNBQSxpQkFDQUEsaUJBR0FBLHFCQUNBQSxzQkFDQUEsc0JBQ0FBO1FBaENUQyxRQUFRQyxHQUFHLENBQUMsbURBQW9FSCxPQUFqQkgsVUFBUyxVQUFzQkUsT0FBZEMsWUFBVyxLQUFZLE9BQVREO1FBRTlGLGlCQUFpQjtRQUNqQixNQUFNSyxVQUFVLE1BQU1iLHNEQUFTQSxDQUFDYyxVQUFVO1FBQzFDLE1BQU1KLFNBQVNHLFFBQVFFLElBQUksQ0FBQ0MsQ0FBQUEsSUFBS0EsRUFBRUMsRUFBRSxLQUFLWDtRQUMxQyxJQUFJLENBQUNJLFFBQVE7WUFDWEMsUUFBUUMsR0FBRyxDQUFDLGdDQUF5QyxPQUFUTixVQUFTO1lBQ3JEO1FBQ0Y7UUFFQSwrQkFBK0I7UUFDL0IsTUFBTVksWUFBWSxDQUFDWCxPQUFPWSxFQUFFLElBQUksS0FBSyxLQUFLLENBQUNaLE9BQU9hLEVBQUUsSUFBSSxLQUFLLEtBQzVDLENBQUNiLE9BQU9jLEVBQUUsSUFBSSxLQUFLLEtBQUssQ0FBQ2QsT0FBT2UsRUFBRSxJQUFJLEtBQUs7UUFFNUQsSUFBSSxDQUFDSixXQUFXO1lBQ2RQLFFBQVFDLEdBQUcsQ0FBRTtZQUNiO1FBQ0Y7UUFFQSx1QkFBdUI7UUFDdkIsTUFBTVcsZ0JBQXdCO1lBQzVCLEdBQUdiLE1BQU07WUFDVEgsUUFBUTtnQkFDTlksSUFBSSxDQUFDVCxFQUFBQSxpQkFBQUEsT0FBT0gsTUFBTSxjQUFiRyxxQ0FBQUEsZUFBZVMsRUFBRSxLQUFJLEtBQU1aLENBQUFBLE9BQU9Z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QWdCakIsS0FBS2dCLEtBQUssQ0FBQ0QsZ0JBQWdCO0lBQ2pELE1BQU1HLFlBQVlILGdCQUFnQjtJQUVsQyxPQUFPO1FBQ0x4QyxJQUFJMEMsZ0JBQWlCQyxDQUFBQSxZQUFZLElBQUksSUFBSTtRQUN6QzFDLElBQUl5QyxnQkFBaUJDLENBQUFBLFlBQVksSUFBSSxJQUFJO1FBQ3pDekMsSUFBSXdDLGdCQUFpQkMsQ0FBQUEsWUFBWSxJQUFJLElBQUk7UUFDekN4QyxJQUFJdUM7SUFDTjtBQUNGO0FBRUE7OztDQUdDLEdBQ00sU0FBU0U7SUFDZCxPQUFPLGlCQUFpQixnQkFBZ0I7QUFDMUM7QUFFQTs7O0NBR0MsR0FDTSxTQUFTQztJQUNkLE9BQU8sb0JBQW9CLGdCQUFnQjtBQUM3QyIsInNvdXJjZXMiOlsid2VicGFjazovL19OX0UvLi93b3JrZmxvd3MvcG9pbnRzLXJld2FyZHMtdXRpbHMudHM/MDQ1ZiJdLCJzb3VyY2VzQ29udGVudCI6WyIvLyB0aGVnYW1lL3dvcmtmbG93cy9wb2ludHMtcmV3YXJkcy11dGlscy50c1xyXG5pbXBvcnQgdHlwZSB7IFBsYXllciwgQ2hhcmFjdGVyLCBSZXdhcmRzIH0gZnJvbSAnQC90eXBlcy9lbnRpdGllcyc7XHJcbmltcG9ydCB7IENsaWVudEFQSSB9IGZyb20gJ0AvbGliL2NsaWVudC1hcGknO1xyXG5pbXBvcnQgeyBtYWtlTGluayB9IGZyb20gJ0AvbGlua3MvbGlua3Mtd29ya2Zsb3dzJztcclxuaW1wb3J0IHsgY3JlYXRlTGluayB9IGZyb20gJ0AvbGlua3MvbGluay1yZWdpc3RyeSc7XHJcbmltcG9ydCB7IExpbmtUeXBlLCBFbnRpdHlUeXBlIH0gZnJvbSAnQC90eXBlcy9lbnVtcyc7XHJcblxyXG4vKipcclxuICogQXdhcmRzIHBvaW50cyB0byBhIHBsYXllciB3aXRoIGlkZW1wb3RlbmN5IGFuZCBwcm9wZXIgdHJhY2tpbmdcclxuICogQHBhcmFtIHBsYXllcklkIC0gSUQgb2YgdGhlIHBsYXllciB0byBhd2FyZCBwb2ludHMgdG9cclxuICogQHBhcmFtIHBvaW50cyAtIFBvaW50cyB0byBhd2FyZCAoWFAsIFJQLCBGUCwgSFApXHJcbiAqIEBwYXJhbSBzb3VyY2VJZCAtIElEIG9mIHRoZSBlbnRpdHkgdGhhdCB0cmlnZ2VyZWQgdGhlIGF3YXJkXHJcbiAqIEBwYXJhbSBzb3VyY2VUeXBlIC0gVHlwZSBvZiBlbnRpdHkgKHRhc2ssIGZpbmFuY2lhbCwgc2FsZSlcclxuICovXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBhd2FyZFBvaW50c1RvUGxheWVyKFxyXG4gIHBsYXllcklkOiBzdHJpbmcsIFxyXG4gIHBvaW50czogUmV3YXJkc1sncG9pbnRzJ10sIFxyXG4gIHNvdXJjZUlkOiBzdHJpbmcsIFxyXG4gIHNvdXJjZVR5cGU6IHN0cmluZ1xyXG4pOiBQcm9taXNlPHZvaWQ+IHtcclxuICB0cnkge1xyXG4gICAgY29uc29sZS5sb2coYFthd2FyZFBvaW50c1RvUGxheWVyXSBBd2FyZGluZyBwb2ludHMgdG8gcGxheWVyICR7cGxheWVySWR9IGZyb20gJHtzb3VyY2VUeXBlfSAke3NvdXJjZUlkfWApO1xyXG4gICAgXHJcbiAgICAvLyBHZXQgdGhlIHBsYXllclxyXG4gICAgY29uc3QgcGxheWVycyA9IGF3YWl0IENsaWVudEFQSS5nZXRQbGF5ZXJzKCk7XHJcbiAgICBjb25zdCBwbGF5ZXIgPSBwbGF5ZXJzLmZpbmQocCA9PiBwLmlkID09PSBwbGF5ZXJJZCk7XHJcbiAgICBpZiAoIXBsYXllcikge1xyXG4gICAgICBjb25zb2xlLmxvZyhgW2F3YXJkUG9pbnRzVG9QbGF5ZXJdIFBsYXllciAke3BsYXllcklkfSBub3QgZm91bmQsIHNraXBwaW5nYCk7XHJcbiAgICAgIHJldHVybjtcclxuICAgIH1cclxuXHJcbiAgICAvLyBDaGVjayBpZiBhbnkgcG9pbnRzIHRvIGF3YXJkXHJcbiAgICBjb25zdCBoYXNQb2ludHMgPSAocG9pbnRzLnhwIHx8IDApID4gMCB8fCAocG9pbnRzLnJwIHx8IDApID4gMCB8fCBcclxuICAgICAgICAgICAgICAgICAgICAgKHBvaW50cy5mcCB8fCAwKSA+IDAgfHwgKHBvaW50cy5ocCB8fCAwKSA+IDA7XHJcbiAgICBcclxuICAgIGlmICghaGFzUG9pbnRzKSB7XHJcbiAgICAgIGNvbnNvbGUubG9nKGBbYXdhcmRQb2ludHNUb1BsYXllcl0gTm8gcG9pbnRzIHRvIGF3YXJkLCBza2lwcGluZ2ApO1xyXG4gICAgICByZXR1cm47XHJcbiAgICB9XHJcblxyXG4gICAgLy8gVXBkYXRlIHBsYXllciBwb2ludHNcclxuICAgIGNvbnN0IHVwZGF0ZWRQbGF5ZXI6IFBsYXllciA9IHtcclxuICAgICAgLi4ucGxheWVyLFxyXG4gICAgICBwb2ludHM6IHtcclxuICAgICAgICB4cDogKHBsYXllci5wb2ludHM/LnhwIHx8IDApICsgKHBvaW50cy54cCB8fCAwKSxcclxuICAgICAgICBycDogKHBsYXllci5wb2ludHM/LnJwIHx8IDApICsgKHBvaW50cy5ycCB8fCAwKSxcclxuICAgICAgICBmcDogKHBsYXllci5wb2ludHM/LmZwIHx8IDApICsgKHBvaW50cy5mcCB8fCAwKSxcclxuICAgICAgICBocDogKHBsYXllci5wb2ludHM/LmhwIHx8IDApICsgKHBvaW50cy5ocCB8fCAwKVxyXG4gICAgICB9LFxyXG4gICAgICB0b3RhbFBvaW50czoge1xyXG4gICAgICAgIHhwOiAocGxheWVyLnRvdGFsUG9pbnRzPy54cCB8fCAwKSArIChwb2ludHMueHAgfHwgMCksXHJcbiAgICAgICAgcnA6IChwbGF5ZXIudG90YWxQb2ludHM/LnJwIHx8IDApICsgKHBvaW50cy5ycCB8fCAwKSxcclxuICAgICAgICBmcDogKHBsYXllci50b3RhbFBvaW50cz8uZnAgfHwgMCkgKyAocG9pbnRzLmZwIHx8IDApLFxyXG4gICAgICAgIGhwOiAocGxheWVyLnRvdGFsUG9pbnRzPy5ocCB8fCAwKSArIChwb2ludHMuaHAgfHwgMClcclxuICAgICAgfSxcclxuICAgICAgdXBkYXRlZEF0OiBuZXcgRGF0ZSgpXHJcbiAgICB9O1xyXG5cclxuICAgIC8vIFNhdmUgdXBkYXRlZCBwbGF5ZXJcclxuICAgIGF3YWl0IENsaWVudEFQSS51cHNlcnRQbGF5ZXIodXBkYXRlZFBsYXllcik7XHJcbiAgICBjb25zb2xlLmxvZyhgW2F3YXJkUG9pbnRzVG9QbGF5ZXJdIOKchSBQb2ludHMgYXdhcmRlZCBzdWNjZXNzZnVsbHk6YCwgcG9pbnRzKTtcclxuXHJcbiAgICAvLyBDcmVhdGUgYXBwcm9wcmlhdGUgbGluayBiYXNlZCBvbiBzb3VyY2UgdHlwZSAtIHVzZSBmb3J3YXJkIGxpbmtzIChTT1VSQ0Ug4oaSIFBMQVlFUilcclxuICAgIGxldCBsaW5rVHlwZTogTGlua1R5cGU7XHJcbiAgICBsZXQgc291cmNlRW50aXR5VHlwZTogRW50aXR5VHlwZTtcclxuICAgIFxyXG4gICAgc3dpdGNoIChzb3VyY2VUeXBlKSB7XHJcbiAgICAgIGNhc2UgJ3Rhc2snOlxyXG4gICAgICAgIGxpbmtUeXBlID0gTGlua1R5cGUuVEFTS19QTEFZRVI7XHJcbiAgICAgICAgc291cmNlRW50aXR5VHlwZSA9IEVudGl0eVR5cGUuVEFTSztcclxuICAgICAgICBicmVhaztcclxuICAgICAgY2FzZSAnZmluYW5jaWFsJzpcclxuICAgICAgICBsaW5rVHlwZSA9IExpbmtUeXBlLkZJTlJFQ19QTEFZRVI7XHJcbiAgICAgICAgc291cmNlRW50aXR5VHlwZSA9IEVudGl0eVR5cGUuRklOQU5DSUFMO1xyXG4gICAgICAgIGJyZWFrO1xyXG4gICAgICBjYXNlICdzYWxlJzpcclxuICAgICAgICBsaW5rVHlwZSA9IExpbmtUeXBlLlNBTEVfUExBWUVSO1xyXG4gICAgICAgIHNvdXJjZUVudGl0eVR5cGUgPSBFbnRpdHlUeXBlLlNBTEU7XHJcbiAgICAgICAgYnJlYWs7XHJcbiAgICAgIGRlZmF1bHQ6XHJcbiAgICAgICAgY29uc29sZS53YXJuKGBbYXdhcmRQb2ludHNUb1BsYXllcl0gVW5rbm93biBzb3VyY2UgdHlwZTogJHtzb3VyY2VUeXBlfWApO1xyXG4gICAgICAgIHJldHVybjtcclxuICAgIH1cclxuXHJcbiAgICAvLyBDcmVhdGUgbGluayB3aXRoIHBvaW50cyBtZXRhZGF0YSAoZm9yd2FyZCBsaW5rOiBTT1VSQ0Ug4oaSIFBMQVlFUilcclxuICAgIGNvbnN0IGxpbmsgPSBtYWtlTGluayhcclxuICAgICAgbGlua1R5cGUsXHJcbiAgICAgIHsgdHlwZTogc291cmNlRW50aXR5VHlwZSwgaWQ6IHNvdXJjZUlkIH0sXHJcbiAgICAgIHsgdHlwZTogRW50aXR5VHlwZS5QTEFZRVIsIGlkOiBwbGF5ZXJJZCB9LFxyXG4gICAgICB7XHJcbiAgICAgICAgcG9pbnRzOiBwb2ludHMsXHJcbiAgICAgICAgc291cmNlVHlwZTogc291cmNlVHlwZSxcclxuICAgICAgICBhd2FyZGVkQXQ6IG5ldyBEYXRlKCkudG9JU09TdHJpbmcoKVxyXG4gICAgICB9XHJcbiAgICApO1xyXG5cclxuICAgIGF3YWl0IGNyZWF0ZUxpbmsobGluayk7XHJcbiAgICBjb25zb2xlLmxvZyhgW2F3YXJkUG9pbnRzVG9QbGF5ZXJdIOKchSBMaW5rIGNyZWF0ZWQ6ICR7bGlua1R5cGV9YCk7XHJcblxyXG4gIH0gY2F0Y2ggKGVycm9yKSB7XHJcbiAgICBjb25zb2xlLmVycm9yKGBbYXdhcmRQb2ludHNUb1BsYXllcl0g4p2MIEZhaWxlZCB0byBhd2FyZCBwb2ludHM6YCwgZXJyb3IpO1xyXG4gICAgdGhyb3cgZXJyb3I7XHJcbiAgfVxyXG59XHJcblxyXG4vKipcclxuICogUmVtb3ZlcyBwb2ludHMgZnJvbSBhIHBsYXllciAocm9sbGJhY2sgZnVuY3Rpb24pXHJcbiAqIEBwYXJhbSBwbGF5ZXJJZCAtIElEIG9mIHRoZSBwbGF5ZXIgdG8gcmVtb3ZlIHBvaW50cyBmcm9tXHJcbiAqIEBwYXJhbSBwb2ludHMgLSBQb2ludHMgdG8gcmVtb3ZlIChYUCwgUlAsIEZQLCBIUClcclxuICovXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiByZW1vdmVQb2ludHNGcm9tUGxheWVyKFxyXG4gIHBsYXllcklkOiBzdHJpbmcsIFxyXG4gIHBvaW50czogUmV3YXJkc1sncG9pbnRzJ11cclxuKTogUHJvbWlzZTx2b2lkPiB7XHJcbiAgdHJ5IHtcclxuICAgIGNvbnNvbGUubG9nKGBbcmVtb3ZlUG9pbnRzRnJvbVBsYXllcl0gUmVtb3ZpbmcgcG9pbnRzIGZyb20gcGxheWVyICR7cGxheWVySWR9YCk7XHJcbiAgICBcclxuICAgIC8vIEdldCB0aGUgcGxheWVyXHJcbiAgICBjb25zdCBwbGF5ZXJzID0gYXdhaXQgQ2xpZW50QVBJLmdldFBsYXllcnMoKTtcclxuICAgIGNvbnN0IHBsYXllciA9IHBsYXllcnMuZmluZChwID0+IHAuaWQgPT09IHBsYXllcklkKTtcclxuICAgIGlmICghcGxheWVyKSB7XHJcbiAgICAgIGNvbnNvbGUubG9nKGBbcmVtb3ZlUG9pbnRzRnJvbVBsYXllcl0gUGxheWVyICR7cGxheWVySWR9IG5vdCBmb3VuZCwgc2tpcHBpbmdgKTtcclxuICAgICAgcmV0dXJuO1xyXG4gICAgfVxyXG5cclxuICAgIC8vIENoZWNrIGlmIGFueSBwb2ludHMgdG8gcmVtb3ZlXHJcbiAgICBjb25zdCBoYXNQb2ludHMgPSAocG9pbnRzLnhwIHx8IDApID4gMCB8fCAocG9pbnRzLnJwIHx8IDApID4gMCB8fCBcclxuICAgICAgICAgICAgICAgICAgICAgKHBvaW50cy5mcCB8fCAwKSA+IDAgfHwgKHBvaW50cy5ocCB8fCAwKSA+IDA7XHJcbiAgICBcclxuICAgIGlmICghaGFzUG9pbnRzKSB7XHJcbiAgICAgIGNvbnNvbGUubG9nKGBbcmVtb3ZlUG9pbnRzRnJvbVBsYXllcl0gTm8gcG9pbnRzIHRvIHJlbW92ZSwgc2tpcHBpbmdgKTtcclxuICAgICAgcmV0dXJuO1xyXG4gICAgfVxyXG5cclxuICAgIC8vIFVwZGF0ZSBwbGF5ZXIgcG9pbnRzIChlbnN1cmUgdGhleSBkb24ndCBnbyBuZWdhdGl2ZSlcclxuICAgIGNvbnN0IHVwZGF0ZWRQbGF5ZXI6IFBsYXllciA9IHtcclxuICAgICAgLi4ucGxheWVyLFxyXG4gICAgICBwb2ludHM6IHtcclxuICAgICAgICB4cDogTWF0aC5tYXgoMCwgKHBsYXllci5wb2ludHM/LnhwIHx8IDApIC0gKHBvaW50cy54cCB8fCAwKSksXHJcbiAgICAgICAgcnA6IE1hdGgubWF4KDAsIChwbGF5ZXIucG9pbnRzPy5ycCB8fCAwKSAtIChwb2ludHMucnAgfHwgMCkpLFxyXG4gICAgICAgIGZwOiBNYXRoLm1heCgwLCAocGxheWVyLnBvaW50cz8uZnAgfHwgMCkgLSAocG9pbnRzLmZwIHx8IDApKSxcclxuICAgICAgICBocDogTWF0aC5tYXgoMCwgKHBsYXllci5wb2ludHM/LmhwIHx8IDApIC0gKHBvaW50cy5ocCB8fCAwKSlcclxuICAgICAgfSxcclxuICAgICAgLy8gTm90ZTogdG90YWxQb2ludHMgYXJlIE5PVCByZWR1Y2VkICh0aGV5IHRyYWNrIGxpZmV0aW1lIGVhcm5pbmdzKVxyXG4gICAgICB1cGRhdGVkQXQ6IG5ldyBEYXRlKClcclxuICAgIH07XHJcblxyXG4gICAgLy8gU2F2ZSB1cGRhdGVkIHBsYXllclxyXG4gICAgYXdhaXQgQ2xpZW50QVBJLnVwc2VydFBsYXllcih1cGRhdGVkUGxheWVyKTtcclxuICAgIGNvbnNvbGUubG9nKGBbcmVtb3ZlUG9pbnRzRnJvbVBsYXllcl0g4pyFIFBvaW50cyByZW1vdmVkIHN1Y2Nlc3NmdWxseTpgLCBwb2ludHMpO1xyXG5cclxuICB9IGNhdGNoIChlcnJvcikge1xyXG4gICAgY29uc29sZS5lcnJvcihgW3JlbW92ZVBvaW50c0Zyb21QbGF5ZXJdIOKdjCBGYWlsZWQgdG8gcmVtb3ZlIHBvaW50czpgLCBlcnJvcik7XHJcbiAgICB0aHJvdyBlcnJvcjtcclxuICB9XHJcbn1cclxuXHJcbi8qKlxyXG4gKiBBd2FyZHMganVuZ2xlIGNvaW5zIHRvIGEgY2hhcmFjdGVyXHJcbiAqIEBwYXJhbSBjaGFyYWN0ZXJJZCAtIElEIG9mIHRoZSBjaGFyYWN0ZXIgdG8gYXdhcmQganVuZ2xlIGNvaW5zIHRvXHJcbiAqIEBwYXJhbSBhbW91bnQgLSBBbW91bnQgb2YganVuZ2xlIGNvaW5zIHRvIGF3YXJkXHJcbiAqIEBwYXJhbSBzb3VyY2VJZCAtIElEIG9mIHRoZSBlbnRpdHkgdGhhdCB0cmlnZ2VyZWQgdGhlIGF3YXJkXHJcbiAqIEBwYXJhbSBzb3VyY2VUeXBlIC0gVHlwZSBvZiBlbnRpdHkgKHRhc2ssIGZpbmFuY2lhbCwgc2FsZSlcclxuICovXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBhd2FyZEp1bmdsZUNvaW5zVG9DaGFyYWN0ZXIoXHJcbiAgY2hhcmFjdGVySWQ6IHN0cmluZywgXHJcbiAgYW1vdW50OiBudW1iZXIsIFxyXG4gIHNvdXJjZUlkOiBzdHJpbmcsIFxyXG4gIHNvdXJjZVR5cGU6IHN0cmluZ1xyXG4pOiBQcm9taXNlPHZvaWQ+IHtcclxuICB0cnkge1xyXG4gICAgY29uc29sZS5sb2coYFthd2FyZEp1bmdsZUNvaW5zVG9DaGFyYWN0ZXJdIEF3YXJkaW5nICR7YW1vdW50fSBKJCB0byBjaGFyYWN0ZXIgJHtjaGFyYWN0ZXJJZH0gZnJvbSAke3NvdXJjZVR5cGV9ICR7c291cmNlSWR9YCk7XHJcbiAgICBcclxuICAgIGlmIChhbW91bnQgPD0gMCkge1xyXG4gICAgICBjb25zb2xlLmxvZyhgW2F3YXJkSnVuZ2xlQ29pbnNUb0NoYXJhY3Rlcl0gTm8ganVuZ2xlIGNvaW5zIHRvIGF3YXJkLCBza2lwcGluZ2ApO1xyXG4gICAgICByZXR1cm47XHJcbiAgICB9XHJcblxyXG4gICAgLy8gR2V0IHRoZSBjaGFyYWN0ZXJcclxuICAgIGNvbnN0IGNoYXJhY3RlcnMgPSBhd2FpdCBDbGllbnRBUEkuZ2V0Q2hhcmFjdGVycygpO1xyXG4gICAgY29uc3QgY2hhcmFjdGVyID0gY2hhcmFjdGVycy5maW5kKGMgPT4gYy5pZCA9PT0gY2hhcmFjdGVySWQpO1xyXG4gICAgaWYgKCFjaGFyYWN0ZXIpIHtcclxuICAgICAgY29uc29sZS5sb2coYFthd2FyZEp1bmdsZUNvaW5zVG9DaGFyYWN0ZXJdIENoYXJhY3RlciAke2NoYXJhY3RlcklkfSBub3QgZm91bmQsIHNraXBwaW5nYCk7XHJcbiAgICAgIHJldHVybjtcclxuICAgIH1cclxuXHJcbiAgICAvLyBVcGRhdGUgY2hhcmFjdGVyIGp1bmdsZSBjb2luc1xyXG4gICAgY29uc3QgdXBkYXRlZENoYXJhY3RlcjogQ2hhcmFjdGVyID0ge1xyXG4gICAgICAuLi5jaGFyYWN0ZXIsXHJcbiAgICAgIGp1bmdsZUNvaW5zOiAoY2hhcmFjdGVyLmp1bmdsZUNvaW5zIHx8IDApICsgYW1vdW50LFxyXG4gICAgICB1cGRhdGVkQXQ6IG5ldyBEYXRlKClcclxuICAgIH07XHJcblxyXG4gICAgLy8gU2F2ZSB1cGRhdGVkIGNoYXJhY3RlclxyXG4gICAgYXdhaXQgQ2xpZW50QVBJLnVwc2VydENoYXJhY3Rlcih1cGRhdGVkQ2hhcmFjdGVyKTtcclxuICAgIGNvbnNvbGUubG9nKGBbYXdhcmRKdW5nbGVDb2luc1RvQ2hhcmFjdGVyXSDinIUgSnVuZ2xlIGNvaW5zIGF3YXJkZWQgc3VjY2Vzc2Z1bGx5OiAke2Ftb3VudH0gSiRgKTtcclxuXHJcbiAgICAvLyBOT1RFOiBKJCAoSnVuZ2xlIENvaW5zKSBhcmUgQ1VSUkVOQ1kgdGhhdCBiZWxvbmdzIHRvIEZJTkFOQ0lBTFNcclxuICAgIC8vIFRoZXkgY2FuIGJlIGJvcnJvd2VkIGFzIEFNQkFTU0FET1IgYnkgUGxheWVyIGFuZCBDaGFyYWN0ZXIsIGJ1dCBkb24ndCBiZWxvbmcgdG8gdGhlbVxyXG4gICAgLy8gTm8gbGluayBjcmVhdGlvbiBuZWVkZWQgaGVyZSAtIEokIGFyZSBoYW5kbGVkIGJ5IHRoZSBGaW5hbmNpYWwgc3lzdGVtXHJcbiAgICBjb25zb2xlLmxvZyhgW2F3YXJkSnVuZ2xlQ29pbnNUb0NoYXJhY3Rlcl0g4pyFIEp1bmdsZSBjb2lucyBhd2FyZGVkIHRvIGNoYXJhY3RlciAoSiQgaGFuZGxlZCBieSBGaW5hbmNpYWwgc3lzdGVtKWApO1xyXG5cclxuICB9IGNhdGNoIChlcnJvcikge1xyXG4gICAgY29uc29sZS5lcnJvcihgW2F3YXJkSnVuZ2xlQ29pbnNUb0NoYXJhY3Rlcl0g4p2MIEZhaWxlZCB0byBhd2FyZCBqdW5nbGUgY29pbnM6YCwgZXJyb3IpO1xyXG4gICAgdGhyb3cgZXJyb3I7XHJcbiAgfVxyXG59XHJcblxyXG4vKipcclxuICogUmVtb3ZlcyBqdW5nbGUgY29pbnMgZnJvbSBhIGNoYXJhY3RlciAocm9sbGJhY2sgZnVuY3Rpb24pXHJcbiAqIEBwYXJhbSBjaGFyYWN0ZXJJZCAtIElEIG9mIHRoZSBjaGFyYWN0ZXIgdG8gcmVtb3ZlIGp1bmdsZSBjb2lucyBmcm9tXHJcbiAqIEBwYXJhbSBhbW91bnQgLSBBbW91bnQgb2YganVuZ2xlIGNvaW5zIHRvIHJlbW92ZVxyXG4gKi9cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIHJlbW92ZUp1bmdsZUNvaW5zRnJvbUNoYXJhY3RlcihcclxuICBjaGFyYWN0ZXJJZDogc3RyaW5nLCBcclxuICBhbW91bnQ6IG51bWJlclxyXG4pOiBQcm9taXNlPHZvaWQ+IHtcclxuICB0cnkge1xyXG4gICAgY29uc29sZS5sb2coYFtyZW1vdmVKdW5nbGVDb2luc0Zyb21DaGFyYWN0ZXJdIFJlbW92aW5nICR7YW1vdW50fSBKJCBmcm9tIGNoYXJhY3RlciAke2NoYXJhY3RlcklkfWApO1xyXG4gICAgXHJcbiAgICBpZiAoYW1vdW50IDw9IDApIHtcclxuICAgICAgY29uc29sZS5sb2coYFtyZW1vdmVKdW5nbGVDb2luc0Zyb21DaGFyYWN0ZXJdIE5vIGp1bmdsZSBjb2lucyB0byByZW1vdmUsIHNraXBwaW5nYCk7XHJcbiAgICAgIHJldHVybjtcclxuICAgIH1cclxuXHJcbiAgICAvLyBHZXQgdGhlIGNoYXJhY3RlclxyXG4gICAgY29uc3QgY2hhcmFjdGVycyA9IGF3YWl0IENsaWVudEFQSS5nZXRDaGFyYWN0ZXJzKCk7XHJcbiAgICBjb25zdCBjaGFyYWN0ZXIgPSBjaGFyYWN0ZXJzLmZpbmQoYyA9PiBjLmlkID09PSBjaGFyYWN0ZXJJZCk7XHJcbiAgICBpZiAoIWNoYXJhY3Rlcikge1xyXG4gICAgICBjb25zb2xlLmxvZyhgW3JlbW92ZUp1bmdsZUNvaW5zRnJvbUNoYXJhY3Rlcl0gQ2hhcmFjdGVyICR7Y2hhcmFjdGVySWR9IG5vdCBmb3VuZCwgc2tpcHBpbmdgKTtcclxuICAgICAgcmV0dXJuO1xyXG4gICAgfVxyXG5cclxuICAgIC8vIFVwZGF0ZSBjaGFyYWN0ZXIganVuZ2xlIGNvaW5zIChlbnN1cmUgdGhleSBkb24ndCBnbyBuZWdhdGl2ZSlcclxuICAgIGNvbnN0IHVwZGF0ZWRDaGFyYWN0ZXI6IENoYXJhY3RlciA9IHtcclxuICAgICAgLi4uY2hhcmFjdGVyLFxyXG4gICAgICBqdW5nbGVDb2luczogTWF0aC5tYXgoMCwgKGNoYXJhY3Rlci5qdW5nbGVDb2lucyB8fCAwKSAtIGFtb3VudCksXHJcbiAgICAgIHVwZGF0ZWRBdDogbmV3IERhdGUoKVxyXG4gICAgfTtcclxuXHJcbiAgICAvLyBTYXZlIHVwZGF0ZWQgY2hhcmFjdGVyXHJcbiAgICBhd2FpdCBDbGllbnRBUEkudXBzZXJ0Q2hhcmFjdGVyKHVwZGF0ZWRDaGFyYWN0ZXIpO1xyXG4gICAgY29uc29sZS5sb2coYFtyZW1vdmVKdW5nbGVDb2luc0Zyb21DaGFyYWN0ZXJdIOKchSBKdW5nbGUgY29pbnMgcmVtb3ZlZCBzdWNjZXNzZnVsbHk6ICR7YW1vdW50fSBKJGApO1xyXG5cclxuICB9IGNhdGNoIChlcnJvcikge1xyXG4gICAgY29uc29sZS5lcnJvcihgW3JlbW92ZUp1bmdsZUNvaW5zRnJvbUNoYXJhY3Rlcl0g4p2MIEZhaWxlZCB0byByZW1vdmUganVuZ2xlIGNvaW5zOmAsIGVycm9yKTtcclxuICAgIHRocm93IGVycm9yO1xyXG4gIH1cclxufVxyXG5cclxuLyoqXHJcbiAqIENhbGN1bGF0ZXMgcG9pbnRzIGZyb20gc2FsZSByZXZlbnVlICgxIFBvaW50ID0gJDEwMClcclxuICogQHBhcmFtIHJldmVudWUgLSBSZXZlbnVlIGFtb3VudCBpbiBkb2xsYXJzXHJcbiAqIEByZXR1cm5zIFBvaW50cyB0byBhd2FyZCAoZGlzdHJpYnV0ZWQgYWNyb3NzIGFsbCB0eXBlcylcclxuICovXHJcbmV4cG9ydCBmdW5jdGlvbiBjYWxjdWxhdGVQb2ludHNGcm9tUmV2ZW51ZShyZXZlbnVlOiBudW1iZXIpOiBSZXdhcmRzWydwb2ludHMnXSB7XHJcbiAgY29uc3QgcG9pbnRzQXdhcmRlZCA9IE1hdGguZmxvb3IocmV2ZW51ZSAvIDEwMCk7XHJcbiAgXHJcbiAgaWYgKHBvaW50c0F3YXJkZWQgPD0gMCkge1xyXG4gICAgcmV0dXJuIHsgeHA6IDAsIHJwOiAwLCBmcDogMCwgaHA6IDAgfTtcclxuICB9XHJcblxyXG4gIC8vIERpc3RyaWJ1dGUgcG9pbnRzIGFjcm9zcyBhbGwgdHlwZXMgZXF1YWxseVxyXG4gIGNvbnN0IHBvaW50c1BlclR5cGUgPSBNYXRoLmZsb29yKHBvaW50c0F3YXJkZWQgLyA0KTtcclxuICBjb25zdCByZW1haW5kZXIgPSBwb2ludHNBd2FyZGVkICUgNDtcclxuICBcclxuICByZXR1cm4ge1xyXG4gICAgeHA6IHBvaW50c1BlclR5cGUgKyAocmVtYWluZGVyID4gMCA/IDEgOiAwKSxcclxuICAgIHJwOiBwb2ludHNQZXJUeXBlICsgKHJlbWFpbmRlciA+IDEgPyAxIDogMCksXHJcbiAgICBmcDogcG9pbnRzUGVyVHlwZSArIChyZW1haW5kZXIgPiAyID8gMSA6IDApLFxyXG4gICAgaHA6IHBvaW50c1BlclR5cGVcclxuICB9O1xyXG59XHJcblxyXG4vKipcclxuICogR2V0cyB0aGUgbWFpbiBwbGF5ZXIgSUQgKFYwLjEgY29uc3RhbnQpXHJcbiAqIFRPRE86IFYwLjIgLSBVc2UgY2hhcmFjdGVyLnBsYXllcklkIGZpZWxkXHJcbiAqL1xyXG5leHBvcnQgZnVuY3Rpb24gZ2V0TWFpblBsYXllcklkKCk6IHN0cmluZyB7XHJcbiAgcmV0dXJuICdQTEFZRVJfT05FX0lEJzsgLy8gVjAuMSBjb25zdGFudFxyXG59XHJcblxyXG4vKipcclxuICogR2V0cyB0aGUgbWFpbiBjaGFyYWN0ZXIgSUQgKFYwLjEgY29uc3RhbnQpXHJcbiAqIFRPRE86IFYwLjIgLSBVc2UgcHJvcGVyIGNoYXJhY3RlciBzZWxlY3Rpb25cclxuICovXHJcbmV4cG9ydCBmdW5jdGlvbiBnZXRNYWluQ2hhcmFjdGVySWQoKTogc3RyaW5nIHtcclxuICByZXR1cm4gJ0NIQVJBQ1RFUl9PTkVfSUQnOyAvLyBWMC4xIGNvbnN0YW50XHJcbn1cclxuIl0sIm5hbWVzIjpbIkNsaWVudEFQSSIsIm1ha2VMaW5rIiwiY3JlYXRlTGluayIsIkxpbmtUeXBlIiwiRW50aXR5VHlwZSIsImF3YXJkUG9pbnRzVG9QbGF5ZXIiLCJwbGF5ZXJJZCIsInBvaW50cyIsInNvdXJjZUlkIiwic291cmNlVHlwZSIsInBsYXllciIsImNvbnNvbGUiLCJsb2ciLCJwbGF5ZXJzIiwiZ2V0UGxheWVycyIsImZpbmQiLCJwIiwiaWQiLCJoYXNQb2ludHMiLCJ4cCIsInJwIiwiZnAiLCJocCIsInVwZGF0ZWRQbGF5ZXIiLCJ0b3RhbFBvaW50cyIsInVwZGF0ZWRBdCIsIkRhdGUiLCJ1cHNlcnRQbGF5ZXIiLCJsaW5rVHlwZSIsInNvdXJjZUVudGl0eVR5cGUiLCJUQVNLX1BMQVlFUiIsIlRBU0siLCJGSU5SRUNfUExBWUVSIiwiRklOQU5DSUFMIiwiU0FMRV9QTEFZRVIiLCJTQUxFIiwid2FybiIsImxpbmsiLCJ0eXBlIiwiUExBWUVSIiwiYXdhcmRlZEF0IiwidG9JU09TdHJpbmciLCJlcnJvciIsInJlbW92ZVBvaW50c0Zyb21QbGF5ZXIiLCJNYXRoIiwibWF4IiwiYXdhcmRKdW5nbGVDb2luc1RvQ2hhcmFjdGVyIiwiY2hhcmFjdGVySWQiLCJhbW91bnQiLCJjaGFyYWN0ZXJzIiwiZ2V0Q2hhcmFjdGVycyIsImNoYXJhY3RlciIsImMiLCJ1cGRhdGVkQ2hhcmFjdGVyIiwianVuZ2xlQ29pbnMiLCJ1cHNlcnRDaGFyYWN0ZXIiLCJyZW1vdmVKdW5nbGVDb2luc0Zyb21DaGFyYWN0ZXIiLCJjYWxjdWxhdGVQb2ludHNGcm9tUmV2ZW51ZSIsInJldmVudWUiLCJwb2ludHNBd2FyZGVkIiwiZmxvb3IiLCJwb2ludHNQZXJUeXBlIiwicmVtYWluZGVyIiwiZ2V0TWFpblBsYXllcklkIiwiZ2V0TWFpbkNoYXJhY3RlcklkIl0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(app-pages-browser)/./workflows/points-rewards-utils.ts\n"));

/***/ }),

/***/ "(app-pages-browser)/./workflows/sale-line-utils.ts":
/*!**************************************!*\
  !*** ./workflows/sale-line-utils.ts ***!
  \**************************************/
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval(__webpack_require__.ts("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   processBundleSaleLine: function() { return /* binding */ processBundleSaleLine; },\n/* harmony export */   processItemSaleLine: function() { return /* binding */ processItemSaleLine; },\n/* harmony export */   processSaleLines: function() { return /* binding */ processSaleLines; },\n/* harmony export */   processServiceLine: function() { return /* binding */ processServiceLine; }\n/* harmony export */ });\n/* harmony import */ var _types_enums__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @/types/enums */ \"(app-pages-browser)/./types/enums.ts\");\n/* harmony import */ var _lib_client_api__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @/lib/client-api */ \"(app-pages-browser)/./lib/client-api.ts\");\n/* harmony import */ var _links_links_workflows__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @/links/links-workflows */ \"(app-pages-browser)/./links/links-workflows.ts\");\n/* harmony import */ var _links_link_registry__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! @/links/link-registry */ \"(app-pages-browser)/./links/link-registry.ts\");\n/* harmony import */ var _data_store_effects_registry__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! @/data-store/effects-registry */ \"(app-pages-browser)/./data-store/effects-registry.ts\");\n/* harmony import */ var _entities_logging__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ./entities-logging */ \"(app-pages-browser)/./workflows/entities-logging.ts\");\n/* harmony import */ var _financial_record_utils__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ./financial-record-utils */ \"(app-pages-browser)/./workflows/financial-record-utils.ts\");\n// workflows/sale-line-utils.ts\n// Sale line processing utilities\n\n\n\n\n\n\n\n/**\r\n * Process all sale lines in a sale\r\n * Main dispatcher that processes each line based on its kind\r\n */ async function processSaleLines(sale) {\n    try {\n        console.log(\"[processSaleLines] Processing \".concat(sale.lines.length, \" lines for sale: \").concat(sale.counterpartyName));\n        // Process each line based on its kind\n        for (const line of sale.lines){\n            console.log(\"[processSaleLines] Processing line: \".concat(line.kind, \", lineId: \").concat(line.lineId));\n            switch(line.kind){\n                case \"item\":\n                    await processItemSaleLine(line, sale);\n                    break;\n                case \"bundle\":\n                    await processBundleSaleLine(line, sale);\n                    break;\n                case \"service\":\n                    await processServiceLine(line, sale);\n                    break;\n                default:\n                    console.warn(\"[processSaleLines] Unknown line kind: \".concat(line.kind));\n            }\n        }\n        // Create financial record from sale if it has revenue\n        if (sale.totals.totalRevenue > 0) {\n            await (0,_financial_record_utils__WEBPACK_IMPORTED_MODULE_6__.createFinancialRecordFromSale)(sale);\n        }\n        console.log(\"[processSaleLines]  Processed all lines for sale: \".concat(sale.counterpartyName));\n    } catch (error) {\n        console.error(\"[processSaleLines]  Failed to process sale lines for sale \".concat(sale.id, \":\"), error);\n        throw error;\n    }\n}\n/**\r\n * Process item sale line - reduce item stock at specific site\r\n */ async function processItemSaleLine(line, sale) {\n    try {\n        console.log(\"[processItemSaleLine] Processing item sale: \".concat(line.itemId, \", quantity: \").concat(line.quantity));\n        // Idempotency check\n        const stockDecrementedKey = \"sale:\".concat(sale.id, \":stockDecremented:\").concat(line.lineId);\n        const hasBeenDecremented = await (0,_data_store_effects_registry__WEBPACK_IMPORTED_MODULE_4__.hasEffect)(stockDecrementedKey);\n        if (hasBeenDecremented) {\n            console.log(\"[processItemSaleLine] Stock already decremented for line \".concat(line.lineId, \", skipping\"));\n            return;\n        }\n        // Get the item\n        const items = await _lib_client_api__WEBPACK_IMPORTED_MODULE_1__.ClientAPI.getItems();\n        const item = items.find((i)=>i.id === line.itemId);\n        if (!item) {\n            console.error(\"[processItemSaleLine] Item not found: \".concat(line.itemId));\n            return;\n        }\n        // Check if we have enough stock at the sale site\n        // Calculate total available quantity from stock array\n        const totalAvailableQuantity = item.stock.reduce((sum, stockPoint)=>sum + stockPoint.quantity, 0);\n        if (item.quantitySold + line.quantity > totalAvailableQuantity) {\n            console.error(\"[processItemSaleLine] Insufficient stock for item \".concat(item.name, \". Available: \").concat(totalAvailableQuantity - item.quantitySold, \", Required: \").concat(line.quantity));\n            return;\n        }\n        // Update item stock\n        const updatedItem = {\n            ...item,\n            quantitySold: item.quantitySold + line.quantity,\n            updatedAt: new Date()\n        };\n        // Mark item as SOLD if all stock is sold\n        if (updatedItem.quantitySold >= totalAvailableQuantity) {\n            updatedItem.status = \"SOLD\";\n        }\n        // Save the updated item\n        await _lib_client_api__WEBPACK_IMPORTED_MODULE_1__.ClientAPI.upsertItem(updatedItem);\n        // Create SALE_ITEM link\n        const linkMetadata = {\n            quantity: line.quantity,\n            unitPrice: line.unitPrice,\n            total: line.quantity * line.unitPrice,\n            soldAt: sale.saleDate.toISOString(),\n            siteId: sale.siteId\n        };\n        const link = (0,_links_links_workflows__WEBPACK_IMPORTED_MODULE_2__.makeLink)(_types_enums__WEBPACK_IMPORTED_MODULE_0__.LinkType.SALE_ITEM, {\n            type: _types_enums__WEBPACK_IMPORTED_MODULE_0__.EntityType.SALE,\n            id: sale.id\n        }, {\n            type: _types_enums__WEBPACK_IMPORTED_MODULE_0__.EntityType.ITEM,\n            id: line.itemId\n        }, linkMetadata);\n        await (0,_links_link_registry__WEBPACK_IMPORTED_MODULE_3__.createLink)(link);\n        // Mark effect as complete\n        await (0,_data_store_effects_registry__WEBPACK_IMPORTED_MODULE_4__.markEffect)(\"sale:\".concat(sale.id, \":\").concat(stockDecrementedKey));\n        // Log the effect\n        await (0,_entities_logging__WEBPACK_IMPORTED_MODULE_5__.appendEntityLog)(\"item\", line.itemId, \"SOLD\", {\n            name: item.name,\n            quantity: line.quantity,\n            unitPrice: line.unitPrice,\n            total: line.quantity * line.unitPrice,\n            saleId: sale.id,\n            soldAt: sale.saleDate.toISOString()\n        });\n        console.log(\"[processItemSaleLine]  Processed item sale: \".concat(item.name, \" x\").concat(line.quantity));\n    } catch (error) {\n        console.error(\"[processItemSaleLine]  Failed to process item sale line \".concat(line.lineId, \":\"), error);\n        throw error;\n    }\n}\n/**\r\n * Process bundle sale line - reduce bundle stock\r\n * TODO: Implement bundle processing logic\r\n */ async function processBundleSaleLine(line, sale) {\n    try {\n        console.log(\"[processBundleSaleLine] Processing bundle sale: \".concat(line.itemType, \", quantity: \").concat(line.quantity));\n        // Idempotency check\n        const bundleProcessedKey = \"sale:\".concat(sale.id, \":bundleProcessed:\").concat(line.lineId);\n        const hasBeenProcessed = await (0,_data_store_effects_registry__WEBPACK_IMPORTED_MODULE_4__.hasEffect)(bundleProcessedKey);\n        if (hasBeenProcessed) {\n            console.log(\"[processBundleSaleLine] Bundle already processed for line \".concat(line.lineId, \", skipping\"));\n            return;\n        }\n        // TODO: Implement bundle processing logic\n        // This would involve:\n        // 1. Finding bundle items of the specified type\n        // 2. Reducing their stock\n        // 3. Creating SALE_ITEM links\n        // 4. Handling itemsPerBundle logic\n        console.log(\"[processBundleSaleLine] Bundle processing not yet implemented for \".concat(line.itemType));\n        // Mark effect as complete (even though not implemented)\n        await (0,_data_store_effects_registry__WEBPACK_IMPORTED_MODULE_4__.markEffect)(\"sale:\".concat(sale.id, \":\").concat(bundleProcessedKey));\n    } catch (error) {\n        console.error(\"[processBundleSaleLine]  Failed to process bundle sale line \".concat(line.lineId, \":\"), error);\n        throw error;\n    }\n}\n/**\r\n * Process service sale line - create task from service\r\n */ async function processServiceLine(line, sale) {\n    try {\n        console.log(\"[processServiceLine] Processing service sale: \".concat(line.description));\n        // Idempotency check\n        const taskCreatedKey = \"sale:\".concat(sale.id, \":taskCreated:\").concat(line.lineId);\n        const hasBeenCreated = await (0,_data_store_effects_registry__WEBPACK_IMPORTED_MODULE_4__.hasEffect)(taskCreatedKey);\n        if (hasBeenCreated || !line.createTask) {\n            console.log(\"[processServiceLine] Task already created or not requested for line \".concat(line.lineId, \", skipping\"));\n            return;\n        }\n        // Create task from service line\n        const serviceTask = {\n            id: line.taskId || \"task-\".concat(sale.id, \"-\").concat(line.lineId),\n            name: line.description || \"Service Task\",\n            description: \"Service from sale: \".concat(sale.counterpartyName),\n            type: line.taskType || \"TASK\",\n            status: \"Created\",\n            priority: \"Normal\",\n            station: line.station,\n            progress: 0,\n            order: Date.now(),\n            cost: line.taskCost || 0,\n            revenue: 0,\n            rewards: line.taskRewards ? {\n                points: line.taskRewards\n            } : {\n                points: {\n                    xp: 0,\n                    rp: 0,\n                    fp: 0,\n                    hp: 0\n                }\n            },\n            isCollected: false,\n            createdAt: new Date(),\n            updatedAt: new Date(),\n            links: [],\n            // Ambassador Fields - inherit from sale\n            siteId: sale.siteId,\n            targetSiteId: line.taskTargetSiteId || undefined,\n            sourceSaleId: sale.id,\n            // Additional fields from service line\n            parentId: line.taskParentId || undefined,\n            dueDate: line.taskDueDate || undefined,\n            // Emissary fields for item creation\n            outputItemType: line.outputItemType || undefined,\n            outputItemSubType: line.outputItemSubType || undefined,\n            outputQuantity: line.outputItemQuantity || undefined,\n            outputItemName: line.outputItemName || undefined,\n            outputUnitCost: line.outputUnitCost || undefined,\n            outputItemCollection: line.outputItemCollection || undefined,\n            outputItemPrice: line.outputItemPrice || undefined,\n            isNewItem: line.isNewOutputItem || false,\n            isSold: line.isSold || false,\n            outputItemStatus: \"Created\"\n        };\n        // Save the task\n        await _lib_client_api__WEBPACK_IMPORTED_MODULE_1__.ClientAPI.upsertTask(serviceTask);\n        // Create SALE_TASK link\n        const linkMetadata = {\n            serviceDescription: line.description,\n            revenue: line.revenue,\n            station: line.station,\n            taskType: line.taskType,\n            createdFrom: \"service_sale\"\n        };\n        const link = (0,_links_links_workflows__WEBPACK_IMPORTED_MODULE_2__.makeLink)(_types_enums__WEBPACK_IMPORTED_MODULE_0__.LinkType.SALE_TASK, {\n            type: _types_enums__WEBPACK_IMPORTED_MODULE_0__.EntityType.SALE,\n            id: sale.id\n        }, {\n            type: _types_enums__WEBPACK_IMPORTED_MODULE_0__.EntityType.TASK,\n            id: serviceTask.id\n        }, linkMetadata);\n        await (0,_links_link_registry__WEBPACK_IMPORTED_MODULE_3__.createLink)(link);\n        // Mark effect as complete\n        await (0,_data_store_effects_registry__WEBPACK_IMPORTED_MODULE_4__.markEffect)(\"sale:\".concat(sale.id, \":\").concat(taskCreatedKey));\n        // Log the task creation\n        await (0,_entities_logging__WEBPACK_IMPORTED_MODULE_5__.appendEntityLog)(\"task\", serviceTask.id, \"CREATED\", {\n            name: serviceTask.name,\n            createdFrom: \"service_sale\",\n            saleId: sale.id,\n            serviceDescription: line.description,\n            station: line.station\n        });\n        console.log(\"[processServiceLine]  Created task from service: \".concat(serviceTask.name));\n    } catch (error) {\n        console.error(\"[processServiceLine]  Failed to process service sale line \".concat(line.lineId, \":\"), error);\n        throw error;\n    }\n}\n\n\n;\n    // Wrapped in an IIFE to avoid polluting the global scope\n    ;\n    (function () {\n        var _a, _b;\n        // Legacy CSS implementations will `eval` browser code in a Node.js context\n        // to extract CSS. For backwards compatibility, we need to check we're in a\n        // browser context before continuing.\n        if (typeof self !== 'undefined' &&\n            // AMP / No-JS mode does not inject these helpers:\n            '$RefreshHelpers$' in self) {\n            // @ts-ignore __webpack_module__ is global\n            var currentExports = module.exports;\n            // @ts-ignore __webpack_module__ is global\n            var prevSignature = (_b = (_a = module.hot.data) === null || _a === void 0 ? void 0 : _a.prevSignature) !== null && _b !== void 0 ? _b : null;\n            // This cannot happen in MainTemplate because the exports mismatch between\n            // templating and execution.\n            self.$RefreshHelpers$.registerExportsForReactRefresh(currentExports, module.id);\n            // A module can be accepted automatically based on its exports, e.g. when\n            // it is a Refresh Boundary.\n            if (self.$RefreshHelpers$.isReactRefreshBoundary(currentExports)) {\n                // Save the previous exports signature on update so we can compare the boundary\n                // signatures. We avoid saving exports themselves since it causes memory leaks (https://github.com/vercel/next.js/pull/53797)\n                module.hot.dispose(function (data) {\n                    data.prevSignature =\n                        self.$RefreshHelpers$.getRefreshBoundarySignature(currentExports);\n                });\n                // Unconditionally accept an update to this module, we'll check if it's\n                // still a Refresh Boundary later.\n                // @ts-ignore importMeta is replaced in the loader\n                module.hot.accept();\n                // This field is set when the previous version of this module was a\n                // Refresh Boundary, letting us know we need to check for invalidation or\n                // enqueue an update.\n                if (prevSignature !== null) {\n                    // A boundary can become ineligible if its exports are incompatible\n                    // with the previous exports.\n                    //\n                    // For example, if you add/remove/change exports, we'll want to\n                    // re-execute the importing modules, and force those components to\n                    // re-render. Similarly, if you convert a class component to a\n                    // function, we want to invalidate the boundary.\n                    if (self.$RefreshHelpers$.shouldInvalidateReactRefreshBoundary(prevSignature, self.$RefreshHelpers$.getRefreshBoundarySignature(currentExports))) {\n                        module.hot.invalidate();\n                    }\n                    else {\n                        self.$RefreshHelpers$.scheduleUpdate();\n                    }\n                }\n            }\n            else {\n                // Since we just executed the code for the module, it's possible that the\n                // new exports made it ineligible for being a boundary.\n                // We only care about the case when we were _previously_ a boundary,\n                // because we already accepted this update (accidental side effect).\n                var isNoLongerABoundary = prevSignature !== null;\n                if (isNoLongerABoundary) {\n                    module.hot.invalidate();\n                }\n            }\n        }\n    })();\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFwcC1wYWdlcy1icm93c2VyKS8uL3dvcmtmbG93cy9zYWxlLWxpbmUtdXRpbHMudHMiLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7Ozs7QUFBQSwrQkFBK0I7QUFDL0IsaUNBQWlDO0FBR29CO0FBQ1I7QUFDTTtBQUNBO0FBQ21CO0FBQ2pCO0FBQ29CO0FBRXpFOzs7Q0FHQyxHQUNNLGVBQWVTLGlCQUFpQkMsSUFBVTtJQUMvQyxJQUFJO1FBQ0ZDLFFBQVFDLEdBQUcsQ0FBQyxpQ0FBc0VGLE9BQXJDQSxLQUFLRyxLQUFLLENBQUNDLE1BQU0sRUFBQyxxQkFBeUMsT0FBdEJKLEtBQUtLLGdCQUFnQjtRQUV2RyxzQ0FBc0M7UUFDdEMsS0FBSyxNQUFNQyxRQUFRTixLQUFLRyxLQUFLLENBQUU7WUFDN0JGLFFBQVFDLEdBQUcsQ0FBQyx1Q0FBNkRJLE9BQXRCQSxLQUFLQyxJQUFJLEVBQUMsY0FBd0IsT0FBWkQsS0FBS0UsTUFBTTtZQUVwRixPQUFRRixLQUFLQyxJQUFJO2dCQUNmLEtBQUs7b0JBQ0gsTUFBTUUsb0JBQW9CSCxNQUFzQk47b0JBQ2hEO2dCQUNGLEtBQUs7b0JBQ0gsTUFBTVUsc0JBQXNCSixNQUF3Qk47b0JBQ3BEO2dCQUNGLEtBQUs7b0JBQ0gsTUFBTVcsbUJBQW1CTCxNQUFxQk47b0JBQzlDO2dCQUNGO29CQUNFQyxRQUFRVyxJQUFJLENBQUMseUNBQTRELE9BQW5CLEtBQWNMLElBQUk7WUFDNUU7UUFDRjtRQUVBLHNEQUFzRDtRQUN0RCxJQUFJUCxLQUFLYSxNQUFNLENBQUNDLFlBQVksR0FBRyxHQUFHO1lBQ2hDLE1BQU1oQixzRkFBNkJBLENBQUNFO1FBQ3RDO1FBRUFDLFFBQVFDLEdBQUcsQ0FBQyxzREFBNEUsT0FBdEJGLEtBQUtLLGdCQUFnQjtJQUV6RixFQUFFLE9BQU9VLE9BQU87UUFDZGQsUUFBUWMsS0FBSyxDQUFDLDhEQUFzRSxPQUFSZixLQUFLZ0IsRUFBRSxFQUFDLE1BQUlEO1FBQ3hGLE1BQU1BO0lBQ1I7QUFDRjtBQUVBOztD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Z0VBQVVBLENBQUNtRDtRQUVqQiwwQkFBMEI7UUFDMUIsTUFBTWpELHdFQUFVQSxDQUFDLFFBQW1CMkQsT0FBWHZELEtBQUtnQixFQUFFLEVBQUMsS0FBa0IsT0FBZnVDO1FBRXBDLHdCQUF3QjtRQUN4QixNQUFNMUQsa0VBQWVBLENBQUMsUUFBUTZELFlBQVkxQyxFQUFFLEVBQUUsV0FBVztZQUN2RGdCLE1BQU0wQixZQUFZMUIsSUFBSTtZQUN0QnFFLGFBQWE7WUFDYm5ELFFBQVFsRCxLQUFLZ0IsRUFBRTtZQUNmb0Ysb0JBQW9COUYsS0FBS2dELFdBQVc7WUFDcENRLFNBQVN4RCxLQUFLd0QsT0FBTztRQUN2QjtRQUVBN0QsUUFBUUMsR0FBRyxDQUFDLHFEQUFzRSxPQUFqQndELFlBQVkxQixJQUFJO0lBRW5GLEVBQUUsT0FBT2pCLE9BQU87UUFDZGQsUUFBUWMsS0FBSyxDQUFDLDhEQUEwRSxPQUFaVCxLQUFLRSxNQUFNLEVBQUMsTUFBSU87UUFDNUYsTUFBTUE7SUFDUjtBQUNGIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vX05fRS8uL3dvcmtmbG93cy9zYWxlLWxpbmUtdXRpbHMudHM/YzUwYiJdLCJzb3VyY2VzQ29udGVudCI6WyIvLyB3b3JrZmxvd3Mvc2FsZS1saW5lLXV0aWxzLnRzXHJcbi8vIFNhbGUgbGluZSBwcm9jZXNzaW5nIHV0aWxpdGllc1xyXG5cclxuaW1wb3J0IHR5cGUgeyBTYWxlLCBJdGVtU2FsZUxpbmUsIEJ1bmRsZVNhbGVMaW5lLCBTZXJ2aWNlTGluZSwgVGFzayB9IGZyb20gJ0AvdHlwZXMvZW50aXRpZXMnO1xyXG5pbXBvcnQgeyBMaW5rVHlwZSwgRW50aXR5VHlwZSB9IGZyb20gJ0AvdHlwZXMvZW51bXMnO1xyXG5pbXBvcnQgeyBDbGllbnRBUEkgfSBmcm9tICdAL2xpYi9jbGllbnQtYXBpJztcclxuaW1wb3J0IHsgbWFrZUxpbmsgfSBmcm9tICdAL2xpbmtzL2xpbmtzLXdvcmtmbG93cyc7XHJcbmltcG9ydCB7IGNyZWF0ZUxpbmsgfSBmcm9tICdAL2xpbmtzL2xpbmstcmVnaXN0cnknO1xyXG5pbXBvcnQgeyBoYXNFZmZlY3QsIG1hcmtFZmZlY3QgfSBmcm9tICdAL2RhdGEtc3RvcmUvZWZmZWN0cy1yZWdpc3RyeSc7XHJcbmltcG9ydCB7IGFwcGVuZEVudGl0eUxvZyB9IGZyb20gJy4vZW50aXRpZXMtbG9nZ2luZyc7XHJcbmltcG9ydCB7IGNyZWF0ZUZpbmFuY2lhbFJlY29yZEZyb21TYWxlIH0gZnJvbSAnLi9maW5hbmNpYWwtcmVjb3JkLXV0aWxzJztcclxuXHJcbi8qKlxyXG4gKiBQcm9jZXNzIGFsbCBzYWxlIGxpbmVzIGluIGEgc2FsZVxyXG4gKiBNYWluIGRpc3BhdGNoZXIgdGhhdCBwcm9jZXNzZXMgZWFjaCBsaW5lIGJhc2VkIG9uIGl0cyBraW5kXHJcbiAqL1xyXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gcHJvY2Vzc1NhbGVMaW5lcyhzYWxlOiBTYWxlKTogUHJvbWlzZTx2b2lkPiB7XHJcbiAgdHJ5IHtcclxuICAgIGNvbnNvbGUubG9nKGBbcHJvY2Vzc1NhbGVMaW5lc10gUHJvY2Vzc2luZyAke3NhbGUubGluZXMubGVuZ3RofSBsaW5lcyBmb3Igc2FsZTogJHtzYWxlLmNvdW50ZXJwYXJ0eU5hbWV9YCk7XHJcbiAgICBcclxuICAgIC8vIFByb2Nlc3MgZWFjaCBsaW5lIGJhc2VkIG9uIGl0cyBraW5kXHJcbiAgICBmb3IgKGNvbnN0IGxpbmUgb2Ygc2FsZS5saW5lcykge1xyXG4gICAgICBjb25zb2xlLmxvZyhgW3Byb2Nlc3NTYWxlTGluZXNdIFByb2Nlc3NpbmcgbGluZTogJHtsaW5lLmtpbmR9LCBsaW5lSWQ6ICR7bGluZS5saW5lSWR9YCk7XHJcbiAgICAgIFxyXG4gICAgICBzd2l0Y2ggKGxpbmUua2luZCkge1xyXG4gICAgICAgIGNhc2UgJ2l0ZW0nOlxyXG4gICAgICAgICAgYXdhaXQgcHJvY2Vzc0l0ZW1TYWxlTGluZShsaW5lIGFzIEl0ZW1TYWxlTGluZSwgc2FsZSk7XHJcbiAgICAgICAgICBicmVhaztcclxuICAgICAgICBjYXNlICdidW5kbGUnOlxyXG4gICAgICAgICAgYXdhaXQgcHJvY2Vzc0J1bmRsZVNhbGVMaW5lKGxpbmUgYXMgQnVuZGxlU2FsZUxpbmUsIHNhbGUpO1xyXG4gICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgY2FzZSAnc2VydmljZSc6XHJcbiAgICAgICAgICBhd2FpdCBwcm9jZXNzU2VydmljZUxpbmUobGluZSBhcyBTZXJ2aWNlTGluZSwgc2FsZSk7XHJcbiAgICAgICAgICBicmVhaztcclxuICAgICAgICBkZWZhdWx0OlxyXG4gICAgICAgICAgY29uc29sZS53YXJuKGBbcHJvY2Vzc1NhbGVMaW5lc10gVW5rbm93biBsaW5lIGtpbmQ6ICR7KGxpbmUgYXMgYW55KS5raW5kfWApO1xyXG4gICAgICB9XHJcbiAgICB9XHJcbiAgICBcclxuICAgIC8vIENyZWF0ZSBmaW5hbmNpYWwgcmVjb3JkIGZyb20gc2FsZSBpZiBpdCBoYXMgcmV2ZW51ZVxyXG4gICAgaWYgKHNhbGUudG90YWxzLnRvdGFsUmV2ZW51ZSA+IDApIHtcclxuICAgICAgYXdhaXQgY3JlYXRlRmluYW5jaWFsUmVjb3JkRnJvbVNhbGUoc2FsZSk7XHJcbiAgICB9XHJcbiAgICBcclxuICAgIGNvbnNvbGUubG9nKGBbcHJvY2Vzc1NhbGVMaW5lc10g4pyFIFByb2Nlc3NlZCBhbGwgbGluZXMgZm9yIHNhbGU6ICR7c2FsZS5jb3VudGVycGFydHlOYW1lfWApO1xyXG4gICAgXHJcbiAgfSBjYXRjaCAoZXJyb3IpIHtcclxuICAgIGNvbnNvbGUuZXJyb3IoYFtwcm9jZXNzU2FsZUxpbmVzXSDinYwgRmFpbGVkIHRvIHByb2Nlc3Mgc2FsZSBsaW5lcyBmb3Igc2FsZSAke3NhbGUuaWR9OmAsIGVycm9yKTtcclxuICAgIHRocm93IGVycm9yO1xyXG4gIH1cclxufVxyXG5cclxuLyoqXHJcbiAqIFByb2Nlc3MgaXRlbSBzYWxlIGxpbmUgLSByZWR1Y2UgaXRlbSBzdG9jayBhdCBzcGVjaWZpYyBzaXRlXHJcbiAqL1xyXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gcHJvY2Vzc0l0ZW1TYWxlTGluZShsaW5lOiBJdGVtU2FsZUxpbmUsIHNhbGU6IFNhbGUpOiBQcm9taXNlPHZvaWQ+IHtcclxuICB0cnkge1xyXG4gICAgY29uc29sZS5sb2coYFtwcm9jZXNzSXRlbVNhbGVMaW5lXSBQcm9jZXNzaW5nIGl0ZW0gc2FsZTogJHtsaW5lLml0ZW1JZH0sIHF1YW50aXR5OiAke2xpbmUucXVhbnRpdHl9YCk7XHJcbiAgICBcclxuICAgIC8vIElkZW1wb3RlbmN5IGNoZWNrXHJcbiAgICBjb25zdCBzdG9ja0RlY3JlbWVudGVkS2V5ID0gYHNhbGU6JHtzYWxlLmlkfTpzdG9ja0RlY3JlbWVudGVkOiR7bGluZS5saW5lSWR9YDtcclxuICAgIGNvbnN0IGhhc0JlZW5EZWNyZW1lbnRlZCA9IGF3YWl0IGhhc0VmZmVjdChzdG9ja0RlY3JlbWVudGVkS2V5KTtcclxuICAgIFxyXG4gICAgaWYgKGhhc0JlZW5EZWNyZW1lbnRlZCkge1xyXG4gICAgICBjb25zb2xlLmxvZyhgW3Byb2Nlc3NJdGVtU2FsZUxpbmVdIFN0b2NrIGFscmVhZHkgZGVjcmVtZW50ZWQgZm9yIGxpbmUgJHtsaW5lLmxpbmVJZH0sIHNraXBwaW5nYCk7XHJcbiAgICAgIHJldHVybjtcclxuICAgIH1cclxuICAgIFxyXG4gICAgLy8gR2V0IHRoZSBpdGVtXHJcbiAgICBjb25zdCBpdGVtcyA9IGF3YWl0IENsaWVudEFQSS5nZXRJdGVtcygpO1xyXG4gICAgY29uc3QgaXRlbSA9IGl0ZW1zLmZpbmQoaSA9PiBpLmlkID09PSBsaW5lLml0ZW1JZCk7XHJcbiAgICBcclxuICAgIGlmICghaXRlbSkge1xyXG4gICAgICBjb25zb2xlLmVycm9yKGBbcHJvY2Vzc0l0ZW1TYWxlTGluZV0gSXRlbSBub3QgZm91bmQ6ICR7bGluZS5pdGVtSWR9YCk7XHJcbiAgICAgIHJldHVybjtcclxuICAgIH1cclxuICAgIFxyXG4gICAgLy8gQ2hlY2sgaWYgd2UgaGF2ZSBlbm91Z2ggc3RvY2sgYXQgdGhlIHNhbGUgc2l0ZVxyXG4gICAgLy8gQ2FsY3VsYXRlIHRvdGFsIGF2YWlsYWJsZSBxdWFudGl0eSBmcm9tIHN0b2NrIGFycmF5XHJcbiAgICBjb25zdCB0b3RhbEF2YWlsYWJsZVF1YW50aXR5ID0gaXRlbS5zdG9jay5yZWR1Y2UoKHN1bSwgc3RvY2tQb2ludCkgPT4gc3VtICsgc3RvY2tQb2ludC5xdWFudGl0eSwgMCk7XHJcbiAgICBpZiAoaXRlbS5xdWFudGl0eVNvbGQgKyBsaW5lLnF1YW50aXR5ID4gdG90YWxBdmFpbGFibGVRdWFudGl0eSkge1xyXG4gICAgICBjb25zb2xlLmVycm9yKGBbcHJvY2Vzc0l0ZW1TYWxlTGluZV0gSW5zdWZmaWNpZW50IHN0b2NrIGZvciBpdGVtICR7aXRlbS5uYW1lfS4gQXZhaWxhYmxlOiAke3RvdGFsQXZhaWxhYmxlUXVhbnRpdHkgLSBpdGVtLnF1YW50aXR5U29sZH0sIFJlcXVpcmVkOiAke2xpbmUucXVhbnRpdHl9YCk7XHJcbiAgICAgIHJldHVybjtcclxuICAgIH1cclxuICAgIFxyXG4gICAgLy8gVXBkYXRlIGl0ZW0gc3RvY2tcclxuICAgIGNvbnN0IHVwZGF0ZWRJdGVtID0ge1xyXG4gICAgICAuLi5pdGVtLFxyXG4gICAgICBxdWFudGl0eVNvbGQ6IGl0ZW0ucXVhbnRpdHlTb2xkICsgbGluZS5xdWFudGl0eSxcclxuICAgICAgdXBkYXRlZEF0OiBuZXcgRGF0ZSgpXHJcbiAgICB9O1xyXG4gICAgXHJcbiAgICAvLyBNYXJrIGl0ZW0gYXMgU09MRCBpZiBhbGwgc3RvY2sgaXMgc29sZFxyXG4gICAgaWYgKHVwZGF0ZWRJdGVtLnF1YW50aXR5U29sZCA+PSB0b3RhbEF2YWlsYWJsZVF1YW50aXR5KSB7XHJcbiAgICAgIHVwZGF0ZWRJdGVtLnN0YXR1cyA9ICdTT0xEJyBhcyBhbnk7XHJcbiAgICB9XHJcbiAgICBcclxuICAgIC8vIFNhdmUgdGhlIHVwZGF0ZWQgaXRlbVxyXG4gICAgYXdhaXQgQ2xpZW50QVBJLnVwc2VydEl0ZW0odXBkYXRlZEl0ZW0pO1xyXG4gICAgXHJcbiAgICAvLyBDcmVhdGUgU0FMRV9JVEVNIGxpbmtcclxuICAgIGNvbnN0IGxpbmtNZXRhZGF0YSA9IHtcclxuICAgICAgcXVhbnRpdHk6IGxpbmUucXVhbnRpdHksXHJcbiAgICAgIHVuaXRQcmljZTogbGluZS51bml0UHJpY2UsXHJcbiAgICAgIHRvdGFsOiBsaW5lLnF1YW50aXR5ICogbGluZS51bml0UHJpY2UsXHJcbiAgICAgIHNvbGRBdDogc2FsZS5zYWxlRGF0ZS50b0lTT1N0cmluZygpLFxyXG4gICAgICBzaXRlSWQ6IHNhbGUuc2l0ZUlkXHJcbiAgICB9O1xyXG4gICAgXHJcbiAgICBjb25zdCBsaW5rID0gbWFrZUxpbmsoXHJcbiAgICAgIExpbmtUeXBlLlNBTEVfSVRFTSxcclxuICAgICAgeyB0eXBlOiBFbnRpdHlUeXBlLlNBTEUsIGlkOiBzYWxlLmlkIH0sXHJcbiAgICAgIHsgdHlwZTogRW50aXR5VHlwZS5JVEVNLCBpZDogbGluZS5pdGVtSWQgfSxcclxuICAgICAgbGlua01ldGFkYXRhXHJcbiAgICApO1xyXG4gICAgYXdhaXQgY3JlYXRlTGluayhsaW5rKTtcclxuICAgIFxyXG4gICAgLy8gTWFyayBlZmZlY3QgYXMgY29tcGxldGVcclxuICAgIGF3YWl0IG1hcmtFZmZlY3QoYHNhbGU6JHtzYWxlLmlkfToke3N0b2NrRGVjcmVtZW50ZWRLZXl9YCk7XHJcbiAgICBcclxuICAgIC8vIExvZyB0aGUgZWZmZWN0XHJcbiAgICBhd2FpdCBhcHBlbmRFbnRpdHlMb2coJ2l0ZW0nLCBsaW5lLml0ZW1JZCwgJ1NPTEQnLCB7XHJcbiAgICAgIG5hbWU6IGl0ZW0ubmFtZSxcclxuICAgICAgcXVhbnRpdHk6IGxpbmUucXVhbnRpdHksXHJcbiAgICAgIHVuaXRQcmljZTogbGluZS51bml0UHJpY2UsXHJcbiAgICAgIHRvdGFsOiBsaW5lLnF1YW50aXR5ICogbGluZS51bml0UHJpY2UsXHJcbiAgICAgIHNhbGVJZDogc2FsZS5pZCxcclxuICAgICAgc29sZEF0OiBzYWxlLnNhbGVEYXRlLnRvSVNPU3RyaW5nKClcclxuICAgIH0pO1xyXG4gICAgXHJcbiAgICBjb25zb2xlLmxvZyhgW3Byb2Nlc3NJdGVtU2FsZUxpbmVdIOKchSBQcm9jZXNzZWQgaXRlbSBzYWxlOiAke2l0ZW0ubmFtZX0geCR7bGluZS5xdWFudGl0eX1gKTtcclxuICAgIFxyXG4gIH0gY2F0Y2ggKGVycm9yKSB7XHJcbiAgICBjb25zb2xlLmVycm9yKGBbcHJvY2Vzc0l0ZW1TYWxlTGluZV0g4p2MIEZhaWxlZCB0byBwcm9jZXNzIGl0ZW0gc2FsZSBsaW5lICR7bGluZS5saW5lSWR9OmAsIGVycm9yKTtcclxuICAgIHRocm93IGVycm9yO1xyXG4gIH1cclxufVxyXG5cclxuLyoqXHJcbiAqIFByb2Nlc3MgYnVuZGxlIHNhbGUgbGluZSAtIHJlZHVjZSBidW5kbGUgc3RvY2tcclxuICogVE9ETzogSW1wbGVtZW50IGJ1bmRsZSBwcm9jZXNzaW5nIGxvZ2ljXHJcbiAqL1xyXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gcHJvY2Vzc0J1bmRsZVNhbGVMaW5lKGxpbmU6IEJ1bmRsZVNhbGVMaW5lLCBzYWxlOiBTYWxlKTogUHJvbWlzZTx2b2lkPiB7XHJcbiAgdHJ5IHtcclxuICAgIGNvbnNvbGUubG9nKGBbcHJvY2Vzc0J1bmRsZVNhbGVMaW5lXSBQcm9jZXNzaW5nIGJ1bmRsZSBzYWxlOiAke2xpbmUuaXRlbVR5cGV9LCBxdWFudGl0eTogJHtsaW5lLnF1YW50aXR5fWApO1xyXG4gICAgXHJcbiAgICAvLyBJZGVtcG90ZW5jeSBjaGVja1xyXG4gICAgY29uc3QgYnVuZGxlUHJvY2Vzc2VkS2V5ID0gYHNhbGU6JHtzYWxlLmlkfTpidW5kbGVQcm9jZXNzZWQ6JHtsaW5lLmxpbmVJZH1gO1xyXG4gICAgY29uc3QgaGFzQmVlblByb2Nlc3NlZCA9IGF3YWl0IGhhc0VmZmVjdChidW5kbGVQcm9jZXNzZWRLZXkpO1xyXG4gICAgXHJcbiAgICBpZiAoaGFzQmVlblByb2Nlc3NlZCkge1xyXG4gICAgICBjb25zb2xlLmxvZyhgW3Byb2Nlc3NCdW5kbGVTYWxlTGluZV0gQnVuZGxlIGFscmVhZHkgcHJvY2Vzc2VkIGZvciBsaW5lICR7bGluZS5saW5lSWR9LCBza2lwcGluZ2ApO1xyXG4gICAgICByZXR1cm47XHJcbiAgICB9XHJcbiAgICBcclxuICAgIC8vIFRPRE86IEltcGxlbWVudCBidW5kbGUgcHJvY2Vzc2luZyBsb2dpY1xyXG4gICAgLy8gVGhpcyB3b3VsZCBpbnZvbHZlOlxyXG4gICAgLy8gMS4gRmluZGluZyBidW5kbGUgaXRlbXMgb2YgdGhlIHNwZWNpZmllZCB0eXBlXHJcbiAgICAvLyAyLiBSZWR1Y2luZyB0aGVpciBzdG9ja1xyXG4gICAgLy8gMy4gQ3JlYXRpbmcgU0FMRV9JVEVNIGxpbmtzXHJcbiAgICAvLyA0LiBIYW5kbGluZyBpdGVtc1BlckJ1bmRsZSBsb2dpY1xyXG4gICAgXHJcbiAgICBjb25zb2xlLmxvZyhgW3Byb2Nlc3NCdW5kbGVTYWxlTGluZV0gQnVuZGxlIHByb2Nlc3Npbmcgbm90IHlldCBpbXBsZW1lbnRlZCBmb3IgJHtsaW5lLml0ZW1UeXBlfWApO1xyXG4gICAgXHJcbiAgICAvLyBNYXJrIGVmZmVjdCBhcyBjb21wbGV0ZSAoZXZlbiB0aG91Z2ggbm90IGltcGxlbWVudGVkKVxyXG4gICAgYXdhaXQgbWFya0VmZmVjdChgc2FsZToke3NhbGUuaWR9OiR7YnVuZGxlUHJvY2Vzc2VkS2V5fWApO1xyXG4gICAgXHJcbiAgfSBjYXRjaCAoZXJyb3IpIHtcclxuICAgIGNvbnNvbGUuZXJyb3IoYFtwcm9jZXNzQnVuZGxlU2FsZUxpbmVdIOKdjCBGYWlsZWQgdG8gcHJvY2VzcyBidW5kbGUgc2FsZSBsaW5lICR7bGluZS5saW5lSWR9OmAsIGVycm9yKTtcclxuICAgIHRocm93IGVycm9yO1xyXG4gIH1cclxufVxyXG5cclxuLyoqXHJcbiAqIFByb2Nlc3Mgc2VydmljZSBzYWxlIGxpbmUgLSBjcmVhdGUgdGFzayBmcm9tIHNlcnZpY2VcclxuICovXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBwcm9jZXNzU2VydmljZUxpbmUobGluZTogU2VydmljZUxpbmUsIHNhbGU6IFNhbGUpOiBQcm9taXNlPHZvaWQ+IHtcclxuICB0cnkge1xyXG4gICAgY29uc29sZS5sb2coYFtwcm9jZXNzU2VydmljZUxpbmVdIFByb2Nlc3Npbmcgc2VydmljZSBzYWxlOiAke2xpbmUuZGVzY3JpcHRpb259YCk7XHJcbiAgICBcclxuICAgIC8vIElkZW1wb3RlbmN5IGNoZWNrXHJcbiAgICBjb25zdCB0YXNrQ3JlYXRlZEtleSA9IGBzYWxlOiR7c2FsZS5pZH06dGFza0NyZWF0ZWQ6JHtsaW5lLmxpbmVJZH1gO1xyXG4gICAgY29uc3QgaGFzQmVlbkNyZWF0ZWQgPSBhd2FpdCBoYXNFZmZlY3QodGFza0NyZWF0ZWRLZXkpO1xyXG4gICAgXHJcbiAgICBpZiAoaGFzQmVlbkNyZWF0ZWQgfHwgIWxpbmUuY3JlYXRlVGFzaykge1xyXG4gICAgICBjb25zb2xlLmxvZyhgW3Byb2Nlc3NTZXJ2aWNlTGluZV0gVGFzayBhbHJlYWR5IGNyZWF0ZWQgb3Igbm90IHJlcXVlc3RlZCBmb3IgbGluZSAke2xpbmUubGluZUlkfSwgc2tpcHBpbmdgKTtcclxuICAgICAgcmV0dXJuO1xyXG4gICAgfVxyXG4gICAgXHJcbiAgICAvLyBDcmVhdGUgdGFzayBmcm9tIHNlcnZpY2UgbGluZVxyXG4gICAgY29uc3Qgc2VydmljZVRhc2s6IFRhc2sgPSB7XHJcbiAgICAgIGlkOiBsaW5lLnRhc2tJZCB8fCBgdGFzay0ke3NhbGUuaWR9LSR7bGluZS5saW5lSWR9YCxcclxuICAgICAgbmFtZTogbGluZS5kZXNjcmlwdGlvbiB8fCAnU2VydmljZSBUYXNrJyxcclxuICAgICAgZGVzY3JpcHRpb246IGBTZXJ2aWNlIGZyb20gc2FsZTogJHtzYWxlLmNvdW50ZXJwYXJ0eU5hbWV9YCxcclxuICAgICAgdHlwZTogbGluZS50YXNrVHlwZSB8fCAnVEFTSycgYXMgYW55LFxyXG4gICAgICBzdGF0dXM6ICdDcmVhdGVkJyBhcyBhbnksXHJcbiAgICAgIHByaW9yaXR5OiAnTm9ybWFsJyBhcyBhbnksXHJcbiAgICAgIHN0YXRpb246IGxpbmUuc3RhdGlvbixcclxuICAgICAgcHJvZ3Jlc3M6IDAsXHJcbiAgICAgIG9yZGVyOiBEYXRlLm5vdygpLFxyXG4gICAgICBjb3N0OiBsaW5lLnRhc2tDb3N0IHx8IDAsXHJcbiAgICAgIHJldmVudWU6IDAsIC8vIFRhc2tzIGZyb20gc2FsZXMgZG9uJ3QgZ2V0IHJldmVudWUgLSBpdCBzdGF5cyBpbiB0aGUgc2FsZVxyXG4gICAgICByZXdhcmRzOiBsaW5lLnRhc2tSZXdhcmRzID8geyBwb2ludHM6IGxpbmUudGFza1Jld2FyZHMgfSA6IHsgcG9pbnRzOiB7IHhwOiAwLCBycDogMCwgZnA6IDAsIGhwOiAwIH0gfSxcclxuICAgICAgaXNDb2xsZWN0ZWQ6IGZhbHNlLFxyXG4gICAgICBjcmVhdGVkQXQ6IG5ldyBEYXRlKCksXHJcbiAgICAgIHVwZGF0ZWRBdDogbmV3IERhdGUoKSxcclxuICAgICAgbGlua3M6IFtdLFxyXG4gICAgICAvLyBBbWJhc3NhZG9yIEZpZWxkcyAtIGluaGVyaXQgZnJvbSBzYWxlXHJcbiAgICAgIHNpdGVJZDogc2FsZS5zaXRlSWQsXHJcbiAgICAgIHRhcmdldFNpdGVJZDogbGluZS50YXNrVGFyZ2V0U2l0ZUlkIHx8IHVuZGVmaW5lZCxcclxuICAgICAgc291cmNlU2FsZUlkOiBzYWxlLmlkLCAvLyBMaW5rIHRhc2sgYmFjayB0byBzYWxlXHJcbiAgICAgIC8vIEFkZGl0aW9uYWwgZmllbGRzIGZyb20gc2VydmljZSBsaW5lXHJcbiAgICAgIHBhcmVudElkOiBsaW5lLnRhc2tQYXJlbnRJZCB8fCB1bmRlZmluZWQsXHJcbiAgICAgIGR1ZURhdGU6IGxpbmUudGFza0R1ZURhdGUgfHwgdW5kZWZpbmVkLFxyXG4gICAgICAvLyBFbWlzc2FyeSBmaWVsZHMgZm9yIGl0ZW0gY3JlYXRpb25cclxuICAgICAgb3V0cHV0SXRlbVR5cGU6IGxpbmUub3V0cHV0SXRlbVR5cGUgfHwgdW5kZWZpbmVkLFxyXG4gICAgICBvdXRwdXRJdGVtU3ViVHlwZTogbGluZS5vdXRwdXRJdGVtU3ViVHlwZSB8fCB1bmRlZmluZWQsXHJcbiAgICAgIG91dHB1dFF1YW50aXR5OiBsaW5lLm91dHB1dEl0ZW1RdWFudGl0eSB8fCB1bmRlZmluZWQsXHJcbiAgICAgIG91dHB1dEl0ZW1OYW1lOiBsaW5lLm91dHB1dEl0ZW1OYW1lIHx8IHVuZGVmaW5lZCxcclxuICAgICAgb3V0cHV0VW5pdENvc3Q6IGxpbmUub3V0cHV0VW5pdENvc3QgfHwgdW5kZWZpbmVkLFxyXG4gICAgICBvdXRwdXRJdGVtQ29sbGVjdGlvbjogbGluZS5vdXRwdXRJdGVtQ29sbGVjdGlvbiB8fCB1bmRlZmluZWQsXHJcbiAgICAgIG91dHB1dEl0ZW1QcmljZTogbGluZS5vdXRwdXRJdGVtUHJpY2UgfHwgdW5kZWZpbmVkLFxyXG4gICAgICBpc05ld0l0ZW06IGxpbmUuaXNOZXdPdXRwdXRJdGVtIHx8IGZhbHNlLFxyXG4gICAgICBpc1NvbGQ6IGxpbmUuaXNTb2xkIHx8IGZhbHNlLFxyXG4gICAgICBvdXRwdXRJdGVtU3RhdHVzOiAnQ3JlYXRlZCcgYXMgYW55XHJcbiAgICB9O1xyXG4gICAgXHJcbiAgICAvLyBTYXZlIHRoZSB0YXNrXHJcbiAgICBhd2FpdCBDbGllbnRBUEkudXBzZXJ0VGFzayhzZXJ2aWNlVGFzayk7XHJcbiAgICBcclxuICAgIC8vIENyZWF0ZSBTQUxFX1RBU0sgbGlua1xyXG4gICAgY29uc3QgbGlua01ldGFkYXRhID0ge1xyXG4gICAgICBzZXJ2aWNlRGVzY3JpcHRpb246IGxpbmUuZGVzY3JpcHRpb24sXHJcbiAgICAgIHJldmVudWU6IGxpbmUucmV2ZW51ZSxcclxuICAgICAgc3RhdGlvbjogbGluZS5zdGF0aW9uLFxyXG4gICAgICB0YXNrVHlwZTogbGluZS50YXNrVHlwZSxcclxuICAgICAgY3JlYXRlZEZyb206ICdzZXJ2aWNlX3NhbGUnXHJcbiAgICB9O1xyXG4gICAgXHJcbiAgICBjb25zdCBsaW5rID0gbWFrZUxpbmsoXHJcbiAgICAgIExpbmtUeXBlLlNBTEVfVEFTSyxcclxuICAgICAgeyB0eXBlOiBFbnRpdHlUeXBlLlNBTEUsIGlkOiBzYWxlLmlkIH0sXHJcbiAgICAgIHsgdHlwZTogRW50aXR5VHlwZS5UQVNLLCBpZDogc2VydmljZVRhc2suaWQgfSxcclxuICAgICAgbGlua01ldGFkYXRhXHJcbiAgICApO1xyXG4gICAgYXdhaXQgY3JlYXRlTGluayhsaW5rKTtcclxuICAgIFxyXG4gICAgLy8gTWFyayBlZmZlY3QgYXMgY29tcGxldGVcclxuICAgIGF3YWl0IG1hcmtFZmZlY3QoYHNhbGU6JHtzYWxlLmlkfToke3Rhc2tDcmVhdGVkS2V5fWApO1xyXG4gICAgXHJcbiAgICAvLyBMb2cgdGhlIHRhc2sgY3JlYXRpb25cclxuICAgIGF3YWl0IGFwcGVuZEVudGl0eUxvZygndGFzaycsIHNlcnZpY2VUYXNrLmlkLCAnQ1JFQVRFRCcsIHtcclxuICAgICAgbmFtZTogc2VydmljZVRhc2submFtZSxcclxuICAgICAgY3JlYXRlZEZyb206ICdzZXJ2aWNlX3NhbGUnLFxyXG4gICAgICBzYWxlSWQ6IHNhbGUuaWQsXHJcbiAgICAgIHNlcnZpY2VEZXNjcmlwdGlvbjogbGluZS5kZXNjcmlwdGlvbixcclxuICAgICAgc3RhdGlvbjogbGluZS5zdGF0aW9uXHJcbiAgICB9KTtcclxuICAgIFxyXG4gICAgY29uc29sZS5sb2coYFtwcm9jZXNzU2VydmljZUxpbmVdIOKchSBDcmVhdGVkIHRhc2sgZnJvbSBzZXJ2aWNlOiAke3NlcnZpY2VUYXNrLm5hbWV9YCk7XHJcbiAgICBcclxuICB9IGNhdGNoIChlcnJvcikge1xyXG4gICAgY29uc29sZS5lcnJvcihgW3Byb2Nlc3NTZXJ2aWNlTGluZV0g4p2MIEZhaWxlZCB0byBwcm9jZXNzIHNlcnZpY2Ugc2FsZSBsaW5lICR7bGluZS5saW5lSWR9OmAsIGVycm9yKTtcclxuICAgIHRocm93IGVycm9yO1xyXG4gIH1cclxufVxyXG5cclxuIl0sIm5hbWVzIjpbIkxpbmtUeXBlIiwiRW50aXR5VHlwZSIsIkNsaWVudEFQSSIsIm1ha2VMaW5rIiwiY3JlYXRlTGluayIsImhhc0VmZmVjdCIsIm1hcmtFZmZlY3QiLCJhcHBlbmRFbnRpdHlMb2ciLCJjcmVhdGVGaW5hbmNpYWxSZWNvcmRGcm9tU2FsZSIsInByb2Nlc3NTYWxlTGluZXMiLCJzYWxlIiwiY29uc29sZSIsImxvZyIsImxpbmVzIiwibGVuZ3RoIiwiY291bnRlcnBhcnR5TmFtZSIsImxpbmUiLCJraW5kIiwibGluZUlkIiwicHJvY2Vzc0l0ZW1TYWxlTGluZSIsInByb2Nlc3NCdW5kbGVTYWxlTGluZSIsInByb2Nlc3NTZXJ2aWNlTGluZSIsIndhcm4iLCJ0b3RhbHMiLCJ0b3RhbFJldmVudWUiLCJlcnJvciIsImlkIiwiaXRlbUlkIiwicXVhbnRpdHkiLCJzdG9ja0RlY3JlbWVudGVkS2V5IiwiaGFzQmVlbkRlY3JlbWVudGVkIiwiaXRlbXMiLCJnZXRJdGVtcyIsIml0ZW0iLCJmaW5kIiwiaSIsInRvdGFsQXZhaWxhYmxlUXVhbnRpdHkiLCJzdG9jayIsInJlZHVjZSIsInN1bSIsInN0b2NrUG9pbnQiLCJxdWFudGl0eVNvbGQiLCJuYW1lIiwidXBkYXRlZEl0ZW0iLCJ1cGRhdGVkQXQiLCJEYXRlIiwic3RhdHVzIiwidXBzZXJ0SXRlbSIsImxpbmtNZXRhZGF0YSIsInVuaXRQcmljZSIsInRvdGFsIiwic29sZEF0Iiwic2FsZURhdGUiLCJ0b0lTT1N0cmluZyIsInNpdGVJZCIsImxpbmsiLCJTQUxFX0lURU0iLCJ0eXBlIiwiU0FMRSIsIklURU0iLCJzYWxlSWQiLCJpdGVtVHlwZSIsImJ1bmRsZVByb2Nlc3NlZEtleSIsImhhc0JlZW5Qcm9jZXNzZWQiLCJkZXNjcmlwdGlvbiIsInRhc2tDcmVhdGVkS2V5IiwiaGFzQmVlbkNyZWF0ZWQiLCJjcmVhdGVUYXNrIiwic2VydmljZVRhc2siLCJ0YXNrSWQiLCJ0YXNrVHlwZSIsInByaW9yaXR5Iiwic3RhdGlvbiIsInByb2dyZXNzIiwib3JkZXIiLCJub3ciLCJjb3N0IiwidGFza0Nvc3QiLCJyZXZlbnVlIiwicmV3YXJkcyIsInRhc2tSZXdhcmRzIiwicG9pbnRzIiwieHAiLCJycCIsImZwIiwiaHAiLCJpc0NvbGxlY3RlZCIsImNyZWF0ZWRBdCIsImxpbmtzIiwidGFyZ2V0U2l0ZUlkIiwidGFza1RhcmdldFNpdGVJZCIsInVuZGVmaW5lZCIsInNvdXJjZVNhbGVJZCIsInBhcmVudElkIiwidGFza1BhcmVudElkIiwiZHVlRGF0ZSIsInRhc2tEdWVEYXRlIiwib3V0cHV0SXRlbVR5cGUiLCJvdXRwdXRJdGVtU3ViVHlwZSIsIm91dHB1dFF1YW50aXR5Iiwib3V0cHV0SXRlbVF1YW50aXR5Iiwib3V0cHV0SXRlbU5hbWUiLCJvdXRwdXRVbml0Q29zdCIsIm91dHB1dEl0ZW1Db2xsZWN0aW9uIiwib3V0cHV0SXRlbVByaWNlIiwiaXNOZXdJdGVtIiwiaXNOZXdPdXRwdXRJdGVtIiwiaXNTb2xkIiwib3V0cHV0SXRlbVN0YXR1cyIsInVwc2VydFRhc2siLCJzZXJ2aWNlRGVzY3JpcHRpb24iLCJjcmVhdGVkRnJvbSIsIlNBTEVfVEFTSyIsIlRBU0siXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(app-pages-browser)/./workflows/sale-line-utils.ts\n"));

/***/ }),

/***/ "(app-pages-browser)/./workflows/update-propagation-utils.ts":
/*!***********************************************!*\
  !*** ./workflows/update-propagation-utils.ts ***!
  \***********************************************/
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval(__webpack_require__.ts("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   hasFinancialPropsChanged: function() { return /* binding */ hasFinancialPropsChanged; },\n/* harmony export */   hasJungleCoinsChanged: function() { return /* binding */ hasJungleCoinsChanged; },\n/* harmony export */   hasLinesChanged: function() { return /* binding */ hasLinesChanged; },\n/* harmony export */   hasOutputPropsChanged: function() { return /* binding */ hasOutputPropsChanged; },\n/* harmony export */   hasRevenueChanged: function() { return /* binding */ hasRevenueChanged; },\n/* harmony export */   hasRewardsChanged: function() { return /* binding */ hasRewardsChanged; },\n/* harmony export */   updateCharacterJungleCoinsFromRecord: function() { return /* binding */ updateCharacterJungleCoinsFromRecord; },\n/* harmony export */   updateFinancialRecordsFromSale: function() { return /* binding */ updateFinancialRecordsFromSale; },\n/* harmony export */   updateFinancialRecordsFromTask: function() { return /* binding */ updateFinancialRecordsFromTask; },\n/* harmony export */   updateItemsCreatedByRecord: function() { return /* binding */ updateItemsCreatedByRecord; },\n/* harmony export */   updateItemsCreatedByTask: function() { return /* binding */ updateItemsCreatedByTask; },\n/* harmony export */   updateItemsFromSale: function() { return /* binding */ updateItemsFromSale; },\n/* harmony export */   updatePlayerPointsFromSource: function() { return /* binding */ updatePlayerPointsFromSource; },\n/* harmony export */   updateTasksFromFinancialRecord: function() { return /* binding */ updateTasksFromFinancialRecord; }\n/* harmony export */ });\n/* harmony import */ var _lib_client_api__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @/lib/client-api */ \"(app-pages-browser)/./lib/client-api.ts\");\n/* harmony import */ var _data_store_effects_registry__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @/data-store/effects-registry */ \"(app-pages-browser)/./data-store/effects-registry.ts\");\n// workflows/update-propagation-utils.ts\n// Comprehensive update propagation across ALL entity relationships\n\n\n// ============================================================================\n// TASK  FINANCIAL RECORD PROPAGATION\n// ============================================================================\nasync function updateFinancialRecordsFromTask(task, previousTask) {\n    try {\n        console.log(\"[updateFinancialRecordsFromTask] Updating financial records for task: \".concat(task.name));\n        // Find financial records created from this task\n        const allFinancials = await _lib_client_api__WEBPACK_IMPORTED_MODULE_0__.ClientAPI.getFinancialRecords();\n        const relatedRecords = allFinancials.filter((record)=>record.sourceTaskId === task.id);\n        for (const record of relatedRecords){\n            var _task_updatedAt;\n            const updateKey = \"updateFinancialFromTask:\".concat(task.id, \":\").concat(record.id, \":\").concat((_task_updatedAt = task.updatedAt) === null || _task_updatedAt === void 0 ? void 0 : _task_updatedAt.getTime());\n            if (await (0,_data_store_effects_registry__WEBPACK_IMPORTED_MODULE_1__.hasEffect)(updateKey)) {\n                console.log(\"[updateFinancialRecordsFromTask]  Already updated record: \".concat(record.id));\n                continue;\n            }\n            // Check if financial properties changed\n            const financialPropsChanged = task.cost !== previousTask.cost || task.revenue !== previousTask.revenue || task.isNotPaid !== previousTask.isNotPaid || task.isNotCharged !== previousTask.isNotCharged || task.name !== previousTask.name || task.station !== previousTask.station;\n            if (financialPropsChanged) {\n                const updatedRecord = {\n                    ...record,\n                    cost: task.cost,\n                    revenue: task.revenue,\n                    isNotPaid: task.isNotPaid,\n                    isNotCharged: task.isNotCharged,\n                    name: task.name,\n                    station: task.station,\n                    updatedAt: new Date()\n                };\n                await _lib_client_api__WEBPACK_IMPORTED_MODULE_0__.ClientAPI.upsertFinancialRecord(updatedRecord);\n                await (0,_data_store_effects_registry__WEBPACK_IMPORTED_MODULE_1__.markEffect)(updateKey);\n                console.log(\"[updateFinancialRecordsFromTask]  Updated financial record: \".concat(record.id));\n            }\n        }\n    } catch (error) {\n        console.error(\"[updateFinancialRecordsFromTask] Error updating financial records:\", error);\n    }\n}\n// ============================================================================\n// FINANCIAL RECORD  TASK PROPAGATION\n// ============================================================================\nasync function updateTasksFromFinancialRecord(record, previousRecord) {\n    try {\n        console.log(\"[updateTasksFromFinancialRecord] Updating tasks for financial record: \".concat(record.name));\n        // Find tasks that created this financial record\n        const allTasks = await _lib_client_api__WEBPACK_IMPORTED_MODULE_0__.ClientAPI.getTasks();\n        const relatedTasks = allTasks.filter((task)=>task.id === record.sourceTaskId);\n        for (const task of relatedTasks){\n            var _record_updatedAt;\n            const updateKey = \"updateTaskFromFinancial:\".concat(record.id, \":\").concat(task.id, \":\").concat((_record_updatedAt = record.updatedAt) === null || _record_updatedAt === void 0 ? void 0 : _record_updatedAt.getTime());\n            if (await (0,_data_store_effects_registry__WEBPACK_IMPORTED_MODULE_1__.hasEffect)(updateKey)) {\n                console.log(\"[updateTasksFromFinancialRecord]  Already updated task: \".concat(task.id));\n                continue;\n            }\n            // Check if financial properties changed\n            const financialPropsChanged = record.cost !== previousRecord.cost || record.revenue !== previousRecord.revenue || record.isNotPaid !== previousRecord.isNotPaid || record.isNotCharged !== previousRecord.isNotCharged || record.name !== previousRecord.name || record.station !== previousRecord.station;\n            if (financialPropsChanged) {\n                const updatedTask = {\n                    ...task,\n                    cost: record.cost,\n                    revenue: record.revenue,\n                    isNotPaid: record.isNotPaid,\n                    isNotCharged: record.isNotCharged,\n                    name: record.name,\n                    station: record.station,\n                    updatedAt: new Date()\n                };\n                await _lib_client_api__WEBPACK_IMPORTED_MODULE_0__.ClientAPI.upsertTask(updatedTask);\n                await (0,_data_store_effects_registry__WEBPACK_IMPORTED_MODULE_1__.markEffect)(updateKey);\n                console.log(\"[updateTasksFromFinancialRecord]  Updated task: \".concat(task.id));\n            }\n        }\n    } catch (error) {\n        console.error(\"[updateTasksFromFinancialRecord] Error updating tasks:\", error);\n    }\n}\n// ============================================================================\n// TASK  ITEM PROPAGATION (Enhanced)\n// ============================================================================\nasync function updateItemsCreatedByTask(task, previousTask) {\n    try {\n        console.log(\"[updateItemsCreatedByTask] Updating items for task: \".concat(task.name));\n        // Find items created from this task\n        const allItems = await _lib_client_api__WEBPACK_IMPORTED_MODULE_0__.ClientAPI.getItems();\n        const relatedItems = allItems.filter((item)=>item.sourceTaskId === task.id);\n        for (const item of relatedItems){\n            var _task_updatedAt;\n            const updateKey = \"updateItemFromTask:\".concat(task.id, \":\").concat(item.id, \":\").concat((_task_updatedAt = task.updatedAt) === null || _task_updatedAt === void 0 ? void 0 : _task_updatedAt.getTime());\n            if (await (0,_data_store_effects_registry__WEBPACK_IMPORTED_MODULE_1__.hasEffect)(updateKey)) {\n                console.log(\"[updateItemsCreatedByTask]  Already updated item: \".concat(item.id));\n                continue;\n            }\n            // Check if output properties changed\n            const outputPropsChanged = task.outputQuantity !== previousTask.outputQuantity || task.outputItemName !== previousTask.outputItemName || task.outputUnitCost !== previousTask.outputUnitCost || task.outputItemPrice !== previousTask.outputItemPrice || task.station !== previousTask.station;\n            if (outputPropsChanged) {\n                const updatedItem = {\n                    ...item,\n                    name: task.outputItemName || item.name,\n                    unitCost: task.outputUnitCost || item.unitCost,\n                    price: task.outputItemPrice || item.price,\n                    station: task.station || item.station,\n                    updatedAt: new Date()\n                };\n                // Update stock quantity if it changed\n                if (task.outputQuantity !== previousTask.outputQuantity) {\n                    const quantityDiff = (task.outputQuantity || 0) - (previousTask.outputQuantity || 0);\n                    if (quantityDiff !== 0) {\n                        // Update the first stock point (or create one if none exists)\n                        if (updatedItem.stock && updatedItem.stock.length > 0) {\n                            updatedItem.stock[0].quantity += quantityDiff;\n                        } else {\n                            updatedItem.stock = [\n                                {\n                                    siteId: task.siteId || \"default\",\n                                    quantity: quantityDiff\n                                }\n                            ];\n                        }\n                    }\n                }\n                await _lib_client_api__WEBPACK_IMPORTED_MODULE_0__.ClientAPI.upsertItem(updatedItem);\n                await (0,_data_store_effects_registry__WEBPACK_IMPORTED_MODULE_1__.markEffect)(updateKey);\n                console.log(\"[updateItemsCreatedByTask]  Updated item: \".concat(item.id));\n            }\n        }\n    } catch (error) {\n        console.error(\"[updateItemsCreatedByTask] Error updating items:\", error);\n    }\n}\n// ============================================================================\n// FINANCIAL RECORD  ITEM PROPAGATION (Enhanced)\n// ============================================================================\nasync function updateItemsCreatedByRecord(record, previousRecord) {\n    try {\n        console.log(\"[updateItemsCreatedByRecord] Updating items for financial record: \".concat(record.name));\n        // Find items created from this financial record\n        const allItems = await _lib_client_api__WEBPACK_IMPORTED_MODULE_0__.ClientAPI.getItems();\n        const relatedItems = allItems.filter((item)=>item.sourceRecordId === record.id);\n        for (const item of relatedItems){\n            var _record_updatedAt;\n            const updateKey = \"updateItemFromRecord:\".concat(record.id, \":\").concat(item.id, \":\").concat((_record_updatedAt = record.updatedAt) === null || _record_updatedAt === void 0 ? void 0 : _record_updatedAt.getTime());\n            if (await (0,_data_store_effects_registry__WEBPACK_IMPORTED_MODULE_1__.hasEffect)(updateKey)) {\n                console.log(\"[updateItemsCreatedByRecord]  Already updated item: \".concat(item.id));\n                continue;\n            }\n            // Check if output properties changed\n            const outputPropsChanged = record.outputQuantity !== previousRecord.outputQuantity || record.outputItemName !== previousRecord.outputItemName || record.outputUnitCost !== previousRecord.outputUnitCost || record.outputItemPrice !== previousRecord.outputItemPrice || record.station !== previousRecord.station;\n            if (outputPropsChanged) {\n                const updatedItem = {\n                    ...item,\n                    name: record.outputItemName || item.name,\n                    unitCost: record.outputUnitCost || item.unitCost,\n                    price: record.outputItemPrice || item.price,\n                    station: record.station || item.station,\n                    updatedAt: new Date()\n                };\n                // Update stock quantity if it changed\n                if (record.outputQuantity !== previousRecord.outputQuantity) {\n                    const quantityDiff = (record.outputQuantity || 0) - (previousRecord.outputQuantity || 0);\n                    if (quantityDiff !== 0) {\n                        // Update the first stock point (or create one if none exists)\n                        if (updatedItem.stock && updatedItem.stock.length > 0) {\n                            updatedItem.stock[0].quantity += quantityDiff;\n                        } else {\n                            updatedItem.stock = [\n                                {\n                                    siteId: record.siteId || \"default\",\n                                    quantity: quantityDiff\n                                }\n                            ];\n                        }\n                    }\n                }\n                await _lib_client_api__WEBPACK_IMPORTED_MODULE_0__.ClientAPI.upsertItem(updatedItem);\n                await (0,_data_store_effects_registry__WEBPACK_IMPORTED_MODULE_1__.markEffect)(updateKey);\n                console.log(\"[updateItemsCreatedByRecord]  Updated item: \".concat(item.id));\n            }\n        }\n    } catch (error) {\n        console.error(\"[updateItemsCreatedByRecord] Error updating items:\", error);\n    }\n}\n// ============================================================================\n// SALE  FINANCIAL RECORD PROPAGATION\n// ============================================================================\nasync function updateFinancialRecordsFromSale(sale, previousSale) {\n    try {\n        console.log(\"[updateFinancialRecordsFromSale] Updating financial records for sale: \".concat(sale.name));\n        // Find financial records created from this sale\n        const allFinancials = await _lib_client_api__WEBPACK_IMPORTED_MODULE_0__.ClientAPI.getFinancialRecords();\n        const relatedRecords = allFinancials.filter((record)=>record.sourceSaleId === sale.id);\n        for (const record of relatedRecords){\n            var _sale_updatedAt, _sale_totals, _previousSale_totals;\n            const updateKey = \"updateFinancialFromSale:\".concat(sale.id, \":\").concat(record.id, \":\").concat((_sale_updatedAt = sale.updatedAt) === null || _sale_updatedAt === void 0 ? void 0 : _sale_updatedAt.getTime());\n            if (await (0,_data_store_effects_registry__WEBPACK_IMPORTED_MODULE_1__.hasEffect)(updateKey)) {\n                console.log(\"[updateFinancialRecordsFromSale]  Already updated record: \".concat(record.id));\n                continue;\n            }\n            // Check if revenue properties changed\n            const revenuePropsChanged = ((_sale_totals = sale.totals) === null || _sale_totals === void 0 ? void 0 : _sale_totals.totalRevenue) !== ((_previousSale_totals = previousSale.totals) === null || _previousSale_totals === void 0 ? void 0 : _previousSale_totals.totalRevenue) || sale.isNotPaid !== previousSale.isNotPaid || sale.status !== previousSale.status;\n            if (revenuePropsChanged) {\n                var _sale_totals1;\n                const updatedRecord = {\n                    ...record,\n                    revenue: ((_sale_totals1 = sale.totals) === null || _sale_totals1 === void 0 ? void 0 : _sale_totals1.totalRevenue) || 0,\n                    isNotPaid: sale.isNotPaid,\n                    isNotCharged: sale.status !== \"CHARGED\",\n                    updatedAt: new Date()\n                };\n                await _lib_client_api__WEBPACK_IMPORTED_MODULE_0__.ClientAPI.upsertFinancialRecord(updatedRecord);\n                await (0,_data_store_effects_registry__WEBPACK_IMPORTED_MODULE_1__.markEffect)(updateKey);\n                console.log(\"[updateFinancialRecordsFromSale]  Updated financial record: \".concat(record.id));\n            }\n        }\n    } catch (error) {\n        console.error(\"[updateFinancialRecordsFromSale] Error updating financial records:\", error);\n    }\n}\n// ============================================================================\n// SALE  ITEM PROPAGATION (Stock Updates)\n// ============================================================================\nasync function updateItemsFromSale(sale, previousSale) {\n    try {\n        var _sale_lines, _previousSale_lines;\n        console.log(\"[updateItemsFromSale] Updating items for sale: \".concat(sale.name));\n        // Check if sale lines changed\n        const linesChanged = ((_sale_lines = sale.lines) === null || _sale_lines === void 0 ? void 0 : _sale_lines.length) !== ((_previousSale_lines = previousSale.lines) === null || _previousSale_lines === void 0 ? void 0 : _previousSale_lines.length) || JSON.stringify(sale.lines) !== JSON.stringify(previousSale.lines);\n        if (!linesChanged) {\n            console.log(\"[updateItemsFromSale] No line changes detected\");\n            return;\n        }\n        // Process each sale line\n        for (const line of sale.lines || []){\n            if (line.kind === \"item\" && \"itemId\" in line && line.itemId) {\n                var _sale_updatedAt;\n                const updateKey = \"updateItemFromSale:\".concat(sale.id, \":\").concat(line.itemId, \":\").concat((_sale_updatedAt = sale.updatedAt) === null || _sale_updatedAt === void 0 ? void 0 : _sale_updatedAt.getTime());\n                if (await (0,_data_store_effects_registry__WEBPACK_IMPORTED_MODULE_1__.hasEffect)(updateKey)) {\n                    console.log(\"[updateItemsFromSale]  Already updated item: \".concat(line.itemId));\n                    continue;\n                }\n                // Get the item\n                const item = await _lib_client_api__WEBPACK_IMPORTED_MODULE_0__.ClientAPI.getItemById(line.itemId);\n                if (!item) {\n                    console.warn(\"[updateItemsFromSale] Item not found: \".concat(line.itemId));\n                    continue;\n                }\n                // Update quantity sold\n                const updatedItem = {\n                    ...item,\n                    quantitySold: (item.quantitySold || 0) + (line.quantity || 0),\n                    updatedAt: new Date()\n                };\n                await _lib_client_api__WEBPACK_IMPORTED_MODULE_0__.ClientAPI.upsertItem(updatedItem);\n                await (0,_data_store_effects_registry__WEBPACK_IMPORTED_MODULE_1__.markEffect)(updateKey);\n                console.log(\"[updateItemsFromSale]  Updated item: \".concat(line.itemId));\n            }\n        }\n    } catch (error) {\n        console.error(\"[updateItemsFromSale] Error updating items:\", error);\n    }\n}\n// ============================================================================\n// TASK/FINANCIAL/SALE  PLAYER PROPAGATION (Points Delta)\n// ============================================================================\nasync function updatePlayerPointsFromSource(sourceType, newSource, oldSource) {\n    try {\n        var _newSource_updatedAt, _player_points, _player_points1, _player_points2, _player_points3;\n        console.log(\"[updatePlayerPointsFromSource] Updating player points from \".concat(sourceType, \": \").concat(newSource.name));\n        // Calculate points delta\n        let pointsDelta = {\n            xp: 0,\n            rp: 0,\n            fp: 0,\n            hp: 0\n        };\n        if (sourceType === \"task\" || sourceType === \"financial\") {\n            var _newSource_rewards, _oldSource_rewards;\n            const newPoints = ((_newSource_rewards = newSource.rewards) === null || _newSource_rewards === void 0 ? void 0 : _newSource_rewards.points) || {\n                xp: 0,\n                rp: 0,\n                fp: 0,\n                hp: 0\n            };\n            const oldPoints = ((_oldSource_rewards = oldSource.rewards) === null || _oldSource_rewards === void 0 ? void 0 : _oldSource_rewards.points) || {\n                xp: 0,\n                rp: 0,\n                fp: 0,\n                hp: 0\n            };\n            pointsDelta = {\n                xp: (newPoints.xp || 0) - (oldPoints.xp || 0),\n                rp: (newPoints.rp || 0) - (oldPoints.rp || 0),\n                fp: (newPoints.fp || 0) - (oldPoints.fp || 0),\n                hp: (newPoints.hp || 0) - (oldPoints.hp || 0)\n            };\n        } else if (sourceType === \"sale\") {\n            var _newSource_totals, _oldSource_totals;\n            // Calculate points from revenue (simplified)\n            const newRevenue = ((_newSource_totals = newSource.totals) === null || _newSource_totals === void 0 ? void 0 : _newSource_totals.totalRevenue) || 0;\n            const oldRevenue = ((_oldSource_totals = oldSource.totals) === null || _oldSource_totals === void 0 ? void 0 : _oldSource_totals.totalRevenue) || 0;\n            const revenueDelta = newRevenue - oldRevenue;\n            // Convert revenue to points (simplified calculation)\n            pointsDelta = {\n                xp: Math.floor(revenueDelta * 0.1),\n                rp: Math.floor(revenueDelta * 0.05),\n                fp: Math.floor(revenueDelta * 0.03),\n                hp: Math.floor(revenueDelta * 0.02)\n            };\n        }\n        // Skip if no points change\n        if (pointsDelta.xp === 0 && pointsDelta.rp === 0 && pointsDelta.fp === 0 && pointsDelta.hp === 0) {\n            console.log(\"[updatePlayerPointsFromSource] No points change detected\");\n            return;\n        }\n        // Find the player (assuming single player for now)\n        const players = await _lib_client_api__WEBPACK_IMPORTED_MODULE_0__.ClientAPI.getPlayers();\n        const player = players[0]; // Simplified - in real system, find by source relationship\n        if (!player) {\n            console.warn(\"[updatePlayerPointsFromSource] No player found\");\n            return;\n        }\n        const updateKey = \"updatePlayerPoints:\".concat(sourceType, \":\").concat(newSource.id, \":\").concat(player.id, \":\").concat((_newSource_updatedAt = newSource.updatedAt) === null || _newSource_updatedAt === void 0 ? void 0 : _newSource_updatedAt.getTime());\n        if (await (0,_data_store_effects_registry__WEBPACK_IMPORTED_MODULE_1__.hasEffect)(updateKey)) {\n            console.log(\"[updatePlayerPointsFromSource]  Already updated player: \".concat(player.id));\n            return;\n        }\n        // Update player points\n        const updatedPlayer = {\n            ...player,\n            points: {\n                xp: (((_player_points = player.points) === null || _player_points === void 0 ? void 0 : _player_points.xp) || 0) + pointsDelta.xp,\n                rp: (((_player_points1 = player.points) === null || _player_points1 === void 0 ? void 0 : _player_points1.rp) || 0) + pointsDelta.rp,\n                fp: (((_player_points2 = player.points) === null || _player_points2 === void 0 ? void 0 : _player_points2.fp) || 0) + pointsDelta.fp,\n                hp: (((_player_points3 = player.points) === null || _player_points3 === void 0 ? void 0 : _player_points3.hp) || 0) + pointsDelta.hp\n            },\n            updatedAt: new Date()\n        };\n        await _lib_client_api__WEBPACK_IMPORTED_MODULE_0__.ClientAPI.upsertPlayer(updatedPlayer);\n        await (0,_data_store_effects_registry__WEBPACK_IMPORTED_MODULE_1__.markEffect)(updateKey);\n        console.log(\"[updatePlayerPointsFromSource]  Updated player points: \".concat(player.id));\n    } catch (error) {\n        console.error(\"[updatePlayerPointsFromSource] Error updating player points:\", error);\n    }\n}\n// ============================================================================\n// FINANCIAL  CHARACTER PROPAGATION (Jungle Coins Delta)\n// ============================================================================\nasync function updateCharacterJungleCoinsFromRecord(record, previousRecord) {\n    try {\n        console.log(\"[updateCharacterJungleCoinsFromRecord] Updating character jungle coins for record: \".concat(record.name));\n        // Calculate jungle coins delta\n        const newJungleCoins = record.jungleCoins || 0;\n        const oldJungleCoins = previousRecord.jungleCoins || 0;\n        const jungleCoinsDelta = newJungleCoins - oldJungleCoins;\n        if (jungleCoinsDelta === 0) {\n            console.log(\"[updateCharacterJungleCoinsFromRecord] No jungle coins change detected\");\n            return;\n        }\n        // Find characters related to this financial record\n        const allCharacters = await _lib_client_api__WEBPACK_IMPORTED_MODULE_0__.ClientAPI.getCharacters();\n        const relatedCharacters = allCharacters.filter((char)=>char.id === record.customerCharacterId);\n        for (const character of relatedCharacters){\n            var _record_updatedAt;\n            const updateKey = \"updateCharacterJungleCoins:\".concat(record.id, \":\").concat(character.id, \":\").concat((_record_updatedAt = record.updatedAt) === null || _record_updatedAt === void 0 ? void 0 : _record_updatedAt.getTime());\n            if (await (0,_data_store_effects_registry__WEBPACK_IMPORTED_MODULE_1__.hasEffect)(updateKey)) {\n                console.log(\"[updateCharacterJungleCoinsFromRecord]  Already updated character: \".concat(character.id));\n                continue;\n            }\n            // Update character jungle coins\n            const updatedCharacter = {\n                ...character,\n                jungleCoins: (character.jungleCoins || 0) + jungleCoinsDelta,\n                updatedAt: new Date()\n            };\n            await _lib_client_api__WEBPACK_IMPORTED_MODULE_0__.ClientAPI.upsertCharacter(updatedCharacter);\n            await (0,_data_store_effects_registry__WEBPACK_IMPORTED_MODULE_1__.markEffect)(updateKey);\n            console.log(\"[updateCharacterJungleCoinsFromRecord]  Updated character jungle coins: \".concat(character.id));\n        }\n    } catch (error) {\n        console.error(\"[updateCharacterJungleCoinsFromRecord] Error updating character jungle coins:\", error);\n    }\n}\n// ============================================================================\n// PROPERTY CHANGE DETECTION HELPERS\n// ============================================================================\nfunction hasFinancialPropsChanged(newEntity, oldEntity) {\n    return newEntity.cost !== oldEntity.cost || newEntity.revenue !== oldEntity.revenue || newEntity.isNotPaid !== oldEntity.isNotPaid || newEntity.isNotCharged !== oldEntity.isNotCharged || newEntity.name !== oldEntity.name || newEntity.station !== oldEntity.station;\n}\nfunction hasOutputPropsChanged(newEntity, oldEntity) {\n    return newEntity.outputQuantity !== oldEntity.outputQuantity || newEntity.outputItemName !== oldEntity.outputItemName || newEntity.outputUnitCost !== oldEntity.outputUnitCost || newEntity.outputItemPrice !== oldEntity.outputItemPrice || newEntity.station !== oldEntity.station;\n}\nfunction hasRewardsChanged(newEntity, oldEntity) {\n    var _newEntity_rewards, _oldEntity_rewards;\n    const newRewards = ((_newEntity_rewards = newEntity.rewards) === null || _newEntity_rewards === void 0 ? void 0 : _newEntity_rewards.points) || {\n        xp: 0,\n        rp: 0,\n        fp: 0,\n        hp: 0\n    };\n    const oldRewards = ((_oldEntity_rewards = oldEntity.rewards) === null || _oldEntity_rewards === void 0 ? void 0 : _oldEntity_rewards.points) || {\n        xp: 0,\n        rp: 0,\n        fp: 0,\n        hp: 0\n    };\n    return newRewards.xp !== oldRewards.xp || newRewards.rp !== oldRewards.rp || newRewards.fp !== oldRewards.fp || newRewards.hp !== oldRewards.hp;\n}\nfunction hasJungleCoinsChanged(newEntity, oldEntity) {\n    return (newEntity.jungleCoins || 0) !== (oldEntity.jungleCoins || 0);\n}\nfunction hasRevenueChanged(newEntity, oldEntity) {\n    var _newEntity_totals, _oldEntity_totals;\n    return (((_newEntity_totals = newEntity.totals) === null || _newEntity_totals === void 0 ? void 0 : _newEntity_totals.totalRevenue) || 0) !== (((_oldEntity_totals = oldEntity.totals) === null || _oldEntity_totals === void 0 ? void 0 : _oldEntity_totals.totalRevenue) || 0);\n}\nfunction hasLinesChanged(newEntity, oldEntity) {\n    return JSON.stringify(newEntity.lines) !== JSON.stringify(oldEntity.lines);\n}\n\n\n;\n    // Wrapped in an IIFE to avoid polluting the global scope\n    ;\n    (function () {\n        var _a, _b;\n        // Legacy CSS implementations will `eval` browser code in a Node.js context\n        // to extract CSS. For backwards compatibility, we need to check we're in a\n        // browser context before continuing.\n        if (typeof self !== 'undefined' &&\n            // AMP / No-JS mode does not inject these helpers:\n            '$RefreshHelpers$' in self) {\n            // @ts-ignore __webpack_module__ is global\n            var currentExports = module.exports;\n            // @ts-ignore __webpack_module__ is global\n            var prevSignature = (_b = (_a = module.hot.data) === null || _a === void 0 ? void 0 : _a.prevSignature) !== null && _b !== void 0 ? _b : null;\n            // This cannot happen in MainTemplate because the exports mismatch between\n            // templating and execution.\n            self.$RefreshHelpers$.registerExportsForReactRefresh(currentExports, module.id);\n            // A module can be accepted automatically based on its exports, e.g. when\n            // it is a Refresh Boundary.\n            if (self.$RefreshHelpers$.isReactRefreshBoundary(currentExports)) {\n                // Save the previous exports signature on update so we can compare the boundary\n                // signatures. We avoid saving exports themselves since it causes memory leaks (https://github.com/vercel/next.js/pull/53797)\n                module.hot.dispose(function (data) {\n                    data.prevSignature =\n                        self.$RefreshHelpers$.getRefreshBoundarySignature(currentExports);\n                });\n                // Unconditionally accept an update to this module, we'll check if it's\n                // still a Refresh Boundary later.\n                // @ts-ignore importMeta is replaced in the loader\n                module.hot.accept();\n                // This field is set when the previous version of this module was a\n                // Refresh Boundary, letting us know we need to check for invalidation or\n                // enqueue an update.\n                if (prevSignature !== null) {\n                    // A boundary can become ineligible if its exports are incompatible\n                    // with the previous exports.\n                    //\n                    // For example, if you add/remove/change exports, we'll want to\n                    // re-execute the importing modules, and force those components to\n                    // re-render. Similarly, if you convert a class component to a\n                    // function, we want to invalidate the boundary.\n                    if (self.$RefreshHelpers$.shouldInvalidateReactRefreshBoundary(prevSignature, self.$RefreshHelpers$.getRefreshBoundarySignature(currentExports))) {\n                        module.hot.invalidate();\n                    }\n                    else {\n                        self.$RefreshHelpers$.scheduleUpdate();\n                    }\n                }\n            }\n            else {\n                // Since we just executed the code for the module, it's possible that the\n                // new exports made it ineligible for being a boundary.\n                // We only care about the case when we were _previously_ a boundary,\n                // because we already accepted this update (accidental side effect).\n                var isNoLongerABoundary = prevSignature !== null;\n                if (isNoLongerABoundary) {\n                    module.hot.invalidate();\n                }\n            }\n        }\n    })();\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFwcC1wYWdlcy1icm93c2VyKS8uL3dvcmtmbG93cy91cGRhdGUtcHJvcGFnYXRpb24tdXRpbHMudHMiLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7Ozs7Ozs7OztBQUFBLHdDQUF3QztBQUN4QyxtRUFBbUU7QUFHdEI7QUFDeUI7QUFFdEUsK0VBQStFO0FBQy9FLHNDQUFzQztBQUN0QywrRUFBK0U7QUFFeEUsZUFBZUcsK0JBQ3BCQyxJQUFVLEVBQ1ZDLFlBQWtCO0lBRWxCLElBQUk7UUFDRkMsUUFBUUMsR0FBRyxDQUFDLHlFQUFtRixPQUFWSCxLQUFLSSxJQUFJO1FBRTlGLGdEQUFnRDtRQUNoRCxNQUFNQyxnQkFBZ0IsTUFBTVQsc0RBQVNBLENBQUNVLG1CQUFtQjtRQUN6RCxNQUFNQyxpQkFBaUJGLGNBQWNHLE1BQU0sQ0FBQ0MsQ0FBQUEsU0FBVUEsT0FBT0MsWUFBWSxLQUFLVixLQUFLVyxFQUFFO1FBRXJGLEtBQUssTUFBTUYsVUFBVUYsZUFBZ0I7Z0JBQ2tDUDtZQUFyRSxNQUFNWSxZQUFZLDJCQUFzQ0gsT0FBWFQsS0FBS1csRUFBRSxFQUFDLFlBQUdGLE9BQU9FLEVBQUUsRUFBQyxLQUE2QixRQUExQlgsa0JBQUFBLEtBQUthLFNBQVMsY0FBZGIsc0NBQUFBLGdCQUFnQmMsT0FBTztZQUU1RixJQUFJLE1BQU1qQix1RUFBU0EsQ0FBQ2UsWUFBWTtnQkFDOUJWLFFBQVFDLEdBQUcsQ0FBQywrREFBeUUsT0FBVk0sT0FBT0UsRUFBRTtnQkFDcEY7WUFDRjtZQUVBLHdDQUF3QztZQUN4QyxNQUFNSSx3QkFDSmYsS0FBS2dCLElBQUksS0FBS2YsYUFBYWUsSUFBSSxJQUMvQmhCLEtBQUtpQixPQUFPLEtBQUtoQixhQUFhZ0IsT0FBTyxJQUNyQ2pCLEtBQUtrQixTQUFTLEtBQUtqQixhQUFhaUIsU0FBUyxJQUN6Q2xCLEtBQUttQixZQUFZLEtBQUtsQixhQUFha0IsWUFBWSxJQUMvQ25CLEtBQUtJLElBQUksS0FBS0gsYUFBYUcsSUFBSSxJQUMvQkosS0FB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QUFFLEtBQUtrQyxXQUFXbEMsRUFBRSxJQUMvQmlDLFdBQVdoQyxFQUFFLEtBQUtpQyxXQUFXakMsRUFBRTtBQUVuQztBQUVPLFNBQVNrQyxzQkFBc0JOLFNBQWMsRUFBRUMsU0FBYztJQUNsRSxPQUFPLENBQUNELFVBQVVaLFdBQVcsSUFBSSxPQUFRYSxDQUFBQSxVQUFVYixXQUFXLElBQUk7QUFDcEU7QUFFTyxTQUFTbUIsa0JBQWtCUCxTQUFjLEVBQUVDLFNBQWM7UUFDdERELG1CQUEwQ0M7SUFBbEQsT0FBTyxDQUFDRCxFQUFBQSxvQkFBQUEsVUFBVW5ELE1BQU0sY0FBaEJtRCx3Q0FBQUEsa0JBQWtCbEQsWUFBWSxLQUFJLE9BQVFtRCxDQUFBQSxFQUFBQSxvQkFBQUEsVUFBVXBELE1BQU0sY0FBaEJvRCx3Q0FBQUEsa0JBQWtCbkQsWUFBWSxLQUFJO0FBQ3RGO0FBRU8sU0FBUzBELGdCQUFnQlIsU0FBYyxFQUFFQyxTQUFjO0lBQzVELE9BQU85QyxLQUFLQyxTQUFTLENBQUM0QyxVQUFVOUMsS0FBSyxNQUFNQyxLQUFLQyxTQUFTLENBQUM2QyxVQUFVL0MsS0FBSztBQUMzRSIsInNvdXJjZXMiOlsid2VicGFjazovL19OX0UvLi93b3JrZmxvd3MvdXBkYXRlLXByb3BhZ2F0aW9uLXV0aWxzLnRzP2QyODQiXSwic291cmNlc0NvbnRlbnQiOlsiLy8gd29ya2Zsb3dzL3VwZGF0ZS1wcm9wYWdhdGlvbi11dGlscy50c1xyXG4vLyBDb21wcmVoZW5zaXZlIHVwZGF0ZSBwcm9wYWdhdGlvbiBhY3Jvc3MgQUxMIGVudGl0eSByZWxhdGlvbnNoaXBzXHJcblxyXG5pbXBvcnQgdHlwZSB7IFRhc2ssIEl0ZW0sIFNhbGUsIEZpbmFuY2lhbFJlY29yZCwgQ2hhcmFjdGVyLCBQbGF5ZXIgfSBmcm9tICdAL3R5cGVzL2VudGl0aWVzJztcclxuaW1wb3J0IHsgQ2xpZW50QVBJIH0gZnJvbSAnQC9saWIvY2xpZW50LWFwaSc7XHJcbmltcG9ydCB7IGhhc0VmZmVjdCwgbWFya0VmZmVjdCB9IGZyb20gJ0AvZGF0YS1zdG9yZS9lZmZlY3RzLXJlZ2lzdHJ5JztcclxuXHJcbi8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cclxuLy8gVEFTSyDihpIgRklOQU5DSUFMIFJFQ09SRCBQUk9QQUdBVElPTlxyXG4vLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XHJcblxyXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gdXBkYXRlRmluYW5jaWFsUmVjb3Jkc0Zyb21UYXNrKFxyXG4gIHRhc2s6IFRhc2ssIFxyXG4gIHByZXZpb3VzVGFzazogVGFza1xyXG4pOiBQcm9taXNlPHZvaWQ+IHtcclxuICB0cnkge1xyXG4gICAgY29uc29sZS5sb2coYFt1cGRhdGVGaW5hbmNpYWxSZWNvcmRzRnJvbVRhc2tdIFVwZGF0aW5nIGZpbmFuY2lhbCByZWNvcmRzIGZvciB0YXNrOiAke3Rhc2submFtZX1gKTtcclxuICAgIFxyXG4gICAgLy8gRmluZCBmaW5hbmNpYWwgcmVjb3JkcyBjcmVhdGVkIGZyb20gdGhpcyB0YXNrXHJcbiAgICBjb25zdCBhbGxGaW5hbmNpYWxzID0gYXdhaXQgQ2xpZW50QVBJLmdldEZpbmFuY2lhbFJlY29yZHMoKTtcclxuICAgIGNvbnN0IHJlbGF0ZWRSZWNvcmRzID0gYWxsRmluYW5jaWFscy5maWx0ZXIocmVjb3JkID0+IHJlY29yZC5zb3VyY2VUYXNrSWQgPT09IHRhc2suaWQpO1xyXG4gICAgXHJcbiAgICBmb3IgKGNvbnN0IHJlY29yZCBvZiByZWxhdGVkUmVjb3Jkcykge1xyXG4gICAgICBjb25zdCB1cGRhdGVLZXkgPSBgdXBkYXRlRmluYW5jaWFsRnJvbVRhc2s6JHt0YXNrLmlkfToke3JlY29yZC5pZH06JHt0YXNrLnVwZGF0ZWRBdD8uZ2V0VGltZSgpfWA7XHJcbiAgICAgIFxyXG4gICAgICBpZiAoYXdhaXQgaGFzRWZmZWN0KHVwZGF0ZUtleSkpIHtcclxuICAgICAgICBjb25zb2xlLmxvZyhgW3VwZGF0ZUZpbmFuY2lhbFJlY29yZHNGcm9tVGFza10g4o+t77iPIEFscmVhZHkgdXBkYXRlZCByZWNvcmQ6ICR7cmVjb3JkLmlkfWApO1xyXG4gICAgICAgIGNvbnRpbnVlO1xyXG4gICAgICB9XHJcbiAgICAgIFxyXG4gICAgICAvLyBDaGVjayBpZiBmaW5hbmNpYWwgcHJvcGVydGllcyBjaGFuZ2VkXHJcbiAgICAgIGNvbnN0IGZpbmFuY2lhbFByb3BzQ2hhbmdlZCA9IFxyXG4gICAgICAgIHRhc2suY29zdCAhPT0gcHJldmlvdXNUYXNrLmNvc3QgfHxcclxuICAgICAgICB0YXNrLnJldmVudWUgIT09IHByZXZpb3VzVGFzay5yZXZlbnVlIHx8XHJcbiAgICAgICAgdGFzay5pc05vdFBhaWQgIT09IHByZXZpb3VzVGFzay5pc05vdFBhaWQgfHxcclxuICAgICAgICB0YXNrLmlzTm90Q2hhcmdlZCAhPT0gcHJldmlvdXNUYXNrLmlzTm90Q2hhcmdlZCB8fFxyXG4gICAgICAgIHRhc2submFtZSAhPT0gcHJldmlvdXNUYXNrLm5hbWUgfHxcclxuICAgICAgICB0YXNrLnN0YXRpb24gIT09IHByZXZpb3VzVGFzay5zdGF0aW9uO1xyXG4gICAgICBcclxuICAgICAgaWYgKGZpbmFuY2lhbFByb3BzQ2hhbmdlZCkge1xyXG4gICAgICAgIGNvbnN0IHVwZGF0ZWRSZWNvcmQgPSB7XHJcbiAgICAgICAgICAuLi5yZWNvcmQsXHJcbiAgICAgICAgICBjb3N0OiB0YXNrLmNvc3QsXHJcbiAgICAgICAgICByZXZlbnVlOiB0YXNrLnJldmVudWUsXHJcbiAgICAgICAgICBpc05vdFBhaWQ6IHRhc2suaXNOb3RQYWlkLFxyXG4gICAgICAgICAgaXNOb3RDaGFyZ2VkOiB0YXNrLmlzTm90Q2hhcmdlZCxcclxuICAgICAgICAgIG5hbWU6IHRhc2submFtZSxcclxuICAgICAgICAgIHN0YXRpb246IHRhc2suc3RhdGlvbixcclxuICAgICAgICAgIHVwZGF0ZWRBdDogbmV3IERhdGUoKVxyXG4gICAgICAgIH07XHJcbiAgICAgICAgXHJcbiAgICAgICAgYXdhaXQgQ2xpZW50QVBJLnVwc2VydEZpbmFuY2lhbFJlY29yZCh1cGRhdGVkUmVjb3JkKTtcclxuICAgICAgICBhd2FpdCBtYXJrRWZmZWN0KHVwZGF0ZUtleSk7XHJcbiAgICAgICAgXHJcbiAgICAgICAgY29uc29sZS5sb2coYFt1cGRhdGVGaW5hbmNpYWxSZWNvcmRzRnJvbVRhc2tdIOKchSBVcGRhdGVkIGZpbmFuY2lhbCByZWNvcmQ6ICR7cmVjb3JkLmlkfWApO1xyXG4gICAgICB9XHJcbiAgICB9XHJcbiAgfSBjYXRjaCAoZXJyb3IpIHtcclxuICAgIGNvbnNvbGUuZXJyb3IoYFt1cGRhdGVGaW5hbmNpYWxSZWNvcmRzRnJvbVRhc2tdIEVycm9yIHVwZGF0aW5nIGZpbmFuY2lhbCByZWNvcmRzOmAsIGVycm9yKTtcclxuICB9XHJcbn1cclxuXHJcbi8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cclxuLy8gRklOQU5DSUFMIFJFQ09SRCDihpIgVEFTSyBQUk9QQUdBVElPTlxyXG4vLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XHJcblxyXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gdXBkYXRlVGFza3NGcm9tRmluYW5jaWFsUmVjb3JkKFxyXG4gIHJlY29yZDogRmluYW5jaWFsUmVjb3JkLFxyXG4gIHByZXZpb3VzUmVjb3JkOiBGaW5hbmNpYWxSZWNvcmRcclxuKTogUHJvbWlzZTx2b2lkPiB7XHJcbiAgdHJ5IHtcclxuICAgIGNvbnNvbGUubG9nKGBbdXBkYXRlVGFza3NGcm9tRmluYW5jaWFsUmVjb3JkXSBVcGRhdGluZyB0YXNrcyBmb3IgZmluYW5jaWFsIHJlY29yZDogJHtyZWNvcmQubmFtZX1gKTtcclxuICAgIFxyXG4gICAgLy8gRmluZCB0YXNrcyB0aGF0IGNyZWF0ZWQgdGhpcyBmaW5hbmNpYWwgcmVjb3JkXHJcbiAgICBjb25zdCBhbGxUYXNrcyA9IGF3YWl0IENsaWVudEFQSS5nZXRUYXNrcygpO1xyXG4gICAgY29uc3QgcmVsYXRlZFRhc2tzID0gYWxsVGFza3MuZmlsdGVyKHRhc2sgPT4gdGFzay5pZCA9PT0gcmVjb3JkLnNvdXJjZVRhc2tJZCk7XHJcbiAgICBcclxuICAgIGZvciAoY29uc3QgdGFzayBvZiByZWxhdGVkVGFza3MpIHtcclxuICAgICAgY29uc3QgdXBkYXRlS2V5ID0gYHVwZGF0ZVRhc2tGcm9tRmluYW5jaWFsOiR7cmVjb3JkLmlkfToke3Rhc2suaWR9OiR7cmVjb3JkLnVwZGF0ZWRBdD8uZ2V0VGltZSgpfWA7XHJcbiAgICAgIFxyXG4gICAgICBpZiAoYXdhaXQgaGFzRWZmZWN0KHVwZGF0ZUtleSkpIHtcclxuICAgICAgICBjb25zb2xlLmxvZyhgW3VwZGF0ZVRhc2tzRnJvbUZpbmFuY2lhbFJlY29yZF0g4o+t77iPIEFscmVhZHkgdXBkYXRlZCB0YXNrOiAke3Rhc2suaWR9YCk7XHJcbiAgICAgICAgY29udGludWU7XHJcbiAgICAgIH1cclxuICAgICAgXHJcbiAgICAgIC8vIENoZWNrIGlmIGZpbmFuY2lhbCBwcm9wZXJ0aWVzIGNoYW5nZWRcclxuICAgICAgY29uc3QgZmluYW5jaWFsUHJvcHNDaGFuZ2VkID0gXHJcbiAgICAgICAgcmVjb3JkLmNvc3QgIT09IHByZXZpb3VzUmVjb3JkLmNvc3QgfHxcclxuICAgICAgICByZWNvcmQucmV2ZW51ZSAhPT0gcHJldmlvdXNSZWNvcmQucmV2ZW51ZSB8fFxyXG4gICAgICAgIHJlY29yZC5pc05vdFBhaWQgIT09IHByZXZpb3VzUmVjb3JkLmlzTm90UGFpZCB8fFxyXG4gICAgICAgIHJlY29yZC5pc05vdENoYXJnZWQgIT09IHByZXZpb3VzUmVjb3JkLmlzTm90Q2hhcmdlZCB8fFxyXG4gICAgICAgIHJlY29yZC5uYW1lICE9PSBwcmV2aW91c1JlY29yZC5uYW1lIHx8XHJcbiAgICAgICAgcmVjb3JkLnN0YXRpb24gIT09IHByZXZpb3VzUmVjb3JkLnN0YXRpb247XHJcbiAgICAgIFxyXG4gICAgICBpZiAoZmluYW5jaWFsUHJvcHNDaGFuZ2VkKSB7XHJcbiAgICAgICAgY29uc3QgdXBkYXRlZFRhc2sgPSB7XHJcbiAgICAgICAgICAuLi50YXNrLFxyXG4gICAgICAgICAgY29zdDogcmVjb3JkLmNvc3QsXHJcbiAgICAgICAgICByZXZlbnVlOiByZWNvcmQucmV2ZW51ZSxcclxuICAgICAgICAgIGlzTm90UGFpZDogcmVjb3JkLmlzTm90UGFpZCxcclxuICAgICAgICAgIGlzTm90Q2hhcmdlZDogcmVjb3JkLmlzTm90Q2hhcmdlZCxcclxuICAgICAgICAgIG5hbWU6IHJlY29yZC5uYW1lLFxyXG4gICAgICAgICAgc3RhdGlvbjogcmVjb3JkLnN0YXRpb24sXHJcbiAgICAgICAgICB1cGRhdGVkQXQ6IG5ldyBEYXRlKClcclxuICAgICAgICB9O1xyXG4gICAgICAgIFxyXG4gICAgICAgIGF3YWl0IENsaWVudEFQSS51cHNlcnRUYXNrKHVwZGF0ZWRUYXNrKTtcclxuICAgICAgICBhd2FpdCBtYXJrRWZmZWN0KHVwZGF0ZUtleSk7XHJcbiAgICAgICAgXHJcbiAgICAgICAgY29uc29sZS5sb2coYFt1cGRhdGVUYXNrc0Zyb21GaW5hbmNpYWxSZWNvcmRdIOKchSBVcGRhdGVkIHRhc2s6ICR7dGFzay5pZH1gKTtcclxuICAgICAgfVxyXG4gICAgfVxyXG4gIH0gY2F0Y2ggKGVycm9yKSB7XHJcbiAgICBjb25zb2xlLmVycm9yKGBbdXBkYXRlVGFza3NGcm9tRmluYW5jaWFsUmVjb3JkXSBFcnJvciB1cGRhdGluZyB0YXNrczpgLCBlcnJvcik7XHJcbiAgfVxyXG59XHJcblxyXG4vLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XHJcbi8vIFRBU0sg4oaSIElURU0gUFJPUEFHQVRJT04gKEVuaGFuY2VkKVxyXG4vLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XHJcblxyXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gdXBkYXRlSXRlbXNDcmVhdGVkQnlUYXNrKFxyXG4gIHRhc2s6IFRhc2ssXHJcbiAgcHJldmlvdXNUYXNrOiBUYXNrXHJcbik6IFByb21pc2U8dm9pZD4ge1xyXG4gIHRyeSB7XHJcbiAgICBjb25zb2xlLmxvZyhgW3VwZGF0ZUl0ZW1zQ3JlYXRlZEJ5VGFza10gVXBkYXRpbmcgaXRlbXMgZm9yIHRhc2s6ICR7dGFzay5uYW1lfWApO1xyXG4gICAgXHJcbiAgICAvLyBGaW5kIGl0ZW1zIGNyZWF0ZWQgZnJvbSB0aGlzIHRhc2tcclxuICAgIGNvbnN0IGFsbEl0ZW1zID0gYXdhaXQgQ2xpZW50QVBJLmdldEl0ZW1zKCk7XHJcbiAgICBjb25zdCByZWxhdGVkSXRlbXMgPSBhbGxJdGVtcy5maWx0ZXIoaXRlbSA9PiBpdGVtLnNvdXJjZVRhc2tJZCA9PT0gdGFzay5pZCk7XHJcbiAgICBcclxuICAgIGZvciAoY29uc3QgaXRlbSBvZiByZWxhdGVkSXRlbXMpIHtcclxuICAgICAgY29uc3QgdXBkYXRlS2V5ID0gYHVwZGF0ZUl0ZW1Gcm9tVGFzazoke3Rhc2suaWR9OiR7aXRlbS5pZH06JHt0YXNrLnVwZGF0ZWRBdD8uZ2V0VGltZSgpfWA7XHJcbiAgICAgIFxyXG4gICAgICBpZiAoYXdhaXQgaGFzRWZmZWN0KHVwZGF0ZUtleSkpIHtcclxuICAgICAgICBjb25zb2xlLmxvZyhgW3VwZGF0ZUl0ZW1zQ3JlYXRlZEJ5VGFza10g4o+t77iPIEFscmVhZHkgdXBkYXRlZCBpdGVtOiAke2l0ZW0uaWR9YCk7XHJcbiAgICAgICAgY29udGludWU7XHJcbiAgICAgIH1cclxuICAgICAgXHJcbiAgICAgIC8vIENoZWNrIGlmIG91dHB1dCBwcm9wZXJ0aWVzIGNoYW5nZWRcclxuICAgICAgY29uc3Qgb3V0cHV0UHJvcHNDaGFuZ2VkID0gXHJcbiAgICAgICAgdGFzay5vdXRwdXRRdWFudGl0eSAhPT0gcHJldmlvdXNUYXNrLm91dHB1dFF1YW50aXR5IHx8XHJcbiAgICAgICAgdGFzay5vdXRwdXRJdGVtTmFtZSAhPT0gcHJldmlvdXNUYXNrLm91dHB1dEl0ZW1OYW1lIHx8XHJcbiAgICAgICAgdGFzay5vdXRwdXRVbml0Q29zdCAhPT0gcHJldmlvdXNUYXNrLm91dHB1dFVuaXRDb3N0IHx8XHJcbiAgICAgICAgdGFzay5vdXRwdXRJdGVtUHJpY2UgIT09IHByZXZpb3VzVGFzay5vdXRwdXRJdGVtUHJpY2UgfHxcclxuICAgICAgICB0YXNrLnN0YXRpb24gIT09IHByZXZpb3VzVGFzay5zdGF0aW9uO1xyXG4gICAgICBcclxuICAgICAgaWYgKG91dHB1dFByb3BzQ2hhbmdlZCkge1xyXG4gICAgICAgIGNvbnN0IHVwZGF0ZWRJdGVtID0ge1xyXG4gICAgICAgICAgLi4uaXRlbSxcclxuICAgICAgICAgIG5hbWU6IHRhc2sub3V0cHV0SXRlbU5hbWUgfHwgaXRlbS5uYW1lLFxyXG4gICAgICAgICAgdW5pdENvc3Q6IHRhc2sub3V0cHV0VW5pdENvc3QgfHwgaXRlbS51bml0Q29zdCxcclxuICAgICAgICAgIHByaWNlOiB0YXNrLm91dHB1dEl0ZW1QcmljZSB8fCBpdGVtLnByaWNlLFxyXG4gICAgICAgICAgc3RhdGlvbjogdGFzay5zdGF0aW9uIHx8IGl0ZW0uc3RhdGlvbixcclxuICAgICAgICAgIHVwZGF0ZWRBdDogbmV3IERhdGUoKVxyXG4gICAgICAgIH07XHJcbiAgICAgICAgXHJcbiAgICAgICAgLy8gVXBkYXRlIHN0b2NrIHF1YW50aXR5IGlmIGl0IGNoYW5nZWRcclxuICAgICAgICBpZiAodGFzay5vdXRwdXRRdWFudGl0eSAhPT0gcHJldmlvdXNUYXNrLm91dHB1dFF1YW50aXR5KSB7XHJcbiAgICAgICAgICBjb25zdCBxdWFudGl0eURpZmYgPSAodGFzay5vdXRwdXRRdWFudGl0eSB8fCAwKSAtIChwcmV2aW91c1Rhc2sub3V0cHV0UXVhbnRpdHkgfHwgMCk7XHJcbiAgICAgICAgICBpZiAocXVhbnRpdHlEaWZmICE9PSAwKSB7XHJcbiAgICAgICAgICAgIC8vIFVwZGF0ZSB0aGUgZmlyc3Qgc3RvY2sgcG9pbnQgKG9yIGNyZWF0ZSBvbmUgaWYgbm9uZSBleGlzdHMpXHJcbiAgICAgICAgICAgIGlmICh1cGRhdGVkSXRlbS5zdG9jayAmJiB1cGRhdGVkSXRlbS5zdG9jay5sZW5ndGggPiAwKSB7XHJcbiAgICAgICAgICAgICAgdXBkYXRlZEl0ZW0uc3RvY2tbMF0ucXVhbnRpdHkgKz0gcXVhbnRpdHlEaWZmO1xyXG4gICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICB1cGRhdGVkSXRlbS5zdG9jayA9IFt7XHJcbiAgICAgICAgICAgICAgc2l0ZUlkOiB0YXNrLnNpdGVJZCB8fCAnZGVmYXVsdCcsXHJcbiAgICAgICAgICAgICAgcXVhbnRpdHk6IHF1YW50aXR5RGlmZlxyXG4gICAgICAgICAgICB9XTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICBcclxuICAgICAgICBhd2FpdCBDbGllbnRBUEkudXBzZXJ0SXRlbSh1cGRhdGVkSXRlbSk7XHJcbiAgICAgICAgYXdhaXQgbWFya0VmZmVjdCh1cGRhdGVLZXkpO1xyXG4gICAgICAgIFxyXG4gICAgICAgIGNvbnNvbGUubG9nKGBbdXBkYXRlSXRlbXNDcmVhdGVkQnlUYXNrXSDinIUgVXBkYXRlZCBpdGVtOiAke2l0ZW0uaWR9YCk7XHJcbiAgICAgIH1cclxuICAgIH1cclxuICB9IGNhdGNoIChlcnJvcikge1xyXG4gICAgY29uc29sZS5lcnJvcihgW3VwZGF0ZUl0ZW1zQ3JlYXRlZEJ5VGFza10gRXJyb3IgdXBkYXRpbmcgaXRlbXM6YCwgZXJyb3IpO1xyXG4gIH1cclxufVxyXG5cclxuLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxyXG4vLyBGSU5BTkNJQUwgUkVDT1JEIOKGkiBJVEVNIFBST1BBR0FUSU9OIChFbmhhbmNlZClcclxuLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIHVwZGF0ZUl0ZW1zQ3JlYXRlZEJ5UmVjb3JkKFxyXG4gIHJlY29yZDogRmluYW5jaWFsUmVjb3JkLFxyXG4gIHByZXZpb3VzUmVjb3JkOiBGaW5hbmNpYWxSZWNvcmRcclxuKTogUHJvbWlzZTx2b2lkPiB7XHJcbiAgdHJ5IHtcclxuICAgIGNvbnNvbGUubG9nKGBbdXBkYXRlSXRlbXNDcmVhdGVkQnlSZWNvcmRdIFVwZGF0aW5nIGl0ZW1zIGZvciBmaW5hbmNpYWwgcmVjb3JkOiAke3JlY29yZC5uYW1lfWApO1xyXG4gICAgXHJcbiAgICAvLyBGaW5kIGl0ZW1zIGNyZWF0ZWQgZnJvbSB0aGlzIGZpbmFuY2lhbCByZWNvcmRcclxuICAgIGNvbnN0IGFsbEl0ZW1zID0gYXdhaXQgQ2xpZW50QVBJLmdldEl0ZW1zKCk7XHJcbiAgICBjb25zdCByZWxhdGVkSXRlbXMgPSBhbGxJdGVtcy5maWx0ZXIoaXRlbSA9PiBpdGVtLnNvdXJjZVJlY29yZElkID09PSByZWNvcmQuaWQpO1xyXG4gICAgXHJcbiAgICBmb3IgKGNvbnN0IGl0ZW0gb2YgcmVsYXRlZEl0ZW1zKSB7XHJcbiAgICAgIGNvbnN0IHVwZGF0ZUtleSA9IGB1cGRhdGVJdGVtRnJvbVJlY29yZDoke3JlY29yZC5pZH06JHtpdGVtLmlkfToke3JlY29yZC51cGRhdGVkQXQ/LmdldFRpbWUoKX1gO1xyXG4gICAgICBcclxuICAgICAgaWYgKGF3YWl0IGhhc0VmZmVjdCh1cGRhdGVLZXkpKSB7XHJcbiAgICAgICAgY29uc29sZS5sb2coYFt1cGRhdGVJdGVtc0NyZWF0ZWRCeVJlY29yZF0g4o+t77iPIEFscmVhZHkgdXBkYXRlZCBpdGVtOiAke2l0ZW0uaWR9YCk7XHJcbiAgICAgICAgY29udGludWU7XHJcbiAgICAgIH1cclxuICAgICAgXHJcbiAgICAgIC8vIENoZWNrIGlmIG91dHB1dCBwcm9wZXJ0aWVzIGNoYW5nZWRcclxuICAgICAgY29uc3Qgb3V0cHV0UHJvcHNDaGFuZ2VkID0gXHJcbiAgICAgICAgcmVjb3JkLm91dHB1dFF1YW50aXR5ICE9PSBwcmV2aW91c1JlY29yZC5vdXRwdXRRdWFudGl0eSB8fFxyXG4gICAgICAgIHJlY29yZC5vdXRwdXRJdGVtTmFtZSAhPT0gcHJldmlvdXNSZWNvcmQub3V0cHV0SXRlbU5hbWUgfHxcclxuICAgICAgICByZWNvcmQub3V0cHV0VW5pdENvc3QgIT09IHByZXZpb3VzUmVjb3JkLm91dHB1dFVuaXRDb3N0IHx8XHJcbiAgICAgICAgcmVjb3JkLm91dHB1dEl0ZW1QcmljZSAhPT0gcHJldmlvdXNSZWNvcmQub3V0cHV0SXRlbVByaWNlIHx8XHJcbiAgICAgICAgcmVjb3JkLnN0YXRpb24gIT09IHByZXZpb3VzUmVjb3JkLnN0YXRpb247XHJcbiAgICAgIFxyXG4gICAgICBpZiAob3V0cHV0UHJvcHNDaGFuZ2VkKSB7XHJcbiAgICAgICAgY29uc3QgdXBkYXRlZEl0ZW0gPSB7XHJcbiAgICAgICAgICAuLi5pdGVtLFxyXG4gICAgICAgICAgbmFtZTogcmVjb3JkLm91dHB1dEl0ZW1OYW1lIHx8IGl0ZW0ubmFtZSxcclxuICAgICAgICAgIHVuaXRDb3N0OiByZWNvcmQub3V0cHV0VW5pdENvc3QgfHwgaXRlbS51bml0Q29zdCxcclxuICAgICAgICAgIHByaWNlOiByZWNvcmQub3V0cHV0SXRlbVByaWNlIHx8IGl0ZW0ucHJpY2UsXHJcbiAgICAgICAgICBzdGF0aW9uOiByZWNvcmQuc3RhdGlvbiB8fCBpdGVtLnN0YXRpb24sXHJcbiAgICAgICAgICB1cGRhdGVkQXQ6IG5ldyBEYXRlKClcclxuICAgICAgICB9O1xyXG4gICAgICAgIFxyXG4gICAgICAgIC8vIFVwZGF0ZSBzdG9jayBxdWFudGl0eSBpZiBpdCBjaGFuZ2VkXHJcbiAgICAgICAgaWYgKHJlY29yZC5vdXRwdXRRdWFudGl0eSAhPT0gcHJldmlvdXNSZWNvcmQub3V0cHV0UXVhbnRpdHkpIHtcclxuICAgICAgICAgIGNvbnN0IHF1YW50aXR5RGlmZiA9IChyZWNvcmQub3V0cHV0UXVhbnRpdHkgfHwgMCkgLSAocHJldmlvdXNSZWNvcmQub3V0cHV0UXVhbnRpdHkgfHwgMCk7XHJcbiAgICAgICAgICBpZiAocXVhbnRpdHlEaWZmICE9PSAwKSB7XHJcbiAgICAgICAgICAgIC8vIFVwZGF0ZSB0aGUgZmlyc3Qgc3RvY2sgcG9pbnQgKG9yIGNyZWF0ZSBvbmUgaWYgbm9uZSBleGlzdHMpXHJcbiAgICAgICAgICAgIGlmICh1cGRhdGVkSXRlbS5zdG9jayAmJiB1cGRhdGVkSXRlbS5zdG9jay5sZW5ndGggPiAwKSB7XHJcbiAgICAgICAgICAgICAgdXBkYXRlZEl0ZW0uc3RvY2tbMF0ucXVhbnRpdHkgKz0gcXVhbnRpdHlEaWZmO1xyXG4gICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgIHVwZGF0ZWRJdGVtLnN0b2NrID0gW3tcclxuICAgICAgICAgICAgICAgIHNpdGVJZDogcmVjb3JkLnNpdGVJZCB8fCAnZGVmYXVsdCcsXHJcbiAgICAgICAgICAgICAgICBxdWFudGl0eTogcXVhbnRpdHlEaWZmXHJcbiAgICAgICAgICAgICAgfV07XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICAgXHJcbiAgICAgICAgYXdhaXQgQ2xpZW50QVBJLnVwc2VydEl0ZW0odXBkYXRlZEl0ZW0pO1xyXG4gICAgICAgIGF3YWl0IG1hcmtFZmZlY3QodXBkYXRlS2V5KTtcclxuICAgICAgICBcclxuICAgICAgICBjb25zb2xlLmxvZyhgW3VwZGF0ZUl0ZW1zQ3JlYXRlZEJ5UmVjb3JkXSDinIUgVXBkYXRlZCBpdGVtOiAke2l0ZW0uaWR9YCk7XHJcbiAgICAgIH1cclxuICAgIH1cclxuICB9IGNhdGNoIChlcnJvcikge1xyXG4gICAgY29uc29sZS5lcnJvcihgW3VwZGF0ZUl0ZW1zQ3JlYXRlZEJ5UmVjb3JkXSBFcnJvciB1cGRhdGluZyBpdGVtczpgLCBlcnJvcik7XHJcbiAgfVxyXG59XHJcblxyXG4vLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XHJcbi8vIFNBTEUg4oaSIEZJTkFOQ0lBTCBSRUNPUkQgUFJPUEFHQVRJT05cclxuLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIHVwZGF0ZUZpbmFuY2lhbFJlY29yZHNGcm9tU2FsZShcclxuICBzYWxlOiBTYWxlLFxyXG4gIHByZXZpb3VzU2FsZTogU2FsZVxyXG4pOiBQcm9taXNlPHZvaWQ+IHtcclxuICB0cnkge1xyXG4gICAgY29uc29sZS5sb2coYFt1cGRhdGVGaW5hbmNpYWxSZWNvcmRzRnJvbVNhbGVdIFVwZGF0aW5nIGZpbmFuY2lhbCByZWNvcmRzIGZvciBzYWxlOiAke3NhbGUubmFtZX1gKTtcclxuICAgIFxyXG4gICAgLy8gRmluZCBmaW5hbmNpYWwgcmVjb3JkcyBjcmVhdGVkIGZyb20gdGhpcyBzYWxlXHJcbiAgICBjb25zdCBhbGxGaW5hbmNpYWxzID0gYXdhaXQgQ2xpZW50QVBJLmdldEZpbmFuY2lhbFJlY29yZHMoKTtcclxuICAgIGNvbnN0IHJlbGF0ZWRSZWNvcmRzID0gYWxsRmluYW5jaWFscy5maWx0ZXIocmVjb3JkID0+IHJlY29yZC5zb3VyY2VTYWxlSWQgPT09IHNhbGUuaWQpO1xyXG4gICAgXHJcbiAgICBmb3IgKGNvbnN0IHJlY29yZCBvZiByZWxhdGVkUmVjb3Jkcykge1xyXG4gICAgICBjb25zdCB1cGRhdGVLZXkgPSBgdXBkYXRlRmluYW5jaWFsRnJvbVNhbGU6JHtzYWxlLmlkfToke3JlY29yZC5pZH06JHtzYWxlLnVwZGF0ZWRBdD8uZ2V0VGltZSgpfWA7XHJcbiAgICAgIFxyXG4gICAgICBpZiAoYXdhaXQgaGFzRWZmZWN0KHVwZGF0ZUtleSkpIHtcclxuICAgICAgICBjb25zb2xlLmxvZyhgW3VwZGF0ZUZpbmFuY2lhbFJlY29yZHNGcm9tU2FsZV0g4o+t77iPIEFscmVhZHkgdXBkYXRlZCByZWNvcmQ6ICR7cmVjb3JkLmlkfWApO1xyXG4gICAgICAgIGNvbnRpbnVlO1xyXG4gICAgICB9XHJcbiAgICAgIFxyXG4gICAgICAvLyBDaGVjayBpZiByZXZlbnVlIHByb3BlcnRpZXMgY2hhbmdlZFxyXG4gICAgICBjb25zdCByZXZlbnVlUHJvcHNDaGFuZ2VkID0gXHJcbiAgICAgICAgc2FsZS50b3RhbHM/LnRvdGFsUmV2ZW51ZSAhPT0gcHJldmlvdXNTYWxlLnRvdGFscz8udG90YWxSZXZlbnVlIHx8XHJcbiAgICAgICAgc2FsZS5pc05vdFBhaWQgIT09IHByZXZpb3VzU2FsZS5pc05vdFBhaWQgfHxcclxuICAgICAgICBzYWxlLnN0YXR1cyAhPT0gcHJldmlvdXNTYWxlLnN0YXR1cztcclxuICAgICAgXHJcbiAgICAgIGlmIChyZXZlbnVlUHJvcHNDaGFuZ2VkKSB7XHJcbiAgICAgICAgY29uc3QgdXBkYXRlZFJlY29yZCA9IHtcclxuICAgICAgICAgIC4uLnJlY29yZCxcclxuICAgICAgICAgIHJldmVudWU6IHNhbGUudG90YWxzPy50b3RhbFJldmVudWUgfHwgMCxcclxuICAgICAgICAgIGlzTm90UGFpZDogc2FsZS5pc05vdFBhaWQsXHJcbiAgICAgICAgICBpc05vdENoYXJnZWQ6IHNhbGUuc3RhdHVzICE9PSAnQ0hBUkdFRCcsXHJcbiAgICAgICAgICB1cGRhdGVkQXQ6IG5ldyBEYXRlKClcclxuICAgICAgICB9O1xyXG4gICAgICAgIFxyXG4gICAgICAgIGF3YWl0IENsaWVudEFQSS51cHNlcnRGaW5hbmNpYWxSZWNvcmQodXBkYXRlZFJlY29yZCk7XHJcbiAgICAgICAgYXdhaXQgbWFya0VmZmVjdCh1cGRhdGVLZXkpO1xyXG4gICAgICAgIFxyXG4gICAgICAgIGNvbnNvbGUubG9nKGBbdXBkYXRlRmluYW5jaWFsUmVjb3Jkc0Zyb21TYWxlXSDinIUgVXBkYXRlZCBmaW5hbmNpYWwgcmVjb3JkOiAke3JlY29yZC5pZH1gKTtcclxuICAgICAgfVxyXG4gICAgfVxyXG4gIH0gY2F0Y2ggKGVycm9yKSB7XHJcbiAgICBjb25zb2xlLmVycm9yKGBbdXBkYXRlRmluYW5jaWFsUmVjb3Jkc0Zyb21TYWxlXSBFcnJvciB1cGRhdGluZyBmaW5hbmNpYWwgcmVjb3JkczpgLCBlcnJvcik7XHJcbiAgfVxyXG59XHJcblxyXG4vLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XHJcbi8vIFNBTEUg4oaSIElURU0gUFJPUEFHQVRJT04gKFN0b2NrIFVwZGF0ZXMpXHJcbi8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cclxuXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiB1cGRhdGVJdGVtc0Zyb21TYWxlKFxyXG4gIHNhbGU6IFNhbGUsXHJcbiAgcHJldmlvdXNTYWxlOiBTYWxlXHJcbik6IFByb21pc2U8dm9pZD4ge1xyXG4gIHRyeSB7XHJcbiAgICBjb25zb2xlLmxvZyhgW3VwZGF0ZUl0ZW1zRnJvbVNhbGVdIFVwZGF0aW5nIGl0ZW1zIGZvciBzYWxlOiAke3NhbGUubmFtZX1gKTtcclxuICAgIFxyXG4gICAgLy8gQ2hlY2sgaWYgc2FsZSBsaW5lcyBjaGFuZ2VkXHJcbiAgICBjb25zdCBsaW5lc0NoYW5nZWQgPSBcclxuICAgICAgc2FsZS5saW5lcz8ubGVuZ3RoICE9PSBwcmV2aW91c1NhbGUubGluZXM/Lmxlbmd0aCB8fFxyXG4gICAgICBKU09OLnN0cmluZ2lmeShzYWxlLmxpbmVzKSAhPT0gSlNPTi5zdHJpbmdpZnkocHJldmlvdXNTYWxlLmxpbmVzKTtcclxuICAgIFxyXG4gICAgaWYgKCFsaW5lc0NoYW5nZWQpIHtcclxuICAgICAgY29uc29sZS5sb2coYFt1cGRhdGVJdGVtc0Zyb21TYWxlXSBObyBsaW5lIGNoYW5nZXMgZGV0ZWN0ZWRgKTtcclxuICAgICAgcmV0dXJuO1xyXG4gICAgfVxyXG4gICAgXHJcbiAgICAvLyBQcm9jZXNzIGVhY2ggc2FsZSBsaW5lXHJcbiAgICBmb3IgKGNvbnN0IGxpbmUgb2Ygc2FsZS5saW5lcyB8fCBbXSkge1xyXG4gICAgICBpZiAobGluZS5raW5kID09PSAnaXRlbScgJiYgJ2l0ZW1JZCcgaW4gbGluZSAmJiBsaW5lLml0ZW1JZCkge1xyXG4gICAgICAgIGNvbnN0IHVwZGF0ZUtleSA9IGB1cGRhdGVJdGVtRnJvbVNhbGU6JHtzYWxlLmlkfToke2xpbmUuaXRlbUlkfToke3NhbGUudXBkYXRlZEF0Py5nZXRUaW1lKCl9YDtcclxuICAgICAgICBcclxuICAgICAgICBpZiAoYXdhaXQgaGFzRWZmZWN0KHVwZGF0ZUtleSkpIHtcclxuICAgICAgICAgIGNvbnNvbGUubG9nKGBbdXBkYXRlSXRlbXNGcm9tU2FsZV0g4o+t77iPIEFscmVhZHkgdXBkYXRlZCBpdGVtOiAke2xpbmUuaXRlbUlkfWApO1xyXG4gICAgICAgICAgY29udGludWU7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIFxyXG4gICAgICAgIC8vIEdldCB0aGUgaXRlbVxyXG4gICAgICAgIGNvbnN0IGl0ZW0gPSBhd2FpdCBDbGllbnRBUEkuZ2V0SXRlbUJ5SWQobGluZS5pdGVtSWQpO1xyXG4gICAgICAgIGlmICghaXRlbSkge1xyXG4gICAgICAgICAgY29uc29sZS53YXJuKGBbdXBkYXRlSXRlbXNGcm9tU2FsZV0gSXRlbSBub3QgZm91bmQ6ICR7bGluZS5pdGVtSWR9YCk7XHJcbiAgICAgICAgICBjb250aW51ZTtcclxuICAgICAgICB9XHJcbiAgICAgICAgXHJcbiAgICAgICAgLy8gVXBkYXRlIHF1YW50aXR5IHNvbGRcclxuICAgICAgICBjb25zdCB1cGRhdGVkSXRlbSA9IHtcclxuICAgICAgICAgIC4uLml0ZW0sXHJcbiAgICAgICAgICBxdWFudGl0eVNvbGQ6IChpdGVtLnF1YW50aXR5U29sZCB8fCAwKSArIChsaW5lLnF1YW50aXR5IHx8IDApLFxyXG4gICAgICAgICAgdXBkYXRlZEF0OiBuZXcgRGF0ZSgpXHJcbiAgICAgICAgfTtcclxuICAgICAgICBcclxuICAgICAgICBhd2FpdCBDbGllbnRBUEkudXBzZXJ0SXRlbSh1cGRhdGVkSXRlbSk7XHJcbiAgICAgICAgYXdhaXQgbWFya0VmZmVjdCh1cGRhdGVLZXkpO1xyXG4gICAgICAgIFxyXG4gICAgICAgIGNvbnNvbGUubG9nKGBbdXBkYXRlSXRlbXNGcm9tU2FsZV0g4pyFIFVwZGF0ZWQgaXRlbTogJHtsaW5lLml0ZW1JZH1gKTtcclxuICAgICAgfVxyXG4gICAgfVxyXG4gIH0gY2F0Y2ggKGVycm9yKSB7XHJcbiAgICBjb25zb2xlLmVycm9yKGBbdXBkYXRlSXRlbXNGcm9tU2FsZV0gRXJyb3IgdXBkYXRpbmcgaXRlbXM6YCwgZXJyb3IpO1xyXG4gIH1cclxufVxyXG5cclxuLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxyXG4vLyBUQVNLL0ZJTkFOQ0lBTC9TQUxFIOKGkiBQTEFZRVIgUFJPUEFHQVRJT04gKFBvaW50cyBEZWx0YSlcclxuLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIHVwZGF0ZVBsYXllclBvaW50c0Zyb21Tb3VyY2UoXHJcbiAgc291cmNlVHlwZTogJ3Rhc2snIHwgJ2ZpbmFuY2lhbCcgfCAnc2FsZScsXHJcbiAgbmV3U291cmNlOiBhbnksXHJcbiAgb2xkU291cmNlOiBhbnlcclxuKTogUHJvbWlzZTx2b2lkPiB7XHJcbiAgdHJ5IHtcclxuICAgIGNvbnNvbGUubG9nKGBbdXBkYXRlUGxheWVyUG9pbnRzRnJvbVNvdXJjZV0gVXBkYXRpbmcgcGxheWVyIHBvaW50cyBmcm9tICR7c291cmNlVHlwZX06ICR7bmV3U291cmNlLm5hbWV9YCk7XHJcbiAgICBcclxuICAgIC8vIENhbGN1bGF0ZSBwb2ludHMgZGVsdGFcclxuICAgIGxldCBwb2ludHNEZWx0YSA9IHsgeHA6IDAsIHJwOiAwLCBmcDogMCwgaHA6IDAgfTtcclxuICAgIFxyXG4gICAgaWYgKHNvdXJjZVR5cGUgPT09ICd0YXNrJyB8fCBzb3VyY2VUeXBlID09PSAnZmluYW5jaWFsJykge1xyXG4gICAgICBjb25zdCBuZXdQb2ludHMgPSBuZXdTb3VyY2UucmV3YXJkcz8ucG9pbnRzIHx8IHsgeHA6IDAsIHJwOiAwLCBmcDogMCwgaHA6IDAgfTtcclxuICAgICAgY29uc3Qgb2xkUG9pbnRzID0gb2xkU291cmNlLnJld2FyZHM/LnBvaW50cyB8fCB7IHhwOiAwLCBycDogMCwgZnA6IDAsIGhwOiAwIH07XHJcbiAgICAgIFxyXG4gICAgICBwb2ludHNEZWx0YSA9IHtcclxuICAgICAgICB4cDogKG5ld1BvaW50cy54cCB8fCAwKSAtIChvbGRQb2ludHMueHAgfHwgMCksXHJcbiAgICAgICAgcnA6IChuZXdQb2ludHMucnAgfHwgMCkgLSAob2xkUG9pbnRzLnJwIHx8IDApLFxyXG4gICAgICAgIGZwOiAobmV3UG9pbnRzLmZwIHx8IDApIC0gKG9sZFBvaW50cy5mcCB8fCAwKSxcclxuICAgICAgICBocDogKG5ld1BvaW50cy5ocCB8fCAwKSAtIChvbGRQb2ludHMuaHAgfHwgMClcclxuICAgICAgfTtcclxuICAgIH0gZWxzZSBpZiAoc291cmNlVHlwZSA9PT0gJ3NhbGUnKSB7XHJcbiAgICAgIC8vIENhbGN1bGF0ZSBwb2ludHMgZnJvbSByZXZlbnVlIChzaW1wbGlmaWVkKVxyXG4gICAgICBjb25zdCBuZXdSZXZlbnVlID0gbmV3U291cmNlLnRvdGFscz8udG90YWxSZXZlbnVlIHx8IDA7XHJcbiAgICAgIGNvbnN0IG9sZFJldmVudWUgPSBvbGRTb3VyY2UudG90YWxzPy50b3RhbFJldmVudWUgfHwgMDtcclxuICAgICAgY29uc3QgcmV2ZW51ZURlbHRhID0gbmV3UmV2ZW51ZSAtIG9sZFJldmVudWU7XHJcbiAgICAgIFxyXG4gICAgICAvLyBDb252ZXJ0IHJldmVudWUgdG8gcG9pbnRzIChzaW1wbGlmaWVkIGNhbGN1bGF0aW9uKVxyXG4gICAgICBwb2ludHNEZWx0YSA9IHtcclxuICAgICAgICB4cDogTWF0aC5mbG9vcihyZXZlbnVlRGVsdGEgKiAwLjEpLFxyXG4gICAgICAgIHJwOiBNYXRoLmZsb29yKHJldmVudWVEZWx0YSAqIDAuMDUpLFxyXG4gICAgICAgIGZwOiBNYXRoLmZsb29yKHJldmVudWVEZWx0YSAqIDAuMDMpLFxyXG4gICAgICAgIGhwOiBNYXRoLmZsb29yKHJldmVudWVEZWx0YSAqIDAuMDIpXHJcbiAgICAgIH07XHJcbiAgICB9XHJcbiAgICBcclxuICAgIC8vIFNraXAgaWYgbm8gcG9pbnRzIGNoYW5nZVxyXG4gICAgaWYgKHBvaW50c0RlbHRhLnhwID09PSAwICYmIHBvaW50c0RlbHRhLnJwID09PSAwICYmIHBvaW50c0RlbHRhLmZwID09PSAwICYmIHBvaW50c0RlbHRhLmhwID09PSAwKSB7XHJcbiAgICAgIGNvbnNvbGUubG9nKGBbdXBkYXRlUGxheWVyUG9pbnRzRnJvbVNvdXJjZV0gTm8gcG9pbnRzIGNoYW5nZSBkZXRlY3RlZGApO1xyXG4gICAgICByZXR1cm47XHJcbiAgICB9XHJcbiAgICBcclxuICAgIC8vIEZpbmQgdGhlIHBsYXllciAoYXNzdW1pbmcgc2luZ2xlIHBsYXllciBmb3Igbm93KVxyXG4gICAgY29uc3QgcGxheWVycyA9IGF3YWl0IENsaWVudEFQSS5nZXRQbGF5ZXJzKCk7XHJcbiAgICBjb25zdCBwbGF5ZXIgPSBwbGF5ZXJzWzBdOyAvLyBTaW1wbGlmaWVkIC0gaW4gcmVhbCBzeXN0ZW0sIGZpbmQgYnkgc291cmNlIHJlbGF0aW9uc2hpcFxyXG4gICAgXHJcbiAgICBpZiAoIXBsYXllcikge1xyXG4gICAgICBjb25zb2xlLndhcm4oYFt1cGRhdGVQbGF5ZXJQb2ludHNGcm9tU291cmNlXSBObyBwbGF5ZXIgZm91bmRgKTtcclxuICAgICAgcmV0dXJuO1xyXG4gICAgfVxyXG4gICAgXHJcbiAgICBjb25zdCB1cGRhdGVLZXkgPSBgdXBkYXRlUGxheWVyUG9pbnRzOiR7c291cmNlVHlwZX06JHtuZXdTb3VyY2UuaWR9OiR7cGxheWVyLmlkfToke25ld1NvdXJjZS51cGRhdGVkQXQ/LmdldFRpbWUoKX1gO1xyXG4gICAgXHJcbiAgICBpZiAoYXdhaXQgaGFzRWZmZWN0KHVwZGF0ZUtleSkpIHtcclxuICAgICAgY29uc29sZS5sb2coYFt1cGRhdGVQbGF5ZXJQb2ludHNGcm9tU291cmNlXSDij63vuI8gQWxyZWFkeSB1cGRhdGVkIHBsYXllcjogJHtwbGF5ZXIuaWR9YCk7XHJcbiAgICAgIHJldHVybjtcclxuICAgIH1cclxuICAgIFxyXG4gICAgLy8gVXBkYXRlIHBsYXllciBwb2ludHNcclxuICAgIGNvbnN0IHVwZGF0ZWRQbGF5ZXIgPSB7XHJcbiAgICAgIC4uLnBsYXllcixcclxuICAgICAgcG9pbnRzOiB7XHJcbiAgICAgICAgeHA6IChwbGF5ZXIucG9pbnRzPy54cCB8fCAwKSArIHBvaW50c0RlbHRhLnhwLFxyXG4gICAgICAgIHJwOiAocGxheWVyLnBvaW50cz8ucnAgfHwgMCkgKyBwb2ludHNEZWx0YS5ycCxcclxuICAgICAgICBmcDogKHBsYXllci5wb2ludHM/LmZwIHx8IDApICsgcG9pbnRzRGVsdGEuZnAsXHJcbiAgICAgICAgaHA6IChwbGF5ZXIucG9pbnRzPy5ocCB8fCAwKSArIHBvaW50c0RlbHRhLmhwXHJcbiAgICAgIH0sXHJcbiAgICAgIHVwZGF0ZWRBdDogbmV3IERhdGUoKVxyXG4gICAgfTtcclxuICAgIFxyXG4gICAgYXdhaXQgQ2xpZW50QVBJLnVwc2VydFBsYXllcih1cGRhdGVkUGxheWVyKTtcclxuICAgIGF3YWl0IG1hcmtFZmZlY3QodXBkYXRlS2V5KTtcclxuICAgIFxyXG4gICAgY29uc29sZS5sb2coYFt1cGRhdGVQbGF5ZXJQb2ludHNGcm9tU291cmNlXSDinIUgVXBkYXRlZCBwbGF5ZXIgcG9pbnRzOiAke3BsYXllci5pZH1gKTtcclxuICB9IGNhdGNoIChlcnJvcikge1xyXG4gICAgY29uc29sZS5lcnJvcihgW3VwZGF0ZVBsYXllclBvaW50c0Zyb21Tb3VyY2VdIEVycm9yIHVwZGF0aW5nIHBsYXllciBwb2ludHM6YCwgZXJyb3IpO1xyXG4gIH1cclxufVxyXG5cclxuLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxyXG4vLyBGSU5BTkNJQUwg4oaSIENIQVJBQ1RFUiBQUk9QQUdBVElPTiAoSnVuZ2xlIENvaW5zIERlbHRhKVxyXG4vLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XHJcblxyXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gdXBkYXRlQ2hhcmFjdGVySnVuZ2xlQ29pbnNGcm9tUmVjb3JkKFxyXG4gIHJlY29yZDogRmluYW5jaWFsUmVjb3JkLFxyXG4gIHByZXZpb3VzUmVjb3JkOiBGaW5hbmNpYWxSZWNvcmRcclxuKTogUHJvbWlzZTx2b2lkPiB7XHJcbiAgdHJ5IHtcclxuICAgIGNvbnNvbGUubG9nKGBbdXBkYXRlQ2hhcmFjdGVySnVuZ2xlQ29pbnNGcm9tUmVjb3JkXSBVcGRhdGluZyBjaGFyYWN0ZXIganVuZ2xlIGNvaW5zIGZvciByZWNvcmQ6ICR7cmVjb3JkLm5hbWV9YCk7XHJcbiAgICBcclxuICAgIC8vIENhbGN1bGF0ZSBqdW5nbGUgY29pbnMgZGVsdGFcclxuICAgIGNvbnN0IG5ld0p1bmdsZUNvaW5zID0gcmVjb3JkLmp1bmdsZUNvaW5zIHx8IDA7XHJcbiAgICBjb25zdCBvbGRKdW5nbGVDb2lucyA9IHByZXZpb3VzUmVjb3JkLmp1bmdsZUNvaW5zIHx8IDA7XHJcbiAgICBjb25zdCBqdW5nbGVDb2luc0RlbHRhID0gbmV3SnVuZ2xlQ29pbnMgLSBvbGRKdW5nbGVDb2lucztcclxuICAgIFxyXG4gICAgaWYgKGp1bmdsZUNvaW5zRGVsdGEgPT09IDApIHtcclxuICAgICAgY29uc29sZS5sb2coYFt1cGRhdGVDaGFyYWN0ZXJKdW5nbGVDb2luc0Zyb21SZWNvcmRdIE5vIGp1bmdsZSBjb2lucyBjaGFuZ2UgZGV0ZWN0ZWRgKTtcclxuICAgICAgcmV0dXJuO1xyXG4gICAgfVxyXG4gICAgXHJcbiAgICAvLyBGaW5kIGNoYXJhY3RlcnMgcmVsYXRlZCB0byB0aGlzIGZpbmFuY2lhbCByZWNvcmRcclxuICAgIGNvbnN0IGFsbENoYXJhY3RlcnMgPSBhd2FpdCBDbGllbnRBUEkuZ2V0Q2hhcmFjdGVycygpO1xyXG4gICAgY29uc3QgcmVsYXRlZENoYXJhY3RlcnMgPSBhbGxDaGFyYWN0ZXJzLmZpbHRlcihjaGFyID0+IFxyXG4gICAgICBjaGFyLmlkID09PSByZWNvcmQuY3VzdG9tZXJDaGFyYWN0ZXJJZFxyXG4gICAgKTtcclxuICAgIFxyXG4gICAgZm9yIChjb25zdCBjaGFyYWN0ZXIgb2YgcmVsYXRlZENoYXJhY3RlcnMpIHtcclxuICAgICAgY29uc3QgdXBkYXRlS2V5ID0gYHVwZGF0ZUNoYXJhY3Rlckp1bmdsZUNvaW5zOiR7cmVjb3JkLmlkfToke2NoYXJhY3Rlci5pZH06JHtyZWNvcmQudXBkYXRlZEF0Py5nZXRUaW1lKCl9YDtcclxuICAgICAgXHJcbiAgICAgIGlmIChhd2FpdCBoYXNFZmZlY3QodXBkYXRlS2V5KSkge1xyXG4gICAgICAgIGNvbnNvbGUubG9nKGBbdXBkYXRlQ2hhcmFjdGVySnVuZ2xlQ29pbnNGcm9tUmVjb3JkXSDij63vuI8gQWxyZWFkeSB1cGRhdGVkIGNoYXJhY3RlcjogJHtjaGFyYWN0ZXIuaWR9YCk7XHJcbiAgICAgICAgY29udGludWU7XHJcbiAgICAgIH1cclxuICAgICAgXHJcbiAgICAgIC8vIFVwZGF0ZSBjaGFyYWN0ZXIganVuZ2xlIGNvaW5zXHJcbiAgICAgIGNvbnN0IHVwZGF0ZWRDaGFyYWN0ZXIgPSB7XHJcbiAgICAgICAgLi4uY2hhcmFjdGVyLFxyXG4gICAgICAgIGp1bmdsZUNvaW5zOiAoY2hhcmFjdGVyLmp1bmdsZUNvaW5zIHx8IDApICsganVuZ2xlQ29pbnNEZWx0YSxcclxuICAgICAgICB1cGRhdGVkQXQ6IG5ldyBEYXRlKClcclxuICAgICAgfTtcclxuICAgICAgXHJcbiAgICAgIGF3YWl0IENsaWVudEFQSS51cHNlcnRDaGFyYWN0ZXIodXBkYXRlZENoYXJhY3Rlcik7XHJcbiAgICAgIGF3YWl0IG1hcmtFZmZlY3QodXBkYXRlS2V5KTtcclxuICAgICAgXHJcbiAgICAgIGNvbnNvbGUubG9nKGBbdXBkYXRlQ2hhcmFjdGVySnVuZ2xlQ29pbnNGcm9tUmVjb3JkXSDinIUgVXBkYXRlZCBjaGFyYWN0ZXIganVuZ2xlIGNvaW5zOiAke2NoYXJhY3Rlci5pZH1gKTtcclxuICAgIH1cclxuICB9IGNhdGNoIChlcnJvcikge1xyXG4gICAgY29uc29sZS5lcnJvcihgW3VwZGF0ZUNoYXJhY3Rlckp1bmdsZUNvaW5zRnJvbVJlY29yZF0gRXJyb3IgdXBkYXRpbmcgY2hhcmFjdGVyIGp1bmdsZSBjb2luczpgLCBlcnJvcik7XHJcbiAgfVxyXG59XHJcblxyXG4vLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XHJcbi8vIFBST1BFUlRZIENIQU5HRSBERVRFQ1RJT04gSEVMUEVSU1xyXG4vLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gaGFzRmluYW5jaWFsUHJvcHNDaGFuZ2VkKG5ld0VudGl0eTogYW55LCBvbGRFbnRpdHk6IGFueSk6IGJvb2xlYW4ge1xyXG4gIHJldHVybiAoXHJcbiAgICBuZXdFbnRpdHkuY29zdCAhPT0gb2xkRW50aXR5LmNvc3QgfHxcclxuICAgIG5ld0VudGl0eS5yZXZlbnVlICE9PSBvbGRFbnRpdHkucmV2ZW51ZSB8fFxyXG4gICAgbmV3RW50aXR5LmlzTm90UGFpZCAhPT0gb2xkRW50aXR5LmlzTm90UGFpZCB8fFxyXG4gICAgbmV3RW50aXR5LmlzTm90Q2hhcmdlZCAhPT0gb2xkRW50aXR5LmlzTm90Q2hhcmdlZCB8fFxyXG4gICAgbmV3RW50aXR5Lm5hbWUgIT09IG9sZEVudGl0eS5uYW1lIHx8XHJcbiAgICBuZXdFbnRpdHkuc3RhdGlvbiAhPT0gb2xkRW50aXR5LnN0YXRpb25cclxuICApO1xyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gaGFzT3V0cHV0UHJvcHNDaGFuZ2VkKG5ld0VudGl0eTogYW55LCBvbGRFbnRpdHk6IGFueSk6IGJvb2xlYW4ge1xyXG4gIHJldHVybiAoXHJcbiAgICBuZXdFbnRpdHkub3V0cHV0UXVhbnRpdHkgIT09IG9sZEVudGl0eS5vdXRwdXRRdWFudGl0eSB8fFxyXG4gICAgbmV3RW50aXR5Lm91dHB1dEl0ZW1OYW1lICE9PSBvbGRFbnRpdHkub3V0cHV0SXRlbU5hbWUgfHxcclxuICAgIG5ld0VudGl0eS5vdXRwdXRVbml0Q29zdCAhPT0gb2xkRW50aXR5Lm91dHB1dFVuaXRDb3N0IHx8XHJcbiAgICBuZXdFbnRpdHkub3V0cHV0SXRlbVByaWNlICE9PSBvbGRFbnRpdHkub3V0cHV0SXRlbVByaWNlIHx8XHJcbiAgICBuZXdFbnRpdHkuc3RhdGlvbiAhPT0gb2xkRW50aXR5LnN0YXRpb25cclxuICApO1xyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gaGFzUmV3YXJkc0NoYW5nZWQobmV3RW50aXR5OiBhbnksIG9sZEVudGl0eTogYW55KTogYm9vbGVhbiB7XHJcbiAgY29uc3QgbmV3UmV3YXJkcyA9IG5ld0VudGl0eS5yZXdhcmRzPy5wb2ludHMgfHwgeyB4cDogMCwgcnA6IDAsIGZwOiAwLCBocDogMCB9O1xyXG4gIGNvbnN0IG9sZFJld2FyZHMgPSBvbGRFbnRpdHkucmV3YXJkcz8ucG9pbnRzIHx8IHsgeHA6IDAsIHJwOiAwLCBmcDogMCwgaHA6IDAgfTtcclxuICBcclxuICByZXR1cm4gKFxyXG4gICAgbmV3UmV3YXJkcy54cCAhPT0gb2xkUmV3YXJkcy54cCB8fFxyXG4gICAgbmV3UmV3YXJkcy5ycCAhPT0gb2xkUmV3YXJkcy5ycCB8fFxyXG4gICAgbmV3UmV3YXJkcy5mcCAhPT0gb2xkUmV3YXJkcy5mcCB8fFxyXG4gICAgbmV3UmV3YXJkcy5ocCAhPT0gb2xkUmV3YXJkcy5ocFxyXG4gICk7XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBoYXNKdW5nbGVDb2luc0NoYW5nZWQobmV3RW50aXR5OiBhbnksIG9sZEVudGl0eTogYW55KTogYm9vbGVhbiB7XHJcbiAgcmV0dXJuIChuZXdFbnRpdHkuanVuZ2xlQ29pbnMgfHwgMCkgIT09IChvbGRFbnRpdHkuanVuZ2xlQ29pbnMgfHwgMCk7XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBoYXNSZXZlbnVlQ2hhbmdlZChuZXdFbnRpdHk6IGFueSwgb2xkRW50aXR5OiBhbnkpOiBib29sZWFuIHtcclxuICByZXR1cm4gKG5ld0VudGl0eS50b3RhbHM/LnRvdGFsUmV2ZW51ZSB8fCAwKSAhPT0gKG9sZEVudGl0eS50b3RhbHM/LnRvdGFsUmV2ZW51ZSB8fCAwKTtcclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIGhhc0xpbmVzQ2hhbmdlZChuZXdFbnRpdHk6IGFueSwgb2xkRW50aXR5OiBhbnkpOiBib29sZWFuIHtcclxuICByZXR1cm4gSlNPTi5zdHJpbmdpZnkobmV3RW50aXR5LmxpbmVzKSAhPT0gSlNPTi5zdHJpbmdpZnkob2xkRW50aXR5LmxpbmVzKTtcclxufVxyXG4iXSwibmFtZXMiOlsiQ2xpZW50QVBJIiwiaGFzRWZmZWN0IiwibWFya0VmZmVjdCIsInVwZGF0ZUZpbmFuY2lhbFJlY29yZHNGcm9tVGFzayIsInRhc2siLCJwcmV2aW91c1Rhc2siLCJjb25zb2xlIiwibG9nIiwibmFtZSIsImFsbEZpbmFuY2lhbHMiLCJnZXRGaW5hbmNpYWxSZWNvcmRzIiwicmVsYXRlZFJlY29yZHMiLCJmaWx0ZXIiLCJyZWNvcmQiLCJzb3VyY2VUYXNrSWQiLCJpZCIsInVwZGF0ZUtleSIsInVwZGF0ZWRBdCIsImdldFRpbWUiLCJmaW5hbmNpYWxQcm9wc0NoYW5nZWQiLCJjb3N0IiwicmV2ZW51ZSIsImlzTm90UGFpZCIsImlzTm90Q2hhcmdlZCIsInN0YXRpb24iLCJ1cGRhdGVkUmVjb3JkIiwiRGF0ZSIsInVwc2VydEZpbmFuY2lhbFJlY29yZCIsImVycm9yIiwidXBkYXRlVGFza3NGcm9tRmluYW5jaWFsUmVjb3JkIiwicHJldmlvdXNSZWNvcmQiLCJhbGxUYXNrcyIsImdldFRhc2tzIiwicmVsYXRlZFRhc2tzIiwidXBkYXRlZFRhc2siLCJ1cHNlcnRUYXNrIiwidXBkYXRlSXRlbXNDcmVhdGVkQnlUYXNrIiwiYWxsSXRlbXMiLCJnZXRJdGVtcyIsInJlbGF0ZWRJdGVtcyIsIml0ZW0iLCJvdXRwdXRQcm9wc0NoYW5nZWQiLCJvdXRwdXRRdWFudGl0eSIsIm91dHB1dEl0ZW1OYW1lIiwib3V0cHV0VW5pdENvc3QiLCJvdXRwdXRJdGVtUHJpY2UiLCJ1cGRhdGVkSXRlbSIsInVuaXRDb3N0IiwicHJpY2UiLCJxdWFudGl0eURpZmYiLCJzdG9jayIsImxlbmd0aCIsInF1YW50aXR5Iiwic2l0ZUlkIiwidXBzZXJ0SXRlbSIsInVwZGF0ZUl0ZW1zQ3JlYXRlZEJ5UmVjb3JkIiwic291cmNlUmVjb3JkSWQiLCJ1cGRhdGVGaW5hbmNpYWxSZWNvcmRzRnJvbVNhbGUiLCJzYWxlIiwicHJldmlvdXNTYWxlIiwic291cmNlU2FsZUlkIiwicmV2ZW51ZVByb3BzQ2hhbmdlZCIsInRvdGFscyIsInRvdGFsUmV2ZW51ZSIsInN0YXR1cyIsInVwZGF0ZUl0ZW1zRnJvbVNhbGUiLCJsaW5lc0NoYW5nZWQiLCJsaW5lcyIsIkpTT04iLCJzdHJpbmdpZnkiLCJsaW5lIiwia2luZCIsIml0ZW1JZCIsImdldEl0ZW1CeUlkIiwid2FybiIsInF1YW50aXR5U29sZCIsInVwZGF0ZVBsYXllclBvaW50c0Zyb21Tb3VyY2UiLCJzb3VyY2VUeXBlIiwibmV3U291cmNlIiwib2xkU291cmNlIiwicGxheWVyIiwicG9pbnRzRGVsdGEiLCJ4cCIsInJwIiwiZnAiLCJocCIsIm5ld1BvaW50cyIsInJld2FyZHMiLCJwb2ludHMiLCJvbGRQb2ludHMiLCJuZXdSZXZlbnVlIiwib2xkUmV2ZW51ZSIsInJldmVudWVEZWx0YSIsIk1hdGgiLCJmbG9vciIsInBsYXllcnMiLCJnZXRQbGF5ZXJzIiwidXBkYXRlZFBsYXllciIsInVwc2VydFBsYXllciIsInVwZGF0ZUNoYXJhY3Rlckp1bmdsZUNvaW5zRnJvbVJlY29yZCIsIm5ld0p1bmdsZUNvaW5zIiwianVuZ2xlQ29pbnMiLCJvbGRKdW5nbGVDb2lucyIsImp1bmdsZUNvaW5zRGVsdGEiLCJhbGxDaGFyYWN0ZXJzIiwiZ2V0Q2hhcmFjdGVycyIsInJlbGF0ZWRDaGFyYWN0ZXJzIiwiY2hhciIsImN1c3RvbWVyQ2hhcmFjdGVySWQiLCJjaGFyYWN0ZXIiLCJ1cGRhdGVkQ2hhcmFjdGVyIiwidXBzZXJ0Q2hhcmFjdGVyIiwiaGFzRmluYW5jaWFsUHJvcHNDaGFuZ2VkIiwibmV3RW50aXR5Iiwib2xkRW50aXR5IiwiaGFzT3V0cHV0UHJvcHNDaGFuZ2VkIiwiaGFzUmV3YXJkc0NoYW5nZWQiLCJuZXdSZXdhcmRzIiwib2xkUmV3YXJkcyIsImhhc0p1bmdsZUNvaW5zQ2hhbmdlZCIsImhhc1JldmVudWVDaGFuZ2VkIiwiaGFzTGluZXNDaGFuZ2VkIl0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(app-pages-browser)/./workflows/update-propagation-utils.ts\n"));

/***/ }),

/***/ "(app-pages-browser)/./node_modules/@upstash/redis/chunk-TAJI6TAE.mjs":
/*!********************************************************!*\
  !*** ./node_modules/@upstash/redis/chunk-TAJI6TAE.mjs ***!
  \********************************************************/
/***/ (function(__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) {

"use strict";
eval(__webpack_require__.ts("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   HttpClient: function() { return /* binding */ HttpClient; },\n/* harmony export */   Redis: function() { return /* binding */ Redis; },\n/* harmony export */   VERSION: function() { return /* binding */ VERSION; },\n/* harmony export */   error_exports: function() { return /* binding */ error_exports; }\n/* harmony export */ });\n/* harmony import */ var uncrypto__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! uncrypto */ \"(app-pages-browser)/./node_modules/uncrypto/dist/crypto.web.mjs\");\nvar __defProp = Object.defineProperty;\nvar __export = (target, all) => {\n  for (var name in all)\n    __defProp(target, name, { get: all[name], enumerable: true });\n};\n\n// pkg/error.ts\nvar error_exports = {};\n__export(error_exports, {\n  UpstashError: () => UpstashError,\n  UpstashJSONParseError: () => UpstashJSONParseError,\n  UrlError: () => UrlError\n});\nvar UpstashError = class extends Error {\n  constructor(message, options) {\n    super(message, options);\n    this.name = \"UpstashError\";\n  }\n};\nvar UrlError = class extends Error {\n  constructor(url) {\n    super(\n      `Upstash Redis client was passed an invalid URL. You should pass a URL starting with https. Received: \"${url}\". `\n    );\n    this.name = \"UrlError\";\n  }\n};\nvar UpstashJSONParseError = class extends UpstashError {\n  constructor(body, options) {\n    const truncatedBody = body.length > 200 ? body.slice(0, 200) + \"...\" : body;\n    super(`Unable to parse response body: ${truncatedBody}`, options);\n    this.name = \"UpstashJSONParseError\";\n  }\n};\n\n// pkg/util.ts\nfunction parseRecursive(obj) {\n  const parsed = Array.isArray(obj) ? obj.map((o) => {\n    try {\n      return parseRecursive(o);\n    } catch {\n      return o;\n    }\n  }) : JSON.parse(obj);\n  if (typeof parsed === \"number\" && parsed.toString() !== obj) {\n    return obj;\n  }\n  return parsed;\n}\nfunction parseResponse(result) {\n  try {\n    return parseRecursive(result);\n  } catch {\n    return result;\n  }\n}\nfunction deserializeScanResponse(result) {\n  return [result[0], ...parseResponse(result.slice(1))];\n}\nfunction deserializeScanWithTypesResponse(result) {\n  const [cursor, keys] = result;\n  const parsedKeys = [];\n  for (let i = 0; i < keys.length; i += 2) {\n    parsedKeys.push({ key: keys[i], type: keys[i + 1] });\n  }\n  return [cursor, parsedKeys];\n}\nfunction mergeHeaders(...headers) {\n  const merged = {};\n  for (const header of headers) {\n    if (!header) continue;\n    for (const [key, value] of Object.entries(header)) {\n      if (value !== void 0 && value !== null) {\n        merged[key] = value;\n      }\n    }\n  }\n  return merged;\n}\n\n// pkg/http.ts\nvar HttpClient = class {\n  baseUrl;\n  headers;\n  options;\n  readYourWrites;\n  upstashSyncToken = \"\";\n  hasCredentials;\n  retry;\n  constructor(config) {\n    this.options = {\n      backend: config.options?.backend,\n      agent: config.agent,\n      responseEncoding: config.responseEncoding ?? \"base64\",\n      // default to base64\n      cache: config.cache,\n      signal: config.signal,\n      keepAlive: config.keepAlive ?? true\n    };\n    this.upstashSyncToken = \"\";\n    this.readYourWrites = config.readYourWrites ?? true;\n    this.baseUrl = (config.baseUrl || \"\").replace(/\\/$/, \"\");\n    const urlRegex = /^https?:\\/\\/[^\\s#$./?].\\S*$/;\n    if (this.baseUrl && !urlRegex.test(this.baseUrl)) {\n      throw new UrlError(this.baseUrl);\n    }\n    this.headers = {\n      \"Content-Type\": \"application/json\",\n      ...config.headers\n    };\n    this.hasCredentials = Boolean(this.baseUrl && this.headers.authorization.split(\" \")[1]);\n    if (this.options.responseEncoding === \"base64\") {\n      this.headers[\"Upstash-Encoding\"] = \"base64\";\n    }\n    this.retry = typeof config.retry === \"boolean\" && !config.retry ? {\n      attempts: 1,\n      backoff: () => 0\n    } : {\n      attempts: config.retry?.retries ?? 5,\n      backoff: config.retry?.backoff ?? ((retryCount) => Math.exp(retryCount) * 50)\n    };\n  }\n  mergeTelemetry(telemetry) {\n    this.headers = merge(this.headers, \"Upstash-Telemetry-Runtime\", telemetry.runtime);\n    this.headers = merge(this.headers, \"Upstash-Telemetry-Platform\", telemetry.platform);\n    this.headers = merge(this.headers, \"Upstash-Telemetry-Sdk\", telemetry.sdk);\n  }\n  async request(req) {\n    const requestHeaders = mergeHeaders(this.headers, req.headers ?? {});\n    const requestUrl = [this.baseUrl, ...req.path ?? []].join(\"/\");\n    const isEventStream = requestHeaders.Accept === \"text/event-stream\";\n    const signal = req.signal ?? this.options.signal;\n    const isSignalFunction = typeof signal === \"function\";\n    const requestOptions = {\n      //@ts-expect-error this should throw due to bun regression\n      cache: this.options.cache,\n      method: \"POST\",\n      headers: requestHeaders,\n      body: JSON.stringify(req.body),\n      keepalive: this.options.keepAlive,\n      agent: this.options.agent,\n      signal: isSignalFunction ? signal() : signal,\n      /**\n       * Fastly specific\n       */\n      backend: this.options.backend\n    };\n    if (!this.hasCredentials) {\n      console.warn(\n        \"[Upstash Redis] Redis client was initialized without url or token. Failed to execute command.\"\n      );\n    }\n    if (this.readYourWrites) {\n      const newHeader = this.upstashSyncToken;\n      this.headers[\"upstash-sync-token\"] = newHeader;\n    }\n    let res = null;\n    let error = null;\n    for (let i = 0; i <= this.retry.attempts; i++) {\n      try {\n        res = await fetch(requestUrl, requestOptions);\n        break;\n      } catch (error_) {\n        if (requestOptions.signal?.aborted && isSignalFunction) {\n          throw error_;\n        } else if (requestOptions.signal?.aborted) {\n          const myBlob = new Blob([\n            JSON.stringify({ result: requestOptions.signal.reason ?? \"Aborted\" })\n          ]);\n          const myOptions = {\n            status: 200,\n            statusText: requestOptions.signal.reason ?? \"Aborted\"\n          };\n          res = new Response(myBlob, myOptions);\n          break;\n        }\n        error = error_;\n        if (i < this.retry.attempts) {\n          await new Promise((r) => setTimeout(r, this.retry.backoff(i)));\n        }\n      }\n    }\n    if (!res) {\n      throw error ?? new Error(\"Exhausted all retries\");\n    }\n    if (!res.ok) {\n      let body2;\n      const rawBody2 = await res.text();\n      try {\n        body2 = JSON.parse(rawBody2);\n      } catch (error2) {\n        throw new UpstashJSONParseError(rawBody2, { cause: error2 });\n      }\n      throw new UpstashError(`${body2.error}, command was: ${JSON.stringify(req.body)}`);\n    }\n    if (this.readYourWrites) {\n      const headers = res.headers;\n      this.upstashSyncToken = headers.get(\"upstash-sync-token\") ?? \"\";\n    }\n    if (isEventStream && req && req.onMessage && res.body) {\n      const reader = res.body.getReader();\n      const decoder = new TextDecoder();\n      (async () => {\n        try {\n          while (true) {\n            const { value, done } = await reader.read();\n            if (done) break;\n            const chunk = decoder.decode(value);\n            const lines = chunk.split(\"\\n\");\n            for (const line of lines) {\n              if (line.startsWith(\"data: \")) {\n                const data = line.slice(6);\n                req.onMessage?.(data);\n              }\n            }\n          }\n        } catch (error2) {\n          if (error2 instanceof Error && error2.name === \"AbortError\") {\n          } else {\n            console.error(\"Stream reading error:\", error2);\n          }\n        } finally {\n          try {\n            await reader.cancel();\n          } catch {\n          }\n        }\n      })();\n      return { result: 1 };\n    }\n    let body;\n    const rawBody = await res.text();\n    try {\n      body = JSON.parse(rawBody);\n    } catch (error2) {\n      throw new UpstashJSONParseError(rawBody, { cause: error2 });\n    }\n    if (this.readYourWrites) {\n      const headers = res.headers;\n      this.upstashSyncToken = headers.get(\"upstash-sync-token\") ?? \"\";\n    }\n    if (this.options.responseEncoding === \"base64\") {\n      if (Array.isArray(body)) {\n        return body.map(({ result: result2, error: error2 }) => ({\n          result: decode(result2),\n          error: error2\n        }));\n      }\n      const result = decode(body.result);\n      return { result, error: body.error };\n    }\n    return body;\n  }\n};\nfunction base64decode(b64) {\n  let dec = \"\";\n  try {\n    const binString = atob(b64);\n    const size = binString.length;\n    const bytes = new Uint8Array(size);\n    for (let i = 0; i < size; i++) {\n      bytes[i] = binString.charCodeAt(i);\n    }\n    dec = new TextDecoder().decode(bytes);\n  } catch {\n    dec = b64;\n  }\n  return dec;\n}\nfunction decode(raw) {\n  let result = void 0;\n  switch (typeof raw) {\n    case \"undefined\": {\n      return raw;\n    }\n    case \"number\": {\n      result = raw;\n      break;\n    }\n    case \"object\": {\n      if (Array.isArray(raw)) {\n        result = raw.map(\n          (v) => typeof v === \"string\" ? base64decode(v) : Array.isArray(v) ? v.map((element) => decode(element)) : v\n        );\n      } else {\n        result = null;\n      }\n      break;\n    }\n    case \"string\": {\n      result = raw === \"OK\" ? \"OK\" : base64decode(raw);\n      break;\n    }\n    default: {\n      break;\n    }\n  }\n  return result;\n}\nfunction merge(obj, key, value) {\n  if (!value) {\n    return obj;\n  }\n  obj[key] = obj[key] ? [obj[key], value].join(\",\") : value;\n  return obj;\n}\n\n// pkg/commands/command.ts\nvar defaultSerializer = (c) => {\n  switch (typeof c) {\n    case \"string\":\n    case \"number\":\n    case \"boolean\": {\n      return c;\n    }\n    default: {\n      return JSON.stringify(c);\n    }\n  }\n};\nvar Command = class {\n  command;\n  serialize;\n  deserialize;\n  headers;\n  path;\n  onMessage;\n  isStreaming;\n  signal;\n  /**\n   * Create a new command instance.\n   *\n   * You can define a custom `deserialize` function. By default we try to deserialize as json.\n   */\n  constructor(command, opts) {\n    this.serialize = defaultSerializer;\n    this.deserialize = opts?.automaticDeserialization === void 0 || opts.automaticDeserialization ? opts?.deserialize ?? parseResponse : (x) => x;\n    this.command = command.map((c) => this.serialize(c));\n    this.headers = opts?.headers;\n    this.path = opts?.path;\n    this.onMessage = opts?.streamOptions?.onMessage;\n    this.isStreaming = opts?.streamOptions?.isStreaming ?? false;\n    this.signal = opts?.streamOptions?.signal;\n    if (opts?.latencyLogging) {\n      const originalExec = this.exec.bind(this);\n      this.exec = async (client) => {\n        const start = performance.now();\n        const result = await originalExec(client);\n        const end = performance.now();\n        const loggerResult = (end - start).toFixed(2);\n        console.log(\n          `Latency for \\x1B[38;2;19;185;39m${this.command[0].toString().toUpperCase()}\\x1B[0m: \\x1B[38;2;0;255;255m${loggerResult} ms\\x1B[0m`\n        );\n        return result;\n      };\n    }\n  }\n  /**\n   * Execute the command using a client.\n   */\n  async exec(client) {\n    const { result, error } = await client.request({\n      body: this.command,\n      path: this.path,\n      upstashSyncToken: client.upstashSyncToken,\n      headers: this.headers,\n      onMessage: this.onMessage,\n      isStreaming: this.isStreaming,\n      signal: this.signal\n    });\n    if (error) {\n      throw new UpstashError(error);\n    }\n    if (result === void 0) {\n      throw new TypeError(\"Request did not return a result\");\n    }\n    return this.deserialize(result);\n  }\n};\n\n// pkg/commands/hrandfield.ts\nfunction deserialize(result) {\n  if (result.length === 0) {\n    return null;\n  }\n  const obj = {};\n  for (let i = 0; i < result.length; i += 2) {\n    const key = result[i];\n    const value = result[i + 1];\n    try {\n      obj[key] = JSON.parse(value);\n    } catch {\n      obj[key] = value;\n    }\n  }\n  return obj;\n}\nvar HRandFieldCommand = class extends Command {\n  constructor(cmd, opts) {\n    const command = [\"hrandfield\", cmd[0]];\n    if (typeof cmd[1] === \"number\") {\n      command.push(cmd[1]);\n    }\n    if (cmd[2]) {\n      command.push(\"WITHVALUES\");\n    }\n    super(command, {\n      // @ts-expect-error to silence compiler\n      deserialize: cmd[2] ? (result) => deserialize(result) : opts?.deserialize,\n      ...opts\n    });\n  }\n};\n\n// pkg/commands/append.ts\nvar AppendCommand = class extends Command {\n  constructor(cmd, opts) {\n    super([\"append\", ...cmd], opts);\n  }\n};\n\n// pkg/commands/bitcount.ts\nvar BitCountCommand = class extends Command {\n  constructor([key, start, end], opts) {\n    const command = [\"bitcount\", key];\n    if (typeof start === \"number\") {\n      command.push(start);\n    }\n    if (typeof end === \"number\") {\n      command.push(end);\n    }\n    super(command, opts);\n  }\n};\n\n// pkg/commands/bitfield.ts\nvar BitFieldCommand = class {\n  constructor(args, client, opts, execOperation = (command) => command.exec(this.client)) {\n    this.client = client;\n    this.opts = opts;\n    this.execOperation = execOperation;\n    this.command = [\"bitfield\", ...args];\n  }\n  command;\n  chain(...args) {\n    this.command.push(...args);\n    return this;\n  }\n  get(...args) {\n    return this.chain(\"get\", ...args);\n  }\n  set(...args) {\n    return this.chain(\"set\", ...args);\n  }\n  incrby(...args) {\n    return this.chain(\"incrby\", ...args);\n  }\n  overflow(overflow) {\n    return this.chain(\"overflow\", overflow);\n  }\n  exec() {\n    const command = new Command(this.command, this.opts);\n    return this.execOperation(command);\n  }\n};\n\n// pkg/commands/bitop.ts\nvar BitOpCommand = class extends Command {\n  constructor(cmd, opts) {\n    super([\"bitop\", ...cmd], opts);\n  }\n};\n\n// pkg/commands/bitpos.ts\nvar BitPosCommand = class extends Command {\n  constructor(cmd, opts) {\n    super([\"bitpos\", ...cmd], opts);\n  }\n};\n\n// pkg/commands/copy.ts\nvar CopyCommand = class extends Command {\n  constructor([key, destinationKey, opts], commandOptions) {\n    super([\"COPY\", key, destinationKey, ...opts?.replace ? [\"REPLACE\"] : []], {\n      ...commandOptions,\n      deserialize(result) {\n        if (result > 0) {\n          return \"COPIED\";\n        }\n        return \"NOT_COPIED\";\n      }\n    });\n  }\n};\n\n// pkg/commands/dbsize.ts\nvar DBSizeCommand = class extends Command {\n  constructor(opts) {\n    super([\"dbsize\"], opts);\n  }\n};\n\n// pkg/commands/decr.ts\nvar DecrCommand = class extends Command {\n  constructor(cmd, opts) {\n    super([\"decr\", ...cmd], opts);\n  }\n};\n\n// pkg/commands/decrby.ts\nvar DecrByCommand = class extends Command {\n  constructor(cmd, opts) {\n    super([\"decrby\", ...cmd], opts);\n  }\n};\n\n// pkg/commands/del.ts\nvar DelCommand = class extends Command {\n  constructor(cmd, opts) {\n    super([\"del\", ...cmd], opts);\n  }\n};\n\n// pkg/commands/echo.ts\nvar EchoCommand = class extends Command {\n  constructor(cmd, opts) {\n    super([\"echo\", ...cmd], opts);\n  }\n};\n\n// pkg/commands/evalRo.ts\nvar EvalROCommand = class extends Command {\n  constructor([script, keys, args], opts) {\n    super([\"eval_ro\", script, keys.length, ...keys, ...args ?? []], opts);\n  }\n};\n\n// pkg/commands/eval.ts\nvar EvalCommand = class extends Command {\n  constructor([script, keys, args], opts) {\n    super([\"eval\", script, keys.length, ...keys, ...args ?? []], opts);\n  }\n};\n\n// pkg/commands/evalshaRo.ts\nvar EvalshaROCommand = class extends Command {\n  constructor([sha, keys, args], opts) {\n    super([\"evalsha_ro\", sha, keys.length, ...keys, ...args ?? []], opts);\n  }\n};\n\n// pkg/commands/evalsha.ts\nvar EvalshaCommand = class extends Command {\n  constructor([sha, keys, args], opts) {\n    super([\"evalsha\", sha, keys.length, ...keys, ...args ?? []], opts);\n  }\n};\n\n// pkg/commands/exec.ts\nvar ExecCommand = class extends Command {\n  constructor(cmd, opts) {\n    const normalizedCmd = cmd.map((arg) => typeof arg === \"string\" ? arg : String(arg));\n    super(normalizedCmd, opts);\n  }\n};\n\n// pkg/commands/exists.ts\nvar ExistsCommand = class extends Command {\n  constructor(cmd, opts) {\n    super([\"exists\", ...cmd], opts);\n  }\n};\n\n// pkg/commands/expire.ts\nvar ExpireCommand = class extends Command {\n  constructor(cmd, opts) {\n    super([\"expire\", ...cmd.filter(Boolean)], opts);\n  }\n};\n\n// pkg/commands/expireat.ts\nvar ExpireAtCommand = class extends Command {\n  constructor(cmd, opts) {\n    super([\"expireat\", ...cmd], opts);\n  }\n};\n\n// pkg/commands/flushall.ts\nvar FlushAllCommand = class extends Command {\n  constructor(args, opts) {\n    const command = [\"flushall\"];\n    if (args && args.length > 0 && args[0].async) {\n      command.push(\"async\");\n    }\n    super(command, opts);\n  }\n};\n\n// pkg/commands/flushdb.ts\nvar FlushDBCommand = class extends Command {\n  constructor([opts], cmdOpts) {\n    const command = [\"flushdb\"];\n    if (opts?.async) {\n      command.push(\"async\");\n    }\n    super(command, cmdOpts);\n  }\n};\n\n// pkg/commands/geo_add.ts\nvar GeoAddCommand = class extends Command {\n  constructor([key, arg1, ...arg2], opts) {\n    const command = [\"geoadd\", key];\n    if (\"nx\" in arg1 && arg1.nx) {\n      command.push(\"nx\");\n    } else if (\"xx\" in arg1 && arg1.xx) {\n      command.push(\"xx\");\n    }\n    if (\"ch\" in arg1 && arg1.ch) {\n      command.push(\"ch\");\n    }\n    if (\"latitude\" in arg1 && arg1.latitude) {\n      command.push(arg1.longitude, arg1.latitude, arg1.member);\n    }\n    command.push(\n      ...arg2.flatMap(({ latitude, longitude, member }) => [longitude, latitude, member])\n    );\n    super(command, opts);\n  }\n};\n\n// pkg/commands/geo_dist.ts\nvar GeoDistCommand = class extends Command {\n  constructor([key, member1, member2, unit = \"M\"], opts) {\n    super([\"GEODIST\", key, member1, member2, unit], opts);\n  }\n};\n\n// pkg/commands/geo_hash.ts\nvar GeoHashCommand = class extends Command {\n  constructor(cmd, opts) {\n    const [key] = cmd;\n    const members = Array.isArray(cmd[1]) ? cmd[1] : cmd.slice(1);\n    super([\"GEOHASH\", key, ...members], opts);\n  }\n};\n\n// pkg/commands/geo_pos.ts\nvar GeoPosCommand = class extends Command {\n  constructor(cmd, opts) {\n    const [key] = cmd;\n    const members = Array.isArray(cmd[1]) ? cmd[1] : cmd.slice(1);\n    super([\"GEOPOS\", key, ...members], {\n      deserialize: (result) => transform(result),\n      ...opts\n    });\n  }\n};\nfunction transform(result) {\n  const final = [];\n  for (const pos of result) {\n    if (!pos?.[0] || !pos?.[1]) {\n      continue;\n    }\n    final.push({ lng: Number.parseFloat(pos[0]), lat: Number.parseFloat(pos[1]) });\n  }\n  return final;\n}\n\n// pkg/commands/geo_search.ts\nvar GeoSearchCommand = class extends Command {\n  constructor([key, centerPoint, shape, order, opts], commandOptions) {\n    const command = [\"GEOSEARCH\", key];\n    if (centerPoint.type === \"FROMMEMBER\" || centerPoint.type === \"frommember\") {\n      command.push(centerPoint.type, centerPoint.member);\n    }\n    if (centerPoint.type === \"FROMLONLAT\" || centerPoint.type === \"fromlonlat\") {\n      command.push(centerPoint.type, centerPoint.coordinate.lon, centerPoint.coordinate.lat);\n    }\n    if (shape.type === \"BYRADIUS\" || shape.type === \"byradius\") {\n      command.push(shape.type, shape.radius, shape.radiusType);\n    }\n    if (shape.type === \"BYBOX\" || shape.type === \"bybox\") {\n      command.push(shape.type, shape.rect.width, shape.rect.height, shape.rectType);\n    }\n    command.push(order);\n    if (opts?.count) {\n      command.push(\"COUNT\", opts.count.limit, ...opts.count.any ? [\"ANY\"] : []);\n    }\n    const transform2 = (result) => {\n      if (!opts?.withCoord && !opts?.withDist && !opts?.withHash) {\n        return result.map((member) => {\n          try {\n            return { member: JSON.parse(member) };\n          } catch {\n            return { member };\n          }\n        });\n      }\n      return result.map((members) => {\n        let counter = 1;\n        const obj = {};\n        try {\n          obj.member = JSON.parse(members[0]);\n        } catch {\n          obj.member = members[0];\n        }\n        if (opts.withDist) {\n          obj.dist = Number.parseFloat(members[counter++]);\n        }\n        if (opts.withHash) {\n          obj.hash = members[counter++].toString();\n        }\n        if (opts.withCoord) {\n          obj.coord = {\n            long: Number.parseFloat(members[counter][0]),\n            lat: Number.parseFloat(members[counter][1])\n          };\n        }\n        return obj;\n      });\n    };\n    super(\n      [\n        ...command,\n        ...opts?.withCoord ? [\"WITHCOORD\"] : [],\n        ...opts?.withDist ? [\"WITHDIST\"] : [],\n        ...opts?.withHash ? [\"WITHHASH\"] : []\n      ],\n      {\n        deserialize: transform2,\n        ...commandOptions\n      }\n    );\n  }\n};\n\n// pkg/commands/geo_search_store.ts\nvar GeoSearchStoreCommand = class extends Command {\n  constructor([destination, key, centerPoint, shape, order, opts], commandOptions) {\n    const command = [\"GEOSEARCHSTORE\", destination, key];\n    if (centerPoint.type === \"FROMMEMBER\" || centerPoint.type === \"frommember\") {\n      command.push(centerPoint.type, centerPoint.member);\n    }\n    if (centerPoint.type === \"FROMLONLAT\" || centerPoint.type === \"fromlonlat\") {\n      command.push(centerPoint.type, centerPoint.coordinate.lon, centerPoint.coordinate.lat);\n    }\n    if (shape.type === \"BYRADIUS\" || shape.type === \"byradius\") {\n      command.push(shape.type, shape.radius, shape.radiusType);\n    }\n    if (shape.type === \"BYBOX\" || shape.type === \"bybox\") {\n      command.push(shape.type, shape.rect.width, shape.rect.height, shape.rectType);\n    }\n    command.push(order);\n    if (opts?.count) {\n      command.push(\"COUNT\", opts.count.limit, ...opts.count.any ? [\"ANY\"] : []);\n    }\n    super([...command, ...opts?.storeDist ? [\"STOREDIST\"] : []], commandOptions);\n  }\n};\n\n// pkg/commands/get.ts\nvar GetCommand = class extends Command {\n  constructor(cmd, opts) {\n    super([\"get\", ...cmd], opts);\n  }\n};\n\n// pkg/commands/getbit.ts\nvar GetBitCommand = class extends Command {\n  constructor(cmd, opts) {\n    super([\"getbit\", ...cmd], opts);\n  }\n};\n\n// pkg/commands/getdel.ts\nvar GetDelCommand = class extends Command {\n  constructor(cmd, opts) {\n    super([\"getdel\", ...cmd], opts);\n  }\n};\n\n// pkg/commands/getex.ts\nvar GetExCommand = class extends Command {\n  constructor([key, opts], cmdOpts) {\n    const command = [\"getex\", key];\n    if (opts) {\n      if (\"ex\" in opts && typeof opts.ex === \"number\") {\n        command.push(\"ex\", opts.ex);\n      } else if (\"px\" in opts && typeof opts.px === \"number\") {\n        command.push(\"px\", opts.px);\n      } else if (\"exat\" in opts && typeof opts.exat === \"number\") {\n        command.push(\"exat\", opts.exat);\n      } else if (\"pxat\" in opts && typeof opts.pxat === \"number\") {\n        command.push(\"pxat\", opts.pxat);\n      } else if (\"persist\" in opts && opts.persist) {\n        command.push(\"persist\");\n      }\n    }\n    super(command, cmdOpts);\n  }\n};\n\n// pkg/commands/getrange.ts\nvar GetRangeCommand = class extends Command {\n  constructor(cmd, opts) {\n    super([\"getrange\", ...cmd], opts);\n  }\n};\n\n// pkg/commands/getset.ts\nvar GetSetCommand = class extends Command {\n  constructor(cmd, opts) {\n    super([\"getset\", ...cmd], opts);\n  }\n};\n\n// pkg/commands/hdel.ts\nvar HDelCommand = class extends Command {\n  constructor(cmd, opts) {\n    super([\"hdel\", ...cmd], opts);\n  }\n};\n\n// pkg/commands/hexists.ts\nvar HExistsCommand = class extends Command {\n  constructor(cmd, opts) {\n    super([\"hexists\", ...cmd], opts);\n  }\n};\n\n// pkg/commands/hexpire.ts\nvar HExpireCommand = class extends Command {\n  constructor(cmd, opts) {\n    const [key, fields, seconds, option] = cmd;\n    const fieldArray = Array.isArray(fields) ? fields : [fields];\n    super(\n      [\n        \"hexpire\",\n        key,\n        seconds,\n        ...option ? [option] : [],\n        \"FIELDS\",\n        fieldArray.length,\n        ...fieldArray\n      ],\n      opts\n    );\n  }\n};\n\n// pkg/commands/hexpireat.ts\nvar HExpireAtCommand = class extends Command {\n  constructor(cmd, opts) {\n    const [key, fields, timestamp, option] = cmd;\n    const fieldArray = Array.isArray(fields) ? fields : [fields];\n    super(\n      [\n        \"hexpireat\",\n        key,\n        timestamp,\n        ...option ? [option] : [],\n        \"FIELDS\",\n        fieldArray.length,\n        ...fieldArray\n      ],\n      opts\n    );\n  }\n};\n\n// pkg/commands/hexpiretime.ts\nvar HExpireTimeCommand = class extends Command {\n  constructor(cmd, opts) {\n    const [key, fields] = cmd;\n    const fieldArray = Array.isArray(fields) ? fields : [fields];\n    super([\"hexpiretime\", key, \"FIELDS\", fieldArray.length, ...fieldArray], opts);\n  }\n};\n\n// pkg/commands/hpersist.ts\nvar HPersistCommand = class extends Command {\n  constructor(cmd, opts) {\n    const [key, fields] = cmd;\n    const fieldArray = Array.isArray(fields) ? fields : [fields];\n    super([\"hpersist\", key, \"FIELDS\", fieldArray.length, ...fieldArray], opts);\n  }\n};\n\n// pkg/commands/hpexpire.ts\nvar HPExpireCommand = class extends Command {\n  constructor(cmd, opts) {\n    const [key, fields, milliseconds, option] = cmd;\n    const fieldArray = Array.isArray(fields) ? fields : [fields];\n    super(\n      [\n        \"hpexpire\",\n        key,\n        milliseconds,\n        ...option ? [option] : [],\n        \"FIELDS\",\n        fieldArray.length,\n        ...fieldArray\n      ],\n      opts\n    );\n  }\n};\n\n// pkg/commands/hpexpireat.ts\nvar HPExpireAtCommand = class extends Command {\n  constructor(cmd, opts) {\n    const [key, fields, timestamp, option] = cmd;\n    const fieldArray = Array.isArray(fields) ? fields : [fields];\n    super(\n      [\n        \"hpexpireat\",\n        key,\n        timestamp,\n        ...option ? [option] : [],\n        \"FIELDS\",\n        fieldArray.length,\n        ...fieldArray\n      ],\n      opts\n    );\n  }\n};\n\n// pkg/commands/hpexpiretime.ts\nvar HPExpireTimeCommand = class extends Command {\n  constructor(cmd, opts) {\n    const [key, fields] = cmd;\n    const fieldArray = Array.isArray(fields) ? fields : [fields];\n    super([\"hpexpiretime\", key, \"FIELDS\", fieldArray.length, ...fieldArray], opts);\n  }\n};\n\n// pkg/commands/hpttl.ts\nvar HPTtlCommand = class extends Command {\n  constructor(cmd, opts) {\n    const [key, fields] = cmd;\n    const fieldArray = Array.isArray(fields) ? fields : [fields];\n    super([\"hpttl\", key, \"FIELDS\", fieldArray.length, ...fieldArray], opts);\n  }\n};\n\n// pkg/commands/hget.ts\nvar HGetCommand = class extends Command {\n  constructor(cmd, opts) {\n    super([\"hget\", ...cmd], opts);\n  }\n};\n\n// pkg/commands/hgetall.ts\nfunction deserialize2(result) {\n  if (result.length === 0) {\n    return null;\n  }\n  const obj = {};\n  for (let i = 0; i < result.length; i += 2) {\n    const key = result[i];\n    const value = result[i + 1];\n    try {\n      const valueIsNumberAndNotSafeInteger = !Number.isNaN(Number(value)) && !Number.isSafeInteger(Number(value));\n      obj[key] = valueIsNumberAndNotSafeInteger ? value : JSON.parse(value);\n    } catch {\n      obj[key] = value;\n    }\n  }\n  return obj;\n}\nvar HGetAllCommand = class extends Command {\n  constructor(cmd, opts) {\n    super([\"hgetall\", ...cmd], {\n      deserialize: (result) => deserialize2(result),\n      ...opts\n    });\n  }\n};\n\n// pkg/commands/hincrby.ts\nvar HIncrByCommand = class extends Command {\n  constructor(cmd, opts) {\n    super([\"hincrby\", ...cmd], opts);\n  }\n};\n\n// pkg/commands/hincrbyfloat.ts\nvar HIncrByFloatCommand = class extends Command {\n  constructor(cmd, opts) {\n    super([\"hincrbyfloat\", ...cmd], opts);\n  }\n};\n\n// pkg/commands/hkeys.ts\nvar HKeysCommand = class extends Command {\n  constructor([key], opts) {\n    super([\"hkeys\", key], opts);\n  }\n};\n\n// pkg/commands/hlen.ts\nvar HLenCommand = class extends Command {\n  constructor(cmd, opts) {\n    super([\"hlen\", ...cmd], opts);\n  }\n};\n\n// pkg/commands/hmget.ts\nfunction deserialize3(fields, result) {\n  if (result.every((field) => field === null)) {\n    return null;\n  }\n  const obj = {};\n  for (const [i, field] of fields.entries()) {\n    try {\n      obj[field] = JSON.parse(result[i]);\n    } catch {\n      obj[field] = result[i];\n    }\n  }\n  return obj;\n}\nvar HMGetCommand = class extends Command {\n  constructor([key, ...fields], opts) {\n    super([\"hmget\", key, ...fields], {\n      deserialize: (result) => deserialize3(fields, result),\n      ...opts\n    });\n  }\n};\n\n// pkg/commands/hmset.ts\nvar HMSetCommand = class extends Command {\n  constructor([key, kv], opts) {\n    super([\"hmset\", key, ...Object.entries(kv).flatMap(([field, value]) => [field, value])], opts);\n  }\n};\n\n// pkg/commands/hscan.ts\nvar HScanCommand = class extends Command {\n  constructor([key, cursor, cmdOpts], opts) {\n    const command = [\"hscan\", key, cursor];\n    if (cmdOpts?.match) {\n      command.push(\"match\", cmdOpts.match);\n    }\n    if (typeof cmdOpts?.count === \"number\") {\n      command.push(\"count\", cmdOpts.count);\n    }\n    super(command, {\n      deserialize: deserializeScanResponse,\n      ...opts\n    });\n  }\n};\n\n// pkg/commands/hset.ts\nvar HSetCommand = class extends Command {\n  constructor([key, kv], opts) {\n    super([\"hset\", key, ...Object.entries(kv).flatMap(([field, value]) => [field, value])], opts);\n  }\n};\n\n// pkg/commands/hsetnx.ts\nvar HSetNXCommand = class extends Command {\n  constructor(cmd, opts) {\n    super([\"hsetnx\", ...cmd], opts);\n  }\n};\n\n// pkg/commands/hstrlen.ts\nvar HStrLenCommand = class extends Command {\n  constructor(cmd, opts) {\n    super([\"hstrlen\", ...cmd], opts);\n  }\n};\n\n// pkg/commands/httl.ts\nvar HTtlCommand = class extends Command {\n  constructor(cmd, opts) {\n    const [key, fields] = cmd;\n    const fieldArray = Array.isArray(fields) ? fields : [fields];\n    super([\"httl\", key, \"FIELDS\", fieldArray.length, ...fieldArray], opts);\n  }\n};\n\n// pkg/commands/hvals.ts\nvar HValsCommand = class extends Command {\n  constructor(cmd, opts) {\n    super([\"hvals\", ...cmd], opts);\n  }\n};\n\n// pkg/commands/incr.ts\nvar IncrCommand = class extends Command {\n  constructor(cmd, opts) {\n    super([\"incr\", ...cmd], opts);\n  }\n};\n\n// pkg/commands/incrby.ts\nvar IncrByCommand = class extends Command {\n  constructor(cmd, opts) {\n    super([\"incrby\", ...cmd], opts);\n  }\n};\n\n// pkg/commands/incrbyfloat.ts\nvar IncrByFloatCommand = class extends Command {\n  constructor(cmd, opts) {\n    super([\"incrbyfloat\", ...cmd], opts);\n  }\n};\n\n// pkg/commands/json_arrappend.ts\nvar JsonArrAppendCommand = class extends Command {\n  constructor(cmd, opts) {\n    super([\"JSON.ARRAPPEND\", ...cmd], opts);\n  }\n};\n\n// pkg/commands/json_arrindex.ts\nvar JsonArrIndexCommand = class extends Command {\n  constructor(cmd, opts) {\n    super([\"JSON.ARRINDEX\", ...cmd], opts);\n  }\n};\n\n// pkg/commands/json_arrinsert.ts\nvar JsonArrInsertCommand = class extends Command {\n  constructor(cmd, opts) {\n    super([\"JSON.ARRINSERT\", ...cmd], opts);\n  }\n};\n\n// pkg/commands/json_arrlen.ts\nvar JsonArrLenCommand = class extends Command {\n  constructor(cmd, opts) {\n    super([\"JSON.ARRLEN\", cmd[0], cmd[1] ?? \"$\"], opts);\n  }\n};\n\n// pkg/commands/json_arrpop.ts\nvar JsonArrPopCommand = class extends Command {\n  constructor(cmd, opts) {\n    super([\"JSON.ARRPOP\", ...cmd], opts);\n  }\n};\n\n// pkg/commands/json_arrtrim.ts\nvar JsonArrTrimCommand = class extends Command {\n  constructor(cmd, opts) {\n    const path = cmd[1] ?? \"$\";\n    const start = cmd[2] ?? 0;\n    const stop = cmd[3] ?? 0;\n    super([\"JSON.ARRTRIM\", cmd[0], path, start, stop], opts);\n  }\n};\n\n// pkg/commands/json_clear.ts\nvar JsonClearCommand = class extends Command {\n  constructor(cmd, opts) {\n    super([\"JSON.CLEAR\", ...cmd], opts);\n  }\n};\n\n// pkg/commands/json_del.ts\nvar JsonDelCommand = class extends Command {\n  constructor(cmd, opts) {\n    super([\"JSON.DEL\", ...cmd], opts);\n  }\n};\n\n// pkg/commands/json_forget.ts\nvar JsonForgetCommand = class extends Command {\n  constructor(cmd, opts) {\n    super([\"JSON.FORGET\", ...cmd], opts);\n  }\n};\n\n// pkg/commands/json_get.ts\nvar JsonGetCommand = class extends Command {\n  constructor(cmd, opts) {\n    const command = [\"JSON.GET\"];\n    if (typeof cmd[1] === \"string\") {\n      command.push(...cmd);\n    } else {\n      command.push(cmd[0]);\n      if (cmd[1]) {\n        if (cmd[1].indent) {\n          command.push(\"INDENT\", cmd[1].indent);\n        }\n        if (cmd[1].newline) {\n          command.push(\"NEWLINE\", cmd[1].newline);\n        }\n        if (cmd[1].space) {\n          command.push(\"SPACE\", cmd[1].space);\n        }\n      }\n      command.push(...cmd.slice(2));\n    }\n    super(command, opts);\n  }\n};\n\n// pkg/commands/json_merge.ts\nvar JsonMergeCommand = class extends Command {\n  constructor(cmd, opts) {\n    const command = [\"JSON.MERGE\", ...cmd];\n    super(command, opts);\n  }\n};\n\n// pkg/commands/json_mget.ts\nvar JsonMGetCommand = class extends Command {\n  constructor(cmd, opts) {\n    super([\"JSON.MGET\", ...cmd[0], cmd[1]], opts);\n  }\n};\n\n// pkg/commands/json_mset.ts\nvar JsonMSetCommand = class extends Command {\n  constructor(cmd, opts) {\n    const command = [\"JSON.MSET\"];\n    for (const c of cmd) {\n      command.push(c.key, c.path, c.value);\n    }\n    super(command, opts);\n  }\n};\n\n// pkg/commands/json_numincrby.ts\nvar JsonNumIncrByCommand = class extends Command {\n  constructor(cmd, opts) {\n    super([\"JSON.NUMINCRBY\", ...cmd], opts);\n  }\n};\n\n// pkg/commands/json_nummultby.ts\nvar JsonNumMultByCommand = class extends Command {\n  constructor(cmd, opts) {\n    super([\"JSON.NUMMULTBY\", ...cmd], opts);\n  }\n};\n\n// pkg/commands/json_objkeys.ts\nvar JsonObjKeysCommand = class extends Command {\n  constructor(cmd, opts) {\n    super([\"JSON.OBJKEYS\", ...cmd], opts);\n  }\n};\n\n// pkg/commands/json_objlen.ts\nvar JsonObjLenCommand = class extends Command {\n  constructor(cmd, opts) {\n    super([\"JSON.OBJLEN\", ...cmd], opts);\n  }\n};\n\n// pkg/commands/json_resp.ts\nvar JsonRespCommand = class extends Command {\n  constructor(cmd, opts) {\n    super([\"JSON.RESP\", ...cmd], opts);\n  }\n};\n\n// pkg/commands/json_set.ts\nvar JsonSetCommand = class extends Command {\n  constructor(cmd, opts) {\n    const command = [\"JSON.SET\", cmd[0], cmd[1], cmd[2]];\n    if (cmd[3]) {\n      if (cmd[3].nx) {\n        command.push(\"NX\");\n      } else if (cmd[3].xx) {\n        command.push(\"XX\");\n      }\n    }\n    super(command, opts);\n  }\n};\n\n// pkg/commands/json_strappend.ts\nvar JsonStrAppendCommand = class extends Command {\n  constructor(cmd, opts) {\n    super([\"JSON.STRAPPEND\", ...cmd], opts);\n  }\n};\n\n// pkg/commands/json_strlen.ts\nvar JsonStrLenCommand = class extends Command {\n  constructor(cmd, opts) {\n    super([\"JSON.STRLEN\", ...cmd], opts);\n  }\n};\n\n// pkg/commands/json_toggle.ts\nvar JsonToggleCommand = class extends Command {\n  constructor(cmd, opts) {\n    super([\"JSON.TOGGLE\", ...cmd], opts);\n  }\n};\n\n// pkg/commands/json_type.ts\nvar JsonTypeCommand = class extends Command {\n  constructor(cmd, opts) {\n    super([\"JSON.TYPE\", ...cmd], opts);\n  }\n};\n\n// pkg/commands/keys.ts\nvar KeysCommand = class extends Command {\n  constructor(cmd, opts) {\n    super([\"keys\", ...cmd], opts);\n  }\n};\n\n// pkg/commands/lindex.ts\nvar LIndexCommand = class extends Command {\n  constructor(cmd, opts) {\n    super([\"lindex\", ...cmd], opts);\n  }\n};\n\n// pkg/commands/linsert.ts\nvar LInsertCommand = class extends Command {\n  constructor(cmd, opts) {\n    super([\"linsert\", ...cmd], opts);\n  }\n};\n\n// pkg/commands/llen.ts\nvar LLenCommand = class extends Command {\n  constructor(cmd, opts) {\n    super([\"llen\", ...cmd], opts);\n  }\n};\n\n// pkg/commands/lmove.ts\nvar LMoveCommand = class extends Command {\n  constructor(cmd, opts) {\n    super([\"lmove\", ...cmd], opts);\n  }\n};\n\n// pkg/commands/lmpop.ts\nvar LmPopCommand = class extends Command {\n  constructor(cmd, opts) {\n    const [numkeys, keys, direction, count] = cmd;\n    super([\"LMPOP\", numkeys, ...keys, direction, ...count ? [\"COUNT\", count] : []], opts);\n  }\n};\n\n// pkg/commands/lpop.ts\nvar LPopCommand = class extends Command {\n  constructor(cmd, opts) {\n    super([\"lpop\", ...cmd], opts);\n  }\n};\n\n// pkg/commands/lpos.ts\nvar LPosCommand = class extends Command {\n  constructor(cmd, opts) {\n    const args = [\"lpos\", cmd[0], cmd[1]];\n    if (typeof cmd[2]?.rank === \"number\") {\n      args.push(\"rank\", cmd[2].rank);\n    }\n    if (typeof cmd[2]?.count === \"number\") {\n      args.push(\"count\", cmd[2].count);\n    }\n    if (typeof cmd[2]?.maxLen === \"number\") {\n      args.push(\"maxLen\", cmd[2].maxLen);\n    }\n    super(args, opts);\n  }\n};\n\n// pkg/commands/lpush.ts\nvar LPushCommand = class extends Command {\n  constructor(cmd, opts) {\n    super([\"lpush\", ...cmd], opts);\n  }\n};\n\n// pkg/commands/lpushx.ts\nvar LPushXCommand = class extends Command {\n  constructor(cmd, opts) {\n    super([\"lpushx\", ...cmd], opts);\n  }\n};\n\n// pkg/commands/lrange.ts\nvar LRangeCommand = class extends Command {\n  constructor(cmd, opts) {\n    super([\"lrange\", ...cmd], opts);\n  }\n};\n\n// pkg/commands/lrem.ts\nvar LRemCommand = class extends Command {\n  constructor(cmd, opts) {\n    super([\"lrem\", ...cmd], opts);\n  }\n};\n\n// pkg/commands/lset.ts\nvar LSetCommand = class extends Command {\n  constructor(cmd, opts) {\n    super([\"lset\", ...cmd], opts);\n  }\n};\n\n// pkg/commands/ltrim.ts\nvar LTrimCommand = class extends Command {\n  constructor(cmd, opts) {\n    super([\"ltrim\", ...cmd], opts);\n  }\n};\n\n// pkg/commands/mget.ts\nvar MGetCommand = class extends Command {\n  constructor(cmd, opts) {\n    const keys = Array.isArray(cmd[0]) ? cmd[0] : cmd;\n    super([\"mget\", ...keys], opts);\n  }\n};\n\n// pkg/commands/mset.ts\nvar MSetCommand = class extends Command {\n  constructor([kv], opts) {\n    super([\"mset\", ...Object.entries(kv).flatMap(([key, value]) => [key, value])], opts);\n  }\n};\n\n// pkg/commands/msetnx.ts\nvar MSetNXCommand = class extends Command {\n  constructor([kv], opts) {\n    super([\"msetnx\", ...Object.entries(kv).flat()], opts);\n  }\n};\n\n// pkg/commands/persist.ts\nvar PersistCommand = class extends Command {\n  constructor(cmd, opts) {\n    super([\"persist\", ...cmd], opts);\n  }\n};\n\n// pkg/commands/pexpire.ts\nvar PExpireCommand = class extends Command {\n  constructor(cmd, opts) {\n    super([\"pexpire\", ...cmd], opts);\n  }\n};\n\n// pkg/commands/pexpireat.ts\nvar PExpireAtCommand = class extends Command {\n  constructor(cmd, opts) {\n    super([\"pexpireat\", ...cmd], opts);\n  }\n};\n\n// pkg/commands/pfadd.ts\nvar PfAddCommand = class extends Command {\n  constructor(cmd, opts) {\n    super([\"pfadd\", ...cmd], opts);\n  }\n};\n\n// pkg/commands/pfcount.ts\nvar PfCountCommand = class extends Command {\n  constructor(cmd, opts) {\n    super([\"pfcount\", ...cmd], opts);\n  }\n};\n\n// pkg/commands/pfmerge.ts\nvar PfMergeCommand = class extends Command {\n  constructor(cmd, opts) {\n    super([\"pfmerge\", ...cmd], opts);\n  }\n};\n\n// pkg/commands/ping.ts\nvar PingCommand = class extends Command {\n  constructor(cmd, opts) {\n    const command = [\"ping\"];\n    if (cmd?.[0] !== void 0) {\n      command.push(cmd[0]);\n    }\n    super(command, opts);\n  }\n};\n\n// pkg/commands/psetex.ts\nvar PSetEXCommand = class extends Command {\n  constructor(cmd, opts) {\n    super([\"psetex\", ...cmd], opts);\n  }\n};\n\n// pkg/commands/pttl.ts\nvar PTtlCommand = class extends Command {\n  constructor(cmd, opts) {\n    super([\"pttl\", ...cmd], opts);\n  }\n};\n\n// pkg/commands/publish.ts\nvar PublishCommand = class extends Command {\n  constructor(cmd, opts) {\n    super([\"publish\", ...cmd], opts);\n  }\n};\n\n// pkg/commands/randomkey.ts\nvar RandomKeyCommand = class extends Command {\n  constructor(opts) {\n    super([\"randomkey\"], opts);\n  }\n};\n\n// pkg/commands/rename.ts\nvar RenameCommand = class extends Command {\n  constructor(cmd, opts) {\n    super([\"rename\", ...cmd], opts);\n  }\n};\n\n// pkg/commands/renamenx.ts\nvar RenameNXCommand = class extends Command {\n  constructor(cmd, opts) {\n    super([\"renamenx\", ...cmd], opts);\n  }\n};\n\n// pkg/commands/rpop.ts\nvar RPopCommand = class extends Command {\n  constructor(cmd, opts) {\n    super([\"rpop\", ...cmd], opts);\n  }\n};\n\n// pkg/commands/rpush.ts\nvar RPushCommand = class extends Command {\n  constructor(cmd, opts) {\n    super([\"rpush\", ...cmd], opts);\n  }\n};\n\n// pkg/commands/rpushx.ts\nvar RPushXCommand = class extends Command {\n  constructor(cmd, opts) {\n    super([\"rpushx\", ...cmd], opts);\n  }\n};\n\n// pkg/commands/sadd.ts\nvar SAddCommand = class extends Command {\n  constructor(cmd, opts) {\n    super([\"sadd\", ...cmd], opts);\n  }\n};\n\n// pkg/commands/scan.ts\nvar ScanCommand = class extends Command {\n  constructor([cursor, opts], cmdOpts) {\n    const command = [\"scan\", cursor];\n    if (opts?.match) {\n      command.push(\"match\", opts.match);\n    }\n    if (typeof opts?.count === \"number\") {\n      command.push(\"count\", opts.count);\n    }\n    if (opts && \"withType\" in opts && opts.withType === true) {\n      command.push(\"withtype\");\n    } else if (opts && \"type\" in opts && opts.type && opts.type.length > 0) {\n      command.push(\"type\", opts.type);\n    }\n    super(command, {\n      // @ts-expect-error ignore types here\n      deserialize: opts?.withType ? deserializeScanWithTypesResponse : deserializeScanResponse,\n      ...cmdOpts\n    });\n  }\n};\n\n// pkg/commands/scard.ts\nvar SCardCommand = class extends Command {\n  constructor(cmd, opts) {\n    super([\"scard\", ...cmd], opts);\n  }\n};\n\n// pkg/commands/script_exists.ts\nvar ScriptExistsCommand = class extends Command {\n  constructor(hashes, opts) {\n    super([\"script\", \"exists\", ...hashes], {\n      deserialize: (result) => result,\n      ...opts\n    });\n  }\n};\n\n// pkg/commands/script_flush.ts\nvar ScriptFlushCommand = class extends Command {\n  constructor([opts], cmdOpts) {\n    const cmd = [\"script\", \"flush\"];\n    if (opts?.sync) {\n      cmd.push(\"sync\");\n    } else if (opts?.async) {\n      cmd.push(\"async\");\n    }\n    super(cmd, cmdOpts);\n  }\n};\n\n// pkg/commands/script_load.ts\nvar ScriptLoadCommand = class extends Command {\n  constructor(args, opts) {\n    super([\"script\", \"load\", ...args], opts);\n  }\n};\n\n// pkg/commands/sdiff.ts\nvar SDiffCommand = class extends Command {\n  constructor(cmd, opts) {\n    super([\"sdiff\", ...cmd], opts);\n  }\n};\n\n// pkg/commands/sdiffstore.ts\nvar SDiffStoreCommand = class extends Command {\n  constructor(cmd, opts) {\n    super([\"sdiffstore\", ...cmd], opts);\n  }\n};\n\n// pkg/commands/set.ts\nvar SetCommand = class extends Command {\n  constructor([key, value, opts], cmdOpts) {\n    const command = [\"set\", key, value];\n    if (opts) {\n      if (\"nx\" in opts && opts.nx) {\n        command.push(\"nx\");\n      } else if (\"xx\" in opts && opts.xx) {\n        command.push(\"xx\");\n      }\n      if (\"get\" in opts && opts.get) {\n        command.push(\"get\");\n      }\n      if (\"ex\" in opts && typeof opts.ex === \"number\") {\n        command.push(\"ex\", opts.ex);\n      } else if (\"px\" in opts && typeof opts.px === \"number\") {\n        command.push(\"px\", opts.px);\n      } else if (\"exat\" in opts && typeof opts.exat === \"number\") {\n        command.push(\"exat\", opts.exat);\n      } else if (\"pxat\" in opts && typeof opts.pxat === \"number\") {\n        command.push(\"pxat\", opts.pxat);\n      } else if (\"keepTtl\" in opts && opts.keepTtl) {\n        command.push(\"keepTtl\");\n      }\n    }\n    super(command, cmdOpts);\n  }\n};\n\n// pkg/commands/setbit.ts\nvar SetBitCommand = class extends Command {\n  constructor(cmd, opts) {\n    super([\"setbit\", ...cmd], opts);\n  }\n};\n\n// pkg/commands/setex.ts\nvar SetExCommand = class extends Command {\n  constructor(cmd, opts) {\n    super([\"setex\", ...cmd], opts);\n  }\n};\n\n// pkg/commands/setnx.ts\nvar SetNxCommand = class extends Command {\n  constructor(cmd, opts) {\n    super([\"setnx\", ...cmd], opts);\n  }\n};\n\n// pkg/commands/setrange.ts\nvar SetRangeCommand = class extends Command {\n  constructor(cmd, opts) {\n    super([\"setrange\", ...cmd], opts);\n  }\n};\n\n// pkg/commands/sinter.ts\nvar SInterCommand = class extends Command {\n  constructor(cmd, opts) {\n    super([\"sinter\", ...cmd], opts);\n  }\n};\n\n// pkg/commands/sinterstore.ts\nvar SInterStoreCommand = class extends Command {\n  constructor(cmd, opts) {\n    super([\"sinterstore\", ...cmd], opts);\n  }\n};\n\n// pkg/commands/sismember.ts\nvar SIsMemberCommand = class extends Command {\n  constructor(cmd, opts) {\n    super([\"sismember\", ...cmd], opts);\n  }\n};\n\n// pkg/commands/smembers.ts\nvar SMembersCommand = class extends Command {\n  constructor(cmd, opts) {\n    super([\"smembers\", ...cmd], opts);\n  }\n};\n\n// pkg/commands/smismember.ts\nvar SMIsMemberCommand = class extends Command {\n  constructor(cmd, opts) {\n    super([\"smismember\", cmd[0], ...cmd[1]], opts);\n  }\n};\n\n// pkg/commands/smove.ts\nvar SMoveCommand = class extends Command {\n  constructor(cmd, opts) {\n    super([\"smove\", ...cmd], opts);\n  }\n};\n\n// pkg/commands/spop.ts\nvar SPopCommand = class extends Command {\n  constructor([key, count], opts) {\n    const command = [\"spop\", key];\n    if (typeof count === \"number\") {\n      command.push(count);\n    }\n    super(command, opts);\n  }\n};\n\n// pkg/commands/srandmember.ts\nvar SRandMemberCommand = class extends Command {\n  constructor([key, count], opts) {\n    const command = [\"srandmember\", key];\n    if (typeof count === \"number\") {\n      command.push(count);\n    }\n    super(command, opts);\n  }\n};\n\n// pkg/commands/srem.ts\nvar SRemCommand = class extends Command {\n  constructor(cmd, opts) {\n    super([\"srem\", ...cmd], opts);\n  }\n};\n\n// pkg/commands/sscan.ts\nvar SScanCommand = class extends Command {\n  constructor([key, cursor, opts], cmdOpts) {\n    const command = [\"sscan\", key, cursor];\n    if (opts?.match) {\n      command.push(\"match\", opts.match);\n    }\n    if (typeof opts?.count === \"number\") {\n      command.push(\"count\", opts.count);\n    }\n    super(command, {\n      deserialize: deserializeScanResponse,\n      ...cmdOpts\n    });\n  }\n};\n\n// pkg/commands/strlen.ts\nvar StrLenCommand = class extends Command {\n  constructor(cmd, opts) {\n    super([\"strlen\", ...cmd], opts);\n  }\n};\n\n// pkg/commands/sunion.ts\nvar SUnionCommand = class extends Command {\n  constructor(cmd, opts) {\n    super([\"sunion\", ...cmd], opts);\n  }\n};\n\n// pkg/commands/sunionstore.ts\nvar SUnionStoreCommand = class extends Command {\n  constructor(cmd, opts) {\n    super([\"sunionstore\", ...cmd], opts);\n  }\n};\n\n// pkg/commands/time.ts\nvar TimeCommand = class extends Command {\n  constructor(opts) {\n    super([\"time\"], opts);\n  }\n};\n\n// pkg/commands/touch.ts\nvar TouchCommand = class extends Command {\n  constructor(cmd, opts) {\n    super([\"touch\", ...cmd], opts);\n  }\n};\n\n// pkg/commands/ttl.ts\nvar TtlCommand = class extends Command {\n  constructor(cmd, opts) {\n    super([\"ttl\", ...cmd], opts);\n  }\n};\n\n// pkg/commands/type.ts\nvar TypeCommand = class extends Command {\n  constructor(cmd, opts) {\n    super([\"type\", ...cmd], opts);\n  }\n};\n\n// pkg/commands/unlink.ts\nvar UnlinkCommand = class extends Command {\n  constructor(cmd, opts) {\n    super([\"unlink\", ...cmd], opts);\n  }\n};\n\n// pkg/commands/xack.ts\nvar XAckCommand = class extends Command {\n  constructor([key, group, id], opts) {\n    const ids = Array.isArray(id) ? [...id] : [id];\n    super([\"XACK\", key, group, ...ids], opts);\n  }\n};\n\n// pkg/commands/xadd.ts\nvar XAddCommand = class extends Command {\n  constructor([key, id, entries, opts], commandOptions) {\n    const command = [\"XADD\", key];\n    if (opts) {\n      if (opts.nomkStream) {\n        command.push(\"NOMKSTREAM\");\n      }\n      if (opts.trim) {\n        command.push(opts.trim.type, opts.trim.comparison, opts.trim.threshold);\n        if (opts.trim.limit !== void 0) {\n          command.push(\"LIMIT\", opts.trim.limit);\n        }\n      }\n    }\n    command.push(id);\n    for (const [k, v] of Object.entries(entries)) {\n      command.push(k, v);\n    }\n    super(command, commandOptions);\n  }\n};\n\n// pkg/commands/xautoclaim.ts\nvar XAutoClaim = class extends Command {\n  constructor([key, group, consumer, minIdleTime, start, options], opts) {\n    const commands = [];\n    if (options?.count) {\n      commands.push(\"COUNT\", options.count);\n    }\n    if (options?.justId) {\n      commands.push(\"JUSTID\");\n    }\n    super([\"XAUTOCLAIM\", key, group, consumer, minIdleTime, start, ...commands], opts);\n  }\n};\n\n// pkg/commands/xclaim.ts\nvar XClaimCommand = class extends Command {\n  constructor([key, group, consumer, minIdleTime, id, options], opts) {\n    const ids = Array.isArray(id) ? [...id] : [id];\n    const commands = [];\n    if (options?.idleMS) {\n      commands.push(\"IDLE\", options.idleMS);\n    }\n    if (options?.idleMS) {\n      commands.push(\"TIME\", options.timeMS);\n    }\n    if (options?.retryCount) {\n      commands.push(\"RETRYCOUNT\", options.retryCount);\n    }\n    if (options?.force) {\n      commands.push(\"FORCE\");\n    }\n    if (options?.justId) {\n      commands.push(\"JUSTID\");\n    }\n    if (options?.lastId) {\n      commands.push(\"LASTID\", options.lastId);\n    }\n    super([\"XCLAIM\", key, group, consumer, minIdleTime, ...ids, ...commands], opts);\n  }\n};\n\n// pkg/commands/xdel.ts\nvar XDelCommand = class extends Command {\n  constructor([key, ids], opts) {\n    const cmds = Array.isArray(ids) ? [...ids] : [ids];\n    super([\"XDEL\", key, ...cmds], opts);\n  }\n};\n\n// pkg/commands/xgroup.ts\nvar XGroupCommand = class extends Command {\n  constructor([key, opts], commandOptions) {\n    const command = [\"XGROUP\"];\n    switch (opts.type) {\n      case \"CREATE\": {\n        command.push(\"CREATE\", key, opts.group, opts.id);\n        if (opts.options) {\n          if (opts.options.MKSTREAM) {\n            command.push(\"MKSTREAM\");\n          }\n          if (opts.options.ENTRIESREAD !== void 0) {\n            command.push(\"ENTRIESREAD\", opts.options.ENTRIESREAD.toString());\n          }\n        }\n        break;\n      }\n      case \"CREATECONSUMER\": {\n        command.push(\"CREATECONSUMER\", key, opts.group, opts.consumer);\n        break;\n      }\n      case \"DELCONSUMER\": {\n        command.push(\"DELCONSUMER\", key, opts.group, opts.consumer);\n        break;\n      }\n      case \"DESTROY\": {\n        command.push(\"DESTROY\", key, opts.group);\n        break;\n      }\n      case \"SETID\": {\n        command.push(\"SETID\", key, opts.group, opts.id);\n        if (opts.options?.ENTRIESREAD !== void 0) {\n          command.push(\"ENTRIESREAD\", opts.options.ENTRIESREAD.toString());\n        }\n        break;\n      }\n      default: {\n        throw new Error(\"Invalid XGROUP\");\n      }\n    }\n    super(command, commandOptions);\n  }\n};\n\n// pkg/commands/xinfo.ts\nvar XInfoCommand = class extends Command {\n  constructor([key, options], opts) {\n    const cmds = [];\n    if (options.type === \"CONSUMERS\") {\n      cmds.push(\"CONSUMERS\", key, options.group);\n    } else {\n      cmds.push(\"GROUPS\", key);\n    }\n    super([\"XINFO\", ...cmds], opts);\n  }\n};\n\n// pkg/commands/xlen.ts\nvar XLenCommand = class extends Command {\n  constructor(cmd, opts) {\n    super([\"XLEN\", ...cmd], opts);\n  }\n};\n\n// pkg/commands/xpending.ts\nvar XPendingCommand = class extends Command {\n  constructor([key, group, start, end, count, options], opts) {\n    const consumers = options?.consumer === void 0 ? [] : Array.isArray(options.consumer) ? [...options.consumer] : [options.consumer];\n    super(\n      [\n        \"XPENDING\",\n        key,\n        group,\n        ...options?.idleTime ? [\"IDLE\", options.idleTime] : [],\n        start,\n        end,\n        count,\n        ...consumers\n      ],\n      opts\n    );\n  }\n};\n\n// pkg/commands/xrange.ts\nfunction deserialize4(result) {\n  const obj = {};\n  for (const e of result) {\n    for (let i = 0; i < e.length; i += 2) {\n      const streamId = e[i];\n      const entries = e[i + 1];\n      if (!(streamId in obj)) {\n        obj[streamId] = {};\n      }\n      for (let j = 0; j < entries.length; j += 2) {\n        const field = entries[j];\n        const value = entries[j + 1];\n        try {\n          obj[streamId][field] = JSON.parse(value);\n        } catch {\n          obj[streamId][field] = value;\n        }\n      }\n    }\n  }\n  return obj;\n}\nvar XRangeCommand = class extends Command {\n  constructor([key, start, end, count], opts) {\n    const command = [\"XRANGE\", key, start, end];\n    if (typeof count === \"number\") {\n      command.push(\"COUNT\", count);\n    }\n    super(command, {\n      deserialize: (result) => deserialize4(result),\n      ...opts\n    });\n  }\n};\n\n// pkg/commands/xread.ts\nvar UNBALANCED_XREAD_ERR = \"ERR Unbalanced XREAD list of streams: for each stream key an ID or '$' must be specified\";\nvar XReadCommand = class extends Command {\n  constructor([key, id, options], opts) {\n    if (Array.isArray(key) && Array.isArray(id) && key.length !== id.length) {\n      throw new Error(UNBALANCED_XREAD_ERR);\n    }\n    const commands = [];\n    if (typeof options?.count === \"number\") {\n      commands.push(\"COUNT\", options.count);\n    }\n    if (typeof options?.blockMS === \"number\") {\n      commands.push(\"BLOCK\", options.blockMS);\n    }\n    commands.push(\n      \"STREAMS\",\n      ...Array.isArray(key) ? [...key] : [key],\n      ...Array.isArray(id) ? [...id] : [id]\n    );\n    super([\"XREAD\", ...commands], opts);\n  }\n};\n\n// pkg/commands/xreadgroup.ts\nvar UNBALANCED_XREADGROUP_ERR = \"ERR Unbalanced XREADGROUP list of streams: for each stream key an ID or '$' must be specified\";\nvar XReadGroupCommand = class extends Command {\n  constructor([group, consumer, key, id, options], opts) {\n    if (Array.isArray(key) && Array.isArray(id) && key.length !== id.length) {\n      throw new Error(UNBALANCED_XREADGROUP_ERR);\n    }\n    const commands = [];\n    if (typeof options?.count === \"number\") {\n      commands.push(\"COUNT\", options.count);\n    }\n    if (typeof options?.blockMS === \"number\") {\n      commands.push(\"BLOCK\", options.blockMS);\n    }\n    if (typeof options?.NOACK === \"boolean\" && options.NOACK) {\n      commands.push(\"NOACK\");\n    }\n    commands.push(\n      \"STREAMS\",\n      ...Array.isArray(key) ? [...key] : [key],\n      ...Array.isArray(id) ? [...id] : [id]\n    );\n    super([\"XREADGROUP\", \"GROUP\", group, consumer, ...commands], opts);\n  }\n};\n\n// pkg/commands/xrevrange.ts\nvar XRevRangeCommand = class extends Command {\n  constructor([key, end, start, count], opts) {\n    const command = [\"XREVRANGE\", key, end, start];\n    if (typeof count === \"number\") {\n      command.push(\"COUNT\", count);\n    }\n    super(command, {\n      deserialize: (result) => deserialize5(result),\n      ...opts\n    });\n  }\n};\nfunction deserialize5(result) {\n  const obj = {};\n  for (const e of result) {\n    for (let i = 0; i < e.length; i += 2) {\n      const streamId = e[i];\n      const entries = e[i + 1];\n      if (!(streamId in obj)) {\n        obj[streamId] = {};\n      }\n      for (let j = 0; j < entries.length; j += 2) {\n        const field = entries[j];\n        const value = entries[j + 1];\n        try {\n          obj[streamId][field] = JSON.parse(value);\n        } catch {\n          obj[streamId][field] = value;\n        }\n      }\n    }\n  }\n  return obj;\n}\n\n// pkg/commands/xtrim.ts\nvar XTrimCommand = class extends Command {\n  constructor([key, options], opts) {\n    const { limit, strategy, threshold, exactness = \"~\" } = options;\n    super([\"XTRIM\", key, strategy, exactness, threshold, ...limit ? [\"LIMIT\", limit] : []], opts);\n  }\n};\n\n// pkg/commands/zadd.ts\nvar ZAddCommand = class extends Command {\n  constructor([key, arg1, ...arg2], opts) {\n    const command = [\"zadd\", key];\n    if (\"nx\" in arg1 && arg1.nx) {\n      command.push(\"nx\");\n    } else if (\"xx\" in arg1 && arg1.xx) {\n      command.push(\"xx\");\n    }\n    if (\"ch\" in arg1 && arg1.ch) {\n      command.push(\"ch\");\n    }\n    if (\"incr\" in arg1 && arg1.incr) {\n      command.push(\"incr\");\n    }\n    if (\"lt\" in arg1 && arg1.lt) {\n      command.push(\"lt\");\n    } else if (\"gt\" in arg1 && arg1.gt) {\n      command.push(\"gt\");\n    }\n    if (\"score\" in arg1 && \"member\" in arg1) {\n      command.push(arg1.score, arg1.member);\n    }\n    command.push(...arg2.flatMap(({ score, member }) => [score, member]));\n    super(command, opts);\n  }\n};\n\n// pkg/commands/zcard.ts\nvar ZCardCommand = class extends Command {\n  constructor(cmd, opts) {\n    super([\"zcard\", ...cmd], opts);\n  }\n};\n\n// pkg/commands/zcount.ts\nvar ZCountCommand = class extends Command {\n  constructor(cmd, opts) {\n    super([\"zcount\", ...cmd], opts);\n  }\n};\n\n// pkg/commands/zincrby.ts\nvar ZIncrByCommand = class extends Command {\n  constructor(cmd, opts) {\n    super([\"zincrby\", ...cmd], opts);\n  }\n};\n\n// pkg/commands/zinterstore.ts\nvar ZInterStoreCommand = class extends Command {\n  constructor([destination, numKeys, keyOrKeys, opts], cmdOpts) {\n    const command = [\"zinterstore\", destination, numKeys];\n    if (Array.isArray(keyOrKeys)) {\n      command.push(...keyOrKeys);\n    } else {\n      command.push(keyOrKeys);\n    }\n    if (opts) {\n      if (\"weights\" in opts && opts.weights) {\n        command.push(\"weights\", ...opts.weights);\n      } else if (\"weight\" in opts && typeof opts.weight === \"number\") {\n        command.push(\"weights\", opts.weight);\n      }\n      if (\"aggregate\" in opts) {\n        command.push(\"aggregate\", opts.aggregate);\n      }\n    }\n    super(command, cmdOpts);\n  }\n};\n\n// pkg/commands/zlexcount.ts\nvar ZLexCountCommand = class extends Command {\n  constructor(cmd, opts) {\n    super([\"zlexcount\", ...cmd], opts);\n  }\n};\n\n// pkg/commands/zpopmax.ts\nvar ZPopMaxCommand = class extends Command {\n  constructor([key, count], opts) {\n    const command = [\"zpopmax\", key];\n    if (typeof count === \"number\") {\n      command.push(count);\n    }\n    super(command, opts);\n  }\n};\n\n// pkg/commands/zpopmin.ts\nvar ZPopMinCommand = class extends Command {\n  constructor([key, count], opts) {\n    const command = [\"zpopmin\", key];\n    if (typeof count === \"number\") {\n      command.push(count);\n    }\n    super(command, opts);\n  }\n};\n\n// pkg/commands/zrange.ts\nvar ZRangeCommand = class extends Command {\n  constructor([key, min, max, opts], cmdOpts) {\n    const command = [\"zrange\", key, min, max];\n    if (opts?.byScore) {\n      command.push(\"byscore\");\n    }\n    if (opts?.byLex) {\n      command.push(\"bylex\");\n    }\n    if (opts?.rev) {\n      command.push(\"rev\");\n    }\n    if (opts?.count !== void 0 && opts.offset !== void 0) {\n      command.push(\"limit\", opts.offset, opts.count);\n    }\n    if (opts?.withScores) {\n      command.push(\"withscores\");\n    }\n    super(command, cmdOpts);\n  }\n};\n\n// pkg/commands/zrank.ts\nvar ZRankCommand = class extends Command {\n  constructor(cmd, opts) {\n    super([\"zrank\", ...cmd], opts);\n  }\n};\n\n// pkg/commands/zrem.ts\nvar ZRemCommand = class extends Command {\n  constructor(cmd, opts) {\n    super([\"zrem\", ...cmd], opts);\n  }\n};\n\n// pkg/commands/zremrangebylex.ts\nvar ZRemRangeByLexCommand = class extends Command {\n  constructor(cmd, opts) {\n    super([\"zremrangebylex\", ...cmd], opts);\n  }\n};\n\n// pkg/commands/zremrangebyrank.ts\nvar ZRemRangeByRankCommand = class extends Command {\n  constructor(cmd, opts) {\n    super([\"zremrangebyrank\", ...cmd], opts);\n  }\n};\n\n// pkg/commands/zremrangebyscore.ts\nvar ZRemRangeByScoreCommand = class extends Command {\n  constructor(cmd, opts) {\n    super([\"zremrangebyscore\", ...cmd], opts);\n  }\n};\n\n// pkg/commands/zrevrank.ts\nvar ZRevRankCommand = class extends Command {\n  constructor(cmd, opts) {\n    super([\"zrevrank\", ...cmd], opts);\n  }\n};\n\n// pkg/commands/zscan.ts\nvar ZScanCommand = class extends Command {\n  constructor([key, cursor, opts], cmdOpts) {\n    const command = [\"zscan\", key, cursor];\n    if (opts?.match) {\n      command.push(\"match\", opts.match);\n    }\n    if (typeof opts?.count === \"number\") {\n      command.push(\"count\", opts.count);\n    }\n    super(command, {\n      deserialize: deserializeScanResponse,\n      ...cmdOpts\n    });\n  }\n};\n\n// pkg/commands/zscore.ts\nvar ZScoreCommand = class extends Command {\n  constructor(cmd, opts) {\n    super([\"zscore\", ...cmd], opts);\n  }\n};\n\n// pkg/commands/zunion.ts\nvar ZUnionCommand = class extends Command {\n  constructor([numKeys, keyOrKeys, opts], cmdOpts) {\n    const command = [\"zunion\", numKeys];\n    if (Array.isArray(keyOrKeys)) {\n      command.push(...keyOrKeys);\n    } else {\n      command.push(keyOrKeys);\n    }\n    if (opts) {\n      if (\"weights\" in opts && opts.weights) {\n        command.push(\"weights\", ...opts.weights);\n      } else if (\"weight\" in opts && typeof opts.weight === \"number\") {\n        command.push(\"weights\", opts.weight);\n      }\n      if (\"aggregate\" in opts) {\n        command.push(\"aggregate\", opts.aggregate);\n      }\n      if (opts.withScores) {\n        command.push(\"withscores\");\n      }\n    }\n    super(command, cmdOpts);\n  }\n};\n\n// pkg/commands/zunionstore.ts\nvar ZUnionStoreCommand = class extends Command {\n  constructor([destination, numKeys, keyOrKeys, opts], cmdOpts) {\n    const command = [\"zunionstore\", destination, numKeys];\n    if (Array.isArray(keyOrKeys)) {\n      command.push(...keyOrKeys);\n    } else {\n      command.push(keyOrKeys);\n    }\n    if (opts) {\n      if (\"weights\" in opts && opts.weights) {\n        command.push(\"weights\", ...opts.weights);\n      } else if (\"weight\" in opts && typeof opts.weight === \"number\") {\n        command.push(\"weights\", opts.weight);\n      }\n      if (\"aggregate\" in opts) {\n        command.push(\"aggregate\", opts.aggregate);\n      }\n    }\n    super(command, cmdOpts);\n  }\n};\n\n// pkg/commands/zdiffstore.ts\nvar ZDiffStoreCommand = class extends Command {\n  constructor(cmd, opts) {\n    super([\"zdiffstore\", ...cmd], opts);\n  }\n};\n\n// pkg/commands/zmscore.ts\nvar ZMScoreCommand = class extends Command {\n  constructor(cmd, opts) {\n    const [key, members] = cmd;\n    super([\"zmscore\", key, ...members], opts);\n  }\n};\n\n// pkg/pipeline.ts\nvar Pipeline = class {\n  client;\n  commands;\n  commandOptions;\n  multiExec;\n  constructor(opts) {\n    this.client = opts.client;\n    this.commands = [];\n    this.commandOptions = opts.commandOptions;\n    this.multiExec = opts.multiExec ?? false;\n    if (this.commandOptions?.latencyLogging) {\n      const originalExec = this.exec.bind(this);\n      this.exec = async (options) => {\n        const start = performance.now();\n        const result = await (options ? originalExec(options) : originalExec());\n        const end = performance.now();\n        const loggerResult = (end - start).toFixed(2);\n        console.log(\n          `Latency for \\x1B[38;2;19;185;39m${this.multiExec ? [\"MULTI-EXEC\"] : [\"PIPELINE\"].toString().toUpperCase()}\\x1B[0m: \\x1B[38;2;0;255;255m${loggerResult} ms\\x1B[0m`\n        );\n        return result;\n      };\n    }\n  }\n  exec = async (options) => {\n    if (this.commands.length === 0) {\n      throw new Error(\"Pipeline is empty\");\n    }\n    const path = this.multiExec ? [\"multi-exec\"] : [\"pipeline\"];\n    const res = await this.client.request({\n      path,\n      body: Object.values(this.commands).map((c) => c.command)\n    });\n    return options?.keepErrors ? res.map(({ error, result }, i) => {\n      return {\n        error,\n        result: this.commands[i].deserialize(result)\n      };\n    }) : res.map(({ error, result }, i) => {\n      if (error) {\n        throw new UpstashError(\n          `Command ${i + 1} [ ${this.commands[i].command[0]} ] failed: ${error}`\n        );\n      }\n      return this.commands[i].deserialize(result);\n    });\n  };\n  /**\n   * Returns the length of pipeline before the execution\n   */\n  length() {\n    return this.commands.length;\n  }\n  /**\n   * Pushes a command into the pipeline and returns a chainable instance of the\n   * pipeline\n   */\n  chain(command) {\n    this.commands.push(command);\n    return this;\n  }\n  /**\n   * @see https://redis.io/commands/append\n   */\n  append = (...args) => this.chain(new AppendCommand(args, this.commandOptions));\n  /**\n   * @see https://redis.io/commands/bitcount\n   */\n  bitcount = (...args) => this.chain(new BitCountCommand(args, this.commandOptions));\n  /**\n   * Returns an instance that can be used to execute `BITFIELD` commands on one key.\n   *\n   * @example\n   * ```typescript\n   * redis.set(\"mykey\", 0);\n   * const result = await redis.pipeline()\n   *   .bitfield(\"mykey\")\n   *   .set(\"u4\", 0, 16)\n   *   .incr(\"u4\", \"#1\", 1)\n   *   .exec();\n   * console.log(result); // [[0, 1]]\n   * ```\n   *\n   * @see https://redis.io/commands/bitfield\n   */\n  bitfield = (...args) => new BitFieldCommand(args, this.client, this.commandOptions, this.chain.bind(this));\n  /**\n   * @see https://redis.io/commands/bitop\n   */\n  bitop = (op, destinationKey, sourceKey, ...sourceKeys) => this.chain(\n    new BitOpCommand([op, destinationKey, sourceKey, ...sourceKeys], this.commandOptions)\n  );\n  /**\n   * @see https://redis.io/commands/bitpos\n   */\n  bitpos = (...args) => this.chain(new BitPosCommand(args, this.commandOptions));\n  /**\n   * @see https://redis.io/commands/copy\n   */\n  copy = (...args) => this.chain(new CopyCommand(args, this.commandOptions));\n  /**\n   * @see https://redis.io/commands/zdiffstore\n   */\n  zdiffstore = (...args) => this.chain(new ZDiffStoreCommand(args, this.commandOptions));\n  /**\n   * @see https://redis.io/commands/dbsize\n   */\n  dbsize = () => this.chain(new DBSizeCommand(this.commandOptions));\n  /**\n   * @see https://redis.io/commands/decr\n   */\n  decr = (...args) => this.chain(new DecrCommand(args, this.commandOptions));\n  /**\n   * @see https://redis.io/commands/decrby\n   */\n  decrby = (...args) => this.chain(new DecrByCommand(args, this.commandOptions));\n  /**\n   * @see https://redis.io/commands/del\n   */\n  del = (...args) => this.chain(new DelCommand(args, this.commandOptions));\n  /**\n   * @see https://redis.io/commands/echo\n   */\n  echo = (...args) => this.chain(new EchoCommand(args, this.commandOptions));\n  /**\n   * @see https://redis.io/commands/eval_ro\n   */\n  evalRo = (...args) => this.chain(new EvalROCommand(args, this.commandOptions));\n  /**\n   * @see https://redis.io/commands/eval\n   */\n  eval = (...args) => this.chain(new EvalCommand(args, this.commandOptions));\n  /**\n   * @see https://redis.io/commands/evalsha_ro\n   */\n  evalshaRo = (...args) => this.chain(new EvalshaROCommand(args, this.commandOptions));\n  /**\n   * @see https://redis.io/commands/evalsha\n   */\n  evalsha = (...args) => this.chain(new EvalshaCommand(args, this.commandOptions));\n  /**\n   * @see https://redis.io/commands/exists\n   */\n  exists = (...args) => this.chain(new ExistsCommand(args, this.commandOptions));\n  /**\n   * @see https://redis.io/commands/expire\n   */\n  expire = (...args) => this.chain(new ExpireCommand(args, this.commandOptions));\n  /**\n   * @see https://redis.io/commands/expireat\n   */\n  expireat = (...args) => this.chain(new ExpireAtCommand(args, this.commandOptions));\n  /**\n   * @see https://redis.io/commands/flushall\n   */\n  flushall = (args) => this.chain(new FlushAllCommand(args, this.commandOptions));\n  /**\n   * @see https://redis.io/commands/flushdb\n   */\n  flushdb = (...args) => this.chain(new FlushDBCommand(args, this.commandOptions));\n  /**\n   * @see https://redis.io/commands/geoadd\n   */\n  geoadd = (...args) => this.chain(new GeoAddCommand(args, this.commandOptions));\n  /**\n   * @see https://redis.io/commands/geodist\n   */\n  geodist = (...args) => this.chain(new GeoDistCommand(args, this.commandOptions));\n  /**\n   * @see https://redis.io/commands/geopos\n   */\n  geopos = (...args) => this.chain(new GeoPosCommand(args, this.commandOptions));\n  /**\n   * @see https://redis.io/commands/geohash\n   */\n  geohash = (...args) => this.chain(new GeoHashCommand(args, this.commandOptions));\n  /**\n   * @see https://redis.io/commands/geosearch\n   */\n  geosearch = (...args) => this.chain(new GeoSearchCommand(args, this.commandOptions));\n  /**\n   * @see https://redis.io/commands/geosearchstore\n   */\n  geosearchstore = (...args) => this.chain(new GeoSearchStoreCommand(args, this.commandOptions));\n  /**\n   * @see https://redis.io/commands/get\n   */\n  get = (...args) => this.chain(new GetCommand(args, this.commandOptions));\n  /**\n   * @see https://redis.io/commands/getbit\n   */\n  getbit = (...args) => this.chain(new GetBitCommand(args, this.commandOptions));\n  /**\n   * @see https://redis.io/commands/getdel\n   */\n  getdel = (...args) => this.chain(new GetDelCommand(args, this.commandOptions));\n  /**\n   * @see https://redis.io/commands/getex\n   */\n  getex = (...args) => this.chain(new GetExCommand(args, this.commandOptions));\n  /**\n   * @see https://redis.io/commands/getrange\n   */\n  getrange = (...args) => this.chain(new GetRangeCommand(args, this.commandOptions));\n  /**\n   * @see https://redis.io/commands/getset\n   */\n  getset = (key, value) => this.chain(new GetSetCommand([key, value], this.commandOptions));\n  /**\n   * @see https://redis.io/commands/hdel\n   */\n  hdel = (...args) => this.chain(new HDelCommand(args, this.commandOptions));\n  /**\n   * @see https://redis.io/commands/hexists\n   */\n  hexists = (...args) => this.chain(new HExistsCommand(args, this.commandOptions));\n  /**\n   * @see https://redis.io/commands/hexpire\n   */\n  hexpire = (...args) => this.chain(new HExpireCommand(args, this.commandOptions));\n  /**\n   * @see https://redis.io/commands/hexpireat\n   */\n  hexpireat = (...args) => this.chain(new HExpireAtCommand(args, this.commandOptions));\n  /**\n   * @see https://redis.io/commands/hexpiretime\n   */\n  hexpiretime = (...args) => this.chain(new HExpireTimeCommand(args, this.commandOptions));\n  /**\n   * @see https://redis.io/commands/httl\n   */\n  httl = (...args) => this.chain(new HTtlCommand(args, this.commandOptions));\n  /**\n   * @see https://redis.io/commands/hpexpire\n   */\n  hpexpire = (...args) => this.chain(new HPExpireCommand(args, this.commandOptions));\n  /**\n   * @see https://redis.io/commands/hpexpireat\n   */\n  hpexpireat = (...args) => this.chain(new HPExpireAtCommand(args, this.commandOptions));\n  /**\n   * @see https://redis.io/commands/hpexpiretime\n   */\n  hpexpiretime = (...args) => this.chain(new HPExpireTimeCommand(args, this.commandOptions));\n  /**\n   * @see https://redis.io/commands/hpttl\n   */\n  hpttl = (...args) => this.chain(new HPTtlCommand(args, this.commandOptions));\n  /**\n   * @see https://redis.io/commands/hpersist\n   */\n  hpersist = (...args) => this.chain(new HPersistCommand(args, this.commandOptions));\n  /**\n   * @see https://redis.io/commands/hget\n   */\n  hget = (...args) => this.chain(new HGetCommand(args, this.commandOptions));\n  /**\n   * @see https://redis.io/commands/hgetall\n   */\n  hgetall = (...args) => this.chain(new HGetAllCommand(args, this.commandOptions));\n  /**\n   * @see https://redis.io/commands/hincrby\n   */\n  hincrby = (...args) => this.chain(new HIncrByCommand(args, this.commandOptions));\n  /**\n   * @see https://redis.io/commands/hincrbyfloat\n   */\n  hincrbyfloat = (...args) => this.chain(new HIncrByFloatCommand(args, this.commandOptions));\n  /**\n   * @see https://redis.io/commands/hkeys\n   */\n  hkeys = (...args) => this.chain(new HKeysCommand(args, this.commandOptions));\n  /**\n   * @see https://redis.io/commands/hlen\n   */\n  hlen = (...args) => this.chain(new HLenCommand(args, this.commandOptions));\n  /**\n   * @see https://redis.io/commands/hmget\n   */\n  hmget = (...args) => this.chain(new HMGetCommand(args, this.commandOptions));\n  /**\n   * @see https://redis.io/commands/hmset\n   */\n  hmset = (key, kv) => this.chain(new HMSetCommand([key, kv], this.commandOptions));\n  /**\n   * @see https://redis.io/commands/hrandfield\n   */\n  hrandfield = (key, count, withValues) => this.chain(new HRandFieldCommand([key, count, withValues], this.commandOptions));\n  /**\n   * @see https://redis.io/commands/hscan\n   */\n  hscan = (...args) => this.chain(new HScanCommand(args, this.commandOptions));\n  /**\n   * @see https://redis.io/commands/hset\n   */\n  hset = (key, kv) => this.chain(new HSetCommand([key, kv], this.commandOptions));\n  /**\n   * @see https://redis.io/commands/hsetnx\n   */\n  hsetnx = (key, field, value) => this.chain(new HSetNXCommand([key, field, value], this.commandOptions));\n  /**\n   * @see https://redis.io/commands/hstrlen\n   */\n  hstrlen = (...args) => this.chain(new HStrLenCommand(args, this.commandOptions));\n  /**\n   * @see https://redis.io/commands/hvals\n   */\n  hvals = (...args) => this.chain(new HValsCommand(args, this.commandOptions));\n  /**\n   * @see https://redis.io/commands/incr\n   */\n  incr = (...args) => this.chain(new IncrCommand(args, this.commandOptions));\n  /**\n   * @see https://redis.io/commands/incrby\n   */\n  incrby = (...args) => this.chain(new IncrByCommand(args, this.commandOptions));\n  /**\n   * @see https://redis.io/commands/incrbyfloat\n   */\n  incrbyfloat = (...args) => this.chain(new IncrByFloatCommand(args, this.commandOptions));\n  /**\n   * @see https://redis.io/commands/keys\n   */\n  keys = (...args) => this.chain(new KeysCommand(args, this.commandOptions));\n  /**\n   * @see https://redis.io/commands/lindex\n   */\n  lindex = (...args) => this.chain(new LIndexCommand(args, this.commandOptions));\n  /**\n   * @see https://redis.io/commands/linsert\n   */\n  linsert = (key, direction, pivot, value) => this.chain(new LInsertCommand([key, direction, pivot, value], this.commandOptions));\n  /**\n   * @see https://redis.io/commands/llen\n   */\n  llen = (...args) => this.chain(new LLenCommand(args, this.commandOptions));\n  /**\n   * @see https://redis.io/commands/lmove\n   */\n  lmove = (...args) => this.chain(new LMoveCommand(args, this.commandOptions));\n  /**\n   * @see https://redis.io/commands/lpop\n   */\n  lpop = (...args) => this.chain(new LPopCommand(args, this.commandOptions));\n  /**\n   * @see https://redis.io/commands/lmpop\n   */\n  lmpop = (...args) => this.chain(new LmPopCommand(args, this.commandOptions));\n  /**\n   * @see https://redis.io/commands/lpos\n   */\n  lpos = (...args) => this.chain(new LPosCommand(args, this.commandOptions));\n  /**\n   * @see https://redis.io/commands/lpush\n   */\n  lpush = (key, ...elements) => this.chain(new LPushCommand([key, ...elements], this.commandOptions));\n  /**\n   * @see https://redis.io/commands/lpushx\n   */\n  lpushx = (key, ...elements) => this.chain(new LPushXCommand([key, ...elements], this.commandOptions));\n  /**\n   * @see https://redis.io/commands/lrange\n   */\n  lrange = (...args) => this.chain(new LRangeCommand(args, this.commandOptions));\n  /**\n   * @see https://redis.io/commands/lrem\n   */\n  lrem = (key, count, value) => this.chain(new LRemCommand([key, count, value], this.commandOptions));\n  /**\n   * @see https://redis.io/commands/lset\n   */\n  lset = (key, index, value) => this.chain(new LSetCommand([key, index, value], this.commandOptions));\n  /**\n   * @see https://redis.io/commands/ltrim\n   */\n  ltrim = (...args) => this.chain(new LTrimCommand(args, this.commandOptions));\n  /**\n   * @see https://redis.io/commands/mget\n   */\n  mget = (...args) => this.chain(new MGetCommand(args, this.commandOptions));\n  /**\n   * @see https://redis.io/commands/mset\n   */\n  mset = (kv) => this.chain(new MSetCommand([kv], this.commandOptions));\n  /**\n   * @see https://redis.io/commands/msetnx\n   */\n  msetnx = (kv) => this.chain(new MSetNXCommand([kv], this.commandOptions));\n  /**\n   * @see https://redis.io/commands/persist\n   */\n  persist = (...args) => this.chain(new PersistCommand(args, this.commandOptions));\n  /**\n   * @see https://redis.io/commands/pexpire\n   */\n  pexpire = (...args) => this.chain(new PExpireCommand(args, this.commandOptions));\n  /**\n   * @see https://redis.io/commands/pexpireat\n   */\n  pexpireat = (...args) => this.chain(new PExpireAtCommand(args, this.commandOptions));\n  /**\n   * @see https://redis.io/commands/pfadd\n   */\n  pfadd = (...args) => this.chain(new PfAddCommand(args, this.commandOptions));\n  /**\n   * @see https://redis.io/commands/pfcount\n   */\n  pfcount = (...args) => this.chain(new PfCountCommand(args, this.commandOptions));\n  /**\n   * @see https://redis.io/commands/pfmerge\n   */\n  pfmerge = (...args) => this.chain(new PfMergeCommand(args, this.commandOptions));\n  /**\n   * @see https://redis.io/commands/ping\n   */\n  ping = (args) => this.chain(new PingCommand(args, this.commandOptions));\n  /**\n   * @see https://redis.io/commands/psetex\n   */\n  psetex = (key, ttl, value) => this.chain(new PSetEXCommand([key, ttl, value], this.commandOptions));\n  /**\n   * @see https://redis.io/commands/pttl\n   */\n  pttl = (...args) => this.chain(new PTtlCommand(args, this.commandOptions));\n  /**\n   * @see https://redis.io/commands/publish\n   */\n  publish = (...args) => this.chain(new PublishCommand(args, this.commandOptions));\n  /**\n   * @see https://redis.io/commands/randomkey\n   */\n  randomkey = () => this.chain(new RandomKeyCommand(this.commandOptions));\n  /**\n   * @see https://redis.io/commands/rename\n   */\n  rename = (...args) => this.chain(new RenameCommand(args, this.commandOptions));\n  /**\n   * @see https://redis.io/commands/renamenx\n   */\n  renamenx = (...args) => this.chain(new RenameNXCommand(args, this.commandOptions));\n  /**\n   * @see https://redis.io/commands/rpop\n   */\n  rpop = (...args) => this.chain(new RPopCommand(args, this.commandOptions));\n  /**\n   * @see https://redis.io/commands/rpush\n   */\n  rpush = (key, ...elements) => this.chain(new RPushCommand([key, ...elements], this.commandOptions));\n  /**\n   * @see https://redis.io/commands/rpushx\n   */\n  rpushx = (key, ...elements) => this.chain(new RPushXCommand([key, ...elements], this.commandOptions));\n  /**\n   * @see https://redis.io/commands/sadd\n   */\n  sadd = (key, member, ...members) => this.chain(new SAddCommand([key, member, ...members], this.commandOptions));\n  /**\n   * @see https://redis.io/commands/scan\n   */\n  scan = (...args) => this.chain(new ScanCommand(args, this.commandOptions));\n  /**\n   * @see https://redis.io/commands/scard\n   */\n  scard = (...args) => this.chain(new SCardCommand(args, this.commandOptions));\n  /**\n   * @see https://redis.io/commands/script-exists\n   */\n  scriptExists = (...args) => this.chain(new ScriptExistsCommand(args, this.commandOptions));\n  /**\n   * @see https://redis.io/commands/script-flush\n   */\n  scriptFlush = (...args) => this.chain(new ScriptFlushCommand(args, this.commandOptions));\n  /**\n   * @see https://redis.io/commands/script-load\n   */\n  scriptLoad = (...args) => this.chain(new ScriptLoadCommand(args, this.commandOptions));\n  /*)*\n   * @see https://redis.io/commands/sdiff\n   */\n  sdiff = (...args) => this.chain(new SDiffCommand(args, this.commandOptions));\n  /**\n   * @see https://redis.io/commands/sdiffstore\n   */\n  sdiffstore = (...args) => this.chain(new SDiffStoreCommand(args, this.commandOptions));\n  /**\n   * @see https://redis.io/commands/set\n   */\n  set = (key, value, opts) => this.chain(new SetCommand([key, value, opts], this.commandOptions));\n  /**\n   * @see https://redis.io/commands/setbit\n   */\n  setbit = (...args) => this.chain(new SetBitCommand(args, this.commandOptions));\n  /**\n   * @see https://redis.io/commands/setex\n   */\n  setex = (key, ttl, value) => this.chain(new SetExCommand([key, ttl, value], this.commandOptions));\n  /**\n   * @see https://redis.io/commands/setnx\n   */\n  setnx = (key, value) => this.chain(new SetNxCommand([key, value], this.commandOptions));\n  /**\n   * @see https://redis.io/commands/setrange\n   */\n  setrange = (...args) => this.chain(new SetRangeCommand(args, this.commandOptions));\n  /**\n   * @see https://redis.io/commands/sinter\n   */\n  sinter = (...args) => this.chain(new SInterCommand(args, this.commandOptions));\n  /**\n   * @see https://redis.io/commands/sinterstore\n   */\n  sinterstore = (...args) => this.chain(new SInterStoreCommand(args, this.commandOptions));\n  /**\n   * @see https://redis.io/commands/sismember\n   */\n  sismember = (key, member) => this.chain(new SIsMemberCommand([key, member], this.commandOptions));\n  /**\n   * @see https://redis.io/commands/smembers\n   */\n  smembers = (...args) => this.chain(new SMembersCommand(args, this.commandOptions));\n  /**\n   * @see https://redis.io/commands/smismember\n   */\n  smismember = (key, members) => this.chain(new SMIsMemberCommand([key, members], this.commandOptions));\n  /**\n   * @see https://redis.io/commands/smove\n   */\n  smove = (source, destination, member) => this.chain(new SMoveCommand([source, destination, member], this.commandOptions));\n  /**\n   * @see https://redis.io/commands/spop\n   */\n  spop = (...args) => this.chain(new SPopCommand(args, this.commandOptions));\n  /**\n   * @see https://redis.io/commands/srandmember\n   */\n  srandmember = (...args) => this.chain(new SRandMemberCommand(args, this.commandOptions));\n  /**\n   * @see https://redis.io/commands/srem\n   */\n  srem = (key, ...members) => this.chain(new SRemCommand([key, ...members], this.commandOptions));\n  /**\n   * @see https://redis.io/commands/sscan\n   */\n  sscan = (...args) => this.chain(new SScanCommand(args, this.commandOptions));\n  /**\n   * @see https://redis.io/commands/strlen\n   */\n  strlen = (...args) => this.chain(new StrLenCommand(args, this.commandOptions));\n  /**\n   * @see https://redis.io/commands/sunion\n   */\n  sunion = (...args) => this.chain(new SUnionCommand(args, this.commandOptions));\n  /**\n   * @see https://redis.io/commands/sunionstore\n   */\n  sunionstore = (...args) => this.chain(new SUnionStoreCommand(args, this.commandOptions));\n  /**\n   * @see https://redis.io/commands/time\n   */\n  time = () => this.chain(new TimeCommand(this.commandOptions));\n  /**\n   * @see https://redis.io/commands/touch\n   */\n  touch = (...args) => this.chain(new TouchCommand(args, this.commandOptions));\n  /**\n   * @see https://redis.io/commands/ttl\n   */\n  ttl = (...args) => this.chain(new TtlCommand(args, this.commandOptions));\n  /**\n   * @see https://redis.io/commands/type\n   */\n  type = (...args) => this.chain(new TypeCommand(args, this.commandOptions));\n  /**\n   * @see https://redis.io/commands/unlink\n   */\n  unlink = (...args) => this.chain(new UnlinkCommand(args, this.commandOptions));\n  /**\n   * @see https://redis.io/commands/zadd\n   */\n  zadd = (...args) => {\n    if (\"score\" in args[1]) {\n      return this.chain(\n        new ZAddCommand([args[0], args[1], ...args.slice(2)], this.commandOptions)\n      );\n    }\n    return this.chain(\n      new ZAddCommand(\n        [args[0], args[1], ...args.slice(2)],\n        this.commandOptions\n      )\n    );\n  };\n  /**\n   * @see https://redis.io/commands/xadd\n   */\n  xadd = (...args) => this.chain(new XAddCommand(args, this.commandOptions));\n  /**\n   * @see https://redis.io/commands/xack\n   */\n  xack = (...args) => this.chain(new XAckCommand(args, this.commandOptions));\n  /**\n   * @see https://redis.io/commands/xdel\n   */\n  xdel = (...args) => this.chain(new XDelCommand(args, this.commandOptions));\n  /**\n   * @see https://redis.io/commands/xgroup\n   */\n  xgroup = (...args) => this.chain(new XGroupCommand(args, this.commandOptions));\n  /**\n   * @see https://redis.io/commands/xread\n   */\n  xread = (...args) => this.chain(new XReadCommand(args, this.commandOptions));\n  /**\n   * @see https://redis.io/commands/xreadgroup\n   */\n  xreadgroup = (...args) => this.chain(new XReadGroupCommand(args, this.commandOptions));\n  /**\n   * @see https://redis.io/commands/xinfo\n   */\n  xinfo = (...args) => this.chain(new XInfoCommand(args, this.commandOptions));\n  /**\n   * @see https://redis.io/commands/xlen\n   */\n  xlen = (...args) => this.chain(new XLenCommand(args, this.commandOptions));\n  /**\n   * @see https://redis.io/commands/xpending\n   */\n  xpending = (...args) => this.chain(new XPendingCommand(args, this.commandOptions));\n  /**\n   * @see https://redis.io/commands/xclaim\n   */\n  xclaim = (...args) => this.chain(new XClaimCommand(args, this.commandOptions));\n  /**\n   * @see https://redis.io/commands/xautoclaim\n   */\n  xautoclaim = (...args) => this.chain(new XAutoClaim(args, this.commandOptions));\n  /**\n   * @see https://redis.io/commands/xtrim\n   */\n  xtrim = (...args) => this.chain(new XTrimCommand(args, this.commandOptions));\n  /**\n   * @see https://redis.io/commands/xrange\n   */\n  xrange = (...args) => this.chain(new XRangeCommand(args, this.commandOptions));\n  /**\n   * @see https://redis.io/commands/xrevrange\n   */\n  xrevrange = (...args) => this.chain(new XRevRangeCommand(args, this.commandOptions));\n  /**\n   * @see https://redis.io/commands/zcard\n   */\n  zcard = (...args) => this.chain(new ZCardCommand(args, this.commandOptions));\n  /**\n   * @see https://redis.io/commands/zcount\n   */\n  zcount = (...args) => this.chain(new ZCountCommand(args, this.commandOptions));\n  /**\n   * @see https://redis.io/commands/zincrby\n   */\n  zincrby = (key, increment, member) => this.chain(new ZIncrByCommand([key, increment, member], this.commandOptions));\n  /**\n   * @see https://redis.io/commands/zinterstore\n   */\n  zinterstore = (...args) => this.chain(new ZInterStoreCommand(args, this.commandOptions));\n  /**\n   * @see https://redis.io/commands/zlexcount\n   */\n  zlexcount = (...args) => this.chain(new ZLexCountCommand(args, this.commandOptions));\n  /**\n   * @see https://redis.io/commands/zmscore\n   */\n  zmscore = (...args) => this.chain(new ZMScoreCommand(args, this.commandOptions));\n  /**\n   * @see https://redis.io/commands/zpopmax\n   */\n  zpopmax = (...args) => this.chain(new ZPopMaxCommand(args, this.commandOptions));\n  /**\n   * @see https://redis.io/commands/zpopmin\n   */\n  zpopmin = (...args) => this.chain(new ZPopMinCommand(args, this.commandOptions));\n  /**\n   * @see https://redis.io/commands/zrange\n   */\n  zrange = (...args) => this.chain(new ZRangeCommand(args, this.commandOptions));\n  /**\n   * @see https://redis.io/commands/zrank\n   */\n  zrank = (key, member) => this.chain(new ZRankCommand([key, member], this.commandOptions));\n  /**\n   * @see https://redis.io/commands/zrem\n   */\n  zrem = (key, ...members) => this.chain(new ZRemCommand([key, ...members], this.commandOptions));\n  /**\n   * @see https://redis.io/commands/zremrangebylex\n   */\n  zremrangebylex = (...args) => this.chain(new ZRemRangeByLexCommand(args, this.commandOptions));\n  /**\n   * @see https://redis.io/commands/zremrangebyrank\n   */\n  zremrangebyrank = (...args) => this.chain(new ZRemRangeByRankCommand(args, this.commandOptions));\n  /**\n   * @see https://redis.io/commands/zremrangebyscore\n   */\n  zremrangebyscore = (...args) => this.chain(new ZRemRangeByScoreCommand(args, this.commandOptions));\n  /**\n   * @see https://redis.io/commands/zrevrank\n   */\n  zrevrank = (key, member) => this.chain(new ZRevRankCommand([key, member], this.commandOptions));\n  /**\n   * @see https://redis.io/commands/zscan\n   */\n  zscan = (...args) => this.chain(new ZScanCommand(args, this.commandOptions));\n  /**\n   * @see https://redis.io/commands/zscore\n   */\n  zscore = (key, member) => this.chain(new ZScoreCommand([key, member], this.commandOptions));\n  /**\n   * @see https://redis.io/commands/zunionstore\n   */\n  zunionstore = (...args) => this.chain(new ZUnionStoreCommand(args, this.commandOptions));\n  /**\n   * @see https://redis.io/commands/zunion\n   */\n  zunion = (...args) => this.chain(new ZUnionCommand(args, this.commandOptions));\n  /**\n   * @see https://redis.io/commands/?group=json\n   */\n  get json() {\n    return {\n      /**\n       * @see https://redis.io/commands/json.arrappend\n       */\n      arrappend: (...args) => this.chain(new JsonArrAppendCommand(args, this.commandOptions)),\n      /**\n       * @see https://redis.io/commands/json.arrindex\n       */\n      arrindex: (...args) => this.chain(new JsonArrIndexCommand(args, this.commandOptions)),\n      /**\n       * @see https://redis.io/commands/json.arrinsert\n       */\n      arrinsert: (...args) => this.chain(new JsonArrInsertCommand(args, this.commandOptions)),\n      /**\n       * @see https://redis.io/commands/json.arrlen\n       */\n      arrlen: (...args) => this.chain(new JsonArrLenCommand(args, this.commandOptions)),\n      /**\n       * @see https://redis.io/commands/json.arrpop\n       */\n      arrpop: (...args) => this.chain(new JsonArrPopCommand(args, this.commandOptions)),\n      /**\n       * @see https://redis.io/commands/json.arrtrim\n       */\n      arrtrim: (...args) => this.chain(new JsonArrTrimCommand(args, this.commandOptions)),\n      /**\n       * @see https://redis.io/commands/json.clear\n       */\n      clear: (...args) => this.chain(new JsonClearCommand(args, this.commandOptions)),\n      /**\n       * @see https://redis.io/commands/json.del\n       */\n      del: (...args) => this.chain(new JsonDelCommand(args, this.commandOptions)),\n      /**\n       * @see https://redis.io/commands/json.forget\n       */\n      forget: (...args) => this.chain(new JsonForgetCommand(args, this.commandOptions)),\n      /**\n       * @see https://redis.io/commands/json.get\n       */\n      get: (...args) => this.chain(new JsonGetCommand(args, this.commandOptions)),\n      /**\n       * @see https://redis.io/commands/json.merge\n       */\n      merge: (...args) => this.chain(new JsonMergeCommand(args, this.commandOptions)),\n      /**\n       * @see https://redis.io/commands/json.mget\n       */\n      mget: (...args) => this.chain(new JsonMGetCommand(args, this.commandOptions)),\n      /**\n       * @see https://redis.io/commands/json.mset\n       */\n      mset: (...args) => this.chain(new JsonMSetCommand(args, this.commandOptions)),\n      /**\n       * @see https://redis.io/commands/json.numincrby\n       */\n      numincrby: (...args) => this.chain(new JsonNumIncrByCommand(args, this.commandOptions)),\n      /**\n       * @see https://redis.io/commands/json.nummultby\n       */\n      nummultby: (...args) => this.chain(new JsonNumMultByCommand(args, this.commandOptions)),\n      /**\n       * @see https://redis.io/commands/json.objkeys\n       */\n      objkeys: (...args) => this.chain(new JsonObjKeysCommand(args, this.commandOptions)),\n      /**\n       * @see https://redis.io/commands/json.objlen\n       */\n      objlen: (...args) => this.chain(new JsonObjLenCommand(args, this.commandOptions)),\n      /**\n       * @see https://redis.io/commands/json.resp\n       */\n      resp: (...args) => this.chain(new JsonRespCommand(args, this.commandOptions)),\n      /**\n       * @see https://redis.io/commands/json.set\n       */\n      set: (...args) => this.chain(new JsonSetCommand(args, this.commandOptions)),\n      /**\n       * @see https://redis.io/commands/json.strappend\n       */\n      strappend: (...args) => this.chain(new JsonStrAppendCommand(args, this.commandOptions)),\n      /**\n       * @see https://redis.io/commands/json.strlen\n       */\n      strlen: (...args) => this.chain(new JsonStrLenCommand(args, this.commandOptions)),\n      /**\n       * @see https://redis.io/commands/json.toggle\n       */\n      toggle: (...args) => this.chain(new JsonToggleCommand(args, this.commandOptions)),\n      /**\n       * @see https://redis.io/commands/json.type\n       */\n      type: (...args) => this.chain(new JsonTypeCommand(args, this.commandOptions))\n    };\n  }\n};\n\n// pkg/auto-pipeline.ts\nvar EXCLUDE_COMMANDS = /* @__PURE__ */ new Set([\n  \"scan\",\n  \"keys\",\n  \"flushdb\",\n  \"flushall\",\n  \"dbsize\",\n  \"hscan\",\n  \"hgetall\",\n  \"hkeys\",\n  \"lrange\",\n  \"sscan\",\n  \"smembers\",\n  \"xrange\",\n  \"xrevrange\",\n  \"zscan\",\n  \"zrange\",\n  \"exec\"\n]);\nfunction createAutoPipelineProxy(_redis, json) {\n  const redis = _redis;\n  if (!redis.autoPipelineExecutor) {\n    redis.autoPipelineExecutor = new AutoPipelineExecutor(redis);\n  }\n  return new Proxy(redis, {\n    get: (redis2, command) => {\n      if (command === \"pipelineCounter\") {\n        return redis2.autoPipelineExecutor.pipelineCounter;\n      }\n      if (command === \"json\") {\n        return createAutoPipelineProxy(redis2, true);\n      }\n      const commandInRedisButNotPipeline = command in redis2 && !(command in redis2.autoPipelineExecutor.pipeline);\n      const isCommandExcluded = EXCLUDE_COMMANDS.has(command);\n      if (commandInRedisButNotPipeline || isCommandExcluded) {\n        return redis2[command];\n      }\n      const isFunction = json ? typeof redis2.autoPipelineExecutor.pipeline.json[command] === \"function\" : typeof redis2.autoPipelineExecutor.pipeline[command] === \"function\";\n      if (isFunction) {\n        return (...args) => {\n          return redis2.autoPipelineExecutor.withAutoPipeline((pipeline) => {\n            if (json) {\n              pipeline.json[command](\n                ...args\n              );\n            } else {\n              pipeline[command](...args);\n            }\n          });\n        };\n      }\n      return redis2.autoPipelineExecutor.pipeline[command];\n    }\n  });\n}\nvar AutoPipelineExecutor = class {\n  pipelinePromises = /* @__PURE__ */ new WeakMap();\n  activePipeline = null;\n  indexInCurrentPipeline = 0;\n  redis;\n  pipeline;\n  // only to make sure that proxy can work\n  pipelineCounter = 0;\n  // to keep track of how many times a pipeline was executed\n  constructor(redis) {\n    this.redis = redis;\n    this.pipeline = redis.pipeline();\n  }\n  async withAutoPipeline(executeWithPipeline) {\n    const pipeline = this.activePipeline ?? this.redis.pipeline();\n    if (!this.activePipeline) {\n      this.activePipeline = pipeline;\n      this.indexInCurrentPipeline = 0;\n    }\n    const index = this.indexInCurrentPipeline++;\n    executeWithPipeline(pipeline);\n    const pipelineDone = this.deferExecution().then(() => {\n      if (!this.pipelinePromises.has(pipeline)) {\n        const pipelinePromise = pipeline.exec({ keepErrors: true });\n        this.pipelineCounter += 1;\n        this.pipelinePromises.set(pipeline, pipelinePromise);\n        this.activePipeline = null;\n      }\n      return this.pipelinePromises.get(pipeline);\n    });\n    const results = await pipelineDone;\n    const commandResult = results[index];\n    if (commandResult.error) {\n      throw new UpstashError(`Command failed: ${commandResult.error}`);\n    }\n    return commandResult.result;\n  }\n  async deferExecution() {\n    await Promise.resolve();\n    await Promise.resolve();\n  }\n};\n\n// pkg/commands/psubscribe.ts\nvar PSubscribeCommand = class extends Command {\n  constructor(cmd, opts) {\n    const sseHeaders = {\n      Accept: \"text/event-stream\",\n      \"Cache-Control\": \"no-cache\",\n      Connection: \"keep-alive\"\n    };\n    super([], {\n      ...opts,\n      headers: sseHeaders,\n      path: [\"psubscribe\", ...cmd],\n      streamOptions: {\n        isStreaming: true,\n        onMessage: opts?.streamOptions?.onMessage,\n        signal: opts?.streamOptions?.signal\n      }\n    });\n  }\n};\n\n// pkg/commands/subscribe.ts\nvar Subscriber = class extends EventTarget {\n  subscriptions;\n  client;\n  listeners;\n  opts;\n  constructor(client, channels, isPattern = false, opts) {\n    super();\n    this.client = client;\n    this.subscriptions = /* @__PURE__ */ new Map();\n    this.listeners = /* @__PURE__ */ new Map();\n    this.opts = opts;\n    for (const channel of channels) {\n      if (isPattern) {\n        this.subscribeToPattern(channel);\n      } else {\n        this.subscribeToChannel(channel);\n      }\n    }\n  }\n  subscribeToChannel(channel) {\n    const controller = new AbortController();\n    const command = new SubscribeCommand([channel], {\n      streamOptions: {\n        signal: controller.signal,\n        onMessage: (data) => this.handleMessage(data, false)\n      }\n    });\n    command.exec(this.client).catch((error) => {\n      if (error.name !== \"AbortError\") {\n        this.dispatchToListeners(\"error\", error);\n      }\n    });\n    this.subscriptions.set(channel, {\n      command,\n      controller,\n      isPattern: false\n    });\n  }\n  subscribeToPattern(pattern) {\n    const controller = new AbortController();\n    const command = new PSubscribeCommand([pattern], {\n      streamOptions: {\n        signal: controller.signal,\n        onMessage: (data) => this.handleMessage(data, true)\n      }\n    });\n    command.exec(this.client).catch((error) => {\n      if (error.name !== \"AbortError\") {\n        this.dispatchToListeners(\"error\", error);\n      }\n    });\n    this.subscriptions.set(pattern, {\n      command,\n      controller,\n      isPattern: true\n    });\n  }\n  handleMessage(data, isPattern) {\n    const messageData = data.replace(/^data:\\s*/, \"\");\n    const firstCommaIndex = messageData.indexOf(\",\");\n    const secondCommaIndex = messageData.indexOf(\",\", firstCommaIndex + 1);\n    const thirdCommaIndex = isPattern ? messageData.indexOf(\",\", secondCommaIndex + 1) : -1;\n    if (firstCommaIndex !== -1 && secondCommaIndex !== -1) {\n      const type = messageData.slice(0, firstCommaIndex);\n      if (isPattern && type === \"pmessage\" && thirdCommaIndex !== -1) {\n        const pattern = messageData.slice(firstCommaIndex + 1, secondCommaIndex);\n        const channel = messageData.slice(secondCommaIndex + 1, thirdCommaIndex);\n        const messageStr = messageData.slice(thirdCommaIndex + 1);\n        try {\n          const message = this.opts?.automaticDeserialization === false ? messageStr : JSON.parse(messageStr);\n          this.dispatchToListeners(\"pmessage\", { pattern, channel, message });\n          this.dispatchToListeners(`pmessage:${pattern}`, { pattern, channel, message });\n        } catch (error) {\n          this.dispatchToListeners(\"error\", new Error(`Failed to parse message: ${error}`));\n        }\n      } else {\n        const channel = messageData.slice(firstCommaIndex + 1, secondCommaIndex);\n        const messageStr = messageData.slice(secondCommaIndex + 1);\n        try {\n          if (type === \"subscribe\" || type === \"psubscribe\" || type === \"unsubscribe\" || type === \"punsubscribe\") {\n            const count = Number.parseInt(messageStr);\n            this.dispatchToListeners(type, count);\n          } else {\n            const message = this.opts?.automaticDeserialization === false ? messageStr : parseWithTryCatch(messageStr);\n            this.dispatchToListeners(type, { channel, message });\n            this.dispatchToListeners(`${type}:${channel}`, { channel, message });\n          }\n        } catch (error) {\n          this.dispatchToListeners(\"error\", new Error(`Failed to parse message: ${error}`));\n        }\n      }\n    }\n  }\n  dispatchToListeners(type, data) {\n    const listeners = this.listeners.get(type);\n    if (listeners) {\n      for (const listener of listeners) {\n        listener(data);\n      }\n    }\n  }\n  on(type, listener) {\n    if (!this.listeners.has(type)) {\n      this.listeners.set(type, /* @__PURE__ */ new Set());\n    }\n    this.listeners.get(type)?.add(listener);\n  }\n  removeAllListeners() {\n    this.listeners.clear();\n  }\n  async unsubscribe(channels) {\n    if (channels) {\n      for (const channel of channels) {\n        const subscription = this.subscriptions.get(channel);\n        if (subscription) {\n          try {\n            subscription.controller.abort();\n          } catch {\n          }\n          this.subscriptions.delete(channel);\n        }\n      }\n    } else {\n      for (const subscription of this.subscriptions.values()) {\n        try {\n          subscription.controller.abort();\n        } catch {\n        }\n      }\n      this.subscriptions.clear();\n      this.removeAllListeners();\n    }\n  }\n  getSubscribedChannels() {\n    return [...this.subscriptions.keys()];\n  }\n};\nvar SubscribeCommand = class extends Command {\n  constructor(cmd, opts) {\n    const sseHeaders = {\n      Accept: \"text/event-stream\",\n      \"Cache-Control\": \"no-cache\",\n      Connection: \"keep-alive\"\n    };\n    super([], {\n      ...opts,\n      headers: sseHeaders,\n      path: [\"subscribe\", ...cmd],\n      streamOptions: {\n        isStreaming: true,\n        onMessage: opts?.streamOptions?.onMessage,\n        signal: opts?.streamOptions?.signal\n      }\n    });\n  }\n};\nvar parseWithTryCatch = (str) => {\n  try {\n    return JSON.parse(str);\n  } catch {\n    return str;\n  }\n};\n\n// pkg/script.ts\n\nvar Script = class {\n  script;\n  /**\n   * @deprecated This property is initialized to an empty string and will be set in the init method\n   * asynchronously. Do not use this property immidiately after the constructor.\n   *\n   * This property is only exposed for backwards compatibility and will be removed in the\n   * future major release.\n   */\n  sha1;\n  redis;\n  constructor(redis, script) {\n    this.redis = redis;\n    this.script = script;\n    this.sha1 = \"\";\n    void this.init(script);\n  }\n  /**\n   * Initialize the script by computing its SHA-1 hash.\n   */\n  async init(script) {\n    if (this.sha1) return;\n    this.sha1 = await this.digest(script);\n  }\n  /**\n   * Send an `EVAL` command to redis.\n   */\n  async eval(keys, args) {\n    await this.init(this.script);\n    return await this.redis.eval(this.script, keys, args);\n  }\n  /**\n   * Calculates the sha1 hash of the script and then calls `EVALSHA`.\n   */\n  async evalsha(keys, args) {\n    await this.init(this.script);\n    return await this.redis.evalsha(this.sha1, keys, args);\n  }\n  /**\n   * Optimistically try to run `EVALSHA` first.\n   * If the script is not loaded in redis, it will fall back and try again with `EVAL`.\n   *\n   * Following calls will be able to use the cached script\n   */\n  async exec(keys, args) {\n    await this.init(this.script);\n    const res = await this.redis.evalsha(this.sha1, keys, args).catch(async (error) => {\n      if (error instanceof Error && error.message.toLowerCase().includes(\"noscript\")) {\n        return await this.redis.eval(this.script, keys, args);\n      }\n      throw error;\n    });\n    return res;\n  }\n  /**\n   * Compute the sha1 hash of the script and return its hex representation.\n   */\n  async digest(s) {\n    const data = new TextEncoder().encode(s);\n    const hashBuffer = await uncrypto__WEBPACK_IMPORTED_MODULE_0__.subtle.digest(\"SHA-1\", data);\n    const hashArray = [...new Uint8Array(hashBuffer)];\n    return hashArray.map((b) => b.toString(16).padStart(2, \"0\")).join(\"\");\n  }\n};\n\n// pkg/scriptRo.ts\n\nvar ScriptRO = class {\n  script;\n  /**\n   * @deprecated This property is initialized to an empty string and will be set in the init method\n   * asynchronously. Do not use this property immidiately after the constructor.\n   *\n   * This property is only exposed for backwards compatibility and will be removed in the\n   * future major release.\n   */\n  sha1;\n  redis;\n  constructor(redis, script) {\n    this.redis = redis;\n    this.sha1 = \"\";\n    this.script = script;\n    void this.init(script);\n  }\n  async init(script) {\n    if (this.sha1) return;\n    this.sha1 = await this.digest(script);\n  }\n  /**\n   * Send an `EVAL_RO` command to redis.\n   */\n  async evalRo(keys, args) {\n    await this.init(this.script);\n    return await this.redis.evalRo(this.script, keys, args);\n  }\n  /**\n   * Calculates the sha1 hash of the script and then calls `EVALSHA_RO`.\n   */\n  async evalshaRo(keys, args) {\n    await this.init(this.script);\n    return await this.redis.evalshaRo(this.sha1, keys, args);\n  }\n  /**\n   * Optimistically try to run `EVALSHA_RO` first.\n   * If the script is not loaded in redis, it will fall back and try again with `EVAL_RO`.\n   *\n   * Following calls will be able to use the cached script\n   */\n  async exec(keys, args) {\n    await this.init(this.script);\n    const res = await this.redis.evalshaRo(this.sha1, keys, args).catch(async (error) => {\n      if (error instanceof Error && error.message.toLowerCase().includes(\"noscript\")) {\n        return await this.redis.evalRo(this.script, keys, args);\n      }\n      throw error;\n    });\n    return res;\n  }\n  /**\n   * Compute the sha1 hash of the script and return its hex representation.\n   */\n  async digest(s) {\n    const data = new TextEncoder().encode(s);\n    const hashBuffer = await uncrypto__WEBPACK_IMPORTED_MODULE_0__.subtle.digest(\"SHA-1\", data);\n    const hashArray = [...new Uint8Array(hashBuffer)];\n    return hashArray.map((b) => b.toString(16).padStart(2, \"0\")).join(\"\");\n  }\n};\n\n// pkg/redis.ts\nvar Redis = class {\n  client;\n  opts;\n  enableTelemetry;\n  enableAutoPipelining;\n  /**\n   * Create a new redis client\n   *\n   * @example\n   * ```typescript\n   * const redis = new Redis({\n   *  url: \"<UPSTASH_REDIS_REST_URL>\",\n   *  token: \"<UPSTASH_REDIS_REST_TOKEN>\",\n   * });\n   * ```\n   */\n  constructor(client, opts) {\n    this.client = client;\n    this.opts = opts;\n    this.enableTelemetry = opts?.enableTelemetry ?? true;\n    if (opts?.readYourWrites === false) {\n      this.client.readYourWrites = false;\n    }\n    this.enableAutoPipelining = opts?.enableAutoPipelining ?? true;\n  }\n  get readYourWritesSyncToken() {\n    return this.client.upstashSyncToken;\n  }\n  set readYourWritesSyncToken(session) {\n    this.client.upstashSyncToken = session;\n  }\n  get json() {\n    return {\n      /**\n       * @see https://redis.io/commands/json.arrappend\n       */\n      arrappend: (...args) => new JsonArrAppendCommand(args, this.opts).exec(this.client),\n      /**\n       * @see https://redis.io/commands/json.arrindex\n       */\n      arrindex: (...args) => new JsonArrIndexCommand(args, this.opts).exec(this.client),\n      /**\n       * @see https://redis.io/commands/json.arrinsert\n       */\n      arrinsert: (...args) => new JsonArrInsertCommand(args, this.opts).exec(this.client),\n      /**\n       * @see https://redis.io/commands/json.arrlen\n       */\n      arrlen: (...args) => new JsonArrLenCommand(args, this.opts).exec(this.client),\n      /**\n       * @see https://redis.io/commands/json.arrpop\n       */\n      arrpop: (...args) => new JsonArrPopCommand(args, this.opts).exec(this.client),\n      /**\n       * @see https://redis.io/commands/json.arrtrim\n       */\n      arrtrim: (...args) => new JsonArrTrimCommand(args, this.opts).exec(this.client),\n      /**\n       * @see https://redis.io/commands/json.clear\n       */\n      clear: (...args) => new JsonClearCommand(args, this.opts).exec(this.client),\n      /**\n       * @see https://redis.io/commands/json.del\n       */\n      del: (...args) => new JsonDelCommand(args, this.opts).exec(this.client),\n      /**\n       * @see https://redis.io/commands/json.forget\n       */\n      forget: (...args) => new JsonForgetCommand(args, this.opts).exec(this.client),\n      /**\n       * @see https://redis.io/commands/json.get\n       */\n      get: (...args) => new JsonGetCommand(args, this.opts).exec(this.client),\n      /**\n       * @see https://redis.io/commands/json.merge\n       */\n      merge: (...args) => new JsonMergeCommand(args, this.opts).exec(this.client),\n      /**\n       * @see https://redis.io/commands/json.mget\n       */\n      mget: (...args) => new JsonMGetCommand(args, this.opts).exec(this.client),\n      /**\n       * @see https://redis.io/commands/json.mset\n       */\n      mset: (...args) => new JsonMSetCommand(args, this.opts).exec(this.client),\n      /**\n       * @see https://redis.io/commands/json.numincrby\n       */\n      numincrby: (...args) => new JsonNumIncrByCommand(args, this.opts).exec(this.client),\n      /**\n       * @see https://redis.io/commands/json.nummultby\n       */\n      nummultby: (...args) => new JsonNumMultByCommand(args, this.opts).exec(this.client),\n      /**\n       * @see https://redis.io/commands/json.objkeys\n       */\n      objkeys: (...args) => new JsonObjKeysCommand(args, this.opts).exec(this.client),\n      /**\n       * @see https://redis.io/commands/json.objlen\n       */\n      objlen: (...args) => new JsonObjLenCommand(args, this.opts).exec(this.client),\n      /**\n       * @see https://redis.io/commands/json.resp\n       */\n      resp: (...args) => new JsonRespCommand(args, this.opts).exec(this.client),\n      /**\n       * @see https://redis.io/commands/json.set\n       */\n      set: (...args) => new JsonSetCommand(args, this.opts).exec(this.client),\n      /**\n       * @see https://redis.io/commands/json.strappend\n       */\n      strappend: (...args) => new JsonStrAppendCommand(args, this.opts).exec(this.client),\n      /**\n       * @see https://redis.io/commands/json.strlen\n       */\n      strlen: (...args) => new JsonStrLenCommand(args, this.opts).exec(this.client),\n      /**\n       * @see https://redis.io/commands/json.toggle\n       */\n      toggle: (...args) => new JsonToggleCommand(args, this.opts).exec(this.client),\n      /**\n       * @see https://redis.io/commands/json.type\n       */\n      type: (...args) => new JsonTypeCommand(args, this.opts).exec(this.client)\n    };\n  }\n  /**\n   * Wrap a new middleware around the HTTP client.\n   */\n  use = (middleware) => {\n    const makeRequest = this.client.request.bind(this.client);\n    this.client.request = (req) => middleware(req, makeRequest);\n  };\n  /**\n   * Technically this is not private, we can hide it from intellisense by doing this\n   */\n  addTelemetry = (telemetry) => {\n    if (!this.enableTelemetry) {\n      return;\n    }\n    try {\n      this.client.mergeTelemetry(telemetry);\n    } catch {\n    }\n  };\n  /**\n   * Creates a new script.\n   *\n   * Scripts offer the ability to optimistically try to execute a script without having to send the\n   * entire script to the server. If the script is loaded on the server, it tries again by sending\n   * the entire script. Afterwards, the script is cached on the server.\n   *\n   * @param script - The script to create\n   * @param opts - Optional options to pass to the script `{ readonly?: boolean }`\n   * @returns A new script\n   *\n   * @example\n   * ```ts\n   * const redis = new Redis({...})\n   *\n   * const script = redis.createScript<string>(\"return ARGV[1];\")\n   * const arg1 = await script.eval([], [\"Hello World\"])\n   * expect(arg1, \"Hello World\")\n   * ```\n   * @example\n   * ```ts\n   * const redis = new Redis({...})\n   *\n   * const script = redis.createScript<string>(\"return ARGV[1];\", { readonly: true })\n   * const arg1 = await script.evalRo([], [\"Hello World\"])\n   * expect(arg1, \"Hello World\")\n   * ```\n   */\n  createScript(script, opts) {\n    return opts?.readonly ? new ScriptRO(this, script) : new Script(this, script);\n  }\n  /**\n   * Create a new pipeline that allows you to send requests in bulk.\n   *\n   * @see {@link Pipeline}\n   */\n  pipeline = () => new Pipeline({\n    client: this.client,\n    commandOptions: this.opts,\n    multiExec: false\n  });\n  autoPipeline = () => {\n    return createAutoPipelineProxy(this);\n  };\n  /**\n   * Create a new transaction to allow executing multiple steps atomically.\n   *\n   * All the commands in a transaction are serialized and executed sequentially. A request sent by\n   * another client will never be served in the middle of the execution of a Redis Transaction. This\n   * guarantees that the commands are executed as a single isolated operation.\n   *\n   * @see {@link Pipeline}\n   */\n  multi = () => new Pipeline({\n    client: this.client,\n    commandOptions: this.opts,\n    multiExec: true\n  });\n  /**\n   * Returns an instance that can be used to execute `BITFIELD` commands on one key.\n   *\n   * @example\n   * ```typescript\n   * redis.set(\"mykey\", 0);\n   * const result = await redis.bitfield(\"mykey\")\n   *   .set(\"u4\", 0, 16)\n   *   .incr(\"u4\", \"#1\", 1)\n   *   .exec();\n   * console.log(result); // [0, 1]\n   * ```\n   *\n   * @see https://redis.io/commands/bitfield\n   */\n  bitfield = (...args) => new BitFieldCommand(args, this.client, this.opts);\n  /**\n   * @see https://redis.io/commands/append\n   */\n  append = (...args) => new AppendCommand(args, this.opts).exec(this.client);\n  /**\n   * @see https://redis.io/commands/bitcount\n   */\n  bitcount = (...args) => new BitCountCommand(args, this.opts).exec(this.client);\n  /**\n   * @see https://redis.io/commands/bitop\n   */\n  bitop = (op, destinationKey, sourceKey, ...sourceKeys) => new BitOpCommand([op, destinationKey, sourceKey, ...sourceKeys], this.opts).exec(\n    this.client\n  );\n  /**\n   * @see https://redis.io/commands/bitpos\n   */\n  bitpos = (...args) => new BitPosCommand(args, this.opts).exec(this.client);\n  /**\n   * @see https://redis.io/commands/copy\n   */\n  copy = (...args) => new CopyCommand(args, this.opts).exec(this.client);\n  /**\n   * @see https://redis.io/commands/dbsize\n   */\n  dbsize = () => new DBSizeCommand(this.opts).exec(this.client);\n  /**\n   * @see https://redis.io/commands/decr\n   */\n  decr = (...args) => new DecrCommand(args, this.opts).exec(this.client);\n  /**\n   * @see https://redis.io/commands/decrby\n   */\n  decrby = (...args) => new DecrByCommand(args, this.opts).exec(this.client);\n  /**\n   * @see https://redis.io/commands/del\n   */\n  del = (...args) => new DelCommand(args, this.opts).exec(this.client);\n  /**\n   * @see https://redis.io/commands/echo\n   */\n  echo = (...args) => new EchoCommand(args, this.opts).exec(this.client);\n  /**\n   * @see https://redis.io/commands/eval_ro\n   */\n  evalRo = (...args) => new EvalROCommand(args, this.opts).exec(this.client);\n  /**\n   * @see https://redis.io/commands/eval\n   */\n  eval = (...args) => new EvalCommand(args, this.opts).exec(this.client);\n  /**\n   * @see https://redis.io/commands/evalsha_ro\n   */\n  evalshaRo = (...args) => new EvalshaROCommand(args, this.opts).exec(this.client);\n  /**\n   * @see https://redis.io/commands/evalsha\n   */\n  evalsha = (...args) => new EvalshaCommand(args, this.opts).exec(this.client);\n  /**\n   * Generic method to execute any Redis command.\n   */\n  exec = (args) => new ExecCommand(args, this.opts).exec(this.client);\n  /**\n   * @see https://redis.io/commands/exists\n   */\n  exists = (...args) => new ExistsCommand(args, this.opts).exec(this.client);\n  /**\n   * @see https://redis.io/commands/expire\n   */\n  expire = (...args) => new ExpireCommand(args, this.opts).exec(this.client);\n  /**\n   * @see https://redis.io/commands/expireat\n   */\n  expireat = (...args) => new ExpireAtCommand(args, this.opts).exec(this.client);\n  /**\n   * @see https://redis.io/commands/flushall\n   */\n  flushall = (args) => new FlushAllCommand(args, this.opts).exec(this.client);\n  /**\n   * @see https://redis.io/commands/flushdb\n   */\n  flushdb = (...args) => new FlushDBCommand(args, this.opts).exec(this.client);\n  /**\n   * @see https://redis.io/commands/geoadd\n   */\n  geoadd = (...args) => new GeoAddCommand(args, this.opts).exec(this.client);\n  /**\n   * @see https://redis.io/commands/geopos\n   */\n  geopos = (...args) => new GeoPosCommand(args, this.opts).exec(this.client);\n  /**\n   * @see https://redis.io/commands/geodist\n   */\n  geodist = (...args) => new GeoDistCommand(args, this.opts).exec(this.client);\n  /**\n   * @see https://redis.io/commands/geohash\n   */\n  geohash = (...args) => new GeoHashCommand(args, this.opts).exec(this.client);\n  /**\n   * @see https://redis.io/commands/geosearch\n   */\n  geosearch = (...args) => new GeoSearchCommand(args, this.opts).exec(this.client);\n  /**\n   * @see https://redis.io/commands/geosearchstore\n   */\n  geosearchstore = (...args) => new GeoSearchStoreCommand(args, this.opts).exec(this.client);\n  /**\n   * @see https://redis.io/commands/get\n   */\n  get = (...args) => new GetCommand(args, this.opts).exec(this.client);\n  /**\n   * @see https://redis.io/commands/getbit\n   */\n  getbit = (...args) => new GetBitCommand(args, this.opts).exec(this.client);\n  /**\n   * @see https://redis.io/commands/getdel\n   */\n  getdel = (...args) => new GetDelCommand(args, this.opts).exec(this.client);\n  /**\n   * @see https://redis.io/commands/getex\n   */\n  getex = (...args) => new GetExCommand(args, this.opts).exec(this.client);\n  /**\n   * @see https://redis.io/commands/getrange\n   */\n  getrange = (...args) => new GetRangeCommand(args, this.opts).exec(this.client);\n  /**\n   * @see https://redis.io/commands/getset\n   */\n  getset = (key, value) => new GetSetCommand([key, value], this.opts).exec(this.client);\n  /**\n   * @see https://redis.io/commands/hdel\n   */\n  hdel = (...args) => new HDelCommand(args, this.opts).exec(this.client);\n  /**\n   * @see https://redis.io/commands/hexists\n   */\n  hexists = (...args) => new HExistsCommand(args, this.opts).exec(this.client);\n  /**\n   * @see https://redis.io/commands/hexpire\n   */\n  hexpire = (...args) => new HExpireCommand(args, this.opts).exec(this.client);\n  /**\n   * @see https://redis.io/commands/hexpireat\n   */\n  hexpireat = (...args) => new HExpireAtCommand(args, this.opts).exec(this.client);\n  /**\n   * @see https://redis.io/commands/hexpiretime\n   */\n  hexpiretime = (...args) => new HExpireTimeCommand(args, this.opts).exec(this.client);\n  /**\n   * @see https://redis.io/commands/httl\n   */\n  httl = (...args) => new HTtlCommand(args, this.opts).exec(this.client);\n  /**\n   * @see https://redis.io/commands/hpexpire\n   */\n  hpexpire = (...args) => new HPExpireCommand(args, this.opts).exec(this.client);\n  /**\n   * @see https://redis.io/commands/hpexpireat\n   */\n  hpexpireat = (...args) => new HPExpireAtCommand(args, this.opts).exec(this.client);\n  /**\n   * @see https://redis.io/commands/hpexpiretime\n   */\n  hpexpiretime = (...args) => new HPExpireTimeCommand(args, this.opts).exec(this.client);\n  /**\n   * @see https://redis.io/commands/hpttl\n   */\n  hpttl = (...args) => new HPTtlCommand(args, this.opts).exec(this.client);\n  /**\n   * @see https://redis.io/commands/hpersist\n   */\n  hpersist = (...args) => new HPersistCommand(args, this.opts).exec(this.client);\n  /**\n   * @see https://redis.io/commands/hget\n   */\n  hget = (...args) => new HGetCommand(args, this.opts).exec(this.client);\n  /**\n   * @see https://redis.io/commands/hgetall\n   */\n  hgetall = (...args) => new HGetAllCommand(args, this.opts).exec(this.client);\n  /**\n   * @see https://redis.io/commands/hincrby\n   */\n  hincrby = (...args) => new HIncrByCommand(args, this.opts).exec(this.client);\n  /**\n   * @see https://redis.io/commands/hincrbyfloat\n   */\n  hincrbyfloat = (...args) => new HIncrByFloatCommand(args, this.opts).exec(this.client);\n  /**\n   * @see https://redis.io/commands/hkeys\n   */\n  hkeys = (...args) => new HKeysCommand(args, this.opts).exec(this.client);\n  /**\n   * @see https://redis.io/commands/hlen\n   */\n  hlen = (...args) => new HLenCommand(args, this.opts).exec(this.client);\n  /**\n   * @see https://redis.io/commands/hmget\n   */\n  hmget = (...args) => new HMGetCommand(args, this.opts).exec(this.client);\n  /**\n   * @see https://redis.io/commands/hmset\n   */\n  hmset = (key, kv) => new HMSetCommand([key, kv], this.opts).exec(this.client);\n  /**\n   * @see https://redis.io/commands/hrandfield\n   */\n  hrandfield = (key, count, withValues) => new HRandFieldCommand([key, count, withValues], this.opts).exec(this.client);\n  /**\n   * @see https://redis.io/commands/hscan\n   */\n  hscan = (...args) => new HScanCommand(args, this.opts).exec(this.client);\n  /**\n   * @see https://redis.io/commands/hset\n   */\n  hset = (key, kv) => new HSetCommand([key, kv], this.opts).exec(this.client);\n  /**\n   * @see https://redis.io/commands/hsetnx\n   */\n  hsetnx = (key, field, value) => new HSetNXCommand([key, field, value], this.opts).exec(this.client);\n  /**\n   * @see https://redis.io/commands/hstrlen\n   */\n  hstrlen = (...args) => new HStrLenCommand(args, this.opts).exec(this.client);\n  /**\n   * @see https://redis.io/commands/hvals\n   */\n  hvals = (...args) => new HValsCommand(args, this.opts).exec(this.client);\n  /**\n   * @see https://redis.io/commands/incr\n   */\n  incr = (...args) => new IncrCommand(args, this.opts).exec(this.client);\n  /**\n   * @see https://redis.io/commands/incrby\n   */\n  incrby = (...args) => new IncrByCommand(args, this.opts).exec(this.client);\n  /**\n   * @see https://redis.io/commands/incrbyfloat\n   */\n  incrbyfloat = (...args) => new IncrByFloatCommand(args, this.opts).exec(this.client);\n  /**\n   * @see https://redis.io/commands/keys\n   */\n  keys = (...args) => new KeysCommand(args, this.opts).exec(this.client);\n  /**\n   * @see https://redis.io/commands/lindex\n   */\n  lindex = (...args) => new LIndexCommand(args, this.opts).exec(this.client);\n  /**\n   * @see https://redis.io/commands/linsert\n   */\n  linsert = (key, direction, pivot, value) => new LInsertCommand([key, direction, pivot, value], this.opts).exec(this.client);\n  /**\n   * @see https://redis.io/commands/llen\n   */\n  llen = (...args) => new LLenCommand(args, this.opts).exec(this.client);\n  /**\n   * @see https://redis.io/commands/lmove\n   */\n  lmove = (...args) => new LMoveCommand(args, this.opts).exec(this.client);\n  /**\n   * @see https://redis.io/commands/lpop\n   */\n  lpop = (...args) => new LPopCommand(args, this.opts).exec(this.client);\n  /**\n   * @see https://redis.io/commands/lmpop\n   */\n  lmpop = (...args) => new LmPopCommand(args, this.opts).exec(this.client);\n  /**\n   * @see https://redis.io/commands/lpos\n   */\n  lpos = (...args) => new LPosCommand(args, this.opts).exec(this.client);\n  /**\n   * @see https://redis.io/commands/lpush\n   */\n  lpush = (key, ...elements) => new LPushCommand([key, ...elements], this.opts).exec(this.client);\n  /**\n   * @see https://redis.io/commands/lpushx\n   */\n  lpushx = (key, ...elements) => new LPushXCommand([key, ...elements], this.opts).exec(this.client);\n  /**\n   * @see https://redis.io/commands/lrange\n   */\n  lrange = (...args) => new LRangeCommand(args, this.opts).exec(this.client);\n  /**\n   * @see https://redis.io/commands/lrem\n   */\n  lrem = (key, count, value) => new LRemCommand([key, count, value], this.opts).exec(this.client);\n  /**\n   * @see https://redis.io/commands/lset\n   */\n  lset = (key, index, value) => new LSetCommand([key, index, value], this.opts).exec(this.client);\n  /**\n   * @see https://redis.io/commands/ltrim\n   */\n  ltrim = (...args) => new LTrimCommand(args, this.opts).exec(this.client);\n  /**\n   * @see https://redis.io/commands/mget\n   */\n  mget = (...args) => new MGetCommand(args, this.opts).exec(this.client);\n  /**\n   * @see https://redis.io/commands/mset\n   */\n  mset = (kv) => new MSetCommand([kv], this.opts).exec(this.client);\n  /**\n   * @see https://redis.io/commands/msetnx\n   */\n  msetnx = (kv) => new MSetNXCommand([kv], this.opts).exec(this.client);\n  /**\n   * @see https://redis.io/commands/persist\n   */\n  persist = (...args) => new PersistCommand(args, this.opts).exec(this.client);\n  /**\n   * @see https://redis.io/commands/pexpire\n   */\n  pexpire = (...args) => new PExpireCommand(args, this.opts).exec(this.client);\n  /**\n   * @see https://redis.io/commands/pexpireat\n   */\n  pexpireat = (...args) => new PExpireAtCommand(args, this.opts).exec(this.client);\n  /**\n   * @see https://redis.io/commands/pfadd\n   */\n  pfadd = (...args) => new PfAddCommand(args, this.opts).exec(this.client);\n  /**\n   * @see https://redis.io/commands/pfcount\n   */\n  pfcount = (...args) => new PfCountCommand(args, this.opts).exec(this.client);\n  /**\n   * @see https://redis.io/commands/pfmerge\n   */\n  pfmerge = (...args) => new PfMergeCommand(args, this.opts).exec(this.client);\n  /**\n   * @see https://redis.io/commands/ping\n   */\n  ping = (args) => new PingCommand(args, this.opts).exec(this.client);\n  /**\n   * @see https://redis.io/commands/psetex\n   */\n  psetex = (key, ttl, value) => new PSetEXCommand([key, ttl, value], this.opts).exec(this.client);\n  /**\n   * @see https://redis.io/commands/psubscribe\n   */\n  psubscribe = (patterns) => {\n    const patternArray = Array.isArray(patterns) ? patterns : [patterns];\n    return new Subscriber(this.client, patternArray, true, this.opts);\n  };\n  /**\n   * @see https://redis.io/commands/pttl\n   */\n  pttl = (...args) => new PTtlCommand(args, this.opts).exec(this.client);\n  /**\n   * @see https://redis.io/commands/publish\n   */\n  publish = (...args) => new PublishCommand(args, this.opts).exec(this.client);\n  /**\n   * @see https://redis.io/commands/randomkey\n   */\n  randomkey = () => new RandomKeyCommand().exec(this.client);\n  /**\n   * @see https://redis.io/commands/rename\n   */\n  rename = (...args) => new RenameCommand(args, this.opts).exec(this.client);\n  /**\n   * @see https://redis.io/commands/renamenx\n   */\n  renamenx = (...args) => new RenameNXCommand(args, this.opts).exec(this.client);\n  /**\n   * @see https://redis.io/commands/rpop\n   */\n  rpop = (...args) => new RPopCommand(args, this.opts).exec(this.client);\n  /**\n   * @see https://redis.io/commands/rpush\n   */\n  rpush = (key, ...elements) => new RPushCommand([key, ...elements], this.opts).exec(this.client);\n  /**\n   * @see https://redis.io/commands/rpushx\n   */\n  rpushx = (key, ...elements) => new RPushXCommand([key, ...elements], this.opts).exec(this.client);\n  /**\n   * @see https://redis.io/commands/sadd\n   */\n  sadd = (key, member, ...members) => new SAddCommand([key, member, ...members], this.opts).exec(this.client);\n  scan(cursor, opts) {\n    return new ScanCommand([cursor, opts], this.opts).exec(this.client);\n  }\n  /**\n   * @see https://redis.io/commands/scard\n   */\n  scard = (...args) => new SCardCommand(args, this.opts).exec(this.client);\n  /**\n   * @see https://redis.io/commands/script-exists\n   */\n  scriptExists = (...args) => new ScriptExistsCommand(args, this.opts).exec(this.client);\n  /**\n   * @see https://redis.io/commands/script-flush\n   */\n  scriptFlush = (...args) => new ScriptFlushCommand(args, this.opts).exec(this.client);\n  /**\n   * @see https://redis.io/commands/script-load\n   */\n  scriptLoad = (...args) => new ScriptLoadCommand(args, this.opts).exec(this.client);\n  /**\n   * @see https://redis.io/commands/sdiff\n   */\n  sdiff = (...args) => new SDiffCommand(args, this.opts).exec(this.client);\n  /**\n   * @see https://redis.io/commands/sdiffstore\n   */\n  sdiffstore = (...args) => new SDiffStoreCommand(args, this.opts).exec(this.client);\n  /**\n   * @see https://redis.io/commands/set\n   */\n  set = (key, value, opts) => new SetCommand([key, value, opts], this.opts).exec(this.client);\n  /**\n   * @see https://redis.io/commands/setbit\n   */\n  setbit = (...args) => new SetBitCommand(args, this.opts).exec(this.client);\n  /**\n   * @see https://redis.io/commands/setex\n   */\n  setex = (key, ttl, value) => new SetExCommand([key, ttl, value], this.opts).exec(this.client);\n  /**\n   * @see https://redis.io/commands/setnx\n   */\n  setnx = (key, value) => new SetNxCommand([key, value], this.opts).exec(this.client);\n  /**\n   * @see https://redis.io/commands/setrange\n   */\n  setrange = (...args) => new SetRangeCommand(args, this.opts).exec(this.client);\n  /**\n   * @see https://redis.io/commands/sinter\n   */\n  sinter = (...args) => new SInterCommand(args, this.opts).exec(this.client);\n  /**\n   * @see https://redis.io/commands/sinterstore\n   */\n  sinterstore = (...args) => new SInterStoreCommand(args, this.opts).exec(this.client);\n  /**\n   * @see https://redis.io/commands/sismember\n   */\n  sismember = (key, member) => new SIsMemberCommand([key, member], this.opts).exec(this.client);\n  /**\n   * @see https://redis.io/commands/smismember\n   */\n  smismember = (key, members) => new SMIsMemberCommand([key, members], this.opts).exec(this.client);\n  /**\n   * @see https://redis.io/commands/smembers\n   */\n  smembers = (...args) => new SMembersCommand(args, this.opts).exec(this.client);\n  /**\n   * @see https://redis.io/commands/smove\n   */\n  smove = (source, destination, member) => new SMoveCommand([source, destination, member], this.opts).exec(this.client);\n  /**\n   * @see https://redis.io/commands/spop\n   */\n  spop = (...args) => new SPopCommand(args, this.opts).exec(this.client);\n  /**\n   * @see https://redis.io/commands/srandmember\n   */\n  srandmember = (...args) => new SRandMemberCommand(args, this.opts).exec(this.client);\n  /**\n   * @see https://redis.io/commands/srem\n   */\n  srem = (key, ...members) => new SRemCommand([key, ...members], this.opts).exec(this.client);\n  /**\n   * @see https://redis.io/commands/sscan\n   */\n  sscan = (...args) => new SScanCommand(args, this.opts).exec(this.client);\n  /**\n   * @see https://redis.io/commands/strlen\n   */\n  strlen = (...args) => new StrLenCommand(args, this.opts).exec(this.client);\n  /**\n   * @see https://redis.io/commands/subscribe\n   */\n  subscribe = (channels) => {\n    const channelArray = Array.isArray(channels) ? channels : [channels];\n    return new Subscriber(this.client, channelArray, false, this.opts);\n  };\n  /**\n   * @see https://redis.io/commands/sunion\n   */\n  sunion = (...args) => new SUnionCommand(args, this.opts).exec(this.client);\n  /**\n   * @see https://redis.io/commands/sunionstore\n   */\n  sunionstore = (...args) => new SUnionStoreCommand(args, this.opts).exec(this.client);\n  /**\n   * @see https://redis.io/commands/time\n   */\n  time = () => new TimeCommand().exec(this.client);\n  /**\n   * @see https://redis.io/commands/touch\n   */\n  touch = (...args) => new TouchCommand(args, this.opts).exec(this.client);\n  /**\n   * @see https://redis.io/commands/ttl\n   */\n  ttl = (...args) => new TtlCommand(args, this.opts).exec(this.client);\n  /**\n   * @see https://redis.io/commands/type\n   */\n  type = (...args) => new TypeCommand(args, this.opts).exec(this.client);\n  /**\n   * @see https://redis.io/commands/unlink\n   */\n  unlink = (...args) => new UnlinkCommand(args, this.opts).exec(this.client);\n  /**\n   * @see https://redis.io/commands/xadd\n   */\n  xadd = (...args) => new XAddCommand(args, this.opts).exec(this.client);\n  /**\n   * @see https://redis.io/commands/xack\n   */\n  xack = (...args) => new XAckCommand(args, this.opts).exec(this.client);\n  /**\n   * @see https://redis.io/commands/xdel\n   */\n  xdel = (...args) => new XDelCommand(args, this.opts).exec(this.client);\n  /**\n   * @see https://redis.io/commands/xgroup\n   */\n  xgroup = (...args) => new XGroupCommand(args, this.opts).exec(this.client);\n  /**\n   * @see https://redis.io/commands/xread\n   */\n  xread = (...args) => new XReadCommand(args, this.opts).exec(this.client);\n  /**\n   * @see https://redis.io/commands/xreadgroup\n   */\n  xreadgroup = (...args) => new XReadGroupCommand(args, this.opts).exec(this.client);\n  /**\n   * @see https://redis.io/commands/xinfo\n   */\n  xinfo = (...args) => new XInfoCommand(args, this.opts).exec(this.client);\n  /**\n   * @see https://redis.io/commands/xlen\n   */\n  xlen = (...args) => new XLenCommand(args, this.opts).exec(this.client);\n  /**\n   * @see https://redis.io/commands/xpending\n   */\n  xpending = (...args) => new XPendingCommand(args, this.opts).exec(this.client);\n  /**\n   * @see https://redis.io/commands/xclaim\n   */\n  xclaim = (...args) => new XClaimCommand(args, this.opts).exec(this.client);\n  /**\n   * @see https://redis.io/commands/xautoclaim\n   */\n  xautoclaim = (...args) => new XAutoClaim(args, this.opts).exec(this.client);\n  /**\n   * @see https://redis.io/commands/xtrim\n   */\n  xtrim = (...args) => new XTrimCommand(args, this.opts).exec(this.client);\n  /**\n   * @see https://redis.io/commands/xrange\n   */\n  xrange = (...args) => new XRangeCommand(args, this.opts).exec(this.client);\n  /**\n   * @see https://redis.io/commands/xrevrange\n   */\n  xrevrange = (...args) => new XRevRangeCommand(args, this.opts).exec(this.client);\n  /**\n   * @see https://redis.io/commands/zadd\n   */\n  zadd = (...args) => {\n    if (\"score\" in args[1]) {\n      return new ZAddCommand([args[0], args[1], ...args.slice(2)], this.opts).exec(\n        this.client\n      );\n    }\n    return new ZAddCommand(\n      [args[0], args[1], ...args.slice(2)],\n      this.opts\n    ).exec(this.client);\n  };\n  /**\n   * @see https://redis.io/commands/zcard\n   */\n  zcard = (...args) => new ZCardCommand(args, this.opts).exec(this.client);\n  /**\n   * @see https://redis.io/commands/zcount\n   */\n  zcount = (...args) => new ZCountCommand(args, this.opts).exec(this.client);\n  /**\n   * @see https://redis.io/commands/zdiffstore\n   */\n  zdiffstore = (...args) => new ZDiffStoreCommand(args, this.opts).exec(this.client);\n  /**\n   * @see https://redis.io/commands/zincrby\n   */\n  zincrby = (key, increment, member) => new ZIncrByCommand([key, increment, member], this.opts).exec(this.client);\n  /**\n   * @see https://redis.io/commands/zinterstore\n   */\n  zinterstore = (...args) => new ZInterStoreCommand(args, this.opts).exec(this.client);\n  /**\n   * @see https://redis.io/commands/zlexcount\n   */\n  zlexcount = (...args) => new ZLexCountCommand(args, this.opts).exec(this.client);\n  /**\n   * @see https://redis.io/commands/zmscore\n   */\n  zmscore = (...args) => new ZMScoreCommand(args, this.opts).exec(this.client);\n  /**\n   * @see https://redis.io/commands/zpopmax\n   */\n  zpopmax = (...args) => new ZPopMaxCommand(args, this.opts).exec(this.client);\n  /**\n   * @see https://redis.io/commands/zpopmin\n   */\n  zpopmin = (...args) => new ZPopMinCommand(args, this.opts).exec(this.client);\n  /**\n   * @see https://redis.io/commands/zrange\n   */\n  zrange = (...args) => new ZRangeCommand(args, this.opts).exec(this.client);\n  /**\n   * @see https://redis.io/commands/zrank\n   */\n  zrank = (key, member) => new ZRankCommand([key, member], this.opts).exec(this.client);\n  /**\n   * @see https://redis.io/commands/zrem\n   */\n  zrem = (key, ...members) => new ZRemCommand([key, ...members], this.opts).exec(this.client);\n  /**\n   * @see https://redis.io/commands/zremrangebylex\n   */\n  zremrangebylex = (...args) => new ZRemRangeByLexCommand(args, this.opts).exec(this.client);\n  /**\n   * @see https://redis.io/commands/zremrangebyrank\n   */\n  zremrangebyrank = (...args) => new ZRemRangeByRankCommand(args, this.opts).exec(this.client);\n  /**\n   * @see https://redis.io/commands/zremrangebyscore\n   */\n  zremrangebyscore = (...args) => new ZRemRangeByScoreCommand(args, this.opts).exec(this.client);\n  /**\n   * @see https://redis.io/commands/zrevrank\n   */\n  zrevrank = (key, member) => new ZRevRankCommand([key, member], this.opts).exec(this.client);\n  /**\n   * @see https://redis.io/commands/zscan\n   */\n  zscan = (...args) => new ZScanCommand(args, this.opts).exec(this.client);\n  /**\n   * @see https://redis.io/commands/zscore\n   */\n  zscore = (key, member) => new ZScoreCommand([key, member], this.opts).exec(this.client);\n  /**\n   * @see https://redis.io/commands/zunion\n   */\n  zunion = (...args) => new ZUnionCommand(args, this.opts).exec(this.client);\n  /**\n   * @see https://redis.io/commands/zunionstore\n   */\n  zunionstore = (...args) => new ZUnionStoreCommand(args, this.opts).exec(this.client);\n};\n\n// version.ts\nvar VERSION = \"v1.35.6\";\n\n\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFwcC1wYWdlcy1icm93c2VyKS8uL25vZGVfbW9kdWxlcy9AdXBzdGFzaC9yZWRpcy9jaHVuay1UQUpJNlRBRS5tanMiLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7QUFBQTtBQUNBO0FBQ0E7QUFDQSw4QkFBOEIsa0NBQWtDO0FBQ2hFOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLENBQUM7QUFDRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSwrR0FBK0csSUFBSTtBQUNuSDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDRDQUE0QyxjQUFjO0FBQzFEO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsTUFBTTtBQUNOO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLElBQUk7QUFDSjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxrQkFBa0IsaUJBQWlCO0FBQ25DLHNCQUFzQixpQ0FBaUM7QUFDdkQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsTUFBTTtBQUNOO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsdUVBQXVFO0FBQ3ZFO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FB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QTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLE1BQU07QUFDTjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSx5QkFBeUIsNkJBQTZCO0FBQ3REO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGlCQUFpQixnRUFBZ0U7QUFDakY7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHFCQUFxQjtBQUNyQixZQUFZO0FBQ1oscUJBQXFCO0FBQ3JCO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFVBQVU7QUFDVjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxPQUFPO0FBQ1A7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxRQUFRO0FBQ1I7QUFDQSxRQUFRO0FBQ1I7QUFDQSxRQUFRO0FBQ1I7QUFDQSxRQUFRO0FBQ1I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxrQkFBa0IsbUJBQW1CO0FBQ3JDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxNQUFNO0FBQ047QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsTUFBTTtBQUNOO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsTUFBTTtBQUNOO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxRQUFRO0FBQ1I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxNQUFNO0FBQ047QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLE1BQU07QUFDTjtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsUUFBUTtBQUNSO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsUUFBUTtBQUNSO0FBQ0EsUUFBUTtBQUNSO0FBQ0EsUUFBUTtBQUNSO0FBQ0EsUUFBUTtBQUNSO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLE1BQU07QUFDTjtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLG9CQUFvQixjQUFjO0FBQ2xDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxzQkFBc0Isb0JBQW9CO0FBQzFDO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsVUFBVTtBQUNWO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLG9CQUFvQixjQUFjO0FBQ2xDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxzQkFBc0Isb0JBQW9CO0FBQzFDO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsVUFBVTtBQUNWO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBLFlBQVksOENBQThDO0FBQzFEO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxNQUFNO0FBQ047QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxNQUFNO0FBQ047QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLG9DQUFvQyxlQUFlO0FBQ25EO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxNQUFNO0FBQ047QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFFBQVE7QUFDUjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLE1BQU07QUFDTjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsUUFBUTtBQUNSO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxNQUFNO0FBQ047QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFFBQVE7QUFDUjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsK0JBQStCLEVBQUUsR0FBRyxJQUFJLEtBQUssd0VBQXdFLGlCQUFpQixFQUFFLEVBQUUsSUFBSSxNQUFNLGNBQWM7QUFDbEs7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0wsNENBQTRDLGVBQWU7QUFDM0Q7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLLGVBQWUsZUFBZTtBQUNuQztBQUNBO0FBQ0EscUJBQXFCLE9BQU8sSUFBSSw2QkFBNkIsWUFBWSxNQUFNO0FBQy9FO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDBCQUEwQjtBQUMxQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGNBQWM7QUFDZDtBQUNBO0FBQ0EsV0FBVztBQUNYO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGdEQUFnRCxrQkFBa0I7QUFDbEU7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQSxnREFBZ0Qsb0JBQW9CO0FBQ3BFO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFFBQVE7QUFDUjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGlEQUFpRCwyQkFBMkI7QUFDNUUsK0NBQStDLFFBQVEsS0FBSywyQkFBMkI7QUFDdkYsVUFBVTtBQUNWLGtGQUFrRixNQUFNO0FBQ3hGO0FBQ0EsUUFBUTtBQUNSO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFlBQVk7QUFDWjtBQUNBLDZDQUE2QyxrQkFBa0I7QUFDL0Qsd0NBQXdDLEtBQUssR0FBRyxRQUFRLEtBQUssa0JBQWtCO0FBQy9FO0FBQ0EsVUFBVTtBQUNWLGtGQUFrRixNQUFNO0FBQ3hGO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsWUFBWTtBQUNaO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsTUFBTTtBQUNOO0FBQ0E7QUFDQTtBQUNBLFVBQVU7QUFDVjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxJQUFJO0FBQ0o7QUFDQTtBQUNBOztBQUVBO0FBQ2tDO0FBQ2xDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDZCQUE2Qiw0Q0FBTTtBQUNuQztBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUM2QztBQUM3QztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSw2QkFBNkIsNENBQU87QUFDcEM7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLE1BQU07QUFDTjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxNQUFNO0FBQ047QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSw2REFBNkQsb0JBQW9CO0FBQ2pGO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsOEJBQThCLElBQUk7QUFDbEM7QUFDQSwrREFBK0Q7QUFDL0Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDhCQUE4QixJQUFJO0FBQ2xDO0FBQ0EsK0RBQStELEtBQUssZ0JBQWdCO0FBQ3BGO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsV0FBVztBQUNYO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxXQUFXO0FBQ1g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDBCQUEwQjtBQUMxQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQU9FIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vX05fRS8uL25vZGVfbW9kdWxlcy9AdXBzdGFzaC9yZWRpcy9jaHVuay1UQUpJNlRBRS5tanM/MDk5YiJdLCJzb3VyY2VzQ29udGVudCI6WyJ2YXIgX19kZWZQcm9wID0gT2JqZWN0LmRlZmluZVByb3BlcnR5O1xudmFyIF9fZXhwb3J0ID0gKHRhcmdldCwgYWxsKSA9PiB7XG4gIGZvciAodmFyIG5hbWUgaW4gYWxsKVxuICAgIF9fZGVmUHJvcCh0YXJnZXQsIG5hbWUsIHsgZ2V0OiBhbGxbbmFtZV0sIGVudW1lcmFibGU6IHRydWUgfSk7XG59O1xuXG4vLyBwa2cvZXJyb3IudHNcbnZhciBlcnJvcl9leHBvcnRzID0ge307XG5fX2V4cG9ydChlcnJvcl9leHBvcnRzLCB7XG4gIFVwc3Rhc2hFcnJvcjogKCkgPT4gVXBzdGFzaEVycm9yLFxuICBVcHN0YXNoSlNPTlBhcnNlRXJyb3I6ICgpID0+IFVwc3Rhc2hKU09OUGFyc2VFcnJvcixcbiAgVXJsRXJyb3I6ICgpID0+IFVybEVycm9yXG59KTtcbnZhciBVcHN0YXNoRXJyb3IgPSBjbGFzcyBleHRlbmRzIEVycm9yIHtcbiAgY29uc3RydWN0b3IobWVzc2FnZSwgb3B0aW9ucykge1xuICAgIHN1cGVyKG1lc3NhZ2UsIG9wdGlvbnMpO1xuICAgIHRoaXMubmFtZSA9IFwiVXBzdGFzaEVycm9yXCI7XG4gIH1cbn07XG52YXIgVXJsRXJyb3IgPSBjbGFzcyBleHRlbmRzIEVycm9yIHtcbiAgY29uc3RydWN0b3IodXJsKSB7XG4gICAgc3VwZXIoXG4gICAgICBgVXBzdGFzaCBSZWRpcyBjbGllbnQgd2FzIHBhc3NlZCBhbiBpbnZhbGlkIFVSTC4gWW91IHNob3VsZCBwYXNzIGEgVVJMIHN0YXJ0aW5nIHdpdGggaHR0cHMuIFJlY2VpdmVkOiBcIiR7dXJsfVwiLiBgXG4gICAgKTtcbiAgICB0aGlzLm5hbWUgPSBcIlVybEVycm9yXCI7XG4gIH1cbn07XG52YXIgVXBzdGFzaEpTT05QYXJzZUVycm9yID0gY2xhc3MgZXh0ZW5kcyBVcHN0YXNoRXJyb3Ige1xuICBjb25zdHJ1Y3Rvcihib2R5LCBvcHRpb25zKSB7XG4gICAgY29uc3QgdHJ1bmNhdGVkQm9keSA9IGJvZHkubGVuZ3RoID4gMjAwID8gYm9keS5zbGljZSgwLCAyMDApICsgXCIuLi5cIiA6IGJvZHk7XG4gICAgc3VwZXIoYFVuYWJsZSB0byBwYXJzZSByZXNwb25zZSBib2R5OiAke3RydW5jYXRlZEJvZHl9YCwgb3B0aW9ucyk7XG4gICAgdGhpcy5uYW1lID0gXCJVcHN0YXNoSlNPTlBhcnNlRXJyb3JcIjtcbiAgfVxufTtcblxuLy8gcGtnL3V0aWwudHNcbmZ1bmN0aW9uIHBhcnNlUmVjdXJzaXZlKG9iaikge1xuICBjb25zdCBwYXJzZWQgPSBBcnJheS5pc0FycmF5KG9iaikgPyBvYmoubWFwKChvKSA9PiB7XG4gICAgdHJ5IHtcbiAgICAgIHJldHVybiBwYXJzZVJlY3Vyc2l2ZShvKTtcbiAgICB9IGNhdGNoIHtcbiAgICAgIHJldHVybiBvO1xuICAgIH1cbiAgfSkgOiBKU09OLnBhcnNlKG9iaik7XG4gIGlmICh0eXBlb2YgcGFyc2VkID09PSBcIm51bWJlclwiICYmIHBhcnNlZC50b1N0cmluZygpICE9PSBvYmopIHtcbiAgICByZXR1cm4gb2JqO1xuICB9XG4gIHJldHVybiBwYXJzZWQ7XG59XG5mdW5jdGlvbiBwYXJzZVJlc3BvbnNlKHJlc3VsdCkge1xuICB0cnkge1xuICAgIHJldHVybiBwYXJzZVJlY3Vyc2l2ZShyZXN1bHQpO1xuICB9IGNhdGNoIHtcbiAgICByZXR1cm4gcmVzdWx0O1xuICB9XG59XG5mdW5jdGlvbiBkZXNlcmlhbGl6ZVNjYW5SZXNwb25zZShyZXN1bHQpIHtcbiAgcmV0dXJuIFtyZXN1bHRbMF0sIC4uLnBhcnNlUmVzcG9uc2UocmVzdWx0LnNsaWNlKDEpKV07XG59XG5mdW5jdGlvbiBkZXNlcmlhbGl6ZVNjYW5XaXRoVHlwZXNSZXNwb25zZShyZXN1bHQpIHtcbiAgY29uc3QgW2N1cnNvciwga2V5c10gPSByZXN1bHQ7XG4gIGNvbnN0IHBhcnNlZEtleXMgPSBbXTtcbiAgZm9yIChsZXQgaSA9IDA7IGkgPCBrZXlzLmxlbmd0aDsgaSArPSAyKSB7XG4gICAgcGFyc2VkS2V5cy5wdXNoKHsga2V5OiBrZXlzW2ldLCB0eXBlOiBrZXlzW2kgKyAxXSB9KTtcbiAgfVxuICByZXR1cm4gW2N1cnNvciwgcGFyc2VkS2V5c107XG59XG5mdW5jdGlvbiBtZXJnZUhlYWRlcnMoLi4uaGVhZGVycykge1xuICBjb25zdCBtZXJnZWQgPSB7fTtcbiAgZm9yIChjb25zdCBoZWFkZXIgb2YgaGVhZGVycykge1xuICAgIGlmICghaGVhZGVyKSBjb250aW51ZTtcbiAgICBmb3IgKGNvbnN0IFtrZXksIHZhbHVlXSBvZiBPYmplY3QuZW50cmllcyhoZWFkZXIpKSB7XG4gICAgICBpZiAodmFsdWUgIT09IHZvaWQgMCAmJiB2YWx1ZSAhPT0gbnVsbCkge1xuICAgICAgICBtZXJnZWRba2V5XSA9IHZhbHVlO1xuICAgICAgfVxuICAgIH1cbiAgfVxuICByZXR1cm4gbWVyZ2VkO1xufVxuXG4vLyBwa2cvaHR0cC50c1xudmFyIEh0dHBDbGllbnQgPSBjbGFzcyB7XG4gIGJhc2VVcmw7XG4gIGhlYWRlcnM7XG4gIG9wdGlvbnM7XG4gIHJlYWRZb3VyV3JpdGVzO1xuICB1cHN0YXNoU3luY1Rva2VuID0gXCJcIjtcbiAgaGFzQ3JlZGVudGlhbHM7XG4gIHJldHJ5O1xuICBjb25zdHJ1Y3Rvcihjb25maWcpIHtcbiAgICB0aGlzLm9wdGlvbnMgPSB7XG4gICAgICBiYWNrZW5kOiBjb25maWcub3B0aW9ucz8uYmFja2VuZCxcbiAgICAgIGFnZW50OiBjb25maWcuYWdlbnQsXG4gICAgICByZXNwb25zZUVuY29kaW5nOiBjb25maWcucmVzcG9uc2VFbmNvZGluZyA/PyBcImJhc2U2NFwiLFxuICAgICAgLy8gZGVmYXVsdCB0byBiYXNlNjRcbiAgICAgIGNhY2hlOiBjb25maWcuY2FjaGUsXG4gICAgICBzaWduYWw6IGNvbmZpZy5zaWduYWwsXG4gICAgICBrZWVwQWxpdmU6IGNvbmZpZy5rZWVwQWxpdmUgPz8gdHJ1ZVxuICAgIH07XG4gICAgdGhpcy51cHN0YXNoU3luY1Rva2VuID0gXCJcIjtcbiAgICB0aGlzLnJlYWRZb3VyV3JpdGVzID0gY29uZmlnLnJlYWRZb3VyV3JpdGVzID8/IHRydWU7XG4gICAgdGhpcy5iYXNlVXJsID0gKGNvbmZpZy5iYXNlVXJsIHx8IFwiXCIpLnJlcGxhY2UoL1xcLyQvLCBcIlwiKTtcbiAgICBjb25zdCB1cmxSZWdleCA9IC9eaHR0cHM/OlxcL1xcL1teXFxzIyQuLz9dLlxcUyokLztcbiAgICBpZiAodGhpcy5iYXNlVXJsICYmICF1cmxSZWdleC50ZXN0KHRoaXMuYmFzZVVybCkpIHtcbiAgICAgIHRocm93IG5ldyBVcmxFcnJvcih0aGlzLmJhc2VVcmwpO1xuICAgIH1cbiAgICB0aGlzLmhlYWRlcnMgPSB7XG4gICAgICBcIkNvbnRlbnQtVHlwZVwiOiBcImFwcGxpY2F0aW9uL2pzb25cIixcbiAgICAgIC4uLmNvbmZpZy5oZWFkZXJzXG4gICAgfTtcbiAgICB0aGlzLmhhc0NyZWRlbnRpYWxzID0gQm9vbGVhbih0aGlzLmJhc2VVcmwgJiYgdGhpcy5oZWFkZXJzLmF1dGhvcml6YXRpb24uc3BsaXQoXCIgXCIpWzFdKTtcbiAgICBpZiAodGhpcy5vcHRpb25zLnJlc3BvbnNlRW5jb2RpbmcgPT09IFwiYmFzZTY0XCIpIHtcbiAgICAgIHRoaXMuaGVhZGVyc1tcIlVwc3Rhc2gtRW5jb2RpbmdcIl0gPSBcImJhc2U2NFwiO1xuICAgIH1cbiAgICB0aGlzLnJldHJ5ID0gdHlwZW9mIGNvbmZpZy5yZXRyeSA9PT0gXCJib29sZWFuXCIgJiYgIWNvbmZpZy5yZXRyeSA/IHtcbiAgICAgIGF0dGVtcHRzOiAxLFxuICAgICAgYmFja29mZjogKCkgPT4gMFxuICAgIH0gOiB7XG4gICAgICBhdHRlbXB0czogY29uZmlnLnJldHJ5Py5yZXRyaWVzID8/IDUsXG4gICAgICBiYWNrb2ZmOiBjb25maWcucmV0cnk/LmJhY2tvZmYgPz8gKChyZXRyeUNvdW50KSA9PiBNYXRoLmV4cChyZXRyeUNvdW50KSAqIDUwKVxuICAgIH07XG4gIH1cbiAgbWVyZ2VUZWxlbWV0cnkodGVsZW1ldHJ5KSB7XG4gICAgdGhpcy5oZWFkZXJzID0gbWVyZ2UodGhpcy5oZWFkZXJzLCBcIlVwc3Rhc2gtVGVsZW1ldHJ5LVJ1bnRpbWVcIiwgdGVsZW1ldHJ5LnJ1bnRpbWUpO1xuICAgIHRoaXMuaGVhZGVycyA9IG1lcmdlKHRoaXMuaGVhZGVycywgXCJVcHN0YXNoLVRlbGVtZXRyeS1QbGF0Zm9ybVwiLCB0ZWxlbWV0cnkucGxhdGZvcm0pO1xuICAgIHRoaXMuaGVhZGVycyA9IG1lcmdlKHRoaXMuaGVhZGVycywgXCJVcHN0YXNoLVRlbGVtZXRyeS1TZGtcIiwgdGVsZW1ldHJ5LnNkayk7XG4gIH1cbiAgYXN5bmMgcmVxdWVzdChyZXEpIHtcbiAgICBjb25zdCByZXF1ZXN0SGVhZGVycyA9IG1lcmdlSGVhZGVycyh0aGlzLmhlYWRlcnMsIHJlcS5oZWFkZXJzID8/IHt9KTtcbiAgICBjb25zdCByZXF1ZXN0VXJsID0gW3RoaXMuYmFzZVVybCwgLi4ucmVxLnBhdGggPz8gW11dLmpvaW4oXCIvXCIpO1xuICAgIGNvbnN0IGlzRXZlbnRTdHJlYW0gPSByZXF1ZXN0SGVhZGVycy5BY2NlcHQgPT09IFwidGV4dC9ldmVudC1zdHJlYW1cIjtcbiAgICBjb25zdCBzaWduYWwgPSByZXEuc2lnbmFsID8/IHRoaXMub3B0aW9ucy5zaWduYWw7XG4gICAgY29uc3QgaXNTaWduYWxGdW5jdGlvbiA9IHR5cGVvZiBzaWduYWwgPT09IFwiZnVuY3Rpb25cIjtcbiAgICBjb25zdCByZXF1ZXN0T3B0aW9ucyA9IHtcbiAgICAgIC8vQHRzLWV4cGVjdC1lcnJvciB0aGlzIHNob3VsZCB0aHJvdyBkdWUgdG8gYnVuIHJlZ3Jlc3Npb25cbiAgICAgIGNhY2hlOiB0aGlzLm9wdGlvbnMuY2FjaGUsXG4gICAgICBtZXRob2Q6IFwiUE9TVFwiLFxuICAgICAgaGVhZGVyczogcmVxdWVzdEhlYWRlcnMsXG4gICAgICBib2R5OiBKU09OLnN0cmluZ2lmeShyZXEuYm9keSksXG4gICAgICBrZWVwYWxpdmU6IHRoaXMub3B0aW9ucy5rZWVwQWxpdmUsXG4gICAgICBhZ2VudDogdGhpcy5vcHRpb25zLmFnZW50LFxuICAgICAgc2lnbmFsOiBpc1NpZ25hbEZ1bmN0aW9uID8gc2lnbmFsKCkgOiBzaWduYWwsXG4gICAgICAvKipcbiAgICAgICAqIEZhc3RseSBzcGVjaWZpY1xuICAgICAgICovXG4gICAgICBiYWNrZW5kOiB0aGlzLm9wdGlvbnMuYmFja2VuZFxuICAgIH07XG4gICAgaWYgKCF0aGlzLmhhc0NyZWRlbnRpYWxzKSB7XG4gICAgICBjb25zb2xlLndhcm4oXG4gICAgICAgIFwiW1Vwc3Rhc2ggUmVkaXNdIFJlZGlzIGNsaWVudCB3YXMgaW5pdGlhbGl6ZWQgd2l0aG91dCB1cmwgb3IgdG9rZW4uIEZhaWxlZCB0byBleGVjdXRlIGNvbW1hbmQuXCJcbiAgICAgICk7XG4gICAgfVxuICAgIGlmICh0aGlzLnJlYWRZb3VyV3JpdGVzKSB7XG4gICAgICBjb25zdCBuZXdIZWFkZXIgPSB0aGlzLnVwc3Rhc2hTeW5jVG9rZW47XG4gICAgICB0aGlzLmhlYWRlcnNbXCJ1cHN0YXNoLXN5bmMtdG9rZW5cIl0gPSBuZXdIZWFkZXI7XG4gICAgfVxuICAgIGxldCByZXMgPSBudWxsO1xuICAgIGxldCBlcnJvciA9IG51bGw7XG4gICAgZm9yIChsZXQgaSA9IDA7IGkgPD0gdGhpcy5yZXRyeS5hdHRlbXB0czsgaSsrKSB7XG4gICAgICB0cnkge1xuICAgICAgICByZXMgPSBhd2FpdCBmZXRjaChyZXF1ZXN0VXJsLCByZXF1ZXN0T3B0aW9ucyk7XG4gICAgICAgIGJyZWFrO1xuICAgICAgfSBjYXRjaCAoZXJyb3JfKSB7XG4gICAgICAgIGlmIChyZXF1ZXN0T3B0aW9ucy5zaWduYWw/LmFib3J0ZWQgJiYgaXNTaWduYWxGdW5jdGlvbikge1xuICAgICAgICAgIHRocm93IGVycm9yXztcbiAgICAgICAgfSBlbHNlIGlmIChyZXF1ZXN0T3B0aW9ucy5zaWduYWw/LmFib3J0ZWQpIHtcbiAgICAgICAgICBjb25zdCBteUJsb2IgPSBuZXcgQmxvYihbXG4gICAgICAgICAgICBKU09OLnN0cmluZ2lmeSh7IHJlc3VsdDogcmVxdWVzdE9wdGlvbnMuc2lnbmFsLnJlYXNvbiA/PyBcIkFib3J0ZWRcIiB9KVxuICAgICAgICAgIF0pO1xuICAgICAgICAgIGNvbnN0IG15T3B0aW9ucyA9IHtcbiAgICAgICAgICAgIHN0YXR1czogMjAwLFxuICAgICAgICAgICAgc3RhdHVzVGV4dDogcmVxdWVzdE9wdGlvbnMuc2lnbmFsLnJlYXNvbiA/PyBcIkFib3J0ZWRcIlxuICAgICAgICAgIH07XG4gICAgICAgICAgcmVzID0gbmV3IFJlc3BvbnNlKG15QmxvYiwgbXlPcHRpb25zKTtcbiAgICAgICAgICBicmVhaztcbiAgICAgICAgfVxuICAgICAgICBlcnJvciA9IGVycm9yXztcbiAgICAgICAgaWYgKGkgPCB0aGlzLnJldHJ5LmF0dGVtcHRzKSB7XG4gICAgICAgICAgYXdhaXQgbmV3IFByb21pc2UoKHIpID0+IHNldFRpbWVvdXQociwgdGhpcy5yZXRyeS5iYWNrb2ZmKGkpKSk7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9XG4gICAgaWYgKCFyZXMpIHtcbiAgICAgIHRocm93IGVycm9yID8/IG5ldyBFcnJvcihcIkV4aGF1c3RlZCBhbGwgcmV0cmllc1wiKTtcbiAgICB9XG4gICAgaWYgKCFyZXMub2spIHtcbiAgICAgIGxldCBib2R5MjtcbiAgICAgIGNvbnN0IHJhd0JvZHkyID0gYXdhaXQgcmVzLnRleHQoKTtcbiAgICAgIHRyeSB7XG4gICAgICAgIGJvZHkyID0gSlNPTi5wYXJzZShyYXdCb2R5Mik7XG4gICAgICB9IGNhdGNoIChlcnJvcjIpIHtcbiAgICAgICAgdGhyb3cgbmV3IFVwc3Rhc2hKU09OUGFyc2VFcnJvcihyYXdCb2R5MiwgeyBjYXVzZTogZXJyb3IyIH0pO1xuICAgICAgfVxuICAgICAgdGhyb3cgbmV3IFVwc3Rhc2hFcnJvcihgJHtib2R5Mi5lcnJvcn0sIGNvbW1hbmQgd2FzOiAke0pTT04uc3RyaW5naWZ5KHJlcS5ib2R5KX1gKTtcbiAgICB9XG4gICAgaWYgKHRoaXMucmVhZFlvdXJXcml0ZXMpIHtcbiAgICAgIGNvbnN0IGhlYWRlcnMgPSByZXMuaGVhZGVycztcbiAgICAgIHRoaXMudXBzdGFzaFN5bmNUb2tlbiA9IGhlYWRlcnMuZ2V0KFwidXBzdGFzaC1zeW5jLXRva2VuXCIpID8/IFwiXCI7XG4gICAgfVxuICAgIGlmIChpc0V2ZW50U3RyZWFtICYmIHJlcSAmJiByZXEub25NZXNzYWdlICYmIHJlcy5ib2R5KSB7XG4gICAgICBjb25zdCByZWFkZXIgPSByZXMuYm9keS5nZXRSZWFkZXIoKTtcbiAgICAgIGNvbnN0IGRlY29kZXIgPSBuZXcgVGV4dERlY29kZXIoKTtcbiAgICAgIChhc3luYyAoKSA9PiB7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgd2hpbGUgKHRydWUpIHtcbiAgICAgICAgICAgIGNvbnN0IHsgdmFsdWUsIGRvbmUgfSA9IGF3YWl0IHJlYWRlci5yZWFkKCk7XG4gICAgICAgICAgICBpZiAoZG9uZSkgYnJlYWs7XG4gICAgICAgICAgICBjb25zdCBjaHVuayA9IGRlY29kZXIuZGVjb2RlKHZhbHVlKTtcbiAgICAgICAgICAgIGNvbnN0IGxpbmVzID0gY2h1bmsuc3BsaXQoXCJcXG5cIik7XG4gICAgICAgICAgICBmb3IgKGNvbnN0IGxpbmUgb2YgbGluZXMpIHtcbiAgICAgICAgICAgICAgaWYgKGxpbmUuc3RhcnRzV2l0aChcImRhdGE6IFwiKSkge1xuICAgICAgICAgICAgICAgIGNvbnN0IGRhdGEgPSBsaW5lLnNsaWNlKDYpO1xuICAgICAgICAgICAgICAgIHJlcS5vbk1lc3NhZ2U/LihkYXRhKTtcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgIH1cbiAgICAgICAgfSBjYXRjaCAoZXJyb3IyKSB7XG4gICAgICAgICAgaWYgKGVycm9yMiBpbnN0YW5jZW9mIEVycm9yICYmIGVycm9yMi5uYW1lID09PSBcIkFib3J0RXJyb3JcIikge1xuICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBjb25zb2xlLmVycm9yKFwiU3RyZWFtIHJlYWRpbmcgZXJyb3I6XCIsIGVycm9yMik7XG4gICAgICAgICAgfVxuICAgICAgICB9IGZpbmFsbHkge1xuICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICBhd2FpdCByZWFkZXIuY2FuY2VsKCk7XG4gICAgICAgICAgfSBjYXRjaCB7XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9KSgpO1xuICAgICAgcmV0dXJuIHsgcmVzdWx0OiAxIH07XG4gICAgfVxuICAgIGxldCBib2R5O1xuICAgIGNvbnN0IHJhd0JvZHkgPSBhd2FpdCByZXMudGV4dCgpO1xuICAgIHRyeSB7XG4gICAgICBib2R5ID0gSlNPTi5wYXJzZShyYXdCb2R5KTtcbiAgICB9IGNhdGNoIChlcnJvcjIpIHtcbiAgICAgIHRocm93IG5ldyBVcHN0YXNoSlNPTlBhcnNlRXJyb3IocmF3Qm9keSwgeyBjYXVzZTogZXJyb3IyIH0pO1xuICAgIH1cbiAgICBpZiAodGhpcy5yZWFkWW91cldyaXRlcykge1xuICAgICAgY29uc3QgaGVhZGVycyA9IHJlcy5oZWFkZXJzO1xuICAgICAgdGhpcy51cHN0YXNoU3luY1Rva2VuID0gaGVhZGVycy5nZXQoXCJ1cHN0YXNoLXN5bmMtdG9rZW5cIikgPz8gXCJcIjtcbiAgICB9XG4gICAgaWYgKHRoaXMub3B0aW9ucy5yZXNwb25zZUVuY29kaW5nID09PSBcImJhc2U2NFwiKSB7XG4gICAgICBpZiAoQXJyYXkuaXNBcnJheShib2R5KSkge1xuICAgICAgICByZXR1cm4gYm9keS5tYXAoKHsgcmVzdWx0OiByZXN1bHQyLCBlcnJvcjogZXJyb3IyIH0pID0+ICh7XG4gICAgICAgICAgcmVzdWx0OiBkZWNvZGUocmVzdWx0MiksXG4gICAgICAgICAgZXJyb3I6IGVycm9yMlxuICAgICAgICB9KSk7XG4gICAgICB9XG4gICAgICBjb25zdCByZXN1bHQgPSBkZWNvZGUoYm9keS5yZXN1bHQpO1xuICAgICAgcmV0dXJuIHsgcmVzdWx0LCBlcnJvcjogYm9keS5lcnJvciB9O1xuICAgIH1cbiAgICByZXR1cm4gYm9keTtcbiAgfVxufTtcbmZ1bmN0aW9uIGJhc2U2NGRlY29kZShiNjQpIHtcbiAgbGV0IGRlYyA9IFwiXCI7XG4gIHRyeSB7XG4gICAgY29uc3QgYmluU3RyaW5nID0gYXRvYihiNjQpO1xuICAgIGNvbnN0IHNpemUgPSBiaW5TdHJpbmcubGVuZ3RoO1xuICAgIGNvbnN0IGJ5dGVzID0gbmV3IFVpbnQ4QXJyYXkoc2l6ZSk7XG4gICAgZm9yIChsZXQgaSA9IDA7IGkgPCBzaXplOyBpKyspIHtcbiAgICAgIGJ5dGVzW2ldID0gYmluU3RyaW5nLmNoYXJDb2RlQXQoaSk7XG4gICAgfVxuICAgIGRlYyA9IG5ldyBUZXh0RGVjb2RlcigpLmRlY29kZShieXRlcyk7XG4gIH0gY2F0Y2gge1xuICAgIGRlYyA9IGI2NDtcbiAgfVxuICByZXR1cm4gZGVjO1xufVxuZnVuY3Rpb24gZGVjb2RlKHJhdykge1xuICBsZXQgcmVzdWx0ID0gdm9pZCAwO1xuICBzd2l0Y2ggKHR5cGVvZiByYXcpIHtcbiAgICBjYXNlIFwidW5kZWZpbmVkXCI6IHtcbiAgICAgIHJldHVybiByYXc7XG4gICAgfVxuICAgIGNhc2UgXCJudW1iZXJcIjoge1xuICAgICAgcmVzdWx0ID0gcmF3O1xuICAgICAgYnJlYWs7XG4gICAgfVxuICAgIGNhc2UgXCJvYmplY3RcIjoge1xuICAgICAgaWYgKEFycmF5LmlzQXJyYXkocmF3KSkge1xuICAgICAgICByZXN1bHQgPSByYXcubWFwKFxuICAgICAgICAgICh2KSA9PiB0eXBlb2YgdiA9PT0gXCJzdHJpbmdcIiA/IGJhc2U2NGRlY29kZSh2KSA6IEFycmF5LmlzQXJyYXkodikgPyB2Lm1hcCgoZWxlbWVudCkgPT4gZGVjb2RlKGVsZW1lbnQpKSA6IHZcbiAgICAgICAgKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHJlc3VsdCA9IG51bGw7XG4gICAgICB9XG4gICAgICBicmVhaztcbiAgICB9XG4gICAgY2FzZSBcInN0cmluZ1wiOiB7XG4gICAgICByZXN1bHQgPSByYXcgPT09IFwiT0tcIiA/IFwiT0tcIiA6IGJhc2U2NGRlY29kZShyYXcpO1xuICAgICAgYnJlYWs7XG4gICAgfVxuICAgIGRlZmF1bHQ6IHtcbiAgICAgIGJyZWFrO1xuICAgIH1cbiAgfVxuICByZXR1cm4gcmVzdWx0O1xufVxuZnVuY3Rpb24gbWVyZ2Uob2JqLCBrZXksIHZhbHVlKSB7XG4gIGlmICghdmFsdWUpIHtcbiAgICByZXR1cm4gb2JqO1xuICB9XG4gIG9ialtrZXldID0gb2JqW2tleV0gPyBbb2JqW2tleV0sIHZhbHVlXS5qb2luKFwiLFwiKSA6IHZhbHVlO1xuICByZXR1cm4gb2JqO1xufVxuXG4vLyBwa2cvY29tbWFuZHMvY29tbWFuZC50c1xudmFyIGRlZmF1bHRTZXJpYWxpemVyID0gKGMpID0+IHtcbiAgc3dpdGNoICh0eXBlb2YgYykge1xuICAgIGNhc2UgXCJzdHJpbmdcIjpcbiAgICBjYXNlIFwibnVtYmVyXCI6XG4gICAgY2FzZSBcImJvb2xlYW5cIjoge1xuICAgICAgcmV0dXJuIGM7XG4gICAgfVxuICAgIGRlZmF1bHQ6IHtcbiAgICAgIHJldHVybiBKU09OLnN0cmluZ2lmeShjKTtcbiAgICB9XG4gIH1cbn07XG52YXIgQ29tbWFuZCA9IGNsYXNzIHtcbiAgY29tbWFuZDtcbiAgc2VyaWFsaXplO1xuICBkZXNlcmlhbGl6ZTtcbiAgaGVhZGVycztcbiAgcGF0aDtcbiAgb25NZXNzYWdlO1xuICBpc1N0cmVhbWluZztcbiAgc2lnbmFsO1xuICAvKipcbiAgICogQ3JlYXRlIGEgbmV3IGNvbW1hbmQgaW5zdGFuY2UuXG4gICAqXG4gICAqIFlvdSBjYW4gZGVmaW5lIGEgY3VzdG9tIGBkZXNlcmlhbGl6ZWAgZnVuY3Rpb24uIEJ5IGRlZmF1bHQgd2UgdHJ5IHRvIGRlc2VyaWFsaXplIGFzIGpzb24uXG4gICAqL1xuICBjb25zdHJ1Y3Rvcihjb21tYW5kLCBvcHRzKSB7XG4gICAgdGhpcy5zZXJpYWxpemUgPSBkZWZhdWx0U2VyaWFsaXplcjtcbiAgICB0aGlzLmRlc2VyaWFsaXplID0gb3B0cz8uYXV0b21hdGljRGVzZXJpYWxpemF0aW9uID09PSB2b2lkIDAgfHwgb3B0cy5hdXRvbWF0aWNEZXNlcmlhbGl6YXRpb24gPyBvcHRzPy5kZXNlcmlhbGl6ZSA/PyBwYXJzZVJlc3BvbnNlIDogKHgpID0+IHg7XG4gICAgdGhpcy5jb21tYW5kID0gY29tbWFuZC5tYXAoKGMpID0+IHRoaXMuc2VyaWFsaXplKGMpKTtcbiAgICB0aGlzLmhlYWRlcnMgPSBvcHRzPy5oZWFkZXJzO1xuICAgIHRoaXMucGF0aCA9IG9wdHM/LnBhdGg7XG4gICAgdGhpcy5vbk1lc3NhZ2UgPSBvcHRzPy5zdHJlYW1PcHRpb25zPy5vbk1lc3NhZ2U7XG4gICAgdGhpcy5pc1N0cmVhbWluZyA9IG9wdHM/LnN0cmVhbU9wdGlvbnM/LmlzU3RyZWFtaW5nID8/IGZhbHNlO1xuICAgIHRoaXMuc2lnbmFsID0gb3B0cz8uc3RyZWFtT3B0aW9ucz8uc2lnbmFsO1xuICAgIGlmIChvcHRzPy5sYXRlbmN5TG9nZ2luZykge1xuICAgICAgY29uc3Qgb3JpZ2luYWxFeGVjID0gdGhpcy5leGVjLmJpbmQodGhpcyk7XG4gICAgICB0aGlzLmV4ZWMgPSBhc3luYyAoY2xpZW50KSA9PiB7XG4gICAgICAgIGNvbnN0IHN0YXJ0ID0gcGVyZm9ybWFuY2Uubm93KCk7XG4gICAgICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IG9yaWdpbmFsRXhlYyhjbGllbnQpO1xuICAgICAgICBjb25zdCBlbmQgPSBwZXJmb3JtYW5jZS5ub3coKTtcbiAgICAgICAgY29uc3QgbG9nZ2VyUmVzdWx0ID0gKGVuZCAtIHN0YXJ0KS50b0ZpeGVkKDIpO1xuICAgICAgICBjb25zb2xlLmxvZyhcbiAgICAgICAgICBgTGF0ZW5jeSBmb3IgXFx4MUJbMzg7MjsxOTsxODU7MzltJHt0aGlzLmNvbW1hbmRbMF0udG9TdHJpbmcoKS50b1VwcGVyQ2FzZSgpfVxceDFCWzBtOiBcXHgxQlszODsyOzA7MjU1OzI1NW0ke2xvZ2dlclJlc3VsdH0gbXNcXHgxQlswbWBcbiAgICAgICAgKTtcbiAgICAgICAgcmV0dXJuIHJlc3VsdDtcbiAgICAgIH07XG4gICAgfVxuICB9XG4gIC8qKlxuICAgKiBFeGVjdXRlIHRoZSBjb21tYW5kIHVzaW5nIGEgY2xpZW50LlxuICAgKi9cbiAgYXN5bmMgZXhlYyhjbGllbnQpIHtcbiAgICBjb25zdCB7IHJlc3VsdCwgZXJyb3IgfSA9IGF3YWl0IGNsaWVudC5yZXF1ZXN0KHtcbiAgICAgIGJvZHk6IHRoaXMuY29tbWFuZCxcbiAgICAgIHBhdGg6IHRoaXMucGF0aCxcbiAgICAgIHVwc3Rhc2hTeW5jVG9rZW46IGNsaWVudC51cHN0YXNoU3luY1Rva2VuLFxuICAgICAgaGVhZGVyczogdGhpcy5oZWFkZXJzLFxuICAgICAgb25NZXNzYWdlOiB0aGlzLm9uTWVzc2FnZSxcbiAgICAgIGlzU3RyZWFtaW5nOiB0aGlzLmlzU3RyZWFtaW5nLFxuICAgICAgc2lnbmFsOiB0aGlzLnNpZ25hbFxuICAgIH0pO1xuICAgIGlmIChlcnJvcikge1xuICAgICAgdGhyb3cgbmV3IFVwc3Rhc2hFcnJvcihlcnJvcik7XG4gICAgfVxuICAgIGlmIChyZXN1bHQgPT09IHZvaWQgMCkge1xuICAgICAgdGhyb3cgbmV3IFR5cGVFcnJvcihcIlJlcXVlc3QgZGlkIG5vdCByZXR1cm4gYSByZXN1bHRcIik7XG4gICAgfVxuICAgIHJldHVybiB0aGlzLmRlc2VyaWFsaXplKHJlc3VsdCk7XG4gIH1cbn07XG5cbi8vIHBrZy9jb21tYW5kcy9ocmFuZGZpZWxkLnRzXG5mdW5jdGlvbiBkZXNlcmlhbGl6ZShyZXN1bHQpIHtcbiAgaWYgKHJlc3VsdC5sZW5ndGggPT09IDApIHtcbiAgICByZXR1cm4gbnVsbDtcbiAgfVxuICBjb25zdCBvYmogPSB7fTtcbiAgZm9yIChsZXQgaSA9IDA7IGkgPCByZXN1bHQubGVuZ3RoOyBpICs9IDIpIHtcbiAgICBjb25zdCBrZXkgPSByZXN1bHRbaV07XG4gICAgY29uc3QgdmFsdWUgPSByZXN1bHRbaSArIDFdO1xuICAgIHRyeSB7XG4gICAgICBvYmpba2V5XSA9IEpTT04ucGFyc2UodmFsdWUpO1xuICAgIH0gY2F0Y2gge1xuICAgICAgb2JqW2tleV0gPSB2YWx1ZTtcbiAgICB9XG4gIH1cbiAgcmV0dXJuIG9iajtcbn1cbnZhciBIUmFuZEZpZWxkQ29tbWFuZCA9IGNsYXNzIGV4dGVuZHMgQ29tbWFuZCB7XG4gIGNvbnN0cnVjdG9yKGNtZCwgb3B0cykge1xuICAgIGNvbnN0IGNvbW1hbmQgPSBbXCJocmFuZGZpZWxkXCIsIGNtZFswXV07XG4gICAgaWYgKHR5cGVvZiBjbWRbMV0gPT09IFwibnVtYmVyXCIpIHtcbiAgICAgIGNvbW1hbmQucHVzaChjbWRbMV0pO1xuICAgIH1cbiAgICBpZiAoY21kWzJdKSB7XG4gICAgICBjb21tYW5kLnB1c2goXCJXSVRIVkFMVUVTXCIpO1xuICAgIH1cbiAgICBzdXBlcihjb21tYW5kLCB7XG4gICAgICAvLyBAdHMtZXhwZWN0LWVycm9yIHRvIHNpbGVuY2UgY29tcGlsZXJcbiAgICAgIGRlc2VyaWFsaXplOiBjbWRbMl0gPyAocmVzdWx0KSA9PiBkZXNlcmlhbGl6ZShyZXN1bHQpIDogb3B0cz8uZGVzZXJpYWxpemUsXG4gICAgICAuLi5vcHRzXG4gICAgfSk7XG4gIH1cbn07XG5cbi8vIHBrZy9jb21tYW5kcy9hcHBlbmQudHNcbnZhciBBcHBlbmRDb21tYW5kID0gY2xhc3MgZXh0ZW5kcyBDb21tYW5kIHtcbiAgY29uc3RydWN0b3IoY21kLCBvcHRzKSB7XG4gICAgc3VwZXIoW1wiYXBwZW5kXCIsIC4uLmNtZF0sIG9wdHMpO1xuICB9XG59O1xuXG4vLyBwa2cvY29tbWFuZHMvYml0Y291bnQudHNcbnZhciBCaXRDb3VudENvbW1hbmQgPSBjbGFzcyBleHRlbmRzIENvbW1hbmQge1xuICBjb25zdHJ1Y3Rvcihba2V5LCBzdGFydCwgZW5kXSwgb3B0cykge1xuICAgIGNvbnN0IGNvbW1hbmQgPSBbXCJiaXRjb3VudFwiLCBrZXldO1xuICAgIGlmICh0eXBlb2Ygc3RhcnQgPT09IFwibnVtYmVyXCIpIHtcbiAgICAgIGNvbW1hbmQucHVzaChzdGFydCk7XG4gICAgfVxuICAgIGlmICh0eXBlb2YgZW5kID09PSBcIm51bWJlclwiKSB7XG4gICAgICBjb21tYW5kLnB1c2goZW5kKTtcbiAgICB9XG4gICAgc3VwZXIoY29tbWFuZCwgb3B0cyk7XG4gIH1cbn07XG5cbi8vIHBrZy9jb21tYW5kcy9iaXRmaWVsZC50c1xudmFyIEJpdEZpZWxkQ29tbWFuZCA9IGNsYXNzIHtcbiAgY29uc3RydWN0b3IoYXJncywgY2xpZW50LCBvcHRzLCBleGVjT3BlcmF0aW9uID0gKGNvbW1hbmQpID0+IGNvbW1hbmQuZXhlYyh0aGlzLmNsaWVudCkpIHtcbiAgICB0aGlzLmNsaWVudCA9IGNsaWVudDtcbiAgICB0aGlzLm9wdHMgPSBvcHRzO1xuICAgIHRoaXMuZXhlY09wZXJhdGlvbiA9IGV4ZWNPcGVyYXRpb247XG4gICAgdGhpcy5jb21tYW5kID0gW1wiYml0ZmllbGRcIiwgLi4uYXJnc107XG4gIH1cbiAgY29tbWFuZDtcbiAgY2hhaW4oLi4uYXJncykge1xuICAgIHRoaXMuY29tbWFuZC5wdXNoKC4uLmFyZ3MpO1xuICAgIHJldHVybiB0aGlzO1xuICB9XG4gIGdldCguLi5hcmdzKSB7XG4gICAgcmV0dXJuIHRoaXMuY2hhaW4oXCJnZXRcIiwgLi4uYXJncyk7XG4gIH1cbiAgc2V0KC4uLmFyZ3MpIHtcbiAgICByZXR1cm4gdGhpcy5jaGFpbihcInNldFwiLCAuLi5hcmdzKTtcbiAgfVxuICBpbmNyYnkoLi4uYXJncykge1xuICAgIHJldHVybiB0aGlzLmNoYWluKFwiaW5jcmJ5XCIsIC4uLmFyZ3MpO1xuICB9XG4gIG92ZXJmbG93KG92ZXJmbG93KSB7XG4gICAgcmV0dXJuIHRoaXMuY2hhaW4oXCJvdmVyZmxvd1wiLCBvdmVyZmxvdyk7XG4gIH1cbiAgZXhlYygpIHtcbiAgICBjb25zdCBjb21tYW5kID0gbmV3IENvbW1hbmQodGhpcy5jb21tYW5kLCB0aGlzLm9wdHMpO1xuICAgIHJldHVybiB0aGlzLmV4ZWNPcGVyYXRpb24oY29tbWFuZCk7XG4gIH1cbn07XG5cbi8vIHBrZy9jb21tYW5kcy9iaXRvcC50c1xudmFyIEJpdE9wQ29tbWFuZCA9IGNsYXNzIGV4dGVuZHMgQ29tbWFuZCB7XG4gIGNvbnN0cnVjdG9yKGNtZCwgb3B0cykge1xuICAgIHN1cGVyKFtcImJpdG9wXCIsIC4uLmNtZF0sIG9wdHMpO1xuICB9XG59O1xuXG4vLyBwa2cvY29tbWFuZHMvYml0cG9zLnRzXG52YXIgQml0UG9zQ29tbWFuZCA9IGNsYXNzIGV4dGVuZHMgQ29tbWFuZCB7XG4gIGNvbnN0cnVjdG9yKGNtZCwgb3B0cykge1xuICAgIHN1cGVyKFtcImJpdHBvc1wiLCAuLi5jbWRdLCBvcHRzKTtcbiAgfVxufTtcblxuLy8gcGtnL2NvbW1hbmRzL2NvcHkudHNcbnZhciBDb3B5Q29tbWFuZCA9IGNsYXNzIGV4dGVuZHMgQ29tbWFuZCB7XG4gIGNvbnN0cnVjdG9yKFtrZXksIGRlc3RpbmF0aW9uS2V5LCBvcHRzXSwgY29tbWFuZE9wdGlvbnMpIHtcbiAgICBzdXBlcihbXCJDT1BZXCIsIGtleSwgZGVzdGluYXRpb25LZXksIC4uLm9wdHM/LnJlcGxhY2UgPyBbXCJSRVBMQUNFXCJdIDogW11dLCB7XG4gICAgICAuLi5jb21tYW5kT3B0aW9ucyxcbiAgICAgIGRlc2VyaWFsaXplKHJlc3VsdCkge1xuICAgICAgICBpZiAocmVzdWx0ID4gMCkge1xuICAgICAgICAgIHJldHVybiBcIkNPUElFRFwiO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBcIk5PVF9DT1BJRURcIjtcbiAgICAgIH1cbiAgICB9KTtcbiAgfVxufTtcblxuLy8gcGtnL2NvbW1hbmRzL2Ric2l6ZS50c1xudmFyIERCU2l6ZUNvbW1hbmQgPSBjbGFzcyBleHRlbmRzIENvbW1hbmQge1xuICBjb25zdHJ1Y3RvcihvcHRzKSB7XG4gICAgc3VwZXIoW1wiZGJzaXplXCJdLCBvcHRzKTtcbiAgfVxufTtcblxuLy8gcGtnL2NvbW1hbmRzL2RlY3IudHNcbnZhciBEZWNyQ29tbWFuZCA9IGNsYXNzIGV4dGVuZHMgQ29tbWFuZCB7XG4gIGNvbnN0cnVjdG9yKGNtZCwgb3B0cykge1xuICAgIHN1cGVyKFtcImRlY3JcIiwgLi4uY21kXSwgb3B0cyk7XG4gIH1cbn07XG5cbi8vIHBrZy9jb21tYW5kcy9kZWNyYnkudHNcbnZhciBEZWNyQnlDb21tYW5kID0gY2xhc3MgZXh0ZW5kcyBDb21tYW5kIHtcbiAgY29uc3RydWN0b3IoY21kLCBvcHRzKSB7XG4gICAgc3VwZXIoW1wiZGVjcmJ5XCIsIC4uLmNtZF0sIG9wdHMpO1xuICB9XG59O1xuXG4vLyBwa2cvY29tbWFuZHMvZGVsLnRzXG52YXIgRGVsQ29tbWFuZCA9IGNsYXNzIGV4dGVuZHMgQ29tbWFuZCB7XG4gIGNvbnN0cnVjdG9yKGNtZCwgb3B0cykge1xuICAgIHN1cGVyKFtcImRlbFwiLCAuLi5jbWRdLCBvcHRzKTtcbiAgfVxufTtcblxuLy8gcGtnL2NvbW1hbmRzL2VjaG8udHNcbnZhciBFY2hvQ29tbWFuZCA9IGNsYXNzIGV4dGVuZHMgQ29tbWFuZCB7XG4gIGNvbnN0cnVjdG9yKGNtZCwgb3B0cykge1xuICAgIHN1cGVyKFtcImVjaG9cIiwgLi4uY21kXSwgb3B0cyk7XG4gIH1cbn07XG5cbi8vIHBrZy9jb21tYW5kcy9ldmFsUm8udHNcbnZhciBFdmFsUk9Db21tYW5kID0gY2xhc3MgZXh0ZW5kcyBDb21tYW5kIHtcbiAgY29uc3RydWN0b3IoW3NjcmlwdCwga2V5cywgYXJnc10sIG9wdHMpIHtcbiAgICBzdXBlcihbXCJldmFsX3JvXCIsIHNjcmlwdCwga2V5cy5sZW5ndGgsIC4uLmtleXMsIC4uLmFyZ3MgPz8gW11dLCBvcHRzKTtcbiAgfVxufTtcblxuLy8gcGtnL2NvbW1hbmRzL2V2YWwudHNcbnZhciBFdmFsQ29tbWFuZCA9IGNsYXNzIGV4dGVuZHMgQ29tbWFuZCB7XG4gIGNvbnN0cnVjdG9yKFtzY3JpcHQsIGtleXMsIGFyZ3NdLCBvcHRzKSB7XG4gICAgc3VwZXIoW1wiZXZhbFwiLCBzY3JpcHQsIGtleXMubGVuZ3RoLCAuLi5rZXlzLCAuLi5hcmdzID8/IFtdXSwgb3B0cyk7XG4gIH1cbn07XG5cbi8vIHBrZy9jb21tYW5kcy9ldmFsc2hhUm8udHNcbnZhciBFdmFsc2hhUk9Db21tYW5kID0gY2xhc3MgZXh0ZW5kcyBDb21tYW5kIHtcbiAgY29uc3RydWN0b3IoW3NoYSwga2V5cywgYXJnc10sIG9wdHMpIHtcbiAgICBzdXBlcihbXCJldmFsc2hhX3JvXCIsIHNoYSwga2V5cy5sZW5ndGgsIC4uLmtleXMsIC4uLmFyZ3MgPz8gW11dLCBvcHRzKTtcbiAgfVxufTtcblxuLy8gcGtnL2NvbW1hbmRzL2V2YWxzaGEudHNcbnZhciBFdmFsc2hhQ29tbWFuZCA9IGNsYXNzIGV4dGVuZHMgQ29tbWFuZCB7XG4gIGNvbnN0cnVjdG9yKFtzaGEsIGtleXMsIGFyZ3NdLCBvcHRzKSB7XG4gICAgc3VwZXIoW1wiZXZhbHNoYVwiLCBzaGEsIGtleXMubGVuZ3RoLCAuLi5rZXlzLCAuLi5hcmdzID8/IFtdXSwgb3B0cyk7XG4gIH1cbn07XG5cbi8vIHBrZy9jb21tYW5kcy9leGVjLnRzXG52YXIgRXhlY0NvbW1hbmQgPSBjbGFzcyBleHRlbmRzIENvbW1hbmQge1xuICBjb25zdHJ1Y3RvcihjbWQsIG9wdHMpIHtcbiAgICBjb25zdCBub3JtYWxpemVkQ21kID0gY21kLm1hcCgoYXJnKSA9PiB0eXBlb2YgYXJnID09PSBcInN0cmluZ1wiID8gYXJnIDogU3RyaW5nKGFyZykpO1xuICAgIHN1cGVyKG5vcm1hbGl6ZWRDbWQsIG9wdHMpO1xuICB9XG59O1xuXG4vLyBwa2cvY29tbWFuZHMvZXhpc3RzLnRzXG52YXIgRXhpc3RzQ29tbWFuZCA9IGNsYXNzIGV4dGVuZHMgQ29tbWFuZCB7XG4gIGNvbnN0cnVjdG9yKGNtZCwgb3B0cykge1xuICAgIHN1cGVyKFtcImV4aXN0c1wiLCAuLi5jbWRdLCBvcHRzKTtcbiAgfVxufTtcblxuLy8gcGtnL2NvbW1hbmRzL2V4cGlyZS50c1xudmFyIEV4cGlyZUNvbW1hbmQgPSBjbGFzcyBleHRlbmRzIENvbW1hbmQge1xuICBjb25zdHJ1Y3RvcihjbWQsIG9wdHMpIHtcbiAgICBzdXBlcihbXCJleHBpcmVcIiwgLi4uY21kLmZpbHRlcihCb29sZWFuKV0sIG9wdHMpO1xuICB9XG59O1xuXG4vLyBwa2cvY29tbWFuZHMvZXhwaXJlYXQudHNcbnZhciBFeHBpcmVBdENvbW1hbmQgPSBjbGFzcyBleHRlbmRzIENvbW1hbmQge1xuICBjb25zdHJ1Y3RvcihjbWQsIG9wdHMpIHtcbiAgICBzdXBlcihbXCJleHBpcmVhdFwiLCAuLi5jbWRdLCBvcHRzKTtcbiAgfVxufTtcblxuLy8gcGtnL2NvbW1hbmRzL2ZsdXNoYWxsLnRzXG52YXIgRmx1c2hBbGxDb21tYW5kID0gY2xhc3MgZXh0ZW5kcyBDb21tYW5kIHtcbiAgY29uc3RydWN0b3IoYXJncywgb3B0cykge1xuICAgIGNvbnN0IGNvbW1hbmQgPSBbXCJmbHVzaGFsbFwiXTtcbiAgICBpZiAoYXJncyAmJiBhcmdzLmxlbmd0aCA+IDAgJiYgYXJnc1swXS5hc3luYykge1xuICAgICAgY29tbWFuZC5wdXNoKFwiYXN5bmNcIik7XG4gICAgfVxuICAgIHN1cGVyKGNvbW1hbmQsIG9wdHMpO1xuICB9XG59O1xuXG4vLyBwa2cvY29tbWFuZHMvZmx1c2hkYi50c1xudmFyIEZsdXNoREJDb21tYW5kID0gY2xhc3MgZXh0ZW5kcyBDb21tYW5kIHtcbiAgY29uc3RydWN0b3IoW29wdHNdLCBjbWRPcHRzKSB7XG4gICAgY29uc3QgY29tbWFuZCA9IFtcImZsdXNoZGJcIl07XG4gICAgaWYgKG9wdHM/LmFzeW5jKSB7XG4gICAgICBjb21tYW5kLnB1c2goXCJhc3luY1wiKTtcbiAgICB9XG4gICAgc3VwZXIoY29tbWFuZCwgY21kT3B0cyk7XG4gIH1cbn07XG5cbi8vIHBrZy9jb21tYW5kcy9nZW9fYWRkLnRzXG52YXIgR2VvQWRkQ29tbWFuZCA9IGNsYXNzIGV4dGVuZHMgQ29tbWFuZCB7XG4gIGNvbnN0cnVjdG9yKFtrZXksIGFyZzEsIC4uLmFyZzJdLCBvcHRzKSB7XG4gICAgY29uc3QgY29tbWFuZCA9IFtcImdlb2FkZFwiLCBrZXldO1xuICAgIGlmIChcIm54XCIgaW4gYXJnMSAmJiBhcmcxLm54KSB7XG4gICAgICBjb21tYW5kLnB1c2goXCJueFwiKTtcbiAgICB9IGVsc2UgaWYgKFwieHhcIiBpbiBhcmcxICYmIGFyZzEueHgpIHtcbiAgICAgIGNvbW1hbmQucHVzaChcInh4XCIpO1xuICAgIH1cbiAgICBpZiAoXCJjaFwiIGluIGFyZzEgJiYgYXJnMS5jaCkge1xuICAgICAgY29tbWFuZC5wdXNoKFwiY2hcIik7XG4gICAgfVxuICAgIGlmIChcImxhdGl0dWRlXCIgaW4gYXJnMSAmJiBhcmcxLmxhdGl0dWRlKSB7XG4gICAgICBjb21tYW5kLnB1c2goYXJnMS5sb25naXR1ZGUsIGFyZzEubGF0aXR1ZGUsIGFyZzEubWVtYmVyKTtcbiAgICB9XG4gICAgY29tbWFuZC5wdXNoKFxuICAgICAgLi4uYXJnMi5mbGF0TWFwKCh7IGxhdGl0dWRlLCBsb25naXR1ZGUsIG1lbWJlciB9KSA9PiBbbG9uZ2l0dWRlLCBsYXRpdHVkZSwgbWVtYmVyXSlcbiAgICApO1xuICAgIHN1cGVyKGNvbW1hbmQsIG9wdHMpO1xuICB9XG59O1xuXG4vLyBwa2cvY29tbWFuZHMvZ2VvX2Rpc3QudHNcbnZhciBHZW9EaXN0Q29tbWFuZCA9IGNsYXNzIGV4dGVuZHMgQ29tbWFuZCB7XG4gIGNvbnN0cnVjdG9yKFtrZXksIG1lbWJlcjEsIG1lbWJlcjIsIHVuaXQgPSBcIk1cIl0sIG9wdHMpIHtcbiAgICBzdXBlcihbXCJHRU9ESVNUXCIsIGtleSwgbWVtYmVyMSwgbWVtYmVyMiwgdW5pdF0sIG9wdHMpO1xuICB9XG59O1xuXG4vLyBwa2cvY29tbWFuZHMvZ2VvX2hhc2gudHNcbnZhciBHZW9IYXNoQ29tbWFuZCA9IGNsYXNzIGV4dGVuZHMgQ29tbWFuZCB7XG4gIGNvbnN0cnVjdG9yKGNtZCwgb3B0cykge1xuICAgIGNvbnN0IFtrZXldID0gY21kO1xuICAgIGNvbnN0IG1lbWJlcnMgPSBBcnJheS5pc0FycmF5KGNtZFsxXSkgPyBjbWRbMV0gOiBjbWQuc2xpY2UoMSk7XG4gICAgc3VwZXIoW1wiR0VPSEFTSFwiLCBrZXksIC4uLm1lbWJlcnNdLCBvcHRzKTtcbiAgfVxufTtcblxuLy8gcGtnL2NvbW1hbmRzL2dlb19wb3MudHNcbnZhciBHZW9Qb3NDb21tYW5kID0gY2xhc3MgZXh0ZW5kcyBDb21tYW5kIHtcbiAgY29uc3RydWN0b3IoY21kLCBvcHRzKSB7XG4gICAgY29uc3QgW2tleV0gPSBjbWQ7XG4gICAgY29uc3QgbWVtYmVycyA9IEFycmF5LmlzQXJyYXkoY21kWzFdKSA/IGNtZFsxXSA6IGNtZC5zbGljZSgxKTtcbiAgICBzdXBlcihbXCJHRU9QT1NcIiwga2V5LCAuLi5tZW1iZXJzXSwge1xuICAgICAgZGVzZXJpYWxpemU6IChyZXN1bHQpID0+IHRyYW5zZm9ybShyZXN1bHQpLFxuICAgICAgLi4ub3B0c1xuICAgIH0pO1xuICB9XG59O1xuZnVuY3Rpb24gdHJhbnNmb3JtKHJlc3VsdCkge1xuICBjb25zdCBmaW5hbCA9IFtdO1xuICBmb3IgKGNvbnN0IHBvcyBvZiByZXN1bHQpIHtcbiAgICBpZiAoIXBvcz8uWzBdIHx8ICFwb3M/LlsxXSkge1xuICAgICAgY29udGludWU7XG4gICAgfVxuICAgIGZpbmFsLnB1c2goeyBsbmc6IE51bWJlci5wYXJzZUZsb2F0KHBvc1swXSksIGxhdDogTnVtYmVyLnBhcnNlRmxvYXQocG9zWzFdKSB9KTtcbiAgfVxuICByZXR1cm4gZmluYWw7XG59XG5cbi8vIHBrZy9jb21tYW5kcy9nZW9fc2VhcmNoLnRzXG52YXIgR2VvU2VhcmNoQ29tbWFuZCA9IGNsYXNzIGV4dGVuZHMgQ29tbWFuZCB7XG4gIGNvbnN0cnVjdG9yKFtrZXksIGNlbnRlclBvaW50LCBzaGFwZSwgb3JkZXIsIG9wdHNdLCBjb21tYW5kT3B0aW9ucykge1xuICAgIGNvbnN0IGNvbW1hbmQgPSBbXCJHRU9TRUFSQ0hcIiwga2V5XTtcbiAgICBpZiAoY2VudGVyUG9pbnQudHlwZSA9PT0gXCJGUk9NTUVNQkVSXCIgfHwgY2VudGVyUG9pbnQudHlwZSA9PT0gXCJmcm9tbWVtYmVyXCIpIHtcbiAgICAgIGNvbW1hbmQucHVzaChjZW50ZXJQb2ludC50eXBlLCBjZW50ZXJQb2ludC5tZW1iZXIpO1xuICAgIH1cbiAgICBpZiAoY2VudGVyUG9pbnQudHlwZSA9PT0gXCJGUk9NTE9OTEFUXCIgfHwgY2VudGVyUG9pbnQudHlwZSA9PT0gXCJmcm9tbG9ubGF0XCIpIHtcbiAgICAgIGNvbW1hbmQucHVzaChjZW50ZXJQb2ludC50eXBlLCBjZW50ZXJQb2ludC5jb29yZGluYXRlLmxvbiwgY2VudGVyUG9pbnQuY29vcmRpbmF0ZS5sYXQpO1xuICAgIH1cbiAgICBpZiAoc2hhcGUudHlwZSA9PT0gXCJCWVJBRElVU1wiIHx8IHNoYXBlLnR5cGUgPT09IFwiYnlyYWRpdXNcIikge1xuICAgICAgY29tbWFuZC5wdXNoKHNoYXBlLnR5cGUsIHNoYXBlLnJhZGl1cywgc2hhcGUucmFkaXVzVHlwZSk7XG4gICAgfVxuICAgIGlmIChzaGFwZS50eXBlID09PSBcIkJZQk9YXCIgfHwgc2hhcGUudHlwZSA9PT0gXCJieWJveFwiKSB7XG4gICAgICBjb21tYW5kLnB1c2goc2hhcGUudHlwZSwgc2hhcGUucmVjdC53aWR0aCwgc2hhcGUucmVjdC5oZWlnaHQsIHNoYXBlLnJlY3RUeXBlKTtcbiAgICB9XG4gICAgY29tbWFuZC5wdXNoKG9yZGVyKTtcbiAgICBpZiAob3B0cz8uY291bnQpIHtcbiAgICAgIGNvbW1hbmQucHVzaChcIkNPVU5UXCIsIG9wdHMuY291bnQubGltaXQsIC4uLm9wdHMuY291bnQuYW55ID8gW1wiQU5ZXCJdIDogW10pO1xuICAgIH1cbiAgICBjb25zdCB0cmFuc2Zvcm0yID0gKHJlc3VsdCkgPT4ge1xuICAgICAgaWYgKCFvcHRzPy53aXRoQ29vcmQgJiYgIW9wdHM/LndpdGhEaXN0ICYmICFvcHRzPy53aXRoSGFzaCkge1xuICAgICAgICByZXR1cm4gcmVzdWx0Lm1hcCgobWVtYmVyKSA9PiB7XG4gICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIHJldHVybiB7IG1lbWJlcjogSlNPTi5wYXJzZShtZW1iZXIpIH07XG4gICAgICAgICAgfSBjYXRjaCB7XG4gICAgICAgICAgICByZXR1cm4geyBtZW1iZXIgfTtcbiAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgICAgfVxuICAgICAgcmV0dXJuIHJlc3VsdC5tYXAoKG1lbWJlcnMpID0+IHtcbiAgICAgICAgbGV0IGNvdW50ZXIgPSAxO1xuICAgICAgICBjb25zdCBvYmogPSB7fTtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICBvYmoubWVtYmVyID0gSlNPTi5wYXJzZShtZW1iZXJzWzBdKTtcbiAgICAgICAgfSBjYXRjaCB7XG4gICAgICAgICAgb2JqLm1lbWJlciA9IG1lbWJlcnNbMF07XG4gICAgICAgIH1cbiAgICAgICAgaWYgKG9wdHMud2l0aERpc3QpIHtcbiAgICAgICAgICBvYmouZGlzdCA9IE51bWJlci5wYXJzZUZsb2F0KG1lbWJlcnNbY291bnRlcisrXSk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKG9wdHMud2l0aEhhc2gpIHtcbiAgICAgICAgICBvYmouaGFzaCA9IG1lbWJlcnNbY291bnRlcisrXS50b1N0cmluZygpO1xuICAgICAgICB9XG4gICAgICAgIGlmIChvcHRzLndpdGhDb29yZCkge1xuICAgICAgICAgIG9iai5jb29yZCA9IHtcbiAgICAgICAgICAgIGxvbmc6IE51bWJlci5wYXJzZUZsb2F0KG1lbWJlcnNbY291bnRlcl1bMF0pLFxuICAgICAgICAgICAgbGF0OiBOdW1iZXIucGFyc2VGbG9hdChtZW1iZXJzW2NvdW50ZXJdWzFdKVxuICAgICAgICAgIH07XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIG9iajtcbiAgICAgIH0pO1xuICAgIH07XG4gICAgc3VwZXIoXG4gICAgICBbXG4gICAgICAgIC4uLmNvbW1hbmQsXG4gICAgICAgIC4uLm9wdHM/LndpdGhDb29yZCA/IFtcIldJVEhDT09SRFwiXSA6IFtdLFxuICAgICAgICAuLi5vcHRzPy53aXRoRGlzdCA/IFtcIldJVEhESVNUXCJdIDogW10sXG4gICAgICAgIC4uLm9wdHM/LndpdGhIYXNoID8gW1wiV0lUSEhBU0hcIl0gOiBbXVxuICAgICAgXSxcbiAgICAgIHtcbiAgICAgICAgZGVzZXJpYWxpemU6IHRyYW5zZm9ybTIsXG4gICAgICAgIC4uLmNvbW1hbmRPcHRpb25zXG4gICAgICB9XG4gICAgKTtcbiAgfVxufTtcblxuLy8gcGtnL2NvbW1hbmRzL2dlb19zZWFyY2hfc3RvcmUudHNcbnZhciBHZW9TZWFyY2hTdG9yZUNvbW1hbmQgPSBjbGFzcyBleHRlbmRzIENvbW1hbmQge1xuICBjb25zdHJ1Y3RvcihbZGVzdGluYXRpb24sIGtleSwgY2VudGVyUG9pbnQsIHNoYXBlLCBvcmRlciwgb3B0c10sIGNvbW1hbmRPcHRpb25zKSB7XG4gICAgY29uc3QgY29tbWFuZCA9IFtcIkdFT1NFQVJDSFNUT1JFXCIsIGRlc3RpbmF0aW9uLCBrZXldO1xuICAgIGlmIChjZW50ZXJQb2ludC50eXBlID09PSBcIkZST01NRU1CRVJcIiB8fCBjZW50ZXJQb2ludC50eXBlID09PSBcImZyb21tZW1iZXJcIikge1xuICAgICAgY29tbWFuZC5wdXNoKGNlbnRlclBvaW50LnR5cGUsIGNlbnRlclBvaW50Lm1lbWJlcik7XG4gICAgfVxuICAgIGlmIChjZW50ZXJQb2ludC50eXBlID09PSBcIkZST01MT05MQVRcIiB8fCBjZW50ZXJQb2ludC50eXBlID09PSBcImZyb21sb25sYXRcIikge1xuICAgICAgY29tbWFuZC5wdXNoKGNlbnRlclBvaW50LnR5cGUsIGNlbnRlclBvaW50LmNvb3JkaW5hdGUubG9uLCBjZW50ZXJQb2ludC5jb29yZGluYXRlLmxhdCk7XG4gICAgfVxuICAgIGlmIChzaGFwZS50eXBlID09PSBcIkJZUkFESVVTXCIgfHwgc2hhcGUudHlwZSA9PT0gXCJieXJhZGl1c1wiKSB7XG4gICAgICBjb21tYW5kLnB1c2goc2hhcGUudHlwZSwgc2hhcGUucmFkaXVzLCBzaGFwZS5yYWRpdXNUeXBlKTtcbiAgICB9XG4gICAgaWYgKHNoYXBlLnR5cGUgPT09IFwiQllCT1hcIiB8fCBzaGFwZS50eXBlID09PSBcImJ5Ym94XCIpIHtcbiAgICAgIGNvbW1hbmQucHVzaChzaGFwZS50eXBlLCBzaGFwZS5yZWN0LndpZHRoLCBzaGFwZS5yZWN0LmhlaWdodCwgc2hhcGUucmVjdFR5cGUpO1xuICAgIH1cbiAgICBjb21tYW5kLnB1c2gob3JkZXIpO1xuICAgIGlmIChvcHRzPy5jb3VudCkge1xuICAgICAgY29tbWFuZC5wdXNoKFwiQ09VTlRcIiwgb3B0cy5jb3VudC5saW1pdCwgLi4ub3B0cy5jb3VudC5hbnkgPyBbXCJBTllcIl0gOiBbXSk7XG4gICAgfVxuICAgIHN1cGVyKFsuLi5jb21tYW5kLCAuLi5vcHRzPy5zdG9yZURpc3QgPyBbXCJTVE9SRURJU1RcIl0gOiBbXV0sIGNvbW1hbmRPcHRpb25zKTtcbiAgfVxufTtcblxuLy8gcGtnL2NvbW1hbmRzL2dldC50c1xudmFyIEdldENvbW1hbmQgPSBjbGFzcyBleHRlbmRzIENvbW1hbmQge1xuICBjb25zdHJ1Y3RvcihjbWQsIG9wdHMpIHtcbiAgICBzdXBlcihbXCJnZXRcIiwgLi4uY21kXSwgb3B0cyk7XG4gIH1cbn07XG5cbi8vIHBrZy9jb21tYW5kcy9nZXRiaXQudHNcbnZhciBHZXRCaXRDb21tYW5kID0gY2xhc3MgZXh0ZW5kcyBDb21tYW5kIHtcbiAgY29uc3RydWN0b3IoY21kLCBvcHRzKSB7XG4gICAgc3VwZXIoW1wiZ2V0Yml0XCIsIC4uLmNtZF0sIG9wdHMpO1xuICB9XG59O1xuXG4vLyBwa2cvY29tbWFuZHMvZ2V0ZGVsLnRzXG52YXIgR2V0RGVsQ29tbWFuZCA9IGNsYXNzIGV4dGVuZHMgQ29tbWFuZCB7XG4gIGNvbnN0cnVjdG9yKGNtZCwgb3B0cykge1xuICAgIHN1cGVyKFtcImdldGRlbFwiLCAuLi5jbWRdLCBvcHRzKTtcbiAgfVxufTtcblxuLy8gcGtnL2NvbW1hbmRzL2dldGV4LnRzXG52YXIgR2V0RXhDb21tYW5kID0gY2xhc3MgZXh0ZW5kcyBDb21tYW5kIHtcbiAgY29uc3RydWN0b3IoW2tleSwgb3B0c10sIGNtZE9wdHMpIHtcbiAgICBjb25zdCBjb21tYW5kID0gW1wiZ2V0ZXhcIiwga2V5XTtcbiAgICBpZiAob3B0cykge1xuICAgICAgaWYgKFwiZXhcIiBpbiBvcHRzICYmIHR5cGVvZiBvcHRzLmV4ID09PSBcIm51bWJlclwiKSB7XG4gICAgICAgIGNvbW1hbmQucHVzaChcImV4XCIsIG9wdHMuZXgpO1xuICAgICAgfSBlbHNlIGlmIChcInB4XCIgaW4gb3B0cyAmJiB0eXBlb2Ygb3B0cy5weCA9PT0gXCJudW1iZXJcIikge1xuICAgICAgICBjb21tYW5kLnB1c2goXCJweFwiLCBvcHRzLnB4KTtcbiAgICAgIH0gZWxzZSBpZiAoXCJleGF0XCIgaW4gb3B0cyAmJiB0eXBlb2Ygb3B0cy5leGF0ID09PSBcIm51bWJlclwiKSB7XG4gICAgICAgIGNvbW1hbmQucHVzaChcImV4YXRcIiwgb3B0cy5leGF0KTtcbiAgICAgIH0gZWxzZSBpZiAoXCJweGF0XCIgaW4gb3B0cyAmJiB0eXBlb2Ygb3B0cy5weGF0ID09PSBcIm51bWJlclwiKSB7XG4gICAgICAgIGNvbW1hbmQucHVzaChcInB4YXRcIiwgb3B0cy5weGF0KTtcbiAgICAgIH0gZWxzZSBpZiAoXCJwZXJzaXN0XCIgaW4gb3B0cyAmJiBvcHRzLnBlcnNpc3QpIHtcbiAgICAgICAgY29tbWFuZC5wdXNoKFwicGVyc2lzdFwiKTtcbiAgICAgIH1cbiAgICB9XG4gICAgc3VwZXIoY29tbWFuZCwgY21kT3B0cyk7XG4gIH1cbn07XG5cbi8vIHBrZy9jb21tYW5kcy9nZXRyYW5nZS50c1xudmFyIEdldFJhbmdlQ29tbWFuZCA9IGNsYXNzIGV4dGVuZHMgQ29tbWFuZCB7XG4gIGNvbnN0cnVjdG9yKGNtZCwgb3B0cykge1xuICAgIHN1cGVyKFtcImdldHJhbmdlXCIsIC4uLmNtZF0sIG9wdHMpO1xuICB9XG59O1xuXG4vLyBwa2cvY29tbWFuZHMvZ2V0c2V0LnRzXG52YXIgR2V0U2V0Q29tbWFuZCA9IGNsYXNzIGV4dGVuZHMgQ29tbWFuZCB7XG4gIGNvbnN0cnVjdG9yKGNtZCwgb3B0cykge1xuICAgIHN1cGVyKFtcImdldHNldFwiLCAuLi5jbWRdLCBvcHRzKTtcbiAgfVxufTtcblxuLy8gcGtnL2NvbW1hbmRzL2hkZWwudHNcbnZhciBIRGVsQ29tbWFuZCA9IGNsYXNzIGV4dGVuZHMgQ29tbWFuZCB7XG4gIGNvbnN0cnVjdG9yKGNtZCwgb3B0cykge1xuICAgIHN1cGVyKFtcImhkZWxcIiwgLi4uY21kXSwgb3B0cyk7XG4gIH1cbn07XG5cbi8vIHBrZy9jb21tYW5kcy9oZXhpc3RzLnRzXG52YXIgSEV4aXN0c0NvbW1hbmQgPSBjbGFzcyBleHRlbmRzIENvbW1hbmQge1xuICBjb25zdHJ1Y3RvcihjbWQsIG9wdHMpIHtcbiAgICBzdXBlcihbXCJoZXhpc3RzXCIsIC4uLmNtZF0sIG9wdHMpO1xuICB9XG59O1xuXG4vLyBwa2cvY29tbWFuZHMvaGV4cGlyZS50c1xudmFyIEhFeHBpcmVDb21tYW5kID0gY2xhc3MgZXh0ZW5kcyBDb21tYW5kIHtcbiAgY29uc3RydWN0b3IoY21kLCBvcHRzKSB7XG4gICAgY29uc3QgW2tleSwgZmllbGRzLCBzZWNvbmRzLCBvcHRpb25dID0gY21kO1xuICAgIGNvbnN0IGZpZWxkQXJyYXkgPSBBcnJheS5pc0FycmF5KGZpZWxkcykgPyBmaWVsZHMgOiBbZmllbGRzXTtcbiAgICBzdXBlcihcbiAgICAgIFtcbiAgICAgICAgXCJoZXhwaXJlXCIsXG4gICAgICAgIGtleSxcbiAgICAgICAgc2Vjb25kcyxcbiAgICAgICAgLi4ub3B0aW9uID8gW29wdGlvbl0gOiBbXSxcbiAgICAgICAgXCJGSUVMRFNcIixcbiAgICAgICAgZmllbGRBcnJheS5sZW5ndGgsXG4gICAgICAgIC4uLmZpZWxkQXJyYXlcbiAgICAgIF0sXG4gICAgICBvcHRzXG4gICAgKTtcbiAgfVxufTtcblxuLy8gcGtnL2NvbW1hbmRzL2hleHBpcmVhdC50c1xudmFyIEhFeHBpcmVBdENvbW1hbmQgPSBjbGFzcyBleHRlbmRzIENvbW1hbmQge1xuICBjb25zdHJ1Y3RvcihjbWQsIG9wdHMpIHtcbiAgICBjb25zdCBba2V5LCBmaWVsZHMsIHRpbWVzdGFtcCwgb3B0aW9uXSA9IGNtZDtcbiAgICBjb25zdCBmaWVsZEFycmF5ID0gQXJyYXkuaXNBcnJheShmaWVsZHMpID8gZmllbGRzIDogW2ZpZWxkc107XG4gICAgc3VwZXIoXG4gICAgICBbXG4gICAgICAgIFwiaGV4cGlyZWF0XCIsXG4gICAgICAgIGtleSxcbiAgICAgICAgdGltZXN0YW1wLFxuICAgICAgICAuLi5vcHRpb24gPyBbb3B0aW9uXSA6IFtdLFxuICAgICAgICBcIkZJRUxEU1wiLFxuICAgICAgICBmaWVsZEFycmF5Lmxlbmd0aCxcbiAgICAgICAgLi4uZmllbGRBcnJheVxuICAgICAgXSxcbiAgICAgIG9wdHNcbiAgICApO1xuICB9XG59O1xuXG4vLyBwa2cvY29tbWFuZHMvaGV4cGlyZXRpbWUudHNcbnZhciBIRXhwaXJlVGltZUNvbW1hbmQgPSBjbGFzcyBleHRlbmRzIENvbW1hbmQge1xuICBjb25zdHJ1Y3RvcihjbWQsIG9wdHMpIHtcbiAgICBjb25zdCBba2V5LCBmaWVsZHNdID0gY21kO1xuICAgIGNvbnN0IGZpZWxkQXJyYXkgPSBBcnJheS5pc0FycmF5KGZpZWxkcykgPyBmaWVsZHMgOiBbZmllbGRzXTtcbiAgICBzdXBlcihbXCJoZXhwaXJldGltZVwiLCBrZXksIFwiRklFTERTXCIsIGZpZWxkQXJyYXkubGVuZ3RoLCAuLi5maWVsZEFycmF5XSwgb3B0cyk7XG4gIH1cbn07XG5cbi8vIHBrZy9jb21tYW5kcy9ocGVyc2lzdC50c1xudmFyIEhQZXJzaXN0Q29tbWFuZCA9IGNsYXNzIGV4dGVuZHMgQ29tbWFuZCB7XG4gIGNvbnN0cnVjdG9yKGNtZCwgb3B0cykge1xuICAgIGNvbnN0IFtrZXksIGZpZWxkc10gPSBjbWQ7XG4gICAgY29uc3QgZmllbGRBcnJheSA9IEFycmF5LmlzQXJyYXkoZmllbGRzKSA/IGZpZWxkcyA6IFtmaWVsZHNdO1xuICAgIHN1cGVyKFtcImhwZXJzaXN0XCIsIGtleSwgXCJGSUVMRFNcIiwgZmllbGRBcnJheS5sZW5ndGgsIC4uLmZpZWxkQXJyYXldLCBvcHRzKTtcbiAgfVxufTtcblxuLy8gcGtnL2NvbW1hbmRzL2hwZXhwaXJlLnRzXG52YXIgSFBFeHBpcmVDb21tYW5kID0gY2xhc3MgZXh0ZW5kcyBDb21tYW5kIHtcbiAgY29uc3RydWN0b3IoY21kLCBvcHRzKSB7XG4gICAgY29uc3QgW2tleSwgZmllbGRzLCBtaWxsaXNlY29uZHMsIG9wdGlvbl0gPSBjbWQ7XG4gICAgY29uc3QgZmllbGRBcnJheSA9IEFycmF5LmlzQXJyYXkoZmllbGRzKSA/IGZpZWxkcyA6IFtmaWVsZHNdO1xuICAgIHN1cGVyKFxuICAgICAgW1xuICAgICAgICBcImhwZXhwaXJlXCIsXG4gICAgICAgIGtleSxcbiAgICAgICAgbWlsbGlzZWNvbmRzLFxuICAgICAgICAuLi5vcHRpb24gPyBbb3B0aW9uXSA6IFtdLFxuICAgICAgICBcIkZJRUxEU1wiLFxuICAgICAgICBmaWVsZEFycmF5Lmxlbmd0aCxcbiAgICAgICAgLi4uZmllbGRBcnJheVxuICAgICAgXSxcbiAgICAgIG9wdHNcbiAgICApO1xuICB9XG59O1xuXG4vLyBwa2cvY29tbWFuZHMvaHBleHBpcmVhdC50c1xudmFyIEhQRXhwaXJlQXRDb21tYW5kID0gY2xhc3MgZXh0ZW5kcyBDb21tYW5kIHtcbiAgY29uc3RydWN0b3IoY21kLCBvcHRzKSB7XG4gICAgY29uc3QgW2tleSwgZmllbGRzLCB0aW1lc3RhbXAsIG9wdGlvbl0gPSBjbWQ7XG4gICAgY29uc3QgZmllbGRBcnJheSA9IEFycmF5LmlzQXJyYXkoZmllbGRzKSA/IGZpZWxkcyA6IFtmaWVsZHNdO1xuICAgIHN1cGVyKFxuICAgICAgW1xuICAgICAgICBcImhwZXhwaXJlYXRcIixcbiAgICAgICAga2V5LFxuICAgICAgICB0aW1lc3RhbXAsXG4gICAgICAgIC4uLm9wdGlvbiA/IFtvcHRpb25dIDogW10sXG4gICAgICAgIFwiRklFTERTXCIsXG4gICAgICAgIGZpZWxkQXJyYXkubGVuZ3RoLFxuICAgICAgICAuLi5maWVsZEFycmF5XG4gICAgICBdLFxuICAgICAgb3B0c1xuICAgICk7XG4gIH1cbn07XG5cbi8vIHBrZy9jb21tYW5kcy9ocGV4cGlyZXRpbWUudHNcbnZhciBIUEV4cGlyZVRpbWVDb21tYW5kID0gY2xhc3MgZXh0ZW5kcyBDb21tYW5kIHtcbiAgY29uc3RydWN0b3IoY21kLCBvcHRzKSB7XG4gICAgY29uc3QgW2tleSwgZmllbGRzXSA9IGNtZDtcbiAgICBjb25zdCBmaWVsZEFycmF5ID0gQXJyYXkuaXNBcnJheShmaWVsZHMpID8gZmllbGRzIDogW2ZpZWxkc107XG4gICAgc3VwZXIoW1wiaHBleHBpcmV0aW1lXCIsIGtleSwgXCJGSUVMRFNcIiwgZmllbGRBcnJheS5sZW5ndGgsIC4uLmZpZWxkQXJyYXldLCBvcHRzKTtcbiAgfVxufTtcblxuLy8gcGtnL2NvbW1hbmRzL2hwdHRsLnRzXG52YXIgSFBUdGxDb21tYW5kID0gY2xhc3MgZXh0ZW5kcyBDb21tYW5kIHtcbiAgY29uc3RydWN0b3IoY21kLCBvcHRzKSB7XG4gICAgY29uc3QgW2tleSwgZmllbGRzXSA9IGNtZDtcbiAgICBjb25zdCBmaWVsZEFycmF5ID0gQXJyYXkuaXNBcnJheShmaWVsZHMpID8gZmllbGRzIDogW2ZpZWxkc107XG4gICAgc3VwZXIoW1wiaHB0dGxcIiwga2V5LCBcIkZJRUxEU1wiLCBmaWVsZEFycmF5Lmxlbmd0aCwgLi4uZmllbGRBcnJheV0sIG9wdHMpO1xuICB9XG59O1xuXG4vLyBwa2cvY29tbWFuZHMvaGdldC50c1xudmFyIEhHZXRDb21tYW5kID0gY2xhc3MgZXh0ZW5kcyBDb21tYW5kIHtcbiAgY29uc3RydWN0b3IoY21kLCBvcHRzKSB7XG4gICAgc3VwZXIoW1wiaGdldFwiLCAuLi5jbWRdLCBvcHRzKTtcbiAgfVxufTtcblxuLy8gcGtnL2NvbW1hbmRzL2hnZXRhbGwudHNcbmZ1bmN0aW9uIGRlc2VyaWFsaXplMihyZXN1bHQpIHtcbiAgaWYgKHJlc3VsdC5sZW5ndGggPT09IDApIHtcbiAgICByZXR1cm4gbnVsbDtcbiAgfVxuICBjb25zdCBvYmogPSB7fTtcbiAgZm9yIChsZXQgaSA9IDA7IGkgPCByZXN1bHQubGVuZ3RoOyBpICs9IDIpIHtcbiAgICBjb25zdCBrZXkgPSByZXN1bHRbaV07XG4gICAgY29uc3QgdmFsdWUgPSByZXN1bHRbaSArIDFdO1xuICAgIHRyeSB7XG4gICAgICBjb25zdCB2YWx1ZUlzTnVtYmVyQW5kTm90U2FmZUludGVnZXIgPSAhTnVtYmVyLmlzTmFOKE51bWJlcih2YWx1ZSkpICYmICFOdW1iZXIuaXNTYWZlSW50ZWdlcihOdW1iZXIodmFsdWUpKTtcbiAgICAgIG9ialtrZXldID0gdmFsdWVJc051bWJlckFuZE5vdFNhZmVJbnRlZ2VyID8gdmFsdWUgOiBKU09OLnBhcnNlKHZhbHVlKTtcbiAgICB9IGNhdGNoIHtcbiAgICAgIG9ialtrZXldID0gdmFsdWU7XG4gICAgfVxuICB9XG4gIHJldHVybiBvYmo7XG59XG52YXIgSEdldEFsbENvbW1hbmQgPSBjbGFzcyBleHRlbmRzIENvbW1hbmQge1xuICBjb25zdHJ1Y3RvcihjbWQsIG9wdHMpIHtcbiAgICBzdXBlcihbXCJoZ2V0YWxsXCIsIC4uLmNtZF0sIHtcbiAgICAgIGRlc2VyaWFsaXplOiAocmVzdWx0KSA9PiBkZXNlcmlhbGl6ZTIocmVzdWx0KSxcbiAgICAgIC4uLm9wdHNcbiAgICB9KTtcbiAgfVxufTtcblxuLy8gcGtnL2NvbW1hbmRzL2hpbmNyYnkudHNcbnZhciBISW5jckJ5Q29tbWFuZCA9IGNsYXNzIGV4dGVuZHMgQ29tbWFuZCB7XG4gIGNvbnN0cnVjdG9yKGNtZCwgb3B0cykge1xuICAgIHN1cGVyKFtcImhpbmNyYnlcIiwgLi4uY21kXSwgb3B0cyk7XG4gIH1cbn07XG5cbi8vIHBrZy9jb21tYW5kcy9oaW5jcmJ5ZmxvYXQudHNcbnZhciBISW5jckJ5RmxvYXRDb21tYW5kID0gY2xhc3MgZXh0ZW5kcyBDb21tYW5kIHtcbiAgY29uc3RydWN0b3IoY21kLCBvcHRzKSB7XG4gICAgc3VwZXIoW1wiaGluY3JieWZsb2F0XCIsIC4uLmNtZF0sIG9wdHMpO1xuICB9XG59O1xuXG4vLyBwa2cvY29tbWFuZHMvaGtleXMudHNcbnZhciBIS2V5c0NvbW1hbmQgPSBjbGFzcyBleHRlbmRzIENvbW1hbmQge1xuICBjb25zdHJ1Y3Rvcihba2V5XSwgb3B0cykge1xuICAgIHN1cGVyKFtcImhrZXlzXCIsIGtleV0sIG9wdHMpO1xuICB9XG59O1xuXG4vLyBwa2cvY29tbWFuZHMvaGxlbi50c1xudmFyIEhMZW5Db21tYW5kID0gY2xhc3MgZXh0ZW5kcyBDb21tYW5kIHtcbiAgY29uc3RydWN0b3IoY21kLCBvcHRzKSB7XG4gICAgc3VwZXIoW1wiaGxlblwiLCAuLi5jbWRdLCBvcHRzKTtcbiAgfVxufTtcblxuLy8gcGtnL2NvbW1hbmRzL2htZ2V0LnRzXG5mdW5jdGlvbiBkZXNlcmlhbGl6ZTMoZmllbGRzLCByZXN1bHQpIHtcbiAgaWYgKHJlc3VsdC5ldmVyeSgoZmllbGQpID0+IGZpZWxkID09PSBudWxsKSkge1xuICAgIHJldHVybiBudWxsO1xuICB9XG4gIGNvbnN0IG9iaiA9IHt9O1xuICBmb3IgKGNvbnN0IFtpLCBmaWVsZF0gb2YgZmllbGRzLmVudHJpZXMoKSkge1xuICAgIHRyeSB7XG4gICAgICBvYmpbZmllbGRdID0gSlNPTi5wYXJzZShyZXN1bHRbaV0pO1xuICAgIH0gY2F0Y2gge1xuICAgICAgb2JqW2ZpZWxkXSA9IHJlc3VsdFtpXTtcbiAgICB9XG4gIH1cbiAgcmV0dXJuIG9iajtcbn1cbnZhciBITUdldENvbW1hbmQgPSBjbGFzcyBleHRlbmRzIENvbW1hbmQge1xuICBjb25zdHJ1Y3Rvcihba2V5LCAuLi5maWVsZHNdLCBvcHRzKSB7XG4gICAgc3VwZXIoW1wiaG1nZXRcIiwga2V5LCAuLi5maWVsZHNdLCB7XG4gICAgICBkZXNlcmlhbGl6ZTogKHJlc3VsdCkgPT4gZGVzZXJpYWxpemUzKGZpZWxkcywgcmVzdWx0KSxcbiAgICAgIC4uLm9wdHNcbiAgICB9KTtcbiAgfVxufTtcblxuLy8gcGtnL2NvbW1hbmRzL2htc2V0LnRzXG52YXIgSE1TZXRDb21tYW5kID0gY2xhc3MgZXh0ZW5kcyBDb21tYW5kIHtcbiAgY29uc3RydWN0b3IoW2tleSwga3ZdLCBvcHRzKSB7XG4gICAgc3VwZXIoW1wiaG1zZXRcIiwga2V5LCAuLi5PYmplY3QuZW50cmllcyhrdikuZmxhdE1hcCgoW2ZpZWxkLCB2YWx1ZV0pID0+IFtmaWVsZCwgdmFsdWVdKV0sIG9wdHMpO1xuICB9XG59O1xuXG4vLyBwa2cvY29tbWFuZHMvaHNjYW4udHNcbnZhciBIU2NhbkNvbW1hbmQgPSBjbGFzcyBleHRlbmRzIENvbW1hbmQge1xuICBjb25zdHJ1Y3Rvcihba2V5LCBjdXJzb3IsIGNtZE9wdHNdLCBvcHRzKSB7XG4gICAgY29uc3QgY29tbWFuZCA9IFtcImhzY2FuXCIsIGtleSwgY3Vyc29yXTtcbiAgICBpZiAoY21kT3B0cz8ubWF0Y2gpIHtcbiAgICAgIGNvbW1hbmQucHVzaChcIm1hdGNoXCIsIGNtZE9wdHMubWF0Y2gpO1xuICAgIH1cbiAgICBpZiAodHlwZW9mIGNtZE9wdHM/LmNvdW50ID09PSBcIm51bWJlclwiKSB7XG4gICAgICBjb21tYW5kLnB1c2goXCJjb3VudFwiLCBjbWRPcHRzLmNvdW50KTtcbiAgICB9XG4gICAgc3VwZXIoY29tbWFuZCwge1xuICAgICAgZGVzZXJpYWxpemU6IGRlc2VyaWFsaXplU2NhblJlc3BvbnNlLFxuICAgICAgLi4ub3B0c1xuICAgIH0pO1xuICB9XG59O1xuXG4vLyBwa2cvY29tbWFuZHMvaHNldC50c1xudmFyIEhTZXRDb21tYW5kID0gY2xhc3MgZXh0ZW5kcyBDb21tYW5kIHtcbiAgY29uc3RydWN0b3IoW2tleSwga3ZdLCBvcHRzKSB7XG4gICAgc3VwZXIoW1wiaHNldFwiLCBrZXksIC4uLk9iamVjdC5lbnRyaWVzKGt2KS5mbGF0TWFwKChbZmllbGQsIHZhbHVlXSkgPT4gW2ZpZWxkLCB2YWx1ZV0pXSwgb3B0cyk7XG4gIH1cbn07XG5cbi8vIHBrZy9jb21tYW5kcy9oc2V0bngudHNcbnZhciBIU2V0TlhDb21tYW5kID0gY2xhc3MgZXh0ZW5kcyBDb21tYW5kIHtcbiAgY29uc3RydWN0b3IoY21kLCBvcHRzKSB7XG4gICAgc3VwZXIoW1wiaHNldG54XCIsIC4uLmNtZF0sIG9wdHMpO1xuICB9XG59O1xuXG4vLyBwa2cvY29tbWFuZHMvaHN0cmxlbi50c1xudmFyIEhTdHJMZW5Db21tYW5kID0gY2xhc3MgZXh0ZW5kcyBDb21tYW5kIHtcbiAgY29uc3RydWN0b3IoY21kLCBvcHRzKSB7XG4gICAgc3VwZXIoW1wiaHN0cmxlblwiLCAuLi5jbWRdLCBvcHRzKTtcbiAgfVxufTtcblxuLy8gcGtnL2NvbW1hbmRzL2h0dGwudHNcbnZhciBIVHRsQ29tbWFuZCA9IGNsYXNzIGV4dGVuZHMgQ29tbWFuZCB7XG4gIGNvbnN0cnVjdG9yKGNtZCwgb3B0cykge1xuICAgIGNvbnN0IFtrZXksIGZpZWxkc10gPSBjbWQ7XG4gICAgY29uc3QgZmllbGRBcnJheSA9IEFycmF5LmlzQXJyYXkoZmllbGRzKSA/IGZpZWxkcyA6IFtmaWVsZHNdO1xuICAgIHN1cGVyKFtcImh0dGxcIiwga2V5LCBcIkZJRUxEU1wiLCBmaWVsZEFycmF5Lmxlbmd0aCwgLi4uZmllbGRBcnJheV0sIG9wdHMpO1xuICB9XG59O1xuXG4vLyBwa2cvY29tbWFuZHMvaHZhbHMudHNcbnZhciBIVmFsc0NvbW1hbmQgPSBjbGFzcyBleHRlbmRzIENvbW1hbmQge1xuICBjb25zdHJ1Y3RvcihjbWQsIG9wdHMpIHtcbiAgICBzdXBlcihbXCJodmFsc1wiLCAuLi5jbWRdLCBvcHRzKTtcbiAgfVxufTtcblxuLy8gcGtnL2NvbW1hbmRzL2luY3IudHNcbnZhciBJbmNyQ29tbWFuZCA9IGNsYXNzIGV4dGVuZHMgQ29tbWFuZCB7XG4gIGNvbnN0cnVjdG9yKGNtZCwgb3B0cykge1xuICAgIHN1cGVyKFtcImluY3JcIiwgLi4uY21kXSwgb3B0cyk7XG4gIH1cbn07XG5cbi8vIHBrZy9jb21tYW5kcy9pbmNyYnkudHNcbnZhciBJbmNyQnlDb21tYW5kID0gY2xhc3MgZXh0ZW5kcyBDb21tYW5kIHtcbiAgY29uc3RydWN0b3IoY21kLCBvcHRzKSB7XG4gICAgc3VwZXIoW1wiaW5jcmJ5XCIsIC4uLmNtZF0sIG9wdHMpO1xuICB9XG59O1xuXG4vLyBwa2cvY29tbWFuZHMvaW5jcmJ5ZmxvYXQudHNcbnZhciBJbmNyQnlGbG9hdENvbW1hbmQgPSBjbGFzcyBleHRlbmRzIENvbW1hbmQge1xuICBjb25zdHJ1Y3RvcihjbWQsIG9wdHMpIHtcbiAgICBzdXBlcihbXCJpbmNyYnlmbG9hdFwiLCAuLi5jbWRdLCBvcHRzKTtcbiAgfVxufTtcblxuLy8gcGtnL2NvbW1hbmRzL2pzb25fYXJyYXBwZW5kLnRzXG52YXIgSnNvbkFyckFwcGVuZENvbW1hbmQgPSBjbGFzcyBleHRlbmRzIENvbW1hbmQge1xuICBjb25zdHJ1Y3RvcihjbWQsIG9wdHMpIHtcbiAgICBzdXBlcihbXCJKU09OLkFSUkFQUEVORFwiLCAuLi5jbWRdLCBvcHRzKTtcbiAgfVxufTtcblxuLy8gcGtnL2NvbW1hbmRzL2pzb25fYXJyaW5kZXgudHNcbnZhciBKc29uQXJySW5kZXhDb21tYW5kID0gY2xhc3MgZXh0ZW5kcyBDb21tYW5kIHtcbiAgY29uc3RydWN0b3IoY21kLCBvcHRzKSB7XG4gICAgc3VwZXIoW1wiSlNPTi5BUlJJTkRFWFwiLCAuLi5jbWRdLCBvcHRzKTtcbiAgfVxufTtcblxuLy8gcGtnL2NvbW1hbmRzL2pzb25fYXJyaW5zZXJ0LnRzXG52YXIgSnNvbkFyckluc2VydENvbW1hbmQgPSBjbGFzcyBleHRlbmRzIENvbW1hbmQge1xuICBjb25zdHJ1Y3RvcihjbWQsIG9wdHMpIHtcbiAgICBzdXBlcihbXCJKU09OLkFSUklOU0VSVFwiLCAuLi5jbWRdLCBvcHRzKTtcbiAgfVxufTtcblxuLy8gcGtnL2NvbW1hbmRzL2pzb25fYXJybGVuLnRzXG52YXIgSnNvbkFyckxlbkNvbW1hbmQgPSBjbGFzcyBleHRlbmRzIENvbW1hbmQge1xuICBjb25zdHJ1Y3RvcihjbWQsIG9wdHMpIHtcbiAgICBzdXBlcihbXCJKU09OLkFSUkxFTlwiLCBjbWRbMF0sIGNtZFsxXSA/PyBcIiRcIl0sIG9wdHMpO1xuICB9XG59O1xuXG4vLyBwa2cvY29tbWFuZHMvanNvbl9hcnJwb3AudHNcbnZhciBKc29uQXJyUG9wQ29tbWFuZCA9IGNsYXNzIGV4dGVuZHMgQ29tbWFuZCB7XG4gIGNvbnN0cnVjdG9yKGNtZCwgb3B0cykge1xuICAgIHN1cGVyKFtcIkpTT04uQVJSUE9QXCIsIC4uLmNtZF0sIG9wdHMpO1xuICB9XG59O1xuXG4vLyBwa2cvY29tbWFuZHMvanNvbl9hcnJ0cmltLnRzXG52YXIgSnNvbkFyclRyaW1Db21tYW5kID0gY2xhc3MgZXh0ZW5kcyBDb21tYW5kIHtcbiAgY29uc3RydWN0b3IoY21kLCBvcHRzKSB7XG4gICAgY29uc3QgcGF0aCA9IGNtZFsxXSA/PyBcIiRcIjtcbiAgICBjb25zdCBzdGFydCA9IGNtZFsyXSA/PyAwO1xuICAgIGNvbnN0IHN0b3AgPSBjbWRbM10gPz8gMDtcbiAgICBzdXBlcihbXCJKU09OLkFSUlRSSU1cIiwgY21kWzBdLCBwYXRoLCBzdGFydCwgc3RvcF0sIG9wdHMpO1xuICB9XG59O1xuXG4vLyBwa2cvY29tbWFuZHMvanNvbl9jbGVhci50c1xudmFyIEpzb25DbGVhckNvbW1hbmQgPSBjbGFzcyBleHRlbmRzIENvbW1hbmQge1xuICBjb25zdHJ1Y3RvcihjbWQsIG9wdHMpIHtcbiAgICBzdXBlcihbXCJKU09OLkNMRUFSXCIsIC4uLmNtZF0sIG9wdHMpO1xuICB9XG59O1xuXG4vLyBwa2cvY29tbWFuZHMvanNvbl9kZWwudHNcbnZhciBKc29uRGVsQ29tbWFuZCA9IGNsYXNzIGV4dGVuZHMgQ29tbWFuZCB7XG4gIGNvbnN0cnVjdG9yKGNtZCwgb3B0cykge1xuICAgIHN1cGVyKFtcIkpTT04uREVMXCIsIC4uLmNtZF0sIG9wdHMpO1xuICB9XG59O1xuXG4vLyBwa2cvY29tbWFuZHMvanNvbl9mb3JnZXQudHNcbnZhciBKc29uRm9yZ2V0Q29tbWFuZCA9IGNsYXNzIGV4dGVuZHMgQ29tbWFuZCB7XG4gIGNvbnN0cnVjdG9yKGNtZCwgb3B0cykge1xuICAgIHN1cGVyKFtcIkpTT04uRk9SR0VUXCIsIC4uLmNtZF0sIG9wdHMpO1xuICB9XG59O1xuXG4vLyBwa2cvY29tbWFuZHMvanNvbl9nZXQudHNcbnZhciBKc29uR2V0Q29tbWFuZCA9IGNsYXNzIGV4dGVuZHMgQ29tbWFuZCB7XG4gIGNvbnN0cnVjdG9yKGNtZCwgb3B0cykge1xuICAgIGNvbnN0IGNvbW1hbmQgPSBbXCJKU09OLkdFVFwiXTtcbiAgICBpZiAodHlwZW9mIGNtZFsxXSA9PT0gXCJzdHJpbmdcIikge1xuICAgICAgY29tbWFuZC5wdXNoKC4uLmNtZCk7XG4gICAgfSBlbHNlIHtcbiAgICAgIGNvbW1hbmQucHVzaChjbWRbMF0pO1xuICAgICAgaWYgKGNtZFsxXSkge1xuICAgICAgICBpZiAoY21kWzFdLmluZGVudCkge1xuICAgICAgICAgIGNvbW1hbmQucHVzaChcIklOREVOVFwiLCBjbWRbMV0uaW5kZW50KTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoY21kWzFdLm5ld2xpbmUpIHtcbiAgICAgICAgICBjb21tYW5kLnB1c2goXCJORVdMSU5FXCIsIGNtZFsxXS5uZXdsaW5lKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoY21kWzFdLnNwYWNlKSB7XG4gICAgICAgICAgY29tbWFuZC5wdXNoKFwiU1BBQ0VcIiwgY21kWzFdLnNwYWNlKTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgICAgY29tbWFuZC5wdXNoKC4uLmNtZC5zbGljZSgyKSk7XG4gICAgfVxuICAgIHN1cGVyKGNvbW1hbmQsIG9wdHMpO1xuICB9XG59O1xuXG4vLyBwa2cvY29tbWFuZHMvanNvbl9tZXJnZS50c1xudmFyIEpzb25NZXJnZUNvbW1hbmQgPSBjbGFzcyBleHRlbmRzIENvbW1hbmQge1xuICBjb25zdHJ1Y3RvcihjbWQsIG9wdHMpIHtcbiAgICBjb25zdCBjb21tYW5kID0gW1wiSlNPTi5NRVJHRVwiLCAuLi5jbWRdO1xuICAgIHN1cGVyKGNvbW1hbmQsIG9wdHMpO1xuICB9XG59O1xuXG4vLyBwa2cvY29tbWFuZHMvanNvbl9tZ2V0LnRzXG52YXIgSnNvbk1HZXRDb21tYW5kID0gY2xhc3MgZXh0ZW5kcyBDb21tYW5kIHtcbiAgY29uc3RydWN0b3IoY21kLCBvcHRzKSB7XG4gICAgc3VwZXIoW1wiSlNPTi5NR0VUXCIsIC4uLmNtZFswXSwgY21kWzFdXSwgb3B0cyk7XG4gIH1cbn07XG5cbi8vIHBrZy9jb21tYW5kcy9qc29uX21zZXQudHNcbnZhciBKc29uTVNldENvbW1hbmQgPSBjbGFzcyBleHRlbmRzIENvbW1hbmQge1xuICBjb25zdHJ1Y3RvcihjbWQsIG9wdHMpIHtcbiAgICBjb25zdCBjb21tYW5kID0gW1wiSlNPTi5NU0VUXCJdO1xuICAgIGZvciAoY29uc3QgYyBvZiBjbWQpIHtcbiAgICAgIGNvbW1hbmQucHVzaChjLmtleSwgYy5wYXRoLCBjLnZhbHVlKTtcbiAgICB9XG4gICAgc3VwZXIoY29tbWFuZCwgb3B0cyk7XG4gIH1cbn07XG5cbi8vIHBrZy9jb21tYW5kcy9qc29uX251bWluY3JieS50c1xudmFyIEpzb25OdW1JbmNyQnlDb21tYW5kID0gY2xhc3MgZXh0ZW5kcyBDb21tYW5kIHtcbiAgY29uc3RydWN0b3IoY21kLCBvcHRzKSB7XG4gICAgc3VwZXIoW1wiSlNPTi5OVU1JTkNSQllcIiwgLi4uY21kXSwgb3B0cyk7XG4gIH1cbn07XG5cbi8vIHBrZy9jb21tYW5kcy9qc29uX251bW11bHRieS50c1xudmFyIEpzb25OdW1NdWx0QnlDb21tYW5kID0gY2xhc3MgZXh0ZW5kcyBDb21tYW5kIHtcbiAgY29uc3RydWN0b3IoY21kLCBvcHRzKSB7XG4gICAgc3VwZXIoW1wiSlNPTi5OVU1NVUxUQllcIiwgLi4uY21kXSwgb3B0cyk7XG4gIH1cbn07XG5cbi8vIHBrZy9jb21tYW5kcy9qc29uX29iamtleXMudHNcbnZhciBKc29uT2JqS2V5c0NvbW1hbmQgPSBjbGFzcyBleHRlbmRzIENvbW1hbmQge1xuICBjb25zdHJ1Y3RvcihjbWQsIG9wdHMpIHtcbiAgICBzdXBlcihbXCJKU09OLk9CSktFWVNcIiwgLi4uY21kXSwgb3B0cyk7XG4gIH1cbn07XG5cbi8vIHBrZy9jb21tYW5kcy9qc29uX29iamxlbi50c1xudmFyIEpzb25PYmpMZW5Db21tYW5kID0gY2xhc3MgZXh0ZW5kcyBDb21tYW5kIHtcbiAgY29uc3RydWN0b3IoY21kLCBvcHRzKSB7XG4gICAgc3VwZXIoW1wiSlNPTi5PQkpMRU5cIiwgLi4uY21kXSwgb3B0cyk7XG4gIH1cbn07XG5cbi8vIHBrZy9jb21tYW5kcy9qc29uX3Jlc3AudHNcbnZhciBKc29uUmVzcENvbW1hbmQgPSBjbGFzcyBleHRlbmRzIENvbW1hbmQge1xuICBjb25zdHJ1Y3RvcihjbWQsIG9wdHMpIHtcbiAgICBzdXBlcihbXCJKU09OLlJFU1BcIiwgLi4uY21kXSwgb3B0cyk7XG4gIH1cbn07XG5cbi8vIHBrZy9jb21tYW5kcy9qc29uX3NldC50c1xudmFyIEpzb25TZXRDb21tYW5kID0gY2xhc3MgZXh0ZW5kcyBDb21tYW5kIHtcbiAgY29uc3RydWN0b3IoY21kLCBvcHRzKSB7XG4gICAgY29uc3QgY29tbWFuZCA9IFtcIkpTT04uU0VUXCIsIGNtZFswXSwgY21kWzFdLCBjbWRbMl1dO1xuICAgIGlmIChjbWRbM10pIHtcbiAgICAgIGlmIChjbWRbM10ubngpIHtcbiAgICAgICAgY29tbWFuZC5wdXNoKFwiTlhcIik7XG4gICAgICB9IGVsc2UgaWYgKGNtZFszXS54eCkge1xuICAgICAgICBjb21tYW5kLnB1c2goXCJYWFwiKTtcbiAgICAgIH1cbiAgICB9XG4gICAgc3VwZXIoY29tbWFuZCwgb3B0cyk7XG4gIH1cbn07XG5cbi8vIHBrZy9jb21tYW5kcy9qc29uX3N0cmFwcGVuZC50c1xudmFyIEpzb25TdHJBcHBlbmRDb21tYW5kID0gY2xhc3MgZXh0ZW5kcyBDb21tYW5kIHtcbiAgY29uc3RydWN0b3IoY21kLCBvcHRzKSB7XG4gICAgc3VwZXIoW1wiSlNPTi5TVFJBUFBFTkRcIiwgLi4uY21kXSwgb3B0cyk7XG4gIH1cbn07XG5cbi8vIHBrZy9jb21tYW5kcy9qc29uX3N0cmxlbi50c1xudmFyIEpzb25TdHJMZW5Db21tYW5kID0gY2xhc3MgZXh0ZW5kcyBDb21tYW5kIHtcbiAgY29uc3RydWN0b3IoY21kLCBvcHRzKSB7XG4gICAgc3VwZXIoW1wiSlNPTi5TVFJMRU5cIiwgLi4uY21kXSwgb3B0cyk7XG4gIH1cbn07XG5cbi8vIHBrZy9jb21tYW5kcy9qc29uX3RvZ2dsZS50c1xudmFyIEpzb25Ub2dnbGVDb21tYW5kID0gY2xhc3MgZXh0ZW5kcyBDb21tYW5kIHtcbiAgY29uc3RydWN0b3IoY21kLCBvcHRzKSB7XG4gICAgc3VwZXIoW1wiSlNPTi5UT0dHTEVcIiwgLi4uY21kXSwgb3B0cyk7XG4gIH1cbn07XG5cbi8vIHBrZy9jb21tYW5kcy9qc29uX3R5cGUudHNcbnZhciBKc29uVHlwZUNvbW1hbmQgPSBjbGFzcyBleHRlbmRzIENvbW1hbmQge1xuICBjb25zdHJ1Y3RvcihjbWQsIG9wdHMpIHtcbiAgICBzdXBlcihbXCJKU09OLlRZUEVcIiwgLi4uY21kXSwgb3B0cyk7XG4gIH1cbn07XG5cbi8vIHBrZy9jb21tYW5kcy9rZXlzLnRzXG52YXIgS2V5c0NvbW1hbmQgPSBjbGFzcyBleHRlbmRzIENvbW1hbmQge1xuICBjb25zdHJ1Y3RvcihjbWQsIG9wdHMpIHtcbiAgICBzdXBlcihbXCJrZXlzXCIsIC4uLmNtZF0sIG9wdHMpO1xuICB9XG59O1xuXG4vLyBwa2cvY29tbWFuZHMvbGluZGV4LnRzXG52YXIgTEluZGV4Q29tbWFuZCA9IGNsYXNzIGV4dGVuZHMgQ29tbWFuZCB7XG4gIGNvbnN0cnVjdG9yKGNtZCwgb3B0cykge1xuICAgIHN1cGVyKFtcImxpbmRleFwiLCAuLi5jbWRdLCBvcHRzKTtcbiAgfVxufTtcblxuLy8gcGtnL2NvbW1hbmRzL2xpbnNlcnQudHNcbnZhciBMSW5zZXJ0Q29tbWFuZCA9IGNsYXNzIGV4dGVuZHMgQ29tbWFuZCB7XG4gIGNvbnN0cnVjdG9yKGNtZCwgb3B0cykge1xuICAgIHN1cGVyKFtcImxpbnNlcnRcIiwgLi4uY21kXSwgb3B0cyk7XG4gIH1cbn07XG5cbi8vIHBrZy9jb21tYW5kcy9sbGVuLnRzXG52YXIgTExlbkNvbW1hbmQgPSBjbGFzcyBleHRlbmRzIENvbW1hbmQge1xuICBjb25zdHJ1Y3RvcihjbWQsIG9wdHMpIHtcbiAgICBzdXBlcihbXCJsbGVuXCIsIC4uLmNtZF0sIG9wdHMpO1xuICB9XG59O1xuXG4vLyBwa2cvY29tbWFuZHMvbG1vdmUudHNcbnZhciBMTW92ZUNvbW1hbmQgPSBjbGFzcyBleHRlbmRzIENvbW1hbmQge1xuICBjb25zdHJ1Y3RvcihjbWQsIG9wdHMpIHtcbiAgICBzdXBlcihbXCJsbW92ZVwiLCAuLi5jbWRdLCBvcHRzKTtcbiAgfVxufTtcblxuLy8gcGtnL2NvbW1hbmRzL2xtcG9wLnRzXG52YXIgTG1Qb3BDb21tYW5kID0gY2xhc3MgZXh0ZW5kcyBDb21tYW5kIHtcbiAgY29uc3RydWN0b3IoY21kLCBvcHRzKSB7XG4gICAgY29uc3QgW251bWtleXMsIGtleXMsIGRpcmVjdGlvbiwgY291bnRdID0gY21kO1xuICAgIHN1cGVyKFtcIkxNUE9QXCIsIG51bWtleXMsIC4uLmtleXMsIGRpcmVjdGlvbiwgLi4uY291bnQgPyBbXCJDT1VOVFwiLCBjb3VudF0gOiBbXV0sIG9wdHMpO1xuICB9XG59O1xuXG4vLyBwa2cvY29tbWFuZHMvbHBvcC50c1xudmFyIExQb3BDb21tYW5kID0gY2xhc3MgZXh0ZW5kcyBDb21tYW5kIHtcbiAgY29uc3RydWN0b3IoY21kLCBvcHRzKSB7XG4gICAgc3VwZXIoW1wibHBvcFwiLCAuLi5jbWRdLCBvcHRzKTtcbiAgfVxufTtcblxuLy8gcGtnL2NvbW1hbmRzL2xwb3MudHNcbnZhciBMUG9zQ29tbWFuZCA9IGNsYXNzIGV4dGVuZHMgQ29tbWFuZCB7XG4gIGNvbnN0cnVjdG9yKGNtZCwgb3B0cykge1xuICAgIGNvbnN0IGFyZ3MgPSBbXCJscG9zXCIsIGNtZFswXSwgY21kWzFdXTtcbiAgICBpZiAodHlwZW9mIGNtZFsyXT8ucmFuayA9PT0gXCJudW1iZXJcIikge1xuICAgICAgYXJncy5wdXNoKFwicmFua1wiLCBjbWRbMl0ucmFuayk7XG4gICAgfVxuICAgIGlmICh0eXBlb2YgY21kWzJdPy5jb3VudCA9PT0gXCJudW1iZXJcIikge1xuICAgICAgYXJncy5wdXNoKFwiY291bnRcIiwgY21kWzJdLmNvdW50KTtcbiAgICB9XG4gICAgaWYgKHR5cGVvZiBjbWRbMl0/Lm1heExlbiA9PT0gXCJudW1iZXJcIikge1xuICAgICAgYXJncy5wdXNoKFwibWF4TGVuXCIsIGNtZFsyXS5tYXhMZW4pO1xuICAgIH1cbiAgICBzdXBlcihhcmdzLCBvcHRzKTtcbiAgfVxufTtcblxuLy8gcGtnL2NvbW1hbmRzL2xwdXNoLnRzXG52YXIgTFB1c2hDb21tYW5kID0gY2xhc3MgZXh0ZW5kcyBDb21tYW5kIHtcbiAgY29uc3RydWN0b3IoY21kLCBvcHRzKSB7XG4gICAgc3VwZXIoW1wibHB1c2hcIiwgLi4uY21kXSwgb3B0cyk7XG4gIH1cbn07XG5cbi8vIHBrZy9jb21tYW5kcy9scHVzaHgudHNcbnZhciBMUHVzaFhDb21tYW5kID0gY2xhc3MgZXh0ZW5kcyBDb21tYW5kIHtcbiAgY29uc3RydWN0b3IoY21kLCBvcHRzKSB7XG4gICAgc3VwZXIoW1wibHB1c2h4XCIsIC4uLmNtZF0sIG9wdHMpO1xuICB9XG59O1xuXG4vLyBwa2cvY29tbWFuZHMvbHJhbmdlLnRzXG52YXIgTFJhbmdlQ29tbWFuZCA9IGNsYXNzIGV4dGVuZHMgQ29tbWFuZCB7XG4gIGNvbnN0cnVjdG9yKGNtZCwgb3B0cykge1xuICAgIHN1cGVyKFtcImxyYW5nZVwiLCAuLi5jbWRdLCBvcHRzKTtcbiAgfVxufTtcblxuLy8gcGtnL2NvbW1hbmRzL2xyZW0udHNcbnZhciBMUmVtQ29tbWFuZCA9IGNsYXNzIGV4dGVuZHMgQ29tbWFuZCB7XG4gIGNvbnN0cnVjdG9yKGNtZCwgb3B0cykge1xuICAgIHN1cGVyKFtcImxyZW1cIiwgLi4uY21kXSwgb3B0cyk7XG4gIH1cbn07XG5cbi8vIHBrZy9jb21tYW5kcy9sc2V0LnRzXG52YXIgTFNldENvbW1hbmQgPSBjbGFzcyBleHRlbmRzIENvbW1hbmQge1xuICBjb25zdHJ1Y3RvcihjbWQsIG9wdHMpIHtcbiAgICBzdXBlcihbXCJsc2V0XCIsIC4uLmNtZF0sIG9wdHMpO1xuICB9XG59O1xuXG4vLyBwa2cvY29tbWFuZHMvbHRyaW0udHNcbnZhciBMVHJpbUNvbW1hbmQgPSBjbGFzcyBleHRlbmRzIENvbW1hbmQge1xuICBjb25zdHJ1Y3RvcihjbWQsIG9wdHMpIHtcbiAgICBzdXBlcihbXCJsdHJpbVwiLCAuLi5jbWRdLCBvcHRzKTtcbiAgfVxufTtcblxuLy8gcGtnL2NvbW1hbmRzL21nZXQudHNcbnZhciBNR2V0Q29tbWFuZCA9IGNsYXNzIGV4dGVuZHMgQ29tbWFuZCB7XG4gIGNvbnN0cnVjdG9yKGNtZCwgb3B0cykge1xuICAgIGNvbnN0IGtleXMgPSBBcnJheS5pc0FycmF5KGNtZFswXSkgPyBjbWRbMF0gOiBjbWQ7XG4gICAgc3VwZXIoW1wibWdldFwiLCAuLi5rZXlzXSwgb3B0cyk7XG4gIH1cbn07XG5cbi8vIHBrZy9jb21tYW5kcy9tc2V0LnRzXG52YXIgTVNldENvbW1hbmQgPSBjbGFzcyBleHRlbmRzIENvbW1hbmQge1xuICBjb25zdHJ1Y3Rvcihba3ZdLCBvcHRzKSB7XG4gICAgc3VwZXIoW1wibXNldFwiLCAuLi5PYmplY3QuZW50cmllcyhrdikuZmxhdE1hcCgoW2tleSwgdmFsdWVdKSA9PiBba2V5LCB2YWx1ZV0pXSwgb3B0cyk7XG4gIH1cbn07XG5cbi8vIHBrZy9jb21tYW5kcy9tc2V0bngudHNcbnZhciBNU2V0TlhDb21tYW5kID0gY2xhc3MgZXh0ZW5kcyBDb21tYW5kIHtcbiAgY29uc3RydWN0b3IoW2t2XSwgb3B0cykge1xuICAgIHN1cGVyKFtcIm1zZXRueFwiLCAuLi5PYmplY3QuZW50cmllcyhrdikuZmxhdCgpXSwgb3B0cyk7XG4gIH1cbn07XG5cbi8vIHBrZy9jb21tYW5kcy9wZXJzaXN0LnRzXG52YXIgUGVyc2lzdENvbW1hbmQgPSBjbGFzcyBleHRlbmRzIENvbW1hbmQge1xuICBjb25zdHJ1Y3RvcihjbWQsIG9wdHMpIHtcbiAgICBzdXBlcihbXCJwZXJzaXN0XCIsIC4uLmNtZF0sIG9wdHMpO1xuICB9XG59O1xuXG4vLyBwa2cvY29tbWFuZHMvcGV4cGlyZS50c1xudmFyIFBFeHBpcmVDb21tYW5kID0gY2xhc3MgZXh0ZW5kcyBDb21tYW5kIHtcbiAgY29uc3RydWN0b3IoY21kLCBvcHRzKSB7XG4gICAgc3VwZXIoW1wicGV4cGlyZVwiLCAuLi5jbWRdLCBvcHRzKTtcbiAgfVxufTtcblxuLy8gcGtnL2NvbW1hbmRzL3BleHBpcmVhdC50c1xudmFyIFBFeHBpcmVBdENvbW1hbmQgPSBjbGFzcyBleHRlbmRzIENvbW1hbmQge1xuICBjb25zdHJ1Y3RvcihjbWQsIG9wdHMpIHtcbiAgICBzdXBlcihbXCJwZXhwaXJlYXRcIiwgLi4uY21kXSwgb3B0cyk7XG4gIH1cbn07XG5cbi8vIHBrZy9jb21tYW5kcy9wZmFkZC50c1xudmFyIFBmQWRkQ29tbWFuZCA9IGNsYXNzIGV4dGVuZHMgQ29tbWFuZCB7XG4gIGNvbnN0cnVjdG9yKGNtZCwgb3B0cykge1xuICAgIHN1cGVyKFtcInBmYWRkXCIsIC4uLmNtZF0sIG9wdHMpO1xuICB9XG59O1xuXG4vLyBwa2cvY29tbWFuZHMvcGZjb3VudC50c1xudmFyIFBmQ291bnRDb21tYW5kID0gY2xhc3MgZXh0ZW5kcyBDb21tYW5kIHtcbiAgY29uc3RydWN0b3IoY21kLCBvcHRzKSB7XG4gICAgc3VwZXIoW1wicGZjb3VudFwiLCAuLi5jbWRdLCBvcHRzKTtcbiAgfVxufTtcblxuLy8gcGtnL2NvbW1hbmRzL3BmbWVyZ2UudHNcbnZhciBQZk1lcmdlQ29tbWFuZCA9IGNsYXNzIGV4dGVuZHMgQ29tbWFuZCB7XG4gIGNvbnN0cnVjdG9yKGNtZCwgb3B0cykge1xuICAgIHN1cGVyKFtcInBmbWVyZ2VcIiwgLi4uY21kXSwgb3B0cyk7XG4gIH1cbn07XG5cbi8vIHBrZy9jb21tYW5kcy9waW5nLnRzXG52YXIgUGluZ0NvbW1hbmQgPSBjbGFzcyBleHRlbmRzIENvbW1hbmQge1xuICBjb25zdHJ1Y3RvcihjbWQsIG9wdHMpIHtcbiAgICBjb25zdCBjb21tYW5kID0gW1wicGluZ1wiXTtcbiAgICBpZiAoY21kPy5bMF0gIT09IHZvaWQgMCkge1xuICAgICAgY29tbWFuZC5wdXNoKGNtZFswXSk7XG4gICAgfVxuICAgIHN1cGVyKGNvbW1hbmQsIG9wdHMpO1xuICB9XG59O1xuXG4vLyBwa2cvY29tbWFuZHMvcHNldGV4LnRzXG52YXIgUFNldEVYQ29tbWFuZCA9IGNsYXNzIGV4dGVuZHMgQ29tbWFuZCB7XG4gIGNvbnN0cnVjdG9yKGNtZCwgb3B0cykge1xuICAgIHN1cGVyKFtcInBzZXRleFwiLCAuLi5jbWRdLCBvcHRzKTtcbiAgfVxufTtcblxuLy8gcGtnL2NvbW1hbmRzL3B0dGwudHNcbnZhciBQVHRsQ29tbWFuZCA9IGNsYXNzIGV4dGVuZHMgQ29tbWFuZCB7XG4gIGNvbnN0cnVjdG9yKGNtZCwgb3B0cykge1xuICAgIHN1cGVyKFtcInB0dGxcIiwgLi4uY21kXSwgb3B0cyk7XG4gIH1cbn07XG5cbi8vIHBrZy9jb21tYW5kcy9wdWJsaXNoLnRzXG52YXIgUHVibGlzaENvbW1hbmQgPSBjbGFzcyBleHRlbmRzIENvbW1hbmQge1xuICBjb25zdHJ1Y3RvcihjbWQsIG9wdHMpIHtcbiAgICBzdXBlcihbXCJwdWJsaXNoXCIsIC4uLmNtZF0sIG9wdHMpO1xuICB9XG59O1xuXG4vLyBwa2cvY29tbWFuZHMvcmFuZG9ta2V5LnRzXG52YXIgUmFuZG9tS2V5Q29tbWFuZCA9IGNsYXNzIGV4dGVuZHMgQ29tbWFuZCB7XG4gIGNvbnN0cnVjdG9yKG9wdHMpIHtcbiAgICBzdXBlcihbXCJyYW5kb21rZXlcIl0sIG9wdHMpO1xuICB9XG59O1xuXG4vLyBwa2cvY29tbWFuZHMvcmVuYW1lLnRzXG52YXIgUmVuYW1lQ29tbWFuZCA9IGNsYXNzIGV4dGVuZHMgQ29tbWFuZCB7XG4gIGNvbnN0cnVjdG9yKGNtZCwgb3B0cykge1xuICAgIHN1cGVyKFtcInJlbmFtZVwiLCAuLi5jbWRdLCBvcHRzKTtcbiAgfVxufTtcblxuLy8gcGtnL2NvbW1hbmRzL3JlbmFtZW54LnRzXG52YXIgUmVuYW1lTlhDb21tYW5kID0gY2xhc3MgZXh0ZW5kcyBDb21tYW5kIHtcbiAgY29uc3RydWN0b3IoY21kLCBvcHRzKSB7XG4gICAgc3VwZXIoW1wicmVuYW1lbnhcIiwgLi4uY21kXSwgb3B0cyk7XG4gIH1cbn07XG5cbi8vIHBrZy9jb21tYW5kcy9ycG9wLnRzXG52YXIgUlBvcENvbW1hbmQgPSBjbGFzcyBleHRlbmRzIENvbW1hbmQge1xuICBjb25zdHJ1Y3RvcihjbWQsIG9wdHMpIHtcbiAgICBzdXBlcihbXCJycG9wXCIsIC4uLmNtZF0sIG9wdHMpO1xuICB9XG59O1xuXG4vLyBwa2cvY29tbWFuZHMvcnB1c2gudHNcbnZhciBSUHVzaENvbW1hbmQgPSBjbGFzcyBleHRlbmRzIENvbW1hbmQge1xuICBjb25zdHJ1Y3RvcihjbWQsIG9wdHMpIHtcbiAgICBzdXBlcihbXCJycHVzaFwiLCAuLi5jbWRdLCBvcHRzKTtcbiAgfVxufTtcblxuLy8gcGtnL2NvbW1hbmRzL3JwdXNoeC50c1xudmFyIFJQdXNoWENvbW1hbmQgPSBjbGFzcyBleHRlbmRzIENvbW1hbmQge1xuICBjb25zdHJ1Y3RvcihjbWQsIG9wdHMpIHtcbiAgICBzdXBlcihbXCJycHVzaHhcIiwgLi4uY21kXSwgb3B0cyk7XG4gIH1cbn07XG5cbi8vIHBrZy9jb21tYW5kcy9zYWRkLnRzXG52YXIgU0FkZENvbW1hbmQgPSBjbGFzcyBleHRlbmRzIENvbW1hbmQge1xuICBjb25zdHJ1Y3RvcihjbWQsIG9wdHMpIHtcbiAgICBzdXBlcihbXCJzYWRkXCIsIC4uLmNtZF0sIG9wdHMpO1xuICB9XG59O1xuXG4vLyBwa2cvY29tbWFuZHMvc2Nhbi50c1xudmFyIFNjYW5Db21tYW5kID0gY2xhc3MgZXh0ZW5kcyBDb21tYW5kIHtcbiAgY29uc3RydWN0b3IoW2N1cnNvciwgb3B0c10sIGNtZE9wdHMpIHtcbiAgICBjb25zdCBjb21tYW5kID0gW1wic2NhblwiLCBjdXJzb3JdO1xuICAgIGlmIChvcHRzPy5tYXRjaCkge1xuICAgICAgY29tbWFuZC5wdXNoKFwibWF0Y2hcIiwgb3B0cy5tYXRjaCk7XG4gICAgfVxuICAgIGlmICh0eXBlb2Ygb3B0cz8uY291bnQgPT09IFwibnVtYmVyXCIpIHtcbiAgICAgIGNvbW1hbmQucHVzaChcImNvdW50XCIsIG9wdHMuY291bnQpO1xuICAgIH1cbiAgICBpZiAob3B0cyAmJiBcIndpdGhUeXBlXCIgaW4gb3B0cyAmJiBvcHRzLndpdGhUeXBlID09PSB0cnVlKSB7XG4gICAgICBjb21tYW5kLnB1c2goXCJ3aXRodHlwZVwiKTtcbiAgICB9IGVsc2UgaWYgKG9wdHMgJiYgXCJ0eXBlXCIgaW4gb3B0cyAmJiBvcHRzLnR5cGUgJiYgb3B0cy50eXBlLmxlbmd0aCA+IDApIHtcbiAgICAgIGNvbW1hbmQucHVzaChcInR5cGVcIiwgb3B0cy50eXBlKTtcbiAgICB9XG4gICAgc3VwZXIoY29tbWFuZCwge1xuICAgICAgLy8gQHRzLWV4cGVjdC1lcnJvciBpZ25vcmUgdHlwZXMgaGVyZVxuICAgICAgZGVzZXJpYWxpemU6IG9wdHM/LndpdGhUeXBlID8gZGVzZXJpYWxpemVTY2FuV2l0aFR5cGVzUmVzcG9uc2UgOiBkZXNlcmlhbGl6ZVNjYW5SZXNwb25zZSxcbiAgICAgIC4uLmNtZE9wdHNcbiAgICB9KTtcbiAgfVxufTtcblxuLy8gcGtnL2NvbW1hbmRzL3NjYXJkLnRzXG52YXIgU0NhcmRDb21tYW5kID0gY2xhc3MgZXh0ZW5kcyBDb21tYW5kIHtcbiAgY29uc3RydWN0b3IoY21kLCBvcHRzKSB7XG4gICAgc3VwZXIoW1wic2NhcmRcIiwgLi4uY21kXSwgb3B0cyk7XG4gIH1cbn07XG5cbi8vIHBrZy9jb21tYW5kcy9zY3JpcHRfZXhpc3RzLnRzXG52YXIgU2NyaXB0RXhpc3RzQ29tbWFuZCA9IGNsYXNzIGV4dGVuZHMgQ29tbWFuZCB7XG4gIGNvbnN0cnVjdG9yKGhhc2hlcywgb3B0cykge1xuICAgIHN1cGVyKFtcInNjcmlwdFwiLCBcImV4aXN0c1wiLCAuLi5oYXNoZXNdLCB7XG4gICAgICBkZXNlcmlhbGl6ZTogKHJlc3VsdCkgPT4gcmVzdWx0LFxuICAgICAgLi4ub3B0c1xuICAgIH0pO1xuICB9XG59O1xuXG4vLyBwa2cvY29tbWFuZHMvc2NyaXB0X2ZsdXNoLnRzXG52YXIgU2NyaXB0Rmx1c2hDb21tYW5kID0gY2xhc3MgZXh0ZW5kcyBDb21tYW5kIHtcbiAgY29uc3RydWN0b3IoW29wdHNdLCBjbWRPcHRzKSB7XG4gICAgY29uc3QgY21kID0gW1wic2NyaXB0XCIsIFwiZmx1c2hcIl07XG4gICAgaWYgKG9wdHM/LnN5bmMpIHtcbiAgICAgIGNtZC5wdXNoKFwic3luY1wiKTtcbiAgICB9IGVsc2UgaWYgKG9wdHM/LmFzeW5jKSB7XG4gICAgICBjbWQucHVzaChcImFzeW5jXCIpO1xuICAgIH1cbiAgICBzdXBlcihjbWQsIGNtZE9wdHMpO1xuICB9XG59O1xuXG4vLyBwa2cvY29tbWFuZHMvc2NyaXB0X2xvYWQudHNcbnZhciBTY3JpcHRMb2FkQ29tbWFuZCA9IGNsYXNzIGV4dGVuZHMgQ29tbWFuZCB7XG4gIGNvbnN0cnVjdG9yKGFyZ3MsIG9wdHMpIHtcbiAgICBzdXBlcihbXCJzY3JpcHRcIiwgXCJsb2FkXCIsIC4uLmFyZ3NdLCBvcHRzKTtcbiAgfVxufTtcblxuLy8gcGtnL2NvbW1hbmRzL3NkaWZmLnRzXG52YXIgU0RpZmZDb21tYW5kID0gY2xhc3MgZXh0ZW5kcyBDb21tYW5kIHtcbiAgY29uc3RydWN0b3IoY21kLCBvcHRzKSB7XG4gICAgc3VwZXIoW1wic2RpZmZcIiwgLi4uY21kXSwgb3B0cyk7XG4gIH1cbn07XG5cbi8vIHBrZy9jb21tYW5kcy9zZGlmZnN0b3JlLnRzXG52YXIgU0RpZmZTdG9yZUNvbW1hbmQgPSBjbGFzcyBleHRlbmRzIENvbW1hbmQge1xuICBjb25zdHJ1Y3RvcihjbWQsIG9wdHMpIHtcbiAgICBzdXBlcihbXCJzZGlmZnN0b3JlXCIsIC4uLmNtZF0sIG9wdHMpO1xuICB9XG59O1xuXG4vLyBwa2cvY29tbWFuZHMvc2V0LnRzXG52YXIgU2V0Q29tbWFuZCA9IGNsYXNzIGV4dGVuZHMgQ29tbWFuZCB7XG4gIGNvbnN0cnVjdG9yKFtrZXksIHZhbHVlLCBvcHRzXSwgY21kT3B0cykge1xuICAgIGNvbnN0IGNvbW1hbmQgPSBbXCJzZXRcIiwga2V5LCB2YWx1ZV07XG4gICAgaWYgKG9wdHMpIHtcbiAgICAgIGlmIChcIm54XCIgaW4gb3B0cyAmJiBvcHRzLm54KSB7XG4gICAgICAgIGNvbW1hbmQucHVzaChcIm54XCIpO1xuICAgICAgfSBlbHNlIGlmIChcInh4XCIgaW4gb3B0cyAmJiBvcHRzLnh4KSB7XG4gICAgICAgIGNvbW1hbmQucHVzaChcInh4XCIpO1xuICAgICAgfVxuICAgICAgaWYgKFwiZ2V0XCIgaW4gb3B0cyAmJiBvcHRzLmdldCkge1xuICAgICAgICBjb21tYW5kLnB1c2goXCJnZXRcIik7XG4gICAgICB9XG4gICAgICBpZiAoXCJleFwiIGluIG9wdHMgJiYgdHlwZW9mIG9wdHMuZXggPT09IFwibnVtYmVyXCIpIHtcbiAgICAgICAgY29tbWFuZC5wdXNoKFwiZXhcIiwgb3B0cy5leCk7XG4gICAgICB9IGVsc2UgaWYgKFwicHhcIiBpbiBvcHRzICYmIHR5cGVvZiBvcHRzLnB4ID09PSBcIm51bWJlclwiKSB7XG4gICAgICAgIGNvbW1hbmQucHVzaChcInB4XCIsIG9wdHMucHgpO1xuICAgICAgfSBlbHNlIGlmIChcImV4YXRcIiBpbiBvcHRzICYmIHR5cGVvZiBvcHRzLmV4YXQgPT09IFwibnVtYmVyXCIpIHtcbiAgICAgICAgY29tbWFuZC5wdXNoKFwiZXhhdFwiLCBvcHRzLmV4YXQpO1xuICAgICAgfSBlbHNlIGlmIChcInB4YXRcIiBpbiBvcHRzICYmIHR5cGVvZiBvcHRzLnB4YXQgPT09IFwibnVtYmVyXCIpIHtcbiAgICAgICAgY29tbWFuZC5wdXNoKFwicHhhdFwiLCBvcHRzLnB4YXQpO1xuICAgICAgfSBlbHNlIGlmIChcImtlZXBUdGxcIiBpbiBvcHRzICYmIG9wdHMua2VlcFR0bCkge1xuICAgICAgICBjb21tYW5kLnB1c2goXCJrZWVwVHRsXCIpO1xuICAgICAgfVxuICAgIH1cbiAgICBzdXBlcihjb21tYW5kLCBjbWRPcHRzKTtcbiAgfVxufTtcblxuLy8gcGtnL2NvbW1hbmRzL3NldGJpdC50c1xudmFyIFNldEJpdENvbW1hbmQgPSBjbGFzcyBleHRlbmRzIENvbW1hbmQge1xuICBjb25zdHJ1Y3RvcihjbWQsIG9wdHMpIHtcbiAgICBzdXBlcihbXCJzZXRiaXRcIiwgLi4uY21kXSwgb3B0cyk7XG4gIH1cbn07XG5cbi8vIHBrZy9jb21tYW5kcy9zZXRleC50c1xudmFyIFNldEV4Q29tbWFuZCA9IGNsYXNzIGV4dGVuZHMgQ29tbWFuZCB7XG4gIGNvbnN0cnVjdG9yKGNtZCwgb3B0cykge1xuICAgIHN1cGVyKFtcInNldGV4XCIsIC4uLmNtZF0sIG9wdHMpO1xuICB9XG59O1xuXG4vLyBwa2cvY29tbWFuZHMvc2V0bngudHNcbnZhciBTZXROeENvbW1hbmQgPSBjbGFzcyBleHRlbmRzIENvbW1hbmQge1xuICBjb25zdHJ1Y3RvcihjbWQsIG9wdHMpIHtcbiAgICBzdXBlcihbXCJzZXRueFwiLCAuLi5jbWRdLCBvcHRzKTtcbiAgfVxufTtcblxuLy8gcGtnL2NvbW1hbmRzL3NldHJhbmdlLnRzXG52YXIgU2V0UmFuZ2VDb21tYW5kID0gY2xhc3MgZXh0ZW5kcyBDb21tYW5kIHtcbiAgY29uc3RydWN0b3IoY21kLCBvcHRzKSB7XG4gICAgc3VwZXIoW1wic2V0cmFuZ2VcIiwgLi4uY21kXSwgb3B0cyk7XG4gIH1cbn07XG5cbi8vIHBrZy9jb21tYW5kcy9zaW50ZXIudHNcbnZhciBTSW50ZXJDb21tYW5kID0gY2xhc3MgZXh0ZW5kcyBDb21tYW5kIHtcbiAgY29uc3RydWN0b3IoY21kLCBvcHRzKSB7XG4gICAgc3VwZXIoW1wic2ludGVyXCIsIC4uLmNtZF0sIG9wdHMpO1xuICB9XG59O1xuXG4vLyBwa2cvY29tbWFuZHMvc2ludGVyc3RvcmUudHNcbnZhciBTSW50ZXJTdG9yZUNvbW1hbmQgPSBjbGFzcyBleHRlbmRzIENvbW1hbmQge1xuICBjb25zdHJ1Y3RvcihjbWQsIG9wdHMpIHtcbiAgICBzdXBlcihbXCJzaW50ZXJzdG9yZVwiLCAuLi5jbWRdLCBvcHRzKTtcbiAgfVxufTtcblxuLy8gcGtnL2NvbW1hbmRzL3Npc21lbWJlci50c1xudmFyIFNJc01lbWJlckNvbW1hbmQgPSBjbGFzcyBleHRlbmRzIENvbW1hbmQge1xuICBjb25zdHJ1Y3RvcihjbWQsIG9wdHMpIHtcbiAgICBzdXBlcihbXCJzaXNtZW1iZXJcIiwgLi4uY21kXSwgb3B0cyk7XG4gIH1cbn07XG5cbi8vIHBrZy9jb21tYW5kcy9zbWVtYmVycy50c1xudmFyIFNNZW1iZXJzQ29tbWFuZCA9IGNsYXNzIGV4dGVuZHMgQ29tbWFuZCB7XG4gIGNvbnN0cnVjdG9yKGNtZCwgb3B0cykge1xuICAgIHN1cGVyKFtcInNtZW1iZXJzXCIsIC4uLmNtZF0sIG9wdHMpO1xuICB9XG59O1xuXG4vLyBwa2cvY29tbWFuZHMvc21pc21lbWJlci50c1xudmFyIFNNSXNNZW1iZXJDb21tYW5kID0gY2xhc3MgZXh0ZW5kcyBDb21tYW5kIHtcbiAgY29uc3RydWN0b3IoY21kLCBvcHRzKSB7XG4gICAgc3VwZXIoW1wic21pc21lbWJlclwiLCBjbWRbMF0sIC4uLmNtZFsxXV0sIG9wdHMpO1xuICB9XG59O1xuXG4vLyBwa2cvY29tbWFuZHMvc21vdmUudHNcbnZhciBTTW92ZUNvbW1hbmQgPSBjbGFzcyBleHRlbmRzIENvbW1hbmQge1xuICBjb25zdHJ1Y3RvcihjbWQsIG9wdHMpIHtcbiAgICBzdXBlcihbXCJzbW92ZVwiLCAuLi5jbWRdLCBvcHRzKTtcbiAgfVxufTtcblxuLy8gcGtnL2NvbW1hbmRzL3Nwb3AudHNcbnZhciBTUG9wQ29tbWFuZCA9IGNsYXNzIGV4dGVuZHMgQ29tbWFuZCB7XG4gIGNvbnN0cnVjdG9yKFtrZXksIGNvdW50XSwgb3B0cykge1xuICAgIGNvbnN0IGNvbW1hbmQgPSBbXCJzcG9wXCIsIGtleV07XG4gICAgaWYgKHR5cGVvZiBjb3VudCA9PT0gXCJudW1iZXJcIikge1xuICAgICAgY29tbWFuZC5wdXNoKGNvdW50KTtcbiAgICB9XG4gICAgc3VwZXIoY29tbWFuZCwgb3B0cyk7XG4gIH1cbn07XG5cbi8vIHBrZy9jb21tYW5kcy9zcmFuZG1lbWJlci50c1xudmFyIFNSYW5kTWVtYmVyQ29tbWFuZCA9IGNsYXNzIGV4dGVuZHMgQ29tbWFuZCB7XG4gIGNvbnN0cnVjdG9yKFtrZXksIGNvdW50XSwgb3B0cykge1xuICAgIGNvbnN0IGNvbW1hbmQgPSBbXCJzcmFuZG1lbWJlclwiLCBrZXldO1xuICAgIGlmICh0eXBlb2YgY291bnQgPT09IFwibnVtYmVyXCIpIHtcbiAgICAgIGNvbW1hbmQucHVzaChjb3VudCk7XG4gICAgfVxuICAgIHN1cGVyKGNvbW1hbmQsIG9wdHMpO1xuICB9XG59O1xuXG4vLyBwa2cvY29tbWFuZHMvc3JlbS50c1xudmFyIFNSZW1Db21tYW5kID0gY2xhc3MgZXh0ZW5kcyBDb21tYW5kIHtcbiAgY29uc3RydWN0b3IoY21kLCBvcHRzKSB7XG4gICAgc3VwZXIoW1wic3JlbVwiLCAuLi5jbWRdLCBvcHRzKTtcbiAgfVxufTtcblxuLy8gcGtnL2NvbW1hbmRzL3NzY2FuLnRzXG52YXIgU1NjYW5Db21tYW5kID0gY2xhc3MgZXh0ZW5kcyBDb21tYW5kIHtcbiAgY29uc3RydWN0b3IoW2tleSwgY3Vyc29yLCBvcHRzXSwgY21kT3B0cykge1xuICAgIGNvbnN0IGNvbW1hbmQgPSBbXCJzc2NhblwiLCBrZXksIGN1cnNvcl07XG4gICAgaWYgKG9wdHM/Lm1hdGNoKSB7XG4gICAgICBjb21tYW5kLnB1c2goXCJtYXRjaFwiLCBvcHRzLm1hdGNoKTtcbiAgICB9XG4gICAgaWYgKHR5cGVvZiBvcHRzPy5jb3VudCA9PT0gXCJudW1iZXJcIikge1xuICAgICAgY29tbWFuZC5wdXNoKFwiY291bnRcIiwgb3B0cy5jb3VudCk7XG4gICAgfVxuICAgIHN1cGVyKGNvbW1hbmQsIHtcbiAgICAgIGRlc2VyaWFsaXplOiBkZXNlcmlhbGl6ZVNjYW5SZXNwb25zZSxcbiAgICAgIC4uLmNtZE9wdHNcbiAgICB9KTtcbiAgfVxufTtcblxuLy8gcGtnL2NvbW1hbmRzL3N0cmxlbi50c1xudmFyIFN0ckxlbkNvbW1hbmQgPSBjbGFzcyBleHRlbmRzIENvbW1hbmQge1xuICBjb25zdHJ1Y3RvcihjbWQsIG9wdHMpIHtcbiAgICBzdXBlcihbXCJzdHJsZW5cIiwgLi4uY21kXSwgb3B0cyk7XG4gIH1cbn07XG5cbi8vIHBrZy9jb21tYW5kcy9zdW5pb24udHNcbnZhciBTVW5pb25Db21tYW5kID0gY2xhc3MgZXh0ZW5kcyBDb21tYW5kIHtcbiAgY29uc3RydWN0b3IoY21kLCBvcHRzKSB7XG4gICAgc3VwZXIoW1wic3VuaW9uXCIsIC4uLmNtZF0sIG9wdHMpO1xuICB9XG59O1xuXG4vLyBwa2cvY29tbWFuZHMvc3VuaW9uc3RvcmUudHNcbnZhciBTVW5pb25TdG9yZUNvbW1hbmQgPSBjbGFzcyBleHRlbmRzIENvbW1hbmQge1xuICBjb25zdHJ1Y3RvcihjbWQsIG9wdHMpIHtcbiAgICBzdXBlcihbXCJzdW5pb25zdG9yZVwiLCAuLi5jbWRdLCBvcHRzKTtcbiAgfVxufTtcblxuLy8gcGtnL2NvbW1hbmRzL3RpbWUudHNcbnZhciBUaW1lQ29tbWFuZCA9IGNsYXNzIGV4dGVuZHMgQ29tbWFuZCB7XG4gIGNvbnN0cnVjdG9yKG9wdHMpIHtcbiAgICBzdXBlcihbXCJ0aW1lXCJdLCBvcHRzKTtcbiAgfVxufTtcblxuLy8gcGtnL2NvbW1hbmRzL3RvdWNoLnRzXG52YXIgVG91Y2hDb21tYW5kID0gY2xhc3MgZXh0ZW5kcyBDb21tYW5kIHtcbiAgY29uc3RydWN0b3IoY21kLCBvcHRzKSB7XG4gICAgc3VwZXIoW1widG91Y2hcIiwgLi4uY21kXSwgb3B0cyk7XG4gIH1cbn07XG5cbi8vIHBrZy9jb21tYW5kcy90dGwudHNcbnZhciBUdGxDb21tYW5kID0gY2xhc3MgZXh0ZW5kcyBDb21tYW5kIHtcbiAgY29uc3RydWN0b3IoY21kLCBvcHRzKSB7XG4gICAgc3VwZXIoW1widHRsXCIsIC4uLmNtZF0sIG9wdHMpO1xuICB9XG59O1xuXG4vLyBwa2cvY29tbWFuZHMvdHlwZS50c1xudmFyIFR5cGVDb21tYW5kID0gY2xhc3MgZXh0ZW5kcyBDb21tYW5kIHtcbiAgY29uc3RydWN0b3IoY21kLCBvcHRzKSB7XG4gICAgc3VwZXIoW1widHlwZVwiLCAuLi5jbWRdLCBvcHRzKTtcbiAgfVxufTtcblxuLy8gcGtnL2NvbW1hbmRzL3VubGluay50c1xudmFyIFVubGlua0NvbW1hbmQgPSBjbGFzcyBleHRlbmRzIENvbW1hbmQge1xuICBjb25zdHJ1Y3RvcihjbWQsIG9wdHMpIHtcbiAgICBzdXBlcihbXCJ1bmxpbmtcIiwgLi4uY21kXSwgb3B0cyk7XG4gIH1cbn07XG5cbi8vIHBrZy9jb21tYW5kcy94YWNrLnRzXG52YXIgWEFja0NvbW1hbmQgPSBjbGFzcyBleHRlbmRzIENvbW1hbmQge1xuICBjb25zdHJ1Y3Rvcihba2V5LCBncm91cCwgaWRdLCBvcHRzKSB7XG4gICAgY29uc3QgaWRzID0gQXJyYXkuaXNBcnJheShpZCkgPyBbLi4uaWRdIDogW2lkXTtcbiAgICBzdXBlcihbXCJYQUNLXCIsIGtleSwgZ3JvdXAsIC4uLmlkc10sIG9wdHMpO1xuICB9XG59O1xuXG4vLyBwa2cvY29tbWFuZHMveGFkZC50c1xudmFyIFhBZGRDb21tYW5kID0gY2xhc3MgZXh0ZW5kcyBDb21tYW5kIHtcbiAgY29uc3RydWN0b3IoW2tleSwgaWQsIGVudHJpZXMsIG9wdHNdLCBjb21tYW5kT3B0aW9ucykge1xuICAgIGNvbnN0IGNvbW1hbmQgPSBbXCJYQUREXCIsIGtleV07XG4gICAgaWYgKG9wdHMpIHtcbiAgICAgIGlmIChvcHRzLm5vbWtTdHJlYW0pIHtcbiAgICAgICAgY29tbWFuZC5wdXNoKFwiTk9NS1NUUkVBTVwiKTtcbiAgICAgIH1cbiAgICAgIGlmIChvcHRzLnRyaW0pIHtcbiAgICAgICAgY29tbWFuZC5wdXNoKG9wdHMudHJpbS50eXBlLCBvcHRzLnRyaW0uY29tcGFyaXNvbiwgb3B0cy50cmltLnRocmVzaG9sZCk7XG4gICAgICAgIGlmIChvcHRzLnRyaW0ubGltaXQgIT09IHZvaWQgMCkge1xuICAgICAgICAgIGNvbW1hbmQucHVzaChcIkxJTUlUXCIsIG9wdHMudHJpbS5saW1pdCk7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9XG4gICAgY29tbWFuZC5wdXNoKGlkKTtcbiAgICBmb3IgKGNvbnN0IFtrLCB2XSBvZiBPYmplY3QuZW50cmllcyhlbnRyaWVzKSkge1xuICAgICAgY29tbWFuZC5wdXNoKGssIHYpO1xuICAgIH1cbiAgICBzdXBlcihjb21tYW5kLCBjb21tYW5kT3B0aW9ucyk7XG4gIH1cbn07XG5cbi8vIHBrZy9jb21tYW5kcy94YXV0b2NsYWltLnRzXG52YXIgWEF1dG9DbGFpbSA9IGNsYXNzIGV4dGVuZHMgQ29tbWFuZCB7XG4gIGNvbnN0cnVjdG9yKFtrZXksIGdyb3VwLCBjb25zdW1lciwgbWluSWRsZVRpbWUsIHN0YXJ0LCBvcHRpb25zXSwgb3B0cykge1xuICAgIGNvbnN0IGNvbW1hbmRzID0gW107XG4gICAgaWYgKG9wdGlvbnM/LmNvdW50KSB7XG4gICAgICBjb21tYW5kcy5wdXNoKFwiQ09VTlRcIiwgb3B0aW9ucy5jb3VudCk7XG4gICAgfVxuICAgIGlmIChvcHRpb25zPy5qdXN0SWQpIHtcbiAgICAgIGNvbW1hbmRzLnB1c2goXCJKVVNUSURcIik7XG4gICAgfVxuICAgIHN1cGVyKFtcIlhBVVRPQ0xBSU1cIiwga2V5LCBncm91cCwgY29uc3VtZXIsIG1pbklkbGVUaW1lLCBzdGFydCwgLi4uY29tbWFuZHNdLCBvcHRzKTtcbiAgfVxufTtcblxuLy8gcGtnL2NvbW1hbmRzL3hjbGFpbS50c1xudmFyIFhDbGFpbUNvbW1hbmQgPSBjbGFzcyBleHRlbmRzIENvbW1hbmQge1xuICBjb25zdHJ1Y3Rvcihba2V5LCBncm91cCwgY29uc3VtZXIsIG1pbklkbGVUaW1lLCBpZCwgb3B0aW9uc10sIG9wdHMpIHtcbiAgICBjb25zdCBpZHMgPSBBcnJheS5pc0FycmF5KGlkKSA/IFsuLi5pZF0gOiBbaWRdO1xuICAgIGNvbnN0IGNvbW1hbmRzID0gW107XG4gICAgaWYgKG9wdGlvbnM/LmlkbGVNUykge1xuICAgICAgY29tbWFuZHMucHVzaChcIklETEVcIiwgb3B0aW9ucy5pZGxlTVMpO1xuICAgIH1cbiAgICBpZiAob3B0aW9ucz8uaWRsZU1TKSB7XG4gICAgICBjb21tYW5kcy5wdXNoKFwiVElNRVwiLCBvcHRpb25zLnRpbWVNUyk7XG4gICAgfVxuICAgIGlmIChvcHRpb25zPy5yZXRyeUNvdW50KSB7XG4gICAgICBjb21tYW5kcy5wdXNoKFwiUkVUUllDT1VOVFwiLCBvcHRpb25zLnJldHJ5Q291bnQpO1xuICAgIH1cbiAgICBpZiAob3B0aW9ucz8uZm9yY2UpIHtcbiAgICAgIGNvbW1hbmRzLnB1c2goXCJGT1JDRVwiKTtcbiAgICB9XG4gICAgaWYgKG9wdGlvbnM/Lmp1c3RJZCkge1xuICAgICAgY29tbWFuZHMucHVzaChcIkpVU1RJRFwiKTtcbiAgICB9XG4gICAgaWYgKG9wdGlvbnM/Lmxhc3RJZCkge1xuICAgICAgY29tbWFuZHMucHVzaChcIkxBU1RJRFwiLCBvcHRpb25zLmxhc3RJZCk7XG4gICAgfVxuICAgIHN1cGVyKFtcIlhDTEFJTVwiLCBrZXksIGdyb3VwLCBjb25zdW1lciwgbWluSWRsZVRpbWUsIC4uLmlkcywgLi4uY29tbWFuZHNdLCBvcHRzKTtcbiAgfVxufTtcblxuLy8gcGtnL2NvbW1hbmRzL3hkZWwudHNcbnZhciBYRGVsQ29tbWFuZCA9IGNsYXNzIGV4dGVuZHMgQ29tbWFuZCB7XG4gIGNvbnN0cnVjdG9yKFtrZXksIGlkc10sIG9wdHMpIHtcbiAgICBjb25zdCBjbWRzID0gQXJyYXkuaXNBcnJheShpZHMpID8gWy4uLmlkc10gOiBbaWRzXTtcbiAgICBzdXBlcihbXCJYREVMXCIsIGtleSwgLi4uY21kc10sIG9wdHMpO1xuICB9XG59O1xuXG4vLyBwa2cvY29tbWFuZHMveGdyb3VwLnRzXG52YXIgWEdyb3VwQ29tbWFuZCA9IGNsYXNzIGV4dGVuZHMgQ29tbWFuZCB7XG4gIGNvbnN0cnVjdG9yKFtrZXksIG9wdHNdLCBjb21tYW5kT3B0aW9ucykge1xuICAgIGNvbnN0IGNvbW1hbmQgPSBbXCJYR1JPVVBcIl07XG4gICAgc3dpdGNoIChvcHRzLnR5cGUpIHtcbiAgICAgIGNhc2UgXCJDUkVBVEVcIjoge1xuICAgICAgICBjb21tYW5kLnB1c2goXCJDUkVBVEVcIiwga2V5LCBvcHRzLmdyb3VwLCBvcHRzLmlkKTtcbiAgICAgICAgaWYgKG9wdHMub3B0aW9ucykge1xuICAgICAgICAgIGlmIChvcHRzLm9wdGlvbnMuTUtTVFJFQU0pIHtcbiAgICAgICAgICAgIGNvbW1hbmQucHVzaChcIk1LU1RSRUFNXCIpO1xuICAgICAgICAgIH1cbiAgICAgICAgICBpZiAob3B0cy5vcHRpb25zLkVOVFJJRVNSRUFEICE9PSB2b2lkIDApIHtcbiAgICAgICAgICAgIGNvbW1hbmQucHVzaChcIkVOVFJJRVNSRUFEXCIsIG9wdHMub3B0aW9ucy5FTlRSSUVTUkVBRC50b1N0cmluZygpKTtcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgYnJlYWs7XG4gICAgICB9XG4gICAgICBjYXNlIFwiQ1JFQVRFQ09OU1VNRVJcIjoge1xuICAgICAgICBjb21tYW5kLnB1c2goXCJDUkVBVEVDT05TVU1FUlwiLCBrZXksIG9wdHMuZ3JvdXAsIG9wdHMuY29uc3VtZXIpO1xuICAgICAgICBicmVhaztcbiAgICAgIH1cbiAgICAgIGNhc2UgXCJERUxDT05TVU1FUlwiOiB7XG4gICAgICAgIGNvbW1hbmQucHVzaChcIkRFTENPTlNVTUVSXCIsIGtleSwgb3B0cy5ncm91cCwgb3B0cy5jb25zdW1lcik7XG4gICAgICAgIGJyZWFrO1xuICAgICAgfVxuICAgICAgY2FzZSBcIkRFU1RST1lcIjoge1xuICAgICAgICBjb21tYW5kLnB1c2goXCJERVNUUk9ZXCIsIGtleSwgb3B0cy5ncm91cCk7XG4gICAgICAgIGJyZWFrO1xuICAgICAgfVxuICAgICAgY2FzZSBcIlNFVElEXCI6IHtcbiAgICAgICAgY29tbWFuZC5wdXNoKFwiU0VUSURcIiwga2V5LCBvcHRzLmdyb3VwLCBvcHRzLmlkKTtcbiAgICAgICAgaWYgKG9wdHMub3B0aW9ucz8uRU5UUklFU1JFQUQgIT09IHZvaWQgMCkge1xuICAgICAgICAgIGNvbW1hbmQucHVzaChcIkVOVFJJRVNSRUFEXCIsIG9wdHMub3B0aW9ucy5FTlRSSUVTUkVBRC50b1N0cmluZygpKTtcbiAgICAgICAgfVxuICAgICAgICBicmVhaztcbiAgICAgIH1cbiAgICAgIGRlZmF1bHQ6IHtcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiSW52YWxpZCBYR1JPVVBcIik7XG4gICAgICB9XG4gICAgfVxuICAgIHN1cGVyKGNvbW1hbmQsIGNvbW1hbmRPcHRpb25zKTtcbiAgfVxufTtcblxuLy8gcGtnL2NvbW1hbmRzL3hpbmZvLnRzXG52YXIgWEluZm9Db21tYW5kID0gY2xhc3MgZXh0ZW5kcyBDb21tYW5kIHtcbiAgY29uc3RydWN0b3IoW2tleSwgb3B0aW9uc10sIG9wdHMpIHtcbiAgICBjb25zdCBjbWRzID0gW107XG4gICAgaWYgKG9wdGlvbnMudHlwZSA9PT0gXCJDT05TVU1FUlNcIikge1xuICAgICAgY21kcy5wdXNoKFwiQ09OU1VNRVJTXCIsIGtleSwgb3B0aW9ucy5ncm91cCk7XG4gICAgfSBlbHNlIHtcbiAgICAgIGNtZHMucHVzaChcIkdST1VQU1wiLCBrZXkpO1xuICAgIH1cbiAgICBzdXBlcihbXCJYSU5GT1wiLCAuLi5jbWRzXSwgb3B0cyk7XG4gIH1cbn07XG5cbi8vIHBrZy9jb21tYW5kcy94bGVuLnRzXG52YXIgWExlbkNvbW1hbmQgPSBjbGFzcyBleHRlbmRzIENvbW1hbmQge1xuICBjb25zdHJ1Y3RvcihjbWQsIG9wdHMpIHtcbiAgICBzdXBlcihbXCJYTEVOXCIsIC4uLmNtZF0sIG9wdHMpO1xuICB9XG59O1xuXG4vLyBwa2cvY29tbWFuZHMveHBlbmRpbmcudHNcbnZhciBYUGVuZGluZ0NvbW1hbmQgPSBjbGFzcyBleHRlbmRzIENvbW1hbmQge1xuICBjb25zdHJ1Y3Rvcihba2V5LCBncm91cCwgc3RhcnQsIGVuZCwgY291bnQsIG9wdGlvbnNdLCBvcHRzKSB7XG4gICAgY29uc3QgY29uc3VtZXJzID0gb3B0aW9ucz8uY29uc3VtZXIgPT09IHZvaWQgMCA/IFtdIDogQXJyYXkuaXNBcnJheShvcHRpb25zLmNvbnN1bWVyKSA/IFsuLi5vcHRpb25zLmNvbnN1bWVyXSA6IFtvcHRpb25zLmNvbnN1bWVyXTtcbiAgICBzdXBlcihcbiAgICAgIFtcbiAgICAgICAgXCJYUEVORElOR1wiLFxuICAgICAgICBrZXksXG4gICAgICAgIGdyb3VwLFxuICAgICAgICAuLi5vcHRpb25zPy5pZGxlVGltZSA/IFtcIklETEVcIiwgb3B0aW9ucy5pZGxlVGltZV0gOiBbXSxcbiAgICAgICAgc3RhcnQsXG4gICAgICAgIGVuZCxcbiAgICAgICAgY291bnQsXG4gICAgICAgIC4uLmNvbnN1bWVyc1xuICAgICAgXSxcbiAgICAgIG9wdHNcbiAgICApO1xuICB9XG59O1xuXG4vLyBwa2cvY29tbWFuZHMveHJhbmdlLnRzXG5mdW5jdGlvbiBkZXNlcmlhbGl6ZTQocmVzdWx0KSB7XG4gIGNvbnN0IG9iaiA9IHt9O1xuICBmb3IgKGNvbnN0IGUgb2YgcmVzdWx0KSB7XG4gICAgZm9yIChsZXQgaSA9IDA7IGkgPCBlLmxlbmd0aDsgaSArPSAyKSB7XG4gICAgICBjb25zdCBzdHJlYW1JZCA9IGVbaV07XG4gICAgICBjb25zdCBlbnRyaWVzID0gZVtpICsgMV07XG4gICAgICBpZiAoIShzdHJlYW1JZCBpbiBvYmopKSB7XG4gICAgICAgIG9ialtzdHJlYW1JZF0gPSB7fTtcbiAgICAgIH1cbiAgICAgIGZvciAobGV0IGogPSAwOyBqIDwgZW50cmllcy5sZW5ndGg7IGogKz0gMikge1xuICAgICAgICBjb25zdCBmaWVsZCA9IGVudHJpZXNbal07XG4gICAgICAgIGNvbnN0IHZhbHVlID0gZW50cmllc1tqICsgMV07XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgb2JqW3N0cmVhbUlkXVtmaWVsZF0gPSBKU09OLnBhcnNlKHZhbHVlKTtcbiAgICAgICAgfSBjYXRjaCB7XG4gICAgICAgICAgb2JqW3N0cmVhbUlkXVtmaWVsZF0gPSB2YWx1ZTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH1cbiAgfVxuICByZXR1cm4gb2JqO1xufVxudmFyIFhSYW5nZUNvbW1hbmQgPSBjbGFzcyBleHRlbmRzIENvbW1hbmQge1xuICBjb25zdHJ1Y3Rvcihba2V5LCBzdGFydCwgZW5kLCBjb3VudF0sIG9wdHMpIHtcbiAgICBjb25zdCBjb21tYW5kID0gW1wiWFJBTkdFXCIsIGtleSwgc3RhcnQsIGVuZF07XG4gICAgaWYgKHR5cGVvZiBjb3VudCA9PT0gXCJudW1iZXJcIikge1xuICAgICAgY29tbWFuZC5wdXNoKFwiQ09VTlRcIiwgY291bnQpO1xuICAgIH1cbiAgICBzdXBlcihjb21tYW5kLCB7XG4gICAgICBkZXNlcmlhbGl6ZTogKHJlc3VsdCkgPT4gZGVzZXJpYWxpemU0KHJlc3VsdCksXG4gICAgICAuLi5vcHRzXG4gICAgfSk7XG4gIH1cbn07XG5cbi8vIHBrZy9jb21tYW5kcy94cmVhZC50c1xudmFyIFVOQkFMQU5DRURfWFJFQURfRVJSID0gXCJFUlIgVW5iYWxhbmNlZCBYUkVBRCBsaXN0IG9mIHN0cmVhbXM6IGZvciBlYWNoIHN0cmVhbSBrZXkgYW4gSUQgb3IgJyQnIG11c3QgYmUgc3BlY2lmaWVkXCI7XG52YXIgWFJlYWRDb21tYW5kID0gY2xhc3MgZXh0ZW5kcyBDb21tYW5kIHtcbiAgY29uc3RydWN0b3IoW2tleSwgaWQsIG9wdGlvbnNdLCBvcHRzKSB7XG4gICAgaWYgKEFycmF5LmlzQXJyYXkoa2V5KSAmJiBBcnJheS5pc0FycmF5KGlkKSAmJiBrZXkubGVuZ3RoICE9PSBpZC5sZW5ndGgpIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcihVTkJBTEFOQ0VEX1hSRUFEX0VSUik7XG4gICAgfVxuICAgIGNvbnN0IGNvbW1hbmRzID0gW107XG4gICAgaWYgKHR5cGVvZiBvcHRpb25zPy5jb3VudCA9PT0gXCJudW1iZXJcIikge1xuICAgICAgY29tbWFuZHMucHVzaChcIkNPVU5UXCIsIG9wdGlvbnMuY291bnQpO1xuICAgIH1cbiAgICBpZiAodHlwZW9mIG9wdGlvbnM/LmJsb2NrTVMgPT09IFwibnVtYmVyXCIpIHtcbiAgICAgIGNvbW1hbmRzLnB1c2goXCJCTE9DS1wiLCBvcHRpb25zLmJsb2NrTVMpO1xuICAgIH1cbiAgICBjb21tYW5kcy5wdXNoKFxuICAgICAgXCJTVFJFQU1TXCIsXG4gICAgICAuLi5BcnJheS5pc0FycmF5KGtleSkgPyBbLi4ua2V5XSA6IFtrZXldLFxuICAgICAgLi4uQXJyYXkuaXNBcnJheShpZCkgPyBbLi4uaWRdIDogW2lkXVxuICAgICk7XG4gICAgc3VwZXIoW1wiWFJFQURcIiwgLi4uY29tbWFuZHNdLCBvcHRzKTtcbiAgfVxufTtcblxuLy8gcGtnL2NvbW1hbmRzL3hyZWFkZ3JvdXAudHNcbnZhciBVTkJBTEFOQ0VEX1hSRUFER1JPVVBfRVJSID0gXCJFUlIgVW5iYWxhbmNlZCBYUkVBREdST1VQIGxpc3Qgb2Ygc3RyZWFtczogZm9yIGVhY2ggc3RyZWFtIGtleSBhbiBJRCBvciAnJCcgbXVzdCBiZSBzcGVjaWZpZWRcIjtcbnZhciBYUmVhZEdyb3VwQ29tbWFuZCA9IGNsYXNzIGV4dGVuZHMgQ29tbWFuZCB7XG4gIGNvbnN0cnVjdG9yKFtncm91cCwgY29uc3VtZXIsIGtleSwgaWQsIG9wdGlvbnNdLCBvcHRzKSB7XG4gICAgaWYgKEFycmF5LmlzQXJyYXkoa2V5KSAmJiBBcnJheS5pc0FycmF5KGlkKSAmJiBrZXkubGVuZ3RoICE9PSBpZC5sZW5ndGgpIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcihVTkJBTEFOQ0VEX1hSRUFER1JPVVBfRVJSKTtcbiAgICB9XG4gICAgY29uc3QgY29tbWFuZHMgPSBbXTtcbiAgICBpZiAodHlwZW9mIG9wdGlvbnM/LmNvdW50ID09PSBcIm51bWJlclwiKSB7XG4gICAgICBjb21tYW5kcy5wdXNoKFwiQ09VTlRcIiwgb3B0aW9ucy5jb3VudCk7XG4gICAgfVxuICAgIGlmICh0eXBlb2Ygb3B0aW9ucz8uYmxvY2tNUyA9PT0gXCJudW1iZXJcIikge1xuICAgICAgY29tbWFuZHMucHVzaChcIkJMT0NLXCIsIG9wdGlvbnMuYmxvY2tNUyk7XG4gICAgfVxuICAgIGlmICh0eXBlb2Ygb3B0aW9ucz8uTk9BQ0sgPT09IFwiYm9vbGVhblwiICYmIG9wdGlvbnMuTk9BQ0spIHtcbiAgICAgIGNvbW1hbmRzLnB1c2goXCJOT0FDS1wiKTtcbiAgICB9XG4gICAgY29tbWFuZHMucHVzaChcbiAgICAgIFwiU1RSRUFNU1wiLFxuICAgICAgLi4uQXJyYXkuaXNBcnJheShrZXkpID8gWy4uLmtleV0gOiBba2V5XSxcbiAgICAgIC4uLkFycmF5LmlzQXJyYXkoaWQpID8gWy4uLmlkXSA6IFtpZF1cbiAgICApO1xuICAgIHN1cGVyKFtcIlhSRUFER1JPVVBcIiwgXCJHUk9VUFwiLCBncm91cCwgY29uc3VtZXIsIC4uLmNvbW1hbmRzXSwgb3B0cyk7XG4gIH1cbn07XG5cbi8vIHBrZy9jb21tYW5kcy94cmV2cmFuZ2UudHNcbnZhciBYUmV2UmFuZ2VDb21tYW5kID0gY2xhc3MgZXh0ZW5kcyBDb21tYW5kIHtcbiAgY29uc3RydWN0b3IoW2tleSwgZW5kLCBzdGFydCwgY291bnRdLCBvcHRzKSB7XG4gICAgY29uc3QgY29tbWFuZCA9IFtcIlhSRVZSQU5HRVwiLCBrZXksIGVuZCwgc3RhcnRdO1xuICAgIGlmICh0eXBlb2YgY291bnQgPT09IFwibnVtYmVyXCIpIHtcbiAgICAgIGNvbW1hbmQucHVzaChcIkNPVU5UXCIsIGNvdW50KTtcbiAgICB9XG4gICAgc3VwZXIoY29tbWFuZCwge1xuICAgICAgZGVzZXJpYWxpemU6IChyZXN1bHQpID0+IGRlc2VyaWFsaXplNShyZXN1bHQpLFxuICAgICAgLi4ub3B0c1xuICAgIH0pO1xuICB9XG59O1xuZnVuY3Rpb24gZGVzZXJpYWxpemU1KHJlc3VsdCkge1xuICBjb25zdCBvYmogPSB7fTtcbiAgZm9yIChjb25zdCBlIG9mIHJlc3VsdCkge1xuICAgIGZvciAobGV0IGkgPSAwOyBpIDwgZS5sZW5ndGg7IGkgKz0gMikge1xuICAgICAgY29uc3Qgc3RyZWFtSWQgPSBlW2ldO1xuICAgICAgY29uc3QgZW50cmllcyA9IGVbaSArIDFdO1xuICAgICAgaWYgKCEoc3RyZWFtSWQgaW4gb2JqKSkge1xuICAgICAgICBvYmpbc3RyZWFtSWRdID0ge307XG4gICAgICB9XG4gICAgICBmb3IgKGxldCBqID0gMDsgaiA8IGVudHJpZXMubGVuZ3RoOyBqICs9IDIpIHtcbiAgICAgICAgY29uc3QgZmllbGQgPSBlbnRyaWVzW2pdO1xuICAgICAgICBjb25zdCB2YWx1ZSA9IGVudHJpZXNbaiArIDFdO1xuICAgICAgICB0cnkge1xuICAgICAgICAgIG9ialtzdHJlYW1JZF1bZmllbGRdID0gSlNPTi5wYXJzZSh2YWx1ZSk7XG4gICAgICAgIH0gY2F0Y2gge1xuICAgICAgICAgIG9ialtzdHJlYW1JZF1bZmllbGRdID0gdmFsdWU7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9XG4gIH1cbiAgcmV0dXJuIG9iajtcbn1cblxuLy8gcGtnL2NvbW1hbmRzL3h0cmltLnRzXG52YXIgWFRyaW1Db21tYW5kID0gY2xhc3MgZXh0ZW5kcyBDb21tYW5kIHtcbiAgY29uc3RydWN0b3IoW2tleSwgb3B0aW9uc10sIG9wdHMpIHtcbiAgICBjb25zdCB7IGxpbWl0LCBzdHJhdGVneSwgdGhyZXNob2xkLCBleGFjdG5lc3MgPSBcIn5cIiB9ID0gb3B0aW9ucztcbiAgICBzdXBlcihbXCJYVFJJTVwiLCBrZXksIHN0cmF0ZWd5LCBleGFjdG5lc3MsIHRocmVzaG9sZCwgLi4ubGltaXQgPyBbXCJMSU1JVFwiLCBsaW1pdF0gOiBbXV0sIG9wdHMpO1xuICB9XG59O1xuXG4vLyBwa2cvY29tbWFuZHMvemFkZC50c1xudmFyIFpBZGRDb21tYW5kID0gY2xhc3MgZXh0ZW5kcyBDb21tYW5kIHtcbiAgY29uc3RydWN0b3IoW2tleSwgYXJnMSwgLi4uYXJnMl0sIG9wdHMpIHtcbiAgICBjb25zdCBjb21tYW5kID0gW1wiemFkZFwiLCBrZXldO1xuICAgIGlmIChcIm54XCIgaW4gYXJnMSAmJiBhcmcxLm54KSB7XG4gICAgICBjb21tYW5kLnB1c2goXCJueFwiKTtcbiAgICB9IGVsc2UgaWYgKFwieHhcIiBpbiBhcmcxICYmIGFyZzEueHgpIHtcbiAgICAgIGNvbW1hbmQucHVzaChcInh4XCIpO1xuICAgIH1cbiAgICBpZiAoXCJjaFwiIGluIGFyZzEgJiYgYXJnMS5jaCkge1xuICAgICAgY29tbWFuZC5wdXNoKFwiY2hcIik7XG4gICAgfVxuICAgIGlmIChcImluY3JcIiBpbiBhcmcxICYmIGFyZzEuaW5jcikge1xuICAgICAgY29tbWFuZC5wdXNoKFwiaW5jclwiKTtcbiAgICB9XG4gICAgaWYgKFwibHRcIiBpbiBhcmcxICYmIGFyZzEubHQpIHtcbiAgICAgIGNvbW1hbmQucHVzaChcImx0XCIpO1xuICAgIH0gZWxzZSBpZiAoXCJndFwiIGluIGFyZzEgJiYgYXJnMS5ndCkge1xuICAgICAgY29tbWFuZC5wdXNoKFwiZ3RcIik7XG4gICAgfVxuICAgIGlmIChcInNjb3JlXCIgaW4gYXJnMSAmJiBcIm1lbWJlclwiIGluIGFyZzEpIHtcbiAgICAgIGNvbW1hbmQucHVzaChhcmcxLnNjb3JlLCBhcmcxLm1lbWJlcik7XG4gICAgfVxuICAgIGNvbW1hbmQucHVzaCguLi5hcmcyLmZsYXRNYXAoKHsgc2NvcmUsIG1lbWJlciB9KSA9PiBbc2NvcmUsIG1lbWJlcl0pKTtcbiAgICBzdXBlcihjb21tYW5kLCBvcHRzKTtcbiAgfVxufTtcblxuLy8gcGtnL2NvbW1hbmRzL3pjYXJkLnRzXG52YXIgWkNhcmRDb21tYW5kID0gY2xhc3MgZXh0ZW5kcyBDb21tYW5kIHtcbiAgY29uc3RydWN0b3IoY21kLCBvcHRzKSB7XG4gICAgc3VwZXIoW1wiemNhcmRcIiwgLi4uY21kXSwgb3B0cyk7XG4gIH1cbn07XG5cbi8vIHBrZy9jb21tYW5kcy96Y291bnQudHNcbnZhciBaQ291bnRDb21tYW5kID0gY2xhc3MgZXh0ZW5kcyBDb21tYW5kIHtcbiAgY29uc3RydWN0b3IoY21kLCBvcHRzKSB7XG4gICAgc3VwZXIoW1wiemNvdW50XCIsIC4uLmNtZF0sIG9wdHMpO1xuICB9XG59O1xuXG4vLyBwa2cvY29tbWFuZHMvemluY3JieS50c1xudmFyIFpJbmNyQnlDb21tYW5kID0gY2xhc3MgZXh0ZW5kcyBDb21tYW5kIHtcbiAgY29uc3RydWN0b3IoY21kLCBvcHRzKSB7XG4gICAgc3VwZXIoW1wiemluY3JieVwiLCAuLi5jbWRdLCBvcHRzKTtcbiAgfVxufTtcblxuLy8gcGtnL2NvbW1hbmRzL3ppbnRlcnN0b3JlLnRzXG52YXIgWkludGVyU3RvcmVDb21tYW5kID0gY2xhc3MgZXh0ZW5kcyBDb21tYW5kIHtcbiAgY29uc3RydWN0b3IoW2Rlc3RpbmF0aW9uLCBudW1LZXlzLCBrZXlPcktleXMsIG9wdHNdLCBjbWRPcHRzKSB7XG4gICAgY29uc3QgY29tbWFuZCA9IFtcInppbnRlcnN0b3JlXCIsIGRlc3RpbmF0aW9uLCBudW1LZXlzXTtcbiAgICBpZiAoQXJyYXkuaXNBcnJheShrZXlPcktleXMpKSB7XG4gICAgICBjb21tYW5kLnB1c2goLi4ua2V5T3JLZXlzKTtcbiAgICB9IGVsc2Uge1xuICAgICAgY29tbWFuZC5wdXNoKGtleU9yS2V5cyk7XG4gICAgfVxuICAgIGlmIChvcHRzKSB7XG4gICAgICBpZiAoXCJ3ZWlnaHRzXCIgaW4gb3B0cyAmJiBvcHRzLndlaWdodHMpIHtcbiAgICAgICAgY29tbWFuZC5wdXNoKFwid2VpZ2h0c1wiLCAuLi5vcHRzLndlaWdodHMpO1xuICAgICAgfSBlbHNlIGlmIChcIndlaWdodFwiIGluIG9wdHMgJiYgdHlwZW9mIG9wdHMud2VpZ2h0ID09PSBcIm51bWJlclwiKSB7XG4gICAgICAgIGNvbW1hbmQucHVzaChcIndlaWdodHNcIiwgb3B0cy53ZWlnaHQpO1xuICAgICAgfVxuICAgICAgaWYgKFwiYWdncmVnYXRlXCIgaW4gb3B0cykge1xuICAgICAgICBjb21tYW5kLnB1c2goXCJhZ2dyZWdhdGVcIiwgb3B0cy5hZ2dyZWdhdGUpO1xuICAgICAgfVxuICAgIH1cbiAgICBzdXBlcihjb21tYW5kLCBjbWRPcHRzKTtcbiAgfVxufTtcblxuLy8gcGtnL2NvbW1hbmRzL3psZXhjb3VudC50c1xudmFyIFpMZXhDb3VudENvbW1hbmQgPSBjbGFzcyBleHRlbmRzIENvbW1hbmQge1xuICBjb25zdHJ1Y3RvcihjbWQsIG9wdHMpIHtcbiAgICBzdXBlcihbXCJ6bGV4Y291bnRcIiwgLi4uY21kXSwgb3B0cyk7XG4gIH1cbn07XG5cbi8vIHBrZy9jb21tYW5kcy96cG9wbWF4LnRzXG52YXIgWlBvcE1heENvbW1hbmQgPSBjbGFzcyBleHRlbmRzIENvbW1hbmQge1xuICBjb25zdHJ1Y3Rvcihba2V5LCBjb3VudF0sIG9wdHMpIHtcbiAgICBjb25zdCBjb21tYW5kID0gW1wienBvcG1heFwiLCBrZXldO1xuICAgIGlmICh0eXBlb2YgY291bnQgPT09IFwibnVtYmVyXCIpIHtcbiAgICAgIGNvbW1hbmQucHVzaChjb3VudCk7XG4gICAgfVxuICAgIHN1cGVyKGNvbW1hbmQsIG9wdHMpO1xuICB9XG59O1xuXG4vLyBwa2cvY29tbWFuZHMvenBvcG1pbi50c1xudmFyIFpQb3BNaW5Db21tYW5kID0gY2xhc3MgZXh0ZW5kcyBDb21tYW5kIHtcbiAgY29uc3RydWN0b3IoW2tleSwgY291bnRdLCBvcHRzKSB7XG4gICAgY29uc3QgY29tbWFuZCA9IFtcInpwb3BtaW5cIiwga2V5XTtcbiAgICBpZiAodHlwZW9mIGNvdW50ID09PSBcIm51bWJlclwiKSB7XG4gICAgICBjb21tYW5kLnB1c2goY291bnQpO1xuICAgIH1cbiAgICBzdXBlcihjb21tYW5kLCBvcHRzKTtcbiAgfVxufTtcblxuLy8gcGtnL2NvbW1hbmRzL3pyYW5nZS50c1xudmFyIFpSYW5nZUNvbW1hbmQgPSBjbGFzcyBleHRlbmRzIENvbW1hbmQge1xuICBjb25zdHJ1Y3Rvcihba2V5LCBtaW4sIG1heCwgb3B0c10sIGNtZE9wdHMpIHtcbiAgICBjb25zdCBjb21tYW5kID0gW1wienJhbmdlXCIsIGtleSwgbWluLCBtYXhdO1xuICAgIGlmIChvcHRzPy5ieVNjb3JlKSB7XG4gICAgICBjb21tYW5kLnB1c2goXCJieXNjb3JlXCIpO1xuICAgIH1cbiAgICBpZiAob3B0cz8uYnlMZXgpIHtcbiAgICAgIGNvbW1hbmQucHVzaChcImJ5bGV4XCIpO1xuICAgIH1cbiAgICBpZiAob3B0cz8ucmV2KSB7XG4gICAgICBjb21tYW5kLnB1c2goXCJyZXZcIik7XG4gICAgfVxuICAgIGlmIChvcHRzPy5jb3VudCAhPT0gdm9pZCAwICYmIG9wdHMub2Zmc2V0ICE9PSB2b2lkIDApIHtcbiAgICAgIGNvbW1hbmQucHVzaChcImxpbWl0XCIsIG9wdHMub2Zmc2V0LCBvcHRzLmNvdW50KTtcbiAgICB9XG4gICAgaWYgKG9wdHM/LndpdGhTY29yZXMpIHtcbiAgICAgIGNvbW1hbmQucHVzaChcIndpdGhzY29yZXNcIik7XG4gICAgfVxuICAgIHN1cGVyKGNvbW1hbmQsIGNtZE9wdHMpO1xuICB9XG59O1xuXG4vLyBwa2cvY29tbWFuZHMvenJhbmsudHNcbnZhciBaUmFua0NvbW1hbmQgPSBjbGFzcyBleHRlbmRzIENvbW1hbmQge1xuICBjb25zdHJ1Y3RvcihjbWQsIG9wdHMpIHtcbiAgICBzdXBlcihbXCJ6cmFua1wiLCAuLi5jbWRdLCBvcHRzKTtcbiAgfVxufTtcblxuLy8gcGtnL2NvbW1hbmRzL3pyZW0udHNcbnZhciBaUmVtQ29tbWFuZCA9IGNsYXNzIGV4dGVuZHMgQ29tbWFuZCB7XG4gIGNvbnN0cnVjdG9yKGNtZCwgb3B0cykge1xuICAgIHN1cGVyKFtcInpyZW1cIiwgLi4uY21kXSwgb3B0cyk7XG4gIH1cbn07XG5cbi8vIHBrZy9jb21tYW5kcy96cmVtcmFuZ2VieWxleC50c1xudmFyIFpSZW1SYW5nZUJ5TGV4Q29tbWFuZCA9IGNsYXNzIGV4dGVuZHMgQ29tbWFuZCB7XG4gIGNvbnN0cnVjdG9yKGNtZCwgb3B0cykge1xuICAgIHN1cGVyKFtcInpyZW1yYW5nZWJ5bGV4XCIsIC4uLmNtZF0sIG9wdHMpO1xuICB9XG59O1xuXG4vLyBwa2cvY29tbWFuZHMvenJlbXJhbmdlYnlyYW5rLnRzXG52YXIgWlJlbVJhbmdlQnlSYW5rQ29tbWFuZCA9IGNsYXNzIGV4dGVuZHMgQ29tbWFuZCB7XG4gIGNvbnN0cnVjdG9yKGNtZCwgb3B0cykge1xuICAgIHN1cGVyKFtcInpyZW1yYW5nZWJ5cmFua1wiLCAuLi5jbWRdLCBvcHRzKTtcbiAgfVxufTtcblxuLy8gcGtnL2NvbW1hbmRzL3pyZW1yYW5nZWJ5c2NvcmUudHNcbnZhciBaUmVtUmFuZ2VCeVNjb3JlQ29tbWFuZCA9IGNsYXNzIGV4dGVuZHMgQ29tbWFuZCB7XG4gIGNvbnN0cnVjdG9yKGNtZCwgb3B0cykge1xuICAgIHN1cGVyKFtcInpyZW1yYW5nZWJ5c2NvcmVcIiwgLi4uY21kXSwgb3B0cyk7XG4gIH1cbn07XG5cbi8vIHBrZy9jb21tYW5kcy96cmV2cmFuay50c1xudmFyIFpSZXZSYW5rQ29tbWFuZCA9IGNsYXNzIGV4dGVuZHMgQ29tbWFuZCB7XG4gIGNvbnN0cnVjdG9yKGNtZCwgb3B0cykge1xuICAgIHN1cGVyKFtcInpyZXZyYW5rXCIsIC4uLmNtZF0sIG9wdHMpO1xuICB9XG59O1xuXG4vLyBwa2cvY29tbWFuZHMvenNjYW4udHNcbnZhciBaU2NhbkNvbW1hbmQgPSBjbGFzcyBleHRlbmRzIENvbW1hbmQge1xuICBjb25zdHJ1Y3Rvcihba2V5LCBjdXJzb3IsIG9wdHNdLCBjbWRPcHRzKSB7XG4gICAgY29uc3QgY29tbWFuZCA9IFtcInpzY2FuXCIsIGtleSwgY3Vyc29yXTtcbiAgICBpZiAob3B0cz8ubWF0Y2gpIHtcbiAgICAgIGNvbW1hbmQucHVzaChcIm1hdGNoXCIsIG9wdHMubWF0Y2gpO1xuICAgIH1cbiAgICBpZiAodHlwZW9mIG9wdHM/LmNvdW50ID09PSBcIm51bWJlclwiKSB7XG4gICAgICBjb21tYW5kLnB1c2goXCJjb3VudFwiLCBvcHRzLmNvdW50KTtcbiAgICB9XG4gICAgc3VwZXIoY29tbWFuZCwge1xuICAgICAgZGVzZXJpYWxpemU6IGRlc2VyaWFsaXplU2NhblJlc3BvbnNlLFxuICAgICAgLi4uY21kT3B0c1xuICAgIH0pO1xuICB9XG59O1xuXG4vLyBwa2cvY29tbWFuZHMvenNjb3JlLnRzXG52YXIgWlNjb3JlQ29tbWFuZCA9IGNsYXNzIGV4dGVuZHMgQ29tbWFuZCB7XG4gIGNvbnN0cnVjdG9yKGNtZCwgb3B0cykge1xuICAgIHN1cGVyKFtcInpzY29yZVwiLCAuLi5jbWRdLCBvcHRzKTtcbiAgfVxufTtcblxuLy8gcGtnL2NvbW1hbmRzL3p1bmlvbi50c1xudmFyIFpVbmlvbkNvbW1hbmQgPSBjbGFzcyBleHRlbmRzIENvbW1hbmQge1xuICBjb25zdHJ1Y3RvcihbbnVtS2V5cywga2V5T3JLZXlzLCBvcHRzXSwgY21kT3B0cykge1xuICAgIGNvbnN0IGNvbW1hbmQgPSBbXCJ6dW5pb25cIiwgbnVtS2V5c107XG4gICAgaWYgKEFycmF5LmlzQXJyYXkoa2V5T3JLZXlzKSkge1xuICAgICAgY29tbWFuZC5wdXNoKC4uLmtleU9yS2V5cyk7XG4gICAgfSBlbHNlIHtcbiAgICAgIGNvbW1hbmQucHVzaChrZXlPcktleXMpO1xuICAgIH1cbiAgICBpZiAob3B0cykge1xuICAgICAgaWYgKFwid2VpZ2h0c1wiIGluIG9wdHMgJiYgb3B0cy53ZWlnaHRzKSB7XG4gICAgICAgIGNvbW1hbmQucHVzaChcIndlaWdodHNcIiwgLi4ub3B0cy53ZWlnaHRzKTtcbiAgICAgIH0gZWxzZSBpZiAoXCJ3ZWlnaHRcIiBpbiBvcHRzICYmIHR5cGVvZiBvcHRzLndlaWdodCA9PT0gXCJudW1iZXJcIikge1xuICAgICAgICBjb21tYW5kLnB1c2goXCJ3ZWlnaHRzXCIsIG9wdHMud2VpZ2h0KTtcbiAgICAgIH1cbiAgICAgIGlmIChcImFnZ3JlZ2F0ZVwiIGluIG9wdHMpIHtcbiAgICAgICAgY29tbWFuZC5wdXNoKFwiYWdncmVnYXRlXCIsIG9wdHMuYWdncmVnYXRlKTtcbiAgICAgIH1cbiAgICAgIGlmIChvcHRzLndpdGhTY29yZXMpIHtcbiAgICAgICAgY29tbWFuZC5wdXNoKFwid2l0aHNjb3Jlc1wiKTtcbiAgICAgIH1cbiAgICB9XG4gICAgc3VwZXIoY29tbWFuZCwgY21kT3B0cyk7XG4gIH1cbn07XG5cbi8vIHBrZy9jb21tYW5kcy96dW5pb25zdG9yZS50c1xudmFyIFpVbmlvblN0b3JlQ29tbWFuZCA9IGNsYXNzIGV4dGVuZHMgQ29tbWFuZCB7XG4gIGNvbnN0cnVjdG9yKFtkZXN0aW5hdGlvbiwgbnVtS2V5cywga2V5T3JLZXlzLCBvcHRzXSwgY21kT3B0cykge1xuICAgIGNvbnN0IGNvbW1hbmQgPSBbXCJ6dW5pb25zdG9yZVwiLCBkZXN0aW5hdGlvbiwgbnVtS2V5c107XG4gICAgaWYgKEFycmF5LmlzQXJyYXkoa2V5T3JLZXlzKSkge1xuICAgICAgY29tbWFuZC5wdXNoKC4uLmtleU9yS2V5cyk7XG4gICAgfSBlbHNlIHtcbiAgICAgIGNvbW1hbmQucHVzaChrZXlPcktleXMpO1xuICAgIH1cbiAgICBpZiAob3B0cykge1xuICAgICAgaWYgKFwid2VpZ2h0c1wiIGluIG9wdHMgJiYgb3B0cy53ZWlnaHRzKSB7XG4gICAgICAgIGNvbW1hbmQucHVzaChcIndlaWdodHNcIiwgLi4ub3B0cy53ZWlnaHRzKTtcbiAgICAgIH0gZWxzZSBpZiAoXCJ3ZWlnaHRcIiBpbiBvcHRzICYmIHR5cGVvZiBvcHRzLndlaWdodCA9PT0gXCJudW1iZXJcIikge1xuICAgICAgICBjb21tYW5kLnB1c2goXCJ3ZWlnaHRzXCIsIG9wdHMud2VpZ2h0KTtcbiAgICAgIH1cbiAgICAgIGlmIChcImFnZ3JlZ2F0ZVwiIGluIG9wdHMpIHtcbiAgICAgICAgY29tbWFuZC5wdXNoKFwiYWdncmVnYXRlXCIsIG9wdHMuYWdncmVnYXRlKTtcbiAgICAgIH1cbiAgICB9XG4gICAgc3VwZXIoY29tbWFuZCwgY21kT3B0cyk7XG4gIH1cbn07XG5cbi8vIHBrZy9jb21tYW5kcy96ZGlmZnN0b3JlLnRzXG52YXIgWkRpZmZTdG9yZUNvbW1hbmQgPSBjbGFzcyBleHRlbmRzIENvbW1hbmQge1xuICBjb25zdHJ1Y3RvcihjbWQsIG9wdHMpIHtcbiAgICBzdXBlcihbXCJ6ZGlmZnN0b3JlXCIsIC4uLmNtZF0sIG9wdHMpO1xuICB9XG59O1xuXG4vLyBwa2cvY29tbWFuZHMvem1zY29yZS50c1xudmFyIFpNU2NvcmVDb21tYW5kID0gY2xhc3MgZXh0ZW5kcyBDb21tYW5kIHtcbiAgY29uc3RydWN0b3IoY21kLCBvcHRzKSB7XG4gICAgY29uc3QgW2tleSwgbWVtYmVyc10gPSBjbWQ7XG4gICAgc3VwZXIoW1wiem1zY29yZVwiLCBrZXksIC4uLm1lbWJlcnNdLCBvcHRzKTtcbiAgfVxufTtcblxuLy8gcGtnL3BpcGVsaW5lLnRzXG52YXIgUGlwZWxpbmUgPSBjbGFzcyB7XG4gIGNsaWVudDtcbiAgY29tbWFuZHM7XG4gIGNvbW1hbmRPcHRpb25zO1xuICBtdWx0aUV4ZWM7XG4gIGNvbnN0cnVjdG9yKG9wdHMpIHtcbiAgICB0aGlzLmNsaWVudCA9IG9wdHMuY2xpZW50O1xuICAgIHRoaXMuY29tbWFuZHMgPSBbXTtcbiAgICB0aGlzLmNvbW1hbmRPcHRpb25zID0gb3B0cy5jb21tYW5kT3B0aW9ucztcbiAgICB0aGlzLm11bHRpRXhlYyA9IG9wdHMubXVsdGlFeGVjID8/IGZhbHNlO1xuICAgIGlmICh0aGlzLmNvbW1hbmRPcHRpb25zPy5sYXRlbmN5TG9nZ2luZykge1xuICAgICAgY29uc3Qgb3JpZ2luYWxFeGVjID0gdGhpcy5leGVjLmJpbmQodGhpcyk7XG4gICAgICB0aGlzLmV4ZWMgPSBhc3luYyAob3B0aW9ucykgPT4ge1xuICAgICAgICBjb25zdCBzdGFydCA9IHBlcmZvcm1hbmNlLm5vdygpO1xuICAgICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCAob3B0aW9ucyA/IG9yaWdpbmFsRXhlYyhvcHRpb25zKSA6IG9yaWdpbmFsRXhlYygpKTtcbiAgICAgICAgY29uc3QgZW5kID0gcGVyZm9ybWFuY2Uubm93KCk7XG4gICAgICAgIGNvbnN0IGxvZ2dlclJlc3VsdCA9IChlbmQgLSBzdGFydCkudG9GaXhlZCgyKTtcbiAgICAgICAgY29uc29sZS5sb2coXG4gICAgICAgICAgYExhdGVuY3kgZm9yIFxceDFCWzM4OzI7MTk7MTg1OzM5bSR7dGhpcy5tdWx0aUV4ZWMgPyBbXCJNVUxUSS1FWEVDXCJdIDogW1wiUElQRUxJTkVcIl0udG9TdHJpbmcoKS50b1VwcGVyQ2FzZSgpfVxceDFCWzBtOiBcXHgxQlszODsyOzA7MjU1OzI1NW0ke2xvZ2dlclJlc3VsdH0gbXNcXHgxQlswbWBcbiAgICAgICAgKTtcbiAgICAgICAgcmV0dXJuIHJlc3VsdDtcbiAgICAgIH07XG4gICAgfVxuICB9XG4gIGV4ZWMgPSBhc3luYyAob3B0aW9ucykgPT4ge1xuICAgIGlmICh0aGlzLmNvbW1hbmRzLmxlbmd0aCA9PT0gMCkge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKFwiUGlwZWxpbmUgaXMgZW1wdHlcIik7XG4gICAgfVxuICAgIGNvbnN0IHBhdGggPSB0aGlzLm11bHRpRXhlYyA/IFtcIm11bHRpLWV4ZWNcIl0gOiBbXCJwaXBlbGluZVwiXTtcbiAgICBjb25zdCByZXMgPSBhd2FpdCB0aGlzLmNsaWVudC5yZXF1ZXN0KHtcbiAgICAgIHBhdGgsXG4gICAgICBib2R5OiBPYmplY3QudmFsdWVzKHRoaXMuY29tbWFuZHMpLm1hcCgoYykgPT4gYy5jb21tYW5kKVxuICAgIH0pO1xuICAgIHJldHVybiBvcHRpb25zPy5rZWVwRXJyb3JzID8gcmVzLm1hcCgoeyBlcnJvciwgcmVzdWx0IH0sIGkpID0+IHtcbiAgICAgIHJldHVybiB7XG4gICAgICAgIGVycm9yLFxuICAgICAgICByZXN1bHQ6IHRoaXMuY29tbWFuZHNbaV0uZGVzZXJpYWxpemUocmVzdWx0KVxuICAgICAgfTtcbiAgICB9KSA6IHJlcy5tYXAoKHsgZXJyb3IsIHJlc3VsdCB9LCBpKSA9PiB7XG4gICAgICBpZiAoZXJyb3IpIHtcbiAgICAgICAgdGhyb3cgbmV3IFVwc3Rhc2hFcnJvcihcbiAgICAgICAgICBgQ29tbWFuZCAke2kgKyAxfSBbICR7dGhpcy5jb21tYW5kc1tpXS5jb21tYW5kWzBdfSBdIGZhaWxlZDogJHtlcnJvcn1gXG4gICAgICAgICk7XG4gICAgICB9XG4gICAgICByZXR1cm4gdGhpcy5jb21tYW5kc1tpXS5kZXNlcmlhbGl6ZShyZXN1bHQpO1xuICAgIH0pO1xuICB9O1xuICAvKipcbiAgICogUmV0dXJucyB0aGUgbGVuZ3RoIG9mIHBpcGVsaW5lIGJlZm9yZSB0aGUgZXhlY3V0aW9uXG4gICAqL1xuICBsZW5ndGgoKSB7XG4gICAgcmV0dXJuIHRoaXMuY29tbWFuZHMubGVuZ3RoO1xuICB9XG4gIC8qKlxuICAgKiBQdXNoZXMgYSBjb21tYW5kIGludG8gdGhlIHBpcGVsaW5lIGFuZCByZXR1cm5zIGEgY2hhaW5hYmxlIGluc3RhbmNlIG9mIHRoZVxuICAgKiBwaXBlbGluZVxuICAgKi9cbiAgY2hhaW4oY29tbWFuZCkge1xuICAgIHRoaXMuY29tbWFuZHMucHVzaChjb21tYW5kKTtcbiAgICByZXR1cm4gdGhpcztcbiAgfVxuICAvKipcbiAgICogQHNlZSBodHRwczovL3JlZGlzLmlvL2NvbW1hbmRzL2FwcGVuZFxuICAgKi9cbiAgYXBwZW5kID0gKC4uLmFyZ3MpID0+IHRoaXMuY2hhaW4obmV3IEFwcGVuZENvbW1hbmQoYXJncywgdGhpcy5jb21tYW5kT3B0aW9ucykpO1xuICAvKipcbiAgICogQHNlZSBodHRwczovL3JlZGlzLmlvL2NvbW1hbmRzL2JpdGNvdW50XG4gICAqL1xuICBiaXRjb3VudCA9ICguLi5hcmdzKSA9PiB0aGlzLmNoYWluKG5ldyBCaXRDb3VudENvbW1hbmQoYXJncywgdGhpcy5jb21tYW5kT3B0aW9ucykpO1xuICAvKipcbiAgICogUmV0dXJucyBhbiBpbnN0YW5jZSB0aGF0IGNhbiBiZSB1c2VkIHRvIGV4ZWN1dGUgYEJJVEZJRUxEYCBjb21tYW5kcyBvbiBvbmUga2V5LlxuICAgKlxuICAgKiBAZXhhbXBsZVxuICAgKiBgYGB0eXBlc2NyaXB0XG4gICAqIHJlZGlzLnNldChcIm15a2V5XCIsIDApO1xuICAgKiBjb25zdCByZXN1bHQgPSBhd2FpdCByZWRpcy5waXBlbGluZSgpXG4gICAqICAgLmJpdGZpZWxkKFwibXlrZXlcIilcbiAgICogICAuc2V0KFwidTRcIiwgMCwgMTYpXG4gICAqICAgLmluY3IoXCJ1NFwiLCBcIiMxXCIsIDEpXG4gICAqICAgLmV4ZWMoKTtcbiAgICogY29uc29sZS5sb2cocmVzdWx0KTsgLy8gW1swLCAxXV1cbiAgICogYGBgXG4gICAqXG4gICAqIEBzZWUgaHR0cHM6Ly9yZWRpcy5pby9jb21tYW5kcy9iaXRmaWVsZFxuICAgKi9cbiAgYml0ZmllbGQgPSAoLi4uYXJncykgPT4gbmV3IEJpdEZpZWxkQ29tbWFuZChhcmdzLCB0aGlzLmNsaWVudCwgdGhpcy5jb21tYW5kT3B0aW9ucywgdGhpcy5jaGFpbi5iaW5kKHRoaXMpKTtcbiAgLyoqXG4gICAqIEBzZWUgaHR0cHM6Ly9yZWRpcy5pby9jb21tYW5kcy9iaXRvcFxuICAgKi9cbiAgYml0b3AgPSAob3AsIGRlc3RpbmF0aW9uS2V5LCBzb3VyY2VLZXksIC4uLnNvdXJjZUtleXMpID0+IHRoaXMuY2hhaW4oXG4gICAgbmV3IEJpdE9wQ29tbWFuZChbb3AsIGRlc3RpbmF0aW9uS2V5LCBzb3VyY2VLZXksIC4uLnNvdXJjZUtleXNdLCB0aGlzLmNvbW1hbmRPcHRpb25zKVxuICApO1xuICAvKipcbiAgICogQHNlZSBodHRwczovL3JlZGlzLmlvL2NvbW1hbmRzL2JpdHBvc1xuICAgKi9cbiAgYml0cG9zID0gKC4uLmFyZ3MpID0+IHRoaXMuY2hhaW4obmV3IEJpdFBvc0NvbW1hbmQoYXJncywgdGhpcy5jb21tYW5kT3B0aW9ucykpO1xuICAvKipcbiAgICogQHNlZSBodHRwczovL3JlZGlzLmlvL2NvbW1hbmRzL2NvcHlcbiAgICovXG4gIGNvcHkgPSAoLi4uYXJncykgPT4gdGhpcy5jaGFpbihuZXcgQ29weUNvbW1hbmQoYXJncywgdGhpcy5jb21tYW5kT3B0aW9ucykpO1xuICAvKipcbiAgICogQHNlZSBodHRwczovL3JlZGlzLmlvL2NvbW1hbmRzL3pkaWZmc3RvcmVcbiAgICovXG4gIHpkaWZmc3RvcmUgPSAoLi4uYXJncykgPT4gdGhpcy5jaGFpbihuZXcgWkRpZmZTdG9yZUNvbW1hbmQoYXJncywgdGhpcy5jb21tYW5kT3B0aW9ucykpO1xuICAvKipcbiAgICogQHNlZSBodHRwczovL3JlZGlzLmlvL2NvbW1hbmRzL2Ric2l6ZVxuICAgKi9cbiAgZGJzaXplID0gKCkgPT4gdGhpcy5jaGFpbihuZXcgREJTaXplQ29tbWFuZCh0aGlzLmNvbW1hbmRPcHRpb25zKSk7XG4gIC8qKlxuICAgKiBAc2VlIGh0dHBzOi8vcmVkaXMuaW8vY29tbWFuZHMvZGVjclxuICAgKi9cbiAgZGVjciA9ICguLi5hcmdzKSA9PiB0aGlzLmNoYWluKG5ldyBEZWNyQ29tbWFuZChhcmdzLCB0aGlzLmNvbW1hbmRPcHRpb25zKSk7XG4gIC8qKlxuICAgKiBAc2VlIGh0dHBzOi8vcmVkaXMuaW8vY29tbWFuZHMvZGVjcmJ5XG4gICAqL1xuICBkZWNyYnkgPSAoLi4uYXJncykgPT4gdGhpcy5jaGFpbihuZXcgRGVjckJ5Q29tbWFuZChhcmdzLCB0aGlzLmNvbW1hbmRPcHRpb25zKSk7XG4gIC8qKlxuICAgKiBAc2VlIGh0dHBzOi8vcmVkaXMuaW8vY29tbWFuZHMvZGVsXG4gICAqL1xuICBkZWwgPSAoLi4uYXJncykgPT4gdGhpcy5jaGFpbihuZXcgRGVsQ29tbWFuZChhcmdzLCB0aGlzLmNvbW1hbmRPcHRpb25zKSk7XG4gIC8qKlxuICAgKiBAc2VlIGh0dHBzOi8vcmVkaXMuaW8vY29tbWFuZHMvZWNob1xuICAgKi9cbiAgZWNobyA9ICguLi5hcmdzKSA9PiB0aGlzLmNoYWluKG5ldyBFY2hvQ29tbWFuZChhcmdzLCB0aGlzLmNvbW1hbmRPcHRpb25zKSk7XG4gIC8qKlxuICAgKiBAc2VlIGh0dHBzOi8vcmVkaXMuaW8vY29tbWFuZHMvZXZhbF9yb1xuICAgKi9cbiAgZXZhbFJvID0gKC4uLmFyZ3MpID0+IHRoaXMuY2hhaW4obmV3IEV2YWxST0NvbW1hbmQoYXJncywgdGhpcy5jb21tYW5kT3B0aW9ucykpO1xuICAvKipcbiAgICogQHNlZSBodHRwczovL3JlZGlzLmlvL2NvbW1hbmRzL2V2YWxcbiAgICovXG4gIGV2YWwgPSAoLi4uYXJncykgPT4gdGhpcy5jaGFpbihuZXcgRXZhbENvbW1hbmQoYXJncywgdGhpcy5jb21tYW5kT3B0aW9ucykpO1xuICAvKipcbiAgICogQHNlZSBodHRwczovL3JlZGlzLmlvL2NvbW1hbmRzL2V2YWxzaGFfcm9cbiAgICovXG4gIGV2YWxzaGFSbyA9ICguLi5hcmdzKSA9PiB0aGlzLmNoYWluKG5ldyBFdmFsc2hhUk9Db21tYW5kKGFyZ3MsIHRoaXMuY29tbWFuZE9wdGlvbnMpKTtcbiAgLyoqXG4gICAqIEBzZWUgaHR0cHM6Ly9yZWRpcy5pby9jb21tYW5kcy9ldmFsc2hhXG4gICAqL1xuICBldmFsc2hhID0gKC4uLmFyZ3MpID0+IHRoaXMuY2hhaW4obmV3IEV2YWxzaGFDb21tYW5kKGFyZ3MsIHRoaXMuY29tbWFuZE9wdGlvbnMpKTtcbiAgLyoqXG4gICAqIEBzZWUgaHR0cHM6Ly9yZWRpcy5pby9jb21tYW5kcy9leGlzdHNcbiAgICovXG4gIGV4aXN0cyA9ICguLi5hcmdzKSA9PiB0aGlzLmNoYWluKG5ldyBFeGlzdHNDb21tYW5kKGFyZ3MsIHRoaXMuY29tbWFuZE9wdGlvbnMpKTtcbiAgLyoqXG4gICAqIEBzZWUgaHR0cHM6Ly9yZWRpcy5pby9jb21tYW5kcy9leHBpcmVcbiAgICovXG4gIGV4cGlyZSA9ICguLi5hcmdzKSA9PiB0aGlzLmNoYWluKG5ldyBFeHBpcmVDb21tYW5kKGFyZ3MsIHRoaXMuY29tbWFuZE9wdGlvbnMpKTtcbiAgLyoqXG4gICAqIEBzZWUgaHR0cHM6Ly9yZWRpcy5pby9jb21tYW5kcy9leHBpcmVhdFxuICAgKi9cbiAgZXhwaXJlYXQgPSAoLi4uYXJncykgPT4gdGhpcy5jaGFpbihuZXcgRXhwaXJlQXRDb21tYW5kKGFyZ3MsIHRoaXMuY29tbWFuZE9wdGlvbnMpKTtcbiAgLyoqXG4gICAqIEBzZWUgaHR0cHM6Ly9yZWRpcy5pby9jb21tYW5kcy9mbHVzaGFsbFxuICAgKi9cbiAgZmx1c2hhbGwgPSAoYXJncykgPT4gdGhpcy5jaGFpbihuZXcgRmx1c2hBbGxDb21tYW5kKGFyZ3MsIHRoaXMuY29tbWFuZE9wdGlvbnMpKTtcbiAgLyoqXG4gICAqIEBzZWUgaHR0cHM6Ly9yZWRpcy5pby9jb21tYW5kcy9mbHVzaGRiXG4gICAqL1xuICBmbHVzaGRiID0gKC4uLmFyZ3MpID0+IHRoaXMuY2hhaW4obmV3IEZsdXNoREJDb21tYW5kKGFyZ3MsIHRoaXMuY29tbWFuZE9wdGlvbnMpKTtcbiAgLyoqXG4gICAqIEBzZWUgaHR0cHM6Ly9yZWRpcy5pby9jb21tYW5kcy9nZW9hZGRcbiAgICovXG4gIGdlb2FkZCA9ICguLi5hcmdzKSA9PiB0aGlzLmNoYWluKG5ldyBHZW9BZGRDb21tYW5kKGFyZ3MsIHRoaXMuY29tbWFuZE9wdGlvbnMpKTtcbiAgLyoqXG4gICAqIEBzZWUgaHR0cHM6Ly9yZWRpcy5pby9jb21tYW5kcy9nZW9kaXN0XG4gICAqL1xuICBnZW9kaXN0ID0gKC4uLmFyZ3MpID0+IHRoaXMuY2hhaW4obmV3IEdlb0Rpc3RDb21tYW5kKGFyZ3MsIHRoaXMuY29tbWFuZE9wdGlvbnMpKTtcbiAgLyoqXG4gICAqIEBzZWUgaHR0cHM6Ly9yZWRpcy5pby9jb21tYW5kcy9nZW9wb3NcbiAgICovXG4gIGdlb3BvcyA9ICguLi5hcmdzKSA9PiB0aGlzLmNoYWluKG5ldyBHZW9Qb3NDb21tYW5kKGFyZ3MsIHRoaXMuY29tbWFuZE9wdGlvbnMpKTtcbiAgLyoqXG4gICAqIEBzZWUgaHR0cHM6Ly9yZWRpcy5pby9jb21tYW5kcy9nZW9oYXNoXG4gICAqL1xuICBnZW9oYXNoID0gKC4uLmFyZ3MpID0+IHRoaXMuY2hhaW4obmV3IEdlb0hhc2hDb21tYW5kKGFyZ3MsIHRoaXMuY29tbWFuZE9wdGlvbnMpKTtcbiAgLyoqXG4gICAqIEBzZWUgaHR0cHM6Ly9yZWRpcy5pby9jb21tYW5kcy9nZW9zZWFyY2hcbiAgICovXG4gIGdlb3NlYXJjaCA9ICguLi5hcmdzKSA9PiB0aGlzLmNoYWluKG5ldyBHZW9TZWFyY2hDb21tYW5kKGFyZ3MsIHRoaXMuY29tbWFuZE9wdGlvbnMpKTtcbiAgLyoqXG4gICAqIEBzZWUgaHR0cHM6Ly9yZWRpcy5pby9jb21tYW5kcy9nZW9zZWFyY2hzdG9yZVxuICAgKi9cbiAgZ2Vvc2VhcmNoc3RvcmUgPSAoLi4uYXJncykgPT4gdGhpcy5jaGFpbihuZXcgR2VvU2VhcmNoU3RvcmVDb21tYW5kKGFyZ3MsIHRoaXMuY29tbWFuZE9wdGlvbnMpKTtcbiAgLyoqXG4gICAqIEBzZWUgaHR0cHM6Ly9yZWRpcy5pby9jb21tYW5kcy9nZXRcbiAgICovXG4gIGdldCA9ICguLi5hcmdzKSA9PiB0aGlzLmNoYWluKG5ldyBHZXRDb21tYW5kKGFyZ3MsIHRoaXMuY29tbWFuZE9wdGlvbnMpKTtcbiAgLyoqXG4gICAqIEBzZWUgaHR0cHM6Ly9yZWRpcy5pby9jb21tYW5kcy9nZXRiaXRcbiAgICovXG4gIGdldGJpdCA9ICguLi5hcmdzKSA9PiB0aGlzLmNoYWluKG5ldyBHZXRCaXRDb21tYW5kKGFyZ3MsIHRoaXMuY29tbWFuZE9wdGlvbnMpKTtcbiAgLyoqXG4gICAqIEBzZWUgaHR0cHM6Ly9yZWRpcy5pby9jb21tYW5kcy9nZXRkZWxcbiAgICovXG4gIGdldGRlbCA9ICguLi5hcmdzKSA9PiB0aGlzLmNoYWluKG5ldyBHZXREZWxDb21tYW5kKGFyZ3MsIHRoaXMuY29tbWFuZE9wdGlvbnMpKTtcbiAgLyoqXG4gICAqIEBzZWUgaHR0cHM6Ly9yZWRpcy5pby9jb21tYW5kcy9nZXRleFxuICAgKi9cbiAgZ2V0ZXggPSAoLi4uYXJncykgPT4gdGhpcy5jaGFpbihuZXcgR2V0RXhDb21tYW5kKGFyZ3MsIHRoaXMuY29tbWFuZE9wdGlvbnMpKTtcbiAgLyoqXG4gICAqIEBzZWUgaHR0cHM6Ly9yZWRpcy5pby9jb21tYW5kcy9nZXRyYW5nZVxuICAgKi9cbiAgZ2V0cmFuZ2UgPSAoLi4uYXJncykgPT4gdGhpcy5jaGFpbihuZXcgR2V0UmFuZ2VDb21tYW5kKGFyZ3MsIHRoaXMuY29tbWFuZE9wdGlvbnMpKTtcbiAgLyoqXG4gICAqIEBzZWUgaHR0cHM6Ly9yZWRpcy5pby9jb21tYW5kcy9nZXRzZXRcbiAgICovXG4gIGdldHNldCA9IChrZXksIHZhbHVlKSA9PiB0aGlzLmNoYWluKG5ldyBHZXRTZXRDb21tYW5kKFtrZXksIHZhbHVlXSwgdGhpcy5jb21tYW5kT3B0aW9ucykpO1xuICAvKipcbiAgICogQHNlZSBodHRwczovL3JlZGlzLmlvL2NvbW1hbmRzL2hkZWxcbiAgICovXG4gIGhkZWwgPSAoLi4uYXJncykgPT4gdGhpcy5jaGFpbihuZXcgSERlbENvbW1hbmQoYXJncywgdGhpcy5jb21tYW5kT3B0aW9ucykpO1xuICAvKipcbiAgICogQHNlZSBodHRwczovL3JlZGlzLmlvL2NvbW1hbmRzL2hleGlzdHNcbiAgICovXG4gIGhleGlzdHMgPSAoLi4uYXJncykgPT4gdGhpcy5jaGFpbihuZXcgSEV4aXN0c0NvbW1hbmQoYXJncywgdGhpcy5jb21tYW5kT3B0aW9ucykpO1xuICAvKipcbiAgICogQHNlZSBodHRwczovL3JlZGlzLmlvL2NvbW1hbmRzL2hleHBpcmVcbiAgICovXG4gIGhleHBpcmUgPSAoLi4uYXJncykgPT4gdGhpcy5jaGFpbihuZXcgSEV4cGlyZUNvbW1hbmQoYXJncywgdGhpcy5jb21tYW5kT3B0aW9ucykpO1xuICAvKipcbiAgICogQHNlZSBodHRwczovL3JlZGlzLmlvL2NvbW1hbmRzL2hleHBpcmVhdFxuICAgKi9cbiAgaGV4cGlyZWF0ID0gKC4uLmFyZ3MpID0+IHRoaXMuY2hhaW4obmV3IEhFeHBpcmVBdENvbW1hbmQoYXJncywgdGhpcy5jb21tYW5kT3B0aW9ucykpO1xuICAvKipcbiAgICogQHNlZSBodHRwczovL3JlZGlzLmlvL2NvbW1hbmRzL2hleHBpcmV0aW1lXG4gICAqL1xuICBoZXhwaXJldGltZSA9ICguLi5hcmdzKSA9PiB0aGlzLmNoYWluKG5ldyBIRXhwaXJlVGltZUNvbW1hbmQoYXJncywgdGhpcy5jb21tYW5kT3B0aW9ucykpO1xuICAvKipcbiAgICogQHNlZSBodHRwczovL3JlZGlzLmlvL2NvbW1hbmRzL2h0dGxcbiAgICovXG4gIGh0dGwgPSAoLi4uYXJncykgPT4gdGhpcy5jaGFpbihuZXcgSFR0bENvbW1hbmQoYXJncywgdGhpcy5jb21tYW5kT3B0aW9ucykpO1xuICAvKipcbiAgICogQHNlZSBodHRwczovL3JlZGlzLmlvL2NvbW1hbmRzL2hwZXhwaXJlXG4gICAqL1xuICBocGV4cGlyZSA9ICguLi5hcmdzKSA9PiB0aGlzLmNoYWluKG5ldyBIUEV4cGlyZUNvbW1hbmQoYXJncywgdGhpcy5jb21tYW5kT3B0aW9ucykpO1xuICAvKipcbiAgICogQHNlZSBodHRwczovL3JlZGlzLmlvL2NvbW1hbmRzL2hwZXhwaXJlYXRcbiAgICovXG4gIGhwZXhwaXJlYXQgPSAoLi4uYXJncykgPT4gdGhpcy5jaGFpbihuZXcgSFBFeHBpcmVBdENvbW1hbmQoYXJncywgdGhpcy5jb21tYW5kT3B0aW9ucykpO1xuICAvKipcbiAgICogQHNlZSBodHRwczovL3JlZGlzLmlvL2NvbW1hbmRzL2hwZXhwaXJldGltZVxuICAgKi9cbiAgaHBleHBpcmV0aW1lID0gKC4uLmFyZ3MpID0+IHRoaXMuY2hhaW4obmV3IEhQRXhwaXJlVGltZUNvbW1hbmQoYXJncywgdGhpcy5jb21tYW5kT3B0aW9ucykpO1xuICAvKipcbiAgICogQHNlZSBodHRwczovL3JlZGlzLmlvL2NvbW1hbmRzL2hwdHRsXG4gICAqL1xuICBocHR0bCA9ICguLi5hcmdzKSA9PiB0aGlzLmNoYWluKG5ldyBIUFR0bENvbW1hbmQoYXJncywgdGhpcy5jb21tYW5kT3B0aW9ucykpO1xuICAvKipcbiAgICogQHNlZSBodHRwczovL3JlZGlzLmlvL2NvbW1hbmRzL2hwZXJzaXN0XG4gICAqL1xuICBocGVyc2lzdCA9ICguLi5hcmdzKSA9PiB0aGlzLmNoYWluKG5ldyBIUGVyc2lzdENvbW1hbmQoYXJncywgdGhpcy5jb21tYW5kT3B0aW9ucykpO1xuICAvKipcbiAgICogQHNlZSBodHRwczovL3JlZGlzLmlvL2NvbW1hbmRzL2hnZXRcbiAgICovXG4gIGhnZXQgPSAoLi4uYXJncykgPT4gdGhpcy5jaGFpbihuZXcgSEdldENvbW1hbmQoYXJncywgdGhpcy5jb21tYW5kT3B0aW9ucykpO1xuICAvKipcbiAgICogQHNlZSBodHRwczovL3JlZGlzLmlvL2NvbW1hbmRzL2hnZXRhbGxcbiAgICovXG4gIGhnZXRhbGwgPSAoLi4uYXJncykgPT4gdGhpcy5jaGFpbihuZXcgSEdldEFsbENvbW1hbmQoYXJncywgdGhpcy5jb21tYW5kT3B0aW9ucykpO1xuICAvKipcbiAgICogQHNlZSBodHRwczovL3JlZGlzLmlvL2NvbW1hbmRzL2hpbmNyYnlcbiAgICovXG4gIGhpbmNyYnkgPSAoLi4uYXJncykgPT4gdGhpcy5jaGFpbihuZXcgSEluY3JCeUNvbW1hbmQoYXJncywgdGhpcy5jb21tYW5kT3B0aW9ucykpO1xuICAvKipcbiAgICogQHNlZSBodHRwczovL3JlZGlzLmlvL2NvbW1hbmRzL2hpbmNyYnlmbG9hdFxuICAgKi9cbiAgaGluY3JieWZsb2F0ID0gKC4uLmFyZ3MpID0+IHRoaXMuY2hhaW4obmV3IEhJbmNyQnlGbG9hdENvbW1hbmQoYXJncywgdGhpcy5jb21tYW5kT3B0aW9ucykpO1xuICAvKipcbiAgICogQHNlZSBodHRwczovL3JlZGlzLmlvL2NvbW1hbmRzL2hrZXlzXG4gICAqL1xuICBoa2V5cyA9ICguLi5hcmdzKSA9PiB0aGlzLmNoYWluKG5ldyBIS2V5c0NvbW1hbmQoYXJncywgdGhpcy5jb21tYW5kT3B0aW9ucykpO1xuICAvKipcbiAgICogQHNlZSBodHRwczovL3JlZGlzLmlvL2NvbW1hbmRzL2hsZW5cbiAgICovXG4gIGhsZW4gPSAoLi4uYXJncykgPT4gdGhpcy5jaGFpbihuZXcgSExlbkNvbW1hbmQoYXJncywgdGhpcy5jb21tYW5kT3B0aW9ucykpO1xuICAvKipcbiAgICogQHNlZSBodHRwczovL3JlZGlzLmlvL2NvbW1hbmRzL2htZ2V0XG4gICAqL1xuICBobWdldCA9ICguLi5hcmdzKSA9PiB0aGlzLmNoYWluKG5ldyBITUdldENvbW1hbmQoYXJncywgdGhpcy5jb21tYW5kT3B0aW9ucykpO1xuICAvKipcbiAgICogQHNlZSBodHRwczovL3JlZGlzLmlvL2NvbW1hbmRzL2htc2V0XG4gICAqL1xuICBobXNldCA9IChrZXksIGt2KSA9PiB0aGlzLmNoYWluKG5ldyBITVNldENvbW1hbmQoW2tleSwga3ZdLCB0aGlzLmNvbW1hbmRPcHRpb25zKSk7XG4gIC8qKlxuICAgKiBAc2VlIGh0dHBzOi8vcmVkaXMuaW8vY29tbWFuZHMvaHJhbmRmaWVsZFxuICAgKi9cbiAgaHJhbmRmaWVsZCA9IChrZXksIGNvdW50LCB3aXRoVmFsdWVzKSA9PiB0aGlzLmNoYWluKG5ldyBIUmFuZEZpZWxkQ29tbWFuZChba2V5LCBjb3VudCwgd2l0aFZhbHVlc10sIHRoaXMuY29tbWFuZE9wdGlvbnMpKTtcbiAgLyoqXG4gICAqIEBzZWUgaHR0cHM6Ly9yZWRpcy5pby9jb21tYW5kcy9oc2NhblxuICAgKi9cbiAgaHNjYW4gPSAoLi4uYXJncykgPT4gdGhpcy5jaGFpbihuZXcgSFNjYW5Db21tYW5kKGFyZ3MsIHRoaXMuY29tbWFuZE9wdGlvbnMpKTtcbiAgLyoqXG4gICAqIEBzZWUgaHR0cHM6Ly9yZWRpcy5pby9jb21tYW5kcy9oc2V0XG4gICAqL1xuICBoc2V0ID0gKGtleSwga3YpID0+IHRoaXMuY2hhaW4obmV3IEhTZXRDb21tYW5kKFtrZXksIGt2XSwgdGhpcy5jb21tYW5kT3B0aW9ucykpO1xuICAvKipcbiAgICogQHNlZSBodHRwczovL3JlZGlzLmlvL2NvbW1hbmRzL2hzZXRueFxuICAgKi9cbiAgaHNldG54ID0gKGtleSwgZmllbGQsIHZhbHVlKSA9PiB0aGlzLmNoYWluKG5ldyBIU2V0TlhDb21tYW5kKFtrZXksIGZpZWxkLCB2YWx1ZV0sIHRoaXMuY29tbWFuZE9wdGlvbnMpKTtcbiAgLyoqXG4gICAqIEBzZWUgaHR0cHM6Ly9yZWRpcy5pby9jb21tYW5kcy9oc3RybGVuXG4gICAqL1xuICBoc3RybGVuID0gKC4uLmFyZ3MpID0+IHRoaXMuY2hhaW4obmV3IEhTdHJMZW5Db21tYW5kKGFyZ3MsIHRoaXMuY29tbWFuZE9wdGlvbnMpKTtcbiAgLyoqXG4gICAqIEBzZWUgaHR0cHM6Ly9yZWRpcy5pby9jb21tYW5kcy9odmFsc1xuICAgKi9cbiAgaHZhbHMgPSAoLi4uYXJncykgPT4gdGhpcy5jaGFpbihuZXcgSFZhbHNDb21tYW5kKGFyZ3MsIHRoaXMuY29tbWFuZE9wdGlvbnMpKTtcbiAgLyoqXG4gICAqIEBzZWUgaHR0cHM6Ly9yZWRpcy5pby9jb21tYW5kcy9pbmNyXG4gICAqL1xuICBpbmNyID0gKC4uLmFyZ3MpID0+IHRoaXMuY2hhaW4obmV3IEluY3JDb21tYW5kKGFyZ3MsIHRoaXMuY29tbWFuZE9wdGlvbnMpKTtcbiAgLyoqXG4gICAqIEBzZWUgaHR0cHM6Ly9yZWRpcy5pby9jb21tYW5kcy9pbmNyYnlcbiAgICovXG4gIGluY3JieSA9ICguLi5hcmdzKSA9PiB0aGlzLmNoYWluKG5ldyBJbmNyQnlDb21tYW5kKGFyZ3MsIHRoaXMuY29tbWFuZE9wdGlvbnMpKTtcbiAgLyoqXG4gICAqIEBzZWUgaHR0cHM6Ly9yZWRpcy5pby9jb21tYW5kcy9pbmNyYnlmbG9hdFxuICAgKi9cbiAgaW5jcmJ5ZmxvYXQgPSAoLi4uYXJncykgPT4gdGhpcy5jaGFpbihuZXcgSW5jckJ5RmxvYXRDb21tYW5kKGFyZ3MsIHRoaXMuY29tbWFuZE9wdGlvbnMpKTtcbiAgLyoqXG4gICAqIEBzZWUgaHR0cHM6Ly9yZWRpcy5pby9jb21tYW5kcy9rZXlzXG4gICAqL1xuICBrZXlzID0gKC4uLmFyZ3MpID0+IHRoaXMuY2hhaW4obmV3IEtleXNDb21tYW5kKGFyZ3MsIHRoaXMuY29tbWFuZE9wdGlvbnMpKTtcbiAgLyoqXG4gICAqIEBzZWUgaHR0cHM6Ly9yZWRpcy5pby9jb21tYW5kcy9saW5kZXhcbiAgICovXG4gIGxpbmRleCA9ICguLi5hcmdzKSA9PiB0aGlzLmNoYWluKG5ldyBMSW5kZXhDb21tYW5kKGFyZ3MsIHRoaXMuY29tbWFuZE9wdGlvbnMpKTtcbiAgLyoqXG4gICAqIEBzZWUgaHR0cHM6Ly9yZWRpcy5pby9jb21tYW5kcy9saW5zZXJ0XG4gICAqL1xuICBsaW5zZXJ0ID0gKGtleSwgZGlyZWN0aW9uLCBwaXZvdCwgdmFsdWUpID0+IHRoaXMuY2hhaW4obmV3IExJbnNlcnRDb21tYW5kKFtrZXksIGRpcmVjdGlvbiwgcGl2b3QsIHZhbHVlXSwgdGhpcy5jb21tYW5kT3B0aW9ucykpO1xuICAvKipcbiAgICogQHNlZSBodHRwczovL3JlZGlzLmlvL2NvbW1hbmRzL2xsZW5cbiAgICovXG4gIGxsZW4gPSAoLi4uYXJncykgPT4gdGhpcy5jaGFpbihuZXcgTExlbkNvbW1hbmQoYXJncywgdGhpcy5jb21tYW5kT3B0aW9ucykpO1xuICAvKipcbiAgICogQHNlZSBodHRwczovL3JlZGlzLmlvL2NvbW1hbmRzL2xtb3ZlXG4gICAqL1xuICBsbW92ZSA9ICguLi5hcmdzKSA9PiB0aGlzLmNoYWluKG5ldyBMTW92ZUNvbW1hbmQoYXJncywgdGhpcy5jb21tYW5kT3B0aW9ucykpO1xuICAvKipcbiAgICogQHNlZSBodHRwczovL3JlZGlzLmlvL2NvbW1hbmRzL2xwb3BcbiAgICovXG4gIGxwb3AgPSAoLi4uYXJncykgPT4gdGhpcy5jaGFpbihuZXcgTFBvcENvbW1hbmQoYXJncywgdGhpcy5jb21tYW5kT3B0aW9ucykpO1xuICAvKipcbiAgICogQHNlZSBodHRwczovL3JlZGlzLmlvL2NvbW1hbmRzL2xtcG9wXG4gICAqL1xuICBsbXBvcCA9ICguLi5hcmdzKSA9PiB0aGlzLmNoYWluKG5ldyBMbVBvcENvbW1hbmQoYXJncywgdGhpcy5jb21tYW5kT3B0aW9ucykpO1xuICAvKipcbiAgICogQHNlZSBodHRwczovL3JlZGlzLmlvL2NvbW1hbmRzL2xwb3NcbiAgICovXG4gIGxwb3MgPSAoLi4uYXJncykgPT4gdGhpcy5jaGFpbihuZXcgTFBvc0NvbW1hbmQoYXJncywgdGhpcy5jb21tYW5kT3B0aW9ucykpO1xuICAvKipcbiAgICogQHNlZSBodHRwczovL3JlZGlzLmlvL2NvbW1hbmRzL2xwdXNoXG4gICAqL1xuICBscHVzaCA9IChrZXksIC4uLmVsZW1lbnRzKSA9PiB0aGlzLmNoYWluKG5ldyBMUHVzaENvbW1hbmQoW2tleSwgLi4uZWxlbWVudHNdLCB0aGlzLmNvbW1hbmRPcHRpb25zKSk7XG4gIC8qKlxuICAgKiBAc2VlIGh0dHBzOi8vcmVkaXMuaW8vY29tbWFuZHMvbHB1c2h4XG4gICAqL1xuICBscHVzaHggPSAoa2V5LCAuLi5lbGVtZW50cykgPT4gdGhpcy5jaGFpbihuZXcgTFB1c2hYQ29tbWFuZChba2V5LCAuLi5lbGVtZW50c10sIHRoaXMuY29tbWFuZE9wdGlvbnMpKTtcbiAgLyoqXG4gICAqIEBzZWUgaHR0cHM6Ly9yZWRpcy5pby9jb21tYW5kcy9scmFuZ2VcbiAgICovXG4gIGxyYW5nZSA9ICguLi5hcmdzKSA9PiB0aGlzLmNoYWluKG5ldyBMUmFuZ2VDb21tYW5kKGFyZ3MsIHRoaXMuY29tbWFuZE9wdGlvbnMpKTtcbiAgLyoqXG4gICAqIEBzZWUgaHR0cHM6Ly9yZWRpcy5pby9jb21tYW5kcy9scmVtXG4gICAqL1xuICBscmVtID0gKGtleSwgY291bnQsIHZhbHVlKSA9PiB0aGlzLmNoYWluKG5ldyBMUmVtQ29tbWFuZChba2V5LCBjb3VudCwgdmFsdWVdLCB0aGlzLmNvbW1hbmRPcHRpb25zKSk7XG4gIC8qKlxuICAgKiBAc2VlIGh0dHBzOi8vcmVkaXMuaW8vY29tbWFuZHMvbHNldFxuICAgKi9cbiAgbHNldCA9IChrZXksIGluZGV4LCB2YWx1ZSkgPT4gdGhpcy5jaGFpbihuZXcgTFNldENvbW1hbmQoW2tleSwgaW5kZXgsIHZhbHVlXSwgdGhpcy5jb21tYW5kT3B0aW9ucykpO1xuICAvKipcbiAgICogQHNlZSBodHRwczovL3JlZGlzLmlvL2NvbW1hbmRzL2x0cmltXG4gICAqL1xuICBsdHJpbSA9ICguLi5hcmdzKSA9PiB0aGlzLmNoYWluKG5ldyBMVHJpbUNvbW1hbmQoYXJncywgdGhpcy5jb21tYW5kT3B0aW9ucykpO1xuICAvKipcbiAgICogQHNlZSBodHRwczovL3JlZGlzLmlvL2NvbW1hbmRzL21nZXRcbiAgICovXG4gIG1nZXQgPSAoLi4uYXJncykgPT4gdGhpcy5jaGFpbihuZXcgTUdldENvbW1hbmQoYXJncywgdGhpcy5jb21tYW5kT3B0aW9ucykpO1xuICAvKipcbiAgICogQHNlZSBodHRwczovL3JlZGlzLmlvL2NvbW1hbmRzL21zZXRcbiAgICovXG4gIG1zZXQgPSAoa3YpID0+IHRoaXMuY2hhaW4obmV3IE1TZXRDb21tYW5kKFtrdl0sIHRoaXMuY29tbWFuZE9wdGlvbnMpKTtcbiAgLyoqXG4gICAqIEBzZWUgaHR0cHM6Ly9yZWRpcy5pby9jb21tYW5kcy9tc2V0bnhcbiAgICovXG4gIG1zZXRueCA9IChrdikgPT4gdGhpcy5jaGFpbihuZXcgTVNldE5YQ29tbWFuZChba3ZdLCB0aGlzLmNvbW1hbmRPcHRpb25zKSk7XG4gIC8qKlxuICAgKiBAc2VlIGh0dHBzOi8vcmVkaXMuaW8vY29tbWFuZHMvcGVyc2lzdFxuICAgKi9cbiAgcGVyc2lzdCA9ICguLi5hcmdzKSA9PiB0aGlzLmNoYWluKG5ldyBQZXJzaXN0Q29tbWFuZChhcmdzLCB0aGlzLmNvbW1hbmRPcHRpb25zKSk7XG4gIC8qKlxuICAgKiBAc2VlIGh0dHBzOi8vcmVkaXMuaW8vY29tbWFuZHMvcGV4cGlyZVxuICAgKi9cbiAgcGV4cGlyZSA9ICguLi5hcmdzKSA9PiB0aGlzLmNoYWluKG5ldyBQRXhwaXJlQ29tbWFuZChhcmdzLCB0aGlzLmNvbW1hbmRPcHRpb25zKSk7XG4gIC8qKlxuICAgKiBAc2VlIGh0dHBzOi8vcmVkaXMuaW8vY29tbWFuZHMvcGV4cGlyZWF0XG4gICAqL1xuICBwZXhwaXJlYXQgPSAoLi4uYXJncykgPT4gdGhpcy5jaGFpbihuZXcgUEV4cGlyZUF0Q29tbWFuZChhcmdzLCB0aGlzLmNvbW1hbmRPcHRpb25zKSk7XG4gIC8qKlxuICAgKiBAc2VlIGh0dHBzOi8vcmVkaXMuaW8vY29tbWFuZHMvcGZhZGRcbiAgICovXG4gIHBmYWRkID0gKC4uLmFyZ3MpID0+IHRoaXMuY2hhaW4obmV3IFBmQWRkQ29tbWFuZChhcmdzLCB0aGlzLmNvbW1hbmRPcHRpb25zKSk7XG4gIC8qKlxuICAgKiBAc2VlIGh0dHBzOi8vcmVkaXMuaW8vY29tbWFuZHMvcGZjb3VudFxuICAgKi9cbiAgcGZjb3VudCA9ICguLi5hcmdzKSA9PiB0aGlzLmNoYWluKG5ldyBQZkNvdW50Q29tbWFuZChhcmdzLCB0aGlzLmNvbW1hbmRPcHRpb25zKSk7XG4gIC8qKlxuICAgKiBAc2VlIGh0dHBzOi8vcmVkaXMuaW8vY29tbWFuZHMvcGZtZXJnZVxuICAgKi9cbiAgcGZtZXJnZSA9ICguLi5hcmdzKSA9PiB0aGlzLmNoYWluKG5ldyBQZk1lcmdlQ29tbWFuZChhcmdzLCB0aGlzLmNvbW1hbmRPcHRpb25zKSk7XG4gIC8qKlxuICAgKiBAc2VlIGh0dHBzOi8vcmVkaXMuaW8vY29tbWFuZHMvcGluZ1xuICAgKi9cbiAgcGluZyA9IChhcmdzKSA9PiB0aGlzLmNoYWluKG5ldyBQaW5nQ29tbWFuZChhcmdzLCB0aGlzLmNvbW1hbmRPcHRpb25zKSk7XG4gIC8qKlxuICAgKiBAc2VlIGh0dHBzOi8vcmVkaXMuaW8vY29tbWFuZHMvcHNldGV4XG4gICAqL1xuICBwc2V0ZXggPSAoa2V5LCB0dGwsIHZhbHVlKSA9PiB0aGlzLmNoYWluKG5ldyBQU2V0RVhDb21tYW5kKFtrZXksIHR0bCwgdmFsdWVdLCB0aGlzLmNvbW1hbmRPcHRpb25zKSk7XG4gIC8qKlxuICAgKiBAc2VlIGh0dHBzOi8vcmVkaXMuaW8vY29tbWFuZHMvcHR0bFxuICAgKi9cbiAgcHR0bCA9ICguLi5hcmdzKSA9PiB0aGlzLmNoYWluKG5ldyBQVHRsQ29tbWFuZChhcmdzLCB0aGlzLmNvbW1hbmRPcHRpb25zKSk7XG4gIC8qKlxuICAgKiBAc2VlIGh0dHBzOi8vcmVkaXMuaW8vY29tbWFuZHMvcHVibGlzaFxuICAgKi9cbiAgcHVibGlzaCA9ICguLi5hcmdzKSA9PiB0aGlzLmNoYWluKG5ldyBQdWJsaXNoQ29tbWFuZChhcmdzLCB0aGlzLmNvbW1hbmRPcHRpb25zKSk7XG4gIC8qKlxuICAgKiBAc2VlIGh0dHBzOi8vcmVkaXMuaW8vY29tbWFuZHMvcmFuZG9ta2V5XG4gICAqL1xuICByYW5kb21rZXkgPSAoKSA9PiB0aGlzLmNoYWluKG5ldyBSYW5kb21LZXlDb21tYW5kKHRoaXMuY29tbWFuZE9wdGlvbnMpKTtcbiAgLyoqXG4gICAqIEBzZWUgaHR0cHM6Ly9yZWRpcy5pby9jb21tYW5kcy9yZW5hbWVcbiAgICovXG4gIHJlbmFtZSA9ICguLi5hcmdzKSA9PiB0aGlzLmNoYWluKG5ldyBSZW5hbWVDb21tYW5kKGFyZ3MsIHRoaXMuY29tbWFuZE9wdGlvbnMpKTtcbiAgLyoqXG4gICAqIEBzZWUgaHR0cHM6Ly9yZWRpcy5pby9jb21tYW5kcy9yZW5hbWVueFxuICAgKi9cbiAgcmVuYW1lbnggPSAoLi4uYXJncykgPT4gdGhpcy5jaGFpbihuZXcgUmVuYW1lTlhDb21tYW5kKGFyZ3MsIHRoaXMuY29tbWFuZE9wdGlvbnMpKTtcbiAgLyoqXG4gICAqIEBzZWUgaHR0cHM6Ly9yZWRpcy5pby9jb21tYW5kcy9ycG9wXG4gICAqL1xuICBycG9wID0gKC4uLmFyZ3MpID0+IHRoaXMuY2hhaW4obmV3IFJQb3BDb21tYW5kKGFyZ3MsIHRoaXMuY29tbWFuZE9wdGlvbnMpKTtcbiAgLyoqXG4gICAqIEBzZWUgaHR0cHM6Ly9yZWRpcy5pby9jb21tYW5kcy9ycHVzaFxuICAgKi9cbiAgcnB1c2ggPSAoa2V5LCAuLi5lbGVtZW50cykgPT4gdGhpcy5jaGFpbihuZXcgUlB1c2hDb21tYW5kKFtrZXksIC4uLmVsZW1lbnRzXSwgdGhpcy5jb21tYW5kT3B0aW9ucykpO1xuICAvKipcbiAgICogQHNlZSBodHRwczovL3JlZGlzLmlvL2NvbW1hbmRzL3JwdXNoeFxuICAgKi9cbiAgcnB1c2h4ID0gKGtleSwgLi4uZWxlbWVudHMpID0+IHRoaXMuY2hhaW4obmV3IFJQdXNoWENvbW1hbmQoW2tleSwgLi4uZWxlbWVudHNdLCB0aGlzLmNvbW1hbmRPcHRpb25zKSk7XG4gIC8qKlxuICAgKiBAc2VlIGh0dHBzOi8vcmVkaXMuaW8vY29tbWFuZHMvc2FkZFxuICAgKi9cbiAgc2FkZCA9IChrZXksIG1lbWJlciwgLi4ubWVtYmVycykgPT4gdGhpcy5jaGFpbihuZXcgU0FkZENvbW1hbmQoW2tleSwgbWVtYmVyLCAuLi5tZW1iZXJzXSwgdGhpcy5jb21tYW5kT3B0aW9ucykpO1xuICAvKipcbiAgICogQHNlZSBodHRwczovL3JlZGlzLmlvL2NvbW1hbmRzL3NjYW5cbiAgICovXG4gIHNjYW4gPSAoLi4uYXJncykgPT4gdGhpcy5jaGFpbihuZXcgU2NhbkNvbW1hbmQoYXJncywgdGhpcy5jb21tYW5kT3B0aW9ucykpO1xuICAvKipcbiAgICogQHNlZSBodHRwczovL3JlZGlzLmlvL2NvbW1hbmRzL3NjYXJkXG4gICAqL1xuICBzY2FyZCA9ICguLi5hcmdzKSA9PiB0aGlzLmNoYWluKG5ldyBTQ2FyZENvbW1hbmQoYXJncywgdGhpcy5jb21tYW5kT3B0aW9ucykpO1xuICAvKipcbiAgICogQHNlZSBodHRwczovL3JlZGlzLmlvL2NvbW1hbmRzL3NjcmlwdC1leGlzdHNcbiAgICovXG4gIHNjcmlwdEV4aXN0cyA9ICguLi5hcmdzKSA9PiB0aGlzLmNoYWluKG5ldyBTY3JpcHRFeGlzdHNDb21tYW5kKGFyZ3MsIHRoaXMuY29tbWFuZE9wdGlvbnMpKTtcbiAgLyoqXG4gICAqIEBzZWUgaHR0cHM6Ly9yZWRpcy5pby9jb21tYW5kcy9zY3JpcHQtZmx1c2hcbiAgICovXG4gIHNjcmlwdEZsdXNoID0gKC4uLmFyZ3MpID0+IHRoaXMuY2hhaW4obmV3IFNjcmlwdEZsdXNoQ29tbWFuZChhcmdzLCB0aGlzLmNvbW1hbmRPcHRpb25zKSk7XG4gIC8qKlxuICAgKiBAc2VlIGh0dHBzOi8vcmVkaXMuaW8vY29tbWFuZHMvc2NyaXB0LWxvYWRcbiAgICovXG4gIHNjcmlwdExvYWQgPSAoLi4uYXJncykgPT4gdGhpcy5jaGFpbihuZXcgU2NyaXB0TG9hZENvbW1hbmQoYXJncywgdGhpcy5jb21tYW5kT3B0aW9ucykpO1xuICAvKikqXG4gICAqIEBzZWUgaHR0cHM6Ly9yZWRpcy5pby9jb21tYW5kcy9zZGlmZlxuICAgKi9cbiAgc2RpZmYgPSAoLi4uYXJncykgPT4gdGhpcy5jaGFpbihuZXcgU0RpZmZDb21tYW5kKGFyZ3MsIHRoaXMuY29tbWFuZE9wdGlvbnMpKTtcbiAgLyoqXG4gICAqIEBzZWUgaHR0cHM6Ly9yZWRpcy5pby9jb21tYW5kcy9zZGlmZnN0b3JlXG4gICAqL1xuICBzZGlmZnN0b3JlID0gKC4uLmFyZ3MpID0+IHRoaXMuY2hhaW4obmV3IFNEaWZmU3RvcmVDb21tYW5kKGFyZ3MsIHRoaXMuY29tbWFuZE9wdGlvbnMpKTtcbiAgLyoqXG4gICAqIEBzZWUgaHR0cHM6Ly9yZWRpcy5pby9jb21tYW5kcy9zZXRcbiAgICovXG4gIHNldCA9IChrZXksIHZhbHVlLCBvcHRzKSA9PiB0aGlzLmNoYWluKG5ldyBTZXRDb21tYW5kKFtrZXksIHZhbHVlLCBvcHRzXSwgdGhpcy5jb21tYW5kT3B0aW9ucykpO1xuICAvKipcbiAgICogQHNlZSBodHRwczovL3JlZGlzLmlvL2NvbW1hbmRzL3NldGJpdFxuICAgKi9cbiAgc2V0Yml0ID0gKC4uLmFyZ3MpID0+IHRoaXMuY2hhaW4obmV3IFNldEJpdENvbW1hbmQoYXJncywgdGhpcy5jb21tYW5kT3B0aW9ucykpO1xuICAvKipcbiAgICogQHNlZSBodHRwczovL3JlZGlzLmlvL2NvbW1hbmRzL3NldGV4XG4gICAqL1xuICBzZXRleCA9IChrZXksIHR0bCwgdmFsdWUpID0+IHRoaXMuY2hhaW4obmV3IFNldEV4Q29tbWFuZChba2V5LCB0dGwsIHZhbHVlXSwgdGhpcy5jb21tYW5kT3B0aW9ucykpO1xuICAvKipcbiAgICogQHNlZSBodHRwczovL3JlZGlzLmlvL2NvbW1hbmRzL3NldG54XG4gICAqL1xuICBzZXRueCA9IChrZXksIHZhbHVlKSA9PiB0aGlzLmNoYWluKG5ldyBTZXROeENvbW1hbmQoW2tleSwgdmFsdWVdLCB0aGlzLmNvbW1hbmRPcHRpb25zKSk7XG4gIC8qKlxuICAgKiBAc2VlIGh0dHBzOi8vcmVkaXMuaW8vY29tbWFuZHMvc2V0cmFuZ2VcbiAgICovXG4gIHNldHJhbmdlID0gKC4uLmFyZ3MpID0+IHRoaXMuY2hhaW4obmV3IFNldFJhbmdlQ29tbWFuZChhcmdzLCB0aGlzLmNvbW1hbmRPcHRpb25zKSk7XG4gIC8qKlxuICAgKiBAc2VlIGh0dHBzOi8vcmVkaXMuaW8vY29tbWFuZHMvc2ludGVyXG4gICAqL1xuICBzaW50ZXIgPSAoLi4uYXJncykgPT4gdGhpcy5jaGFpbihuZXcgU0ludGVyQ29tbWFuZChhcmdzLCB0aGlzLmNvbW1hbmRPcHRpb25zKSk7XG4gIC8qKlxuICAgKiBAc2VlIGh0dHBzOi8vcmVkaXMuaW8vY29tbWFuZHMvc2ludGVyc3RvcmVcbiAgICovXG4gIHNpbnRlcnN0b3JlID0gKC4uLmFyZ3MpID0+IHRoaXMuY2hhaW4obmV3IFNJbnRlclN0b3JlQ29tbWFuZChhcmdzLCB0aGlzLmNvbW1hbmRPcHRpb25zKSk7XG4gIC8qKlxuICAgKiBAc2VlIGh0dHBzOi8vcmVkaXMuaW8vY29tbWFuZHMvc2lzbWVtYmVyXG4gICAqL1xuICBzaXNtZW1iZXIgPSAoa2V5LCBtZW1iZXIpID0+IHRoaXMuY2hhaW4obmV3IFNJc01lbWJlckNvbW1hbmQoW2tleSwgbWVtYmVyXSwgdGhpcy5jb21tYW5kT3B0aW9ucykpO1xuICAvKipcbiAgICogQHNlZSBodHRwczovL3JlZGlzLmlvL2NvbW1hbmRzL3NtZW1iZXJzXG4gICAqL1xuICBzbWVtYmVycyA9ICguLi5hcmdzKSA9PiB0aGlzLmNoYWluKG5ldyBTTWVtYmVyc0NvbW1hbmQoYXJncywgdGhpcy5jb21tYW5kT3B0aW9ucykpO1xuICAvKipcbiAgICogQHNlZSBodHRwczovL3JlZGlzLmlvL2NvbW1hbmRzL3NtaXNtZW1iZXJcbiAgICovXG4gIHNtaXNtZW1iZXIgPSAoa2V5LCBtZW1iZXJzKSA9PiB0aGlzLmNoYWluKG5ldyBTTUlzTWVtYmVyQ29tbWFuZChba2V5LCBtZW1iZXJzXSwgdGhpcy5jb21tYW5kT3B0aW9ucykpO1xuICAvKipcbiAgICogQHNlZSBodHRwczovL3JlZGlzLmlvL2NvbW1hbmRzL3Ntb3ZlXG4gICAqL1xuICBzbW92ZSA9IChzb3VyY2UsIGRlc3RpbmF0aW9uLCBtZW1iZXIpID0+IHRoaXMuY2hhaW4obmV3IFNNb3ZlQ29tbWFuZChbc291cmNlLCBkZXN0aW5hdGlvbiwgbWVtYmVyXSwgdGhpcy5jb21tYW5kT3B0aW9ucykpO1xuICAvKipcbiAgICogQHNlZSBodHRwczovL3JlZGlzLmlvL2NvbW1hbmRzL3Nwb3BcbiAgICovXG4gIHNwb3AgPSAoLi4uYXJncykgPT4gdGhpcy5jaGFpbihuZXcgU1BvcENvbW1hbmQoYXJncywgdGhpcy5jb21tYW5kT3B0aW9ucykpO1xuICAvKipcbiAgICogQHNlZSBodHRwczovL3JlZGlzLmlvL2NvbW1hbmRzL3NyYW5kbWVtYmVyXG4gICAqL1xuICBzcmFuZG1lbWJlciA9ICguLi5hcmdzKSA9PiB0aGlzLmNoYWluKG5ldyBTUmFuZE1lbWJlckNvbW1hbmQoYXJncywgdGhpcy5jb21tYW5kT3B0aW9ucykpO1xuICAvKipcbiAgICogQHNlZSBodHRwczovL3JlZGlzLmlvL2NvbW1hbmRzL3NyZW1cbiAgICovXG4gIHNyZW0gPSAoa2V5LCAuLi5tZW1iZXJzKSA9PiB0aGlzLmNoYWluKG5ldyBTUmVtQ29tbWFuZChba2V5LCAuLi5tZW1iZXJzXSwgdGhpcy5jb21tYW5kT3B0aW9ucykpO1xuICAvKipcbiAgICogQHNlZSBodHRwczovL3JlZGlzLmlvL2NvbW1hbmRzL3NzY2FuXG4gICAqL1xuICBzc2NhbiA9ICguLi5hcmdzKSA9PiB0aGlzLmNoYWluKG5ldyBTU2NhbkNvbW1hbmQoYXJncywgdGhpcy5jb21tYW5kT3B0aW9ucykpO1xuICAvKipcbiAgICogQHNlZSBodHRwczovL3JlZGlzLmlvL2NvbW1hbmRzL3N0cmxlblxuICAgKi9cbiAgc3RybGVuID0gKC4uLmFyZ3MpID0+IHRoaXMuY2hhaW4obmV3IFN0ckxlbkNvbW1hbmQoYXJncywgdGhpcy5jb21tYW5kT3B0aW9ucykpO1xuICAvKipcbiAgICogQHNlZSBodHRwczovL3JlZGlzLmlvL2NvbW1hbmRzL3N1bmlvblxuICAgKi9cbiAgc3VuaW9uID0gKC4uLmFyZ3MpID0+IHRoaXMuY2hhaW4obmV3IFNVbmlvbkNvbW1hbmQoYXJncywgdGhpcy5jb21tYW5kT3B0aW9ucykpO1xuICAvKipcbiAgICogQHNlZSBodHRwczovL3JlZGlzLmlvL2NvbW1hbmRzL3N1bmlvbnN0b3JlXG4gICAqL1xuICBzdW5pb25zdG9yZSA9ICguLi5hcmdzKSA9PiB0aGlzLmNoYWluKG5ldyBTVW5pb25TdG9yZUNvbW1hbmQoYXJncywgdGhpcy5jb21tYW5kT3B0aW9ucykpO1xuICAvKipcbiAgICogQHNlZSBodHRwczovL3JlZGlzLmlvL2NvbW1hbmRzL3RpbWVcbiAgICovXG4gIHRpbWUgPSAoKSA9PiB0aGlzLmNoYWluKG5ldyBUaW1lQ29tbWFuZCh0aGlzLmNvbW1hbmRPcHRpb25zKSk7XG4gIC8qKlxuICAgKiBAc2VlIGh0dHBzOi8vcmVkaXMuaW8vY29tbWFuZHMvdG91Y2hcbiAgICovXG4gIHRvdWNoID0gKC4uLmFyZ3MpID0+IHRoaXMuY2hhaW4obmV3IFRvdWNoQ29tbWFuZChhcmdzLCB0aGlzLmNvbW1hbmRPcHRpb25zKSk7XG4gIC8qKlxuICAgKiBAc2VlIGh0dHBzOi8vcmVkaXMuaW8vY29tbWFuZHMvdHRsXG4gICAqL1xuICB0dGwgPSAoLi4uYXJncykgPT4gdGhpcy5jaGFpbihuZXcgVHRsQ29tbWFuZChhcmdzLCB0aGlzLmNvbW1hbmRPcHRpb25zKSk7XG4gIC8qKlxuICAgKiBAc2VlIGh0dHBzOi8vcmVkaXMuaW8vY29tbWFuZHMvdHlwZVxuICAgKi9cbiAgdHlwZSA9ICguLi5hcmdzKSA9PiB0aGlzLmNoYWluKG5ldyBUeXBlQ29tbWFuZChhcmdzLCB0aGlzLmNvbW1hbmRPcHRpb25zKSk7XG4gIC8qKlxuICAgKiBAc2VlIGh0dHBzOi8vcmVkaXMuaW8vY29tbWFuZHMvdW5saW5rXG4gICAqL1xuICB1bmxpbmsgPSAoLi4uYXJncykgPT4gdGhpcy5jaGFpbihuZXcgVW5saW5rQ29tbWFuZChhcmdzLCB0aGlzLmNvbW1hbmRPcHRpb25zKSk7XG4gIC8qKlxuICAgKiBAc2VlIGh0dHBzOi8vcmVkaXMuaW8vY29tbWFuZHMvemFkZFxuICAgKi9cbiAgemFkZCA9ICguLi5hcmdzKSA9PiB7XG4gICAgaWYgKFwic2NvcmVcIiBpbiBhcmdzWzFdKSB7XG4gICAgICByZXR1cm4gdGhpcy5jaGFpbihcbiAgICAgICAgbmV3IFpBZGRDb21tYW5kKFthcmdzWzBdLCBhcmdzWzFdLCAuLi5hcmdzLnNsaWNlKDIpXSwgdGhpcy5jb21tYW5kT3B0aW9ucylcbiAgICAgICk7XG4gICAgfVxuICAgIHJldHVybiB0aGlzLmNoYWluKFxuICAgICAgbmV3IFpBZGRDb21tYW5kKFxuICAgICAgICBbYXJnc1swXSwgYXJnc1sxXSwgLi4uYXJncy5zbGljZSgyKV0sXG4gICAgICAgIHRoaXMuY29tbWFuZE9wdGlvbnNcbiAgICAgIClcbiAgICApO1xuICB9O1xuICAvKipcbiAgICogQHNlZSBodHRwczovL3JlZGlzLmlvL2NvbW1hbmRzL3hhZGRcbiAgICovXG4gIHhhZGQgPSAoLi4uYXJncykgPT4gdGhpcy5jaGFpbihuZXcgWEFkZENvbW1hbmQoYXJncywgdGhpcy5jb21tYW5kT3B0aW9ucykpO1xuICAvKipcbiAgICogQHNlZSBodHRwczovL3JlZGlzLmlvL2NvbW1hbmRzL3hhY2tcbiAgICovXG4gIHhhY2sgPSAoLi4uYXJncykgPT4gdGhpcy5jaGFpbihuZXcgWEFja0NvbW1hbmQoYXJncywgdGhpcy5jb21tYW5kT3B0aW9ucykpO1xuICAvKipcbiAgICogQHNlZSBodHRwczovL3JlZGlzLmlvL2NvbW1hbmRzL3hkZWxcbiAgICovXG4gIHhkZWwgPSAoLi4uYXJncykgPT4gdGhpcy5jaGFpbihuZXcgWERlbENvbW1hbmQoYXJncywgdGhpcy5jb21tYW5kT3B0aW9ucykpO1xuICAvKipcbiAgICogQHNlZSBodHRwczovL3JlZGlzLmlvL2NvbW1hbmRzL3hncm91cFxuICAgKi9cbiAgeGdyb3VwID0gKC4uLmFyZ3MpID0+IHRoaXMuY2hhaW4obmV3IFhHcm91cENvbW1hbmQoYXJncywgdGhpcy5jb21tYW5kT3B0aW9ucykpO1xuICAvKipcbiAgICogQHNlZSBodHRwczovL3JlZGlzLmlvL2NvbW1hbmRzL3hyZWFkXG4gICAqL1xuICB4cmVhZCA9ICguLi5hcmdzKSA9PiB0aGlzLmNoYWluKG5ldyBYUmVhZENvbW1hbmQoYXJncywgdGhpcy5jb21tYW5kT3B0aW9ucykpO1xuICAvKipcbiAgICogQHNlZSBodHRwczovL3JlZGlzLmlvL2NvbW1hbmRzL3hyZWFkZ3JvdXBcbiAgICovXG4gIHhyZWFkZ3JvdXAgPSAoLi4uYXJncykgPT4gdGhpcy5jaGFpbihuZXcgWFJlYWRHcm91cENvbW1hbmQoYXJncywgdGhpcy5jb21tYW5kT3B0aW9ucykpO1xuICAvKipcbiAgICogQHNlZSBodHRwczovL3JlZGlzLmlvL2NvbW1hbmRzL3hpbmZvXG4gICAqL1xuICB4aW5mbyA9ICguLi5hcmdzKSA9PiB0aGlzLmNoYWluKG5ldyBYSW5mb0NvbW1hbmQoYXJncywgdGhpcy5jb21tYW5kT3B0aW9ucykpO1xuICAvKipcbiAgICogQHNlZSBodHRwczovL3JlZGlzLmlvL2NvbW1hbmRzL3hsZW5cbiAgICovXG4gIHhsZW4gPSAoLi4uYXJncykgPT4gdGhpcy5jaGFpbihuZXcgWExlbkNvbW1hbmQoYXJncywgdGhpcy5jb21tYW5kT3B0aW9ucykpO1xuICAvKipcbiAgICogQHNlZSBodHRwczovL3JlZGlzLmlvL2NvbW1hbmRzL3hwZW5kaW5nXG4gICAqL1xuICB4cGVuZGluZyA9ICguLi5hcmdzKSA9PiB0aGlzLmNoYWluKG5ldyBYUGVuZGluZ0NvbW1hbmQoYXJncywgdGhpcy5jb21tYW5kT3B0aW9ucykpO1xuICAvKipcbiAgICogQHNlZSBodHRwczovL3JlZGlzLmlvL2NvbW1hbmRzL3hjbGFpbVxuICAgKi9cbiAgeGNsYWltID0gKC4uLmFyZ3MpID0+IHRoaXMuY2hhaW4obmV3IFhDbGFpbUNvbW1hbmQoYXJncywgdGhpcy5jb21tYW5kT3B0aW9ucykpO1xuICAvKipcbiAgICogQHNlZSBodHRwczovL3JlZGlzLmlvL2NvbW1hbmRzL3hhdXRvY2xhaW1cbiAgICovXG4gIHhhdXRvY2xhaW0gPSAoLi4uYXJncykgPT4gdGhpcy5jaGFpbihuZXcgWEF1dG9DbGFpbShhcmdzLCB0aGlzLmNvbW1hbmRPcHRpb25zKSk7XG4gIC8qKlxuICAgKiBAc2VlIGh0dHBzOi8vcmVkaXMuaW8vY29tbWFuZHMveHRyaW1cbiAgICovXG4gIHh0cmltID0gKC4uLmFyZ3MpID0+IHRoaXMuY2hhaW4obmV3IFhUcmltQ29tbWFuZChhcmdzLCB0aGlzLmNvbW1hbmRPcHRpb25zKSk7XG4gIC8qKlxuICAgKiBAc2VlIGh0dHBzOi8vcmVkaXMuaW8vY29tbWFuZHMveHJhbmdlXG4gICAqL1xuICB4cmFuZ2UgPSAoLi4uYXJncykgPT4gdGhpcy5jaGFpbihuZXcgWFJhbmdlQ29tbWFuZChhcmdzLCB0aGlzLmNvbW1hbmRPcHRpb25zKSk7XG4gIC8qKlxuICAgKiBAc2VlIGh0dHBzOi8vcmVkaXMuaW8vY29tbWFuZHMveHJldnJhbmdlXG4gICAqL1xuICB4cmV2cmFuZ2UgPSAoLi4uYXJncykgPT4gdGhpcy5jaGFpbihuZXcgWFJldlJhbmdlQ29tbWFuZChhcmdzLCB0aGlzLmNvbW1hbmRPcHRpb25zKSk7XG4gIC8qKlxuICAgKiBAc2VlIGh0dHBzOi8vcmVkaXMuaW8vY29tbWFuZHMvemNhcmRcbiAgICovXG4gIHpjYXJkID0gKC4uLmFyZ3MpID0+IHRoaXMuY2hhaW4obmV3IFpDYXJkQ29tbWFuZChhcmdzLCB0aGlzLmNvbW1hbmRPcHRpb25zKSk7XG4gIC8qKlxuICAgKiBAc2VlIGh0dHBzOi8vcmVkaXMuaW8vY29tbWFuZHMvemNvdW50XG4gICAqL1xuICB6Y291bnQgPSAoLi4uYXJncykgPT4gdGhpcy5jaGFpbihuZXcgWkNvdW50Q29tbWFuZChhcmdzLCB0aGlzLmNvbW1hbmRPcHRpb25zKSk7XG4gIC8qKlxuICAgKiBAc2VlIGh0dHBzOi8vcmVkaXMuaW8vY29tbWFuZHMvemluY3JieVxuICAgKi9cbiAgemluY3JieSA9IChrZXksIGluY3JlbWVudCwgbWVtYmVyKSA9PiB0aGlzLmNoYWluKG5ldyBaSW5jckJ5Q29tbWFuZChba2V5LCBpbmNyZW1lbnQsIG1lbWJlcl0sIHRoaXMuY29tbWFuZE9wdGlvbnMpKTtcbiAgLyoqXG4gICAqIEBzZWUgaHR0cHM6Ly9yZWRpcy5pby9jb21tYW5kcy96aW50ZXJzdG9yZVxuICAgKi9cbiAgemludGVyc3RvcmUgPSAoLi4uYXJncykgPT4gdGhpcy5jaGFpbihuZXcgWkludGVyU3RvcmVDb21tYW5kKGFyZ3MsIHRoaXMuY29tbWFuZE9wdGlvbnMpKTtcbiAgLyoqXG4gICAqIEBzZWUgaHR0cHM6Ly9yZWRpcy5pby9jb21tYW5kcy96bGV4Y291bnRcbiAgICovXG4gIHpsZXhjb3VudCA9ICguLi5hcmdzKSA9PiB0aGlzLmNoYWluKG5ldyBaTGV4Q291bnRDb21tYW5kKGFyZ3MsIHRoaXMuY29tbWFuZE9wdGlvbnMpKTtcbiAgLyoqXG4gICAqIEBzZWUgaHR0cHM6Ly9yZWRpcy5pby9jb21tYW5kcy96bXNjb3JlXG4gICAqL1xuICB6bXNjb3JlID0gKC4uLmFyZ3MpID0+IHRoaXMuY2hhaW4obmV3IFpNU2NvcmVDb21tYW5kKGFyZ3MsIHRoaXMuY29tbWFuZE9wdGlvbnMpKTtcbiAgLyoqXG4gICAqIEBzZWUgaHR0cHM6Ly9yZWRpcy5pby9jb21tYW5kcy96cG9wbWF4XG4gICAqL1xuICB6cG9wbWF4ID0gKC4uLmFyZ3MpID0+IHRoaXMuY2hhaW4obmV3IFpQb3BNYXhDb21tYW5kKGFyZ3MsIHRoaXMuY29tbWFuZE9wdGlvbnMpKTtcbiAgLyoqXG4gICAqIEBzZWUgaHR0cHM6Ly9yZWRpcy5pby9jb21tYW5kcy96cG9wbWluXG4gICAqL1xuICB6cG9wbWluID0gKC4uLmFyZ3MpID0+IHRoaXMuY2hhaW4obmV3IFpQb3BNaW5Db21tYW5kKGFyZ3MsIHRoaXMuY29tbWFuZE9wdGlvbnMpKTtcbiAgLyoqXG4gICAqIEBzZWUgaHR0cHM6Ly9yZWRpcy5pby9jb21tYW5kcy96cmFuZ2VcbiAgICovXG4gIHpyYW5nZSA9ICguLi5hcmdzKSA9PiB0aGlzLmNoYWluKG5ldyBaUmFuZ2VDb21tYW5kKGFyZ3MsIHRoaXMuY29tbWFuZE9wdGlvbnMpKTtcbiAgLyoqXG4gICAqIEBzZWUgaHR0cHM6Ly9yZWRpcy5pby9jb21tYW5kcy96cmFua1xuICAgKi9cbiAgenJhbmsgPSAoa2V5LCBtZW1iZXIpID0+IHRoaXMuY2hhaW4obmV3IFpSYW5rQ29tbWFuZChba2V5LCBtZW1iZXJdLCB0aGlzLmNvbW1hbmRPcHRpb25zKSk7XG4gIC8qKlxuICAgKiBAc2VlIGh0dHBzOi8vcmVkaXMuaW8vY29tbWFuZHMvenJlbVxuICAgKi9cbiAgenJlbSA9IChrZXksIC4uLm1lbWJlcnMpID0+IHRoaXMuY2hhaW4obmV3IFpSZW1Db21tYW5kKFtrZXksIC4uLm1lbWJlcnNdLCB0aGlzLmNvbW1hbmRPcHRpb25zKSk7XG4gIC8qKlxuICAgKiBAc2VlIGh0dHBzOi8vcmVkaXMuaW8vY29tbWFuZHMvenJlbXJhbmdlYnlsZXhcbiAgICovXG4gIHpyZW1yYW5nZWJ5bGV4ID0gKC4uLmFyZ3MpID0+IHRoaXMuY2hhaW4obmV3IFpSZW1SYW5nZUJ5TGV4Q29tbWFuZChhcmdzLCB0aGlzLmNvbW1hbmRPcHRpb25zKSk7XG4gIC8qKlxuICAgKiBAc2VlIGh0dHBzOi8vcmVkaXMuaW8vY29tbWFuZHMvenJlbXJhbmdlYnlyYW5rXG4gICAqL1xuICB6cmVtcmFuZ2VieXJhbmsgPSAoLi4uYXJncykgPT4gdGhpcy5jaGFpbihuZXcgWlJlbVJhbmdlQnlSYW5rQ29tbWFuZChhcmdzLCB0aGlzLmNvbW1hbmRPcHRpb25zKSk7XG4gIC8qKlxuICAgKiBAc2VlIGh0dHBzOi8vcmVkaXMuaW8vY29tbWFuZHMvenJlbXJhbmdlYnlzY29yZVxuICAgKi9cbiAgenJlbXJhbmdlYnlzY29yZSA9ICguLi5hcmdzKSA9PiB0aGlzLmNoYWluKG5ldyBaUmVtUmFuZ2VCeVNjb3JlQ29tbWFuZChhcmdzLCB0aGlzLmNvbW1hbmRPcHRpb25zKSk7XG4gIC8qKlxuICAgKiBAc2VlIGh0dHBzOi8vcmVkaXMuaW8vY29tbWFuZHMvenJldnJhbmtcbiAgICovXG4gIHpyZXZyYW5rID0gKGtleSwgbWVtYmVyKSA9PiB0aGlzLmNoYWluKG5ldyBaUmV2UmFua0NvbW1hbmQoW2tleSwgbWVtYmVyXSwgdGhpcy5jb21tYW5kT3B0aW9ucykpO1xuICAvKipcbiAgICogQHNlZSBodHRwczovL3JlZGlzLmlvL2NvbW1hbmRzL3pzY2FuXG4gICAqL1xuICB6c2NhbiA9ICguLi5hcmdzKSA9PiB0aGlzLmNoYWluKG5ldyBaU2NhbkNvbW1hbmQoYXJncywgdGhpcy5jb21tYW5kT3B0aW9ucykpO1xuICAvKipcbiAgICogQHNlZSBodHRwczovL3JlZGlzLmlvL2NvbW1hbmRzL3pzY29yZVxuICAgKi9cbiAgenNjb3JlID0gKGtleSwgbWVtYmVyKSA9PiB0aGlzLmNoYWluKG5ldyBaU2NvcmVDb21tYW5kKFtrZXksIG1lbWJlcl0sIHRoaXMuY29tbWFuZE9wdGlvbnMpKTtcbiAgLyoqXG4gICAqIEBzZWUgaHR0cHM6Ly9yZWRpcy5pby9jb21tYW5kcy96dW5pb25zdG9yZVxuICAgKi9cbiAgenVuaW9uc3RvcmUgPSAoLi4uYXJncykgPT4gdGhpcy5jaGFpbihuZXcgWlVuaW9uU3RvcmVDb21tYW5kKGFyZ3MsIHRoaXMuY29tbWFuZE9wdGlvbnMpKTtcbiAgLyoqXG4gICAqIEBzZWUgaHR0cHM6Ly9yZWRpcy5pby9jb21tYW5kcy96dW5pb25cbiAgICovXG4gIHp1bmlvbiA9ICguLi5hcmdzKSA9PiB0aGlzLmNoYWluKG5ldyBaVW5pb25Db21tYW5kKGFyZ3MsIHRoaXMuY29tbWFuZE9wdGlvbnMpKTtcbiAgLyoqXG4gICAqIEBzZWUgaHR0cHM6Ly9yZWRpcy5pby9jb21tYW5kcy8/Z3JvdXA9anNvblxuICAgKi9cbiAgZ2V0IGpzb24oKSB7XG4gICAgcmV0dXJuIHtcbiAgICAgIC8qKlxuICAgICAgICogQHNlZSBodHRwczovL3JlZGlzLmlvL2NvbW1hbmRzL2pzb24uYXJyYXBwZW5kXG4gICAgICAgKi9cbiAgICAgIGFycmFwcGVuZDogKC4uLmFyZ3MpID0+IHRoaXMuY2hhaW4obmV3IEpzb25BcnJBcHBlbmRDb21tYW5kKGFyZ3MsIHRoaXMuY29tbWFuZE9wdGlvbnMpKSxcbiAgICAgIC8qKlxuICAgICAgICogQHNlZSBodHRwczovL3JlZGlzLmlvL2NvbW1hbmRzL2pzb24uYXJyaW5kZXhcbiAgICAgICAqL1xuICAgICAgYXJyaW5kZXg6ICguLi5hcmdzKSA9PiB0aGlzLmNoYWluKG5ldyBKc29uQXJySW5kZXhDb21tYW5kKGFyZ3MsIHRoaXMuY29tbWFuZE9wdGlvbnMpKSxcbiAgICAgIC8qKlxuICAgICAgICogQHNlZSBodHRwczovL3JlZGlzLmlvL2NvbW1hbmRzL2pzb24uYXJyaW5zZXJ0XG4gICAgICAgKi9cbiAgICAgIGFycmluc2VydDogKC4uLmFyZ3MpID0+IHRoaXMuY2hhaW4obmV3IEpzb25BcnJJbnNlcnRDb21tYW5kKGFyZ3MsIHRoaXMuY29tbWFuZE9wdGlvbnMpKSxcbiAgICAgIC8qKlxuICAgICAgICogQHNlZSBodHRwczovL3JlZGlzLmlvL2NvbW1hbmRzL2pzb24uYXJybGVuXG4gICAgICAgKi9cbiAgICAgIGFycmxlbjogKC4uLmFyZ3MpID0+IHRoaXMuY2hhaW4obmV3IEpzb25BcnJMZW5Db21tYW5kKGFyZ3MsIHRoaXMuY29tbWFuZE9wdGlvbnMpKSxcbiAgICAgIC8qKlxuICAgICAgICogQHNlZSBodHRwczovL3JlZGlzLmlvL2NvbW1hbmRzL2pzb24uYXJycG9wXG4gICAgICAgKi9cbiAgICAgIGFycnBvcDogKC4uLmFyZ3MpID0+IHRoaXMuY2hhaW4obmV3IEpzb25BcnJQb3BDb21tYW5kKGFyZ3MsIHRoaXMuY29tbWFuZE9wdGlvbnMpKSxcbiAgICAgIC8qKlxuICAgICAgICogQHNlZSBodHRwczovL3JlZGlzLmlvL2NvbW1hbmRzL2pzb24uYXJydHJpbVxuICAgICAgICovXG4gICAgICBhcnJ0cmltOiAoLi4uYXJncykgPT4gdGhpcy5jaGFpbihuZXcgSnNvbkFyclRyaW1Db21tYW5kKGFyZ3MsIHRoaXMuY29tbWFuZE9wdGlvbnMpKSxcbiAgICAgIC8qKlxuICAgICAgICogQHNlZSBodHRwczovL3JlZGlzLmlvL2NvbW1hbmRzL2pzb24uY2xlYXJcbiAgICAgICAqL1xuICAgICAgY2xlYXI6ICguLi5hcmdzKSA9PiB0aGlzLmNoYWluKG5ldyBKc29uQ2xlYXJDb21tYW5kKGFyZ3MsIHRoaXMuY29tbWFuZE9wdGlvbnMpKSxcbiAgICAgIC8qKlxuICAgICAgICogQHNlZSBodHRwczovL3JlZGlzLmlvL2NvbW1hbmRzL2pzb24uZGVsXG4gICAgICAgKi9cbiAgICAgIGRlbDogKC4uLmFyZ3MpID0+IHRoaXMuY2hhaW4obmV3IEpzb25EZWxDb21tYW5kKGFyZ3MsIHRoaXMuY29tbWFuZE9wdGlvbnMpKSxcbiAgICAgIC8qKlxuICAgICAgICogQHNlZSBodHRwczovL3JlZGlzLmlvL2NvbW1hbmRzL2pzb24uZm9yZ2V0XG4gICAgICAgKi9cbiAgICAgIGZvcmdldDogKC4uLmFyZ3MpID0+IHRoaXMuY2hhaW4obmV3IEpzb25Gb3JnZXRDb21tYW5kKGFyZ3MsIHRoaXMuY29tbWFuZE9wdGlvbnMpKSxcbiAgICAgIC8qKlxuICAgICAgICogQHNlZSBodHRwczovL3JlZGlzLmlvL2NvbW1hbmRzL2pzb24uZ2V0XG4gICAgICAgKi9cbiAgICAgIGdldDogKC4uLmFyZ3MpID0+IHRoaXMuY2hhaW4obmV3IEpzb25HZXRDb21tYW5kKGFyZ3MsIHRoaXMuY29tbWFuZE9wdGlvbnMpKSxcbiAgICAgIC8qKlxuICAgICAgICogQHNlZSBodHRwczovL3JlZGlzLmlvL2NvbW1hbmRzL2pzb24ubWVyZ2VcbiAgICAgICAqL1xuICAgICAgbWVyZ2U6ICguLi5hcmdzKSA9PiB0aGlzLmNoYWluKG5ldyBKc29uTWVyZ2VDb21tYW5kKGFyZ3MsIHRoaXMuY29tbWFuZE9wdGlvbnMpKSxcbiAgICAgIC8qKlxuICAgICAgICogQHNlZSBodHRwczovL3JlZGlzLmlvL2NvbW1hbmRzL2pzb24ubWdldFxuICAgICAgICovXG4gICAgICBtZ2V0OiAoLi4uYXJncykgPT4gdGhpcy5jaGFpbihuZXcgSnNvbk1HZXRDb21tYW5kKGFyZ3MsIHRoaXMuY29tbWFuZE9wdGlvbnMpKSxcbiAgICAgIC8qKlxuICAgICAgICogQHNlZSBodHRwczovL3JlZGlzLmlvL2NvbW1hbmRzL2pzb24ubXNldFxuICAgICAgICovXG4gICAgICBtc2V0OiAoLi4uYXJncykgPT4gdGhpcy5jaGFpbihuZXcgSnNvbk1TZXRDb21tYW5kKGFyZ3MsIHRoaXMuY29tbWFuZE9wdGlvbnMpKSxcbiAgICAgIC8qKlxuICAgICAgICogQHNlZSBodHRwczovL3JlZGlzLmlvL2NvbW1hbmRzL2pzb24ubnVtaW5jcmJ5XG4gICAgICAgKi9cbiAgICAgIG51bWluY3JieTogKC4uLmFyZ3MpID0+IHRoaXMuY2hhaW4obmV3IEpzb25OdW1JbmNyQnlDb21tYW5kKGFyZ3MsIHRoaXMuY29tbWFuZE9wdGlvbnMpKSxcbiAgICAgIC8qKlxuICAgICAgICogQHNlZSBodHRwczovL3JlZGlzLmlvL2NvbW1hbmRzL2pzb24ubnVtbXVsdGJ5XG4gICAgICAgKi9cbiAgICAgIG51bW11bHRieTogKC4uLmFyZ3MpID0+IHRoaXMuY2hhaW4obmV3IEpzb25OdW1NdWx0QnlDb21tYW5kKGFyZ3MsIHRoaXMuY29tbWFuZE9wdGlvbnMpKSxcbiAgICAgIC8qKlxuICAgICAgICogQHNlZSBodHRwczovL3JlZGlzLmlvL2NvbW1hbmRzL2pzb24ub2Jqa2V5c1xuICAgICAgICovXG4gICAgICBvYmprZXlzOiAoLi4uYXJncykgPT4gdGhpcy5jaGFpbihuZXcgSnNvbk9iaktleXNDb21tYW5kKGFyZ3MsIHRoaXMuY29tbWFuZE9wdGlvbnMpKSxcbiAgICAgIC8qKlxuICAgICAgICogQHNlZSBodHRwczovL3JlZGlzLmlvL2NvbW1hbmRzL2pzb24ub2JqbGVuXG4gICAgICAgKi9cbiAgICAgIG9iamxlbjogKC4uLmFyZ3MpID0+IHRoaXMuY2hhaW4obmV3IEpzb25PYmpMZW5Db21tYW5kKGFyZ3MsIHRoaXMuY29tbWFuZE9wdGlvbnMpKSxcbiAgICAgIC8qKlxuICAgICAgICogQHNlZSBodHRwczovL3JlZGlzLmlvL2NvbW1hbmRzL2pzb24ucmVzcFxuICAgICAgICovXG4gICAgICByZXNwOiAoLi4uYXJncykgPT4gdGhpcy5jaGFpbihuZXcgSnNvblJlc3BDb21tYW5kKGFyZ3MsIHRoaXMuY29tbWFuZE9wdGlvbnMpKSxcbiAgICAgIC8qKlxuICAgICAgICogQHNlZSBodHRwczovL3JlZGlzLmlvL2NvbW1hbmRzL2pzb24uc2V0XG4gICAgICAgKi9cbiAgICAgIHNldDogKC4uLmFyZ3MpID0+IHRoaXMuY2hhaW4obmV3IEpzb25TZXRDb21tYW5kKGFyZ3MsIHRoaXMuY29tbWFuZE9wdGlvbnMpKSxcbiAgICAgIC8qKlxuICAgICAgICogQHNlZSBodHRwczovL3JlZGlzLmlvL2NvbW1hbmRzL2pzb24uc3RyYXBwZW5kXG4gICAgICAgKi9cbiAgICAgIHN0cmFwcGVuZDogKC4uLmFyZ3MpID0+IHRoaXMuY2hhaW4obmV3IEpzb25TdHJBcHBlbmRDb21tYW5kKGFyZ3MsIHRoaXMuY29tbWFuZE9wdGlvbnMpKSxcbiAgICAgIC8qKlxuICAgICAgICogQHNlZSBodHRwczovL3JlZGlzLmlvL2NvbW1hbmRzL2pzb24uc3RybGVuXG4gICAgICAgKi9cbiAgICAgIHN0cmxlbjogKC4uLmFyZ3MpID0+IHRoaXMuY2hhaW4obmV3IEpzb25TdHJMZW5Db21tYW5kKGFyZ3MsIHRoaXMuY29tbWFuZE9wdGlvbnMpKSxcbiAgICAgIC8qKlxuICAgICAgICogQHNlZSBodHRwczovL3JlZGlzLmlvL2NvbW1hbmRzL2pzb24udG9nZ2xlXG4gICAgICAgKi9cbiAgICAgIHRvZ2dsZTogKC4uLmFyZ3MpID0+IHRoaXMuY2hhaW4obmV3IEpzb25Ub2dnbGVDb21tYW5kKGFyZ3MsIHRoaXMuY29tbWFuZE9wdGlvbnMpKSxcbiAgICAgIC8qKlxuICAgICAgICogQHNlZSBodHRwczovL3JlZGlzLmlvL2NvbW1hbmRzL2pzb24udHlwZVxuICAgICAgICovXG4gICAgICB0eXBlOiAoLi4uYXJncykgPT4gdGhpcy5jaGFpbihuZXcgSnNvblR5cGVDb21tYW5kKGFyZ3MsIHRoaXMuY29tbWFuZE9wdGlvbnMpKVxuICAgIH07XG4gIH1cbn07XG5cbi8vIHBrZy9hdXRvLXBpcGVsaW5lLnRzXG52YXIgRVhDTFVERV9DT01NQU5EUyA9IC8qIEBfX1BVUkVfXyAqLyBuZXcgU2V0KFtcbiAgXCJzY2FuXCIsXG4gIFwia2V5c1wiLFxuICBcImZsdXNoZGJcIixcbiAgXCJmbHVzaGFsbFwiLFxuICBcImRic2l6ZVwiLFxuICBcImhzY2FuXCIsXG4gIFwiaGdldGFsbFwiLFxuICBcImhrZXlzXCIsXG4gIFwibHJhbmdlXCIsXG4gIFwic3NjYW5cIixcbiAgXCJzbWVtYmVyc1wiLFxuICBcInhyYW5nZVwiLFxuICBcInhyZXZyYW5nZVwiLFxuICBcInpzY2FuXCIsXG4gIFwienJhbmdlXCIsXG4gIFwiZXhlY1wiXG5dKTtcbmZ1bmN0aW9uIGNyZWF0ZUF1dG9QaXBlbGluZVByb3h5KF9yZWRpcywganNvbikge1xuICBjb25zdCByZWRpcyA9IF9yZWRpcztcbiAgaWYgKCFyZWRpcy5hdXRvUGlwZWxpbmVFeGVjdXRvcikge1xuICAgIHJlZGlzLmF1dG9QaXBlbGluZUV4ZWN1dG9yID0gbmV3IEF1dG9QaXBlbGluZUV4ZWN1dG9yKHJlZGlzKTtcbiAgfVxuICByZXR1cm4gbmV3IFByb3h5KHJlZGlzLCB7XG4gICAgZ2V0OiAocmVkaXMyLCBjb21tYW5kKSA9PiB7XG4gICAgICBpZiAoY29tbWFuZCA9PT0gXCJwaXBlbGluZUNvdW50ZXJcIikge1xuICAgICAgICByZXR1cm4gcmVkaXMyLmF1dG9QaXBlbGluZUV4ZWN1dG9yLnBpcGVsaW5lQ291bnRlcjtcbiAgICAgIH1cbiAgICAgIGlmIChjb21tYW5kID09PSBcImpzb25cIikge1xuICAgICAgICByZXR1cm4gY3JlYXRlQXV0b1BpcGVsaW5lUHJveHkocmVkaXMyLCB0cnVlKTtcbiAgICAgIH1cbiAgICAgIGNvbnN0IGNvbW1hbmRJblJlZGlzQnV0Tm90UGlwZWxpbmUgPSBjb21tYW5kIGluIHJlZGlzMiAmJiAhKGNvbW1hbmQgaW4gcmVkaXMyLmF1dG9QaXBlbGluZUV4ZWN1dG9yLnBpcGVsaW5lKTtcbiAgICAgIGNvbnN0IGlzQ29tbWFuZEV4Y2x1ZGVkID0gRVhDTFVERV9DT01NQU5EUy5oYXMoY29tbWFuZCk7XG4gICAgICBpZiAoY29tbWFuZEluUmVkaXNCdXROb3RQaXBlbGluZSB8fCBpc0NvbW1hbmRFeGNsdWRlZCkge1xuICAgICAgICByZXR1cm4gcmVkaXMyW2NvbW1hbmRdO1xuICAgICAgfVxuICAgICAgY29uc3QgaXNGdW5jdGlvbiA9IGpzb24gPyB0eXBlb2YgcmVkaXMyLmF1dG9QaXBlbGluZUV4ZWN1dG9yLnBpcGVsaW5lLmpzb25bY29tbWFuZF0gPT09IFwiZnVuY3Rpb25cIiA6IHR5cGVvZiByZWRpczIuYXV0b1BpcGVsaW5lRXhlY3V0b3IucGlwZWxpbmVbY29tbWFuZF0gPT09IFwiZnVuY3Rpb25cIjtcbiAgICAgIGlmIChpc0Z1bmN0aW9uKSB7XG4gICAgICAgIHJldHVybiAoLi4uYXJncykgPT4ge1xuICAgICAgICAgIHJldHVybiByZWRpczIuYXV0b1BpcGVsaW5lRXhlY3V0b3Iud2l0aEF1dG9QaXBlbGluZSgocGlwZWxpbmUpID0+IHtcbiAgICAgICAgICAgIGlmIChqc29uKSB7XG4gICAgICAgICAgICAgIHBpcGVsaW5lLmpzb25bY29tbWFuZF0oXG4gICAgICAgICAgICAgICAgLi4uYXJnc1xuICAgICAgICAgICAgICApO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgcGlwZWxpbmVbY29tbWFuZF0oLi4uYXJncyk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfSk7XG4gICAgICAgIH07XG4gICAgICB9XG4gICAgICByZXR1cm4gcmVkaXMyLmF1dG9QaXBlbGluZUV4ZWN1dG9yLnBpcGVsaW5lW2NvbW1hbmRdO1xuICAgIH1cbiAgfSk7XG59XG52YXIgQXV0b1BpcGVsaW5lRXhlY3V0b3IgPSBjbGFzcyB7XG4gIHBpcGVsaW5lUHJvbWlzZXMgPSAvKiBAX19QVVJFX18gKi8gbmV3IFdlYWtNYXAoKTtcbiAgYWN0aXZlUGlwZWxpbmUgPSBudWxsO1xuICBpbmRleEluQ3VycmVudFBpcGVsaW5lID0gMDtcbiAgcmVkaXM7XG4gIHBpcGVsaW5lO1xuICAvLyBvbmx5IHRvIG1ha2Ugc3VyZSB0aGF0IHByb3h5IGNhbiB3b3JrXG4gIHBpcGVsaW5lQ291bnRlciA9IDA7XG4gIC8vIHRvIGtlZXAgdHJhY2sgb2YgaG93IG1hbnkgdGltZXMgYSBwaXBlbGluZSB3YXMgZXhlY3V0ZWRcbiAgY29uc3RydWN0b3IocmVkaXMpIHtcbiAgICB0aGlzLnJlZGlzID0gcmVkaXM7XG4gICAgdGhpcy5waXBlbGluZSA9IHJlZGlzLnBpcGVsaW5lKCk7XG4gIH1cbiAgYXN5bmMgd2l0aEF1dG9QaXBlbGluZShleGVjdXRlV2l0aFBpcGVsaW5lKSB7XG4gICAgY29uc3QgcGlwZWxpbmUgPSB0aGlzLmFjdGl2ZVBpcGVsaW5lID8/IHRoaXMucmVkaXMucGlwZWxpbmUoKTtcbiAgICBpZiAoIXRoaXMuYWN0aXZlUGlwZWxpbmUpIHtcbiAgICAgIHRoaXMuYWN0aXZlUGlwZWxpbmUgPSBwaXBlbGluZTtcbiAgICAgIHRoaXMuaW5kZXhJbkN1cnJlbnRQaXBlbGluZSA9IDA7XG4gICAgfVxuICAgIGNvbnN0IGluZGV4ID0gdGhpcy5pbmRleEluQ3VycmVudFBpcGVsaW5lKys7XG4gICAgZXhlY3V0ZVdpdGhQaXBlbGluZShwaXBlbGluZSk7XG4gICAgY29uc3QgcGlwZWxpbmVEb25lID0gdGhpcy5kZWZlckV4ZWN1dGlvbigpLnRoZW4oKCkgPT4ge1xuICAgICAgaWYgKCF0aGlzLnBpcGVsaW5lUHJvbWlzZXMuaGFzKHBpcGVsaW5lKSkge1xuICAgICAgICBjb25zdCBwaXBlbGluZVByb21pc2UgPSBwaXBlbGluZS5leGVjKHsga2VlcEVycm9yczogdHJ1ZSB9KTtcbiAgICAgICAgdGhpcy5waXBlbGluZUNvdW50ZXIgKz0gMTtcbiAgICAgICAgdGhpcy5waXBlbGluZVByb21pc2VzLnNldChwaXBlbGluZSwgcGlwZWxpbmVQcm9taXNlKTtcbiAgICAgICAgdGhpcy5hY3RpdmVQaXBlbGluZSA9IG51bGw7XG4gICAgICB9XG4gICAgICByZXR1cm4gdGhpcy5waXBlbGluZVByb21pc2VzLmdldChwaXBlbGluZSk7XG4gICAgfSk7XG4gICAgY29uc3QgcmVzdWx0cyA9IGF3YWl0IHBpcGVsaW5lRG9uZTtcbiAgICBjb25zdCBjb21tYW5kUmVzdWx0ID0gcmVzdWx0c1tpbmRleF07XG4gICAgaWYgKGNvbW1hbmRSZXN1bHQuZXJyb3IpIHtcbiAgICAgIHRocm93IG5ldyBVcHN0YXNoRXJyb3IoYENvbW1hbmQgZmFpbGVkOiAke2NvbW1hbmRSZXN1bHQuZXJyb3J9YCk7XG4gICAgfVxuICAgIHJldHVybiBjb21tYW5kUmVzdWx0LnJlc3VsdDtcbiAgfVxuICBhc3luYyBkZWZlckV4ZWN1dGlvbigpIHtcbiAgICBhd2FpdCBQcm9taXNlLnJlc29sdmUoKTtcbiAgICBhd2FpdCBQcm9taXNlLnJlc29sdmUoKTtcbiAgfVxufTtcblxuLy8gcGtnL2NvbW1hbmRzL3BzdWJzY3JpYmUudHNcbnZhciBQU3Vic2NyaWJlQ29tbWFuZCA9IGNsYXNzIGV4dGVuZHMgQ29tbWFuZCB7XG4gIGNvbnN0cnVjdG9yKGNtZCwgb3B0cykge1xuICAgIGNvbnN0IHNzZUhlYWRlcnMgPSB7XG4gICAgICBBY2NlcHQ6IFwidGV4dC9ldmVudC1zdHJlYW1cIixcbiAgICAgIFwiQ2FjaGUtQ29udHJvbFwiOiBcIm5vLWNhY2hlXCIsXG4gICAgICBDb25uZWN0aW9uOiBcImtlZXAtYWxpdmVcIlxuICAgIH07XG4gICAgc3VwZXIoW10sIHtcbiAgICAgIC4uLm9wdHMsXG4gICAgICBoZWFkZXJzOiBzc2VIZWFkZXJzLFxuICAgICAgcGF0aDogW1wicHN1YnNjcmliZVwiLCAuLi5jbWRdLFxuICAgICAgc3RyZWFtT3B0aW9uczoge1xuICAgICAgICBpc1N0cmVhbWluZzogdHJ1ZSxcbiAgICAgICAgb25NZXNzYWdlOiBvcHRzPy5zdHJlYW1PcHRpb25zPy5vbk1lc3NhZ2UsXG4gICAgICAgIHNpZ25hbDogb3B0cz8uc3RyZWFtT3B0aW9ucz8uc2lnbmFsXG4gICAgICB9XG4gICAgfSk7XG4gIH1cbn07XG5cbi8vIHBrZy9jb21tYW5kcy9zdWJzY3JpYmUudHNcbnZhciBTdWJzY3JpYmVyID0gY2xhc3MgZXh0ZW5kcyBFdmVudFRhcmdldCB7XG4gIHN1YnNjcmlwdGlvbnM7XG4gIGNsaWVudDtcbiAgbGlzdGVuZXJzO1xuICBvcHRzO1xuICBjb25zdHJ1Y3RvcihjbGllbnQsIGNoYW5uZWxzLCBpc1BhdHRlcm4gPSBmYWxzZSwgb3B0cykge1xuICAgIHN1cGVyKCk7XG4gICAgdGhpcy5jbGllbnQgPSBjbGllbnQ7XG4gICAgdGhpcy5zdWJzY3JpcHRpb25zID0gLyogQF9fUFVSRV9fICovIG5ldyBNYXAoKTtcbiAgICB0aGlzLmxpc3RlbmVycyA9IC8qIEBfX1BVUkVfXyAqLyBuZXcgTWFwKCk7XG4gICAgdGhpcy5vcHRzID0gb3B0cztcbiAgICBmb3IgKGNvbnN0IGNoYW5uZWwgb2YgY2hhbm5lbHMpIHtcbiAgICAgIGlmIChpc1BhdHRlcm4pIHtcbiAgICAgICAgdGhpcy5zdWJzY3JpYmVUb1BhdHRlcm4oY2hhbm5lbCk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICB0aGlzLnN1YnNjcmliZVRvQ2hhbm5lbChjaGFubmVsKTtcbiAgICAgIH1cbiAgICB9XG4gIH1cbiAgc3Vic2NyaWJlVG9DaGFubmVsKGNoYW5uZWwpIHtcbiAgICBjb25zdCBjb250cm9sbGVyID0gbmV3IEFib3J0Q29udHJvbGxlcigpO1xuICAgIGNvbnN0IGNvbW1hbmQgPSBuZXcgU3Vic2NyaWJlQ29tbWFuZChbY2hhbm5lbF0sIHtcbiAgICAgIHN0cmVhbU9wdGlvbnM6IHtcbiAgICAgICAgc2lnbmFsOiBjb250cm9sbGVyLnNpZ25hbCxcbiAgICAgICAgb25NZXNzYWdlOiAoZGF0YSkgPT4gdGhpcy5oYW5kbGVNZXNzYWdlKGRhdGEsIGZhbHNlKVxuICAgICAgfVxuICAgIH0pO1xuICAgIGNvbW1hbmQuZXhlYyh0aGlzLmNsaWVudCkuY2F0Y2goKGVycm9yKSA9PiB7XG4gICAgICBpZiAoZXJyb3IubmFtZSAhPT0gXCJBYm9ydEVycm9yXCIpIHtcbiAgICAgICAgdGhpcy5kaXNwYXRjaFRvTGlzdGVuZXJzKFwiZXJyb3JcIiwgZXJyb3IpO1xuICAgICAgfVxuICAgIH0pO1xuICAgIHRoaXMuc3Vic2NyaXB0aW9ucy5zZXQoY2hhbm5lbCwge1xuICAgICAgY29tbWFuZCxcbiAgICAgIGNvbnRyb2xsZXIsXG4gICAgICBpc1BhdHRlcm46IGZhbHNlXG4gICAgfSk7XG4gIH1cbiAgc3Vic2NyaWJlVG9QYXR0ZXJuKHBhdHRlcm4pIHtcbiAgICBjb25zdCBjb250cm9sbGVyID0gbmV3IEFib3J0Q29udHJvbGxlcigpO1xuICAgIGNvbnN0IGNvbW1hbmQgPSBuZXcgUFN1YnNjcmliZUNvbW1hbmQoW3BhdHRlcm5dLCB7XG4gICAgICBzdHJlYW1PcHRpb25zOiB7XG4gICAgICAgIHNpZ25hbDogY29udHJvbGxlci5zaWduYWwsXG4gICAgICAgIG9uTWVzc2FnZTogKGRhdGEpID0+IHRoaXMuaGFuZGxlTWVzc2FnZShkYXRhLCB0cnVlKVxuICAgICAgfVxuICAgIH0pO1xuICAgIGNvbW1hbmQuZXhlYyh0aGlzLmNsaWVudCkuY2F0Y2goKGVycm9yKSA9PiB7XG4gICAgICBpZiAoZXJyb3IubmFtZSAhPT0gXCJBYm9ydEVycm9yXCIpIHtcbiAgICAgICAgdGhpcy5kaXNwYXRjaFRvTGlzdGVuZXJzKFwiZXJyb3JcIiwgZXJyb3IpO1xuICAgICAgfVxuICAgIH0pO1xuICAgIHRoaXMuc3Vic2NyaXB0aW9ucy5zZXQocGF0dGVybiwge1xuICAgICAgY29tbWFuZCxcbiAgICAgIGNvbnRyb2xsZXIsXG4gICAgICBpc1BhdHRlcm46IHRydWVcbiAgICB9KTtcbiAgfVxuICBoYW5kbGVNZXNzYWdlKGRhdGEsIGlzUGF0dGVybikge1xuICAgIGNvbnN0IG1lc3NhZ2VEYXRhID0gZGF0YS5yZXBsYWNlKC9eZGF0YTpcXHMqLywgXCJcIik7XG4gICAgY29uc3QgZmlyc3RDb21tYUluZGV4ID0gbWVzc2FnZURhdGEuaW5kZXhPZihcIixcIik7XG4gICAgY29uc3Qgc2Vjb25kQ29tbWFJbmRleCA9IG1lc3NhZ2VEYXRhLmluZGV4T2YoXCIsXCIsIGZpcnN0Q29tbWFJbmRleCArIDEpO1xuICAgIGNvbnN0IHRoaXJkQ29tbWFJbmRleCA9IGlzUGF0dGVybiA/IG1lc3NhZ2VEYXRhLmluZGV4T2YoXCIsXCIsIHNlY29uZENvbW1hSW5kZXggKyAxKSA6IC0xO1xuICAgIGlmIChmaXJzdENvbW1hSW5kZXggIT09IC0xICYmIHNlY29uZENvbW1hSW5kZXggIT09IC0xKSB7XG4gICAgICBjb25zdCB0eXBlID0gbWVzc2FnZURhdGEuc2xpY2UoMCwgZmlyc3RDb21tYUluZGV4KTtcbiAgICAgIGlmIChpc1BhdHRlcm4gJiYgdHlwZSA9PT0gXCJwbWVzc2FnZVwiICYmIHRoaXJkQ29tbWFJbmRleCAhPT0gLTEpIHtcbiAgICAgICAgY29uc3QgcGF0dGVybiA9IG1lc3NhZ2VEYXRhLnNsaWNlKGZpcnN0Q29tbWFJbmRleCArIDEsIHNlY29uZENvbW1hSW5kZXgpO1xuICAgICAgICBjb25zdCBjaGFubmVsID0gbWVzc2FnZURhdGEuc2xpY2Uoc2Vjb25kQ29tbWFJbmRleCArIDEsIHRoaXJkQ29tbWFJbmRleCk7XG4gICAgICAgIGNvbnN0IG1lc3NhZ2VTdHIgPSBtZXNzYWdlRGF0YS5zbGljZSh0aGlyZENvbW1hSW5kZXggKyAxKTtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICBjb25zdCBtZXNzYWdlID0gdGhpcy5vcHRzPy5hdXRvbWF0aWNEZXNlcmlhbGl6YXRpb24gPT09IGZhbHNlID8gbWVzc2FnZVN0ciA6IEpTT04ucGFyc2UobWVzc2FnZVN0cik7XG4gICAgICAgICAgdGhpcy5kaXNwYXRjaFRvTGlzdGVuZXJzKFwicG1lc3NhZ2VcIiwgeyBwYXR0ZXJuLCBjaGFubmVsLCBtZXNzYWdlIH0pO1xuICAgICAgICAgIHRoaXMuZGlzcGF0Y2hUb0xpc3RlbmVycyhgcG1lc3NhZ2U6JHtwYXR0ZXJufWAsIHsgcGF0dGVybiwgY2hhbm5lbCwgbWVzc2FnZSB9KTtcbiAgICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgICB0aGlzLmRpc3BhdGNoVG9MaXN0ZW5lcnMoXCJlcnJvclwiLCBuZXcgRXJyb3IoYEZhaWxlZCB0byBwYXJzZSBtZXNzYWdlOiAke2Vycm9yfWApKTtcbiAgICAgICAgfVxuICAgICAgfSBlbHNlIHtcbiAgICAgICAgY29uc3QgY2hhbm5lbCA9IG1lc3NhZ2VEYXRhLnNsaWNlKGZpcnN0Q29tbWFJbmRleCArIDEsIHNlY29uZENvbW1hSW5kZXgpO1xuICAgICAgICBjb25zdCBtZXNzYWdlU3RyID0gbWVzc2FnZURhdGEuc2xpY2Uoc2Vjb25kQ29tbWFJbmRleCArIDEpO1xuICAgICAgICB0cnkge1xuICAgICAgICAgIGlmICh0eXBlID09PSBcInN1YnNjcmliZVwiIHx8IHR5cGUgPT09IFwicHN1YnNjcmliZVwiIHx8IHR5cGUgPT09IFwidW5zdWJzY3JpYmVcIiB8fCB0eXBlID09PSBcInB1bnN1YnNjcmliZVwiKSB7XG4gICAgICAgICAgICBjb25zdCBjb3VudCA9IE51bWJlci5wYXJzZUludChtZXNzYWdlU3RyKTtcbiAgICAgICAgICAgIHRoaXMuZGlzcGF0Y2hUb0xpc3RlbmVycyh0eXBlLCBjb3VudCk7XG4gICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIGNvbnN0IG1lc3NhZ2UgPSB0aGlzLm9wdHM/LmF1dG9tYXRpY0Rlc2VyaWFsaXphdGlvbiA9PT0gZmFsc2UgPyBtZXNzYWdlU3RyIDogcGFyc2VXaXRoVHJ5Q2F0Y2gobWVzc2FnZVN0cik7XG4gICAgICAgICAgICB0aGlzLmRpc3BhdGNoVG9MaXN0ZW5lcnModHlwZSwgeyBjaGFubmVsLCBtZXNzYWdlIH0pO1xuICAgICAgICAgICAgdGhpcy5kaXNwYXRjaFRvTGlzdGVuZXJzKGAke3R5cGV9OiR7Y2hhbm5lbH1gLCB7IGNoYW5uZWwsIG1lc3NhZ2UgfSk7XG4gICAgICAgICAgfVxuICAgICAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICAgIHRoaXMuZGlzcGF0Y2hUb0xpc3RlbmVycyhcImVycm9yXCIsIG5ldyBFcnJvcihgRmFpbGVkIHRvIHBhcnNlIG1lc3NhZ2U6ICR7ZXJyb3J9YCkpO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuICB9XG4gIGRpc3BhdGNoVG9MaXN0ZW5lcnModHlwZSwgZGF0YSkge1xuICAgIGNvbnN0IGxpc3RlbmVycyA9IHRoaXMubGlzdGVuZXJzLmdldCh0eXBlKTtcbiAgICBpZiAobGlzdGVuZXJzKSB7XG4gICAgICBmb3IgKGNvbnN0IGxpc3RlbmVyIG9mIGxpc3RlbmVycykge1xuICAgICAgICBsaXN0ZW5lcihkYXRhKTtcbiAgICAgIH1cbiAgICB9XG4gIH1cbiAgb24odHlwZSwgbGlzdGVuZXIpIHtcbiAgICBpZiAoIXRoaXMubGlzdGVuZXJzLmhhcyh0eXBlKSkge1xuICAgICAgdGhpcy5saXN0ZW5lcnMuc2V0KHR5cGUsIC8qIEBfX1BVUkVfXyAqLyBuZXcgU2V0KCkpO1xuICAgIH1cbiAgICB0aGlzLmxpc3RlbmVycy5nZXQodHlwZSk/LmFkZChsaXN0ZW5lcik7XG4gIH1cbiAgcmVtb3ZlQWxsTGlzdGVuZXJzKCkge1xuICAgIHRoaXMubGlzdGVuZXJzLmNsZWFyKCk7XG4gIH1cbiAgYXN5bmMgdW5zdWJzY3JpYmUoY2hhbm5lbHMpIHtcbiAgICBpZiAoY2hhbm5lbHMpIHtcbiAgICAgIGZvciAoY29uc3QgY2hhbm5lbCBvZiBjaGFubmVscykge1xuICAgICAgICBjb25zdCBzdWJzY3JpcHRpb24gPSB0aGlzLnN1YnNjcmlwdGlvbnMuZ2V0KGNoYW5uZWwpO1xuICAgICAgICBpZiAoc3Vic2NyaXB0aW9uKSB7XG4gICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIHN1YnNjcmlwdGlvbi5jb250cm9sbGVyLmFib3J0KCk7XG4gICAgICAgICAgfSBjYXRjaCB7XG4gICAgICAgICAgfVxuICAgICAgICAgIHRoaXMuc3Vic2NyaXB0aW9ucy5kZWxldGUoY2hhbm5lbCk7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9IGVsc2Uge1xuICAgICAgZm9yIChjb25zdCBzdWJzY3JpcHRpb24gb2YgdGhpcy5zdWJzY3JpcHRpb25zLnZhbHVlcygpKSB7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgc3Vic2NyaXB0aW9uLmNvbnRyb2xsZXIuYWJvcnQoKTtcbiAgICAgICAgfSBjYXRjaCB7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICAgIHRoaXMuc3Vic2NyaXB0aW9ucy5jbGVhcigpO1xuICAgICAgdGhpcy5yZW1vdmVBbGxMaXN0ZW5lcnMoKTtcbiAgICB9XG4gIH1cbiAgZ2V0U3Vic2NyaWJlZENoYW5uZWxzKCkge1xuICAgIHJldHVybiBbLi4udGhpcy5zdWJzY3JpcHRpb25zLmtleXMoKV07XG4gIH1cbn07XG52YXIgU3Vic2NyaWJlQ29tbWFuZCA9IGNsYXNzIGV4dGVuZHMgQ29tbWFuZCB7XG4gIGNvbnN0cnVjdG9yKGNtZCwgb3B0cykge1xuICAgIGNvbnN0IHNzZUhlYWRlcnMgPSB7XG4gICAgICBBY2NlcHQ6IFwidGV4dC9ldmVudC1zdHJlYW1cIixcbiAgICAgIFwiQ2FjaGUtQ29udHJvbFwiOiBcIm5vLWNhY2hlXCIsXG4gICAgICBDb25uZWN0aW9uOiBcImtlZXAtYWxpdmVcIlxuICAgIH07XG4gICAgc3VwZXIoW10sIHtcbiAgICAgIC4uLm9wdHMsXG4gICAgICBoZWFkZXJzOiBzc2VIZWFkZXJzLFxuICAgICAgcGF0aDogW1wic3Vic2NyaWJlXCIsIC4uLmNtZF0sXG4gICAgICBzdHJlYW1PcHRpb25zOiB7XG4gICAgICAgIGlzU3RyZWFtaW5nOiB0cnVlLFxuICAgICAgICBvbk1lc3NhZ2U6IG9wdHM/LnN0cmVhbU9wdGlvbnM/Lm9uTWVzc2FnZSxcbiAgICAgICAgc2lnbmFsOiBvcHRzPy5zdHJlYW1PcHRpb25zPy5zaWduYWxcbiAgICAgIH1cbiAgICB9KTtcbiAgfVxufTtcbnZhciBwYXJzZVdpdGhUcnlDYXRjaCA9IChzdHIpID0+IHtcbiAgdHJ5IHtcbiAgICByZXR1cm4gSlNPTi5wYXJzZShzdHIpO1xuICB9IGNhdGNoIHtcbiAgICByZXR1cm4gc3RyO1xuICB9XG59O1xuXG4vLyBwa2cvc2NyaXB0LnRzXG5pbXBvcnQgeyBzdWJ0bGUgfSBmcm9tIFwidW5jcnlwdG9cIjtcbnZhciBTY3JpcHQgPSBjbGFzcyB7XG4gIHNjcmlwdDtcbiAgLyoqXG4gICAqIEBkZXByZWNhdGVkIFRoaXMgcHJvcGVydHkgaXMgaW5pdGlhbGl6ZWQgdG8gYW4gZW1wdHkgc3RyaW5nIGFuZCB3aWxsIGJlIHNldCBpbiB0aGUgaW5pdCBtZXRob2RcbiAgICogYXN5bmNocm9ub3VzbHkuIERvIG5vdCB1c2UgdGhpcyBwcm9wZXJ0eSBpbW1pZGlhdGVseSBhZnRlciB0aGUgY29uc3RydWN0b3IuXG4gICAqXG4gICAqIFRoaXMgcHJvcGVydHkgaXMgb25seSBleHBvc2VkIGZvciBiYWNrd2FyZHMgY29tcGF0aWJpbGl0eSBhbmQgd2lsbCBiZSByZW1vdmVkIGluIHRoZVxuICAgKiBmdXR1cmUgbWFqb3IgcmVsZWFzZS5cbiAgICovXG4gIHNoYTE7XG4gIHJlZGlzO1xuICBjb25zdHJ1Y3RvcihyZWRpcywgc2NyaXB0KSB7XG4gICAgdGhpcy5yZWRpcyA9IHJlZGlzO1xuICAgIHRoaXMuc2NyaXB0ID0gc2NyaXB0O1xuICAgIHRoaXMuc2hhMSA9IFwiXCI7XG4gICAgdm9pZCB0aGlzLmluaXQoc2NyaXB0KTtcbiAgfVxuICAvKipcbiAgICogSW5pdGlhbGl6ZSB0aGUgc2NyaXB0IGJ5IGNvbXB1dGluZyBpdHMgU0hBLTEgaGFzaC5cbiAgICovXG4gIGFzeW5jIGluaXQoc2NyaXB0KSB7XG4gICAgaWYgKHRoaXMuc2hhMSkgcmV0dXJuO1xuICAgIHRoaXMuc2hhMSA9IGF3YWl0IHRoaXMuZGlnZXN0KHNjcmlwdCk7XG4gIH1cbiAgLyoqXG4gICAqIFNlbmQgYW4gYEVWQUxgIGNvbW1hbmQgdG8gcmVkaXMuXG4gICAqL1xuICBhc3luYyBldmFsKGtleXMsIGFyZ3MpIHtcbiAgICBhd2FpdCB0aGlzLmluaXQodGhpcy5zY3JpcHQpO1xuICAgIHJldHVybiBhd2FpdCB0aGlzLnJlZGlzLmV2YWwodGhpcy5zY3JpcHQsIGtleXMsIGFyZ3MpO1xuICB9XG4gIC8qKlxuICAgKiBDYWxjdWxhdGVzIHRoZSBzaGExIGhhc2ggb2YgdGhlIHNjcmlwdCBhbmQgdGhlbiBjYWxscyBgRVZBTFNIQWAuXG4gICAqL1xuICBhc3luYyBldmFsc2hhKGtleXMsIGFyZ3MpIHtcbiAgICBhd2FpdCB0aGlzLmluaXQodGhpcy5zY3JpcHQpO1xuICAgIHJldHVybiBhd2FpdCB0aGlzLnJlZGlzLmV2YWxzaGEodGhpcy5zaGExLCBrZXlzLCBhcmdzKTtcbiAgfVxuICAvKipcbiAgICogT3B0aW1pc3RpY2FsbHkgdHJ5IHRvIHJ1biBgRVZBTFNIQWAgZmlyc3QuXG4gICAqIElmIHRoZSBzY3JpcHQgaXMgbm90IGxvYWRlZCBpbiByZWRpcywgaXQgd2lsbCBmYWxsIGJhY2sgYW5kIHRyeSBhZ2FpbiB3aXRoIGBFVkFMYC5cbiAgICpcbiAgICogRm9sbG93aW5nIGNhbGxzIHdpbGwgYmUgYWJsZSB0byB1c2UgdGhlIGNhY2hlZCBzY3JpcHRcbiAgICovXG4gIGFzeW5jIGV4ZWMoa2V5cywgYXJncykge1xuICAgIGF3YWl0IHRoaXMuaW5pdCh0aGlzLnNjcmlwdCk7XG4gICAgY29uc3QgcmVzID0gYXdhaXQgdGhpcy5yZWRpcy5ldmFsc2hhKHRoaXMuc2hhMSwga2V5cywgYXJncykuY2F0Y2goYXN5bmMgKGVycm9yKSA9PiB7XG4gICAgICBpZiAoZXJyb3IgaW5zdGFuY2VvZiBFcnJvciAmJiBlcnJvci5tZXNzYWdlLnRvTG93ZXJDYXNlKCkuaW5jbHVkZXMoXCJub3NjcmlwdFwiKSkge1xuICAgICAgICByZXR1cm4gYXdhaXQgdGhpcy5yZWRpcy5ldmFsKHRoaXMuc2NyaXB0LCBrZXlzLCBhcmdzKTtcbiAgICAgIH1cbiAgICAgIHRocm93IGVycm9yO1xuICAgIH0pO1xuICAgIHJldHVybiByZXM7XG4gIH1cbiAgLyoqXG4gICAqIENvbXB1dGUgdGhlIHNoYTEgaGFzaCBvZiB0aGUgc2NyaXB0IGFuZCByZXR1cm4gaXRzIGhleCByZXByZXNlbnRhdGlvbi5cbiAgICovXG4gIGFzeW5jIGRpZ2VzdChzKSB7XG4gICAgY29uc3QgZGF0YSA9IG5ldyBUZXh0RW5jb2RlcigpLmVuY29kZShzKTtcbiAgICBjb25zdCBoYXNoQnVmZmVyID0gYXdhaXQgc3VidGxlLmRpZ2VzdChcIlNIQS0xXCIsIGRhdGEpO1xuICAgIGNvbnN0IGhhc2hBcnJheSA9IFsuLi5uZXcgVWludDhBcnJheShoYXNoQnVmZmVyKV07XG4gICAgcmV0dXJuIGhhc2hBcnJheS5tYXAoKGIpID0+IGIudG9TdHJpbmcoMTYpLnBhZFN0YXJ0KDIsIFwiMFwiKSkuam9pbihcIlwiKTtcbiAgfVxufTtcblxuLy8gcGtnL3NjcmlwdFJvLnRzXG5pbXBvcnQgeyBzdWJ0bGUgYXMgc3VidGxlMiB9IGZyb20gXCJ1bmNyeXB0b1wiO1xudmFyIFNjcmlwdFJPID0gY2xhc3Mge1xuICBzY3JpcHQ7XG4gIC8qKlxuICAgKiBAZGVwcmVjYXRlZCBUaGlzIHByb3BlcnR5IGlzIGluaXRpYWxpemVkIHRvIGFuIGVtcHR5IHN0cmluZyBhbmQgd2lsbCBiZSBzZXQgaW4gdGhlIGluaXQgbWV0aG9kXG4gICAqIGFzeW5jaHJvbm91c2x5LiBEbyBub3QgdXNlIHRoaXMgcHJvcGVydHkgaW1taWRpYXRlbHkgYWZ0ZXIgdGhlIGNvbnN0cnVjdG9yLlxuICAgKlxuICAgKiBUaGlzIHByb3BlcnR5IGlzIG9ubHkgZXhwb3NlZCBmb3IgYmFja3dhcmRzIGNvbXBhdGliaWxpdHkgYW5kIHdpbGwgYmUgcmVtb3ZlZCBpbiB0aGVcbiAgICogZnV0dXJlIG1ham9yIHJlbGVhc2UuXG4gICAqL1xuICBzaGExO1xuICByZWRpcztcbiAgY29uc3RydWN0b3IocmVkaXMsIHNjcmlwdCkge1xuICAgIHRoaXMucmVkaXMgPSByZWRpcztcbiAgICB0aGlzLnNoYTEgPSBcIlwiO1xuICAgIHRoaXMuc2NyaXB0ID0gc2NyaXB0O1xuICAgIHZvaWQgdGhpcy5pbml0KHNjcmlwdCk7XG4gIH1cbiAgYXN5bmMgaW5pdChzY3JpcHQpIHtcbiAgICBpZiAodGhpcy5zaGExKSByZXR1cm47XG4gICAgdGhpcy5zaGExID0gYXdhaXQgdGhpcy5kaWdlc3Qoc2NyaXB0KTtcbiAgfVxuICAvKipcbiAgICogU2VuZCBhbiBgRVZBTF9ST2AgY29tbWFuZCB0byByZWRpcy5cbiAgICovXG4gIGFzeW5jIGV2YWxSbyhrZXlzLCBhcmdzKSB7XG4gICAgYXdhaXQgdGhpcy5pbml0KHRoaXMuc2NyaXB0KTtcbiAgICByZXR1cm4gYXdhaXQgdGhpcy5yZWRpcy5ldmFsUm8odGhpcy5zY3JpcHQsIGtleXMsIGFyZ3MpO1xuICB9XG4gIC8qKlxuICAgKiBDYWxjdWxhdGVzIHRoZSBzaGExIGhhc2ggb2YgdGhlIHNjcmlwdCBhbmQgdGhlbiBjYWxscyBgRVZBTFNIQV9ST2AuXG4gICAqL1xuICBhc3luYyBldmFsc2hhUm8oa2V5cywgYXJncykge1xuICAgIGF3YWl0IHRoaXMuaW5pdCh0aGlzLnNjcmlwdCk7XG4gICAgcmV0dXJuIGF3YWl0IHRoaXMucmVkaXMuZXZhbHNoYVJvKHRoaXMuc2hhMSwga2V5cywgYXJncyk7XG4gIH1cbiAgLyoqXG4gICAqIE9wdGltaXN0aWNhbGx5IHRyeSB0byBydW4gYEVWQUxTSEFfUk9gIGZpcnN0LlxuICAgKiBJZiB0aGUgc2NyaXB0IGlzIG5vdCBsb2FkZWQgaW4gcmVkaXMsIGl0IHdpbGwgZmFsbCBiYWNrIGFuZCB0cnkgYWdhaW4gd2l0aCBgRVZBTF9ST2AuXG4gICAqXG4gICAqIEZvbGxvd2luZyBjYWxscyB3aWxsIGJlIGFibGUgdG8gdXNlIHRoZSBjYWNoZWQgc2NyaXB0XG4gICAqL1xuICBhc3luYyBleGVjKGtleXMsIGFyZ3MpIHtcbiAgICBhd2FpdCB0aGlzLmluaXQodGhpcy5zY3JpcHQpO1xuICAgIGNvbnN0IHJlcyA9IGF3YWl0IHRoaXMucmVkaXMuZXZhbHNoYVJvKHRoaXMuc2hhMSwga2V5cywgYXJncykuY2F0Y2goYXN5bmMgKGVycm9yKSA9PiB7XG4gICAgICBpZiAoZXJyb3IgaW5zdGFuY2VvZiBFcnJvciAmJiBlcnJvci5tZXNzYWdlLnRvTG93ZXJDYXNlKCkuaW5jbHVkZXMoXCJub3NjcmlwdFwiKSkge1xuICAgICAgICByZXR1cm4gYXdhaXQgdGhpcy5yZWRpcy5ldmFsUm8odGhpcy5zY3JpcHQsIGtleXMsIGFyZ3MpO1xuICAgICAgfVxuICAgICAgdGhyb3cgZXJyb3I7XG4gICAgfSk7XG4gICAgcmV0dXJuIHJlcztcbiAgfVxuICAvKipcbiAgICogQ29tcHV0ZSB0aGUgc2hhMSBoYXNoIG9mIHRoZSBzY3JpcHQgYW5kIHJldHVybiBpdHMgaGV4IHJlcHJlc2VudGF0aW9uLlxuICAgKi9cbiAgYXN5bmMgZGlnZXN0KHMpIHtcbiAgICBjb25zdCBkYXRhID0gbmV3IFRleHRFbmNvZGVyKCkuZW5jb2RlKHMpO1xuICAgIGNvbnN0IGhhc2hCdWZmZXIgPSBhd2FpdCBzdWJ0bGUyLmRpZ2VzdChcIlNIQS0xXCIsIGRhdGEpO1xuICAgIGNvbnN0IGhhc2hBcnJheSA9IFsuLi5uZXcgVWludDhBcnJheShoYXNoQnVmZmVyKV07XG4gICAgcmV0dXJuIGhhc2hBcnJheS5tYXAoKGIpID0+IGIudG9TdHJpbmcoMTYpLnBhZFN0YXJ0KDIsIFwiMFwiKSkuam9pbihcIlwiKTtcbiAgfVxufTtcblxuLy8gcGtnL3JlZGlzLnRzXG52YXIgUmVkaXMgPSBjbGFzcyB7XG4gIGNsaWVudDtcbiAgb3B0cztcbiAgZW5hYmxlVGVsZW1ldHJ5O1xuICBlbmFibGVBdXRvUGlwZWxpbmluZztcbiAgLyoqXG4gICAqIENyZWF0ZSBhIG5ldyByZWRpcyBjbGllbnRcbiAgICpcbiAgICogQGV4YW1wbGVcbiAgICogYGBgdHlwZXNjcmlwdFxuICAgKiBjb25zdCByZWRpcyA9IG5ldyBSZWRpcyh7XG4gICAqICB1cmw6IFwiPFVQU1RBU0hfUkVESVNfUkVTVF9VUkw+XCIsXG4gICAqICB0b2tlbjogXCI8VVBTVEFTSF9SRURJU19SRVNUX1RPS0VOPlwiLFxuICAgKiB9KTtcbiAgICogYGBgXG4gICAqL1xuICBjb25zdHJ1Y3RvcihjbGllbnQsIG9wdHMpIHtcbiAgICB0aGlzLmNsaWVudCA9IGNsaWVudDtcbiAgICB0aGlzLm9wdHMgPSBvcHRzO1xuICAgIHRoaXMuZW5hYmxlVGVsZW1ldHJ5ID0gb3B0cz8uZW5hYmxlVGVsZW1ldHJ5ID8/IHRydWU7XG4gICAgaWYgKG9wdHM/LnJlYWRZb3VyV3JpdGVzID09PSBmYWxzZSkge1xuICAgICAgdGhpcy5jbGllbnQucmVhZFlvdXJXcml0ZXMgPSBmYWxzZTtcbiAgICB9XG4gICAgdGhpcy5lbmFibGVBdXRvUGlwZWxpbmluZyA9IG9wdHM/LmVuYWJsZUF1dG9QaXBlbGluaW5nID8/IHRydWU7XG4gIH1cbiAgZ2V0IHJlYWRZb3VyV3JpdGVzU3luY1Rva2VuKCkge1xuICAgIHJldHVybiB0aGlzLmNsaWVudC51cHN0YXNoU3luY1Rva2VuO1xuICB9XG4gIHNldCByZWFkWW91cldyaXRlc1N5bmNUb2tlbihzZXNzaW9uKSB7XG4gICAgdGhpcy5jbGllbnQudXBzdGFzaFN5bmNUb2tlbiA9IHNlc3Npb247XG4gIH1cbiAgZ2V0IGpzb24oKSB7XG4gICAgcmV0dXJuIHtcbiAgICAgIC8qKlxuICAgICAgICogQHNlZSBodHRwczovL3JlZGlzLmlvL2NvbW1hbmRzL2pzb24uYXJyYXBwZW5kXG4gICAgICAgKi9cbiAgICAgIGFycmFwcGVuZDogKC4uLmFyZ3MpID0+IG5ldyBKc29uQXJyQXBwZW5kQ29tbWFuZChhcmdzLCB0aGlzLm9wdHMpLmV4ZWModGhpcy5jbGllbnQpLFxuICAgICAgLyoqXG4gICAgICAgKiBAc2VlIGh0dHBzOi8vcmVkaXMuaW8vY29tbWFuZHMvanNvbi5hcnJpbmRleFxuICAgICAgICovXG4gICAgICBhcnJpbmRleDogKC4uLmFyZ3MpID0+IG5ldyBKc29uQXJySW5kZXhDb21tYW5kKGFyZ3MsIHRoaXMub3B0cykuZXhlYyh0aGlzLmNsaWVudCksXG4gICAgICAvKipcbiAgICAgICAqIEBzZWUgaHR0cHM6Ly9yZWRpcy5pby9jb21tYW5kcy9qc29uLmFycmluc2VydFxuICAgICAgICovXG4gICAgICBhcnJpbnNlcnQ6ICguLi5hcmdzKSA9PiBuZXcgSnNvbkFyckluc2VydENvbW1hbmQoYXJncywgdGhpcy5vcHRzKS5leGVjKHRoaXMuY2xpZW50KSxcbiAgICAgIC8qKlxuICAgICAgICogQHNlZSBodHRwczovL3JlZGlzLmlvL2NvbW1hbmRzL2pzb24uYXJybGVuXG4gICAgICAgKi9cbiAgICAgIGFycmxlbjogKC4uLmFyZ3MpID0+IG5ldyBKc29uQXJyTGVuQ29tbWFuZChhcmdzLCB0aGlzLm9wdHMpLmV4ZWModGhpcy5jbGllbnQpLFxuICAgICAgLyoqXG4gICAgICAgKiBAc2VlIGh0dHBzOi8vcmVkaXMuaW8vY29tbWFuZHMvanNvbi5hcnJwb3BcbiAgICAgICAqL1xuICAgICAgYXJycG9wOiAoLi4uYXJncykgPT4gbmV3IEpzb25BcnJQb3BDb21tYW5kKGFyZ3MsIHRoaXMub3B0cykuZXhlYyh0aGlzLmNsaWVudCksXG4gICAgICAvKipcbiAgICAgICAqIEBzZWUgaHR0cHM6Ly9yZWRpcy5pby9jb21tYW5kcy9qc29uLmFycnRyaW1cbiAgICAgICAqL1xuICAgICAgYXJydHJpbTogKC4uLmFyZ3MpID0+IG5ldyBKc29uQXJyVHJpbUNvbW1hbmQoYXJncywgdGhpcy5vcHRzKS5leGVjKHRoaXMuY2xpZW50KSxcbiAgICAgIC8qKlxuICAgICAgICogQHNlZSBodHRwczovL3JlZGlzLmlvL2NvbW1hbmRzL2pzb24uY2xlYXJcbiAgICAgICAqL1xuICAgICAgY2xlYXI6ICguLi5hcmdzKSA9PiBuZXcgSnNvbkNsZWFyQ29tbWFuZChhcmdzLCB0aGlzLm9wdHMpLmV4ZWModGhpcy5jbGllbnQpLFxuICAgICAgLyoqXG4gICAgICAgKiBAc2VlIGh0dHBzOi8vcmVkaXMuaW8vY29tbWFuZHMvanNvbi5kZWxcbiAgICAgICAqL1xuICAgICAgZGVsOiAoLi4uYXJncykgPT4gbmV3IEpzb25EZWxDb21tYW5kKGFyZ3MsIHRoaXMub3B0cykuZXhlYyh0aGlzLmNsaWVudCksXG4gICAgICAvKipcbiAgICAgICAqIEBzZWUgaHR0cHM6Ly9yZWRpcy5pby9jb21tYW5kcy9qc29uLmZvcmdldFxuICAgICAgICovXG4gICAgICBmb3JnZXQ6ICguLi5hcmdzKSA9PiBuZXcgSnNvbkZvcmdldENvbW1hbmQoYXJncywgdGhpcy5vcHRzKS5leGVjKHRoaXMuY2xpZW50KSxcbiAgICAgIC8qKlxuICAgICAgICogQHNlZSBodHRwczovL3JlZGlzLmlvL2NvbW1hbmRzL2pzb24uZ2V0XG4gICAgICAgKi9cbiAgICAgIGdldDogKC4uLmFyZ3MpID0+IG5ldyBKc29uR2V0Q29tbWFuZChhcmdzLCB0aGlzLm9wdHMpLmV4ZWModGhpcy5jbGllbnQpLFxuICAgICAgLyoqXG4gICAgICAgKiBAc2VlIGh0dHBzOi8vcmVkaXMuaW8vY29tbWFuZHMvanNvbi5tZXJnZVxuICAgICAgICovXG4gICAgICBtZXJnZTogKC4uLmFyZ3MpID0+IG5ldyBKc29uTWVyZ2VDb21tYW5kKGFyZ3MsIHRoaXMub3B0cykuZXhlYyh0aGlzLmNsaWVudCksXG4gICAgICAvKipcbiAgICAgICAqIEBzZWUgaHR0cHM6Ly9yZWRpcy5pby9jb21tYW5kcy9qc29uLm1nZXRcbiAgICAgICAqL1xuICAgICAgbWdldDogKC4uLmFyZ3MpID0+IG5ldyBKc29uTUdldENvbW1hbmQoYXJncywgdGhpcy5vcHRzKS5leGVjKHRoaXMuY2xpZW50KSxcbiAgICAgIC8qKlxuICAgICAgICogQHNlZSBodHRwczovL3JlZGlzLmlvL2NvbW1hbmRzL2pzb24ubXNldFxuICAgICAgICovXG4gICAgICBtc2V0OiAoLi4uYXJncykgPT4gbmV3IEpzb25NU2V0Q29tbWFuZChhcmdzLCB0aGlzLm9wdHMpLmV4ZWModGhpcy5jbGllbnQpLFxuICAgICAgLyoqXG4gICAgICAgKiBAc2VlIGh0dHBzOi8vcmVkaXMuaW8vY29tbWFuZHMvanNvbi5udW1pbmNyYnlcbiAgICAgICAqL1xuICAgICAgbnVtaW5jcmJ5OiAoLi4uYXJncykgPT4gbmV3IEpzb25OdW1JbmNyQnlDb21tYW5kKGFyZ3MsIHRoaXMub3B0cykuZXhlYyh0aGlzLmNsaWVudCksXG4gICAgICAvKipcbiAgICAgICAqIEBzZWUgaHR0cHM6Ly9yZWRpcy5pby9jb21tYW5kcy9qc29uLm51bW11bHRieVxuICAgICAgICovXG4gICAgICBudW1tdWx0Ynk6ICguLi5hcmdzKSA9PiBuZXcgSnNvbk51bU11bHRCeUNvbW1hbmQoYXJncywgdGhpcy5vcHRzKS5leGVjKHRoaXMuY2xpZW50KSxcbiAgICAgIC8qKlxuICAgICAgICogQHNlZSBodHRwczovL3JlZGlzLmlvL2NvbW1hbmRzL2pzb24ub2Jqa2V5c1xuICAgICAgICovXG4gICAgICBvYmprZXlzOiAoLi4uYXJncykgPT4gbmV3IEpzb25PYmpLZXlzQ29tbWFuZChhcmdzLCB0aGlzLm9wdHMpLmV4ZWModGhpcy5jbGllbnQpLFxuICAgICAgLyoqXG4gICAgICAgKiBAc2VlIGh0dHBzOi8vcmVkaXMuaW8vY29tbWFuZHMvanNvbi5vYmpsZW5cbiAgICAgICAqL1xuICAgICAgb2JqbGVuOiAoLi4uYXJncykgPT4gbmV3IEpzb25PYmpMZW5Db21tYW5kKGFyZ3MsIHRoaXMub3B0cykuZXhlYyh0aGlzLmNsaWVudCksXG4gICAgICAvKipcbiAgICAgICAqIEBzZWUgaHR0cHM6Ly9yZWRpcy5pby9jb21tYW5kcy9qc29uLnJlc3BcbiAgICAgICAqL1xuICAgICAgcmVzcDogKC4uLmFyZ3MpID0+IG5ldyBKc29uUmVzcENvbW1hbmQoYXJncywgdGhpcy5vcHRzKS5leGVjKHRoaXMuY2xpZW50KSxcbiAgICAgIC8qKlxuICAgICAgICogQHNlZSBodHRwczovL3JlZGlzLmlvL2NvbW1hbmRzL2pzb24uc2V0XG4gICAgICAgKi9cbiAgICAgIHNldDogKC4uLmFyZ3MpID0+IG5ldyBKc29uU2V0Q29tbWFuZChhcmdzLCB0aGlzLm9wdHMpLmV4ZWModGhpcy5jbGllbnQpLFxuICAgICAgLyoqXG4gICAgICAgKiBAc2VlIGh0dHBzOi8vcmVkaXMuaW8vY29tbWFuZHMvanNvbi5zdHJhcHBlbmRcbiAgICAgICAqL1xuICAgICAgc3RyYXBwZW5kOiAoLi4uYXJncykgPT4gbmV3IEpzb25TdHJBcHBlbmRDb21tYW5kKGFyZ3MsIHRoaXMub3B0cykuZXhlYyh0aGlzLmNsaWVudCksXG4gICAgICAvKipcbiAgICAgICAqIEBzZWUgaHR0cHM6Ly9yZWRpcy5pby9jb21tYW5kcy9qc29uLnN0cmxlblxuICAgICAgICovXG4gICAgICBzdHJsZW46ICguLi5hcmdzKSA9PiBuZXcgSnNvblN0ckxlbkNvbW1hbmQoYXJncywgdGhpcy5vcHRzKS5leGVjKHRoaXMuY2xpZW50KSxcbiAgICAgIC8qKlxuICAgICAgICogQHNlZSBodHRwczovL3JlZGlzLmlvL2NvbW1hbmRzL2pzb24udG9nZ2xlXG4gICAgICAgKi9cbiAgICAgIHRvZ2dsZTogKC4uLmFyZ3MpID0+IG5ldyBKc29uVG9nZ2xlQ29tbWFuZChhcmdzLCB0aGlzLm9wdHMpLmV4ZWModGhpcy5jbGllbnQpLFxuICAgICAgLyoqXG4gICAgICAgKiBAc2VlIGh0dHBzOi8vcmVkaXMuaW8vY29tbWFuZHMvanNvbi50eXBlXG4gICAgICAgKi9cbiAgICAgIHR5cGU6ICguLi5hcmdzKSA9PiBuZXcgSnNvblR5cGVDb21tYW5kKGFyZ3MsIHRoaXMub3B0cykuZXhlYyh0aGlzLmNsaWVudClcbiAgICB9O1xuICB9XG4gIC8qKlxuICAgKiBXcmFwIGEgbmV3IG1pZGRsZXdhcmUgYXJvdW5kIHRoZSBIVFRQIGNsaWVudC5cbiAgICovXG4gIHVzZSA9IChtaWRkbGV3YXJlKSA9PiB7XG4gICAgY29uc3QgbWFrZVJlcXVlc3QgPSB0aGlzLmNsaWVudC5yZXF1ZXN0LmJpbmQodGhpcy5jbGllbnQpO1xuICAgIHRoaXMuY2xpZW50LnJlcXVlc3QgPSAocmVxKSA9PiBtaWRkbGV3YXJlKHJlcSwgbWFrZVJlcXVlc3QpO1xuICB9O1xuICAvKipcbiAgICogVGVjaG5pY2FsbHkgdGhpcyBpcyBub3QgcHJpdmF0ZSwgd2UgY2FuIGhpZGUgaXQgZnJvbSBpbnRlbGxpc2Vuc2UgYnkgZG9pbmcgdGhpc1xuICAgKi9cbiAgYWRkVGVsZW1ldHJ5ID0gKHRlbGVtZXRyeSkgPT4ge1xuICAgIGlmICghdGhpcy5lbmFibGVUZWxlbWV0cnkpIHtcbiAgICAgIHJldHVybjtcbiAgICB9XG4gICAgdHJ5IHtcbiAgICAgIHRoaXMuY2xpZW50Lm1lcmdlVGVsZW1ldHJ5KHRlbGVtZXRyeSk7XG4gICAgfSBjYXRjaCB7XG4gICAgfVxuICB9O1xuICAvKipcbiAgICogQ3JlYXRlcyBhIG5ldyBzY3JpcHQuXG4gICAqXG4gICAqIFNjcmlwdHMgb2ZmZXIgdGhlIGFiaWxpdHkgdG8gb3B0aW1pc3RpY2FsbHkgdHJ5IHRvIGV4ZWN1dGUgYSBzY3JpcHQgd2l0aG91dCBoYXZpbmcgdG8gc2VuZCB0aGVcbiAgICogZW50aXJlIHNjcmlwdCB0byB0aGUgc2VydmVyLiBJZiB0aGUgc2NyaXB0IGlzIGxvYWRlZCBvbiB0aGUgc2VydmVyLCBpdCB0cmllcyBhZ2FpbiBieSBzZW5kaW5nXG4gICAqIHRoZSBlbnRpcmUgc2NyaXB0LiBBZnRlcndhcmRzLCB0aGUgc2NyaXB0IGlzIGNhY2hlZCBvbiB0aGUgc2VydmVyLlxuICAgKlxuICAgKiBAcGFyYW0gc2NyaXB0IC0gVGhlIHNjcmlwdCB0byBjcmVhdGVcbiAgICogQHBhcmFtIG9wdHMgLSBPcHRpb25hbCBvcHRpb25zIHRvIHBhc3MgdG8gdGhlIHNjcmlwdCBgeyByZWFkb25seT86IGJvb2xlYW4gfWBcbiAgICogQHJldHVybnMgQSBuZXcgc2NyaXB0XG4gICAqXG4gICAqIEBleGFtcGxlXG4gICAqIGBgYHRzXG4gICAqIGNvbnN0IHJlZGlzID0gbmV3IFJlZGlzKHsuLi59KVxuICAgKlxuICAgKiBjb25zdCBzY3JpcHQgPSByZWRpcy5jcmVhdGVTY3JpcHQ8c3RyaW5nPihcInJldHVybiBBUkdWWzFdO1wiKVxuICAgKiBjb25zdCBhcmcxID0gYXdhaXQgc2NyaXB0LmV2YWwoW10sIFtcIkhlbGxvIFdvcmxkXCJdKVxuICAgKiBleHBlY3QoYXJnMSwgXCJIZWxsbyBXb3JsZFwiKVxuICAgKiBgYGBcbiAgICogQGV4YW1wbGVcbiAgICogYGBgdHNcbiAgICogY29uc3QgcmVkaXMgPSBuZXcgUmVkaXMoey4uLn0pXG4gICAqXG4gICAqIGNvbnN0IHNjcmlwdCA9IHJlZGlzLmNyZWF0ZVNjcmlwdDxzdHJpbmc+KFwicmV0dXJuIEFSR1ZbMV07XCIsIHsgcmVhZG9ubHk6IHRydWUgfSlcbiAgICogY29uc3QgYXJnMSA9IGF3YWl0IHNjcmlwdC5ldmFsUm8oW10sIFtcIkhlbGxvIFdvcmxkXCJdKVxuICAgKiBleHBlY3QoYXJnMSwgXCJIZWxsbyBXb3JsZFwiKVxuICAgKiBgYGBcbiAgICovXG4gIGNyZWF0ZVNjcmlwdChzY3JpcHQsIG9wdHMpIHtcbiAgICByZXR1cm4gb3B0cz8ucmVhZG9ubHkgPyBuZXcgU2NyaXB0Uk8odGhpcywgc2NyaXB0KSA6IG5ldyBTY3JpcHQodGhpcywgc2NyaXB0KTtcbiAgfVxuICAvKipcbiAgICogQ3JlYXRlIGEgbmV3IHBpcGVsaW5lIHRoYXQgYWxsb3dzIHlvdSB0byBzZW5kIHJlcXVlc3RzIGluIGJ1bGsuXG4gICAqXG4gICAqIEBzZWUge0BsaW5rIFBpcGVsaW5lfVxuICAgKi9cbiAgcGlwZWxpbmUgPSAoKSA9PiBuZXcgUGlwZWxpbmUoe1xuICAgIGNsaWVudDogdGhpcy5jbGllbnQsXG4gICAgY29tbWFuZE9wdGlvbnM6IHRoaXMub3B0cyxcbiAgICBtdWx0aUV4ZWM6IGZhbHNlXG4gIH0pO1xuICBhdXRvUGlwZWxpbmUgPSAoKSA9PiB7XG4gICAgcmV0dXJuIGNyZWF0ZUF1dG9QaXBlbGluZVByb3h5KHRoaXMpO1xuICB9O1xuICAvKipcbiAgICogQ3JlYXRlIGEgbmV3IHRyYW5zYWN0aW9uIHRvIGFsbG93IGV4ZWN1dGluZyBtdWx0aXBsZSBzdGVwcyBhdG9taWNhbGx5LlxuICAgKlxuICAgKiBBbGwgdGhlIGNvbW1hbmRzIGluIGEgdHJhbnNhY3Rpb24gYXJlIHNlcmlhbGl6ZWQgYW5kIGV4ZWN1dGVkIHNlcXVlbnRpYWxseS4gQSByZXF1ZXN0IHNlbnQgYnlcbiAgICogYW5vdGhlciBjbGllbnQgd2lsbCBuZXZlciBiZSBzZXJ2ZWQgaW4gdGhlIG1pZGRsZSBvZiB0aGUgZXhlY3V0aW9uIG9mIGEgUmVkaXMgVHJhbnNhY3Rpb24uIFRoaXNcbiAgICogZ3VhcmFudGVlcyB0aGF0IHRoZSBjb21tYW5kcyBhcmUgZXhlY3V0ZWQgYXMgYSBzaW5nbGUgaXNvbGF0ZWQgb3BlcmF0aW9uLlxuICAgKlxuICAgKiBAc2VlIHtAbGluayBQaXBlbGluZX1cbiAgICovXG4gIG11bHRpID0gKCkgPT4gbmV3IFBpcGVsaW5lKHtcbiAgICBjbGllbnQ6IHRoaXMuY2xpZW50LFxuICAgIGNvbW1hbmRPcHRpb25zOiB0aGlzLm9wdHMsXG4gICAgbXVsdGlFeGVjOiB0cnVlXG4gIH0pO1xuICAvKipcbiAgICogUmV0dXJucyBhbiBpbnN0YW5jZSB0aGF0IGNhbiBiZSB1c2VkIHRvIGV4ZWN1dGUgYEJJVEZJRUxEYCBjb21tYW5kcyBvbiBvbmUga2V5LlxuICAgKlxuICAgKiBAZXhhbXBsZVxuICAgKiBgYGB0eXBlc2NyaXB0XG4gICAqIHJlZGlzLnNldChcIm15a2V5XCIsIDApO1xuICAgKiBjb25zdCByZXN1bHQgPSBhd2FpdCByZWRpcy5iaXRmaWVsZChcIm15a2V5XCIpXG4gICAqICAgLnNldChcInU0XCIsIDAsIDE2KVxuICAgKiAgIC5pbmNyKFwidTRcIiwgXCIjMVwiLCAxKVxuICAgKiAgIC5leGVjKCk7XG4gICAqIGNvbnNvbGUubG9nKHJlc3VsdCk7IC8vIFswLCAxXVxuICAgKiBgYGBcbiAgICpcbiAgICogQHNlZSBodHRwczovL3JlZGlzLmlvL2NvbW1hbmRzL2JpdGZpZWxkXG4gICAqL1xuICBiaXRmaWVsZCA9ICguLi5hcmdzKSA9PiBuZXcgQml0RmllbGRDb21tYW5kKGFyZ3MsIHRoaXMuY2xpZW50LCB0aGlzLm9wdHMpO1xuICAvKipcbiAgICogQHNlZSBodHRwczovL3JlZGlzLmlvL2NvbW1hbmRzL2FwcGVuZFxuICAgKi9cbiAgYXBwZW5kID0gKC4uLmFyZ3MpID0+IG5ldyBBcHBlbmRDb21tYW5kKGFyZ3MsIHRoaXMub3B0cykuZXhlYyh0aGlzLmNsaWVudCk7XG4gIC8qKlxuICAgKiBAc2VlIGh0dHBzOi8vcmVkaXMuaW8vY29tbWFuZHMvYml0Y291bnRcbiAgICovXG4gIGJpdGNvdW50ID0gKC4uLmFyZ3MpID0+IG5ldyBCaXRDb3VudENvbW1hbmQoYXJncywgdGhpcy5vcHRzKS5leGVjKHRoaXMuY2xpZW50KTtcbiAgLyoqXG4gICAqIEBzZWUgaHR0cHM6Ly9yZWRpcy5pby9jb21tYW5kcy9iaXRvcFxuICAgKi9cbiAgYml0b3AgPSAob3AsIGRlc3RpbmF0aW9uS2V5LCBzb3VyY2VLZXksIC4uLnNvdXJjZUtleXMpID0+IG5ldyBCaXRPcENvbW1hbmQoW29wLCBkZXN0aW5hdGlvbktleSwgc291cmNlS2V5LCAuLi5zb3VyY2VLZXlzXSwgdGhpcy5vcHRzKS5leGVjKFxuICAgIHRoaXMuY2xpZW50XG4gICk7XG4gIC8qKlxuICAgKiBAc2VlIGh0dHBzOi8vcmVkaXMuaW8vY29tbWFuZHMvYml0cG9zXG4gICAqL1xuICBiaXRwb3MgPSAoLi4uYXJncykgPT4gbmV3IEJpdFBvc0NvbW1hbmQoYXJncywgdGhpcy5vcHRzKS5leGVjKHRoaXMuY2xpZW50KTtcbiAgLyoqXG4gICAqIEBzZWUgaHR0cHM6Ly9yZWRpcy5pby9jb21tYW5kcy9jb3B5XG4gICAqL1xuICBjb3B5ID0gKC4uLmFyZ3MpID0+IG5ldyBDb3B5Q29tbWFuZChhcmdzLCB0aGlzLm9wdHMpLmV4ZWModGhpcy5jbGllbnQpO1xuICAvKipcbiAgICogQHNlZSBodHRwczovL3JlZGlzLmlvL2NvbW1hbmRzL2Ric2l6ZVxuICAgKi9cbiAgZGJzaXplID0gKCkgPT4gbmV3IERCU2l6ZUNvbW1hbmQodGhpcy5vcHRzKS5leGVjKHRoaXMuY2xpZW50KTtcbiAgLyoqXG4gICAqIEBzZWUgaHR0cHM6Ly9yZWRpcy5pby9jb21tYW5kcy9kZWNyXG4gICAqL1xuICBkZWNyID0gKC4uLmFyZ3MpID0+IG5ldyBEZWNyQ29tbWFuZChhcmdzLCB0aGlzLm9wdHMpLmV4ZWModGhpcy5jbGllbnQpO1xuICAvKipcbiAgICogQHNlZSBodHRwczovL3JlZGlzLmlvL2NvbW1hbmRzL2RlY3JieVxuICAgKi9cbiAgZGVjcmJ5ID0gKC4uLmFyZ3MpID0+IG5ldyBEZWNyQnlDb21tYW5kKGFyZ3MsIHRoaXMub3B0cykuZXhlYyh0aGlzLmNsaWVudCk7XG4gIC8qKlxuICAgKiBAc2VlIGh0dHBzOi8vcmVkaXMuaW8vY29tbWFuZHMvZGVsXG4gICAqL1xuICBkZWwgPSAoLi4uYXJncykgPT4gbmV3IERlbENvbW1hbmQoYXJncywgdGhpcy5vcHRzKS5leGVjKHRoaXMuY2xpZW50KTtcbiAgLyoqXG4gICAqIEBzZWUgaHR0cHM6Ly9yZWRpcy5pby9jb21tYW5kcy9lY2hvXG4gICAqL1xuICBlY2hvID0gKC4uLmFyZ3MpID0+IG5ldyBFY2hvQ29tbWFuZChhcmdzLCB0aGlzLm9wdHMpLmV4ZWModGhpcy5jbGllbnQpO1xuICAvKipcbiAgICogQHNlZSBodHRwczovL3JlZGlzLmlvL2NvbW1hbmRzL2V2YWxfcm9cbiAgICovXG4gIGV2YWxSbyA9ICguLi5hcmdzKSA9PiBuZXcgRXZhbFJPQ29tbWFuZChhcmdzLCB0aGlzLm9wdHMpLmV4ZWModGhpcy5jbGllbnQpO1xuICAvKipcbiAgICogQHNlZSBodHRwczovL3JlZGlzLmlvL2NvbW1hbmRzL2V2YWxcbiAgICovXG4gIGV2YWwgPSAoLi4uYXJncykgPT4gbmV3IEV2YWxDb21tYW5kKGFyZ3MsIHRoaXMub3B0cykuZXhlYyh0aGlzLmNsaWVudCk7XG4gIC8qKlxuICAgKiBAc2VlIGh0dHBzOi8vcmVkaXMuaW8vY29tbWFuZHMvZXZhbHNoYV9yb1xuICAgKi9cbiAgZXZhbHNoYVJvID0gKC4uLmFyZ3MpID0+IG5ldyBFdmFsc2hhUk9Db21tYW5kKGFyZ3MsIHRoaXMub3B0cykuZXhlYyh0aGlzLmNsaWVudCk7XG4gIC8qKlxuICAgKiBAc2VlIGh0dHBzOi8vcmVkaXMuaW8vY29tbWFuZHMvZXZhbHNoYVxuICAgKi9cbiAgZXZhbHNoYSA9ICguLi5hcmdzKSA9PiBuZXcgRXZhbHNoYUNvbW1hbmQoYXJncywgdGhpcy5vcHRzKS5leGVjKHRoaXMuY2xpZW50KTtcbiAgLyoqXG4gICAqIEdlbmVyaWMgbWV0aG9kIHRvIGV4ZWN1dGUgYW55IFJlZGlzIGNvbW1hbmQuXG4gICAqL1xuICBleGVjID0gKGFyZ3MpID0+IG5ldyBFeGVjQ29tbWFuZChhcmdzLCB0aGlzLm9wdHMpLmV4ZWModGhpcy5jbGllbnQpO1xuICAvKipcbiAgICogQHNlZSBodHRwczovL3JlZGlzLmlvL2NvbW1hbmRzL2V4aXN0c1xuICAgKi9cbiAgZXhpc3RzID0gKC4uLmFyZ3MpID0+IG5ldyBFeGlzdHNDb21tYW5kKGFyZ3MsIHRoaXMub3B0cykuZXhlYyh0aGlzLmNsaWVudCk7XG4gIC8qKlxuICAgKiBAc2VlIGh0dHBzOi8vcmVkaXMuaW8vY29tbWFuZHMvZXhwaXJlXG4gICAqL1xuICBleHBpcmUgPSAoLi4uYXJncykgPT4gbmV3IEV4cGlyZUNvbW1hbmQoYXJncywgdGhpcy5vcHRzKS5leGVjKHRoaXMuY2xpZW50KTtcbiAgLyoqXG4gICAqIEBzZWUgaHR0cHM6Ly9yZWRpcy5pby9jb21tYW5kcy9leHBpcmVhdFxuICAgKi9cbiAgZXhwaXJlYXQgPSAoLi4uYXJncykgPT4gbmV3IEV4cGlyZUF0Q29tbWFuZChhcmdzLCB0aGlzLm9wdHMpLmV4ZWModGhpcy5jbGllbnQpO1xuICAvKipcbiAgICogQHNlZSBodHRwczovL3JlZGlzLmlvL2NvbW1hbmRzL2ZsdXNoYWxsXG4gICAqL1xuICBmbHVzaGFsbCA9IChhcmdzKSA9PiBuZXcgRmx1c2hBbGxDb21tYW5kKGFyZ3MsIHRoaXMub3B0cykuZXhlYyh0aGlzLmNsaWVudCk7XG4gIC8qKlxuICAgKiBAc2VlIGh0dHBzOi8vcmVkaXMuaW8vY29tbWFuZHMvZmx1c2hkYlxuICAgKi9cbiAgZmx1c2hkYiA9ICguLi5hcmdzKSA9PiBuZXcgRmx1c2hEQkNvbW1hbmQoYXJncywgdGhpcy5vcHRzKS5leGVjKHRoaXMuY2xpZW50KTtcbiAgLyoqXG4gICAqIEBzZWUgaHR0cHM6Ly9yZWRpcy5pby9jb21tYW5kcy9nZW9hZGRcbiAgICovXG4gIGdlb2FkZCA9ICguLi5hcmdzKSA9PiBuZXcgR2VvQWRkQ29tbWFuZChhcmdzLCB0aGlzLm9wdHMpLmV4ZWModGhpcy5jbGllbnQpO1xuICAvKipcbiAgICogQHNlZSBodHRwczovL3JlZGlzLmlvL2NvbW1hbmRzL2dlb3Bvc1xuICAgKi9cbiAgZ2VvcG9zID0gKC4uLmFyZ3MpID0+IG5ldyBHZW9Qb3NDb21tYW5kKGFyZ3MsIHRoaXMub3B0cykuZXhlYyh0aGlzLmNsaWVudCk7XG4gIC8qKlxuICAgKiBAc2VlIGh0dHBzOi8vcmVkaXMuaW8vY29tbWFuZHMvZ2VvZGlzdFxuICAgKi9cbiAgZ2VvZGlzdCA9ICguLi5hcmdzKSA9PiBuZXcgR2VvRGlzdENvbW1hbmQoYXJncywgdGhpcy5vcHRzKS5leGVjKHRoaXMuY2xpZW50KTtcbiAgLyoqXG4gICAqIEBzZWUgaHR0cHM6Ly9yZWRpcy5pby9jb21tYW5kcy9nZW9oYXNoXG4gICAqL1xuICBnZW9oYXNoID0gKC4uLmFyZ3MpID0+IG5ldyBHZW9IYXNoQ29tbWFuZChhcmdzLCB0aGlzLm9wdHMpLmV4ZWModGhpcy5jbGllbnQpO1xuICAvKipcbiAgICogQHNlZSBodHRwczovL3JlZGlzLmlvL2NvbW1hbmRzL2dlb3NlYXJjaFxuICAgKi9cbiAgZ2Vvc2VhcmNoID0gKC4uLmFyZ3MpID0+IG5ldyBHZW9TZWFyY2hDb21tYW5kKGFyZ3MsIHRoaXMub3B0cykuZXhlYyh0aGlzLmNsaWVudCk7XG4gIC8qKlxuICAgKiBAc2VlIGh0dHBzOi8vcmVkaXMuaW8vY29tbWFuZHMvZ2Vvc2VhcmNoc3RvcmVcbiAgICovXG4gIGdlb3NlYXJjaHN0b3JlID0gKC4uLmFyZ3MpID0+IG5ldyBHZW9TZWFyY2hTdG9yZUNvbW1hbmQoYXJncywgdGhpcy5vcHRzKS5leGVjKHRoaXMuY2xpZW50KTtcbiAgLyoqXG4gICAqIEBzZWUgaHR0cHM6Ly9yZWRpcy5pby9jb21tYW5kcy9nZXRcbiAgICovXG4gIGdldCA9ICguLi5hcmdzKSA9PiBuZXcgR2V0Q29tbWFuZChhcmdzLCB0aGlzLm9wdHMpLmV4ZWModGhpcy5jbGllbnQpO1xuICAvKipcbiAgICogQHNlZSBodHRwczovL3JlZGlzLmlvL2NvbW1hbmRzL2dldGJpdFxuICAgKi9cbiAgZ2V0Yml0ID0gKC4uLmFyZ3MpID0+IG5ldyBHZXRCaXRDb21tYW5kKGFyZ3MsIHRoaXMub3B0cykuZXhlYyh0aGlzLmNsaWVudCk7XG4gIC8qKlxuICAgKiBAc2VlIGh0dHBzOi8vcmVkaXMuaW8vY29tbWFuZHMvZ2V0ZGVsXG4gICAqL1xuICBnZXRkZWwgPSAoLi4uYXJncykgPT4gbmV3IEdldERlbENvbW1hbmQoYXJncywgdGhpcy5vcHRzKS5leGVjKHRoaXMuY2xpZW50KTtcbiAgLyoqXG4gICAqIEBzZWUgaHR0cHM6Ly9yZWRpcy5pby9jb21tYW5kcy9nZXRleFxuICAgKi9cbiAgZ2V0ZXggPSAoLi4uYXJncykgPT4gbmV3IEdldEV4Q29tbWFuZChhcmdzLCB0aGlzLm9wdHMpLmV4ZWModGhpcy5jbGllbnQpO1xuICAvKipcbiAgICogQHNlZSBodHRwczovL3JlZGlzLmlvL2NvbW1hbmRzL2dldHJhbmdlXG4gICAqL1xuICBnZXRyYW5nZSA9ICguLi5hcmdzKSA9PiBuZXcgR2V0UmFuZ2VDb21tYW5kKGFyZ3MsIHRoaXMub3B0cykuZXhlYyh0aGlzLmNsaWVudCk7XG4gIC8qKlxuICAgKiBAc2VlIGh0dHBzOi8vcmVkaXMuaW8vY29tbWFuZHMvZ2V0c2V0XG4gICAqL1xuICBnZXRzZXQgPSAoa2V5LCB2YWx1ZSkgPT4gbmV3IEdldFNldENvbW1hbmQoW2tleSwgdmFsdWVdLCB0aGlzLm9wdHMpLmV4ZWModGhpcy5jbGllbnQpO1xuICAvKipcbiAgICogQHNlZSBodHRwczovL3JlZGlzLmlvL2NvbW1hbmRzL2hkZWxcbiAgICovXG4gIGhkZWwgPSAoLi4uYXJncykgPT4gbmV3IEhEZWxDb21tYW5kKGFyZ3MsIHRoaXMub3B0cykuZXhlYyh0aGlzLmNsaWVudCk7XG4gIC8qKlxuICAgKiBAc2VlIGh0dHBzOi8vcmVkaXMuaW8vY29tbWFuZHMvaGV4aXN0c1xuICAgKi9cbiAgaGV4aXN0cyA9ICguLi5hcmdzKSA9PiBuZXcgSEV4aXN0c0NvbW1hbmQoYXJncywgdGhpcy5vcHRzKS5leGVjKHRoaXMuY2xpZW50KTtcbiAgLyoqXG4gICAqIEBzZWUgaHR0cHM6Ly9yZWRpcy5pby9jb21tYW5kcy9oZXhwaXJlXG4gICAqL1xuICBoZXhwaXJlID0gKC4uLmFyZ3MpID0+IG5ldyBIRXhwaXJlQ29tbWFuZChhcmdzLCB0aGlzLm9wdHMpLmV4ZWModGhpcy5jbGllbnQpO1xuICAvKipcbiAgICogQHNlZSBodHRwczovL3JlZGlzLmlvL2NvbW1hbmRzL2hleHBpcmVhdFxuICAgKi9cbiAgaGV4cGlyZWF0ID0gKC4uLmFyZ3MpID0+IG5ldyBIRXhwaXJlQXRDb21tYW5kKGFyZ3MsIHRoaXMub3B0cykuZXhlYyh0aGlzLmNsaWVudCk7XG4gIC8qKlxuICAgKiBAc2VlIGh0dHBzOi8vcmVkaXMuaW8vY29tbWFuZHMvaGV4cGlyZXRpbWVcbiAgICovXG4gIGhleHBpcmV0aW1lID0gKC4uLmFyZ3MpID0+IG5ldyBIRXhwaXJlVGltZUNvbW1hbmQoYXJncywgdGhpcy5vcHRzKS5leGVjKHRoaXMuY2xpZW50KTtcbiAgLyoqXG4gICAqIEBzZWUgaHR0cHM6Ly9yZWRpcy5pby9jb21tYW5kcy9odHRsXG4gICAqL1xuICBodHRsID0gKC4uLmFyZ3MpID0+IG5ldyBIVHRsQ29tbWFuZChhcmdzLCB0aGlzLm9wdHMpLmV4ZWModGhpcy5jbGllbnQpO1xuICAvKipcbiAgICogQHNlZSBodHRwczovL3JlZGlzLmlvL2NvbW1hbmRzL2hwZXhwaXJlXG4gICAqL1xuICBocGV4cGlyZSA9ICguLi5hcmdzKSA9PiBuZXcgSFBFeHBpcmVDb21tYW5kKGFyZ3MsIHRoaXMub3B0cykuZXhlYyh0aGlzLmNsaWVudCk7XG4gIC8qKlxuICAgKiBAc2VlIGh0dHBzOi8vcmVkaXMuaW8vY29tbWFuZHMvaHBleHBpcmVhdFxuICAgKi9cbiAgaHBleHBpcmVhdCA9ICguLi5hcmdzKSA9PiBuZXcgSFBFeHBpcmVBdENvbW1hbmQoYXJncywgdGhpcy5vcHRzKS5leGVjKHRoaXMuY2xpZW50KTtcbiAgLyoqXG4gICAqIEBzZWUgaHR0cHM6Ly9yZWRpcy5pby9jb21tYW5kcy9ocGV4cGlyZXRpbWVcbiAgICovXG4gIGhwZXhwaXJldGltZSA9ICguLi5hcmdzKSA9PiBuZXcgSFBFeHBpcmVUaW1lQ29tbWFuZChhcmdzLCB0aGlzLm9wdHMpLmV4ZWModGhpcy5jbGllbnQpO1xuICAvKipcbiAgICogQHNlZSBodHRwczovL3JlZGlzLmlvL2NvbW1hbmRzL2hwdHRsXG4gICAqL1xuICBocHR0bCA9ICguLi5hcmdzKSA9PiBuZXcgSFBUdGxDb21tYW5kKGFyZ3MsIHRoaXMub3B0cykuZXhlYyh0aGlzLmNsaWVudCk7XG4gIC8qKlxuICAgKiBAc2VlIGh0dHBzOi8vcmVkaXMuaW8vY29tbWFuZHMvaHBlcnNpc3RcbiAgICovXG4gIGhwZXJzaXN0ID0gKC4uLmFyZ3MpID0+IG5ldyBIUGVyc2lzdENvbW1hbmQoYXJncywgdGhpcy5vcHRzKS5leGVjKHRoaXMuY2xpZW50KTtcbiAgLyoqXG4gICAqIEBzZWUgaHR0cHM6Ly9yZWRpcy5pby9jb21tYW5kcy9oZ2V0XG4gICAqL1xuICBoZ2V0ID0gKC4uLmFyZ3MpID0+IG5ldyBIR2V0Q29tbWFuZChhcmdzLCB0aGlzLm9wdHMpLmV4ZWModGhpcy5jbGllbnQpO1xuICAvKipcbiAgICogQHNlZSBodHRwczovL3JlZGlzLmlvL2NvbW1hbmRzL2hnZXRhbGxcbiAgICovXG4gIGhnZXRhbGwgPSAoLi4uYXJncykgPT4gbmV3IEhHZXRBbGxDb21tYW5kKGFyZ3MsIHRoaXMub3B0cykuZXhlYyh0aGlzLmNsaWVudCk7XG4gIC8qKlxuICAgKiBAc2VlIGh0dHBzOi8vcmVkaXMuaW8vY29tbWFuZHMvaGluY3JieVxuICAgKi9cbiAgaGluY3JieSA9ICguLi5hcmdzKSA9PiBuZXcgSEluY3JCeUNvbW1hbmQoYXJncywgdGhpcy5vcHRzKS5leGVjKHRoaXMuY2xpZW50KTtcbiAgLyoqXG4gICAqIEBzZWUgaHR0cHM6Ly9yZWRpcy5pby9jb21tYW5kcy9oaW5jcmJ5ZmxvYXRcbiAgICovXG4gIGhpbmNyYnlmbG9hdCA9ICguLi5hcmdzKSA9PiBuZXcgSEluY3JCeUZsb2F0Q29tbWFuZChhcmdzLCB0aGlzLm9wdHMpLmV4ZWModGhpcy5jbGllbnQpO1xuICAvKipcbiAgICogQHNlZSBodHRwczovL3JlZGlzLmlvL2NvbW1hbmRzL2hrZXlzXG4gICAqL1xuICBoa2V5cyA9ICguLi5hcmdzKSA9PiBuZXcgSEtleXNDb21tYW5kKGFyZ3MsIHRoaXMub3B0cykuZXhlYyh0aGlzLmNsaWVudCk7XG4gIC8qKlxuICAgKiBAc2VlIGh0dHBzOi8vcmVkaXMuaW8vY29tbWFuZHMvaGxlblxuICAgKi9cbiAgaGxlbiA9ICguLi5hcmdzKSA9PiBuZXcgSExlbkNvbW1hbmQoYXJncywgdGhpcy5vcHRzKS5leGVjKHRoaXMuY2xpZW50KTtcbiAgLyoqXG4gICAqIEBzZWUgaHR0cHM6Ly9yZWRpcy5pby9jb21tYW5kcy9obWdldFxuICAgKi9cbiAgaG1nZXQgPSAoLi4uYXJncykgPT4gbmV3IEhNR2V0Q29tbWFuZChhcmdzLCB0aGlzLm9wdHMpLmV4ZWModGhpcy5jbGllbnQpO1xuICAvKipcbiAgICogQHNlZSBodHRwczovL3JlZGlzLmlvL2NvbW1hbmRzL2htc2V0XG4gICAqL1xuICBobXNldCA9IChrZXksIGt2KSA9PiBuZXcgSE1TZXRDb21tYW5kKFtrZXksIGt2XSwgdGhpcy5vcHRzKS5leGVjKHRoaXMuY2xpZW50KTtcbiAgLyoqXG4gICAqIEBzZWUgaHR0cHM6Ly9yZWRpcy5pby9jb21tYW5kcy9ocmFuZGZpZWxkXG4gICAqL1xuICBocmFuZGZpZWxkID0gKGtleSwgY291bnQsIHdpdGhWYWx1ZXMpID0+IG5ldyBIUmFuZEZpZWxkQ29tbWFuZChba2V5LCBjb3VudCwgd2l0aFZhbHVlc10sIHRoaXMub3B0cykuZXhlYyh0aGlzLmNsaWVudCk7XG4gIC8qKlxuICAgKiBAc2VlIGh0dHBzOi8vcmVkaXMuaW8vY29tbWFuZHMvaHNjYW5cbiAgICovXG4gIGhzY2FuID0gKC4uLmFyZ3MpID0+IG5ldyBIU2NhbkNvbW1hbmQoYXJncywgdGhpcy5vcHRzKS5leGVjKHRoaXMuY2xpZW50KTtcbiAgLyoqXG4gICAqIEBzZWUgaHR0cHM6Ly9yZWRpcy5pby9jb21tYW5kcy9oc2V0XG4gICAqL1xuICBoc2V0ID0gKGtleSwga3YpID0+IG5ldyBIU2V0Q29tbWFuZChba2V5LCBrdl0sIHRoaXMub3B0cykuZXhlYyh0aGlzLmNsaWVudCk7XG4gIC8qKlxuICAgKiBAc2VlIGh0dHBzOi8vcmVkaXMuaW8vY29tbWFuZHMvaHNldG54XG4gICAqL1xuICBoc2V0bnggPSAoa2V5LCBmaWVsZCwgdmFsdWUpID0+IG5ldyBIU2V0TlhDb21tYW5kKFtrZXksIGZpZWxkLCB2YWx1ZV0sIHRoaXMub3B0cykuZXhlYyh0aGlzLmNsaWVudCk7XG4gIC8qKlxuICAgKiBAc2VlIGh0dHBzOi8vcmVkaXMuaW8vY29tbWFuZHMvaHN0cmxlblxuICAgKi9cbiAgaHN0cmxlbiA9ICguLi5hcmdzKSA9PiBuZXcgSFN0ckxlbkNvbW1hbmQoYXJncywgdGhpcy5vcHRzKS5leGVjKHRoaXMuY2xpZW50KTtcbiAgLyoqXG4gICAqIEBzZWUgaHR0cHM6Ly9yZWRpcy5pby9jb21tYW5kcy9odmFsc1xuICAgKi9cbiAgaHZhbHMgPSAoLi4uYXJncykgPT4gbmV3IEhWYWxzQ29tbWFuZChhcmdzLCB0aGlzLm9wdHMpLmV4ZWModGhpcy5jbGllbnQpO1xuICAvKipcbiAgICogQHNlZSBodHRwczovL3JlZGlzLmlvL2NvbW1hbmRzL2luY3JcbiAgICovXG4gIGluY3IgPSAoLi4uYXJncykgPT4gbmV3IEluY3JDb21tYW5kKGFyZ3MsIHRoaXMub3B0cykuZXhlYyh0aGlzLmNsaWVudCk7XG4gIC8qKlxuICAgKiBAc2VlIGh0dHBzOi8vcmVkaXMuaW8vY29tbWFuZHMvaW5jcmJ5XG4gICAqL1xuICBpbmNyYnkgPSAoLi4uYXJncykgPT4gbmV3IEluY3JCeUNvbW1hbmQoYXJncywgdGhpcy5vcHRzKS5leGVjKHRoaXMuY2xpZW50KTtcbiAgLyoqXG4gICAqIEBzZWUgaHR0cHM6Ly9yZWRpcy5pby9jb21tYW5kcy9pbmNyYnlmbG9hdFxuICAgKi9cbiAgaW5jcmJ5ZmxvYXQgPSAoLi4uYXJncykgPT4gbmV3IEluY3JCeUZsb2F0Q29tbWFuZChhcmdzLCB0aGlzLm9wdHMpLmV4ZWModGhpcy5jbGllbnQpO1xuICAvKipcbiAgICogQHNlZSBodHRwczovL3JlZGlzLmlvL2NvbW1hbmRzL2tleXNcbiAgICovXG4gIGtleXMgPSAoLi4uYXJncykgPT4gbmV3IEtleXNDb21tYW5kKGFyZ3MsIHRoaXMub3B0cykuZXhlYyh0aGlzLmNsaWVudCk7XG4gIC8qKlxuICAgKiBAc2VlIGh0dHBzOi8vcmVkaXMuaW8vY29tbWFuZHMvbGluZGV4XG4gICAqL1xuICBsaW5kZXggPSAoLi4uYXJncykgPT4gbmV3IExJbmRleENvbW1hbmQoYXJncywgdGhpcy5vcHRzKS5leGVjKHRoaXMuY2xpZW50KTtcbiAgLyoqXG4gICAqIEBzZWUgaHR0cHM6Ly9yZWRpcy5pby9jb21tYW5kcy9saW5zZXJ0XG4gICAqL1xuICBsaW5zZXJ0ID0gKGtleSwgZGlyZWN0aW9uLCBwaXZvdCwgdmFsdWUpID0+IG5ldyBMSW5zZXJ0Q29tbWFuZChba2V5LCBkaXJlY3Rpb24sIHBpdm90LCB2YWx1ZV0sIHRoaXMub3B0cykuZXhlYyh0aGlzLmNsaWVudCk7XG4gIC8qKlxuICAgKiBAc2VlIGh0dHBzOi8vcmVkaXMuaW8vY29tbWFuZHMvbGxlblxuICAgKi9cbiAgbGxlbiA9ICguLi5hcmdzKSA9PiBuZXcgTExlbkNvbW1hbmQoYXJncywgdGhpcy5vcHRzKS5leGVjKHRoaXMuY2xpZW50KTtcbiAgLyoqXG4gICAqIEBzZWUgaHR0cHM6Ly9yZWRpcy5pby9jb21tYW5kcy9sbW92ZVxuICAgKi9cbiAgbG1vdmUgPSAoLi4uYXJncykgPT4gbmV3IExNb3ZlQ29tbWFuZChhcmdzLCB0aGlzLm9wdHMpLmV4ZWModGhpcy5jbGllbnQpO1xuICAvKipcbiAgICogQHNlZSBodHRwczovL3JlZGlzLmlvL2NvbW1hbmRzL2xwb3BcbiAgICovXG4gIGxwb3AgPSAoLi4uYXJncykgPT4gbmV3IExQb3BDb21tYW5kKGFyZ3MsIHRoaXMub3B0cykuZXhlYyh0aGlzLmNsaWVudCk7XG4gIC8qKlxuICAgKiBAc2VlIGh0dHBzOi8vcmVkaXMuaW8vY29tbWFuZHMvbG1wb3BcbiAgICovXG4gIGxtcG9wID0gKC4uLmFyZ3MpID0+IG5ldyBMbVBvcENvbW1hbmQoYXJncywgdGhpcy5vcHRzKS5leGVjKHRoaXMuY2xpZW50KTtcbiAgLyoqXG4gICAqIEBzZWUgaHR0cHM6Ly9yZWRpcy5pby9jb21tYW5kcy9scG9zXG4gICAqL1xuICBscG9zID0gKC4uLmFyZ3MpID0+IG5ldyBMUG9zQ29tbWFuZChhcmdzLCB0aGlzLm9wdHMpLmV4ZWModGhpcy5jbGllbnQpO1xuICAvKipcbiAgICogQHNlZSBodHRwczovL3JlZGlzLmlvL2NvbW1hbmRzL2xwdXNoXG4gICAqL1xuICBscHVzaCA9IChrZXksIC4uLmVsZW1lbnRzKSA9PiBuZXcgTFB1c2hDb21tYW5kKFtrZXksIC4uLmVsZW1lbnRzXSwgdGhpcy5vcHRzKS5leGVjKHRoaXMuY2xpZW50KTtcbiAgLyoqXG4gICAqIEBzZWUgaHR0cHM6Ly9yZWRpcy5pby9jb21tYW5kcy9scHVzaHhcbiAgICovXG4gIGxwdXNoeCA9IChrZXksIC4uLmVsZW1lbnRzKSA9PiBuZXcgTFB1c2hYQ29tbWFuZChba2V5LCAuLi5lbGVtZW50c10sIHRoaXMub3B0cykuZXhlYyh0aGlzLmNsaWVudCk7XG4gIC8qKlxuICAgKiBAc2VlIGh0dHBzOi8vcmVkaXMuaW8vY29tbWFuZHMvbHJhbmdlXG4gICAqL1xuICBscmFuZ2UgPSAoLi4uYXJncykgPT4gbmV3IExSYW5nZUNvbW1hbmQoYXJncywgdGhpcy5vcHRzKS5leGVjKHRoaXMuY2xpZW50KTtcbiAgLyoqXG4gICAqIEBzZWUgaHR0cHM6Ly9yZWRpcy5pby9jb21tYW5kcy9scmVtXG4gICAqL1xuICBscmVtID0gKGtleSwgY291bnQsIHZhbHVlKSA9PiBuZXcgTFJlbUNvbW1hbmQoW2tleSwgY291bnQsIHZhbHVlXSwgdGhpcy5vcHRzKS5leGVjKHRoaXMuY2xpZW50KTtcbiAgLyoqXG4gICAqIEBzZWUgaHR0cHM6Ly9yZWRpcy5pby9jb21tYW5kcy9sc2V0XG4gICAqL1xuICBsc2V0ID0gKGtleSwgaW5kZXgsIHZhbHVlKSA9PiBuZXcgTFNldENvbW1hbmQoW2tleSwgaW5kZXgsIHZhbHVlXSwgdGhpcy5vcHRzKS5leGVjKHRoaXMuY2xpZW50KTtcbiAgLyoqXG4gICAqIEBzZWUgaHR0cHM6Ly9yZWRpcy5pby9jb21tYW5kcy9sdHJpbVxuICAgKi9cbiAgbHRyaW0gPSAoLi4uYXJncykgPT4gbmV3IExUcmltQ29tbWFuZChhcmdzLCB0aGlzLm9wdHMpLmV4ZWModGhpcy5jbGllbnQpO1xuICAvKipcbiAgICogQHNlZSBodHRwczovL3JlZGlzLmlvL2NvbW1hbmRzL21nZXRcbiAgICovXG4gIG1nZXQgPSAoLi4uYXJncykgPT4gbmV3IE1HZXRDb21tYW5kKGFyZ3MsIHRoaXMub3B0cykuZXhlYyh0aGlzLmNsaWVudCk7XG4gIC8qKlxuICAgKiBAc2VlIGh0dHBzOi8vcmVkaXMuaW8vY29tbWFuZHMvbXNldFxuICAgKi9cbiAgbXNldCA9IChrdikgPT4gbmV3IE1TZXRDb21tYW5kKFtrdl0sIHRoaXMub3B0cykuZXhlYyh0aGlzLmNsaWVudCk7XG4gIC8qKlxuICAgKiBAc2VlIGh0dHBzOi8vcmVkaXMuaW8vY29tbWFuZHMvbXNldG54XG4gICAqL1xuICBtc2V0bnggPSAoa3YpID0+IG5ldyBNU2V0TlhDb21tYW5kKFtrdl0sIHRoaXMub3B0cykuZXhlYyh0aGlzLmNsaWVudCk7XG4gIC8qKlxuICAgKiBAc2VlIGh0dHBzOi8vcmVkaXMuaW8vY29tbWFuZHMvcGVyc2lzdFxuICAgKi9cbiAgcGVyc2lzdCA9ICguLi5hcmdzKSA9PiBuZXcgUGVyc2lzdENvbW1hbmQoYXJncywgdGhpcy5vcHRzKS5leGVjKHRoaXMuY2xpZW50KTtcbiAgLyoqXG4gICAqIEBzZWUgaHR0cHM6Ly9yZWRpcy5pby9jb21tYW5kcy9wZXhwaXJlXG4gICAqL1xuICBwZXhwaXJlID0gKC4uLmFyZ3MpID0+IG5ldyBQRXhwaXJlQ29tbWFuZChhcmdzLCB0aGlzLm9wdHMpLmV4ZWModGhpcy5jbGllbnQpO1xuICAvKipcbiAgICogQHNlZSBodHRwczovL3JlZGlzLmlvL2NvbW1hbmRzL3BleHBpcmVhdFxuICAgKi9cbiAgcGV4cGlyZWF0ID0gKC4uLmFyZ3MpID0+IG5ldyBQRXhwaXJlQXRDb21tYW5kKGFyZ3MsIHRoaXMub3B0cykuZXhlYyh0aGlzLmNsaWVudCk7XG4gIC8qKlxuICAgKiBAc2VlIGh0dHBzOi8vcmVkaXMuaW8vY29tbWFuZHMvcGZhZGRcbiAgICovXG4gIHBmYWRkID0gKC4uLmFyZ3MpID0+IG5ldyBQZkFkZENvbW1hbmQoYXJncywgdGhpcy5vcHRzKS5leGVjKHRoaXMuY2xpZW50KTtcbiAgLyoqXG4gICAqIEBzZWUgaHR0cHM6Ly9yZWRpcy5pby9jb21tYW5kcy9wZmNvdW50XG4gICAqL1xuICBwZmNvdW50ID0gKC4uLmFyZ3MpID0+IG5ldyBQZkNvdW50Q29tbWFuZChhcmdzLCB0aGlzLm9wdHMpLmV4ZWModGhpcy5jbGllbnQpO1xuICAvKipcbiAgICogQHNlZSBodHRwczovL3JlZGlzLmlvL2NvbW1hbmRzL3BmbWVyZ2VcbiAgICovXG4gIHBmbWVyZ2UgPSAoLi4uYXJncykgPT4gbmV3IFBmTWVyZ2VDb21tYW5kKGFyZ3MsIHRoaXMub3B0cykuZXhlYyh0aGlzLmNsaWVudCk7XG4gIC8qKlxuICAgKiBAc2VlIGh0dHBzOi8vcmVkaXMuaW8vY29tbWFuZHMvcGluZ1xuICAgKi9cbiAgcGluZyA9IChhcmdzKSA9PiBuZXcgUGluZ0NvbW1hbmQoYXJncywgdGhpcy5vcHRzKS5leGVjKHRoaXMuY2xpZW50KTtcbiAgLyoqXG4gICAqIEBzZWUgaHR0cHM6Ly9yZWRpcy5pby9jb21tYW5kcy9wc2V0ZXhcbiAgICovXG4gIHBzZXRleCA9IChrZXksIHR0bCwgdmFsdWUpID0+IG5ldyBQU2V0RVhDb21tYW5kKFtrZXksIHR0bCwgdmFsdWVdLCB0aGlzLm9wdHMpLmV4ZWModGhpcy5jbGllbnQpO1xuICAvKipcbiAgICogQHNlZSBodHRwczovL3JlZGlzLmlvL2NvbW1hbmRzL3BzdWJzY3JpYmVcbiAgICovXG4gIHBzdWJzY3JpYmUgPSAocGF0dGVybnMpID0+IHtcbiAgICBjb25zdCBwYXR0ZXJuQXJyYXkgPSBBcnJheS5pc0FycmF5KHBhdHRlcm5zKSA/IHBhdHRlcm5zIDogW3BhdHRlcm5zXTtcbiAgICByZXR1cm4gbmV3IFN1YnNjcmliZXIodGhpcy5jbGllbnQsIHBhdHRlcm5BcnJheSwgdHJ1ZSwgdGhpcy5vcHRzKTtcbiAgfTtcbiAgLyoqXG4gICAqIEBzZWUgaHR0cHM6Ly9yZWRpcy5pby9jb21tYW5kcy9wdHRsXG4gICAqL1xuICBwdHRsID0gKC4uLmFyZ3MpID0+IG5ldyBQVHRsQ29tbWFuZChhcmdzLCB0aGlzLm9wdHMpLmV4ZWModGhpcy5jbGllbnQpO1xuICAvKipcbiAgICogQHNlZSBodHRwczovL3JlZGlzLmlvL2NvbW1hbmRzL3B1Ymxpc2hcbiAgICovXG4gIHB1Ymxpc2ggPSAoLi4uYXJncykgPT4gbmV3IFB1Ymxpc2hDb21tYW5kKGFyZ3MsIHRoaXMub3B0cykuZXhlYyh0aGlzLmNsaWVudCk7XG4gIC8qKlxuICAgKiBAc2VlIGh0dHBzOi8vcmVkaXMuaW8vY29tbWFuZHMvcmFuZG9ta2V5XG4gICAqL1xuICByYW5kb21rZXkgPSAoKSA9PiBuZXcgUmFuZG9tS2V5Q29tbWFuZCgpLmV4ZWModGhpcy5jbGllbnQpO1xuICAvKipcbiAgICogQHNlZSBodHRwczovL3JlZGlzLmlvL2NvbW1hbmRzL3JlbmFtZVxuICAgKi9cbiAgcmVuYW1lID0gKC4uLmFyZ3MpID0+IG5ldyBSZW5hbWVDb21tYW5kKGFyZ3MsIHRoaXMub3B0cykuZXhlYyh0aGlzLmNsaWVudCk7XG4gIC8qKlxuICAgKiBAc2VlIGh0dHBzOi8vcmVkaXMuaW8vY29tbWFuZHMvcmVuYW1lbnhcbiAgICovXG4gIHJlbmFtZW54ID0gKC4uLmFyZ3MpID0+IG5ldyBSZW5hbWVOWENvbW1hbmQoYXJncywgdGhpcy5vcHRzKS5leGVjKHRoaXMuY2xpZW50KTtcbiAgLyoqXG4gICAqIEBzZWUgaHR0cHM6Ly9yZWRpcy5pby9jb21tYW5kcy9ycG9wXG4gICAqL1xuICBycG9wID0gKC4uLmFyZ3MpID0+IG5ldyBSUG9wQ29tbWFuZChhcmdzLCB0aGlzLm9wdHMpLmV4ZWModGhpcy5jbGllbnQpO1xuICAvKipcbiAgICogQHNlZSBodHRwczovL3JlZGlzLmlvL2NvbW1hbmRzL3JwdXNoXG4gICAqL1xuICBycHVzaCA9IChrZXksIC4uLmVsZW1lbnRzKSA9PiBuZXcgUlB1c2hDb21tYW5kKFtrZXksIC4uLmVsZW1lbnRzXSwgdGhpcy5vcHRzKS5leGVjKHRoaXMuY2xpZW50KTtcbiAgLyoqXG4gICAqIEBzZWUgaHR0cHM6Ly9yZWRpcy5pby9jb21tYW5kcy9ycHVzaHhcbiAgICovXG4gIHJwdXNoeCA9IChrZXksIC4uLmVsZW1lbnRzKSA9PiBuZXcgUlB1c2hYQ29tbWFuZChba2V5LCAuLi5lbGVtZW50c10sIHRoaXMub3B0cykuZXhlYyh0aGlzLmNsaWVudCk7XG4gIC8qKlxuICAgKiBAc2VlIGh0dHBzOi8vcmVkaXMuaW8vY29tbWFuZHMvc2FkZFxuICAgKi9cbiAgc2FkZCA9IChrZXksIG1lbWJlciwgLi4ubWVtYmVycykgPT4gbmV3IFNBZGRDb21tYW5kKFtrZXksIG1lbWJlciwgLi4ubWVtYmVyc10sIHRoaXMub3B0cykuZXhlYyh0aGlzLmNsaWVudCk7XG4gIHNjYW4oY3Vyc29yLCBvcHRzKSB7XG4gICAgcmV0dXJuIG5ldyBTY2FuQ29tbWFuZChbY3Vyc29yLCBvcHRzXSwgdGhpcy5vcHRzKS5leGVjKHRoaXMuY2xpZW50KTtcbiAgfVxuICAvKipcbiAgICogQHNlZSBodHRwczovL3JlZGlzLmlvL2NvbW1hbmRzL3NjYXJkXG4gICAqL1xuICBzY2FyZCA9ICguLi5hcmdzKSA9PiBuZXcgU0NhcmRDb21tYW5kKGFyZ3MsIHRoaXMub3B0cykuZXhlYyh0aGlzLmNsaWVudCk7XG4gIC8qKlxuICAgKiBAc2VlIGh0dHBzOi8vcmVkaXMuaW8vY29tbWFuZHMvc2NyaXB0LWV4aXN0c1xuICAgKi9cbiAgc2NyaXB0RXhpc3RzID0gKC4uLmFyZ3MpID0+IG5ldyBTY3JpcHRFeGlzdHNDb21tYW5kKGFyZ3MsIHRoaXMub3B0cykuZXhlYyh0aGlzLmNsaWVudCk7XG4gIC8qKlxuICAgKiBAc2VlIGh0dHBzOi8vcmVkaXMuaW8vY29tbWFuZHMvc2NyaXB0LWZsdXNoXG4gICAqL1xuICBzY3JpcHRGbHVzaCA9ICguLi5hcmdzKSA9PiBuZXcgU2NyaXB0Rmx1c2hDb21tYW5kKGFyZ3MsIHRoaXMub3B0cykuZXhlYyh0aGlzLmNsaWVudCk7XG4gIC8qKlxuICAgKiBAc2VlIGh0dHBzOi8vcmVkaXMuaW8vY29tbWFuZHMvc2NyaXB0LWxvYWRcbiAgICovXG4gIHNjcmlwdExvYWQgPSAoLi4uYXJncykgPT4gbmV3IFNjcmlwdExvYWRDb21tYW5kKGFyZ3MsIHRoaXMub3B0cykuZXhlYyh0aGlzLmNsaWVudCk7XG4gIC8qKlxuICAgKiBAc2VlIGh0dHBzOi8vcmVkaXMuaW8vY29tbWFuZHMvc2RpZmZcbiAgICovXG4gIHNkaWZmID0gKC4uLmFyZ3MpID0+IG5ldyBTRGlmZkNvbW1hbmQoYXJncywgdGhpcy5vcHRzKS5leGVjKHRoaXMuY2xpZW50KTtcbiAgLyoqXG4gICAqIEBzZWUgaHR0cHM6Ly9yZWRpcy5pby9jb21tYW5kcy9zZGlmZnN0b3JlXG4gICAqL1xuICBzZGlmZnN0b3JlID0gKC4uLmFyZ3MpID0+IG5ldyBTRGlmZlN0b3JlQ29tbWFuZChhcmdzLCB0aGlzLm9wdHMpLmV4ZWModGhpcy5jbGllbnQpO1xuICAvKipcbiAgICogQHNlZSBodHRwczovL3JlZGlzLmlvL2NvbW1hbmRzL3NldFxuICAgKi9cbiAgc2V0ID0gKGtleSwgdmFsdWUsIG9wdHMpID0+IG5ldyBTZXRDb21tYW5kKFtrZXksIHZhbHVlLCBvcHRzXSwgdGhpcy5vcHRzKS5leGVjKHRoaXMuY2xpZW50KTtcbiAgLyoqXG4gICAqIEBzZWUgaHR0cHM6Ly9yZWRpcy5pby9jb21tYW5kcy9zZXRiaXRcbiAgICovXG4gIHNldGJpdCA9ICguLi5hcmdzKSA9PiBuZXcgU2V0Qml0Q29tbWFuZChhcmdzLCB0aGlzLm9wdHMpLmV4ZWModGhpcy5jbGllbnQpO1xuICAvKipcbiAgICogQHNlZSBodHRwczovL3JlZGlzLmlvL2NvbW1hbmRzL3NldGV4XG4gICAqL1xuICBzZXRleCA9IChrZXksIHR0bCwgdmFsdWUpID0+IG5ldyBTZXRFeENvbW1hbmQoW2tleSwgdHRsLCB2YWx1ZV0sIHRoaXMub3B0cykuZXhlYyh0aGlzLmNsaWVudCk7XG4gIC8qKlxuICAgKiBAc2VlIGh0dHBzOi8vcmVkaXMuaW8vY29tbWFuZHMvc2V0bnhcbiAgICovXG4gIHNldG54ID0gKGtleSwgdmFsdWUpID0+IG5ldyBTZXROeENvbW1hbmQoW2tleSwgdmFsdWVdLCB0aGlzLm9wdHMpLmV4ZWModGhpcy5jbGllbnQpO1xuICAvKipcbiAgICogQHNlZSBodHRwczovL3JlZGlzLmlvL2NvbW1hbmRzL3NldHJhbmdlXG4gICAqL1xuICBzZXRyYW5nZSA9ICguLi5hcmdzKSA9PiBuZXcgU2V0UmFuZ2VDb21tYW5kKGFyZ3MsIHRoaXMub3B0cykuZXhlYyh0aGlzLmNsaWVudCk7XG4gIC8qKlxuICAgKiBAc2VlIGh0dHBzOi8vcmVkaXMuaW8vY29tbWFuZHMvc2ludGVyXG4gICAqL1xuICBzaW50ZXIgPSAoLi4uYXJncykgPT4gbmV3IFNJbnRlckNvbW1hbmQoYXJncywgdGhpcy5vcHRzKS5leGVjKHRoaXMuY2xpZW50KTtcbiAgLyoqXG4gICAqIEBzZWUgaHR0cHM6Ly9yZWRpcy5pby9jb21tYW5kcy9zaW50ZXJzdG9yZVxuICAgKi9cbiAgc2ludGVyc3RvcmUgPSAoLi4uYXJncykgPT4gbmV3IFNJbnRlclN0b3JlQ29tbWFuZChhcmdzLCB0aGlzLm9wdHMpLmV4ZWModGhpcy5jbGllbnQpO1xuICAvKipcbiAgICogQHNlZSBodHRwczovL3JlZGlzLmlvL2NvbW1hbmRzL3Npc21lbWJlclxuICAgKi9cbiAgc2lzbWVtYmVyID0gKGtleSwgbWVtYmVyKSA9PiBuZXcgU0lzTWVtYmVyQ29tbWFuZChba2V5LCBtZW1iZXJdLCB0aGlzLm9wdHMpLmV4ZWModGhpcy5jbGllbnQpO1xuICAvKipcbiAgICogQHNlZSBodHRwczovL3JlZGlzLmlvL2NvbW1hbmRzL3NtaXNtZW1iZXJcbiAgICovXG4gIHNtaXNtZW1iZXIgPSAoa2V5LCBtZW1iZXJzKSA9PiBuZXcgU01Jc01lbWJlckNvbW1hbmQoW2tleSwgbWVtYmVyc10sIHRoaXMub3B0cykuZXhlYyh0aGlzLmNsaWVudCk7XG4gIC8qKlxuICAgKiBAc2VlIGh0dHBzOi8vcmVkaXMuaW8vY29tbWFuZHMvc21lbWJlcnNcbiAgICovXG4gIHNtZW1iZXJzID0gKC4uLmFyZ3MpID0+IG5ldyBTTWVtYmVyc0NvbW1hbmQoYXJncywgdGhpcy5vcHRzKS5leGVjKHRoaXMuY2xpZW50KTtcbiAgLyoqXG4gICAqIEBzZWUgaHR0cHM6Ly9yZWRpcy5pby9jb21tYW5kcy9zbW92ZVxuICAgKi9cbiAgc21vdmUgPSAoc291cmNlLCBkZXN0aW5hdGlvbiwgbWVtYmVyKSA9PiBuZXcgU01vdmVDb21tYW5kKFtzb3VyY2UsIGRlc3RpbmF0aW9uLCBtZW1iZXJdLCB0aGlzLm9wdHMpLmV4ZWModGhpcy5jbGllbnQpO1xuICAvKipcbiAgICogQHNlZSBodHRwczovL3JlZGlzLmlvL2NvbW1hbmRzL3Nwb3BcbiAgICovXG4gIHNwb3AgPSAoLi4uYXJncykgPT4gbmV3IFNQb3BDb21tYW5kKGFyZ3MsIHRoaXMub3B0cykuZXhlYyh0aGlzLmNsaWVudCk7XG4gIC8qKlxuICAgKiBAc2VlIGh0dHBzOi8vcmVkaXMuaW8vY29tbWFuZHMvc3JhbmRtZW1iZXJcbiAgICovXG4gIHNyYW5kbWVtYmVyID0gKC4uLmFyZ3MpID0+IG5ldyBTUmFuZE1lbWJlckNvbW1hbmQoYXJncywgdGhpcy5vcHRzKS5leGVjKHRoaXMuY2xpZW50KTtcbiAgLyoqXG4gICAqIEBzZWUgaHR0cHM6Ly9yZWRpcy5pby9jb21tYW5kcy9zcmVtXG4gICAqL1xuICBzcmVtID0gKGtleSwgLi4ubWVtYmVycykgPT4gbmV3IFNSZW1Db21tYW5kKFtrZXksIC4uLm1lbWJlcnNdLCB0aGlzLm9wdHMpLmV4ZWModGhpcy5jbGllbnQpO1xuICAvKipcbiAgICogQHNlZSBodHRwczovL3JlZGlzLmlvL2NvbW1hbmRzL3NzY2FuXG4gICAqL1xuICBzc2NhbiA9ICguLi5hcmdzKSA9PiBuZXcgU1NjYW5Db21tYW5kKGFyZ3MsIHRoaXMub3B0cykuZXhlYyh0aGlzLmNsaWVudCk7XG4gIC8qKlxuICAgKiBAc2VlIGh0dHBzOi8vcmVkaXMuaW8vY29tbWFuZHMvc3RybGVuXG4gICAqL1xuICBzdHJsZW4gPSAoLi4uYXJncykgPT4gbmV3IFN0ckxlbkNvbW1hbmQoYXJncywgdGhpcy5vcHRzKS5leGVjKHRoaXMuY2xpZW50KTtcbiAgLyoqXG4gICAqIEBzZWUgaHR0cHM6Ly9yZWRpcy5pby9jb21tYW5kcy9zdWJzY3JpYmVcbiAgICovXG4gIHN1YnNjcmliZSA9IChjaGFubmVscykgPT4ge1xuICAgIGNvbnN0IGNoYW5uZWxBcnJheSA9IEFycmF5LmlzQXJyYXkoY2hhbm5lbHMpID8gY2hhbm5lbHMgOiBbY2hhbm5lbHNdO1xuICAgIHJldHVybiBuZXcgU3Vic2NyaWJlcih0aGlzLmNsaWVudCwgY2hhbm5lbEFycmF5LCBmYWxzZSwgdGhpcy5vcHRzKTtcbiAgfTtcbiAgLyoqXG4gICAqIEBzZWUgaHR0cHM6Ly9yZWRpcy5pby9jb21tYW5kcy9zdW5pb25cbiAgICovXG4gIHN1bmlvbiA9ICguLi5hcmdzKSA9PiBuZXcgU1VuaW9uQ29tbWFuZChhcmdzLCB0aGlzLm9wdHMpLmV4ZWModGhpcy5jbGllbnQpO1xuICAvKipcbiAgICogQHNlZSBodHRwczovL3JlZGlzLmlvL2NvbW1hbmRzL3N1bmlvbnN0b3JlXG4gICAqL1xuICBzdW5pb25zdG9yZSA9ICguLi5hcmdzKSA9PiBuZXcgU1VuaW9uU3RvcmVDb21tYW5kKGFyZ3MsIHRoaXMub3B0cykuZXhlYyh0aGlzLmNsaWVudCk7XG4gIC8qKlxuICAgKiBAc2VlIGh0dHBzOi8vcmVkaXMuaW8vY29tbWFuZHMvdGltZVxuICAgKi9cbiAgdGltZSA9ICgpID0+IG5ldyBUaW1lQ29tbWFuZCgpLmV4ZWModGhpcy5jbGllbnQpO1xuICAvKipcbiAgICogQHNlZSBodHRwczovL3JlZGlzLmlvL2NvbW1hbmRzL3RvdWNoXG4gICAqL1xuICB0b3VjaCA9ICguLi5hcmdzKSA9PiBuZXcgVG91Y2hDb21tYW5kKGFyZ3MsIHRoaXMub3B0cykuZXhlYyh0aGlzLmNsaWVudCk7XG4gIC8qKlxuICAgKiBAc2VlIGh0dHBzOi8vcmVkaXMuaW8vY29tbWFuZHMvdHRsXG4gICAqL1xuICB0dGwgPSAoLi4uYXJncykgPT4gbmV3IFR0bENvbW1hbmQoYXJncywgdGhpcy5vcHRzKS5leGVjKHRoaXMuY2xpZW50KTtcbiAgLyoqXG4gICAqIEBzZWUgaHR0cHM6Ly9yZWRpcy5pby9jb21tYW5kcy90eXBlXG4gICAqL1xuICB0eXBlID0gKC4uLmFyZ3MpID0+IG5ldyBUeXBlQ29tbWFuZChhcmdzLCB0aGlzLm9wdHMpLmV4ZWModGhpcy5jbGllbnQpO1xuICAvKipcbiAgICogQHNlZSBodHRwczovL3JlZGlzLmlvL2NvbW1hbmRzL3VubGlua1xuICAgKi9cbiAgdW5saW5rID0gKC4uLmFyZ3MpID0+IG5ldyBVbmxpbmtDb21tYW5kKGFyZ3MsIHRoaXMub3B0cykuZXhlYyh0aGlzLmNsaWVudCk7XG4gIC8qKlxuICAgKiBAc2VlIGh0dHBzOi8vcmVkaXMuaW8vY29tbWFuZHMveGFkZFxuICAgKi9cbiAgeGFkZCA9ICguLi5hcmdzKSA9PiBuZXcgWEFkZENvbW1hbmQoYXJncywgdGhpcy5vcHRzKS5leGVjKHRoaXMuY2xpZW50KTtcbiAgLyoqXG4gICAqIEBzZWUgaHR0cHM6Ly9yZWRpcy5pby9jb21tYW5kcy94YWNrXG4gICAqL1xuICB4YWNrID0gKC4uLmFyZ3MpID0+IG5ldyBYQWNrQ29tbWFuZChhcmdzLCB0aGlzLm9wdHMpLmV4ZWModGhpcy5jbGllbnQpO1xuICAvKipcbiAgICogQHNlZSBodHRwczovL3JlZGlzLmlvL2NvbW1hbmRzL3hkZWxcbiAgICovXG4gIHhkZWwgPSAoLi4uYXJncykgPT4gbmV3IFhEZWxDb21tYW5kKGFyZ3MsIHRoaXMub3B0cykuZXhlYyh0aGlzLmNsaWVudCk7XG4gIC8qKlxuICAgKiBAc2VlIGh0dHBzOi8vcmVkaXMuaW8vY29tbWFuZHMveGdyb3VwXG4gICAqL1xuICB4Z3JvdXAgPSAoLi4uYXJncykgPT4gbmV3IFhHcm91cENvbW1hbmQoYXJncywgdGhpcy5vcHRzKS5leGVjKHRoaXMuY2xpZW50KTtcbiAgLyoqXG4gICAqIEBzZWUgaHR0cHM6Ly9yZWRpcy5pby9jb21tYW5kcy94cmVhZFxuICAgKi9cbiAgeHJlYWQgPSAoLi4uYXJncykgPT4gbmV3IFhSZWFkQ29tbWFuZChhcmdzLCB0aGlzLm9wdHMpLmV4ZWModGhpcy5jbGllbnQpO1xuICAvKipcbiAgICogQHNlZSBodHRwczovL3JlZGlzLmlvL2NvbW1hbmRzL3hyZWFkZ3JvdXBcbiAgICovXG4gIHhyZWFkZ3JvdXAgPSAoLi4uYXJncykgPT4gbmV3IFhSZWFkR3JvdXBDb21tYW5kKGFyZ3MsIHRoaXMub3B0cykuZXhlYyh0aGlzLmNsaWVudCk7XG4gIC8qKlxuICAgKiBAc2VlIGh0dHBzOi8vcmVkaXMuaW8vY29tbWFuZHMveGluZm9cbiAgICovXG4gIHhpbmZvID0gKC4uLmFyZ3MpID0+IG5ldyBYSW5mb0NvbW1hbmQoYXJncywgdGhpcy5vcHRzKS5leGVjKHRoaXMuY2xpZW50KTtcbiAgLyoqXG4gICAqIEBzZWUgaHR0cHM6Ly9yZWRpcy5pby9jb21tYW5kcy94bGVuXG4gICAqL1xuICB4bGVuID0gKC4uLmFyZ3MpID0+IG5ldyBYTGVuQ29tbWFuZChhcmdzLCB0aGlzLm9wdHMpLmV4ZWModGhpcy5jbGllbnQpO1xuICAvKipcbiAgICogQHNlZSBodHRwczovL3JlZGlzLmlvL2NvbW1hbmRzL3hwZW5kaW5nXG4gICAqL1xuICB4cGVuZGluZyA9ICguLi5hcmdzKSA9PiBuZXcgWFBlbmRpbmdDb21tYW5kKGFyZ3MsIHRoaXMub3B0cykuZXhlYyh0aGlzLmNsaWVudCk7XG4gIC8qKlxuICAgKiBAc2VlIGh0dHBzOi8vcmVkaXMuaW8vY29tbWFuZHMveGNsYWltXG4gICAqL1xuICB4Y2xhaW0gPSAoLi4uYXJncykgPT4gbmV3IFhDbGFpbUNvbW1hbmQoYXJncywgdGhpcy5vcHRzKS5leGVjKHRoaXMuY2xpZW50KTtcbiAgLyoqXG4gICAqIEBzZWUgaHR0cHM6Ly9yZWRpcy5pby9jb21tYW5kcy94YXV0b2NsYWltXG4gICAqL1xuICB4YXV0b2NsYWltID0gKC4uLmFyZ3MpID0+IG5ldyBYQXV0b0NsYWltKGFyZ3MsIHRoaXMub3B0cykuZXhlYyh0aGlzLmNsaWVudCk7XG4gIC8qKlxuICAgKiBAc2VlIGh0dHBzOi8vcmVkaXMuaW8vY29tbWFuZHMveHRyaW1cbiAgICovXG4gIHh0cmltID0gKC4uLmFyZ3MpID0+IG5ldyBYVHJpbUNvbW1hbmQoYXJncywgdGhpcy5vcHRzKS5leGVjKHRoaXMuY2xpZW50KTtcbiAgLyoqXG4gICAqIEBzZWUgaHR0cHM6Ly9yZWRpcy5pby9jb21tYW5kcy94cmFuZ2VcbiAgICovXG4gIHhyYW5nZSA9ICguLi5hcmdzKSA9PiBuZXcgWFJhbmdlQ29tbWFuZChhcmdzLCB0aGlzLm9wdHMpLmV4ZWModGhpcy5jbGllbnQpO1xuICAvKipcbiAgICogQHNlZSBodHRwczovL3JlZGlzLmlvL2NvbW1hbmRzL3hyZXZyYW5nZVxuICAgKi9cbiAgeHJldnJhbmdlID0gKC4uLmFyZ3MpID0+IG5ldyBYUmV2UmFuZ2VDb21tYW5kKGFyZ3MsIHRoaXMub3B0cykuZXhlYyh0aGlzLmNsaWVudCk7XG4gIC8qKlxuICAgKiBAc2VlIGh0dHBzOi8vcmVkaXMuaW8vY29tbWFuZHMvemFkZFxuICAgKi9cbiAgemFkZCA9ICguLi5hcmdzKSA9PiB7XG4gICAgaWYgKFwic2NvcmVcIiBpbiBhcmdzWzFdKSB7XG4gICAgICByZXR1cm4gbmV3IFpBZGRDb21tYW5kKFthcmdzWzBdLCBhcmdzWzFdLCAuLi5hcmdzLnNsaWNlKDIpXSwgdGhpcy5vcHRzKS5leGVjKFxuICAgICAgICB0aGlzLmNsaWVudFxuICAgICAgKTtcbiAgICB9XG4gICAgcmV0dXJuIG5ldyBaQWRkQ29tbWFuZChcbiAgICAgIFthcmdzWzBdLCBhcmdzWzFdLCAuLi5hcmdzLnNsaWNlKDIpXSxcbiAgICAgIHRoaXMub3B0c1xuICAgICkuZXhlYyh0aGlzLmNsaWVudCk7XG4gIH07XG4gIC8qKlxuICAgKiBAc2VlIGh0dHBzOi8vcmVkaXMuaW8vY29tbWFuZHMvemNhcmRcbiAgICovXG4gIHpjYXJkID0gKC4uLmFyZ3MpID0+IG5ldyBaQ2FyZENvbW1hbmQoYXJncywgdGhpcy5vcHRzKS5leGVjKHRoaXMuY2xpZW50KTtcbiAgLyoqXG4gICAqIEBzZWUgaHR0cHM6Ly9yZWRpcy5pby9jb21tYW5kcy96Y291bnRcbiAgICovXG4gIHpjb3VudCA9ICguLi5hcmdzKSA9PiBuZXcgWkNvdW50Q29tbWFuZChhcmdzLCB0aGlzLm9wdHMpLmV4ZWModGhpcy5jbGllbnQpO1xuICAvKipcbiAgICogQHNlZSBodHRwczovL3JlZGlzLmlvL2NvbW1hbmRzL3pkaWZmc3RvcmVcbiAgICovXG4gIHpkaWZmc3RvcmUgPSAoLi4uYXJncykgPT4gbmV3IFpEaWZmU3RvcmVDb21tYW5kKGFyZ3MsIHRoaXMub3B0cykuZXhlYyh0aGlzLmNsaWVudCk7XG4gIC8qKlxuICAgKiBAc2VlIGh0dHBzOi8vcmVkaXMuaW8vY29tbWFuZHMvemluY3JieVxuICAgKi9cbiAgemluY3JieSA9IChrZXksIGluY3JlbWVudCwgbWVtYmVyKSA9PiBuZXcgWkluY3JCeUNvbW1hbmQoW2tleSwgaW5jcmVtZW50LCBtZW1iZXJdLCB0aGlzLm9wdHMpLmV4ZWModGhpcy5jbGllbnQpO1xuICAvKipcbiAgICogQHNlZSBodHRwczovL3JlZGlzLmlvL2NvbW1hbmRzL3ppbnRlcnN0b3JlXG4gICAqL1xuICB6aW50ZXJzdG9yZSA9ICguLi5hcmdzKSA9PiBuZXcgWkludGVyU3RvcmVDb21tYW5kKGFyZ3MsIHRoaXMub3B0cykuZXhlYyh0aGlzLmNsaWVudCk7XG4gIC8qKlxuICAgKiBAc2VlIGh0dHBzOi8vcmVkaXMuaW8vY29tbWFuZHMvemxleGNvdW50XG4gICAqL1xuICB6bGV4Y291bnQgPSAoLi4uYXJncykgPT4gbmV3IFpMZXhDb3VudENvbW1hbmQoYXJncywgdGhpcy5vcHRzKS5leGVjKHRoaXMuY2xpZW50KTtcbiAgLyoqXG4gICAqIEBzZWUgaHR0cHM6Ly9yZWRpcy5pby9jb21tYW5kcy96bXNjb3JlXG4gICAqL1xuICB6bXNjb3JlID0gKC4uLmFyZ3MpID0+IG5ldyBaTVNjb3JlQ29tbWFuZChhcmdzLCB0aGlzLm9wdHMpLmV4ZWModGhpcy5jbGllbnQpO1xuICAvKipcbiAgICogQHNlZSBodHRwczovL3JlZGlzLmlvL2NvbW1hbmRzL3pwb3BtYXhcbiAgICovXG4gIHpwb3BtYXggPSAoLi4uYXJncykgPT4gbmV3IFpQb3BNYXhDb21tYW5kKGFyZ3MsIHRoaXMub3B0cykuZXhlYyh0aGlzLmNsaWVudCk7XG4gIC8qKlxuICAgKiBAc2VlIGh0dHBzOi8vcmVkaXMuaW8vY29tbWFuZHMvenBvcG1pblxuICAgKi9cbiAgenBvcG1pbiA9ICguLi5hcmdzKSA9PiBuZXcgWlBvcE1pbkNvbW1hbmQoYXJncywgdGhpcy5vcHRzKS5leGVjKHRoaXMuY2xpZW50KTtcbiAgLyoqXG4gICAqIEBzZWUgaHR0cHM6Ly9yZWRpcy5pby9jb21tYW5kcy96cmFuZ2VcbiAgICovXG4gIHpyYW5nZSA9ICguLi5hcmdzKSA9PiBuZXcgWlJhbmdlQ29tbWFuZChhcmdzLCB0aGlzLm9wdHMpLmV4ZWModGhpcy5jbGllbnQpO1xuICAvKipcbiAgICogQHNlZSBodHRwczovL3JlZGlzLmlvL2NvbW1hbmRzL3pyYW5rXG4gICAqL1xuICB6cmFuayA9IChrZXksIG1lbWJlcikgPT4gbmV3IFpSYW5rQ29tbWFuZChba2V5LCBtZW1iZXJdLCB0aGlzLm9wdHMpLmV4ZWModGhpcy5jbGllbnQpO1xuICAvKipcbiAgICogQHNlZSBodHRwczovL3JlZGlzLmlvL2NvbW1hbmRzL3pyZW1cbiAgICovXG4gIHpyZW0gPSAoa2V5LCAuLi5tZW1iZXJzKSA9PiBuZXcgWlJlbUNvbW1hbmQoW2tleSwgLi4ubWVtYmVyc10sIHRoaXMub3B0cykuZXhlYyh0aGlzLmNsaWVudCk7XG4gIC8qKlxuICAgKiBAc2VlIGh0dHBzOi8vcmVkaXMuaW8vY29tbWFuZHMvenJlbXJhbmdlYnlsZXhcbiAgICovXG4gIHpyZW1yYW5nZWJ5bGV4ID0gKC4uLmFyZ3MpID0+IG5ldyBaUmVtUmFuZ2VCeUxleENvbW1hbmQoYXJncywgdGhpcy5vcHRzKS5leGVjKHRoaXMuY2xpZW50KTtcbiAgLyoqXG4gICAqIEBzZWUgaHR0cHM6Ly9yZWRpcy5pby9jb21tYW5kcy96cmVtcmFuZ2VieXJhbmtcbiAgICovXG4gIHpyZW1yYW5nZWJ5cmFuayA9ICguLi5hcmdzKSA9PiBuZXcgWlJlbVJhbmdlQnlSYW5rQ29tbWFuZChhcmdzLCB0aGlzLm9wdHMpLmV4ZWModGhpcy5jbGllbnQpO1xuICAvKipcbiAgICogQHNlZSBodHRwczovL3JlZGlzLmlvL2NvbW1hbmRzL3pyZW1yYW5nZWJ5c2NvcmVcbiAgICovXG4gIHpyZW1yYW5nZWJ5c2NvcmUgPSAoLi4uYXJncykgPT4gbmV3IFpSZW1SYW5nZUJ5U2NvcmVDb21tYW5kKGFyZ3MsIHRoaXMub3B0cykuZXhlYyh0aGlzLmNsaWVudCk7XG4gIC8qKlxuICAgKiBAc2VlIGh0dHBzOi8vcmVkaXMuaW8vY29tbWFuZHMvenJldnJhbmtcbiAgICovXG4gIHpyZXZyYW5rID0gKGtleSwgbWVtYmVyKSA9PiBuZXcgWlJldlJhbmtDb21tYW5kKFtrZXksIG1lbWJlcl0sIHRoaXMub3B0cykuZXhlYyh0aGlzLmNsaWVudCk7XG4gIC8qKlxuICAgKiBAc2VlIGh0dHBzOi8vcmVkaXMuaW8vY29tbWFuZHMvenNjYW5cbiAgICovXG4gIHpzY2FuID0gKC4uLmFyZ3MpID0+IG5ldyBaU2NhbkNvbW1hbmQoYXJncywgdGhpcy5vcHRzKS5leGVjKHRoaXMuY2xpZW50KTtcbiAgLyoqXG4gICAqIEBzZWUgaHR0cHM6Ly9yZWRpcy5pby9jb21tYW5kcy96c2NvcmVcbiAgICovXG4gIHpzY29yZSA9IChrZXksIG1lbWJlcikgPT4gbmV3IFpTY29yZUNvbW1hbmQoW2tleSwgbWVtYmVyXSwgdGhpcy5vcHRzKS5leGVjKHRoaXMuY2xpZW50KTtcbiAgLyoqXG4gICAqIEBzZWUgaHR0cHM6Ly9yZWRpcy5pby9jb21tYW5kcy96dW5pb25cbiAgICovXG4gIHp1bmlvbiA9ICguLi5hcmdzKSA9PiBuZXcgWlVuaW9uQ29tbWFuZChhcmdzLCB0aGlzLm9wdHMpLmV4ZWModGhpcy5jbGllbnQpO1xuICAvKipcbiAgICogQHNlZSBodHRwczovL3JlZGlzLmlvL2NvbW1hbmRzL3p1bmlvbnN0b3JlXG4gICAqL1xuICB6dW5pb25zdG9yZSA9ICguLi5hcmdzKSA9PiBuZXcgWlVuaW9uU3RvcmVDb21tYW5kKGFyZ3MsIHRoaXMub3B0cykuZXhlYyh0aGlzLmNsaWVudCk7XG59O1xuXG4vLyB2ZXJzaW9uLnRzXG52YXIgVkVSU0lPTiA9IFwidjEuMzUuNlwiO1xuXG5leHBvcnQge1xuICBlcnJvcl9leHBvcnRzLFxuICBIdHRwQ2xpZW50LFxuICBSZWRpcyxcbiAgVkVSU0lPTlxufTtcbiJdLCJuYW1lcyI6W10sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(app-pages-browser)/./node_modules/@upstash/redis/chunk-TAJI6TAE.mjs\n"));

/***/ }),

/***/ "(app-pages-browser)/./node_modules/@upstash/redis/nodejs.mjs":
/*!************************************************!*\
  !*** ./node_modules/@upstash/redis/nodejs.mjs ***!
  \************************************************/
/***/ (function(__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) {

"use strict";
eval(__webpack_require__.ts("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   Redis: function() { return /* binding */ Redis2; },\n/* harmony export */   errors: function() { return /* reexport safe */ _chunk_TAJI6TAE_mjs__WEBPACK_IMPORTED_MODULE_0__.error_exports; }\n/* harmony export */ });\n/* harmony import */ var _chunk_TAJI6TAE_mjs__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./chunk-TAJI6TAE.mjs */ \"(app-pages-browser)/./node_modules/@upstash/redis/chunk-TAJI6TAE.mjs\");\n/* provided dependency */ var Buffer = __webpack_require__(/*! buffer */ \"(app-pages-browser)/./node_modules/next/dist/compiled/buffer/index.js\")[\"Buffer\"];\n/* provided dependency */ var process = __webpack_require__(/*! process */ \"(app-pages-browser)/./node_modules/next/dist/build/polyfills/process.js\");\n\n\n// platforms/nodejs.ts\nif (typeof atob === \"undefined\") {\n  global.atob = (b64) => Buffer.from(b64, \"base64\").toString(\"utf8\");\n}\nvar Redis2 = class _Redis extends _chunk_TAJI6TAE_mjs__WEBPACK_IMPORTED_MODULE_0__.Redis {\n  /**\n   * Create a new redis client by providing a custom `Requester` implementation\n   *\n   * @example\n   * ```ts\n   *\n   * import { UpstashRequest, Requester, UpstashResponse, Redis } from \"@upstash/redis\"\n   *\n   *  const requester: Requester = {\n   *    request: <TResult>(req: UpstashRequest): Promise<UpstashResponse<TResult>> => {\n   *      // ...\n   *    }\n   *  }\n   *\n   * const redis = new Redis(requester)\n   * ```\n   */\n  constructor(configOrRequester) {\n    if (\"request\" in configOrRequester) {\n      super(configOrRequester);\n      return;\n    }\n    if (!configOrRequester.url) {\n      console.warn(\n        `[Upstash Redis] The 'url' property is missing or undefined in your Redis config.`\n      );\n    } else if (configOrRequester.url.startsWith(\" \") || configOrRequester.url.endsWith(\" \") || /\\r|\\n/.test(configOrRequester.url)) {\n      console.warn(\n        \"[Upstash Redis] The redis url contains whitespace or newline, which can cause errors!\"\n      );\n    }\n    if (!configOrRequester.token) {\n      console.warn(\n        `[Upstash Redis] The 'token' property is missing or undefined in your Redis config.`\n      );\n    } else if (configOrRequester.token.startsWith(\" \") || configOrRequester.token.endsWith(\" \") || /\\r|\\n/.test(configOrRequester.token)) {\n      console.warn(\n        \"[Upstash Redis] The redis token contains whitespace or newline, which can cause errors!\"\n      );\n    }\n    const client = new _chunk_TAJI6TAE_mjs__WEBPACK_IMPORTED_MODULE_0__.HttpClient({\n      baseUrl: configOrRequester.url,\n      retry: configOrRequester.retry,\n      headers: { authorization: `Bearer ${configOrRequester.token}` },\n      agent: configOrRequester.agent,\n      responseEncoding: configOrRequester.responseEncoding,\n      cache: configOrRequester.cache ?? \"no-store\",\n      signal: configOrRequester.signal,\n      keepAlive: configOrRequester.keepAlive,\n      readYourWrites: configOrRequester.readYourWrites\n    });\n    super(client, {\n      automaticDeserialization: configOrRequester.automaticDeserialization,\n      enableTelemetry: !process.env.UPSTASH_DISABLE_TELEMETRY,\n      latencyLogging: configOrRequester.latencyLogging,\n      enableAutoPipelining: configOrRequester.enableAutoPipelining\n    });\n    this.addTelemetry({\n      runtime: (\n        // @ts-expect-error to silence compiler\n        typeof EdgeRuntime === \"string\" ? \"edge-light\" : `node@${process.version}`\n      ),\n      platform: process.env.UPSTASH_CONSOLE ? \"console\" : process.env.VERCEL ? \"vercel\" : process.env.AWS_REGION ? \"aws\" : \"unknown\",\n      sdk: `@upstash/redis@${_chunk_TAJI6TAE_mjs__WEBPACK_IMPORTED_MODULE_0__.VERSION}`\n    });\n    if (this.enableAutoPipelining) {\n      return this.autoPipeline();\n    }\n  }\n  /**\n   * Create a new Upstash Redis instance from environment variables.\n   *\n   * Use this to automatically load connection secrets from your environment\n   * variables. For instance when using the Vercel integration.\n   *\n   * This tries to load connection details from your environment using `process.env`:\n   * - URL: `UPSTASH_REDIS_REST_URL` or fallback to `KV_REST_API_URL`\n   * - Token: `UPSTASH_REDIS_REST_TOKEN` or fallback to `KV_REST_API_TOKEN`\n   *\n   * The fallback variables provide compatibility with Vercel KV and other platforms\n   * that may use different naming conventions.\n   */\n  static fromEnv(config) {\n    if (process.env === void 0) {\n      throw new TypeError(\n        '[Upstash Redis] Unable to get environment variables, `process.env` is undefined. If you are deploying to cloudflare, please import from \"@upstash/redis/cloudflare\" instead'\n      );\n    }\n    const url = process.env.UPSTASH_REDIS_REST_URL || process.env.KV_REST_API_URL;\n    if (!url) {\n      console.warn(\"[Upstash Redis] Unable to find environment variable: `UPSTASH_REDIS_REST_URL`\");\n    }\n    const token = process.env.UPSTASH_REDIS_REST_TOKEN || process.env.KV_REST_API_TOKEN;\n    if (!token) {\n      console.warn(\n        \"[Upstash Redis] Unable to find environment variable: `UPSTASH_REDIS_REST_TOKEN`\"\n      );\n    }\n    return new _Redis({ ...config, url, token });\n  }\n};\n\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFwcC1wYWdlcy1icm93c2VyKS8uL25vZGVfbW9kdWxlcy9AdXBzdGFzaC9yZWRpcy9ub2RlanMubWpzIiwibWFwcGluZ3MiOiI7Ozs7Ozs7O0FBSzhCOztBQUU5QjtBQUNBO0FBQ0EseUJBQXlCLE1BQU07QUFDL0I7QUFDQSxrQ0FBa0Msc0RBQUs7QUFDdkM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsY0FBYyxvREFBb0Q7QUFDbEU7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxNQUFNO0FBQ047QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLE1BQU07QUFDTjtBQUNBO0FBQ0E7QUFDQTtBQUNBLHVCQUF1QiwyREFBVTtBQUNqQztBQUNBO0FBQ0EsaUJBQWlCLHlCQUF5Qix3QkFBd0IsR0FBRztBQUNyRTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBLHdCQUF3QixPQUFPO0FBQy9CO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0EsaUVBQWlFLE9BQU8sU0FBUztBQUNqRjtBQUNBLGdCQUFnQixPQUFPLG1DQUFtQyxPQUFPLHlCQUF5QixPQUFPO0FBQ2pHLDZCQUE2Qix3REFBTyxDQUFDO0FBQ3JDLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxRQUFRLE9BQU87QUFDZjtBQUNBO0FBQ0E7QUFDQTtBQUNBLGdCQUFnQixPQUFPLCtCQUErQixPQUFPO0FBQzdEO0FBQ0E7QUFDQTtBQUNBLGtCQUFrQixPQUFPLGlDQUFpQyxPQUFPO0FBQ2pFO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSx3QkFBd0IsdUJBQXVCO0FBQy9DO0FBQ0E7QUFJRSIsInNvdXJjZXMiOlsid2VicGFjazovL19OX0UvLi9ub2RlX21vZHVsZXMvQHVwc3Rhc2gvcmVkaXMvbm9kZWpzLm1qcz8xNWIzIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7XG4gIEh0dHBDbGllbnQsXG4gIFJlZGlzLFxuICBWRVJTSU9OLFxuICBlcnJvcl9leHBvcnRzXG59IGZyb20gXCIuL2NodW5rLVRBSkk2VEFFLm1qc1wiO1xuXG4vLyBwbGF0Zm9ybXMvbm9kZWpzLnRzXG5pZiAodHlwZW9mIGF0b2IgPT09IFwidW5kZWZpbmVkXCIpIHtcbiAgZ2xvYmFsLmF0b2IgPSAoYjY0KSA9PiBCdWZmZXIuZnJvbShiNjQsIFwiYmFzZTY0XCIpLnRvU3RyaW5nKFwidXRmOFwiKTtcbn1cbnZhciBSZWRpczIgPSBjbGFzcyBfUmVkaXMgZXh0ZW5kcyBSZWRpcyB7XG4gIC8qKlxuICAgKiBDcmVhdGUgYSBuZXcgcmVkaXMgY2xpZW50IGJ5IHByb3ZpZGluZyBhIGN1c3RvbSBgUmVxdWVzdGVyYCBpbXBsZW1lbnRhdGlvblxuICAgKlxuICAgKiBAZXhhbXBsZVxuICAgKiBgYGB0c1xuICAgKlxuICAgKiBpbXBvcnQgeyBVcHN0YXNoUmVxdWVzdCwgUmVxdWVzdGVyLCBVcHN0YXNoUmVzcG9uc2UsIFJlZGlzIH0gZnJvbSBcIkB1cHN0YXNoL3JlZGlzXCJcbiAgICpcbiAgICogIGNvbnN0IHJlcXVlc3RlcjogUmVxdWVzdGVyID0ge1xuICAgKiAgICByZXF1ZXN0OiA8VFJlc3VsdD4ocmVxOiBVcHN0YXNoUmVxdWVzdCk6IFByb21pc2U8VXBzdGFzaFJlc3BvbnNlPFRSZXN1bHQ+PiA9PiB7XG4gICAqICAgICAgLy8gLi4uXG4gICAqICAgIH1cbiAgICogIH1cbiAgICpcbiAgICogY29uc3QgcmVkaXMgPSBuZXcgUmVkaXMocmVxdWVzdGVyKVxuICAgKiBgYGBcbiAgICovXG4gIGNvbnN0cnVjdG9yKGNvbmZpZ09yUmVxdWVzdGVyKSB7XG4gICAgaWYgKFwicmVxdWVzdFwiIGluIGNvbmZpZ09yUmVxdWVzdGVyKSB7XG4gICAgICBzdXBlcihjb25maWdPclJlcXVlc3Rlcik7XG4gICAgICByZXR1cm47XG4gICAgfVxuICAgIGlmICghY29uZmlnT3JSZXF1ZXN0ZXIudXJsKSB7XG4gICAgICBjb25zb2xlLndhcm4oXG4gICAgICAgIGBbVXBzdGFzaCBSZWRpc10gVGhlICd1cmwnIHByb3BlcnR5IGlzIG1pc3Npbmcgb3IgdW5kZWZpbmVkIGluIHlvdXIgUmVkaXMgY29uZmlnLmBcbiAgICAgICk7XG4gICAgfSBlbHNlIGlmIChjb25maWdPclJlcXVlc3Rlci51cmwuc3RhcnRzV2l0aChcIiBcIikgfHwgY29uZmlnT3JSZXF1ZXN0ZXIudXJsLmVuZHNXaXRoKFwiIFwiKSB8fCAvXFxyfFxcbi8udGVzdChjb25maWdPclJlcXVlc3Rlci51cmwpKSB7XG4gICAgICBjb25zb2xlLndhcm4oXG4gICAgICAgIFwiW1Vwc3Rhc2ggUmVkaXNdIFRoZSByZWRpcyB1cmwgY29udGFpbnMgd2hpdGVzcGFjZSBvciBuZXdsaW5lLCB3aGljaCBjYW4gY2F1c2UgZXJyb3JzIVwiXG4gICAgICApO1xuICAgIH1cbiAgICBpZiAoIWNvbmZpZ09yUmVxdWVzdGVyLnRva2VuKSB7XG4gICAgICBjb25zb2xlLndhcm4oXG4gICAgICAgIGBbVXBzdGFzaCBSZWRpc10gVGhlICd0b2tlbicgcHJvcGVydHkgaXMgbWlzc2luZyBvciB1bmRlZmluZWQgaW4geW91ciBSZWRpcyBjb25maWcuYFxuICAgICAgKTtcbiAgICB9IGVsc2UgaWYgKGNvbmZpZ09yUmVxdWVzdGVyLnRva2VuLnN0YXJ0c1dpdGgoXCIgXCIpIHx8IGNvbmZpZ09yUmVxdWVzdGVyLnRva2VuLmVuZHNXaXRoKFwiIFwiKSB8fCAvXFxyfFxcbi8udGVzdChjb25maWdPclJlcXVlc3Rlci50b2tlbikpIHtcbiAgICAgIGNvbnNvbGUud2FybihcbiAgICAgICAgXCJbVXBzdGFzaCBSZWRpc10gVGhlIHJlZGlzIHRva2VuIGNvbnRhaW5zIHdoaXRlc3BhY2Ugb3IgbmV3bGluZSwgd2hpY2ggY2FuIGNhdXNlIGVycm9ycyFcIlxuICAgICAgKTtcbiAgICB9XG4gICAgY29uc3QgY2xpZW50ID0gbmV3IEh0dHBDbGllbnQoe1xuICAgICAgYmFzZVVybDogY29uZmlnT3JSZXF1ZXN0ZXIudXJsLFxuICAgICAgcmV0cnk6IGNvbmZpZ09yUmVxdWVzdGVyLnJldHJ5LFxuICAgICAgaGVhZGVyczogeyBhdXRob3JpemF0aW9uOiBgQmVhcmVyICR7Y29uZmlnT3JSZXF1ZXN0ZXIudG9rZW59YCB9LFxuICAgICAgYWdlbnQ6IGNvbmZpZ09yUmVxdWVzdGVyLmFnZW50LFxuICAgICAgcmVzcG9uc2VFbmNvZGluZzogY29uZmlnT3JSZXF1ZXN0ZXIucmVzcG9uc2VFbmNvZGluZyxcbiAgICAgIGNhY2hlOiBjb25maWdPclJlcXVlc3Rlci5jYWNoZSA/PyBcIm5vLXN0b3JlXCIsXG4gICAgICBzaWduYWw6IGNvbmZpZ09yUmVxdWVzdGVyLnNpZ25hbCxcbiAgICAgIGtlZXBBbGl2ZTogY29uZmlnT3JSZXF1ZXN0ZXIua2VlcEFsaXZlLFxuICAgICAgcmVhZFlvdXJXcml0ZXM6IGNvbmZpZ09yUmVxdWVzdGVyLnJlYWRZb3VyV3JpdGVzXG4gICAgfSk7XG4gICAgc3VwZXIoY2xpZW50LCB7XG4gICAgICBhdXRvbWF0aWNEZXNlcmlhbGl6YXRpb246IGNvbmZpZ09yUmVxdWVzdGVyLmF1dG9tYXRpY0Rlc2VyaWFsaXphdGlvbixcbiAgICAgIGVuYWJsZVRlbGVtZXRyeTogIXByb2Nlc3MuZW52LlVQU1RBU0hfRElTQUJMRV9URUxFTUVUUlksXG4gICAgICBsYXRlbmN5TG9nZ2luZzogY29uZmlnT3JSZXF1ZXN0ZXIubGF0ZW5jeUxvZ2dpbmcsXG4gICAgICBlbmFibGVBdXRvUGlwZWxpbmluZzogY29uZmlnT3JSZXF1ZXN0ZXIuZW5hYmxlQXV0b1BpcGVsaW5pbmdcbiAgICB9KTtcbiAgICB0aGlzLmFkZFRlbGVtZXRyeSh7XG4gICAgICBydW50aW1lOiAoXG4gICAgICAgIC8vIEB0cy1leHBlY3QtZXJyb3IgdG8gc2lsZW5jZSBjb21waWxlclxuICAgICAgICB0eXBlb2YgRWRnZVJ1bnRpbWUgPT09IFwic3RyaW5nXCIgPyBcImVkZ2UtbGlnaHRcIiA6IGBub2RlQCR7cHJvY2Vzcy52ZXJzaW9ufWBcbiAgICAgICksXG4gICAgICBwbGF0Zm9ybTogcHJvY2Vzcy5lbnYuVVBTVEFTSF9DT05TT0xFID8gXCJjb25zb2xlXCIgOiBwcm9jZXNzLmVudi5WRVJDRUwgPyBcInZlcmNlbFwiIDogcHJvY2Vzcy5lbnYuQVdTX1JFR0lPTiA/IFwiYXdzXCIgOiBcInVua25vd25cIixcbiAgICAgIHNkazogYEB1cHN0YXNoL3JlZGlzQCR7VkVSU0lPTn1gXG4gICAgfSk7XG4gICAgaWYgKHRoaXMuZW5hYmxlQXV0b1BpcGVsaW5pbmcpIHtcbiAgICAgIHJldHVybiB0aGlzLmF1dG9QaXBlbGluZSgpO1xuICAgIH1cbiAgfVxuICAvKipcbiAgICogQ3JlYXRlIGEgbmV3IFVwc3Rhc2ggUmVkaXMgaW5zdGFuY2UgZnJvbSBlbnZpcm9ubWVudCB2YXJpYWJsZXMuXG4gICAqXG4gICAqIFVzZSB0aGlzIHRvIGF1dG9tYXRpY2FsbHkgbG9hZCBjb25uZWN0aW9uIHNlY3JldHMgZnJvbSB5b3VyIGVudmlyb25tZW50XG4gICAqIHZhcmlhYmxlcy4gRm9yIGluc3RhbmNlIHdoZW4gdXNpbmcgdGhlIFZlcmNlbCBpbnRlZ3JhdGlvbi5cbiAgICpcbiAgICogVGhpcyB0cmllcyB0byBsb2FkIGNvbm5lY3Rpb24gZGV0YWlscyBmcm9tIHlvdXIgZW52aXJvbm1lbnQgdXNpbmcgYHByb2Nlc3MuZW52YDpcbiAgICogLSBVUkw6IGBVUFNUQVNIX1JFRElTX1JFU1RfVVJMYCBvciBmYWxsYmFjayB0byBgS1ZfUkVTVF9BUElfVVJMYFxuICAgKiAtIFRva2VuOiBgVVBTVEFTSF9SRURJU19SRVNUX1RPS0VOYCBvciBmYWxsYmFjayB0byBgS1ZfUkVTVF9BUElfVE9LRU5gXG4gICAqXG4gICAqIFRoZSBmYWxsYmFjayB2YXJpYWJsZXMgcHJvdmlkZSBjb21wYXRpYmlsaXR5IHdpdGggVmVyY2VsIEtWIGFuZCBvdGhlciBwbGF0Zm9ybXNcbiAgICogdGhhdCBtYXkgdXNlIGRpZmZlcmVudCBuYW1pbmcgY29udmVudGlvbnMuXG4gICAqL1xuICBzdGF0aWMgZnJvbUVudihjb25maWcpIHtcbiAgICBpZiAocHJvY2Vzcy5lbnYgPT09IHZvaWQgMCkge1xuICAgICAgdGhyb3cgbmV3IFR5cGVFcnJvcihcbiAgICAgICAgJ1tVcHN0YXNoIFJlZGlzXSBVbmFibGUgdG8gZ2V0IGVudmlyb25tZW50IHZhcmlhYmxlcywgYHByb2Nlc3MuZW52YCBpcyB1bmRlZmluZWQuIElmIHlvdSBhcmUgZGVwbG95aW5nIHRvIGNsb3VkZmxhcmUsIHBsZWFzZSBpbXBvcnQgZnJvbSBcIkB1cHN0YXNoL3JlZGlzL2Nsb3VkZmxhcmVcIiBpbnN0ZWFkJ1xuICAgICAgKTtcbiAgICB9XG4gICAgY29uc3QgdXJsID0gcHJvY2Vzcy5lbnYuVVBTVEFTSF9SRURJU19SRVNUX1VSTCB8fCBwcm9jZXNzLmVudi5LVl9SRVNUX0FQSV9VUkw7XG4gICAgaWYgKCF1cmwpIHtcbiAgICAgIGNvbnNvbGUud2FybihcIltVcHN0YXNoIFJlZGlzXSBVbmFibGUgdG8gZmluZCBlbnZpcm9ubWVudCB2YXJpYWJsZTogYFVQU1RBU0hfUkVESVNfUkVTVF9VUkxgXCIpO1xuICAgIH1cbiAgICBjb25zdCB0b2tlbiA9IHByb2Nlc3MuZW52LlVQU1RBU0hfUkVESVNfUkVTVF9UT0tFTiB8fCBwcm9jZXNzLmVudi5LVl9SRVNUX0FQSV9UT0tFTjtcbiAgICBpZiAoIXRva2VuKSB7XG4gICAgICBjb25zb2xlLndhcm4oXG4gICAgICAgIFwiW1Vwc3Rhc2ggUmVkaXNdIFVuYWJsZSB0byBmaW5kIGVudmlyb25tZW50IHZhcmlhYmxlOiBgVVBTVEFTSF9SRURJU19SRVNUX1RPS0VOYFwiXG4gICAgICApO1xuICAgIH1cbiAgICByZXR1cm4gbmV3IF9SZWRpcyh7IC4uLmNvbmZpZywgdXJsLCB0b2tlbiB9KTtcbiAgfVxufTtcbmV4cG9ydCB7XG4gIFJlZGlzMiBhcyBSZWRpcyxcbiAgZXJyb3JfZXhwb3J0cyBhcyBlcnJvcnNcbn07XG4iXSwibmFtZXMiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(app-pages-browser)/./node_modules/@upstash/redis/nodejs.mjs\n"));

/***/ }),

/***/ "(app-pages-browser)/./node_modules/@vercel/kv/dist/index.js":
/*!***********************************************!*\
  !*** ./node_modules/@vercel/kv/dist/index.js ***!
  \***********************************************/
/***/ (function(__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) {

"use strict";
eval(__webpack_require__.ts("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   VercelKV: function() { return /* binding */ VercelKV; },\n/* harmony export */   createClient: function() { return /* binding */ createClient; },\n/* harmony export */   \"default\": function() { return /* binding */ src_default; },\n/* harmony export */   kv: function() { return /* binding */ kv; }\n/* harmony export */ });\n/* harmony import */ var _upstash_redis__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @upstash/redis */ \"(app-pages-browser)/./node_modules/@upstash/redis/nodejs.mjs\");\n/* provided dependency */ var process = __webpack_require__(/*! process */ \"(app-pages-browser)/./node_modules/next/dist/build/polyfills/process.js\");\n// src/index.ts\n\nvar _kv = null;\nprocess.env.UPSTASH_DISABLE_TELEMETRY = \"1\";\nvar VercelKV = class extends _upstash_redis__WEBPACK_IMPORTED_MODULE_0__.Redis {\n  // This API is based on https://github.com/redis/node-redis#scan-iterator which is not supported in @upstash/redis\n  /**\n   * Same as `scan` but returns an AsyncIterator to allow iteration via `for await`.\n   */\n  async *scanIterator(options) {\n    let cursor = \"0\";\n    let keys;\n    do {\n      [cursor, keys] = await this.scan(cursor, options);\n      for (const key of keys) {\n        yield key;\n      }\n    } while (cursor !== \"0\");\n  }\n  /**\n   * Same as `hscan` but returns an AsyncIterator to allow iteration via `for await`.\n   */\n  async *hscanIterator(key, options) {\n    let cursor = \"0\";\n    let items;\n    do {\n      [cursor, items] = await this.hscan(key, cursor, options);\n      for (const item of items) {\n        yield item;\n      }\n    } while (cursor !== \"0\");\n  }\n  /**\n   * Same as `sscan` but returns an AsyncIterator to allow iteration via `for await`.\n   */\n  async *sscanIterator(key, options) {\n    let cursor = \"0\";\n    let items;\n    do {\n      [cursor, items] = await this.sscan(key, cursor, options);\n      for (const item of items) {\n        yield item;\n      }\n    } while (cursor !== \"0\");\n  }\n  /**\n   * Same as `zscan` but returns an AsyncIterator to allow iteration via `for await`.\n   */\n  async *zscanIterator(key, options) {\n    let cursor = \"0\";\n    let items;\n    do {\n      [cursor, items] = await this.zscan(key, cursor, options);\n      for (const item of items) {\n        yield item;\n      }\n    } while (cursor !== \"0\");\n  }\n};\nfunction createClient(config) {\n  return new VercelKV({\n    // The Next.js team recommends no value or `default` for fetch requests's `cache` option\n    // upstash/redis defaults to `no-store`, so we enforce `default`\n    cache: \"default\",\n    enableAutoPipelining: true,\n    ...config\n  });\n}\nvar src_default = new Proxy(\n  {},\n  {\n    get(target, prop, receiver) {\n      if (prop === \"then\" || prop === \"parse\") {\n        return Reflect.get(target, prop, receiver);\n      }\n      if (!_kv) {\n        if (!process.env.KV_REST_API_URL || !process.env.KV_REST_API_TOKEN) {\n          throw new Error(\n            \"@vercel/kv: Missing required environment variables KV_REST_API_URL and KV_REST_API_TOKEN\"\n          );\n        }\n        console.warn(\n          '\\x1B[33m\"The default export has been moved to a named export and it will be removed in version 1, change to import { kv }\\x1B[0m\"'\n        );\n        _kv = createClient({\n          url: process.env.KV_REST_API_URL,\n          token: process.env.KV_REST_API_TOKEN\n        });\n      }\n      return Reflect.get(_kv, prop);\n    }\n  }\n);\nvar kv = new Proxy(\n  {},\n  {\n    get(target, prop) {\n      if (!_kv) {\n        if (!process.env.KV_REST_API_URL || !process.env.KV_REST_API_TOKEN) {\n          throw new Error(\n            \"@vercel/kv: Missing required environment variables KV_REST_API_URL and KV_REST_API_TOKEN\"\n          );\n        }\n        _kv = createClient({\n          url: process.env.KV_REST_API_URL,\n          token: process.env.KV_REST_API_TOKEN\n        });\n      }\n      return Reflect.get(_kv, prop);\n    }\n  }\n);\n\n//# sourceMappingURL=index.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFwcC1wYWdlcy1icm93c2VyKS8uL25vZGVfbW9kdWxlcy9AdmVyY2VsL2t2L2Rpc3QvaW5kZXguanMiLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7O0FBQUE7QUFDdUM7QUFDdkM7QUFDQSxPQUFPO0FBQ1AsNkJBQTZCLGlEQUFLO0FBQ2xDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLE1BQU07QUFDTjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxNQUFNO0FBQ047QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsTUFBTTtBQUNOO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLE1BQU07QUFDTjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBLElBQUk7QUFDSjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxhQUFhLE9BQU8seUJBQXlCLE9BQU87QUFDcEQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGdJQUFnSSxJQUFJO0FBQ3BJO0FBQ0E7QUFDQSxlQUFlLE9BQU87QUFDdEIsaUJBQWlCLE9BQU87QUFDeEIsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLElBQUk7QUFDSjtBQUNBO0FBQ0E7QUFDQSxhQUFhLE9BQU8seUJBQXlCLE9BQU87QUFDcEQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGVBQWUsT0FBTztBQUN0QixpQkFBaUIsT0FBTztBQUN4QixTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQU1FO0FBQ0YiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9fTl9FLy4vbm9kZV9tb2R1bGVzL0B2ZXJjZWwva3YvZGlzdC9pbmRleC5qcz81ZmQzIl0sInNvdXJjZXNDb250ZW50IjpbIi8vIHNyYy9pbmRleC50c1xuaW1wb3J0IHsgUmVkaXMgfSBmcm9tIFwiQHVwc3Rhc2gvcmVkaXNcIjtcbnZhciBfa3YgPSBudWxsO1xucHJvY2Vzcy5lbnYuVVBTVEFTSF9ESVNBQkxFX1RFTEVNRVRSWSA9IFwiMVwiO1xudmFyIFZlcmNlbEtWID0gY2xhc3MgZXh0ZW5kcyBSZWRpcyB7XG4gIC8vIFRoaXMgQVBJIGlzIGJhc2VkIG9uIGh0dHBzOi8vZ2l0aHViLmNvbS9yZWRpcy9ub2RlLXJlZGlzI3NjYW4taXRlcmF0b3Igd2hpY2ggaXMgbm90IHN1cHBvcnRlZCBpbiBAdXBzdGFzaC9yZWRpc1xuICAvKipcbiAgICogU2FtZSBhcyBgc2NhbmAgYnV0IHJldHVybnMgYW4gQXN5bmNJdGVyYXRvciB0byBhbGxvdyBpdGVyYXRpb24gdmlhIGBmb3IgYXdhaXRgLlxuICAgKi9cbiAgYXN5bmMgKnNjYW5JdGVyYXRvcihvcHRpb25zKSB7XG4gICAgbGV0IGN1cnNvciA9IFwiMFwiO1xuICAgIGxldCBrZXlzO1xuICAgIGRvIHtcbiAgICAgIFtjdXJzb3IsIGtleXNdID0gYXdhaXQgdGhpcy5zY2FuKGN1cnNvciwgb3B0aW9ucyk7XG4gICAgICBmb3IgKGNvbnN0IGtleSBvZiBrZXlzKSB7XG4gICAgICAgIHlpZWxkIGtleTtcbiAgICAgIH1cbiAgICB9IHdoaWxlIChjdXJzb3IgIT09IFwiMFwiKTtcbiAgfVxuICAvKipcbiAgICogU2FtZSBhcyBgaHNjYW5gIGJ1dCByZXR1cm5zIGFuIEFzeW5jSXRlcmF0b3IgdG8gYWxsb3cgaXRlcmF0aW9uIHZpYSBgZm9yIGF3YWl0YC5cbiAgICovXG4gIGFzeW5jICpoc2Nhbkl0ZXJhdG9yKGtleSwgb3B0aW9ucykge1xuICAgIGxldCBjdXJzb3IgPSBcIjBcIjtcbiAgICBsZXQgaXRlbXM7XG4gICAgZG8ge1xuICAgICAgW2N1cnNvciwgaXRlbXNdID0gYXdhaXQgdGhpcy5oc2NhbihrZXksIGN1cnNvciwgb3B0aW9ucyk7XG4gICAgICBmb3IgKGNvbnN0IGl0ZW0gb2YgaXRlbXMpIHtcbiAgICAgICAgeWllbGQgaXRlbTtcbiAgICAgIH1cbiAgICB9IHdoaWxlIChjdXJzb3IgIT09IFwiMFwiKTtcbiAgfVxuICAvKipcbiAgICogU2FtZSBhcyBgc3NjYW5gIGJ1dCByZXR1cm5zIGFuIEFzeW5jSXRlcmF0b3IgdG8gYWxsb3cgaXRlcmF0aW9uIHZpYSBgZm9yIGF3YWl0YC5cbiAgICovXG4gIGFzeW5jICpzc2Nhbkl0ZXJhdG9yKGtleSwgb3B0aW9ucykge1xuICAgIGxldCBjdXJzb3IgPSBcIjBcIjtcbiAgICBsZXQgaXRlbXM7XG4gICAgZG8ge1xuICAgICAgW2N1cnNvciwgaXRlbXNdID0gYXdhaXQgdGhpcy5zc2NhbihrZXksIGN1cnNvciwgb3B0aW9ucyk7XG4gICAgICBmb3IgKGNvbnN0IGl0ZW0gb2YgaXRlbXMpIHtcbiAgICAgICAgeWllbGQgaXRlbTtcbiAgICAgIH1cbiAgICB9IHdoaWxlIChjdXJzb3IgIT09IFwiMFwiKTtcbiAgfVxuICAvKipcbiAgICogU2FtZSBhcyBgenNjYW5gIGJ1dCByZXR1cm5zIGFuIEFzeW5jSXRlcmF0b3IgdG8gYWxsb3cgaXRlcmF0aW9uIHZpYSBgZm9yIGF3YWl0YC5cbiAgICovXG4gIGFzeW5jICp6c2Nhbkl0ZXJhdG9yKGtleSwgb3B0aW9ucykge1xuICAgIGxldCBjdXJzb3IgPSBcIjBcIjtcbiAgICBsZXQgaXRlbXM7XG4gICAgZG8ge1xuICAgICAgW2N1cnNvciwgaXRlbXNdID0gYXdhaXQgdGhpcy56c2NhbihrZXksIGN1cnNvciwgb3B0aW9ucyk7XG4gICAgICBmb3IgKGNvbnN0IGl0ZW0gb2YgaXRlbXMpIHtcbiAgICAgICAgeWllbGQgaXRlbTtcbiAgICAgIH1cbiAgICB9IHdoaWxlIChjdXJzb3IgIT09IFwiMFwiKTtcbiAgfVxufTtcbmZ1bmN0aW9uIGNyZWF0ZUNsaWVudChjb25maWcpIHtcbiAgcmV0dXJuIG5ldyBWZXJjZWxLVih7XG4gICAgLy8gVGhlIE5leHQuanMgdGVhbSByZWNvbW1lbmRzIG5vIHZhbHVlIG9yIGBkZWZhdWx0YCBmb3IgZmV0Y2ggcmVxdWVzdHMncyBgY2FjaGVgIG9wdGlvblxuICAgIC8vIHVwc3Rhc2gvcmVkaXMgZGVmYXVsdHMgdG8gYG5vLXN0b3JlYCwgc28gd2UgZW5mb3JjZSBgZGVmYXVsdGBcbiAgICBjYWNoZTogXCJkZWZhdWx0XCIsXG4gICAgZW5hYmxlQXV0b1BpcGVsaW5pbmc6IHRydWUsXG4gICAgLi4uY29uZmlnXG4gIH0pO1xufVxudmFyIHNyY19kZWZhdWx0ID0gbmV3IFByb3h5KFxuICB7fSxcbiAge1xuICAgIGdldCh0YXJnZXQsIHByb3AsIHJlY2VpdmVyKSB7XG4gICAgICBpZiAocHJvcCA9PT0gXCJ0aGVuXCIgfHwgcHJvcCA9PT0gXCJwYXJzZVwiKSB7XG4gICAgICAgIHJldHVybiBSZWZsZWN0LmdldCh0YXJnZXQsIHByb3AsIHJlY2VpdmVyKTtcbiAgICAgIH1cbiAgICAgIGlmICghX2t2KSB7XG4gICAgICAgIGlmICghcHJvY2Vzcy5lbnYuS1ZfUkVTVF9BUElfVVJMIHx8ICFwcm9jZXNzLmVudi5LVl9SRVNUX0FQSV9UT0tFTikge1xuICAgICAgICAgIHRocm93IG5ldyBFcnJvcihcbiAgICAgICAgICAgIFwiQHZlcmNlbC9rdjogTWlzc2luZyByZXF1aXJlZCBlbnZpcm9ubWVudCB2YXJpYWJsZXMgS1ZfUkVTVF9BUElfVVJMIGFuZCBLVl9SRVNUX0FQSV9UT0tFTlwiXG4gICAgICAgICAgKTtcbiAgICAgICAgfVxuICAgICAgICBjb25zb2xlLndhcm4oXG4gICAgICAgICAgJ1xceDFCWzMzbVwiVGhlIGRlZmF1bHQgZXhwb3J0IGhhcyBiZWVuIG1vdmVkIHRvIGEgbmFtZWQgZXhwb3J0IGFuZCBpdCB3aWxsIGJlIHJlbW92ZWQgaW4gdmVyc2lvbiAxLCBjaGFuZ2UgdG8gaW1wb3J0IHsga3YgfVxceDFCWzBtXCInXG4gICAgICAgICk7XG4gICAgICAgIF9rdiA9IGNyZWF0ZUNsaWVudCh7XG4gICAgICAgICAgdXJsOiBwcm9jZXNzLmVudi5LVl9SRVNUX0FQSV9VUkwsXG4gICAgICAgICAgdG9rZW46IHByb2Nlc3MuZW52LktWX1JFU1RfQVBJX1RPS0VOXG4gICAgICAgIH0pO1xuICAgICAgfVxuICAgICAgcmV0dXJuIFJlZmxlY3QuZ2V0KF9rdiwgcHJvcCk7XG4gICAgfVxuICB9XG4pO1xudmFyIGt2ID0gbmV3IFByb3h5KFxuICB7fSxcbiAge1xuICAgIGdldCh0YXJnZXQsIHByb3ApIHtcbiAgICAgIGlmICghX2t2KSB7XG4gICAgICAgIGlmICghcHJvY2Vzcy5lbnYuS1ZfUkVTVF9BUElfVVJMIHx8ICFwcm9jZXNzLmVudi5LVl9SRVNUX0FQSV9UT0tFTikge1xuICAgICAgICAgIHRocm93IG5ldyBFcnJvcihcbiAgICAgICAgICAgIFwiQHZlcmNlbC9rdjogTWlzc2luZyByZXF1aXJlZCBlbnZpcm9ubWVudCB2YXJpYWJsZXMgS1ZfUkVTVF9BUElfVVJMIGFuZCBLVl9SRVNUX0FQSV9UT0tFTlwiXG4gICAgICAgICAgKTtcbiAgICAgICAgfVxuICAgICAgICBfa3YgPSBjcmVhdGVDbGllbnQoe1xuICAgICAgICAgIHVybDogcHJvY2Vzcy5lbnYuS1ZfUkVTVF9BUElfVVJMLFxuICAgICAgICAgIHRva2VuOiBwcm9jZXNzLmVudi5LVl9SRVNUX0FQSV9UT0tFTlxuICAgICAgICB9KTtcbiAgICAgIH1cbiAgICAgIHJldHVybiBSZWZsZWN0LmdldChfa3YsIHByb3ApO1xuICAgIH1cbiAgfVxuKTtcbmV4cG9ydCB7XG4gIFZlcmNlbEtWLFxuICBjcmVhdGVDbGllbnQsXG4gIHNyY19kZWZhdWx0IGFzIGRlZmF1bHQsXG4gIGt2XG59O1xuLy8jIHNvdXJjZU1hcHBpbmdVUkw9aW5kZXguanMubWFwIl0sIm5hbWVzIjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(app-pages-browser)/./node_modules/@vercel/kv/dist/index.js\n"));

/***/ }),

/***/ "(app-pages-browser)/./node_modules/uncrypto/dist/crypto.web.mjs":
/*!***************************************************!*\
  !*** ./node_modules/uncrypto/dist/crypto.web.mjs ***!
  \***************************************************/
/***/ (function(__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) {

"use strict";
eval(__webpack_require__.ts("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": function() { return /* binding */ _crypto; },\n/* harmony export */   getRandomValues: function() { return /* binding */ getRandomValues; },\n/* harmony export */   randomUUID: function() { return /* binding */ randomUUID; },\n/* harmony export */   subtle: function() { return /* binding */ subtle; }\n/* harmony export */ });\nconst webCrypto = globalThis.crypto;\nconst subtle = webCrypto.subtle;\nconst randomUUID = () => {\n  return webCrypto.randomUUID();\n};\nconst getRandomValues = (array) => {\n  return webCrypto.getRandomValues(array);\n};\nconst _crypto = {\n  randomUUID,\n  getRandomValues,\n  subtle\n};\n\n\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFwcC1wYWdlcy1icm93c2VyKS8uL25vZGVfbW9kdWxlcy91bmNyeXB0by9kaXN0L2NyeXB0by53ZWIubWpzIiwibWFwcGluZ3MiOiI7Ozs7Ozs7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFbUUiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9fTl9FLy4vbm9kZV9tb2R1bGVzL3VuY3J5cHRvL2Rpc3QvY3J5cHRvLndlYi5tanM/MjRmMCJdLCJzb3VyY2VzQ29udGVudCI6WyJjb25zdCB3ZWJDcnlwdG8gPSBnbG9iYWxUaGlzLmNyeXB0bztcbmNvbnN0IHN1YnRsZSA9IHdlYkNyeXB0by5zdWJ0bGU7XG5jb25zdCByYW5kb21VVUlEID0gKCkgPT4ge1xuICByZXR1cm4gd2ViQ3J5cHRvLnJhbmRvbVVVSUQoKTtcbn07XG5jb25zdCBnZXRSYW5kb21WYWx1ZXMgPSAoYXJyYXkpID0+IHtcbiAgcmV0dXJuIHdlYkNyeXB0by5nZXRSYW5kb21WYWx1ZXMoYXJyYXkpO1xufTtcbmNvbnN0IF9jcnlwdG8gPSB7XG4gIHJhbmRvbVVVSUQsXG4gIGdldFJhbmRvbVZhbHVlcyxcbiAgc3VidGxlXG59O1xuXG5leHBvcnQgeyBfY3J5cHRvIGFzIGRlZmF1bHQsIGdldFJhbmRvbVZhbHVlcywgcmFuZG9tVVVJRCwgc3VidGxlIH07XG4iXSwibmFtZXMiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(app-pages-browser)/./node_modules/uncrypto/dist/crypto.web.mjs\n"));

/***/ })

}]);